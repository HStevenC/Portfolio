var yte=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var cHe=yte((mo,go)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var xte=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zx(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function wte(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function i(){if(this instanceof i){var r=[null];r.push.apply(r,arguments);var s=Function.bind.apply(e,r);return new s}return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}),n}var l8={exports:{}},TM={},c8={exports:{}},cn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $x=Symbol.for("react.element"),_te=Symbol.for("react.portal"),bte=Symbol.for("react.fragment"),Ste=Symbol.for("react.strict_mode"),Ate=Symbol.for("react.profiler"),Mte=Symbol.for("react.provider"),Ete=Symbol.for("react.context"),Cte=Symbol.for("react.forward_ref"),Tte=Symbol.for("react.suspense"),Pte=Symbol.for("react.memo"),Dte=Symbol.for("react.lazy"),KU=Symbol.iterator;function Rte(t){return t===null||typeof t!="object"?null:(t=KU&&t[KU]||t["@@iterator"],typeof t=="function"?t:null)}var u8={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},h8=Object.assign,d8={};function rv(t,e,n){this.props=t,this.context=e,this.refs=d8,this.updater=n||u8}rv.prototype.isReactComponent={};rv.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};rv.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function f8(){}f8.prototype=rv.prototype;function m3(t,e,n){this.props=t,this.context=e,this.refs=d8,this.updater=n||u8}var g3=m3.prototype=new f8;g3.constructor=m3;h8(g3,rv.prototype);g3.isPureReactComponent=!0;var JU=Array.isArray,p8=Object.prototype.hasOwnProperty,v3={current:null},m8={key:!0,ref:!0,__self:!0,__source:!0};function g8(t,e,n){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)p8.call(e,i)&&!m8.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:$x,type:t,key:s,ref:o,props:r,_owner:v3.current}}function Lte(t,e){return{$$typeof:$x,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function y3(t){return typeof t=="object"&&t!==null&&t.$$typeof===$x}function Ite(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var ZU=/\/+/g;function aT(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Ite(""+t.key):e.toString(36)}function cS(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case $x:case _te:o=!0}}if(o)return o=t,r=r(o),t=i===""?"."+aT(o,0):i,JU(r)?(n="",t!=null&&(n=t.replace(ZU,"$&/")+"/"),cS(r,e,n,"",function(c){return c})):r!=null&&(y3(r)&&(r=Lte(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(ZU,"$&/")+"/")+t)),e.push(r)),1;if(o=0,i=i===""?".":i+":",JU(t))for(var a=0;a<t.length;a++){s=t[a];var l=i+aT(s,a);o+=cS(s,e,n,l,r)}else if(l=Rte(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=i+aT(s,a++),o+=cS(s,e,n,l,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Gw(t,e,n){if(t==null)return t;var i=[],r=0;return cS(t,i,"","",function(s){return e.call(n,s,r++)}),i}function Bte(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ys={current:null},uS={transition:null},Ote={ReactCurrentDispatcher:ys,ReactCurrentBatchConfig:uS,ReactCurrentOwner:v3};cn.Children={map:Gw,forEach:function(t,e,n){Gw(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Gw(t,function(){e++}),e},toArray:function(t){return Gw(t,function(e){return e})||[]},only:function(t){if(!y3(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};cn.Component=rv;cn.Fragment=bte;cn.Profiler=Ate;cn.PureComponent=m3;cn.StrictMode=Ste;cn.Suspense=Tte;cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ote;cn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=h8({},t.props),r=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=v3.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)p8.call(e,l)&&!m8.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];i.children=a}return{$$typeof:$x,type:t.type,key:r,ref:s,props:i,_owner:o}};cn.createContext=function(t){return t={$$typeof:Ete,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Mte,_context:t},t.Consumer=t};cn.createElement=g8;cn.createFactory=function(t){var e=g8.bind(null,t);return e.type=t,e};cn.createRef=function(){return{current:null}};cn.forwardRef=function(t){return{$$typeof:Cte,render:t}};cn.isValidElement=y3;cn.lazy=function(t){return{$$typeof:Dte,_payload:{_status:-1,_result:t},_init:Bte}};cn.memo=function(t,e){return{$$typeof:Pte,type:t,compare:e===void 0?null:e}};cn.startTransition=function(t){var e=uS.transition;uS.transition={};try{t()}finally{uS.transition=e}};cn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};cn.useCallback=function(t,e){return ys.current.useCallback(t,e)};cn.useContext=function(t){return ys.current.useContext(t)};cn.useDebugValue=function(){};cn.useDeferredValue=function(t){return ys.current.useDeferredValue(t)};cn.useEffect=function(t,e){return ys.current.useEffect(t,e)};cn.useId=function(){return ys.current.useId()};cn.useImperativeHandle=function(t,e,n){return ys.current.useImperativeHandle(t,e,n)};cn.useInsertionEffect=function(t,e){return ys.current.useInsertionEffect(t,e)};cn.useLayoutEffect=function(t,e){return ys.current.useLayoutEffect(t,e)};cn.useMemo=function(t,e){return ys.current.useMemo(t,e)};cn.useReducer=function(t,e,n){return ys.current.useReducer(t,e,n)};cn.useRef=function(t){return ys.current.useRef(t)};cn.useState=function(t){return ys.current.useState(t)};cn.useSyncExternalStore=function(t,e,n){return ys.current.useSyncExternalStore(t,e,n)};cn.useTransition=function(){return ys.current.useTransition()};cn.version="18.2.0";c8.exports=cn;var ge=c8.exports;const du=Zx(ge);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fte=ge,Nte=Symbol.for("react.element"),Ute=Symbol.for("react.fragment"),kte=Object.prototype.hasOwnProperty,zte=Fte.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Gte={key:!0,ref:!0,__self:!0,__source:!0};function v8(t,e,n){var i,r={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)kte.call(e,i)&&!Gte.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:Nte,type:t,key:s,ref:o,props:r,_owner:zte.current}}TM.Fragment=Ute;TM.jsx=v8;TM.jsxs=v8;l8.exports=TM;var We=l8.exports,RD={},y8={exports:{}},Ao={},x8={exports:{}},w8={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(O,W){var H=O.length;O.push(W);e:for(;0<H;){var Y=H-1>>>1,z=O[Y];if(0<r(z,W))O[Y]=W,O[H]=z,H=Y;else break e}}function n(O){return O.length===0?null:O[0]}function i(O){if(O.length===0)return null;var W=O[0],H=O.pop();if(H!==W){O[0]=H;e:for(var Y=0,z=O.length,X=z>>>1;Y<X;){var q=2*(Y+1)-1,re=O[q],G=q+1,K=O[G];if(0>r(re,H))G<z&&0>r(K,re)?(O[Y]=K,O[G]=H,Y=G):(O[Y]=re,O[q]=H,Y=q);else if(G<z&&0>r(K,H))O[Y]=K,O[G]=H,Y=G;else break e}}return W}function r(O,W){var H=O.sortIndex-W.sortIndex;return H!==0?H:O.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,u=null,d=3,f=!1,p=!1,v=!1,g=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(O){for(var W=n(c);W!==null;){if(W.callback===null)i(c);else if(W.startTime<=O)i(c),W.sortIndex=W.expirationTime,e(l,W);else break;W=n(c)}}function b(O){if(v=!1,w(O),!p)if(n(l)!==null)p=!0,Z(A);else{var W=n(c);W!==null&&ee(b,W.startTime-O)}}function A(O,W){p=!1,v&&(v=!1,m(M),M=-1),f=!0;var H=d;try{for(w(W),u=n(l);u!==null&&(!(u.expirationTime>W)||O&&!R());){var Y=u.callback;if(typeof Y=="function"){u.callback=null,d=u.priorityLevel;var z=Y(u.expirationTime<=W);W=t.unstable_now(),typeof z=="function"?u.callback=z:u===n(l)&&i(l),w(W)}else i(l);u=n(l)}if(u!==null)var X=!0;else{var q=n(c);q!==null&&ee(b,q.startTime-W),X=!1}return X}finally{u=null,d=H,f=!1}}var S=!1,T=null,M=-1,E=5,P=-1;function R(){return!(t.unstable_now()-P<E)}function F(){if(T!==null){var O=t.unstable_now();P=O;var W=!0;try{W=T(!0,O)}finally{W?B():(S=!1,T=null)}}else S=!1}var B;if(typeof y=="function")B=function(){y(F)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,j=k.port2;k.port1.onmessage=F,B=function(){j.postMessage(null)}}else B=function(){g(F,0)};function Z(O){T=O,S||(S=!0,B())}function ee(O,W){M=g(function(){O(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,Z(A))},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(O){switch(d){case 1:case 2:case 3:var W=3;break;default:W=d}var H=d;d=W;try{return O()}finally{d=H}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(O,W){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var H=d;d=O;try{return W()}finally{d=H}},t.unstable_scheduleCallback=function(O,W,H){var Y=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?Y+H:Y):H=Y,O){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=H+z,O={id:h++,callback:W,priorityLevel:O,startTime:H,expirationTime:z,sortIndex:-1},H>Y?(O.sortIndex=H,e(c,O),n(l)===null&&O===n(c)&&(v?(m(M),M=-1):v=!0,ee(b,H-Y))):(O.sortIndex=z,e(l,O),p||f||(p=!0,Z(A))),O},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(O){var W=d;return function(){var H=d;d=W;try{return O.apply(this,arguments)}finally{d=H}}}})(w8);x8.exports=w8;var Hte=x8.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _8=ge,_o=Hte;function Je(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var b8=new Set,Qy={};function jf(t,e){Eg(t,e),Eg(t+"Capture",e)}function Eg(t,e){for(Qy[t]=e,t=0;t<e.length;t++)b8.add(e[t])}var tu=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),LD=Object.prototype.hasOwnProperty,Vte=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$U={},ek={};function jte(t){return LD.call(ek,t)?!0:LD.call($U,t)?!1:Vte.test(t)?ek[t]=!0:($U[t]=!0,!1)}function Wte(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Xte(t,e,n,i){if(e===null||typeof e>"u"||Wte(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function xs(t,e,n,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Fr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Fr[t]=new xs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Fr[e]=new xs(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Fr[t]=new xs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Fr[t]=new xs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Fr[t]=new xs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Fr[t]=new xs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Fr[t]=new xs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Fr[t]=new xs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Fr[t]=new xs(t,5,!1,t.toLowerCase(),null,!1,!1)});var x3=/[\-:]([a-z])/g;function w3(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(x3,w3);Fr[e]=new xs(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(x3,w3);Fr[e]=new xs(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(x3,w3);Fr[e]=new xs(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Fr[t]=new xs(t,1,!1,t.toLowerCase(),null,!1,!1)});Fr.xlinkHref=new xs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Fr[t]=new xs(t,1,!1,t.toLowerCase(),null,!0,!0)});function _3(t,e,n,i){var r=Fr.hasOwnProperty(e)?Fr[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Xte(e,n,r,i)&&(n=null),i||r===null?jte(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var fu=_8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Hw=Symbol.for("react.element"),Mm=Symbol.for("react.portal"),Em=Symbol.for("react.fragment"),b3=Symbol.for("react.strict_mode"),ID=Symbol.for("react.profiler"),S8=Symbol.for("react.provider"),A8=Symbol.for("react.context"),S3=Symbol.for("react.forward_ref"),BD=Symbol.for("react.suspense"),OD=Symbol.for("react.suspense_list"),A3=Symbol.for("react.memo"),Ju=Symbol.for("react.lazy"),M8=Symbol.for("react.offscreen"),tk=Symbol.iterator;function Kv(t){return t===null||typeof t!="object"?null:(t=tk&&t[tk]||t["@@iterator"],typeof t=="function"?t:null)}var fi=Object.assign,lT;function $0(t){if(lT===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);lT=e&&e[1]||""}return`
`+lT+t}var cT=!1;function uT(t,e){if(!t||cT)return"";cT=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var i=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){i=c}t.call(e.prototype)}else{try{throw Error()}catch(c){i=c}t()}}catch(c){if(c&&i&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{cT=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?$0(t):""}function Yte(t){switch(t.tag){case 5:return $0(t.type);case 16:return $0("Lazy");case 13:return $0("Suspense");case 19:return $0("SuspenseList");case 0:case 2:case 15:return t=uT(t.type,!1),t;case 11:return t=uT(t.type.render,!1),t;case 1:return t=uT(t.type,!0),t;default:return""}}function FD(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Em:return"Fragment";case Mm:return"Portal";case ID:return"Profiler";case b3:return"StrictMode";case BD:return"Suspense";case OD:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case A8:return(t.displayName||"Context")+".Consumer";case S8:return(t._context.displayName||"Context")+".Provider";case S3:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case A3:return e=t.displayName||null,e!==null?e:FD(t.type)||"Memo";case Ju:e=t._payload,t=t._init;try{return FD(t(e))}catch{}}return null}function qte(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return FD(e);case 8:return e===b3?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function zh(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function E8(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Qte(t){var e=E8(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Vw(t){t._valueTracker||(t._valueTracker=Qte(t))}function C8(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=E8(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function XS(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ND(t,e){var n=e.checked;return fi({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function nk(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=zh(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function T8(t,e){e=e.checked,e!=null&&_3(t,"checked",e,!1)}function UD(t,e){T8(t,e);var n=zh(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?kD(t,e.type,n):e.hasOwnProperty("defaultValue")&&kD(t,e.type,zh(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function ik(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function kD(t,e,n){(e!=="number"||XS(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ey=Array.isArray;function tg(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+zh(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function zD(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Je(91));return fi({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function rk(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Je(92));if(ey(n)){if(1<n.length)throw Error(Je(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:zh(n)}}function P8(t,e){var n=zh(e.value),i=zh(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function sk(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function D8(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function GD(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?D8(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var jw,R8=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(jw=jw||document.createElement("div"),jw.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=jw.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ky(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var py={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Kte=["Webkit","ms","Moz","O"];Object.keys(py).forEach(function(t){Kte.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),py[e]=py[t]})});function L8(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||py.hasOwnProperty(t)&&py[t]?(""+e).trim():e+"px"}function I8(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=L8(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var Jte=fi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function HD(t,e){if(e){if(Jte[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Je(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Je(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Je(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Je(62))}}function VD(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jD=null;function M3(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var WD=null,ng=null,ig=null;function ok(t){if(t=n1(t)){if(typeof WD!="function")throw Error(Je(280));var e=t.stateNode;e&&(e=IM(e),WD(t.stateNode,t.type,e))}}function B8(t){ng?ig?ig.push(t):ig=[t]:ng=t}function O8(){if(ng){var t=ng,e=ig;if(ig=ng=null,ok(t),e)for(t=0;t<e.length;t++)ok(e[t])}}function F8(t,e){return t(e)}function N8(){}var hT=!1;function U8(t,e,n){if(hT)return t(e,n);hT=!0;try{return F8(t,e,n)}finally{hT=!1,(ng!==null||ig!==null)&&(N8(),O8())}}function Jy(t,e){var n=t.stateNode;if(n===null)return null;var i=IM(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Je(231,e,typeof n));return n}var XD=!1;if(tu)try{var Jv={};Object.defineProperty(Jv,"passive",{get:function(){XD=!0}}),window.addEventListener("test",Jv,Jv),window.removeEventListener("test",Jv,Jv)}catch{XD=!1}function Zte(t,e,n,i,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(h){this.onError(h)}}var my=!1,YS=null,qS=!1,YD=null,$te={onError:function(t){my=!0,YS=t}};function ene(t,e,n,i,r,s,o,a,l){my=!1,YS=null,Zte.apply($te,arguments)}function tne(t,e,n,i,r,s,o,a,l){if(ene.apply(this,arguments),my){if(my){var c=YS;my=!1,YS=null}else throw Error(Je(198));qS||(qS=!0,YD=c)}}function Wf(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function k8(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function ak(t){if(Wf(t)!==t)throw Error(Je(188))}function nne(t){var e=t.alternate;if(!e){if(e=Wf(t),e===null)throw Error(Je(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return ak(r),t;if(s===i)return ak(r),e;s=s.sibling}throw Error(Je(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o)throw Error(Je(189))}}if(n.alternate!==i)throw Error(Je(190))}if(n.tag!==3)throw Error(Je(188));return n.stateNode.current===n?t:e}function z8(t){return t=nne(t),t!==null?G8(t):null}function G8(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=G8(t);if(e!==null)return e;t=t.sibling}return null}var H8=_o.unstable_scheduleCallback,lk=_o.unstable_cancelCallback,ine=_o.unstable_shouldYield,rne=_o.unstable_requestPaint,Pi=_o.unstable_now,sne=_o.unstable_getCurrentPriorityLevel,E3=_o.unstable_ImmediatePriority,V8=_o.unstable_UserBlockingPriority,QS=_o.unstable_NormalPriority,one=_o.unstable_LowPriority,j8=_o.unstable_IdlePriority,PM=null,jl=null;function ane(t){if(jl&&typeof jl.onCommitFiberRoot=="function")try{jl.onCommitFiberRoot(PM,t,void 0,(t.current.flags&128)===128)}catch{}}var Wa=Math.clz32?Math.clz32:une,lne=Math.log,cne=Math.LN2;function une(t){return t>>>=0,t===0?32:31-(lne(t)/cne|0)|0}var Ww=64,Xw=4194304;function ty(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function KS(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?i=ty(a):(s&=o,s!==0&&(i=ty(s)))}else o=n&~r,o!==0?i=ty(o):s!==0&&(i=ty(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-Wa(e),r=1<<n,i|=t[n],e&=~r;return i}function hne(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dne(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Wa(s),a=1<<o,l=r[o];l===-1?(!(a&n)||a&i)&&(r[o]=hne(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function qD(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function W8(){var t=Ww;return Ww<<=1,!(Ww&4194240)&&(Ww=64),t}function dT(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function e1(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Wa(e),t[e]=n}function fne(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Wa(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}function C3(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-Wa(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var Ln=0;function X8(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Y8,T3,q8,Q8,K8,QD=!1,Yw=[],bh=null,Sh=null,Ah=null,Zy=new Map,$y=new Map,rh=[],pne="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ck(t,e){switch(t){case"focusin":case"focusout":bh=null;break;case"dragenter":case"dragleave":Sh=null;break;case"mouseover":case"mouseout":Ah=null;break;case"pointerover":case"pointerout":Zy.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":$y.delete(e.pointerId)}}function Zv(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=n1(e),e!==null&&T3(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function mne(t,e,n,i,r){switch(e){case"focusin":return bh=Zv(bh,t,e,n,i,r),!0;case"dragenter":return Sh=Zv(Sh,t,e,n,i,r),!0;case"mouseover":return Ah=Zv(Ah,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return Zy.set(s,Zv(Zy.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,$y.set(s,Zv($y.get(s)||null,t,e,n,i,r)),!0}return!1}function J8(t){var e=Zd(t.target);if(e!==null){var n=Wf(e);if(n!==null){if(e=n.tag,e===13){if(e=k8(n),e!==null){t.blockedOn=e,K8(t.priority,function(){q8(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function hS(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=KD(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);jD=i,n.target.dispatchEvent(i),jD=null}else return e=n1(n),e!==null&&T3(e),t.blockedOn=n,!1;e.shift()}return!0}function uk(t,e,n){hS(t)&&n.delete(e)}function gne(){QD=!1,bh!==null&&hS(bh)&&(bh=null),Sh!==null&&hS(Sh)&&(Sh=null),Ah!==null&&hS(Ah)&&(Ah=null),Zy.forEach(uk),$y.forEach(uk)}function $v(t,e){t.blockedOn===e&&(t.blockedOn=null,QD||(QD=!0,_o.unstable_scheduleCallback(_o.unstable_NormalPriority,gne)))}function ex(t){function e(r){return $v(r,t)}if(0<Yw.length){$v(Yw[0],t);for(var n=1;n<Yw.length;n++){var i=Yw[n];i.blockedOn===t&&(i.blockedOn=null)}}for(bh!==null&&$v(bh,t),Sh!==null&&$v(Sh,t),Ah!==null&&$v(Ah,t),Zy.forEach(e),$y.forEach(e),n=0;n<rh.length;n++)i=rh[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<rh.length&&(n=rh[0],n.blockedOn===null);)J8(n),n.blockedOn===null&&rh.shift()}var rg=fu.ReactCurrentBatchConfig,JS=!0;function vne(t,e,n,i){var r=Ln,s=rg.transition;rg.transition=null;try{Ln=1,P3(t,e,n,i)}finally{Ln=r,rg.transition=s}}function yne(t,e,n,i){var r=Ln,s=rg.transition;rg.transition=null;try{Ln=4,P3(t,e,n,i)}finally{Ln=r,rg.transition=s}}function P3(t,e,n,i){if(JS){var r=KD(t,e,n,i);if(r===null)bT(t,e,i,ZS,n),ck(t,i);else if(mne(r,t,e,n,i))i.stopPropagation();else if(ck(t,i),e&4&&-1<pne.indexOf(t)){for(;r!==null;){var s=n1(r);if(s!==null&&Y8(s),s=KD(t,e,n,i),s===null&&bT(t,e,i,ZS,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else bT(t,e,i,null,n)}}var ZS=null;function KD(t,e,n,i){if(ZS=null,t=M3(i),t=Zd(t),t!==null)if(e=Wf(t),e===null)t=null;else if(n=e.tag,n===13){if(t=k8(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ZS=t,null}function Z8(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sne()){case E3:return 1;case V8:return 4;case QS:case one:return 16;case j8:return 536870912;default:return 16}default:return 16}}var ch=null,D3=null,dS=null;function $8(){if(dS)return dS;var t,e=D3,n=e.length,i,r="value"in ch?ch.value:ch.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(i=1;i<=o&&e[n-i]===r[s-i];i++);return dS=r.slice(t,1<i?1-i:void 0)}function fS(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function qw(){return!0}function hk(){return!1}function Mo(t){function e(n,i,r,s,o){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?qw:hk,this.isPropagationStopped=hk,this}return fi(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=qw)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=qw)},persist:function(){},isPersistent:qw}),e}var sv={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},R3=Mo(sv),t1=fi({},sv,{view:0,detail:0}),xne=Mo(t1),fT,pT,e0,DM=fi({},t1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:L3,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==e0&&(e0&&t.type==="mousemove"?(fT=t.screenX-e0.screenX,pT=t.screenY-e0.screenY):pT=fT=0,e0=t),fT)},movementY:function(t){return"movementY"in t?t.movementY:pT}}),dk=Mo(DM),wne=fi({},DM,{dataTransfer:0}),_ne=Mo(wne),bne=fi({},t1,{relatedTarget:0}),mT=Mo(bne),Sne=fi({},sv,{animationName:0,elapsedTime:0,pseudoElement:0}),Ane=Mo(Sne),Mne=fi({},sv,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Ene=Mo(Mne),Cne=fi({},sv,{data:0}),fk=Mo(Cne),Tne={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Pne={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Dne={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rne(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Dne[t])?!!e[t]:!1}function L3(){return Rne}var Lne=fi({},t1,{key:function(t){if(t.key){var e=Tne[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=fS(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Pne[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:L3,charCode:function(t){return t.type==="keypress"?fS(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?fS(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Ine=Mo(Lne),Bne=fi({},DM,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pk=Mo(Bne),One=fi({},t1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:L3}),Fne=Mo(One),Nne=fi({},sv,{propertyName:0,elapsedTime:0,pseudoElement:0}),Une=Mo(Nne),kne=fi({},DM,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),zne=Mo(kne),Gne=[9,13,27,32],I3=tu&&"CompositionEvent"in window,gy=null;tu&&"documentMode"in document&&(gy=document.documentMode);var Hne=tu&&"TextEvent"in window&&!gy,e9=tu&&(!I3||gy&&8<gy&&11>=gy),mk=String.fromCharCode(32),gk=!1;function t9(t,e){switch(t){case"keyup":return Gne.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function n9(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Cm=!1;function Vne(t,e){switch(t){case"compositionend":return n9(e);case"keypress":return e.which!==32?null:(gk=!0,mk);case"textInput":return t=e.data,t===mk&&gk?null:t;default:return null}}function jne(t,e){if(Cm)return t==="compositionend"||!I3&&t9(t,e)?(t=$8(),dS=D3=ch=null,Cm=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return e9&&e.locale!=="ko"?null:e.data;default:return null}}var Wne={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vk(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Wne[t.type]:e==="textarea"}function i9(t,e,n,i){B8(i),e=$S(e,"onChange"),0<e.length&&(n=new R3("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var vy=null,tx=null;function Xne(t){p9(t,0)}function RM(t){var e=Dm(t);if(C8(e))return t}function Yne(t,e){if(t==="change")return e}var r9=!1;if(tu){var gT;if(tu){var vT="oninput"in document;if(!vT){var yk=document.createElement("div");yk.setAttribute("oninput","return;"),vT=typeof yk.oninput=="function"}gT=vT}else gT=!1;r9=gT&&(!document.documentMode||9<document.documentMode)}function xk(){vy&&(vy.detachEvent("onpropertychange",s9),tx=vy=null)}function s9(t){if(t.propertyName==="value"&&RM(tx)){var e=[];i9(e,tx,t,M3(t)),U8(Xne,e)}}function qne(t,e,n){t==="focusin"?(xk(),vy=e,tx=n,vy.attachEvent("onpropertychange",s9)):t==="focusout"&&xk()}function Qne(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return RM(tx)}function Kne(t,e){if(t==="click")return RM(e)}function Jne(t,e){if(t==="input"||t==="change")return RM(e)}function Zne(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ka=typeof Object.is=="function"?Object.is:Zne;function nx(t,e){if(Ka(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!LD.call(e,r)||!Ka(t[r],e[r]))return!1}return!0}function wk(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function _k(t,e){var n=wk(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=wk(n)}}function o9(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?o9(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function a9(){for(var t=window,e=XS();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=XS(t.document)}return e}function B3(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function $ne(t){var e=a9(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&o9(n.ownerDocument.documentElement,n)){if(i!==null&&B3(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=_k(n,s);var o=_k(n,i);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var eie=tu&&"documentMode"in document&&11>=document.documentMode,Tm=null,JD=null,yy=null,ZD=!1;function bk(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ZD||Tm==null||Tm!==XS(i)||(i=Tm,"selectionStart"in i&&B3(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),yy&&nx(yy,i)||(yy=i,i=$S(JD,"onSelect"),0<i.length&&(e=new R3("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=Tm)))}function Qw(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Pm={animationend:Qw("Animation","AnimationEnd"),animationiteration:Qw("Animation","AnimationIteration"),animationstart:Qw("Animation","AnimationStart"),transitionend:Qw("Transition","TransitionEnd")},yT={},l9={};tu&&(l9=document.createElement("div").style,"AnimationEvent"in window||(delete Pm.animationend.animation,delete Pm.animationiteration.animation,delete Pm.animationstart.animation),"TransitionEvent"in window||delete Pm.transitionend.transition);function LM(t){if(yT[t])return yT[t];if(!Pm[t])return t;var e=Pm[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in l9)return yT[t]=e[n];return t}var c9=LM("animationend"),u9=LM("animationiteration"),h9=LM("animationstart"),d9=LM("transitionend"),f9=new Map,Sk="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Jh(t,e){f9.set(t,e),jf(e,[t])}for(var xT=0;xT<Sk.length;xT++){var wT=Sk[xT],tie=wT.toLowerCase(),nie=wT[0].toUpperCase()+wT.slice(1);Jh(tie,"on"+nie)}Jh(c9,"onAnimationEnd");Jh(u9,"onAnimationIteration");Jh(h9,"onAnimationStart");Jh("dblclick","onDoubleClick");Jh("focusin","onFocus");Jh("focusout","onBlur");Jh(d9,"onTransitionEnd");Eg("onMouseEnter",["mouseout","mouseover"]);Eg("onMouseLeave",["mouseout","mouseover"]);Eg("onPointerEnter",["pointerout","pointerover"]);Eg("onPointerLeave",["pointerout","pointerover"]);jf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));jf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));jf("onBeforeInput",["compositionend","keypress","textInput","paste"]);jf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));jf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));jf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ny="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iie=new Set("cancel close invalid load scroll toggle".split(" ").concat(ny));function Ak(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,tne(i,e,void 0,t),t.currentTarget=null}function p9(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;Ak(r,a,c),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;Ak(r,a,c),s=l}}}if(qS)throw t=YD,qS=!1,YD=null,t}function Yn(t,e){var n=e[iR];n===void 0&&(n=e[iR]=new Set);var i=t+"__bubble";n.has(i)||(m9(e,t,2,!1),n.add(i))}function _T(t,e,n){var i=0;e&&(i|=4),m9(n,t,i,e)}var Kw="_reactListening"+Math.random().toString(36).slice(2);function ix(t){if(!t[Kw]){t[Kw]=!0,b8.forEach(function(n){n!=="selectionchange"&&(iie.has(n)||_T(n,!1,t),_T(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Kw]||(e[Kw]=!0,_T("selectionchange",!1,e))}}function m9(t,e,n,i){switch(Z8(e)){case 1:var r=vne;break;case 4:r=yne;break;default:r=P3}n=r.bind(null,e,n,t),r=void 0,!XD||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function bT(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Zd(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}U8(function(){var c=s,h=M3(n),u=[];e:{var d=f9.get(t);if(d!==void 0){var f=R3,p=t;switch(t){case"keypress":if(fS(n)===0)break e;case"keydown":case"keyup":f=Ine;break;case"focusin":p="focus",f=mT;break;case"focusout":p="blur",f=mT;break;case"beforeblur":case"afterblur":f=mT;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=dk;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=_ne;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=Fne;break;case c9:case u9:case h9:f=Ane;break;case d9:f=Une;break;case"scroll":f=xne;break;case"wheel":f=zne;break;case"copy":case"cut":case"paste":f=Ene;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=pk}var v=(e&4)!==0,g=!v&&t==="scroll",m=v?d!==null?d+"Capture":null:d;v=[];for(var y=c,w;y!==null;){w=y;var b=w.stateNode;if(w.tag===5&&b!==null&&(w=b,m!==null&&(b=Jy(y,m),b!=null&&v.push(rx(y,b,w)))),g)break;y=y.return}0<v.length&&(d=new f(d,p,null,n,h),u.push({event:d,listeners:v}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",d&&n!==jD&&(p=n.relatedTarget||n.fromElement)&&(Zd(p)||p[nu]))break e;if((f||d)&&(d=h.window===h?h:(d=h.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=c,p=p?Zd(p):null,p!==null&&(g=Wf(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(v=dk,b="onMouseLeave",m="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(v=pk,b="onPointerLeave",m="onPointerEnter",y="pointer"),g=f==null?d:Dm(f),w=p==null?d:Dm(p),d=new v(b,y+"leave",f,n,h),d.target=g,d.relatedTarget=w,b=null,Zd(h)===c&&(v=new v(m,y+"enter",p,n,h),v.target=w,v.relatedTarget=g,b=v),g=b,f&&p)t:{for(v=f,m=p,y=0,w=v;w;w=vp(w))y++;for(w=0,b=m;b;b=vp(b))w++;for(;0<y-w;)v=vp(v),y--;for(;0<w-y;)m=vp(m),w--;for(;y--;){if(v===m||m!==null&&v===m.alternate)break t;v=vp(v),m=vp(m)}v=null}else v=null;f!==null&&Mk(u,d,f,v,!1),p!==null&&g!==null&&Mk(u,g,p,v,!0)}}e:{if(d=c?Dm(c):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var A=Yne;else if(vk(d))if(r9)A=Jne;else{A=Qne;var S=qne}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(A=Kne);if(A&&(A=A(t,c))){i9(u,A,n,h);break e}S&&S(t,d,c),t==="focusout"&&(S=d._wrapperState)&&S.controlled&&d.type==="number"&&kD(d,"number",d.value)}switch(S=c?Dm(c):window,t){case"focusin":(vk(S)||S.contentEditable==="true")&&(Tm=S,JD=c,yy=null);break;case"focusout":yy=JD=Tm=null;break;case"mousedown":ZD=!0;break;case"contextmenu":case"mouseup":case"dragend":ZD=!1,bk(u,n,h);break;case"selectionchange":if(eie)break;case"keydown":case"keyup":bk(u,n,h)}var T;if(I3)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Cm?t9(t,n)&&(M="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(e9&&n.locale!=="ko"&&(Cm||M!=="onCompositionStart"?M==="onCompositionEnd"&&Cm&&(T=$8()):(ch=h,D3="value"in ch?ch.value:ch.textContent,Cm=!0)),S=$S(c,M),0<S.length&&(M=new fk(M,t,null,n,h),u.push({event:M,listeners:S}),T?M.data=T:(T=n9(n),T!==null&&(M.data=T)))),(T=Hne?Vne(t,n):jne(t,n))&&(c=$S(c,"onBeforeInput"),0<c.length&&(h=new fk("onBeforeInput","beforeinput",null,n,h),u.push({event:h,listeners:c}),h.data=T))}p9(u,e)})}function rx(t,e,n){return{instance:t,listener:e,currentTarget:n}}function $S(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=Jy(t,n),s!=null&&i.unshift(rx(t,s,r)),s=Jy(t,e),s!=null&&i.push(rx(t,s,r))),t=t.return}return i}function vp(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Mk(t,e,n,i,r){for(var s=e._reactName,o=[];n!==null&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&c!==null&&(a=c,r?(l=Jy(n,s),l!=null&&o.unshift(rx(n,l,a))):r||(l=Jy(n,s),l!=null&&o.push(rx(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var rie=/\r\n?/g,sie=/\u0000|\uFFFD/g;function Ek(t){return(typeof t=="string"?t:""+t).replace(rie,`
`).replace(sie,"")}function Jw(t,e,n){if(e=Ek(e),Ek(t)!==e&&n)throw Error(Je(425))}function eA(){}var $D=null,eR=null;function tR(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var nR=typeof setTimeout=="function"?setTimeout:void 0,oie=typeof clearTimeout=="function"?clearTimeout:void 0,Ck=typeof Promise=="function"?Promise:void 0,aie=typeof queueMicrotask=="function"?queueMicrotask:typeof Ck<"u"?function(t){return Ck.resolve(null).then(t).catch(lie)}:nR;function lie(t){setTimeout(function(){throw t})}function ST(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),ex(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);ex(e)}function Mh(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Tk(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ov=Math.random().toString(36).slice(2),Ol="__reactFiber$"+ov,sx="__reactProps$"+ov,nu="__reactContainer$"+ov,iR="__reactEvents$"+ov,cie="__reactListeners$"+ov,uie="__reactHandles$"+ov;function Zd(t){var e=t[Ol];if(e)return e;for(var n=t.parentNode;n;){if(e=n[nu]||n[Ol]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Tk(t);t!==null;){if(n=t[Ol])return n;t=Tk(t)}return e}t=n,n=t.parentNode}return null}function n1(t){return t=t[Ol]||t[nu],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Dm(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Je(33))}function IM(t){return t[sx]||null}var rR=[],Rm=-1;function Zh(t){return{current:t}}function Jn(t){0>Rm||(t.current=rR[Rm],rR[Rm]=null,Rm--)}function jn(t,e){Rm++,rR[Rm]=t.current,t.current=e}var Gh={},Jr=Zh(Gh),Fs=Zh(!1),Ef=Gh;function Cg(t,e){var n=t.type.contextTypes;if(!n)return Gh;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=e[s];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Ns(t){return t=t.childContextTypes,t!=null}function tA(){Jn(Fs),Jn(Jr)}function Pk(t,e,n){if(Jr.current!==Gh)throw Error(Je(168));jn(Jr,e),jn(Fs,n)}function g9(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(Je(108,qte(t)||"Unknown",r));return fi({},n,i)}function nA(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Gh,Ef=Jr.current,jn(Jr,t),jn(Fs,Fs.current),!0}function Dk(t,e,n){var i=t.stateNode;if(!i)throw Error(Je(169));n?(t=g9(t,e,Ef),i.__reactInternalMemoizedMergedChildContext=t,Jn(Fs),Jn(Jr),jn(Jr,t)):Jn(Fs),jn(Fs,n)}var Nc=null,BM=!1,AT=!1;function v9(t){Nc===null?Nc=[t]:Nc.push(t)}function hie(t){BM=!0,v9(t)}function $h(){if(!AT&&Nc!==null){AT=!0;var t=0,e=Ln;try{var n=Nc;for(Ln=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}Nc=null,BM=!1}catch(r){throw Nc!==null&&(Nc=Nc.slice(t+1)),H8(E3,$h),r}finally{Ln=e,AT=!1}}return null}var Lm=[],Im=0,iA=null,rA=0,Zo=[],$o=0,Cf=null,zc=1,Gc="";function Bd(t,e){Lm[Im++]=rA,Lm[Im++]=iA,iA=t,rA=e}function y9(t,e,n){Zo[$o++]=zc,Zo[$o++]=Gc,Zo[$o++]=Cf,Cf=t;var i=zc;t=Gc;var r=32-Wa(i)-1;i&=~(1<<r),n+=1;var s=32-Wa(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,zc=1<<32-Wa(e)+r|n<<r|i,Gc=s+t}else zc=1<<s|n<<r|i,Gc=t}function O3(t){t.return!==null&&(Bd(t,1),y9(t,1,0))}function F3(t){for(;t===iA;)iA=Lm[--Im],Lm[Im]=null,rA=Lm[--Im],Lm[Im]=null;for(;t===Cf;)Cf=Zo[--$o],Zo[$o]=null,Gc=Zo[--$o],Zo[$o]=null,zc=Zo[--$o],Zo[$o]=null}var vo=null,oo=null,ni=!1,Na=null;function x9(t,e){var n=ra(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Rk(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,vo=t,oo=Mh(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,vo=t,oo=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Cf!==null?{id:zc,overflow:Gc}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ra(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,vo=t,oo=null,!0):!1;default:return!1}}function sR(t){return(t.mode&1)!==0&&(t.flags&128)===0}function oR(t){if(ni){var e=oo;if(e){var n=e;if(!Rk(t,e)){if(sR(t))throw Error(Je(418));e=Mh(n.nextSibling);var i=vo;e&&Rk(t,e)?x9(i,n):(t.flags=t.flags&-4097|2,ni=!1,vo=t)}}else{if(sR(t))throw Error(Je(418));t.flags=t.flags&-4097|2,ni=!1,vo=t}}}function Lk(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;vo=t}function Zw(t){if(t!==vo)return!1;if(!ni)return Lk(t),ni=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!tR(t.type,t.memoizedProps)),e&&(e=oo)){if(sR(t))throw w9(),Error(Je(418));for(;e;)x9(t,e),e=Mh(e.nextSibling)}if(Lk(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Je(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){oo=Mh(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}oo=null}}else oo=vo?Mh(t.stateNode.nextSibling):null;return!0}function w9(){for(var t=oo;t;)t=Mh(t.nextSibling)}function Tg(){oo=vo=null,ni=!1}function N3(t){Na===null?Na=[t]:Na.push(t)}var die=fu.ReactCurrentBatchConfig;function Ba(t,e){if(t&&t.defaultProps){e=fi({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var sA=Zh(null),oA=null,Bm=null,U3=null;function k3(){U3=Bm=oA=null}function z3(t){var e=sA.current;Jn(sA),t._currentValue=e}function aR(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function sg(t,e){oA=t,U3=Bm=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Is=!0),t.firstContext=null)}function ca(t){var e=t._currentValue;if(U3!==t)if(t={context:t,memoizedValue:e,next:null},Bm===null){if(oA===null)throw Error(Je(308));Bm=t,oA.dependencies={lanes:0,firstContext:t}}else Bm=Bm.next=t;return e}var $d=null;function G3(t){$d===null?$d=[t]:$d.push(t)}function _9(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,G3(e)):(n.next=r.next,r.next=n),e.interleaved=n,iu(t,i)}function iu(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Zu=!1;function H3(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function b9(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function qc(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Eh(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,gn&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,iu(t,n)}return r=i.interleaved,r===null?(e.next=e,G3(i)):(e.next=r.next,r.next=e),i.interleaved=e,iu(t,n)}function pS(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,C3(t,n)}}function Ik(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function aA(t,e,n,i){var r=t.updateQueue;Zu=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=c:a.next=c,h.lastBaseUpdate=l))}if(s!==null){var u=r.baseState;o=0,h=c=l=null,a=s;do{var d=a.lane,f=a.eventTime;if((i&d)===d){h!==null&&(h=h.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,v=a;switch(d=e,f=n,v.tag){case 1:if(p=v.payload,typeof p=="function"){u=p.call(f,u,d);break e}u=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=v.payload,d=typeof p=="function"?p.call(f,u,d):p,d==null)break e;u=fi({},u,d);break e;case 2:Zu=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,d=r.effects,d===null?r.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(c=h=f,l=u):h=h.next=f,o|=d;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;d=a,a=d.next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}while(1);if(h===null&&(l=u),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=h,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Pf|=o,t.lanes=o,t.memoizedState=u}}function Bk(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(Je(191,r));r.call(i)}}}var S9=new _8.Component().refs;function lR(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:fi({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var OM={isMounted:function(t){return(t=t._reactInternals)?Wf(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=ms(),r=Th(t),s=qc(i,r);s.payload=e,n!=null&&(s.callback=n),e=Eh(t,s,r),e!==null&&(Xa(e,t,r,i),pS(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=ms(),r=Th(t),s=qc(i,r);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Eh(t,s,r),e!==null&&(Xa(e,t,r,i),pS(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ms(),i=Th(t),r=qc(n,i);r.tag=2,e!=null&&(r.callback=e),e=Eh(t,r,i),e!==null&&(Xa(e,t,i,n),pS(e,t,i))}};function Ok(t,e,n,i,r,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!nx(n,i)||!nx(r,s):!0}function A9(t,e,n){var i=!1,r=Gh,s=e.contextType;return typeof s=="object"&&s!==null?s=ca(s):(r=Ns(e)?Ef:Jr.current,i=e.contextTypes,s=(i=i!=null)?Cg(t,r):Gh),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=OM,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function Fk(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&OM.enqueueReplaceState(e,e.state,null)}function cR(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=S9,H3(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=ca(s):(s=Ns(e)?Ef:Jr.current,r.context=Cg(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(lR(t,e,s,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&OM.enqueueReplaceState(r,r.state,null),aA(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function t0(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Je(309));var i=n.stateNode}if(!i)throw Error(Je(147,t));var r=i,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;a===S9&&(a=r.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Je(284));if(!n._owner)throw Error(Je(290,t))}return t}function $w(t,e){throw t=Object.prototype.toString.call(e),Error(Je(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Nk(t){var e=t._init;return e(t._payload)}function M9(t){function e(m,y){if(t){var w=m.deletions;w===null?(m.deletions=[y],m.flags|=16):w.push(y)}}function n(m,y){if(!t)return null;for(;y!==null;)e(m,y),y=y.sibling;return null}function i(m,y){for(m=new Map;y!==null;)y.key!==null?m.set(y.key,y):m.set(y.index,y),y=y.sibling;return m}function r(m,y){return m=Ph(m,y),m.index=0,m.sibling=null,m}function s(m,y,w){return m.index=w,t?(w=m.alternate,w!==null?(w=w.index,w<y?(m.flags|=2,y):w):(m.flags|=2,y)):(m.flags|=1048576,y)}function o(m){return t&&m.alternate===null&&(m.flags|=2),m}function a(m,y,w,b){return y===null||y.tag!==6?(y=RT(w,m.mode,b),y.return=m,y):(y=r(y,w),y.return=m,y)}function l(m,y,w,b){var A=w.type;return A===Em?h(m,y,w.props.children,b,w.key):y!==null&&(y.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Ju&&Nk(A)===y.type)?(b=r(y,w.props),b.ref=t0(m,y,w),b.return=m,b):(b=wS(w.type,w.key,w.props,null,m.mode,b),b.ref=t0(m,y,w),b.return=m,b)}function c(m,y,w,b){return y===null||y.tag!==4||y.stateNode.containerInfo!==w.containerInfo||y.stateNode.implementation!==w.implementation?(y=LT(w,m.mode,b),y.return=m,y):(y=r(y,w.children||[]),y.return=m,y)}function h(m,y,w,b,A){return y===null||y.tag!==7?(y=hf(w,m.mode,b,A),y.return=m,y):(y=r(y,w),y.return=m,y)}function u(m,y,w){if(typeof y=="string"&&y!==""||typeof y=="number")return y=RT(""+y,m.mode,w),y.return=m,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Hw:return w=wS(y.type,y.key,y.props,null,m.mode,w),w.ref=t0(m,null,y),w.return=m,w;case Mm:return y=LT(y,m.mode,w),y.return=m,y;case Ju:var b=y._init;return u(m,b(y._payload),w)}if(ey(y)||Kv(y))return y=hf(y,m.mode,w,null),y.return=m,y;$w(m,y)}return null}function d(m,y,w,b){var A=y!==null?y.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return A!==null?null:a(m,y,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Hw:return w.key===A?l(m,y,w,b):null;case Mm:return w.key===A?c(m,y,w,b):null;case Ju:return A=w._init,d(m,y,A(w._payload),b)}if(ey(w)||Kv(w))return A!==null?null:h(m,y,w,b,null);$w(m,w)}return null}function f(m,y,w,b,A){if(typeof b=="string"&&b!==""||typeof b=="number")return m=m.get(w)||null,a(y,m,""+b,A);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Hw:return m=m.get(b.key===null?w:b.key)||null,l(y,m,b,A);case Mm:return m=m.get(b.key===null?w:b.key)||null,c(y,m,b,A);case Ju:var S=b._init;return f(m,y,w,S(b._payload),A)}if(ey(b)||Kv(b))return m=m.get(w)||null,h(y,m,b,A,null);$w(y,b)}return null}function p(m,y,w,b){for(var A=null,S=null,T=y,M=y=0,E=null;T!==null&&M<w.length;M++){T.index>M?(E=T,T=null):E=T.sibling;var P=d(m,T,w[M],b);if(P===null){T===null&&(T=E);break}t&&T&&P.alternate===null&&e(m,T),y=s(P,y,M),S===null?A=P:S.sibling=P,S=P,T=E}if(M===w.length)return n(m,T),ni&&Bd(m,M),A;if(T===null){for(;M<w.length;M++)T=u(m,w[M],b),T!==null&&(y=s(T,y,M),S===null?A=T:S.sibling=T,S=T);return ni&&Bd(m,M),A}for(T=i(m,T);M<w.length;M++)E=f(T,m,M,w[M],b),E!==null&&(t&&E.alternate!==null&&T.delete(E.key===null?M:E.key),y=s(E,y,M),S===null?A=E:S.sibling=E,S=E);return t&&T.forEach(function(R){return e(m,R)}),ni&&Bd(m,M),A}function v(m,y,w,b){var A=Kv(w);if(typeof A!="function")throw Error(Je(150));if(w=A.call(w),w==null)throw Error(Je(151));for(var S=A=null,T=y,M=y=0,E=null,P=w.next();T!==null&&!P.done;M++,P=w.next()){T.index>M?(E=T,T=null):E=T.sibling;var R=d(m,T,P.value,b);if(R===null){T===null&&(T=E);break}t&&T&&R.alternate===null&&e(m,T),y=s(R,y,M),S===null?A=R:S.sibling=R,S=R,T=E}if(P.done)return n(m,T),ni&&Bd(m,M),A;if(T===null){for(;!P.done;M++,P=w.next())P=u(m,P.value,b),P!==null&&(y=s(P,y,M),S===null?A=P:S.sibling=P,S=P);return ni&&Bd(m,M),A}for(T=i(m,T);!P.done;M++,P=w.next())P=f(T,m,M,P.value,b),P!==null&&(t&&P.alternate!==null&&T.delete(P.key===null?M:P.key),y=s(P,y,M),S===null?A=P:S.sibling=P,S=P);return t&&T.forEach(function(F){return e(m,F)}),ni&&Bd(m,M),A}function g(m,y,w,b){if(typeof w=="object"&&w!==null&&w.type===Em&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Hw:e:{for(var A=w.key,S=y;S!==null;){if(S.key===A){if(A=w.type,A===Em){if(S.tag===7){n(m,S.sibling),y=r(S,w.props.children),y.return=m,m=y;break e}}else if(S.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Ju&&Nk(A)===S.type){n(m,S.sibling),y=r(S,w.props),y.ref=t0(m,S,w),y.return=m,m=y;break e}n(m,S);break}else e(m,S);S=S.sibling}w.type===Em?(y=hf(w.props.children,m.mode,b,w.key),y.return=m,m=y):(b=wS(w.type,w.key,w.props,null,m.mode,b),b.ref=t0(m,y,w),b.return=m,m=b)}return o(m);case Mm:e:{for(S=w.key;y!==null;){if(y.key===S)if(y.tag===4&&y.stateNode.containerInfo===w.containerInfo&&y.stateNode.implementation===w.implementation){n(m,y.sibling),y=r(y,w.children||[]),y.return=m,m=y;break e}else{n(m,y);break}else e(m,y);y=y.sibling}y=LT(w,m.mode,b),y.return=m,m=y}return o(m);case Ju:return S=w._init,g(m,y,S(w._payload),b)}if(ey(w))return p(m,y,w,b);if(Kv(w))return v(m,y,w,b);$w(m,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,y!==null&&y.tag===6?(n(m,y.sibling),y=r(y,w),y.return=m,m=y):(n(m,y),y=RT(w,m.mode,b),y.return=m,m=y),o(m)):n(m,y)}return g}var Pg=M9(!0),E9=M9(!1),i1={},Wl=Zh(i1),ox=Zh(i1),ax=Zh(i1);function ef(t){if(t===i1)throw Error(Je(174));return t}function V3(t,e){switch(jn(ax,e),jn(ox,t),jn(Wl,i1),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:GD(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=GD(e,t)}Jn(Wl),jn(Wl,e)}function Dg(){Jn(Wl),Jn(ox),Jn(ax)}function C9(t){ef(ax.current);var e=ef(Wl.current),n=GD(e,t.type);e!==n&&(jn(ox,t),jn(Wl,n))}function j3(t){ox.current===t&&(Jn(Wl),Jn(ox))}var si=Zh(0);function lA(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var MT=[];function W3(){for(var t=0;t<MT.length;t++)MT[t]._workInProgressVersionPrimary=null;MT.length=0}var mS=fu.ReactCurrentDispatcher,ET=fu.ReactCurrentBatchConfig,Tf=0,di=null,Ki=null,mr=null,cA=!1,xy=!1,lx=0,fie=0;function Gr(){throw Error(Je(321))}function X3(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ka(t[n],e[n]))return!1;return!0}function Y3(t,e,n,i,r,s){if(Tf=s,di=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,mS.current=t===null||t.memoizedState===null?vie:yie,t=n(i,r),xy){s=0;do{if(xy=!1,lx=0,25<=s)throw Error(Je(301));s+=1,mr=Ki=null,e.updateQueue=null,mS.current=xie,t=n(i,r)}while(xy)}if(mS.current=uA,e=Ki!==null&&Ki.next!==null,Tf=0,mr=Ki=di=null,cA=!1,e)throw Error(Je(300));return t}function q3(){var t=lx!==0;return lx=0,t}function Dl(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mr===null?di.memoizedState=mr=t:mr=mr.next=t,mr}function ua(){if(Ki===null){var t=di.alternate;t=t!==null?t.memoizedState:null}else t=Ki.next;var e=mr===null?di.memoizedState:mr.next;if(e!==null)mr=e,Ki=t;else{if(t===null)throw Error(Je(310));Ki=t,t={memoizedState:Ki.memoizedState,baseState:Ki.baseState,baseQueue:Ki.baseQueue,queue:Ki.queue,next:null},mr===null?di.memoizedState=mr=t:mr=mr.next=t}return mr}function cx(t,e){return typeof e=="function"?e(t):e}function CT(t){var e=ua(),n=e.queue;if(n===null)throw Error(Je(311));n.lastRenderedReducer=t;var i=Ki,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,c=s;do{var h=c.lane;if((Tf&h)===h)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:t(i,c.action);else{var u={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=u,o=i):l=l.next=u,di.lanes|=h,Pf|=h}c=c.next}while(c!==null&&c!==s);l===null?o=i:l.next=a,Ka(i,e.memoizedState)||(Is=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do s=r.lane,di.lanes|=s,Pf|=s,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function TT(t){var e=ua(),n=e.queue;if(n===null)throw Error(Je(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do s=t(s,o.action),o=o.next;while(o!==r);Ka(s,e.memoizedState)||(Is=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function T9(){}function P9(t,e){var n=di,i=ua(),r=e(),s=!Ka(i.memoizedState,r);if(s&&(i.memoizedState=r,Is=!0),i=i.queue,Q3(L9.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||mr!==null&&mr.memoizedState.tag&1){if(n.flags|=2048,ux(9,R9.bind(null,n,i,r,e),void 0,null),wr===null)throw Error(Je(349));Tf&30||D9(n,e,r)}return r}function D9(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=di.updateQueue,e===null?(e={lastEffect:null,stores:null},di.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function R9(t,e,n,i){e.value=n,e.getSnapshot=i,I9(e)&&B9(t)}function L9(t,e,n){return n(function(){I9(e)&&B9(t)})}function I9(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ka(t,n)}catch{return!0}}function B9(t){var e=iu(t,1);e!==null&&Xa(e,t,1,-1)}function Uk(t){var e=Dl();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:cx,lastRenderedState:t},e.queue=t,t=t.dispatch=gie.bind(null,di,t),[e.memoizedState,t]}function ux(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=di.updateQueue,e===null?(e={lastEffect:null,stores:null},di.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function O9(){return ua().memoizedState}function gS(t,e,n,i){var r=Dl();di.flags|=t,r.memoizedState=ux(1|e,n,void 0,i===void 0?null:i)}function FM(t,e,n,i){var r=ua();i=i===void 0?null:i;var s=void 0;if(Ki!==null){var o=Ki.memoizedState;if(s=o.destroy,i!==null&&X3(i,o.deps)){r.memoizedState=ux(e,n,s,i);return}}di.flags|=t,r.memoizedState=ux(1|e,n,s,i)}function kk(t,e){return gS(8390656,8,t,e)}function Q3(t,e){return FM(2048,8,t,e)}function F9(t,e){return FM(4,2,t,e)}function N9(t,e){return FM(4,4,t,e)}function U9(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function k9(t,e,n){return n=n!=null?n.concat([t]):null,FM(4,4,U9.bind(null,e,t),n)}function K3(){}function z9(t,e){var n=ua();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&X3(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function G9(t,e){var n=ua();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&X3(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function H9(t,e,n){return Tf&21?(Ka(n,e)||(n=W8(),di.lanes|=n,Pf|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Is=!0),t.memoizedState=n)}function pie(t,e){var n=Ln;Ln=n!==0&&4>n?n:4,t(!0);var i=ET.transition;ET.transition={};try{t(!1),e()}finally{Ln=n,ET.transition=i}}function V9(){return ua().memoizedState}function mie(t,e,n){var i=Th(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},j9(t))W9(e,n);else if(n=_9(t,e,n,i),n!==null){var r=ms();Xa(n,t,i,r),X9(n,e,i)}}function gie(t,e,n){var i=Th(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(j9(t))W9(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,Ka(a,o)){var l=e.interleaved;l===null?(r.next=r,G3(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=_9(t,e,r,i),n!==null&&(r=ms(),Xa(n,t,i,r),X9(n,e,i))}}function j9(t){var e=t.alternate;return t===di||e!==null&&e===di}function W9(t,e){xy=cA=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function X9(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,C3(t,n)}}var uA={readContext:ca,useCallback:Gr,useContext:Gr,useEffect:Gr,useImperativeHandle:Gr,useInsertionEffect:Gr,useLayoutEffect:Gr,useMemo:Gr,useReducer:Gr,useRef:Gr,useState:Gr,useDebugValue:Gr,useDeferredValue:Gr,useTransition:Gr,useMutableSource:Gr,useSyncExternalStore:Gr,useId:Gr,unstable_isNewReconciler:!1},vie={readContext:ca,useCallback:function(t,e){return Dl().memoizedState=[t,e===void 0?null:e],t},useContext:ca,useEffect:kk,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,gS(4194308,4,U9.bind(null,e,t),n)},useLayoutEffect:function(t,e){return gS(4194308,4,t,e)},useInsertionEffect:function(t,e){return gS(4,2,t,e)},useMemo:function(t,e){var n=Dl();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=Dl();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=mie.bind(null,di,t),[i.memoizedState,t]},useRef:function(t){var e=Dl();return t={current:t},e.memoizedState=t},useState:Uk,useDebugValue:K3,useDeferredValue:function(t){return Dl().memoizedState=t},useTransition:function(){var t=Uk(!1),e=t[0];return t=pie.bind(null,t[1]),Dl().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=di,r=Dl();if(ni){if(n===void 0)throw Error(Je(407));n=n()}else{if(n=e(),wr===null)throw Error(Je(349));Tf&30||D9(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,kk(L9.bind(null,i,s,t),[t]),i.flags|=2048,ux(9,R9.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=Dl(),e=wr.identifierPrefix;if(ni){var n=Gc,i=zc;n=(i&~(1<<32-Wa(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=lx++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=fie++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},yie={readContext:ca,useCallback:z9,useContext:ca,useEffect:Q3,useImperativeHandle:k9,useInsertionEffect:F9,useLayoutEffect:N9,useMemo:G9,useReducer:CT,useRef:O9,useState:function(){return CT(cx)},useDebugValue:K3,useDeferredValue:function(t){var e=ua();return H9(e,Ki.memoizedState,t)},useTransition:function(){var t=CT(cx)[0],e=ua().memoizedState;return[t,e]},useMutableSource:T9,useSyncExternalStore:P9,useId:V9,unstable_isNewReconciler:!1},xie={readContext:ca,useCallback:z9,useContext:ca,useEffect:Q3,useImperativeHandle:k9,useInsertionEffect:F9,useLayoutEffect:N9,useMemo:G9,useReducer:TT,useRef:O9,useState:function(){return TT(cx)},useDebugValue:K3,useDeferredValue:function(t){var e=ua();return Ki===null?e.memoizedState=t:H9(e,Ki.memoizedState,t)},useTransition:function(){var t=TT(cx)[0],e=ua().memoizedState;return[t,e]},useMutableSource:T9,useSyncExternalStore:P9,useId:V9,unstable_isNewReconciler:!1};function Rg(t,e){try{var n="",i=e;do n+=Yte(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function PT(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function uR(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var wie=typeof WeakMap=="function"?WeakMap:Map;function Y9(t,e,n){n=qc(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){dA||(dA=!0,wR=i),uR(t,e)},n}function q9(t,e,n){n=qc(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){uR(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){uR(t,e),typeof i!="function"&&(Ch===null?Ch=new Set([this]):Ch.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function zk(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new wie;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=Bie.bind(null,t,e,n),e.then(t,t))}function Gk(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Hk(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=qc(-1,1),e.tag=2,Eh(n,e,1))),n.lanes|=1),t)}var _ie=fu.ReactCurrentOwner,Is=!1;function ds(t,e,n,i){e.child=t===null?E9(e,null,n,i):Pg(e,t.child,n,i)}function Vk(t,e,n,i,r){n=n.render;var s=e.ref;return sg(e,r),i=Y3(t,e,n,i,s,r),n=q3(),t!==null&&!Is?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,ru(t,e,r)):(ni&&n&&O3(e),e.flags|=1,ds(t,e,i,r),e.child)}function jk(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!rB(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,Q9(t,e,s,i,r)):(t=wS(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&r)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:nx,n(o,i)&&t.ref===e.ref)return ru(t,e,r)}return e.flags|=1,t=Ph(s,i),t.ref=e.ref,t.return=e,e.child=t}function Q9(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(nx(s,i)&&t.ref===e.ref)if(Is=!1,e.pendingProps=i=s,(t.lanes&r)!==0)t.flags&131072&&(Is=!0);else return e.lanes=t.lanes,ru(t,e,r)}return hR(t,e,n,i,r)}function K9(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},jn(Fm,eo),eo|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,jn(Fm,eo),eo|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,jn(Fm,eo),eo|=i}else s!==null?(i=s.baseLanes|n,e.memoizedState=null):i=n,jn(Fm,eo),eo|=i;return ds(t,e,r,n),e.child}function J9(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function hR(t,e,n,i,r){var s=Ns(n)?Ef:Jr.current;return s=Cg(e,s),sg(e,r),n=Y3(t,e,n,i,s,r),i=q3(),t!==null&&!Is?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,ru(t,e,r)):(ni&&i&&O3(e),e.flags|=1,ds(t,e,n,r),e.child)}function Wk(t,e,n,i,r){if(Ns(n)){var s=!0;nA(e)}else s=!1;if(sg(e,r),e.stateNode===null)vS(t,e),A9(e,n,i),cR(e,n,i,r),i=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=ca(c):(c=Ns(n)?Ef:Jr.current,c=Cg(e,c));var h=n.getDerivedStateFromProps,u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";u||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==c)&&Fk(e,o,i,c),Zu=!1;var d=e.memoizedState;o.state=d,aA(e,i,o,r),l=e.memoizedState,a!==i||d!==l||Fs.current||Zu?(typeof h=="function"&&(lR(e,n,h,i),l=e.memoizedState),(a=Zu||Ok(e,n,a,i,d,l,c))?(u||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,b9(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Ba(e.type,a),o.props=c,u=e.pendingProps,d=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=ca(l):(l=Ns(n)?Ef:Jr.current,l=Cg(e,l));var f=n.getDerivedStateFromProps;(h=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==u||d!==l)&&Fk(e,o,i,l),Zu=!1,d=e.memoizedState,o.state=d,aA(e,i,o,r);var p=e.memoizedState;a!==u||d!==p||Fs.current||Zu?(typeof f=="function"&&(lR(e,n,f,i),p=e.memoizedState),(c=Zu||Ok(e,n,c,i,d,p,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=p),o.props=i,o.state=p,o.context=l,i=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),i=!1)}return dR(t,e,n,i,s,r)}function dR(t,e,n,i,r,s){J9(t,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&Dk(e,n,!1),ru(t,e,s);i=e.stateNode,_ie.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&o?(e.child=Pg(e,t.child,null,s),e.child=Pg(e,null,a,s)):ds(t,e,a,s),e.memoizedState=i.state,r&&Dk(e,n,!0),e.child}function Z9(t){var e=t.stateNode;e.pendingContext?Pk(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Pk(t,e.context,!1),V3(t,e.containerInfo)}function Xk(t,e,n,i,r){return Tg(),N3(r),e.flags|=256,ds(t,e,n,i),e.child}var fR={dehydrated:null,treeContext:null,retryLane:0};function pR(t){return{baseLanes:t,cachePool:null,transitions:null}}function $9(t,e,n){var i=e.pendingProps,r=si.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),jn(si,r&1),t===null)return oR(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,t=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=kM(o,i,0,null),t=hf(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=pR(n),e.memoizedState=fR,t):J3(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return bie(t,e,o,i,a,r,n);if(s){s=i.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=Ph(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=Ph(a,s):(s=hf(s,o,n,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=t.child.memoizedState,o=o===null?pR(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=fR,i}return s=t.child,t=s.sibling,i=Ph(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function J3(t,e){return e=kM({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function e_(t,e,n,i){return i!==null&&N3(i),Pg(e,t.child,null,n),t=J3(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function bie(t,e,n,i,r,s,o){if(n)return e.flags&256?(e.flags&=-257,i=PT(Error(Je(422))),e_(t,e,o,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=kM({mode:"visible",children:i.children},r,0,null),s=hf(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&Pg(e,t.child,null,o),e.child.memoizedState=pR(o),e.memoizedState=fR,s);if(!(e.mode&1))return e_(t,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(Je(419)),i=PT(s,i,void 0),e_(t,e,o,i)}if(a=(o&t.childLanes)!==0,Is||a){if(i=wr,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,iu(t,r),Xa(i,t,r,-1))}return iB(),i=PT(Error(Je(421))),e_(t,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=Oie.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,oo=Mh(r.nextSibling),vo=e,ni=!0,Na=null,t!==null&&(Zo[$o++]=zc,Zo[$o++]=Gc,Zo[$o++]=Cf,zc=t.id,Gc=t.overflow,Cf=e),e=J3(e,i.children),e.flags|=4096,e)}function Yk(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),aR(t.return,e,n)}function DT(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function eX(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(ds(t,e,i.children,n),i=si.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Yk(t,n,e);else if(t.tag===19)Yk(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(jn(si,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&lA(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),DT(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&lA(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}DT(e,!0,n,null,s);break;case"together":DT(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function vS(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ru(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Pf|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Je(153));if(e.child!==null){for(t=e.child,n=Ph(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ph(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Sie(t,e,n){switch(e.tag){case 3:Z9(e),Tg();break;case 5:C9(e);break;case 1:Ns(e.type)&&nA(e);break;case 4:V3(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;jn(sA,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(jn(si,si.current&1),e.flags|=128,null):n&e.child.childLanes?$9(t,e,n):(jn(si,si.current&1),t=ru(t,e,n),t!==null?t.sibling:null);jn(si,si.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return eX(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),jn(si,si.current),i)break;return null;case 22:case 23:return e.lanes=0,K9(t,e,n)}return ru(t,e,n)}var tX,mR,nX,iX;tX=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};mR=function(){};nX=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,ef(Wl.current);var s=null;switch(n){case"input":r=ND(t,r),i=ND(t,i),s=[];break;case"select":r=fi({},r,{value:void 0}),i=fi({},i,{value:void 0}),s=[];break;case"textarea":r=zD(t,r),i=zD(t,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=eA)}HD(n,i);var o;n=null;for(c in r)if(!i.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Qy.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in i){var l=i[c];if(a=r!=null?r[c]:void 0,i.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Qy.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Yn("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};iX=function(t,e,n,i){n!==i&&(e.flags|=4)};function n0(t,e){if(!ni)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Hr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function Aie(t,e,n){var i=e.pendingProps;switch(F3(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hr(e),null;case 1:return Ns(e.type)&&tA(),Hr(e),null;case 3:return i=e.stateNode,Dg(),Jn(Fs),Jn(Jr),W3(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(Zw(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Na!==null&&(SR(Na),Na=null))),mR(t,e),Hr(e),null;case 5:j3(e);var r=ef(ax.current);if(n=e.type,t!==null&&e.stateNode!=null)nX(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(Je(166));return Hr(e),null}if(t=ef(Wl.current),Zw(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[Ol]=e,i[sx]=s,t=(e.mode&1)!==0,n){case"dialog":Yn("cancel",i),Yn("close",i);break;case"iframe":case"object":case"embed":Yn("load",i);break;case"video":case"audio":for(r=0;r<ny.length;r++)Yn(ny[r],i);break;case"source":Yn("error",i);break;case"img":case"image":case"link":Yn("error",i),Yn("load",i);break;case"details":Yn("toggle",i);break;case"input":nk(i,s),Yn("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Yn("invalid",i);break;case"textarea":rk(i,s),Yn("invalid",i)}HD(n,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&Jw(i.textContent,a,t),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Jw(i.textContent,a,t),r=["children",""+a]):Qy.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Yn("scroll",i)}switch(n){case"input":Vw(i),ik(i,s,!0);break;case"textarea":Vw(i),sk(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=eA)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=D8(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=o.createElement(n,{is:i.is}):(t=o.createElement(n),n==="select"&&(o=t,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):t=o.createElementNS(t,n),t[Ol]=e,t[sx]=i,tX(t,e,!1,!1),e.stateNode=t;e:{switch(o=VD(n,i),n){case"dialog":Yn("cancel",t),Yn("close",t),r=i;break;case"iframe":case"object":case"embed":Yn("load",t),r=i;break;case"video":case"audio":for(r=0;r<ny.length;r++)Yn(ny[r],t);r=i;break;case"source":Yn("error",t),r=i;break;case"img":case"image":case"link":Yn("error",t),Yn("load",t),r=i;break;case"details":Yn("toggle",t),r=i;break;case"input":nk(t,i),r=ND(t,i),Yn("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=fi({},i,{value:void 0}),Yn("invalid",t);break;case"textarea":rk(t,i),r=zD(t,i),Yn("invalid",t);break;default:r=i}HD(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?I8(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&R8(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Ky(t,l):typeof l=="number"&&Ky(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Qy.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Yn("scroll",t):l!=null&&_3(t,s,l,o))}switch(n){case"input":Vw(t),ik(t,i,!1);break;case"textarea":Vw(t),sk(t);break;case"option":i.value!=null&&t.setAttribute("value",""+zh(i.value));break;case"select":t.multiple=!!i.multiple,s=i.value,s!=null?tg(t,!!i.multiple,s,!1):i.defaultValue!=null&&tg(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=eA)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Hr(e),null;case 6:if(t&&e.stateNode!=null)iX(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(Je(166));if(n=ef(ax.current),ef(Wl.current),Zw(e)){if(i=e.stateNode,n=e.memoizedProps,i[Ol]=e,(s=i.nodeValue!==n)&&(t=vo,t!==null))switch(t.tag){case 3:Jw(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Jw(i.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[Ol]=e,e.stateNode=i}return Hr(e),null;case 13:if(Jn(si),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ni&&oo!==null&&e.mode&1&&!(e.flags&128))w9(),Tg(),e.flags|=98560,s=!1;else if(s=Zw(e),i!==null&&i.dehydrated!==null){if(t===null){if(!s)throw Error(Je(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Je(317));s[Ol]=e}else Tg(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Hr(e),s=!1}else Na!==null&&(SR(Na),Na=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||si.current&1?$i===0&&($i=3):iB())),e.updateQueue!==null&&(e.flags|=4),Hr(e),null);case 4:return Dg(),mR(t,e),t===null&&ix(e.stateNode.containerInfo),Hr(e),null;case 10:return z3(e.type._context),Hr(e),null;case 17:return Ns(e.type)&&tA(),Hr(e),null;case 19:if(Jn(si),s=e.memoizedState,s===null)return Hr(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)n0(s,!1);else{if($i!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=lA(t),o!==null){for(e.flags|=128,n0(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)s=n,t=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return jn(si,si.current&1|2),e.child}t=t.sibling}s.tail!==null&&Pi()>Lg&&(e.flags|=128,i=!0,n0(s,!1),e.lanes=4194304)}else{if(!i)if(t=lA(o),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),n0(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ni)return Hr(e),null}else 2*Pi()-s.renderingStartTime>Lg&&n!==1073741824&&(e.flags|=128,i=!0,n0(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Pi(),e.sibling=null,n=si.current,jn(si,i?n&1|2:n&1),e):(Hr(e),null);case 22:case 23:return nB(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?eo&1073741824&&(Hr(e),e.subtreeFlags&6&&(e.flags|=8192)):Hr(e),null;case 24:return null;case 25:return null}throw Error(Je(156,e.tag))}function Mie(t,e){switch(F3(e),e.tag){case 1:return Ns(e.type)&&tA(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Dg(),Jn(Fs),Jn(Jr),W3(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return j3(e),null;case 13:if(Jn(si),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Je(340));Tg()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Jn(si),null;case 4:return Dg(),null;case 10:return z3(e.type._context),null;case 22:case 23:return nB(),null;case 24:return null;default:return null}}var t_=!1,qr=!1,Eie=typeof WeakSet=="function"?WeakSet:Set,pt=null;function Om(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){vi(t,e,i)}else n.current=null}function gR(t,e,n){try{n()}catch(i){vi(t,e,i)}}var qk=!1;function Cie(t,e){if($D=JS,t=a9(),B3(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,h=0,u=t,d=null;t:for(;;){for(var f;u!==n||r!==0&&u.nodeType!==3||(a=o+r),u!==s||i!==0&&u.nodeType!==3||(l=o+i),u.nodeType===3&&(o+=u.nodeValue.length),(f=u.firstChild)!==null;)d=u,u=f;for(;;){if(u===t)break t;if(d===n&&++c===r&&(a=o),d===s&&++h===i&&(l=o),(f=u.nextSibling)!==null)break;u=d,d=u.parentNode}u=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(eR={focusedElem:t,selectionRange:n},JS=!1,pt=e;pt!==null;)if(e=pt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,pt=t;else for(;pt!==null;){e=pt;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var v=p.memoizedProps,g=p.memoizedState,m=e.stateNode,y=m.getSnapshotBeforeUpdate(e.elementType===e.type?v:Ba(e.type,v),g);m.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Je(163))}}catch(b){vi(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,pt=t;break}pt=e.return}return p=qk,qk=!1,p}function wy(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&gR(e,n,s)}r=r.next}while(r!==i)}}function NM(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function vR(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function rX(t){var e=t.alternate;e!==null&&(t.alternate=null,rX(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ol],delete e[sx],delete e[iR],delete e[cie],delete e[uie])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function sX(t){return t.tag===5||t.tag===3||t.tag===4}function Qk(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||sX(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function yR(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=eA));else if(i!==4&&(t=t.child,t!==null))for(yR(t,e,n),t=t.sibling;t!==null;)yR(t,e,n),t=t.sibling}function xR(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(xR(t,e,n),t=t.sibling;t!==null;)xR(t,e,n),t=t.sibling}var Cr=null,Fa=!1;function Cu(t,e,n){for(n=n.child;n!==null;)oX(t,e,n),n=n.sibling}function oX(t,e,n){if(jl&&typeof jl.onCommitFiberUnmount=="function")try{jl.onCommitFiberUnmount(PM,n)}catch{}switch(n.tag){case 5:qr||Om(n,e);case 6:var i=Cr,r=Fa;Cr=null,Cu(t,e,n),Cr=i,Fa=r,Cr!==null&&(Fa?(t=Cr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Cr.removeChild(n.stateNode));break;case 18:Cr!==null&&(Fa?(t=Cr,n=n.stateNode,t.nodeType===8?ST(t.parentNode,n):t.nodeType===1&&ST(t,n),ex(t)):ST(Cr,n.stateNode));break;case 4:i=Cr,r=Fa,Cr=n.stateNode.containerInfo,Fa=!0,Cu(t,e,n),Cr=i,Fa=r;break;case 0:case 11:case 14:case 15:if(!qr&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&gR(n,e,o),r=r.next}while(r!==i)}Cu(t,e,n);break;case 1:if(!qr&&(Om(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){vi(n,e,a)}Cu(t,e,n);break;case 21:Cu(t,e,n);break;case 22:n.mode&1?(qr=(i=qr)||n.memoizedState!==null,Cu(t,e,n),qr=i):Cu(t,e,n);break;default:Cu(t,e,n)}}function Kk(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new Eie),e.forEach(function(i){var r=Fie.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function _a(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Cr=a.stateNode,Fa=!1;break e;case 3:Cr=a.stateNode.containerInfo,Fa=!0;break e;case 4:Cr=a.stateNode.containerInfo,Fa=!0;break e}a=a.return}if(Cr===null)throw Error(Je(160));oX(s,o,r),Cr=null,Fa=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){vi(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)aX(e,t),e=e.sibling}function aX(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(_a(e,t),gl(t),i&4){try{wy(3,t,t.return),NM(3,t)}catch(v){vi(t,t.return,v)}try{wy(5,t,t.return)}catch(v){vi(t,t.return,v)}}break;case 1:_a(e,t),gl(t),i&512&&n!==null&&Om(n,n.return);break;case 5:if(_a(e,t),gl(t),i&512&&n!==null&&Om(n,n.return),t.flags&32){var r=t.stateNode;try{Ky(r,"")}catch(v){vi(t,t.return,v)}}if(i&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&T8(r,s),VD(a,o);var c=VD(a,s);for(o=0;o<l.length;o+=2){var h=l[o],u=l[o+1];h==="style"?I8(r,u):h==="dangerouslySetInnerHTML"?R8(r,u):h==="children"?Ky(r,u):_3(r,h,u,c)}switch(a){case"input":UD(r,s);break;case"textarea":P8(r,s);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?tg(r,!!s.multiple,f,!1):d!==!!s.multiple&&(s.defaultValue!=null?tg(r,!!s.multiple,s.defaultValue,!0):tg(r,!!s.multiple,s.multiple?[]:"",!1))}r[sx]=s}catch(v){vi(t,t.return,v)}}break;case 6:if(_a(e,t),gl(t),i&4){if(t.stateNode===null)throw Error(Je(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(v){vi(t,t.return,v)}}break;case 3:if(_a(e,t),gl(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{ex(e.containerInfo)}catch(v){vi(t,t.return,v)}break;case 4:_a(e,t),gl(t);break;case 13:_a(e,t),gl(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(eB=Pi())),i&4&&Kk(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(qr=(c=qr)||h,_a(e,t),qr=c):_a(e,t),gl(t),i&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!h&&t.mode&1)for(pt=t,h=t.child;h!==null;){for(u=pt=h;pt!==null;){switch(d=pt,f=d.child,d.tag){case 0:case 11:case 14:case 15:wy(4,d,d.return);break;case 1:Om(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){i=d,n=d.return;try{e=i,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(v){vi(i,n,v)}}break;case 5:Om(d,d.return);break;case 22:if(d.memoizedState!==null){Zk(u);continue}}f!==null?(f.return=d,pt=f):Zk(u)}h=h.sibling}e:for(h=null,u=t;;){if(u.tag===5){if(h===null){h=u;try{r=u.stateNode,c?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=u.stateNode,l=u.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=L8("display",o))}catch(v){vi(t,t.return,v)}}}else if(u.tag===6){if(h===null)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(v){vi(t,t.return,v)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===t)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===t)break e;for(;u.sibling===null;){if(u.return===null||u.return===t)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:_a(e,t),gl(t),i&4&&Kk(t);break;case 21:break;default:_a(e,t),gl(t)}}function gl(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(sX(n)){var i=n;break e}n=n.return}throw Error(Je(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Ky(r,""),i.flags&=-33);var s=Qk(t);xR(t,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=Qk(t);yR(t,a,o);break;default:throw Error(Je(161))}}catch(l){vi(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Tie(t,e,n){pt=t,lX(t)}function lX(t,e,n){for(var i=(t.mode&1)!==0;pt!==null;){var r=pt,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||t_;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||qr;a=t_;var c=qr;if(t_=o,(qr=l)&&!c)for(pt=r;pt!==null;)o=pt,l=o.child,o.tag===22&&o.memoizedState!==null?$k(r):l!==null?(l.return=o,pt=l):$k(r);for(;s!==null;)pt=s,lX(s),s=s.sibling;pt=r,t_=a,qr=c}Jk(t)}else r.subtreeFlags&8772&&s!==null?(s.return=r,pt=s):Jk(t)}}function Jk(t){for(;pt!==null;){var e=pt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:qr||NM(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!qr)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Ba(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Bk(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Bk(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var h=c.memoizedState;if(h!==null){var u=h.dehydrated;u!==null&&ex(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Je(163))}qr||e.flags&512&&vR(e)}catch(d){vi(e,e.return,d)}}if(e===t){pt=null;break}if(n=e.sibling,n!==null){n.return=e.return,pt=n;break}pt=e.return}}function Zk(t){for(;pt!==null;){var e=pt;if(e===t){pt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,pt=n;break}pt=e.return}}function $k(t){for(;pt!==null;){var e=pt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{NM(4,e)}catch(l){vi(e,n,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){vi(e,r,l)}}var s=e.return;try{vR(e)}catch(l){vi(e,s,l)}break;case 5:var o=e.return;try{vR(e)}catch(l){vi(e,o,l)}}}catch(l){vi(e,e.return,l)}if(e===t){pt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,pt=a;break}pt=e.return}}var Pie=Math.ceil,hA=fu.ReactCurrentDispatcher,Z3=fu.ReactCurrentOwner,sa=fu.ReactCurrentBatchConfig,gn=0,wr=null,zi=null,Lr=0,eo=0,Fm=Zh(0),$i=0,hx=null,Pf=0,UM=0,$3=0,_y=null,Cs=null,eB=0,Lg=1/0,Fc=null,dA=!1,wR=null,Ch=null,n_=!1,uh=null,fA=0,by=0,_R=null,yS=-1,xS=0;function ms(){return gn&6?Pi():yS!==-1?yS:yS=Pi()}function Th(t){return t.mode&1?gn&2&&Lr!==0?Lr&-Lr:die.transition!==null?(xS===0&&(xS=W8()),xS):(t=Ln,t!==0||(t=window.event,t=t===void 0?16:Z8(t.type)),t):1}function Xa(t,e,n,i){if(50<by)throw by=0,_R=null,Error(Je(185));e1(t,n,i),(!(gn&2)||t!==wr)&&(t===wr&&(!(gn&2)&&(UM|=n),$i===4&&sh(t,Lr)),Us(t,i),n===1&&gn===0&&!(e.mode&1)&&(Lg=Pi()+500,BM&&$h()))}function Us(t,e){var n=t.callbackNode;dne(t,e);var i=KS(t,t===wr?Lr:0);if(i===0)n!==null&&lk(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&lk(n),e===1)t.tag===0?hie(ez.bind(null,t)):v9(ez.bind(null,t)),aie(function(){!(gn&6)&&$h()}),n=null;else{switch(X8(i)){case 1:n=E3;break;case 4:n=V8;break;case 16:n=QS;break;case 536870912:n=j8;break;default:n=QS}n=gX(n,cX.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function cX(t,e){if(yS=-1,xS=0,gn&6)throw Error(Je(327));var n=t.callbackNode;if(og()&&t.callbackNode!==n)return null;var i=KS(t,t===wr?Lr:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=pA(t,i);else{e=i;var r=gn;gn|=2;var s=hX();(wr!==t||Lr!==e)&&(Fc=null,Lg=Pi()+500,uf(t,e));do try{Lie();break}catch(a){uX(t,a)}while(1);k3(),hA.current=s,gn=r,zi!==null?e=0:(wr=null,Lr=0,e=$i)}if(e!==0){if(e===2&&(r=qD(t),r!==0&&(i=r,e=bR(t,r))),e===1)throw n=hx,uf(t,0),sh(t,i),Us(t,Pi()),n;if(e===6)sh(t,i);else{if(r=t.current.alternate,!(i&30)&&!Die(r)&&(e=pA(t,i),e===2&&(s=qD(t),s!==0&&(i=s,e=bR(t,s))),e===1))throw n=hx,uf(t,0),sh(t,i),Us(t,Pi()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(Je(345));case 2:Od(t,Cs,Fc);break;case 3:if(sh(t,i),(i&130023424)===i&&(e=eB+500-Pi(),10<e)){if(KS(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){ms(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=nR(Od.bind(null,t,Cs,Fc),e);break}Od(t,Cs,Fc);break;case 4:if(sh(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var o=31-Wa(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=Pi()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Pie(i/1960))-i,10<i){t.timeoutHandle=nR(Od.bind(null,t,Cs,Fc),i);break}Od(t,Cs,Fc);break;case 5:Od(t,Cs,Fc);break;default:throw Error(Je(329))}}}return Us(t,Pi()),t.callbackNode===n?cX.bind(null,t):null}function bR(t,e){var n=_y;return t.current.memoizedState.isDehydrated&&(uf(t,e).flags|=256),t=pA(t,e),t!==2&&(e=Cs,Cs=n,e!==null&&SR(e)),t}function SR(t){Cs===null?Cs=t:Cs.push.apply(Cs,t)}function Die(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!Ka(s(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function sh(t,e){for(e&=~$3,e&=~UM,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Wa(e),i=1<<n;t[n]=-1,e&=~i}}function ez(t){if(gn&6)throw Error(Je(327));og();var e=KS(t,0);if(!(e&1))return Us(t,Pi()),null;var n=pA(t,e);if(t.tag!==0&&n===2){var i=qD(t);i!==0&&(e=i,n=bR(t,i))}if(n===1)throw n=hx,uf(t,0),sh(t,e),Us(t,Pi()),n;if(n===6)throw Error(Je(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Od(t,Cs,Fc),Us(t,Pi()),null}function tB(t,e){var n=gn;gn|=1;try{return t(e)}finally{gn=n,gn===0&&(Lg=Pi()+500,BM&&$h())}}function Df(t){uh!==null&&uh.tag===0&&!(gn&6)&&og();var e=gn;gn|=1;var n=sa.transition,i=Ln;try{if(sa.transition=null,Ln=1,t)return t()}finally{Ln=i,sa.transition=n,gn=e,!(gn&6)&&$h()}}function nB(){eo=Fm.current,Jn(Fm)}function uf(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,oie(n)),zi!==null)for(n=zi.return;n!==null;){var i=n;switch(F3(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&tA();break;case 3:Dg(),Jn(Fs),Jn(Jr),W3();break;case 5:j3(i);break;case 4:Dg();break;case 13:Jn(si);break;case 19:Jn(si);break;case 10:z3(i.type._context);break;case 22:case 23:nB()}n=n.return}if(wr=t,zi=t=Ph(t.current,null),Lr=eo=e,$i=0,hx=null,$3=UM=Pf=0,Cs=_y=null,$d!==null){for(e=0;e<$d.length;e++)if(n=$d[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}n.pending=i}$d=null}return t}function uX(t,e){do{var n=zi;try{if(k3(),mS.current=uA,cA){for(var i=di.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}cA=!1}if(Tf=0,mr=Ki=di=null,xy=!1,lx=0,Z3.current=null,n===null||n.return===null){$i=1,hx=e,zi=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Lr,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,h=a,u=h.tag;if(!(h.mode&1)&&(u===0||u===11||u===15)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=Gk(o);if(f!==null){f.flags&=-257,Hk(f,o,a,s,e),f.mode&1&&zk(s,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var v=new Set;v.add(l),e.updateQueue=v}else p.add(l);break e}else{if(!(e&1)){zk(s,c,e),iB();break e}l=Error(Je(426))}}else if(ni&&a.mode&1){var g=Gk(o);if(g!==null){!(g.flags&65536)&&(g.flags|=256),Hk(g,o,a,s,e),N3(Rg(l,a));break e}}s=l=Rg(l,a),$i!==4&&($i=2),_y===null?_y=[s]:_y.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var m=Y9(s,l,e);Ik(s,m);break e;case 1:a=l;var y=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Ch===null||!Ch.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var b=q9(s,a,e);Ik(s,b);break e}}s=s.return}while(s!==null)}fX(n)}catch(A){e=A,zi===n&&n!==null&&(zi=n=n.return);continue}break}while(1)}function hX(){var t=hA.current;return hA.current=uA,t===null?uA:t}function iB(){($i===0||$i===3||$i===2)&&($i=4),wr===null||!(Pf&268435455)&&!(UM&268435455)||sh(wr,Lr)}function pA(t,e){var n=gn;gn|=2;var i=hX();(wr!==t||Lr!==e)&&(Fc=null,uf(t,e));do try{Rie();break}catch(r){uX(t,r)}while(1);if(k3(),gn=n,hA.current=i,zi!==null)throw Error(Je(261));return wr=null,Lr=0,$i}function Rie(){for(;zi!==null;)dX(zi)}function Lie(){for(;zi!==null&&!ine();)dX(zi)}function dX(t){var e=mX(t.alternate,t,eo);t.memoizedProps=t.pendingProps,e===null?fX(t):zi=e,Z3.current=null}function fX(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Mie(n,e),n!==null){n.flags&=32767,zi=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{$i=6,zi=null;return}}else if(n=Aie(n,e,eo),n!==null){zi=n;return}if(e=e.sibling,e!==null){zi=e;return}zi=e=t}while(e!==null);$i===0&&($i=5)}function Od(t,e,n){var i=Ln,r=sa.transition;try{sa.transition=null,Ln=1,Iie(t,e,n,i)}finally{sa.transition=r,Ln=i}return null}function Iie(t,e,n,i){do og();while(uh!==null);if(gn&6)throw Error(Je(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Je(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(fne(t,s),t===wr&&(zi=wr=null,Lr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||n_||(n_=!0,gX(QS,function(){return og(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=sa.transition,sa.transition=null;var o=Ln;Ln=1;var a=gn;gn|=4,Z3.current=null,Cie(t,n),aX(n,t),$ne(eR),JS=!!$D,eR=$D=null,t.current=n,Tie(n),rne(),gn=a,Ln=o,sa.transition=s}else t.current=n;if(n_&&(n_=!1,uh=t,fA=r),s=t.pendingLanes,s===0&&(Ch=null),ane(n.stateNode),Us(t,Pi()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(dA)throw dA=!1,t=wR,wR=null,t;return fA&1&&t.tag!==0&&og(),s=t.pendingLanes,s&1?t===_R?by++:(by=0,_R=t):by=0,$h(),null}function og(){if(uh!==null){var t=X8(fA),e=sa.transition,n=Ln;try{if(sa.transition=null,Ln=16>t?16:t,uh===null)var i=!1;else{if(t=uh,uh=null,fA=0,gn&6)throw Error(Je(331));var r=gn;for(gn|=4,pt=t.current;pt!==null;){var s=pt,o=s.child;if(pt.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(pt=c;pt!==null;){var h=pt;switch(h.tag){case 0:case 11:case 15:wy(8,h,s)}var u=h.child;if(u!==null)u.return=h,pt=u;else for(;pt!==null;){h=pt;var d=h.sibling,f=h.return;if(rX(h),h===c){pt=null;break}if(d!==null){d.return=f,pt=d;break}pt=f}}}var p=s.alternate;if(p!==null){var v=p.child;if(v!==null){p.child=null;do{var g=v.sibling;v.sibling=null,v=g}while(v!==null)}}pt=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,pt=o;else e:for(;pt!==null;){if(s=pt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:wy(9,s,s.return)}var m=s.sibling;if(m!==null){m.return=s.return,pt=m;break e}pt=s.return}}var y=t.current;for(pt=y;pt!==null;){o=pt;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,pt=w;else e:for(o=y;pt!==null;){if(a=pt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:NM(9,a)}}catch(A){vi(a,a.return,A)}if(a===o){pt=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,pt=b;break e}pt=a.return}}if(gn=r,$h(),jl&&typeof jl.onPostCommitFiberRoot=="function")try{jl.onPostCommitFiberRoot(PM,t)}catch{}i=!0}return i}finally{Ln=n,sa.transition=e}}return!1}function tz(t,e,n){e=Rg(n,e),e=Y9(t,e,1),t=Eh(t,e,1),e=ms(),t!==null&&(e1(t,1,e),Us(t,e))}function vi(t,e,n){if(t.tag===3)tz(t,t,n);else for(;e!==null;){if(e.tag===3){tz(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Ch===null||!Ch.has(i))){t=Rg(n,t),t=q9(e,t,1),e=Eh(e,t,1),t=ms(),e!==null&&(e1(e,1,t),Us(e,t));break}}e=e.return}}function Bie(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=ms(),t.pingedLanes|=t.suspendedLanes&n,wr===t&&(Lr&n)===n&&($i===4||$i===3&&(Lr&130023424)===Lr&&500>Pi()-eB?uf(t,0):$3|=n),Us(t,e)}function pX(t,e){e===0&&(t.mode&1?(e=Xw,Xw<<=1,!(Xw&130023424)&&(Xw=4194304)):e=1);var n=ms();t=iu(t,e),t!==null&&(e1(t,e,n),Us(t,n))}function Oie(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),pX(t,n)}function Fie(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(Je(314))}i!==null&&i.delete(e),pX(t,n)}var mX;mX=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Fs.current)Is=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Is=!1,Sie(t,e,n);Is=!!(t.flags&131072)}else Is=!1,ni&&e.flags&1048576&&y9(e,rA,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;vS(t,e),t=e.pendingProps;var r=Cg(e,Jr.current);sg(e,n),r=Y3(null,e,i,t,r,n);var s=q3();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ns(i)?(s=!0,nA(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,H3(e),r.updater=OM,e.stateNode=r,r._reactInternals=e,cR(e,i,t,n),e=dR(null,e,i,!0,s,n)):(e.tag=0,ni&&s&&O3(e),ds(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(vS(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=Uie(i),t=Ba(i,t),r){case 0:e=hR(null,e,i,t,n);break e;case 1:e=Wk(null,e,i,t,n);break e;case 11:e=Vk(null,e,i,t,n);break e;case 14:e=jk(null,e,i,Ba(i.type,t),n);break e}throw Error(Je(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ba(i,r),hR(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ba(i,r),Wk(t,e,i,r,n);case 3:e:{if(Z9(e),t===null)throw Error(Je(387));i=e.pendingProps,s=e.memoizedState,r=s.element,b9(t,e),aA(e,i,null,n);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=Rg(Error(Je(423)),e),e=Xk(t,e,i,n,r);break e}else if(i!==r){r=Rg(Error(Je(424)),e),e=Xk(t,e,i,n,r);break e}else for(oo=Mh(e.stateNode.containerInfo.firstChild),vo=e,ni=!0,Na=null,n=E9(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Tg(),i===r){e=ru(t,e,n);break e}ds(t,e,i,n)}e=e.child}return e;case 5:return C9(e),t===null&&oR(e),i=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,o=r.children,tR(i,r)?o=null:s!==null&&tR(i,s)&&(e.flags|=32),J9(t,e),ds(t,e,o,n),e.child;case 6:return t===null&&oR(e),null;case 13:return $9(t,e,n);case 4:return V3(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=Pg(e,null,i,n):ds(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ba(i,r),Vk(t,e,i,r,n);case 7:return ds(t,e,e.pendingProps,n),e.child;case 8:return ds(t,e,e.pendingProps.children,n),e.child;case 12:return ds(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,jn(sA,i._currentValue),i._currentValue=o,s!==null)if(Ka(s.value,o)){if(s.children===r.children&&!Fs.current){e=ru(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=qc(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var h=c.pending;h===null?l.next=l:(l.next=h.next,h.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),aR(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Je(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),aR(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}ds(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,sg(e,n),r=ca(r),i=i(r),e.flags|=1,ds(t,e,i,n),e.child;case 14:return i=e.type,r=Ba(i,e.pendingProps),r=Ba(i.type,r),jk(t,e,i,r,n);case 15:return Q9(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ba(i,r),vS(t,e),e.tag=1,Ns(i)?(t=!0,nA(e)):t=!1,sg(e,n),A9(e,i,r),cR(e,i,r,n),dR(null,e,i,!0,t,n);case 19:return eX(t,e,n);case 22:return K9(t,e,n)}throw Error(Je(156,e.tag))};function gX(t,e){return H8(t,e)}function Nie(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ra(t,e,n,i){return new Nie(t,e,n,i)}function rB(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Uie(t){if(typeof t=="function")return rB(t)?1:0;if(t!=null){if(t=t.$$typeof,t===S3)return 11;if(t===A3)return 14}return 2}function Ph(t,e){var n=t.alternate;return n===null?(n=ra(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function wS(t,e,n,i,r,s){var o=2;if(i=t,typeof t=="function")rB(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Em:return hf(n.children,r,s,e);case b3:o=8,r|=8;break;case ID:return t=ra(12,n,e,r|2),t.elementType=ID,t.lanes=s,t;case BD:return t=ra(13,n,e,r),t.elementType=BD,t.lanes=s,t;case OD:return t=ra(19,n,e,r),t.elementType=OD,t.lanes=s,t;case M8:return kM(n,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case S8:o=10;break e;case A8:o=9;break e;case S3:o=11;break e;case A3:o=14;break e;case Ju:o=16,i=null;break e}throw Error(Je(130,t==null?t:typeof t,""))}return e=ra(o,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function hf(t,e,n,i){return t=ra(7,t,i,e),t.lanes=n,t}function kM(t,e,n,i){return t=ra(22,t,i,e),t.elementType=M8,t.lanes=n,t.stateNode={isHidden:!1},t}function RT(t,e,n){return t=ra(6,t,null,e),t.lanes=n,t}function LT(t,e,n){return e=ra(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function kie(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=dT(0),this.expirationTimes=dT(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dT(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function sB(t,e,n,i,r,s,o,a,l){return t=new kie(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ra(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},H3(s),t}function zie(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Mm,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function vX(t){if(!t)return Gh;t=t._reactInternals;e:{if(Wf(t)!==t||t.tag!==1)throw Error(Je(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ns(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Je(171))}if(t.tag===1){var n=t.type;if(Ns(n))return g9(t,n,e)}return e}function yX(t,e,n,i,r,s,o,a,l){return t=sB(n,i,!0,t,r,s,o,a,l),t.context=vX(null),n=t.current,i=ms(),r=Th(n),s=qc(i,r),s.callback=e??null,Eh(n,s,r),t.current.lanes=r,e1(t,r,i),Us(t,i),t}function zM(t,e,n,i){var r=e.current,s=ms(),o=Th(r);return n=vX(n),e.context===null?e.context=n:e.pendingContext=n,e=qc(s,o),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=Eh(r,e,o),t!==null&&(Xa(t,r,o,s),pS(t,r,o)),o}function mA(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function nz(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function oB(t,e){nz(t,e),(t=t.alternate)&&nz(t,e)}function Gie(){return null}var xX=typeof reportError=="function"?reportError:function(t){console.error(t)};function aB(t){this._internalRoot=t}GM.prototype.render=aB.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Je(409));zM(t,e,null,null)};GM.prototype.unmount=aB.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Df(function(){zM(null,t,null,null)}),e[nu]=null}};function GM(t){this._internalRoot=t}GM.prototype.unstable_scheduleHydration=function(t){if(t){var e=Q8();t={blockedOn:null,target:t,priority:e};for(var n=0;n<rh.length&&e!==0&&e<rh[n].priority;n++);rh.splice(n,0,t),n===0&&J8(t)}};function lB(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function HM(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function iz(){}function Hie(t,e,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var c=mA(o);s.call(c)}}var o=yX(e,i,t,0,null,!1,!1,"",iz);return t._reactRootContainer=o,t[nu]=o.current,ix(t.nodeType===8?t.parentNode:t),Df(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var c=mA(l);a.call(c)}}var l=sB(t,0,!1,null,null,!1,!1,"",iz);return t._reactRootContainer=l,t[nu]=l.current,ix(t.nodeType===8?t.parentNode:t),Df(function(){zM(e,l,n,i)}),l}function VM(t,e,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=mA(o);a.call(l)}}zM(e,o,t,r)}else o=Hie(n,e,t,r,i);return mA(o)}Y8=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ty(e.pendingLanes);n!==0&&(C3(e,n|1),Us(e,Pi()),!(gn&6)&&(Lg=Pi()+500,$h()))}break;case 13:Df(function(){var i=iu(t,1);if(i!==null){var r=ms();Xa(i,t,1,r)}}),oB(t,1)}};T3=function(t){if(t.tag===13){var e=iu(t,134217728);if(e!==null){var n=ms();Xa(e,t,134217728,n)}oB(t,134217728)}};q8=function(t){if(t.tag===13){var e=Th(t),n=iu(t,e);if(n!==null){var i=ms();Xa(n,t,e,i)}oB(t,e)}};Q8=function(){return Ln};K8=function(t,e){var n=Ln;try{return Ln=t,e()}finally{Ln=n}};WD=function(t,e,n){switch(e){case"input":if(UD(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=IM(i);if(!r)throw Error(Je(90));C8(i),UD(i,r)}}}break;case"textarea":P8(t,n);break;case"select":e=n.value,e!=null&&tg(t,!!n.multiple,e,!1)}};F8=tB;N8=Df;var Vie={usingClientEntryPoint:!1,Events:[n1,Dm,IM,B8,O8,tB]},i0={findFiberByHostInstance:Zd,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},jie={bundleType:i0.bundleType,version:i0.version,rendererPackageName:i0.rendererPackageName,rendererConfig:i0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fu.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=z8(t),t===null?null:t.stateNode},findFiberByHostInstance:i0.findFiberByHostInstance||Gie,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var i_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!i_.isDisabled&&i_.supportsFiber)try{PM=i_.inject(jie),jl=i_}catch{}}Ao.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Vie;Ao.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!lB(e))throw Error(Je(200));return zie(t,e,null,n)};Ao.createRoot=function(t,e){if(!lB(t))throw Error(Je(299));var n=!1,i="",r=xX;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=sB(t,1,!1,null,null,n,!1,i,r),t[nu]=e.current,ix(t.nodeType===8?t.parentNode:t),new aB(e)};Ao.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Je(188)):(t=Object.keys(t).join(","),Error(Je(268,t)));return t=z8(e),t=t===null?null:t.stateNode,t};Ao.flushSync=function(t){return Df(t)};Ao.hydrate=function(t,e,n){if(!HM(e))throw Error(Je(200));return VM(null,t,e,!0,n)};Ao.hydrateRoot=function(t,e,n){if(!lB(t))throw Error(Je(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",o=xX;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=yX(e,null,t,1,n??null,r,!1,s,o),t[nu]=e.current,ix(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new GM(e)};Ao.render=function(t,e,n){if(!HM(e))throw Error(Je(200));return VM(null,t,e,!1,n)};Ao.unmountComponentAtNode=function(t){if(!HM(t))throw Error(Je(40));return t._reactRootContainer?(Df(function(){VM(null,null,t,!1,function(){t._reactRootContainer=null,t[nu]=null})}),!0):!1};Ao.unstable_batchedUpdates=tB;Ao.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!HM(n))throw Error(Je(200));if(t==null||t._reactInternals===void 0)throw Error(Je(38));return VM(t,e,n,!1,i)};Ao.version="18.2.0-next-9e3b772b8-20220608";function wX(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(wX)}catch(t){console.error(t)}}wX(),y8.exports=Ao;var Wie=y8.exports,_X,rz=Wie;_X=RD.createRoot=rz.createRoot,RD.hydrateRoot=rz.hydrateRoot;/**
 * @remix-run/router v1.6.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function dx(){return dx=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},dx.apply(this,arguments)}var hh;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(hh||(hh={}));const sz="popstate";function Xie(t){t===void 0&&(t={});function e(i,r){let{pathname:s,search:o,hash:a}=i.location;return AR("",{pathname:s,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(i,r){return typeof r=="string"?r:gA(r)}return qie(e,n,null,t)}function Hi(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function cB(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Yie(){return Math.random().toString(36).substr(2,8)}function oz(t,e){return{usr:t.state,key:t.key,idx:e}}function AR(t,e,n,i){return n===void 0&&(n=null),dx({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?av(e):e,{state:n,key:e&&e.key||i||Yie()})}function gA(t){let{pathname:e="/",search:n="",hash:i=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function av(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substr(i),t=t.substr(0,i)),t&&(e.pathname=t)}return e}function qie(t,e,n,i){i===void 0&&(i={});let{window:r=document.defaultView,v5Compat:s=!1}=i,o=r.history,a=hh.Pop,l=null,c=h();c==null&&(c=0,o.replaceState(dx({},o.state,{idx:c}),""));function h(){return(o.state||{idx:null}).idx}function u(){a=hh.Pop;let g=h(),m=g==null?null:g-c;c=g,l&&l({action:a,location:v.location,delta:m})}function d(g,m){a=hh.Push;let y=AR(v.location,g,m);n&&n(y,g),c=h()+1;let w=oz(y,c),b=v.createHref(y);try{o.pushState(w,"",b)}catch{r.location.assign(b)}s&&l&&l({action:a,location:v.location,delta:1})}function f(g,m){a=hh.Replace;let y=AR(v.location,g,m);n&&n(y,g),c=h();let w=oz(y,c),b=v.createHref(y);o.replaceState(w,"",b),s&&l&&l({action:a,location:v.location,delta:0})}function p(g){let m=r.location.origin!=="null"?r.location.origin:r.location.href,y=typeof g=="string"?g:gA(g);return Hi(m,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,m)}let v={get action(){return a},get location(){return t(r,o)},listen(g){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(sz,u),l=g,()=>{r.removeEventListener(sz,u),l=null}},createHref(g){return e(r,g)},createURL:p,encodeLocation(g){let m=p(g);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:d,replace:f,go(g){return o.go(g)}};return v}var az;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(az||(az={}));function Qie(t,e,n){n===void 0&&(n="/");let i=typeof e=="string"?av(e):e,r=uB(i.pathname||"/",n);if(r==null)return null;let s=bX(t);Kie(s);let o=null;for(let a=0;o==null&&a<s.length;++a)o=sre(s[a],lre(r));return o}function bX(t,e,n,i){e===void 0&&(e=[]),n===void 0&&(n=[]),i===void 0&&(i="");let r=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Hi(l.relativePath.startsWith(i),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(i.length));let c=Dh([i,l.relativePath]),h=n.concat(l);s.children&&s.children.length>0&&(Hi(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),bX(s.children,e,h,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:ire(c,s.index),routesMeta:h})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))r(s,o);else for(let l of SX(s.path))r(s,o,l)}),e}function SX(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(i.length===0)return r?[s,""]:[s];let o=SX(i.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),r&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function Kie(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:rre(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}const Jie=/^:\w+$/,Zie=3,$ie=2,ere=1,tre=10,nre=-2,lz=t=>t==="*";function ire(t,e){let n=t.split("/"),i=n.length;return n.some(lz)&&(i+=nre),e&&(i+=$ie),n.filter(r=>!lz(r)).reduce((r,s)=>r+(Jie.test(s)?Zie:s===""?ere:tre),i)}function rre(t,e){return t.length===e.length&&t.slice(0,-1).every((i,r)=>i===e[r])?t[t.length-1]-e[e.length-1]:0}function sre(t,e){let{routesMeta:n}=t,i={},r="/",s=[];for(let o=0;o<n.length;++o){let a=n[o],l=o===n.length-1,c=r==="/"?e:e.slice(r.length)||"/",h=ore({path:a.relativePath,caseSensitive:a.caseSensitive,end:l},c);if(!h)return null;Object.assign(i,h.params);let u=a.route;s.push({params:i,pathname:Dh([r,h.pathname]),pathnameBase:dre(Dh([r,h.pathnameBase])),route:u}),h.pathnameBase!=="/"&&(r=Dh([r,h.pathnameBase]))}return s}function ore(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=are(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let s=r[0],o=s.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:i.reduce((c,h,u)=>{if(h==="*"){let d=a[u]||"";o=s.slice(0,s.length-d.length).replace(/(.)\/+$/,"$1")}return c[h]=cre(a[u]||"",h),c},{}),pathname:s,pathnameBase:o,pattern:t}}function are(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),cB(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let i=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(o,a)=>(i.push(a),"/([^\\/]+)"));return t.endsWith("*")?(i.push("*"),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function lre(t){try{return decodeURI(t)}catch(e){return cB(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function cre(t,e){try{return decodeURIComponent(t)}catch(n){return cB(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function uB(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}function ure(t,e){e===void 0&&(e="/");let{pathname:n,search:i="",hash:r=""}=typeof t=="string"?av(t):t;return{pathname:n?n.startsWith("/")?n:hre(n,e):e,search:fre(i),hash:pre(r)}}function hre(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function IT(t,e,n,i){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function AX(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function MX(t,e,n,i){i===void 0&&(i=!1);let r;typeof t=="string"?r=av(t):(r=dx({},t),Hi(!r.pathname||!r.pathname.includes("?"),IT("?","pathname","search",r)),Hi(!r.pathname||!r.pathname.includes("#"),IT("#","pathname","hash",r)),Hi(!r.search||!r.search.includes("#"),IT("#","search","hash",r)));let s=t===""||r.pathname==="",o=s?"/":r.pathname,a;if(i||o==null)a=n;else{let u=e.length-1;if(o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),u-=1;r.pathname=d.join("/")}a=u>=0?e[u]:"/"}let l=ure(r,a),c=o&&o!=="/"&&o.endsWith("/"),h=(s||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||h)&&(l.pathname+="/"),l}const Dh=t=>t.join("/").replace(/\/\/+/g,"/"),dre=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),fre=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,pre=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function mre(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const EX=["post","put","patch","delete"];new Set(EX);const gre=["get",...EX];new Set(gre);/**
 * React Router v6.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vA(){return vA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},vA.apply(this,arguments)}const hB=ge.createContext(null),vre=ge.createContext(null),lv=ge.createContext(null),jM=ge.createContext(null),cv=ge.createContext({outlet:null,matches:[]}),CX=ge.createContext(null);function yre(t,e){let{relative:n}=e===void 0?{}:e;r1()||Hi(!1);let{basename:i,navigator:r}=ge.useContext(lv),{hash:s,pathname:o,search:a}=PX(t,{relative:n}),l=o;return i!=="/"&&(l=o==="/"?i:Dh([i,o])),r.createHref({pathname:l,search:a,hash:s})}function r1(){return ge.useContext(jM)!=null}function WM(){return r1()||Hi(!1),ge.useContext(jM).location}function TX(t){ge.useContext(lv).static||ge.useLayoutEffect(t)}function xre(){return ge.useContext(hB)!=null?Lre():wre()}function wre(){r1()||Hi(!1);let{basename:t,navigator:e}=ge.useContext(lv),{matches:n}=ge.useContext(cv),{pathname:i}=WM(),r=JSON.stringify(AX(n).map(a=>a.pathnameBase)),s=ge.useRef(!1);return TX(()=>{s.current=!0}),ge.useCallback(function(a,l){if(l===void 0&&(l={}),!s.current)return;if(typeof a=="number"){e.go(a);return}let c=MX(a,JSON.parse(r),i,l.relative==="path");t!=="/"&&(c.pathname=c.pathname==="/"?t:Dh([t,c.pathname])),(l.replace?e.replace:e.push)(c,l.state,l)},[t,e,r,i])}function PX(t,e){let{relative:n}=e===void 0?{}:e,{matches:i}=ge.useContext(cv),{pathname:r}=WM(),s=JSON.stringify(AX(i).map(o=>o.pathnameBase));return ge.useMemo(()=>MX(t,JSON.parse(s),r,n==="path"),[t,s,r,n])}function _re(t,e){return bre(t,e)}function bre(t,e,n){r1()||Hi(!1);let{navigator:i}=ge.useContext(lv),{matches:r}=ge.useContext(cv),s=r[r.length-1],o=s?s.params:{};s&&s.pathname;let a=s?s.pathnameBase:"/";s&&s.route;let l=WM(),c;if(e){var h;let v=typeof e=="string"?av(e):e;a==="/"||(h=v.pathname)!=null&&h.startsWith(a)||Hi(!1),c=v}else c=l;let u=c.pathname||"/",d=a==="/"?u:u.slice(a.length)||"/",f=Qie(t,{pathname:d}),p=Cre(f&&f.map(v=>Object.assign({},v,{params:Object.assign({},o,v.params),pathname:Dh([a,i.encodeLocation?i.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?a:Dh([a,i.encodeLocation?i.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),r,n);return e&&p?ge.createElement(jM.Provider,{value:{location:vA({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:hh.Pop}},p):p}function Sre(){let t=Rre(),e=mre(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return ge.createElement(ge.Fragment,null,ge.createElement("h2",null,"Unexpected Application Error!"),ge.createElement("h3",{style:{fontStyle:"italic"}},e),n?ge.createElement("pre",{style:r},n):null,s)}const Are=ge.createElement(Sre,null);class Mre extends ge.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error?ge.createElement(cv.Provider,{value:this.props.routeContext},ge.createElement(CX.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Ere(t){let{routeContext:e,match:n,children:i}=t,r=ge.useContext(hB);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),ge.createElement(cv.Provider,{value:e},i)}function Cre(t,e,n){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),t==null){var r;if((r=n)!=null&&r.errors)t=n.matches;else return null}let s=t,o=(i=n)==null?void 0:i.errors;if(o!=null){let a=s.findIndex(l=>l.route.id&&(o==null?void 0:o[l.route.id]));a>=0||Hi(!1),s=s.slice(0,Math.min(s.length,a+1))}return s.reduceRight((a,l,c)=>{let h=l.route.id?o==null?void 0:o[l.route.id]:null,u=null;n&&(u=l.route.errorElement||Are);let d=e.concat(s.slice(0,c+1)),f=()=>{let p;return h?p=u:l.route.element?p=l.route.element:p=a,ge.createElement(Ere,{match:l,routeContext:{outlet:a,matches:d},children:p})};return n&&(l.route.ErrorBoundary||l.route.errorElement||c===0)?ge.createElement(Mre,{location:n.location,revalidation:n.revalidation,component:u,error:h,children:f(),routeContext:{outlet:null,matches:d}}):f()},null)}var MR;(function(t){t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate"})(MR||(MR={}));var fx;(function(t){t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId"})(fx||(fx={}));function Tre(t){let e=ge.useContext(hB);return e||Hi(!1),e}function Pre(t){let e=ge.useContext(vre);return e||Hi(!1),e}function Dre(t){let e=ge.useContext(cv);return e||Hi(!1),e}function DX(t){let e=Dre(),n=e.matches[e.matches.length-1];return n.route.id||Hi(!1),n.route.id}function Rre(){var t;let e=ge.useContext(CX),n=Pre(fx.UseRouteError),i=DX(fx.UseRouteError);return e||((t=n.errors)==null?void 0:t[i])}function Lre(){let{router:t}=Tre(MR.UseNavigateStable),e=DX(fx.UseNavigateStable),n=ge.useRef(!1);return TX(()=>{n.current=!0}),ge.useCallback(function(r,s){s===void 0&&(s={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,vA({fromRouteId:e},s)))},[t,e])}function gm(t){Hi(!1)}function Ire(t){let{basename:e="/",children:n=null,location:i,navigationType:r=hh.Pop,navigator:s,static:o=!1}=t;r1()&&Hi(!1);let a=e.replace(/^\/*/,"/"),l=ge.useMemo(()=>({basename:a,navigator:s,static:o}),[a,s,o]);typeof i=="string"&&(i=av(i));let{pathname:c="/",search:h="",hash:u="",state:d=null,key:f="default"}=i,p=ge.useMemo(()=>{let v=uB(c,a);return v==null?null:{location:{pathname:v,search:h,hash:u,state:d,key:f},navigationType:r}},[a,c,h,u,d,f,r]);return p==null?null:ge.createElement(lv.Provider,{value:l},ge.createElement(jM.Provider,{children:n,value:p}))}function Bre(t){let{children:e,location:n}=t;return _re(ER(e),n)}var cz;(function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"})(cz||(cz={}));new Promise(()=>{});function ER(t,e){e===void 0&&(e=[]);let n=[];return ge.Children.forEach(t,(i,r)=>{if(!ge.isValidElement(i))return;let s=[...e,r];if(i.type===ge.Fragment){n.push.apply(n,ER(i.props.children,s));return}i.type!==gm&&Hi(!1),!i.props.index||!i.props.children||Hi(!1);let o={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=ER(i.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function CR(){return CR=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},CR.apply(this,arguments)}function Ore(t,e){if(t==null)return{};var n={},i=Object.keys(t),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function Fre(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Nre(t,e){return t.button===0&&(!e||e==="_self")&&!Fre(t)}const Ure=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function kre(t){let{basename:e,children:n,window:i}=t,r=ge.useRef();r.current==null&&(r.current=Xie({window:i,v5Compat:!0}));let s=r.current,[o,a]=ge.useState({action:s.action,location:s.location});return ge.useLayoutEffect(()=>s.listen(a),[s]),ge.createElement(Ire,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:s})}const zre=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Gre=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Hre=ge.forwardRef(function(e,n){let{onClick:i,relative:r,reloadDocument:s,replace:o,state:a,target:l,to:c,preventScrollReset:h}=e,u=Ore(e,Ure),{basename:d}=ge.useContext(lv),f,p=!1;if(typeof c=="string"&&Gre.test(c)&&(f=c,zre))try{let y=new URL(window.location.href),w=c.startsWith("//")?new URL(y.protocol+c):new URL(c),b=uB(w.pathname,d);w.origin===y.origin&&b!=null?c=b+w.search+w.hash:p=!0}catch{}let v=yre(c,{relative:r}),g=Vre(c,{replace:o,state:a,target:l,preventScrollReset:h,relative:r});function m(y){i&&i(y),y.defaultPrevented||g(y)}return ge.createElement("a",CR({},u,{href:f||v,onClick:p||s?i:m,ref:n,target:l}))});var uz;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmitImpl="useSubmitImpl",t.UseFetcher="useFetcher"})(uz||(uz={}));var hz;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(hz||(hz={}));function Vre(t,e){let{target:n,replace:i,state:r,preventScrollReset:s,relative:o}=e===void 0?{}:e,a=xre(),l=WM(),c=PX(t,{relative:o});return ge.useCallback(h=>{if(Nre(h,n)){h.preventDefault();let u=i!==void 0?i:gA(l)===gA(c);a(t,{replace:u,state:r,preventScrollReset:s,relative:o})}},[l,a,c,i,r,n,t,s,o])}/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const XM="152",Fd={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Nd={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},RX=0,TR=1,LX=2,jre=3,IX=0,YM=1,Sy=2,Oa=3,Zl=0,gs=1,na=2,Wre=2,Qc=0,df=1,PR=2,DR=3,RR=4,BX=5,Wd=100,OX=101,FX=102,LR=103,IR=104,NX=200,UX=201,kX=202,zX=203,dB=204,fB=205,GX=206,HX=207,VX=208,jX=209,WX=210,XX=0,YX=1,qX=2,yA=3,QX=4,KX=5,JX=6,ZX=7,s1=0,$X=1,e7=2,Ya=0,t7=1,n7=2,i7=3,pB=4,r7=5,qM=300,Hh=301,Vh=302,px=303,mx=304,uv=306,jh=1e3,Pr=1001,Ig=1002,yi=1003,gx=1004,Xre=1004,ag=1005,Yre=1005,ai=1006,QM=1007,qre=1007,$l=1008,Qre=1008,su=1009,s7=1010,o7=1011,mB=1012,a7=1013,dh=1014,Hc=1015,Bg=1016,l7=1017,c7=1018,ff=1020,u7=1021,Ps=1023,h7=1024,d7=1025,Rh=1026,Rf=1027,f7=1028,p7=1029,m7=1030,g7=1031,v7=1033,_S=33776,bS=33777,SS=33778,AS=33779,BR=35840,OR=35841,FR=35842,NR=35843,y7=36196,UR=37492,kR=37496,zR=37808,GR=37809,HR=37810,VR=37811,jR=37812,WR=37813,XR=37814,YR=37815,qR=37816,QR=37817,KR=37818,JR=37819,ZR=37820,$R=37821,MS=36492,x7=36283,eL=36284,tL=36285,nL=36286,w7=2200,_7=2201,b7=2202,Og=2300,Lf=2301,ES=2302,tf=2400,nf=2401,vx=2402,KM=2500,gB=2501,S7=0,vB=1,xA=2,yB=3e3,yo=3001,A7=3200,M7=3201,ed=0,E7=1,Lh="",Jt="srgb",Ja="srgb-linear",xB="display-p3",Kre=0,CS=7680,Jre=7681,Zre=7682,$re=7683,ese=34055,tse=34056,nse=5386,ise=512,rse=513,sse=514,ose=515,ase=516,lse=517,cse=518,C7=519,yx=35044,pf=35048,use=35040,hse=35045,dse=35049,fse=35041,pse=35046,mse=35050,gse=35042,vse="100",iL="300 es",wA=1035;class sc{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Vr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let dz=1234567;const mf=Math.PI/180,Fg=180/Math.PI;function xo(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Vr[t&255]+Vr[t>>8&255]+Vr[t>>16&255]+Vr[t>>24&255]+"-"+Vr[e&255]+Vr[e>>8&255]+"-"+Vr[e>>16&15|64]+Vr[e>>24&255]+"-"+Vr[n&63|128]+Vr[n>>8&255]+"-"+Vr[n>>16&255]+Vr[n>>24&255]+Vr[i&255]+Vr[i>>8&255]+Vr[i>>16&255]+Vr[i>>24&255]).toLowerCase()}function xi(t,e,n){return Math.max(e,Math.min(n,t))}function wB(t,e){return(t%e+e)%e}function yse(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)}function xse(t,e,n){return t!==e?(n-t)/(e-t):0}function Ay(t,e,n){return(1-n)*t+n*e}function wse(t,e,n,i){return Ay(t,e,1-Math.exp(-n*i))}function _se(t,e=1){return e-Math.abs(wB(t,e*2)-e)}function bse(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function Sse(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function Ase(t,e){return t+Math.floor(Math.random()*(e-t+1))}function Mse(t,e){return t+Math.random()*(e-t)}function Ese(t){return t*(.5-Math.random())}function Cse(t){t!==void 0&&(dz=t);let e=dz+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Tse(t){return t*mf}function Pse(t){return t*Fg}function rL(t){return(t&t-1)===0&&t!==0}function T7(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function P7(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function Dse(t,e,n,i,r){const s=Math.cos,o=Math.sin,a=s(n/2),l=o(n/2),c=s((e+i)/2),h=o((e+i)/2),u=s((e-i)/2),d=o((e-i)/2),f=s((i-e)/2),p=o((i-e)/2);switch(r){case"XYX":t.set(a*h,l*u,l*d,a*c);break;case"YZY":t.set(l*d,a*h,l*u,a*c);break;case"ZXZ":t.set(l*u,l*d,a*h,a*c);break;case"XZX":t.set(a*h,l*p,l*f,a*c);break;case"YXY":t.set(l*f,a*h,l*p,a*c);break;case"ZYZ":t.set(l*p,l*f,a*h,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function ao(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function nn(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const D7={DEG2RAD:mf,RAD2DEG:Fg,generateUUID:xo,clamp:xi,euclideanModulo:wB,mapLinear:yse,inverseLerp:xse,lerp:Ay,damp:wse,pingpong:_se,smoothstep:bse,smootherstep:Sse,randInt:Ase,randFloat:Mse,randFloatSpread:Ese,seededRandom:Cse,degToRad:Tse,radToDeg:Pse,isPowerOfTwo:rL,ceilPowerOfTwo:T7,floorPowerOfTwo:P7,setQuaternionFromProperEuler:Dse,normalize:nn,denormalize:ao};class Ye{constructor(e=0,n=0){Ye.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,r=e.elements;return this.x=r[0]*n+r[3]*i+r[6],this.y=r[1]*n+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(xi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),r=Math.sin(n),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ln{constructor(){ln.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,n,i,r,s,o,a,l,c){const h=this.elements;return h[0]=e,h[1]=r,h[2]=a,h[3]=n,h[4]=s,h[5]=l,h[6]=i,h[7]=o,h[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],h=i[4],u=i[7],d=i[2],f=i[5],p=i[8],v=r[0],g=r[3],m=r[6],y=r[1],w=r[4],b=r[7],A=r[2],S=r[5],T=r[8];return s[0]=o*v+a*y+l*A,s[3]=o*g+a*w+l*S,s[6]=o*m+a*b+l*T,s[1]=c*v+h*y+u*A,s[4]=c*g+h*w+u*S,s[7]=c*m+h*b+u*T,s[2]=d*v+f*y+p*A,s[5]=d*g+f*w+p*S,s[8]=d*m+f*b+p*T,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8];return n*o*h-n*a*c-i*s*h+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8],u=h*o-a*c,d=a*l-h*s,f=c*s-o*l,p=n*u+i*d+r*f;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const v=1/p;return e[0]=u*v,e[1]=(r*c-h*i)*v,e[2]=(a*i-r*o)*v,e[3]=d*v,e[4]=(h*n-r*l)*v,e[5]=(r*s-a*n)*v,e[6]=f*v,e[7]=(i*l-c*n)*v,e[8]=(o*n-i*s)*v,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+n,0,0,1),this}scale(e,n){return this.premultiply(BT.makeScale(e,n)),this}rotate(e){return this.premultiply(BT.makeRotation(-e)),this}translate(e,n){return this.premultiply(BT.makeTranslation(e,n)),this}makeTranslation(e,n){return this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<9;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const BT=new ln;function R7(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}const Rse={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Nm(t,e){return new Rse[t](e)}function xx(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}const fz={};function My(t){t in fz||(fz[t]=!0,console.warn(t))}function lg(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function OT(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}const Lse=new ln().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),Ise=new ln().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]);function Bse(t){return t.convertSRGBToLinear().applyMatrix3(Ise)}function Ose(t){return t.applyMatrix3(Lse).convertLinearToSRGB()}const Fse={[Ja]:t=>t,[Jt]:t=>t.convertSRGBToLinear(),[xB]:Bse},Nse={[Ja]:t=>t,[Jt]:t=>t.convertLinearToSRGB(),[xB]:Ose},jo={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(t){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!t},get workingColorSpace(){return Ja},set workingColorSpace(t){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(t,e,n){if(this.enabled===!1||e===n||!e||!n)return t;const i=Fse[e],r=Nse[n];if(i===void 0||r===void 0)throw new Error(`Unsupported color space conversion, "${e}" to "${n}".`);return r(i(t))},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}};let yp;class _B{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{yp===void 0&&(yp=xx("canvas")),yp.width=e.width,yp.height=e.height;const i=yp.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),n=yp}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=xx("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=lg(s[o]/255)*255;return i.putImageData(r,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(lg(n[i]/255)*255):n[i]=lg(n[i]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class rf{constructor(e=null){this.isSource=!0,this.uuid=xo(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(FT(r[o].image)):s.push(FT(r[o]))}else s=FT(r);i.url=s}return n||(e.images[this.uuid]=i),i}}function FT(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?_B.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Use=0;class ii extends sc{constructor(e=ii.DEFAULT_IMAGE,n=ii.DEFAULT_MAPPING,i=Pr,r=Pr,s=ai,o=$l,a=Ps,l=su,c=ii.DEFAULT_ANISOTROPY,h=Lh){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Use++}),this.uuid=xo(),this.name="",this.source=new rf(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Ye(0,0),this.repeat=new Ye(1,1),this.center=new Ye(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ln,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof h=="string"?this.colorSpace=h:(My("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=h===yo?Jt:Lh),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==qM)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case jh:e.x=e.x-Math.floor(e.x);break;case Pr:e.x=e.x<0?0:1;break;case Ig:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case jh:e.y=e.y-Math.floor(e.y);break;case Pr:e.y=e.y<0?0:1;break;case Ig:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return My("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Jt?yo:yB}set encoding(e){My("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===yo?Jt:Lh}}ii.DEFAULT_IMAGE=null;ii.DEFAULT_MAPPING=qM;ii.DEFAULT_ANISOTROPY=1;class Dn{constructor(e=0,n=0,i=0,r=1){Dn.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*n+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*n+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*n+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*n+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,r,s;const l=e.elements,c=l[0],h=l[4],u=l[8],d=l[1],f=l[5],p=l[9],v=l[2],g=l[6],m=l[10];if(Math.abs(h-d)<.01&&Math.abs(u-v)<.01&&Math.abs(p-g)<.01){if(Math.abs(h+d)<.1&&Math.abs(u+v)<.1&&Math.abs(p+g)<.1&&Math.abs(c+f+m-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const w=(c+1)/2,b=(f+1)/2,A=(m+1)/2,S=(h+d)/4,T=(u+v)/4,M=(p+g)/4;return w>b&&w>A?w<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(w),r=S/i,s=T/i):b>A?b<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(b),i=S/r,s=M/r):A<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(A),i=T/s,r=M/s),this.set(i,r,s,n),this}let y=Math.sqrt((g-p)*(g-p)+(u-v)*(u-v)+(d-h)*(d-h));return Math.abs(y)<.001&&(y=1),this.x=(g-p)/y,this.y=(u-v)/y,this.z=(d-h)/y,this.w=Math.acos((c+f+m-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Za extends sc{constructor(e=1,n=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=n,this.depth=1,this.scissor=new Dn(0,0,e,n),this.scissorTest=!1,this.viewport=new Dn(0,0,e,n);const r={width:e,height:n,depth:1};i.encoding!==void 0&&(My("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===yo?Jt:Lh),this.texture=new ii(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:ai,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(e,n,i=1){(this.width!==e||this.height!==n||this.depth!==i)&&(this.width=e,this.height=n,this.depth=i,this.texture.image.width=e,this.texture.image.height=n,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const n=Object.assign({},e.texture.image);return this.texture.source=new rf(n),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class JM extends ii{constructor(e=null,n=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=yi,this.minFilter=yi,this.wrapR=Pr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class kse extends Za{constructor(e=1,n=1,i=1){super(e,n),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new JM(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class bB extends ii{constructor(e=null,n=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=yi,this.minFilter=yi,this.wrapR=Pr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class zse extends Za{constructor(e=1,n=1,i=1){super(e,n),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new bB(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class Gse extends Za{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<i;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,n,i=1){if(this.width!==e||this.height!==n||this.depth!==i){this.width=e,this.height=n,this.depth=i;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=n,this.texture[r].image.depth=i;this.dispose()}return this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let n=0,i=e.texture.length;n<i;n++)this.texture[n]=e.texture[n].clone(),this.texture[n].isRenderTargetTexture=!0;return this}}class _r{constructor(e=0,n=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=r}static slerpFlat(e,n,i,r,s,o,a){let l=i[r+0],c=i[r+1],h=i[r+2],u=i[r+3];const d=s[o+0],f=s[o+1],p=s[o+2],v=s[o+3];if(a===0){e[n+0]=l,e[n+1]=c,e[n+2]=h,e[n+3]=u;return}if(a===1){e[n+0]=d,e[n+1]=f,e[n+2]=p,e[n+3]=v;return}if(u!==v||l!==d||c!==f||h!==p){let g=1-a;const m=l*d+c*f+h*p+u*v,y=m>=0?1:-1,w=1-m*m;if(w>Number.EPSILON){const A=Math.sqrt(w),S=Math.atan2(A,m*y);g=Math.sin(g*S)/A,a=Math.sin(a*S)/A}const b=a*y;if(l=l*g+d*b,c=c*g+f*b,h=h*g+p*b,u=u*g+v*b,g===1-a){const A=1/Math.sqrt(l*l+c*c+h*h+u*u);l*=A,c*=A,h*=A,u*=A}}e[n]=l,e[n+1]=c,e[n+2]=h,e[n+3]=u}static multiplyQuaternionsFlat(e,n,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],h=i[r+3],u=s[o],d=s[o+1],f=s[o+2],p=s[o+3];return e[n]=a*p+h*u+l*f-c*d,e[n+1]=l*p+h*d+c*u-a*f,e[n+2]=c*p+h*f+a*d-l*u,e[n+3]=h*p-a*u-l*d-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,r){return this._x=e,this._y=n,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),h=a(r/2),u=a(s/2),d=l(i/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=d*h*u+c*f*p,this._y=c*f*u-d*h*p,this._z=c*h*p+d*f*u,this._w=c*h*u-d*f*p;break;case"YXZ":this._x=d*h*u+c*f*p,this._y=c*f*u-d*h*p,this._z=c*h*p-d*f*u,this._w=c*h*u+d*f*p;break;case"ZXY":this._x=d*h*u-c*f*p,this._y=c*f*u+d*h*p,this._z=c*h*p+d*f*u,this._w=c*h*u-d*f*p;break;case"ZYX":this._x=d*h*u-c*f*p,this._y=c*f*u+d*h*p,this._z=c*h*p-d*f*u,this._w=c*h*u+d*f*p;break;case"YZX":this._x=d*h*u+c*f*p,this._y=c*f*u+d*h*p,this._z=c*h*p-d*f*u,this._w=c*h*u-d*f*p;break;case"XZY":this._x=d*h*u-c*f*p,this._y=c*f*u-d*h*p,this._z=c*h*p+d*f*u,this._w=c*h*u+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return n!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],r=n[4],s=n[8],o=n[1],a=n[5],l=n[9],c=n[2],h=n[6],u=n[10],d=i+a+u;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(h-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(i>a&&i>u){const f=2*Math.sqrt(1+i-a-u);this._w=(h-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>u){const f=2*Math.sqrt(1+a-i-u);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+h)/f}else{const f=2*Math.sqrt(1+u-i-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+h)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(xi(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,n/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,r=e._y,s=e._z,o=e._w,a=n._x,l=n._y,c=n._z,h=n._w;return this._x=i*h+o*a+r*c-s*l,this._y=r*h+o*l+s*a-i*c,this._z=s*h+o*c+i*l-r*a,this._w=o*h-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-n;return this._w=f*o+n*this._w,this._x=f*i+n*this._x,this._y=f*r+n*this._y,this._z=f*s+n*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),h=Math.atan2(c,a),u=Math.sin((1-n)*h)/c,d=Math.sin(n*h)/c;return this._w=o*u+this._w*d,this._x=i*u+this._x*d,this._y=r*u+this._y*d,this._z=s*u+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=Math.random(),n=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(n*Math.cos(r),i*Math.sin(s),i*Math.cos(s),n*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ae{constructor(e=0,n=0,i=0){ae.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(pz.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(pz.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6]*r,this.y=s[1]*n+s[4]*i+s[7]*r,this.z=s[2]*n+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*n+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*n+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*n+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*n+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const n=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*n+o*r-a*i,h=l*i+a*n-s*r,u=l*r+s*i-o*n,d=-s*n-o*i-a*r;return this.x=c*l+d*-s+h*-a-u*-o,this.y=h*l+d*-o+u*-s-c*-a,this.z=u*l+d*-a+c*-o-h*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[4]*i+s[8]*r,this.y=s[1]*n+s[5]*i+s[9]*r,this.z=s[2]*n+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,r=e.y,s=e.z,o=n.x,a=n.y,l=n.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return NT.copy(this).projectOnVector(e),this.sub(NT)}reflect(e){return this.sub(NT.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(xi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return n*n+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const r=Math.sin(n)*e;return this.x=r*Math.sin(i),this.y=Math.cos(n)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=r,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,n=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(n),this.y=i*Math.sin(n),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const NT=new ae,pz=new _r;class il{constructor(e=new ae(1/0,1/0,1/0),n=new ae(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(vc.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(vc.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=vc.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){if(e.updateWorldMatrix(!1,!1),e.boundingBox!==void 0)e.boundingBox===null&&e.computeBoundingBox(),xp.copy(e.boundingBox),xp.applyMatrix4(e.matrixWorld),this.union(xp);else{const r=e.geometry;if(r!==void 0)if(n&&r.attributes!==void 0&&r.attributes.position!==void 0){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)vc.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(vc)}else r.boundingBox===null&&r.computeBoundingBox(),xp.copy(r.boundingBox),xp.applyMatrix4(e.matrixWorld),this.union(xp)}const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],n);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,vc),vc.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(r0),r_.subVectors(this.max,r0),wp.subVectors(e.a,r0),_p.subVectors(e.b,r0),bp.subVectors(e.c,r0),Tu.subVectors(_p,wp),Pu.subVectors(bp,_p),vd.subVectors(wp,bp);let n=[0,-Tu.z,Tu.y,0,-Pu.z,Pu.y,0,-vd.z,vd.y,Tu.z,0,-Tu.x,Pu.z,0,-Pu.x,vd.z,0,-vd.x,-Tu.y,Tu.x,0,-Pu.y,Pu.x,0,-vd.y,vd.x,0];return!UT(n,wp,_p,bp,r_)||(n=[1,0,0,0,1,0,0,0,1],!UT(n,wp,_p,bp,r_))?!1:(s_.crossVectors(Tu,Pu),n=[s_.x,s_.y,s_.z],UT(n,wp,_p,bp,r_))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,vc).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(vc).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(gc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),gc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),gc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),gc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),gc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),gc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),gc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),gc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(gc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const gc=[new ae,new ae,new ae,new ae,new ae,new ae,new ae,new ae],vc=new ae,xp=new il,wp=new ae,_p=new ae,bp=new ae,Tu=new ae,Pu=new ae,vd=new ae,r0=new ae,r_=new ae,s_=new ae,yd=new ae;function UT(t,e,n,i,r){for(let s=0,o=t.length-3;s<=o;s+=3){yd.fromArray(t,s);const a=r.x*Math.abs(yd.x)+r.y*Math.abs(yd.y)+r.z*Math.abs(yd.z),l=e.dot(yd),c=n.dot(yd),h=i.dot(yd);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>a)return!1}return!0}const Hse=new il,s0=new ae,kT=new ae;class rl{constructor(e=new ae,n=-1){this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):Hse.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;s0.subVectors(e,this.center);const n=s0.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),r=(i-this.radius)*.5;this.center.addScaledVector(s0,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(kT.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(s0.copy(e.center).add(kT)),this.expandByPoint(s0.copy(e.center).sub(kT))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const yc=new ae,zT=new ae,o_=new ae,Du=new ae,GT=new ae,a_=new ae,HT=new ae;class o1{constructor(e=new ae,n=new ae(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,yc)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=yc.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(yc.copy(this.origin).addScaledVector(this.direction,n),yc.distanceToSquared(e))}distanceSqToSegment(e,n,i,r){zT.copy(e).add(n).multiplyScalar(.5),o_.copy(n).sub(e).normalize(),Du.copy(this.origin).sub(zT);const s=e.distanceTo(n)*.5,o=-this.direction.dot(o_),a=Du.dot(this.direction),l=-Du.dot(o_),c=Du.lengthSq(),h=Math.abs(1-o*o);let u,d,f,p;if(h>0)if(u=o*l-a,d=o*a-l,p=s*h,u>=0)if(d>=-p)if(d<=p){const v=1/h;u*=v,d*=v,f=u*(u+o*d+2*a)+d*(o*u+d+2*l)+c}else d=s,u=Math.max(0,-(o*d+a)),f=-u*u+d*(d+2*l)+c;else d=-s,u=Math.max(0,-(o*d+a)),f=-u*u+d*(d+2*l)+c;else d<=-p?(u=Math.max(0,-(-o*s+a)),d=u>0?-s:Math.min(Math.max(-s,-l),s),f=-u*u+d*(d+2*l)+c):d<=p?(u=0,d=Math.min(Math.max(-s,-l),s),f=d*(d+2*l)+c):(u=Math.max(0,-(o*s+a)),d=u>0?s:Math.min(Math.max(-s,-l),s),f=-u*u+d*(d+2*l)+c);else d=o>0?-s:s,u=Math.max(0,-(o*d+a)),f=-u*u+d*(d+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,u),r&&r.copy(zT).addScaledVector(o_,d),f}intersectSphere(e,n){yc.subVectors(e.center,this.origin);const i=yc.dot(this.direction),r=yc.dot(yc)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:a<0?this.at(l,n):this.at(a,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,r,s,o,a,l;const c=1/this.direction.x,h=1/this.direction.y,u=1/this.direction.z,d=this.origin;return c>=0?(i=(e.min.x-d.x)*c,r=(e.max.x-d.x)*c):(i=(e.max.x-d.x)*c,r=(e.min.x-d.x)*c),h>=0?(s=(e.min.y-d.y)*h,o=(e.max.y-d.y)*h):(s=(e.max.y-d.y)*h,o=(e.min.y-d.y)*h),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),u>=0?(a=(e.min.z-d.z)*u,l=(e.max.z-d.z)*u):(a=(e.max.z-d.z)*u,l=(e.min.z-d.z)*u),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,n)}intersectsBox(e){return this.intersectBox(e,yc)!==null}intersectTriangle(e,n,i,r,s){GT.subVectors(n,e),a_.subVectors(i,e),HT.crossVectors(GT,a_);let o=this.direction.dot(HT),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Du.subVectors(this.origin,e);const l=a*this.direction.dot(a_.crossVectors(Du,a_));if(l<0)return null;const c=a*this.direction.dot(GT.cross(Du));if(c<0||l+c>o)return null;const h=-a*Du.dot(HT);return h<0?null:this.at(h/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class kt{constructor(){kt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,n,i,r,s,o,a,l,c,h,u,d,f,p,v,g){const m=this.elements;return m[0]=e,m[4]=n,m[8]=i,m[12]=r,m[1]=s,m[5]=o,m[9]=a,m[13]=l,m[2]=c,m[6]=h,m[10]=u,m[14]=d,m[3]=f,m[7]=p,m[11]=v,m[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new kt().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,r=1/Sp.setFromMatrixColumn(e,0).length(),s=1/Sp.setFromMatrixColumn(e,1).length(),o=1/Sp.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[3]=0,n[4]=i[4]*s,n[5]=i[5]*s,n[6]=i[6]*s,n[7]=0,n[8]=i[8]*o,n[9]=i[9]*o,n[10]=i[10]*o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),h=Math.cos(s),u=Math.sin(s);if(e.order==="XYZ"){const d=o*h,f=o*u,p=a*h,v=a*u;n[0]=l*h,n[4]=-l*u,n[8]=c,n[1]=f+p*c,n[5]=d-v*c,n[9]=-a*l,n[2]=v-d*c,n[6]=p+f*c,n[10]=o*l}else if(e.order==="YXZ"){const d=l*h,f=l*u,p=c*h,v=c*u;n[0]=d+v*a,n[4]=p*a-f,n[8]=o*c,n[1]=o*u,n[5]=o*h,n[9]=-a,n[2]=f*a-p,n[6]=v+d*a,n[10]=o*l}else if(e.order==="ZXY"){const d=l*h,f=l*u,p=c*h,v=c*u;n[0]=d-v*a,n[4]=-o*u,n[8]=p+f*a,n[1]=f+p*a,n[5]=o*h,n[9]=v-d*a,n[2]=-o*c,n[6]=a,n[10]=o*l}else if(e.order==="ZYX"){const d=o*h,f=o*u,p=a*h,v=a*u;n[0]=l*h,n[4]=p*c-f,n[8]=d*c+v,n[1]=l*u,n[5]=v*c+d,n[9]=f*c-p,n[2]=-c,n[6]=a*l,n[10]=o*l}else if(e.order==="YZX"){const d=o*l,f=o*c,p=a*l,v=a*c;n[0]=l*h,n[4]=v-d*u,n[8]=p*u+f,n[1]=u,n[5]=o*h,n[9]=-a*h,n[2]=-c*h,n[6]=f*u+p,n[10]=d-v*u}else if(e.order==="XZY"){const d=o*l,f=o*c,p=a*l,v=a*c;n[0]=l*h,n[4]=-u,n[8]=c*h,n[1]=d*u+v,n[5]=o*h,n[9]=f*u-p,n[2]=p*u-f,n[6]=a*h,n[10]=v*u+d}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Vse,e,jse)}lookAt(e,n,i){const r=this.elements;return Qs.subVectors(e,n),Qs.lengthSq()===0&&(Qs.z=1),Qs.normalize(),Ru.crossVectors(i,Qs),Ru.lengthSq()===0&&(Math.abs(i.z)===1?Qs.x+=1e-4:Qs.z+=1e-4,Qs.normalize(),Ru.crossVectors(i,Qs)),Ru.normalize(),l_.crossVectors(Qs,Ru),r[0]=Ru.x,r[4]=l_.x,r[8]=Qs.x,r[1]=Ru.y,r[5]=l_.y,r[9]=Qs.y,r[2]=Ru.z,r[6]=l_.z,r[10]=Qs.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],h=i[1],u=i[5],d=i[9],f=i[13],p=i[2],v=i[6],g=i[10],m=i[14],y=i[3],w=i[7],b=i[11],A=i[15],S=r[0],T=r[4],M=r[8],E=r[12],P=r[1],R=r[5],F=r[9],B=r[13],k=r[2],j=r[6],Z=r[10],ee=r[14],O=r[3],W=r[7],H=r[11],Y=r[15];return s[0]=o*S+a*P+l*k+c*O,s[4]=o*T+a*R+l*j+c*W,s[8]=o*M+a*F+l*Z+c*H,s[12]=o*E+a*B+l*ee+c*Y,s[1]=h*S+u*P+d*k+f*O,s[5]=h*T+u*R+d*j+f*W,s[9]=h*M+u*F+d*Z+f*H,s[13]=h*E+u*B+d*ee+f*Y,s[2]=p*S+v*P+g*k+m*O,s[6]=p*T+v*R+g*j+m*W,s[10]=p*M+v*F+g*Z+m*H,s[14]=p*E+v*B+g*ee+m*Y,s[3]=y*S+w*P+b*k+A*O,s[7]=y*T+w*R+b*j+A*W,s[11]=y*M+w*F+b*Z+A*H,s[15]=y*E+w*B+b*ee+A*Y,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],h=e[2],u=e[6],d=e[10],f=e[14],p=e[3],v=e[7],g=e[11],m=e[15];return p*(+s*l*u-r*c*u-s*a*d+i*c*d+r*a*f-i*l*f)+v*(+n*l*f-n*c*d+s*o*d-r*o*f+r*c*h-s*l*h)+g*(+n*c*u-n*a*f-s*o*u+i*o*f+s*a*h-i*c*h)+m*(-r*a*h-n*l*u+n*a*d+r*o*u-i*o*d+i*l*h)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=n,r[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8],u=e[9],d=e[10],f=e[11],p=e[12],v=e[13],g=e[14],m=e[15],y=u*g*c-v*d*c+v*l*f-a*g*f-u*l*m+a*d*m,w=p*d*c-h*g*c-p*l*f+o*g*f+h*l*m-o*d*m,b=h*v*c-p*u*c+p*a*f-o*v*f-h*a*m+o*u*m,A=p*u*l-h*v*l-p*a*d+o*v*d+h*a*g-o*u*g,S=n*y+i*w+r*b+s*A;if(S===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const T=1/S;return e[0]=y*T,e[1]=(v*d*s-u*g*s-v*r*f+i*g*f+u*r*m-i*d*m)*T,e[2]=(a*g*s-v*l*s+v*r*c-i*g*c-a*r*m+i*l*m)*T,e[3]=(u*l*s-a*d*s-u*r*c+i*d*c+a*r*f-i*l*f)*T,e[4]=w*T,e[5]=(h*g*s-p*d*s+p*r*f-n*g*f-h*r*m+n*d*m)*T,e[6]=(p*l*s-o*g*s-p*r*c+n*g*c+o*r*m-n*l*m)*T,e[7]=(o*d*s-h*l*s+h*r*c-n*d*c-o*r*f+n*l*f)*T,e[8]=b*T,e[9]=(p*u*s-h*v*s-p*i*f+n*v*f+h*i*m-n*u*m)*T,e[10]=(o*v*s-p*a*s+p*i*c-n*v*c-o*i*m+n*a*m)*T,e[11]=(h*a*s-o*u*s-h*i*c+n*u*c+o*i*f-n*a*f)*T,e[12]=A*T,e[13]=(h*v*r-p*u*r+p*i*d-n*v*d-h*i*g+n*u*g)*T,e[14]=(p*a*r-o*v*r-p*i*l+n*v*l+o*i*g-n*a*g)*T,e[15]=(o*u*r-h*a*r+h*i*l-n*u*l-o*i*d+n*a*d)*T,this}scale(e){const n=this.elements,i=e.x,r=e.y,s=e.z;return n[0]*=i,n[4]*=r,n[8]*=s,n[1]*=i,n[5]*=r,n[9]*=s,n[2]*=i,n[6]*=r,n[10]*=s,n[3]*=i,n[7]*=r,n[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,r))}makeTranslation(e,n,i){return this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),r=Math.sin(n),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,h=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,h*a+i,h*l-r*o,0,c*l-r*a,h*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,n,r,1,0,0,0,0,1),this}compose(e,n,i){const r=this.elements,s=n._x,o=n._y,a=n._z,l=n._w,c=s+s,h=o+o,u=a+a,d=s*c,f=s*h,p=s*u,v=o*h,g=o*u,m=a*u,y=l*c,w=l*h,b=l*u,A=i.x,S=i.y,T=i.z;return r[0]=(1-(v+m))*A,r[1]=(f+b)*A,r[2]=(p-w)*A,r[3]=0,r[4]=(f-b)*S,r[5]=(1-(d+m))*S,r[6]=(g+y)*S,r[7]=0,r[8]=(p+w)*T,r[9]=(g-y)*T,r[10]=(1-(d+v))*T,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,n,i){const r=this.elements;let s=Sp.set(r[0],r[1],r[2]).length();const o=Sp.set(r[4],r[5],r[6]).length(),a=Sp.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],ba.copy(this);const c=1/s,h=1/o,u=1/a;return ba.elements[0]*=c,ba.elements[1]*=c,ba.elements[2]*=c,ba.elements[4]*=h,ba.elements[5]*=h,ba.elements[6]*=h,ba.elements[8]*=u,ba.elements[9]*=u,ba.elements[10]*=u,n.setFromRotationMatrix(ba),i.x=s,i.y=o,i.z=a,this}makePerspective(e,n,i,r,s,o){const a=this.elements,l=2*s/(n-e),c=2*s/(i-r),h=(n+e)/(n-e),u=(i+r)/(i-r),d=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=l,a[4]=0,a[8]=h,a[12]=0,a[1]=0,a[5]=c,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,n,i,r,s,o){const a=this.elements,l=1/(n-e),c=1/(i-r),h=1/(o-s),u=(n+e)*l,d=(i+r)*c,f=(o+s)*h;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*h,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<16;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}}const Sp=new ae,ba=new kt,Vse=new ae(0,0,0),jse=new ae(1,1,1),Ru=new ae,l_=new ae,Qs=new ae,mz=new kt,gz=new _r;class a1{constructor(e=0,n=0,i=0,r=a1.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,r=this._order){return this._x=e,this._y=n,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],c=r[5],h=r[9],u=r[2],d=r[6],f=r[10];switch(n){case"XYZ":this._y=Math.asin(xi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-h,f),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-xi(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-u,s),this._z=0);break;case"ZXY":this._x=Math.asin(xi(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-u,f),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-xi(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(xi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,c),this._y=Math.atan2(-u,s)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-xi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-h,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return mz.makeRotationFromQuaternion(e),this.setFromRotationMatrix(mz,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return gz.setFromEuler(this),this.setFromQuaternion(gz,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}a1.DEFAULT_ORDER="XYZ";class gf{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let Wse=0;const vz=new ae,Ap=new _r,xc=new kt,c_=new ae,o0=new ae,Xse=new ae,Yse=new _r,yz=new ae(1,0,0),xz=new ae(0,1,0),wz=new ae(0,0,1),qse={type:"added"},_z={type:"removed"};class mn extends sc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Wse++}),this.uuid=xo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=mn.DEFAULT_UP.clone();const e=new ae,n=new a1,i=new _r,r=new ae(1,1,1);function s(){i.setFromEuler(n,!1)}function o(){n.setFromQuaternion(i,void 0,!1)}n._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new kt},normalMatrix:{value:new ln}}),this.matrix=new kt,this.matrixWorld=new kt,this.matrixAutoUpdate=mn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=mn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new gf,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return Ap.setFromAxisAngle(e,n),this.quaternion.multiply(Ap),this}rotateOnWorldAxis(e,n){return Ap.setFromAxisAngle(e,n),this.quaternion.premultiply(Ap),this}rotateX(e){return this.rotateOnAxis(yz,e)}rotateY(e){return this.rotateOnAxis(xz,e)}rotateZ(e){return this.rotateOnAxis(wz,e)}translateOnAxis(e,n){return vz.copy(e).applyQuaternion(this.quaternion),this.position.add(vz.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(yz,e)}translateY(e){return this.translateOnAxis(xz,e)}translateZ(e){return this.translateOnAxis(wz,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(xc.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?c_.copy(e):c_.set(e,n,i);const r=this.parent;this.updateWorldMatrix(!0,!1),o0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?xc.lookAt(o0,c_,this.up):xc.lookAt(c_,o0,this.up),this.quaternion.setFromRotationMatrix(xc),r&&(xc.extractRotation(r.matrixWorld),Ap.setFromRotationMatrix(xc),this.quaternion.premultiply(Ap.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(qse)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(_z)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const n=this.children[e];n.parent=null,n.dispatchEvent(_z)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),xc.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),xc.multiply(e.parent.matrixWorld)),e.applyMatrix4(xc),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,n);if(o!==void 0)return o}}getObjectsByProperty(e,n){let i=[];this[e]===n&&i.push(this);for(let r=0,s=this.children.length;r<s;r++){const o=this.children[r].getObjectsByProperty(e,n);o.length>0&&(i=i.concat(o))}return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(o0,e,Xse),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(o0,Yse,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,r=n.length;i<r;i++){const s=n[i];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++){const a=r[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,h=l.length;c<h;c++){const u=l[c];s(e.shapes,u)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(n){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),h=o(e.images),u=o(e.shapes),d=o(e.skeletons),f=o(e.animations),p=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),c.length>0&&(i.textures=c),h.length>0&&(i.images=h),u.length>0&&(i.shapes=u),d.length>0&&(i.skeletons=d),f.length>0&&(i.animations=f),p.length>0&&(i.nodes=p)}return i.object=r,i;function o(a){const l=[];for(const c in a){const h=a[c];delete h.metadata,l.push(h)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations,this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}mn.DEFAULT_UP=new ae(0,1,0);mn.DEFAULT_MATRIX_AUTO_UPDATE=!0;mn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Sa=new ae,wc=new ae,VT=new ae,_c=new ae,Mp=new ae,Ep=new ae,bz=new ae,jT=new ae,WT=new ae,XT=new ae;let u_=!1;class Ts{constructor(e=new ae,n=new ae,i=new ae){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,r){r.subVectors(i,n),Sa.subVectors(e,n),r.cross(Sa);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,n,i,r,s){Sa.subVectors(r,n),wc.subVectors(i,n),VT.subVectors(e,n);const o=Sa.dot(Sa),a=Sa.dot(wc),l=Sa.dot(VT),c=wc.dot(wc),h=wc.dot(VT),u=o*c-a*a;if(u===0)return s.set(-2,-1,-1);const d=1/u,f=(c*l-a*h)*d,p=(o*h-a*l)*d;return s.set(1-f-p,p,f)}static containsPoint(e,n,i,r){return this.getBarycoord(e,n,i,r,_c),_c.x>=0&&_c.y>=0&&_c.x+_c.y<=1}static getUV(e,n,i,r,s,o,a,l){return u_===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),u_=!0),this.getInterpolation(e,n,i,r,s,o,a,l)}static getInterpolation(e,n,i,r,s,o,a,l){return this.getBarycoord(e,n,i,r,_c),l.setScalar(0),l.addScaledVector(s,_c.x),l.addScaledVector(o,_c.y),l.addScaledVector(a,_c.z),l}static isFrontFacing(e,n,i,r){return Sa.subVectors(i,n),wc.subVectors(e,n),Sa.cross(wc).dot(r)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,r){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,n,i,r){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Sa.subVectors(this.c,this.b),wc.subVectors(this.a,this.b),Sa.cross(wc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Ts.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return Ts.getBarycoord(e,this.a,this.b,this.c,n)}getUV(e,n,i,r,s){return u_===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),u_=!0),Ts.getInterpolation(e,this.a,this.b,this.c,n,i,r,s)}getInterpolation(e,n,i,r,s){return Ts.getInterpolation(e,this.a,this.b,this.c,n,i,r,s)}containsPoint(e){return Ts.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Ts.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,r=this.b,s=this.c;let o,a;Mp.subVectors(r,i),Ep.subVectors(s,i),jT.subVectors(e,i);const l=Mp.dot(jT),c=Ep.dot(jT);if(l<=0&&c<=0)return n.copy(i);WT.subVectors(e,r);const h=Mp.dot(WT),u=Ep.dot(WT);if(h>=0&&u<=h)return n.copy(r);const d=l*u-h*c;if(d<=0&&l>=0&&h<=0)return o=l/(l-h),n.copy(i).addScaledVector(Mp,o);XT.subVectors(e,s);const f=Mp.dot(XT),p=Ep.dot(XT);if(p>=0&&f<=p)return n.copy(s);const v=f*c-l*p;if(v<=0&&c>=0&&p<=0)return a=c/(c-p),n.copy(i).addScaledVector(Ep,a);const g=h*p-f*u;if(g<=0&&u-h>=0&&f-p>=0)return bz.subVectors(s,r),a=(u-h)/(u-h+(f-p)),n.copy(r).addScaledVector(bz,a);const m=1/(g+v+d);return o=v*m,a=d*m,n.copy(i).addScaledVector(Mp,o).addScaledVector(Ep,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Qse=0;class Vi extends sc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Qse++}),this.uuid=xo(),this.name="",this.type="Material",this.blending=df,this.side=Zl,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=dB,this.blendDst=fB,this.blendEquation=Wd,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=yA,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=C7,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=CS,this.stencilZFail=CS,this.stencilZPass=CS,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const i=e[n];if(i===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const r=this[n];if(r===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==df&&(i.blending=this.blending),this.side!==Zl&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(i.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(n){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(n!==null){const r=n.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=n[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}const L7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Aa={h:0,s:0,l:0},h_={h:0,s:0,l:0};function YT(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}class st{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,n===void 0&&i===void 0?this.set(e):this.setRGB(e,n,i)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=Jt){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,jo.toWorkingColorSpace(this,n),this}setRGB(e,n,i,r=jo.workingColorSpace){return this.r=e,this.g=n,this.b=i,jo.toWorkingColorSpace(this,r),this}setHSL(e,n,i,r=jo.workingColorSpace){if(e=wB(e,1),n=xi(n,0,1),i=xi(i,0,1),n===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+n):i+n-i*n,o=2*i-s;this.r=YT(o,s,e+1/3),this.g=YT(o,s,e),this.b=YT(o,s,e-1/3)}return jo.toWorkingColorSpace(this,r),this}setStyle(e,n=Jt){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,n);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,n);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,n);if(o===6)return this.setHex(parseInt(s,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=Jt){const i=L7[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=lg(e.r),this.g=lg(e.g),this.b=lg(e.b),this}copyLinearToSRGB(e){return this.r=OT(e.r),this.g=OT(e.g),this.b=OT(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Jt){return jo.fromWorkingColorSpace(jr.copy(this),e),Math.round(xi(jr.r*255,0,255))*65536+Math.round(xi(jr.g*255,0,255))*256+Math.round(xi(jr.b*255,0,255))}getHexString(e=Jt){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=jo.workingColorSpace){jo.fromWorkingColorSpace(jr.copy(this),n);const i=jr.r,r=jr.g,s=jr.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const h=(a+o)/2;if(a===o)l=0,c=0;else{const u=o-a;switch(c=h<=.5?u/(o+a):u/(2-o-a),o){case i:l=(r-s)/u+(r<s?6:0);break;case r:l=(s-i)/u+2;break;case s:l=(i-r)/u+4;break}l/=6}return e.h=l,e.s=c,e.l=h,e}getRGB(e,n=jo.workingColorSpace){return jo.fromWorkingColorSpace(jr.copy(this),n),e.r=jr.r,e.g=jr.g,e.b=jr.b,e}getStyle(e=Jt){jo.fromWorkingColorSpace(jr.copy(this),e);const n=jr.r,i=jr.g,r=jr.b;return e!==Jt?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,n,i){return this.getHSL(Aa),Aa.h+=e,Aa.s+=n,Aa.l+=i,this.setHSL(Aa.h,Aa.s,Aa.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(Aa),e.getHSL(h_);const i=Ay(Aa.h,h_.h,n),r=Ay(Aa.s,h_.s,n),s=Ay(Aa.l,h_.l,n);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*n+s[3]*i+s[6]*r,this.g=s[1]*n+s[4]*i+s[7]*r,this.b=s[2]*n+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const jr=new st;st.NAMES=L7;class lo extends Vi{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new st(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=s1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Uc=Kse();function Kse(){const t=new ArrayBuffer(4),e=new Float32Array(t),n=new Uint32Array(t),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(i[l]=0,i[l|256]=32768,r[l]=24,r[l|256]=24):c<-14?(i[l]=1024>>-c-14,i[l|256]=1024>>-c-14|32768,r[l]=-c-1,r[l|256]=-c-1):c<=15?(i[l]=c+15<<10,i[l|256]=c+15<<10|32768,r[l]=13,r[l|256]=13):c<128?(i[l]=31744,i[l|256]=64512,r[l]=24,r[l|256]=24):(i[l]=31744,i[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,h=0;for(;!(c&8388608);)c<<=1,h-=8388608;c&=-8388609,h+=947912704,s[l]=c|h}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:n,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function Es(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=xi(t,-65504,65504),Uc.floatView[0]=t;const e=Uc.uint32View[0],n=e>>23&511;return Uc.baseTable[n]+((e&8388607)>>Uc.shiftTable[n])}function iy(t){const e=t>>10;return Uc.uint32View[0]=Uc.mantissaTable[Uc.offsetTable[e]+(t&1023)]+Uc.exponentTable[e],Uc.floatView[0]}const Jse={toHalfFloat:Es,fromHalfFloat:iy},Oi=new ae,d_=new Ye;class Sn{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=yx,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=n.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)d_.fromBufferAttribute(this,n),d_.applyMatrix3(e),this.setXY(n,d_.x,d_.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)Oi.fromBufferAttribute(this,n),Oi.applyMatrix3(e),this.setXYZ(n,Oi.x,Oi.y,Oi.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)Oi.fromBufferAttribute(this,n),Oi.applyMatrix4(e),this.setXYZ(n,Oi.x,Oi.y,Oi.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)Oi.fromBufferAttribute(this,n),Oi.applyNormalMatrix(e),this.setXYZ(n,Oi.x,Oi.y,Oi.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)Oi.fromBufferAttribute(this,n),Oi.transformDirection(e),this.setXYZ(n,Oi.x,Oi.y,Oi.z);return this}set(e,n=0){return this.array.set(e,n),this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=ao(n,this.array)),n}setX(e,n){return this.normalized&&(n=nn(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=ao(n,this.array)),n}setY(e,n){return this.normalized&&(n=nn(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=ao(n,this.array)),n}setZ(e,n){return this.normalized&&(n=nn(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=ao(n,this.array)),n}setW(e,n){return this.normalized&&(n=nn(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=nn(n,this.array),i=nn(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=nn(n,this.array),i=nn(i,this.array),r=nn(r,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=nn(n,this.array),i=nn(i,this.array),r=nn(r,this.array),s=nn(s,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==yx&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class Zse extends Sn{constructor(e,n,i){super(new Int8Array(e),n,i)}}class $se extends Sn{constructor(e,n,i){super(new Uint8Array(e),n,i)}}class eoe extends Sn{constructor(e,n,i){super(new Uint8ClampedArray(e),n,i)}}class toe extends Sn{constructor(e,n,i){super(new Int16Array(e),n,i)}}class SB extends Sn{constructor(e,n,i){super(new Uint16Array(e),n,i)}}class noe extends Sn{constructor(e,n,i){super(new Int32Array(e),n,i)}}class AB extends Sn{constructor(e,n,i){super(new Uint32Array(e),n,i)}}class ioe extends Sn{constructor(e,n,i){super(new Uint16Array(e),n,i),this.isFloat16BufferAttribute=!0}getX(e){let n=iy(this.array[e*this.itemSize]);return this.normalized&&(n=ao(n,this.array)),n}setX(e,n){return this.normalized&&(n=nn(n,this.array)),this.array[e*this.itemSize]=Es(n),this}getY(e){let n=iy(this.array[e*this.itemSize+1]);return this.normalized&&(n=ao(n,this.array)),n}setY(e,n){return this.normalized&&(n=nn(n,this.array)),this.array[e*this.itemSize+1]=Es(n),this}getZ(e){let n=iy(this.array[e*this.itemSize+2]);return this.normalized&&(n=ao(n,this.array)),n}setZ(e,n){return this.normalized&&(n=nn(n,this.array)),this.array[e*this.itemSize+2]=Es(n),this}getW(e){let n=iy(this.array[e*this.itemSize+3]);return this.normalized&&(n=ao(n,this.array)),n}setW(e,n){return this.normalized&&(n=nn(n,this.array)),this.array[e*this.itemSize+3]=Es(n),this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=nn(n,this.array),i=nn(i,this.array)),this.array[e+0]=Es(n),this.array[e+1]=Es(i),this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=nn(n,this.array),i=nn(i,this.array),r=nn(r,this.array)),this.array[e+0]=Es(n),this.array[e+1]=Es(i),this.array[e+2]=Es(r),this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=nn(n,this.array),i=nn(i,this.array),r=nn(r,this.array),s=nn(s,this.array)),this.array[e+0]=Es(n),this.array[e+1]=Es(i),this.array[e+2]=Es(r),this.array[e+3]=Es(s),this}}class xt extends Sn{constructor(e,n,i){super(new Float32Array(e),n,i)}}class roe extends Sn{constructor(e,n,i){super(new Float64Array(e),n,i)}}let soe=0;const Fo=new kt,qT=new mn,Cp=new ae,Ks=new il,a0=new il,hr=new ae;class Kt extends sc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:soe++}),this.uuid=xo(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(R7(e)?AB:SB)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new ln().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Fo.makeRotationFromQuaternion(e),this.applyMatrix4(Fo),this}rotateX(e){return Fo.makeRotationX(e),this.applyMatrix4(Fo),this}rotateY(e){return Fo.makeRotationY(e),this.applyMatrix4(Fo),this}rotateZ(e){return Fo.makeRotationZ(e),this.applyMatrix4(Fo),this}translate(e,n,i){return Fo.makeTranslation(e,n,i),this.applyMatrix4(Fo),this}scale(e,n,i){return Fo.makeScale(e,n,i),this.applyMatrix4(Fo),this}lookAt(e){return qT.lookAt(e),qT.updateMatrix(),this.applyMatrix4(qT.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Cp).negate(),this.translate(Cp.x,Cp.y,Cp.z),this}setFromPoints(e){const n=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];n.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new xt(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new il);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new ae(-1/0,-1/0,-1/0),new ae(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,r=n.length;i<r;i++){const s=n[i];Ks.setFromBufferAttribute(s),this.morphTargetsRelative?(hr.addVectors(this.boundingBox.min,Ks.min),this.boundingBox.expandByPoint(hr),hr.addVectors(this.boundingBox.max,Ks.max),this.boundingBox.expandByPoint(hr)):(this.boundingBox.expandByPoint(Ks.min),this.boundingBox.expandByPoint(Ks.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new rl);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new ae,1/0);return}if(e){const i=this.boundingSphere.center;if(Ks.setFromBufferAttribute(e),n)for(let s=0,o=n.length;s<o;s++){const a=n[s];a0.setFromBufferAttribute(a),this.morphTargetsRelative?(hr.addVectors(Ks.min,a0.min),Ks.expandByPoint(hr),hr.addVectors(Ks.max,a0.max),Ks.expandByPoint(hr)):(Ks.expandByPoint(a0.min),Ks.expandByPoint(a0.max))}Ks.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)hr.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(hr));if(n)for(let s=0,o=n.length;s<o;s++){const a=n[s],l=this.morphTargetsRelative;for(let c=0,h=a.count;c<h;c++)hr.fromBufferAttribute(a,c),l&&(Cp.fromBufferAttribute(e,c),hr.add(Cp)),r=Math.max(r,i.distanceToSquared(hr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,r=n.position.array,s=n.normal.array,o=n.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Sn(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],h=[];for(let P=0;P<a;P++)c[P]=new ae,h[P]=new ae;const u=new ae,d=new ae,f=new ae,p=new Ye,v=new Ye,g=new Ye,m=new ae,y=new ae;function w(P,R,F){u.fromArray(r,P*3),d.fromArray(r,R*3),f.fromArray(r,F*3),p.fromArray(o,P*2),v.fromArray(o,R*2),g.fromArray(o,F*2),d.sub(u),f.sub(u),v.sub(p),g.sub(p);const B=1/(v.x*g.y-g.x*v.y);isFinite(B)&&(m.copy(d).multiplyScalar(g.y).addScaledVector(f,-v.y).multiplyScalar(B),y.copy(f).multiplyScalar(v.x).addScaledVector(d,-g.x).multiplyScalar(B),c[P].add(m),c[R].add(m),c[F].add(m),h[P].add(y),h[R].add(y),h[F].add(y))}let b=this.groups;b.length===0&&(b=[{start:0,count:i.length}]);for(let P=0,R=b.length;P<R;++P){const F=b[P],B=F.start,k=F.count;for(let j=B,Z=B+k;j<Z;j+=3)w(i[j+0],i[j+1],i[j+2])}const A=new ae,S=new ae,T=new ae,M=new ae;function E(P){T.fromArray(s,P*3),M.copy(T);const R=c[P];A.copy(R),A.sub(T.multiplyScalar(T.dot(R))).normalize(),S.crossVectors(M,R);const B=S.dot(h[P])<0?-1:1;l[P*4]=A.x,l[P*4+1]=A.y,l[P*4+2]=A.z,l[P*4+3]=B}for(let P=0,R=b.length;P<R;++P){const F=b[P],B=F.start,k=F.count;for(let j=B,Z=B+k;j<Z;j+=3)E(i[j+0]),E(i[j+1]),E(i[j+2])}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Sn(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let d=0,f=i.count;d<f;d++)i.setXYZ(d,0,0,0);const r=new ae,s=new ae,o=new ae,a=new ae,l=new ae,c=new ae,h=new ae,u=new ae;if(e)for(let d=0,f=e.count;d<f;d+=3){const p=e.getX(d+0),v=e.getX(d+1),g=e.getX(d+2);r.fromBufferAttribute(n,p),s.fromBufferAttribute(n,v),o.fromBufferAttribute(n,g),h.subVectors(o,s),u.subVectors(r,s),h.cross(u),a.fromBufferAttribute(i,p),l.fromBufferAttribute(i,v),c.fromBufferAttribute(i,g),a.add(h),l.add(h),c.add(h),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(v,l.x,l.y,l.z),i.setXYZ(g,c.x,c.y,c.z)}else for(let d=0,f=n.count;d<f;d+=3)r.fromBufferAttribute(n,d+0),s.fromBufferAttribute(n,d+1),o.fromBufferAttribute(n,d+2),h.subVectors(o,s),u.subVectors(r,s),h.cross(u),i.setXYZ(d+0,h.x,h.y,h.z),i.setXYZ(d+1,h.x,h.y,h.z),i.setXYZ(d+2,h.x,h.y,h.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)hr.fromBufferAttribute(e,n),hr.normalize(),e.setXYZ(n,hr.x,hr.y,hr.z)}toNonIndexed(){function e(a,l){const c=a.array,h=a.itemSize,u=a.normalized,d=new c.constructor(l.length*h);let f=0,p=0;for(let v=0,g=l.length;v<g;v++){a.isInterleavedBufferAttribute?f=l[v]*a.data.stride+a.offset:f=l[v]*h;for(let m=0;m<h;m++)d[p++]=c[f++]}return new Sn(d,h,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new Kt,i=this.index.array,r=this.attributes;for(const a in r){const l=r[a],c=e(l,i);n.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let h=0,u=c.length;h<u;h++){const d=c[h],f=e(d,i);l.push(f)}n.morphAttributes[a]=l}n.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];n.addGroup(c.start,c.count,c.materialIndex)}return n}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const l in i){const c=i[l];e.data.attributes[l]=c.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],h=[];for(let u=0,d=c.length;u<d;u++){const f=c[u];h.push(f.toJSON(e.data))}h.length>0&&(r[l]=h,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(n));const r=e.attributes;for(const c in r){const h=r[c];this.setAttribute(c,h.clone(n))}const s=e.morphAttributes;for(const c in s){const h=[],u=s[c];for(let d=0,f=u.length;d<f;d++)h.push(u[d].clone(n));this.morphAttributes[c]=h}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,h=o.length;c<h;c++){const u=o[c];this.addGroup(u.start,u.count,u.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Sz=new kt,vl=new o1,f_=new rl,Az=new ae,Tp=new ae,Pp=new ae,Dp=new ae,QT=new ae,p_=new ae,m_=new Ye,g_=new Ye,v_=new Ye,Mz=new ae,Ez=new ae,Cz=new ae,y_=new ae,x_=new ae;class yr extends mn{constructor(e=new Kt,n=new lo){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,n){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;n.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){p_.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const h=a[l],u=s[l];h!==0&&(QT.fromBufferAttribute(u,e),o?p_.addScaledVector(QT,h):p_.addScaledVector(QT.sub(n),h))}n.add(p_)}return n}raycast(e,n){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),f_.copy(i.boundingSphere),f_.applyMatrix4(s),vl.copy(e.ray).recast(e.near),!(f_.containsPoint(vl.origin)===!1&&(vl.intersectSphere(f_,Az)===null||vl.origin.distanceToSquared(Az)>(e.far-e.near)**2))&&(Sz.copy(s).invert(),vl.copy(e.ray).applyMatrix4(Sz),!(i.boundingBox!==null&&vl.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n)))}_computeIntersections(e,n){let i;const r=this.geometry,s=this.material,o=r.index,a=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv1,h=r.attributes.normal,u=r.groups,d=r.drawRange;if(o!==null)if(Array.isArray(s))for(let f=0,p=u.length;f<p;f++){const v=u[f],g=s[v.materialIndex],m=Math.max(v.start,d.start),y=Math.min(o.count,Math.min(v.start+v.count,d.start+d.count));for(let w=m,b=y;w<b;w+=3){const A=o.getX(w),S=o.getX(w+1),T=o.getX(w+2);i=w_(this,g,e,vl,l,c,h,A,S,T),i&&(i.faceIndex=Math.floor(w/3),i.face.materialIndex=v.materialIndex,n.push(i))}}else{const f=Math.max(0,d.start),p=Math.min(o.count,d.start+d.count);for(let v=f,g=p;v<g;v+=3){const m=o.getX(v),y=o.getX(v+1),w=o.getX(v+2);i=w_(this,s,e,vl,l,c,h,m,y,w),i&&(i.faceIndex=Math.floor(v/3),n.push(i))}}else if(a!==void 0)if(Array.isArray(s))for(let f=0,p=u.length;f<p;f++){const v=u[f],g=s[v.materialIndex],m=Math.max(v.start,d.start),y=Math.min(a.count,Math.min(v.start+v.count,d.start+d.count));for(let w=m,b=y;w<b;w+=3){const A=w,S=w+1,T=w+2;i=w_(this,g,e,vl,l,c,h,A,S,T),i&&(i.faceIndex=Math.floor(w/3),i.face.materialIndex=v.materialIndex,n.push(i))}}else{const f=Math.max(0,d.start),p=Math.min(a.count,d.start+d.count);for(let v=f,g=p;v<g;v+=3){const m=v,y=v+1,w=v+2;i=w_(this,s,e,vl,l,c,h,m,y,w),i&&(i.faceIndex=Math.floor(v/3),n.push(i))}}}}function ooe(t,e,n,i,r,s,o,a){let l;if(e.side===gs?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===Zl,a),l===null)return null;x_.copy(a),x_.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(x_);return c<n.near||c>n.far?null:{distance:c,point:x_.clone(),object:t}}function w_(t,e,n,i,r,s,o,a,l,c){t.getVertexPosition(a,Tp),t.getVertexPosition(l,Pp),t.getVertexPosition(c,Dp);const h=ooe(t,e,n,i,Tp,Pp,Dp,y_);if(h){r&&(m_.fromBufferAttribute(r,a),g_.fromBufferAttribute(r,l),v_.fromBufferAttribute(r,c),h.uv=Ts.getInterpolation(y_,Tp,Pp,Dp,m_,g_,v_,new Ye)),s&&(m_.fromBufferAttribute(s,a),g_.fromBufferAttribute(s,l),v_.fromBufferAttribute(s,c),h.uv1=Ts.getInterpolation(y_,Tp,Pp,Dp,m_,g_,v_,new Ye),h.uv2=h.uv1),o&&(Mz.fromBufferAttribute(o,a),Ez.fromBufferAttribute(o,l),Cz.fromBufferAttribute(o,c),h.normal=Ts.getInterpolation(y_,Tp,Pp,Dp,Mz,Ez,Cz,new ae),h.normal.dot(i.direction)>0&&h.normal.multiplyScalar(-1));const u={a,b:l,c,normal:new ae,materialIndex:0};Ts.getNormal(Tp,Pp,Dp,u.normal),h.face=u}return h}class td extends Kt{constructor(e=1,n=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],h=[],u=[];let d=0,f=0;p("z","y","x",-1,-1,i,n,e,o,s,0),p("z","y","x",1,-1,i,n,-e,o,s,1),p("x","z","y",1,1,e,i,n,r,o,2),p("x","z","y",1,-1,e,i,-n,r,o,3),p("x","y","z",1,-1,e,n,i,r,s,4),p("x","y","z",-1,-1,e,n,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new xt(c,3)),this.setAttribute("normal",new xt(h,3)),this.setAttribute("uv",new xt(u,2));function p(v,g,m,y,w,b,A,S,T,M,E){const P=b/T,R=A/M,F=b/2,B=A/2,k=S/2,j=T+1,Z=M+1;let ee=0,O=0;const W=new ae;for(let H=0;H<Z;H++){const Y=H*R-B;for(let z=0;z<j;z++){const X=z*P-F;W[v]=X*y,W[g]=Y*w,W[m]=k,c.push(W.x,W.y,W.z),W[v]=0,W[g]=0,W[m]=S>0?1:-1,h.push(W.x,W.y,W.z),u.push(z/T),u.push(1-H/M),ee+=1}}for(let H=0;H<M;H++)for(let Y=0;Y<T;Y++){const z=d+Y+j*H,X=d+Y+j*(H+1),q=d+(Y+1)+j*(H+1),re=d+(Y+1)+j*H;l.push(z,X,re),l.push(X,q,re),O+=6}a.addGroup(f,O,E),f+=O,d+=ee}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new td(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Ng(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][i]=null):e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function cs(t){const e={};for(let n=0;n<t.length;n++){const i=Ng(t[n]);for(const r in i)e[r]=i[r]}return e}function aoe(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function I7(t){return t.getRenderTarget()===null?t.outputColorSpace:Ja}const B7={clone:Ng,merge:cs};var loe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,coe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ec extends Vi{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=loe,this.fragmentShader=coe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ng(e.uniforms),this.uniformsGroups=aoe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?n.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?n.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?n.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?n.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?n.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?n.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?n.uniforms[r]={type:"m4",value:o.toArray()}:n.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}}class l1 extends mn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new kt,this.projectionMatrix=new kt,this.projectionMatrixInverse=new kt}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(-n[8],-n[9],-n[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Gn extends l1{constructor(e=50,n=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=Fg*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(mf*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Fg*2*Math.atan(Math.tan(mf*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,n,i,r,s,o){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(mf*.5*this.fov)/this.zoom,i=2*n,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,n-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,n,n-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const Rp=-90,Lp=1;class MB extends mn{constructor(e,n,i){super(),this.type="CubeCamera",this.renderTarget=i;const r=new Gn(Rp,Lp,e,n);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);const s=new Gn(Rp,Lp,e,n);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(-1,0,0),this.add(s);const o=new Gn(Rp,Lp,e,n);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(0,1,0),this.add(o);const a=new Gn(Rp,Lp,e,n);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);const l=new Gn(Rp,Lp,e,n);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,1),this.add(l);const c=new Gn(Rp,Lp,e,n);c.layers=this.layers,c.up.set(0,1,0),c.lookAt(0,0,-1),this.add(c)}update(e,n){this.parent===null&&this.updateMatrixWorld();const i=this.renderTarget,[r,s,o,a,l,c]=this.children,h=e.getRenderTarget(),u=e.toneMapping,d=e.xr.enabled;e.toneMapping=Ya,e.xr.enabled=!1;const f=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(n,r),e.setRenderTarget(i,1),e.render(n,s),e.setRenderTarget(i,2),e.render(n,o),e.setRenderTarget(i,3),e.render(n,a),e.setRenderTarget(i,4),e.render(n,l),i.texture.generateMipmaps=f,e.setRenderTarget(i,5),e.render(n,c),e.setRenderTarget(h),e.toneMapping=u,e.xr.enabled=d,i.texture.needsPMREMUpdate=!0}}class c1 extends ii{constructor(e,n,i,r,s,o,a,l,c,h){e=e!==void 0?e:[],n=n!==void 0?n:Hh,super(e,n,i,r,s,o,a,l,c,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class EB extends Za{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];n.encoding!==void 0&&(My("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),n.colorSpace=n.encoding===yo?Jt:Lh),this.texture=new c1(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:ai}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new td(5,5,5),s=new ec({name:"CubemapFromEquirect",uniforms:Ng(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:gs,blending:Qc});s.uniforms.tEquirect.value=n;const o=new yr(r,s),a=n.minFilter;return n.minFilter===$l&&(n.minFilter=ai),new MB(1,10,this).update(e,o),n.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,n,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(n,i,r);e.setRenderTarget(s)}}const KT=new ae,uoe=new ae,hoe=new ln;class $u{constructor(e=new ae(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,r){return this.normal.set(e,n,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const r=KT.subVectors(i,n).cross(uoe.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const i=e.delta(KT),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:n.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||hoe.getNormalMatrix(e),r=this.coplanarPoint(KT).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const xd=new rl,__=new ae;class ZM{constructor(e=new $u,n=new $u,i=new $u,r=new $u,s=new $u,o=new $u){this.planes=[e,n,i,r,s,o]}set(e,n,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(n),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const n=this.planes,i=e.elements,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5],h=i[6],u=i[7],d=i[8],f=i[9],p=i[10],v=i[11],g=i[12],m=i[13],y=i[14],w=i[15];return n[0].setComponents(a-r,u-l,v-d,w-g).normalize(),n[1].setComponents(a+r,u+l,v+d,w+g).normalize(),n[2].setComponents(a+s,u+c,v+f,w+m).normalize(),n[3].setComponents(a-s,u-c,v-f,w-m).normalize(),n[4].setComponents(a-o,u-h,v-p,w-y).normalize(),n[5].setComponents(a+o,u+h,v+p,w+y).normalize(),this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),xd.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),xd.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(xd)}intersectsSprite(e){return xd.center.set(0,0,0),xd.radius=.7071067811865476,xd.applyMatrix4(e.matrixWorld),this.intersectsSphere(xd)}intersectsSphere(e){const n=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(n[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const r=n[i];if(__.x=r.normal.x>0?e.max.x:e.min.x,__.y=r.normal.y>0?e.max.y:e.min.y,__.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(__)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function O7(){let t=null,e=!1,n=null,i=null;function r(s,o){n(s,o),i=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&n!==null&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){n=s},setContext:function(s){t=s}}}function doe(t,e){const n=e.isWebGL2,i=new WeakMap;function r(c,h){const u=c.array,d=c.usage,f=t.createBuffer();t.bindBuffer(h,f),t.bufferData(h,u,d),c.onUploadCallback();let p;if(u instanceof Float32Array)p=t.FLOAT;else if(u instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(n)p=t.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else p=t.UNSIGNED_SHORT;else if(u instanceof Int16Array)p=t.SHORT;else if(u instanceof Uint32Array)p=t.UNSIGNED_INT;else if(u instanceof Int32Array)p=t.INT;else if(u instanceof Int8Array)p=t.BYTE;else if(u instanceof Uint8Array)p=t.UNSIGNED_BYTE;else if(u instanceof Uint8ClampedArray)p=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:f,type:p,bytesPerElement:u.BYTES_PER_ELEMENT,version:c.version}}function s(c,h,u){const d=h.array,f=h.updateRange;t.bindBuffer(u,c),f.count===-1?t.bufferSubData(u,0,d):(n?t.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):t.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1),h.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const h=i.get(c);h&&(t.deleteBuffer(h.buffer),i.delete(c))}function l(c,h){if(c.isGLBufferAttribute){const d=i.get(c);(!d||d.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const u=i.get(c);u===void 0?i.set(c,r(c,h)):u.version<c.version&&(s(u.buffer,c,h),u.version=c.version)}return{get:o,remove:a,update:l}}class hv extends Kt{constructor(e=1,n=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:r};const s=e/2,o=n/2,a=Math.floor(i),l=Math.floor(r),c=a+1,h=l+1,u=e/a,d=n/l,f=[],p=[],v=[],g=[];for(let m=0;m<h;m++){const y=m*d-o;for(let w=0;w<c;w++){const b=w*u-s;p.push(b,-y,0),v.push(0,0,1),g.push(w/a),g.push(1-m/l)}}for(let m=0;m<l;m++)for(let y=0;y<a;y++){const w=y+c*m,b=y+c*(m+1),A=y+1+c*(m+1),S=y+1+c*m;f.push(w,b,S),f.push(b,A,S)}this.setIndex(f),this.setAttribute("position",new xt(p,3)),this.setAttribute("normal",new xt(v,3)),this.setAttribute("uv",new xt(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hv(e.width,e.height,e.widthSegments,e.heightSegments)}}var foe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,poe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,moe=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,goe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,voe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,yoe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,xoe="vec3 transformed = vec3( position );",woe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,_oe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,boe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Soe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Aoe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Moe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Eoe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Coe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Toe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Poe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Doe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Roe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Loe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Ioe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Boe=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Ooe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Foe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Noe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Uoe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,koe="gl_FragColor = linearToOutputTexel( gl_FragColor );",zoe=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Goe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Hoe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Voe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,joe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Woe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Xoe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Yoe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,qoe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Qoe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Koe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Joe=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,Zoe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,$oe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,eae=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,tae=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,nae=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,iae=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,rae=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,sae=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,oae=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,aae=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif`,lae=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,cae=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,uae=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,hae=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,dae=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,fae=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,pae=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,mae=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,gae=`#ifdef USE_MAP
	diffuseColor *= texture2D( map, vMapUv );
#endif`,vae=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,yae=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,xae=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,wae=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,_ae=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,bae=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Sae=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Aae=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Mae=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Eae=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#ifdef USE_NORMALMAP_TANGENTSPACE
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal, vNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 geometryNormal = normal;`,Cae=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Tae=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Pae=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Dae=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Rae=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Lae=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,Iae=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Bae=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Oae=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Fae=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Nae=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Uae=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,kae=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,zae=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Gae=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Hae=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Vae=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,jae=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,Wae=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Xae=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Yae=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,qae=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Qae=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,Kae=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Jae=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Zae=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,$ae=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,ele=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tle=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,nle=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,ile=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,rle=`#ifdef USE_UV
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,sle=`#ifdef USE_UV
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,ole=`#ifdef USE_UV
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,ale=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const lle=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cle=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,ule=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,hle=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,dle=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fle=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,ple=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,mle=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,gle=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,vle=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,yle=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,xle=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,wle=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,_le=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,ble=`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Sle=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Ale=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Mle=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Ele=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Cle=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Tle=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Ple=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Dle=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Rle=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Lle=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Ile=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Ble=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Ole=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Fle=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Nle=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Ule=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,kle=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,zle=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Gle=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,tn={alphamap_fragment:foe,alphamap_pars_fragment:poe,alphatest_fragment:moe,alphatest_pars_fragment:goe,aomap_fragment:voe,aomap_pars_fragment:yoe,begin_vertex:xoe,beginnormal_vertex:woe,bsdfs:_oe,iridescence_fragment:boe,bumpmap_pars_fragment:Soe,clipping_planes_fragment:Aoe,clipping_planes_pars_fragment:Moe,clipping_planes_pars_vertex:Eoe,clipping_planes_vertex:Coe,color_fragment:Toe,color_pars_fragment:Poe,color_pars_vertex:Doe,color_vertex:Roe,common:Loe,cube_uv_reflection_fragment:Ioe,defaultnormal_vertex:Boe,displacementmap_pars_vertex:Ooe,displacementmap_vertex:Foe,emissivemap_fragment:Noe,emissivemap_pars_fragment:Uoe,encodings_fragment:koe,encodings_pars_fragment:zoe,envmap_fragment:Goe,envmap_common_pars_fragment:Hoe,envmap_pars_fragment:Voe,envmap_pars_vertex:joe,envmap_physical_pars_fragment:nae,envmap_vertex:Woe,fog_vertex:Xoe,fog_pars_vertex:Yoe,fog_fragment:qoe,fog_pars_fragment:Qoe,gradientmap_pars_fragment:Koe,lightmap_fragment:Joe,lightmap_pars_fragment:Zoe,lights_lambert_fragment:$oe,lights_lambert_pars_fragment:eae,lights_pars_begin:tae,lights_toon_fragment:iae,lights_toon_pars_fragment:rae,lights_phong_fragment:sae,lights_phong_pars_fragment:oae,lights_physical_fragment:aae,lights_physical_pars_fragment:lae,lights_fragment_begin:cae,lights_fragment_maps:uae,lights_fragment_end:hae,logdepthbuf_fragment:dae,logdepthbuf_pars_fragment:fae,logdepthbuf_pars_vertex:pae,logdepthbuf_vertex:mae,map_fragment:gae,map_pars_fragment:vae,map_particle_fragment:yae,map_particle_pars_fragment:xae,metalnessmap_fragment:wae,metalnessmap_pars_fragment:_ae,morphcolor_vertex:bae,morphnormal_vertex:Sae,morphtarget_pars_vertex:Aae,morphtarget_vertex:Mae,normal_fragment_begin:Eae,normal_fragment_maps:Cae,normal_pars_fragment:Tae,normal_pars_vertex:Pae,normal_vertex:Dae,normalmap_pars_fragment:Rae,clearcoat_normal_fragment_begin:Lae,clearcoat_normal_fragment_maps:Iae,clearcoat_pars_fragment:Bae,iridescence_pars_fragment:Oae,output_fragment:Fae,packing:Nae,premultiplied_alpha_fragment:Uae,project_vertex:kae,dithering_fragment:zae,dithering_pars_fragment:Gae,roughnessmap_fragment:Hae,roughnessmap_pars_fragment:Vae,shadowmap_pars_fragment:jae,shadowmap_pars_vertex:Wae,shadowmap_vertex:Xae,shadowmask_pars_fragment:Yae,skinbase_vertex:qae,skinning_pars_vertex:Qae,skinning_vertex:Kae,skinnormal_vertex:Jae,specularmap_fragment:Zae,specularmap_pars_fragment:$ae,tonemapping_fragment:ele,tonemapping_pars_fragment:tle,transmission_fragment:nle,transmission_pars_fragment:ile,uv_pars_fragment:rle,uv_pars_vertex:sle,uv_vertex:ole,worldpos_vertex:ale,background_vert:lle,background_frag:cle,backgroundCube_vert:ule,backgroundCube_frag:hle,cube_vert:dle,cube_frag:fle,depth_vert:ple,depth_frag:mle,distanceRGBA_vert:gle,distanceRGBA_frag:vle,equirect_vert:yle,equirect_frag:xle,linedashed_vert:wle,linedashed_frag:_le,meshbasic_vert:ble,meshbasic_frag:Sle,meshlambert_vert:Ale,meshlambert_frag:Mle,meshmatcap_vert:Ele,meshmatcap_frag:Cle,meshnormal_vert:Tle,meshnormal_frag:Ple,meshphong_vert:Dle,meshphong_frag:Rle,meshphysical_vert:Lle,meshphysical_frag:Ile,meshtoon_vert:Ble,meshtoon_frag:Ole,points_vert:Fle,points_frag:Nle,shadow_vert:Ule,shadow_frag:kle,sprite_vert:zle,sprite_frag:Gle},rt={common:{diffuse:{value:new st(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ln},alphaMap:{value:null},alphaMapTransform:{value:new ln},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ln}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ln}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ln}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ln},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ln},normalScale:{value:new Ye(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ln},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ln}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ln}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ln}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new st(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new st(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ln}},sprite:{diffuse:{value:new st(16777215)},opacity:{value:1},center:{value:new Ye(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ln},alphaMap:{value:null},alphaTest:{value:0}}},Ua={basic:{uniforms:cs([rt.common,rt.specularmap,rt.envmap,rt.aomap,rt.lightmap,rt.fog]),vertexShader:tn.meshbasic_vert,fragmentShader:tn.meshbasic_frag},lambert:{uniforms:cs([rt.common,rt.specularmap,rt.envmap,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.fog,rt.lights,{emissive:{value:new st(0)}}]),vertexShader:tn.meshlambert_vert,fragmentShader:tn.meshlambert_frag},phong:{uniforms:cs([rt.common,rt.specularmap,rt.envmap,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.fog,rt.lights,{emissive:{value:new st(0)},specular:{value:new st(1118481)},shininess:{value:30}}]),vertexShader:tn.meshphong_vert,fragmentShader:tn.meshphong_frag},standard:{uniforms:cs([rt.common,rt.envmap,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.roughnessmap,rt.metalnessmap,rt.fog,rt.lights,{emissive:{value:new st(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:tn.meshphysical_vert,fragmentShader:tn.meshphysical_frag},toon:{uniforms:cs([rt.common,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.gradientmap,rt.fog,rt.lights,{emissive:{value:new st(0)}}]),vertexShader:tn.meshtoon_vert,fragmentShader:tn.meshtoon_frag},matcap:{uniforms:cs([rt.common,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.fog,{matcap:{value:null}}]),vertexShader:tn.meshmatcap_vert,fragmentShader:tn.meshmatcap_frag},points:{uniforms:cs([rt.points,rt.fog]),vertexShader:tn.points_vert,fragmentShader:tn.points_frag},dashed:{uniforms:cs([rt.common,rt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:tn.linedashed_vert,fragmentShader:tn.linedashed_frag},depth:{uniforms:cs([rt.common,rt.displacementmap]),vertexShader:tn.depth_vert,fragmentShader:tn.depth_frag},normal:{uniforms:cs([rt.common,rt.bumpmap,rt.normalmap,rt.displacementmap,{opacity:{value:1}}]),vertexShader:tn.meshnormal_vert,fragmentShader:tn.meshnormal_frag},sprite:{uniforms:cs([rt.sprite,rt.fog]),vertexShader:tn.sprite_vert,fragmentShader:tn.sprite_frag},background:{uniforms:{uvTransform:{value:new ln},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:tn.background_vert,fragmentShader:tn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:tn.backgroundCube_vert,fragmentShader:tn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:tn.cube_vert,fragmentShader:tn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:tn.equirect_vert,fragmentShader:tn.equirect_frag},distanceRGBA:{uniforms:cs([rt.common,rt.displacementmap,{referencePosition:{value:new ae},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:tn.distanceRGBA_vert,fragmentShader:tn.distanceRGBA_frag},shadow:{uniforms:cs([rt.lights,rt.fog,{color:{value:new st(0)},opacity:{value:1}}]),vertexShader:tn.shadow_vert,fragmentShader:tn.shadow_frag}};Ua.physical={uniforms:cs([Ua.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ln},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ln},clearcoatNormalScale:{value:new Ye(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ln},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ln},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ln},sheen:{value:0},sheenColor:{value:new st(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ln},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ln},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ln},transmissionSamplerSize:{value:new Ye},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ln},attenuationDistance:{value:0},attenuationColor:{value:new st(0)},specularColor:{value:new st(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ln},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ln}}]),vertexShader:tn.meshphysical_vert,fragmentShader:tn.meshphysical_frag};const b_={r:0,b:0,g:0};function Hle(t,e,n,i,r,s,o){const a=new st(0);let l=s===!0?0:1,c,h,u=null,d=0,f=null;function p(g,m){let y=!1,w=m.isScene===!0?m.background:null;switch(w&&w.isTexture&&(w=(m.backgroundBlurriness>0?n:e).get(w)),w===null?v(a,l):w&&w.isColor&&(v(w,1),y=!0),t.xr.getEnvironmentBlendMode()){case"opaque":y=!0;break;case"additive":i.buffers.color.setClear(0,0,0,1,o),y=!0;break;case"alpha-blend":i.buffers.color.setClear(0,0,0,0,o),y=!0;break}(t.autoClear||y)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),w&&(w.isCubeTexture||w.mapping===uv)?(h===void 0&&(h=new yr(new td(1,1,1),new ec({name:"BackgroundCubeMaterial",uniforms:Ng(Ua.backgroundCube.uniforms),vertexShader:Ua.backgroundCube.vertexShader,fragmentShader:Ua.backgroundCube.fragmentShader,side:gs,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(S,T,M){this.matrixWorld.copyPosition(M.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(h)),h.material.uniforms.envMap.value=w,h.material.uniforms.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,h.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,h.material.toneMapped=w.colorSpace!==Jt,(u!==w||d!==w.version||f!==t.toneMapping)&&(h.material.needsUpdate=!0,u=w,d=w.version,f=t.toneMapping),h.layers.enableAll(),g.unshift(h,h.geometry,h.material,0,0,null)):w&&w.isTexture&&(c===void 0&&(c=new yr(new hv(2,2),new ec({name:"BackgroundMaterial",uniforms:Ng(Ua.background.uniforms),vertexShader:Ua.background.vertexShader,fragmentShader:Ua.background.fragmentShader,side:Zl,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=w,c.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,c.material.toneMapped=w.colorSpace!==Jt,w.matrixAutoUpdate===!0&&w.updateMatrix(),c.material.uniforms.uvTransform.value.copy(w.matrix),(u!==w||d!==w.version||f!==t.toneMapping)&&(c.material.needsUpdate=!0,u=w,d=w.version,f=t.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}function v(g,m){g.getRGB(b_,I7(t)),i.buffers.color.setClear(b_.r,b_.g,b_.b,m,o)}return{getClearColor:function(){return a},setClearColor:function(g,m=1){a.set(g),l=m,v(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,v(a,l)},render:p}}function Vle(t,e,n,i){const r=t.getParameter(t.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||s!==null,a={},l=g(null);let c=l,h=!1;function u(k,j,Z,ee,O){let W=!1;if(o){const H=v(ee,Z,j);c!==H&&(c=H,f(c.object)),W=m(k,ee,Z,O),W&&y(k,ee,Z,O)}else{const H=j.wireframe===!0;(c.geometry!==ee.id||c.program!==Z.id||c.wireframe!==H)&&(c.geometry=ee.id,c.program=Z.id,c.wireframe=H,W=!0)}O!==null&&n.update(O,t.ELEMENT_ARRAY_BUFFER),(W||h)&&(h=!1,M(k,j,Z,ee),O!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.get(O).buffer))}function d(){return i.isWebGL2?t.createVertexArray():s.createVertexArrayOES()}function f(k){return i.isWebGL2?t.bindVertexArray(k):s.bindVertexArrayOES(k)}function p(k){return i.isWebGL2?t.deleteVertexArray(k):s.deleteVertexArrayOES(k)}function v(k,j,Z){const ee=Z.wireframe===!0;let O=a[k.id];O===void 0&&(O={},a[k.id]=O);let W=O[j.id];W===void 0&&(W={},O[j.id]=W);let H=W[ee];return H===void 0&&(H=g(d()),W[ee]=H),H}function g(k){const j=[],Z=[],ee=[];for(let O=0;O<r;O++)j[O]=0,Z[O]=0,ee[O]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:j,enabledAttributes:Z,attributeDivisors:ee,object:k,attributes:{},index:null}}function m(k,j,Z,ee){const O=c.attributes,W=j.attributes;let H=0;const Y=Z.getAttributes();for(const z in Y)if(Y[z].location>=0){const q=O[z];let re=W[z];if(re===void 0&&(z==="instanceMatrix"&&k.instanceMatrix&&(re=k.instanceMatrix),z==="instanceColor"&&k.instanceColor&&(re=k.instanceColor)),q===void 0||q.attribute!==re||re&&q.data!==re.data)return!0;H++}return c.attributesNum!==H||c.index!==ee}function y(k,j,Z,ee){const O={},W=j.attributes;let H=0;const Y=Z.getAttributes();for(const z in Y)if(Y[z].location>=0){let q=W[z];q===void 0&&(z==="instanceMatrix"&&k.instanceMatrix&&(q=k.instanceMatrix),z==="instanceColor"&&k.instanceColor&&(q=k.instanceColor));const re={};re.attribute=q,q&&q.data&&(re.data=q.data),O[z]=re,H++}c.attributes=O,c.attributesNum=H,c.index=ee}function w(){const k=c.newAttributes;for(let j=0,Z=k.length;j<Z;j++)k[j]=0}function b(k){A(k,0)}function A(k,j){const Z=c.newAttributes,ee=c.enabledAttributes,O=c.attributeDivisors;Z[k]=1,ee[k]===0&&(t.enableVertexAttribArray(k),ee[k]=1),O[k]!==j&&((i.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](k,j),O[k]=j)}function S(){const k=c.newAttributes,j=c.enabledAttributes;for(let Z=0,ee=j.length;Z<ee;Z++)j[Z]!==k[Z]&&(t.disableVertexAttribArray(Z),j[Z]=0)}function T(k,j,Z,ee,O,W){i.isWebGL2===!0&&(Z===t.INT||Z===t.UNSIGNED_INT)?t.vertexAttribIPointer(k,j,Z,O,W):t.vertexAttribPointer(k,j,Z,ee,O,W)}function M(k,j,Z,ee){if(i.isWebGL2===!1&&(k.isInstancedMesh||ee.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;w();const O=ee.attributes,W=Z.getAttributes(),H=j.defaultAttributeValues;for(const Y in W){const z=W[Y];if(z.location>=0){let X=O[Y];if(X===void 0&&(Y==="instanceMatrix"&&k.instanceMatrix&&(X=k.instanceMatrix),Y==="instanceColor"&&k.instanceColor&&(X=k.instanceColor)),X!==void 0){const q=X.normalized,re=X.itemSize,G=n.get(X);if(G===void 0)continue;const K=G.buffer,oe=G.type,ve=G.bytesPerElement;if(X.isInterleavedBufferAttribute){const $=X.data,se=$.stride,ne=X.offset;if($.isInstancedInterleavedBuffer){for(let ie=0;ie<z.locationSize;ie++)A(z.location+ie,$.meshPerAttribute);k.isInstancedMesh!==!0&&ee._maxInstanceCount===void 0&&(ee._maxInstanceCount=$.meshPerAttribute*$.count)}else for(let ie=0;ie<z.locationSize;ie++)b(z.location+ie);t.bindBuffer(t.ARRAY_BUFFER,K);for(let ie=0;ie<z.locationSize;ie++)T(z.location+ie,re/z.locationSize,oe,q,se*ve,(ne+re/z.locationSize*ie)*ve)}else{if(X.isInstancedBufferAttribute){for(let $=0;$<z.locationSize;$++)A(z.location+$,X.meshPerAttribute);k.isInstancedMesh!==!0&&ee._maxInstanceCount===void 0&&(ee._maxInstanceCount=X.meshPerAttribute*X.count)}else for(let $=0;$<z.locationSize;$++)b(z.location+$);t.bindBuffer(t.ARRAY_BUFFER,K);for(let $=0;$<z.locationSize;$++)T(z.location+$,re/z.locationSize,oe,q,re*ve,re/z.locationSize*$*ve)}}else if(H!==void 0){const q=H[Y];if(q!==void 0)switch(q.length){case 2:t.vertexAttrib2fv(z.location,q);break;case 3:t.vertexAttrib3fv(z.location,q);break;case 4:t.vertexAttrib4fv(z.location,q);break;default:t.vertexAttrib1fv(z.location,q)}}}}S()}function E(){F();for(const k in a){const j=a[k];for(const Z in j){const ee=j[Z];for(const O in ee)p(ee[O].object),delete ee[O];delete j[Z]}delete a[k]}}function P(k){if(a[k.id]===void 0)return;const j=a[k.id];for(const Z in j){const ee=j[Z];for(const O in ee)p(ee[O].object),delete ee[O];delete j[Z]}delete a[k.id]}function R(k){for(const j in a){const Z=a[j];if(Z[k.id]===void 0)continue;const ee=Z[k.id];for(const O in ee)p(ee[O].object),delete ee[O];delete Z[k.id]}}function F(){B(),h=!0,c!==l&&(c=l,f(c.object))}function B(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:u,reset:F,resetDefaultState:B,dispose:E,releaseStatesOfGeometry:P,releaseStatesOfProgram:R,initAttributes:w,enableAttribute:b,disableUnusedAttributes:S}}function jle(t,e,n,i){const r=i.isWebGL2;let s;function o(c){s=c}function a(c,h){t.drawArrays(s,c,h),n.update(h,s,1)}function l(c,h,u){if(u===0)return;let d,f;if(r)d=t,f="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[f](s,c,h,u),n.update(h,s,u)}this.setMode=o,this.render=a,this.renderInstances=l}function Wle(t,e,n){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const T=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(T){if(T==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";T="mediump"}return T==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&t.constructor.name==="WebGL2RenderingContext";let a=n.precision!==void 0?n.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),h=n.logarithmicDepthBuffer===!0,u=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),d=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=t.getParameter(t.MAX_TEXTURE_SIZE),p=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),v=t.getParameter(t.MAX_VERTEX_ATTRIBS),g=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),m=t.getParameter(t.MAX_VARYING_VECTORS),y=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),w=d>0,b=o||e.has("OES_texture_float"),A=w&&b,S=o?t.getParameter(t.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:h,maxTextures:u,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:v,maxVertexUniforms:g,maxVaryings:m,maxFragmentUniforms:y,vertexTextures:w,floatFragmentTextures:b,floatVertexTextures:A,maxSamples:S}}function Xle(t){const e=this;let n=null,i=0,r=!1,s=!1;const o=new $u,a=new ln,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,d){const f=u.length!==0||d||i!==0||r;return r=d,i=u.length,f},this.beginShadows=function(){s=!0,h(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(u,d){n=h(u,d,0)},this.setState=function(u,d,f){const p=u.clippingPlanes,v=u.clipIntersection,g=u.clipShadows,m=t.get(u);if(!r||p===null||p.length===0||s&&!g)s?h(null):c();else{const y=s?0:i,w=y*4;let b=m.clippingState||null;l.value=b,b=h(p,d,w,f);for(let A=0;A!==w;++A)b[A]=n[A];m.clippingState=b,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==n&&(l.value=n,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function h(u,d,f,p){const v=u!==null?u.length:0;let g=null;if(v!==0){if(g=l.value,p!==!0||g===null){const m=f+v*4,y=d.matrixWorldInverse;a.getNormalMatrix(y),(g===null||g.length<m)&&(g=new Float32Array(m));for(let w=0,b=f;w!==v;++w,b+=4)o.copy(u[w]).applyMatrix4(y,a),o.normal.toArray(g,b),g[b+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=v,e.numIntersection=0,g}}function Yle(t){let e=new WeakMap;function n(o,a){return a===px?o.mapping=Hh:a===mx&&(o.mapping=Vh),o}function i(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const a=o.mapping;if(a===px||a===mx)if(e.has(o)){const l=e.get(o).texture;return n(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new EB(l.height/2);return c.fromEquirectangularTexture(t,o),e.set(o,c),o.addEventListener("dispose",r),n(c.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}class qa extends l1{constructor(e=-1,n=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+n,l=r-n;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=h*this.view.offsetY,l=a-h*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}const Um=4,Tz=[.125,.215,.35,.446,.526,.582],Xd=20,JT=new qa,Pz=new st;let ZT=null;const Ud=(1+Math.sqrt(5))/2,Ip=1/Ud,Dz=[new ae(1,1,1),new ae(-1,1,1),new ae(1,1,-1),new ae(-1,1,-1),new ae(0,Ud,Ip),new ae(0,Ud,-Ip),new ae(Ip,0,Ud),new ae(-Ip,0,Ud),new ae(Ud,Ip,0),new ae(-Ud,Ip,0)];class sL{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,i=.1,r=100){ZT=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),n>0&&this._blur(s,0,0,n),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Iz(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Lz(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(ZT),e.scissorTest=!1,S_(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===Hh||e.mapping===Vh?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),ZT=this._renderer.getRenderTarget();const i=n||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,i={magFilter:ai,minFilter:ai,generateMipmaps:!1,type:Bg,format:Ps,colorSpace:Ja,depthBuffer:!1},r=Rz(e,n,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=Rz(e,n,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=qle(s)),this._blurMaterial=Qle(s,e,n)}return r}_compileMaterial(e){const n=new yr(this._lodPlanes[0],e);this._renderer.compile(n,JT)}_sceneToCubeUV(e,n,i,r){const a=new Gn(90,1,n,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],h=this._renderer,u=h.autoClear,d=h.toneMapping;h.getClearColor(Pz),h.toneMapping=Ya,h.autoClear=!1;const f=new lo({name:"PMREM.Background",side:gs,depthWrite:!1,depthTest:!1}),p=new yr(new td,f);let v=!1;const g=e.background;g?g.isColor&&(f.color.copy(g),e.background=null,v=!0):(f.color.copy(Pz),v=!0);for(let m=0;m<6;m++){const y=m%3;y===0?(a.up.set(0,l[m],0),a.lookAt(c[m],0,0)):y===1?(a.up.set(0,0,l[m]),a.lookAt(0,c[m],0)):(a.up.set(0,l[m],0),a.lookAt(0,0,c[m]));const w=this._cubeSize;S_(r,y*w,m>2?w:0,w,w),h.setRenderTarget(r),v&&h.render(p,a),h.render(e,a)}p.geometry.dispose(),p.material.dispose(),h.toneMapping=d,h.autoClear=u,e.background=g}_textureToCubeUV(e,n){const i=this._renderer,r=e.mapping===Hh||e.mapping===Vh;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=Iz()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Lz());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new yr(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;S_(n,0,0,3*l,2*l),i.setRenderTarget(n),i.render(o,JT)}_applyPMREM(e){const n=this._renderer,i=n.autoClear;n.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=Dz[(r-1)%Dz.length];this._blur(e,r-1,r,s,o)}n.autoClear=i}_blur(e,n,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,n,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,n,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const h=3,u=new yr(this._lodPlanes[r],c),d=c.uniforms,f=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/(2*Xd-1),v=s/p,g=isFinite(s)?1+Math.floor(h*v):Xd;g>Xd&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to ${Xd}`);const m=[];let y=0;for(let T=0;T<Xd;++T){const M=T/v,E=Math.exp(-M*M/2);m.push(E),T===0?y+=E:T<g&&(y+=2*E)}for(let T=0;T<m.length;T++)m[T]=m[T]/y;d.envMap.value=e.texture,d.samples.value=g,d.weights.value=m,d.latitudinal.value=o==="latitudinal",a&&(d.poleAxis.value=a);const{_lodMax:w}=this;d.dTheta.value=p,d.mipInt.value=w-i;const b=this._sizeLods[r],A=3*b*(r>w-Um?r-w+Um:0),S=4*(this._cubeSize-b);S_(n,A,S,3*b,2*b),l.setRenderTarget(n),l.render(u,JT)}}function qle(t){const e=[],n=[],i=[];let r=t;const s=t-Um+1+Tz.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);n.push(a);let l=1/a;o>t-Um?l=Tz[o-t+Um-1]:o===0&&(l=0),i.push(l);const c=1/(a-2),h=-c,u=1+c,d=[h,h,u,h,u,u,h,h,u,u,h,u],f=6,p=6,v=3,g=2,m=1,y=new Float32Array(v*p*f),w=new Float32Array(g*p*f),b=new Float32Array(m*p*f);for(let S=0;S<f;S++){const T=S%3*2/3-1,M=S>2?0:-1,E=[T,M,0,T+2/3,M,0,T+2/3,M+1,0,T,M,0,T+2/3,M+1,0,T,M+1,0];y.set(E,v*p*S),w.set(d,g*p*S);const P=[S,S,S,S,S,S];b.set(P,m*p*S)}const A=new Kt;A.setAttribute("position",new Sn(y,v)),A.setAttribute("uv",new Sn(w,g)),A.setAttribute("faceIndex",new Sn(b,m)),e.push(A),r>Um&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}function Rz(t,e,n){const i=new Za(t,e,n);return i.texture.mapping=uv,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function S_(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function Qle(t,e,n){const i=new Float32Array(Xd),r=new ae(0,1,0);return new ec({name:"SphericalGaussianBlur",defines:{n:Xd,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:CB(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Qc,depthTest:!1,depthWrite:!1})}function Lz(){return new ec({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:CB(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Qc,depthTest:!1,depthWrite:!1})}function Iz(){return new ec({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:CB(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Qc,depthTest:!1,depthWrite:!1})}function CB(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Kle(t){let e=new WeakMap,n=null;function i(a){if(a&&a.isTexture){const l=a.mapping,c=l===px||l===mx,h=l===Hh||l===Vh;if(c||h)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let u=e.get(a);return n===null&&(n=new sL(t)),u=c?n.fromEquirectangular(a,u):n.fromCubemap(a,u),e.set(a,u),u.texture}else{if(e.has(a))return e.get(a).texture;{const u=a.image;if(c&&u&&u.height>0||h&&u&&r(u)){n===null&&(n=new sL(t));const d=c?n.fromEquirectangular(a):n.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}else return null}}}return a}function r(a){let l=0;const c=6;for(let h=0;h<c;h++)a[h]!==void 0&&l++;return l===c}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:o}}function Jle(t){const e={};function n(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(i)}return e[i]=r,r}return{has:function(i){return n(i)!==null},init:function(i){i.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(i){const r=n(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function Zle(t,e,n,i){const r={},s=new WeakMap;function o(u){const d=u.target;d.index!==null&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);d.removeEventListener("dispose",o),delete r[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),i.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,n.memory.geometries--}function a(u,d){return r[d.id]===!0||(d.addEventListener("dispose",o),r[d.id]=!0,n.memory.geometries++),d}function l(u){const d=u.attributes;for(const p in d)e.update(d[p],t.ARRAY_BUFFER);const f=u.morphAttributes;for(const p in f){const v=f[p];for(let g=0,m=v.length;g<m;g++)e.update(v[g],t.ARRAY_BUFFER)}}function c(u){const d=[],f=u.index,p=u.attributes.position;let v=0;if(f!==null){const y=f.array;v=f.version;for(let w=0,b=y.length;w<b;w+=3){const A=y[w+0],S=y[w+1],T=y[w+2];d.push(A,S,S,T,T,A)}}else{const y=p.array;v=p.version;for(let w=0,b=y.length/3-1;w<b;w+=3){const A=w+0,S=w+1,T=w+2;d.push(A,S,S,T,T,A)}}const g=new(R7(d)?AB:SB)(d,1);g.version=v;const m=s.get(u);m&&e.remove(m),s.set(u,g)}function h(u){const d=s.get(u);if(d){const f=u.index;f!==null&&d.version<f.version&&c(u)}else c(u);return s.get(u)}return{get:a,update:l,getWireframeAttribute:h}}function $le(t,e,n,i){const r=i.isWebGL2;let s;function o(d){s=d}let a,l;function c(d){a=d.type,l=d.bytesPerElement}function h(d,f){t.drawElements(s,f,a,d*l),n.update(f,s,1)}function u(d,f,p){if(p===0)return;let v,g;if(r)v=t,g="drawElementsInstanced";else if(v=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",v===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}v[g](s,f,a,d*l,p),n.update(f,s,p)}this.setMode=o,this.setIndex=c,this.render=h,this.renderInstances=u}function ece(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(n.calls++,o){case t.TRIANGLES:n.triangles+=a*(s/3);break;case t.LINES:n.lines+=a*(s/2);break;case t.LINE_STRIP:n.lines+=a*(s-1);break;case t.LINE_LOOP:n.lines+=a*s;break;case t.POINTS:n.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:r,update:i}}function tce(t,e){return t[0]-e[0]}function nce(t,e){return Math.abs(e[1])-Math.abs(t[1])}function ice(t,e,n){const i={},r=new Float32Array(8),s=new WeakMap,o=new Dn,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,h,u){const d=c.morphTargetInfluences;if(e.isWebGL2===!0){const p=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,v=p!==void 0?p.length:0;let g=s.get(h);if(g===void 0||g.count!==v){let j=function(){B.dispose(),s.delete(h),h.removeEventListener("dispose",j)};var f=j;g!==void 0&&g.texture.dispose();const w=h.morphAttributes.position!==void 0,b=h.morphAttributes.normal!==void 0,A=h.morphAttributes.color!==void 0,S=h.morphAttributes.position||[],T=h.morphAttributes.normal||[],M=h.morphAttributes.color||[];let E=0;w===!0&&(E=1),b===!0&&(E=2),A===!0&&(E=3);let P=h.attributes.position.count*E,R=1;P>e.maxTextureSize&&(R=Math.ceil(P/e.maxTextureSize),P=e.maxTextureSize);const F=new Float32Array(P*R*4*v),B=new JM(F,P,R,v);B.type=Hc,B.needsUpdate=!0;const k=E*4;for(let Z=0;Z<v;Z++){const ee=S[Z],O=T[Z],W=M[Z],H=P*R*4*Z;for(let Y=0;Y<ee.count;Y++){const z=Y*k;w===!0&&(o.fromBufferAttribute(ee,Y),F[H+z+0]=o.x,F[H+z+1]=o.y,F[H+z+2]=o.z,F[H+z+3]=0),b===!0&&(o.fromBufferAttribute(O,Y),F[H+z+4]=o.x,F[H+z+5]=o.y,F[H+z+6]=o.z,F[H+z+7]=0),A===!0&&(o.fromBufferAttribute(W,Y),F[H+z+8]=o.x,F[H+z+9]=o.y,F[H+z+10]=o.z,F[H+z+11]=W.itemSize===4?o.w:1)}}g={count:v,texture:B,size:new Ye(P,R)},s.set(h,g),h.addEventListener("dispose",j)}let m=0;for(let w=0;w<d.length;w++)m+=d[w];const y=h.morphTargetsRelative?1:1-m;u.getUniforms().setValue(t,"morphTargetBaseInfluence",y),u.getUniforms().setValue(t,"morphTargetInfluences",d),u.getUniforms().setValue(t,"morphTargetsTexture",g.texture,n),u.getUniforms().setValue(t,"morphTargetsTextureSize",g.size)}else{const p=d===void 0?0:d.length;let v=i[h.id];if(v===void 0||v.length!==p){v=[];for(let b=0;b<p;b++)v[b]=[b,0];i[h.id]=v}for(let b=0;b<p;b++){const A=v[b];A[0]=b,A[1]=d[b]}v.sort(nce);for(let b=0;b<8;b++)b<p&&v[b][1]?(a[b][0]=v[b][0],a[b][1]=v[b][1]):(a[b][0]=Number.MAX_SAFE_INTEGER,a[b][1]=0);a.sort(tce);const g=h.morphAttributes.position,m=h.morphAttributes.normal;let y=0;for(let b=0;b<8;b++){const A=a[b],S=A[0],T=A[1];S!==Number.MAX_SAFE_INTEGER&&T?(g&&h.getAttribute("morphTarget"+b)!==g[S]&&h.setAttribute("morphTarget"+b,g[S]),m&&h.getAttribute("morphNormal"+b)!==m[S]&&h.setAttribute("morphNormal"+b,m[S]),r[b]=T,y+=T):(g&&h.hasAttribute("morphTarget"+b)===!0&&h.deleteAttribute("morphTarget"+b),m&&h.hasAttribute("morphNormal"+b)===!0&&h.deleteAttribute("morphNormal"+b),r[b]=0)}const w=h.morphTargetsRelative?1:1-y;u.getUniforms().setValue(t,"morphTargetBaseInfluence",w),u.getUniforms().setValue(t,"morphTargetInfluences",r)}}return{update:l}}function rce(t,e,n,i){let r=new WeakMap;function s(l){const c=i.render.frame,h=l.geometry,u=e.get(l,h);return r.get(u)!==c&&(e.update(u),r.set(u,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),n.update(l.instanceMatrix,t.ARRAY_BUFFER),l.instanceColor!==null&&n.update(l.instanceColor,t.ARRAY_BUFFER)),u}function o(){r=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),n.remove(c.instanceMatrix),c.instanceColor!==null&&n.remove(c.instanceColor)}return{update:s,dispose:o}}const F7=new ii,N7=new JM,U7=new bB,k7=new c1,Bz=[],Oz=[],Fz=new Float32Array(16),Nz=new Float32Array(9),Uz=new Float32Array(4);function dv(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let s=Bz[r];if(s===void 0&&(s=new Float32Array(r),Bz[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=n,t[o].toArray(s,a)}return s}function tr(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function nr(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function $M(t,e){let n=Oz[e];n===void 0&&(n=new Int32Array(e),Oz[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function sce(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function oce(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(tr(n,e))return;t.uniform2fv(this.addr,e),nr(n,e)}}function ace(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(tr(n,e))return;t.uniform3fv(this.addr,e),nr(n,e)}}function lce(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(tr(n,e))return;t.uniform4fv(this.addr,e),nr(n,e)}}function cce(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(tr(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),nr(n,e)}else{if(tr(n,i))return;Uz.set(i),t.uniformMatrix2fv(this.addr,!1,Uz),nr(n,i)}}function uce(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(tr(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),nr(n,e)}else{if(tr(n,i))return;Nz.set(i),t.uniformMatrix3fv(this.addr,!1,Nz),nr(n,i)}}function hce(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(tr(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),nr(n,e)}else{if(tr(n,i))return;Fz.set(i),t.uniformMatrix4fv(this.addr,!1,Fz),nr(n,i)}}function dce(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function fce(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(tr(n,e))return;t.uniform2iv(this.addr,e),nr(n,e)}}function pce(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(tr(n,e))return;t.uniform3iv(this.addr,e),nr(n,e)}}function mce(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(tr(n,e))return;t.uniform4iv(this.addr,e),nr(n,e)}}function gce(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function vce(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(tr(n,e))return;t.uniform2uiv(this.addr,e),nr(n,e)}}function yce(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(tr(n,e))return;t.uniform3uiv(this.addr,e),nr(n,e)}}function xce(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(tr(n,e))return;t.uniform4uiv(this.addr,e),nr(n,e)}}function wce(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2D(e||F7,r)}function _ce(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||U7,r)}function bce(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||k7,r)}function Sce(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||N7,r)}function Ace(t){switch(t){case 5126:return sce;case 35664:return oce;case 35665:return ace;case 35666:return lce;case 35674:return cce;case 35675:return uce;case 35676:return hce;case 5124:case 35670:return dce;case 35667:case 35671:return fce;case 35668:case 35672:return pce;case 35669:case 35673:return mce;case 5125:return gce;case 36294:return vce;case 36295:return yce;case 36296:return xce;case 35678:case 36198:case 36298:case 36306:case 35682:return wce;case 35679:case 36299:case 36307:return _ce;case 35680:case 36300:case 36308:case 36293:return bce;case 36289:case 36303:case 36311:case 36292:return Sce}}function Mce(t,e){t.uniform1fv(this.addr,e)}function Ece(t,e){const n=dv(e,this.size,2);t.uniform2fv(this.addr,n)}function Cce(t,e){const n=dv(e,this.size,3);t.uniform3fv(this.addr,n)}function Tce(t,e){const n=dv(e,this.size,4);t.uniform4fv(this.addr,n)}function Pce(t,e){const n=dv(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Dce(t,e){const n=dv(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function Rce(t,e){const n=dv(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Lce(t,e){t.uniform1iv(this.addr,e)}function Ice(t,e){t.uniform2iv(this.addr,e)}function Bce(t,e){t.uniform3iv(this.addr,e)}function Oce(t,e){t.uniform4iv(this.addr,e)}function Fce(t,e){t.uniform1uiv(this.addr,e)}function Nce(t,e){t.uniform2uiv(this.addr,e)}function Uce(t,e){t.uniform3uiv(this.addr,e)}function kce(t,e){t.uniform4uiv(this.addr,e)}function zce(t,e,n){const i=this.cache,r=e.length,s=$M(n,r);tr(i,s)||(t.uniform1iv(this.addr,s),nr(i,s));for(let o=0;o!==r;++o)n.setTexture2D(e[o]||F7,s[o])}function Gce(t,e,n){const i=this.cache,r=e.length,s=$M(n,r);tr(i,s)||(t.uniform1iv(this.addr,s),nr(i,s));for(let o=0;o!==r;++o)n.setTexture3D(e[o]||U7,s[o])}function Hce(t,e,n){const i=this.cache,r=e.length,s=$M(n,r);tr(i,s)||(t.uniform1iv(this.addr,s),nr(i,s));for(let o=0;o!==r;++o)n.setTextureCube(e[o]||k7,s[o])}function Vce(t,e,n){const i=this.cache,r=e.length,s=$M(n,r);tr(i,s)||(t.uniform1iv(this.addr,s),nr(i,s));for(let o=0;o!==r;++o)n.setTexture2DArray(e[o]||N7,s[o])}function jce(t){switch(t){case 5126:return Mce;case 35664:return Ece;case 35665:return Cce;case 35666:return Tce;case 35674:return Pce;case 35675:return Dce;case 35676:return Rce;case 5124:case 35670:return Lce;case 35667:case 35671:return Ice;case 35668:case 35672:return Bce;case 35669:case 35673:return Oce;case 5125:return Fce;case 36294:return Nce;case 36295:return Uce;case 36296:return kce;case 35678:case 36198:case 36298:case 36306:case 35682:return zce;case 35679:case 36299:case 36307:return Gce;case 35680:case 36300:case 36308:case 36293:return Hce;case 36289:case 36303:case 36311:case 36292:return Vce}}class Wce{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.setValue=Ace(n.type)}}class Xce{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.size=n.size,this.setValue=jce(n.type)}}class Yce{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,n[a.id],i)}}}const $T=/(\w+)(\])?(\[|\.)?/g;function kz(t,e){t.seq.push(e),t.map[e.id]=e}function qce(t,e,n){const i=t.name,r=i.length;for($T.lastIndex=0;;){const s=$T.exec(i),o=$T.lastIndex;let a=s[1];const l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){kz(n,c===void 0?new Wce(a,t,e):new Xce(a,t,e));break}else{let u=n.map[a];u===void 0&&(u=new Yce(a),kz(n,u)),n=u}}}class TS{constructor(e,n){this.seq=[],this.map={};const i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(n,r),o=e.getUniformLocation(n,s.name);qce(s,o,this)}}setValue(e,n,i,r){const s=this.map[n];s!==void 0&&s.setValue(e,i,r)}setOptional(e,n,i){const r=n[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,n,i,r){for(let s=0,o=n.length;s!==o;++s){const a=n[s],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,n){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in n&&i.push(o)}return i}}function zz(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}let Qce=0;function Kce(t,e){const n=t.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${n[o]}`)}return i.join(`
`)}function Jce(t){switch(t){case Ja:return["Linear","( value )"];case Jt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",t),["Linear","( value )"]}}function Gz(t,e,n){const i=t.getShaderParameter(e,t.COMPILE_STATUS),r=t.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return n.toUpperCase()+`

`+r+`

`+Kce(t.getShaderSource(e),o)}else return r}function Zce(t,e){const n=Jce(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function $ce(t,e){let n;switch(e){case t7:n="Linear";break;case n7:n="Reinhard";break;case i7:n="OptimizedCineon";break;case pB:n="ACESFilmic";break;case r7:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function eue(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.normalMapTangentSpace||t.clearcoatNormalMap||t.flatShading||t.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ry).join(`
`)}function tue(t){const e=[];for(const n in t){const i=t[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function nue(t,e){const n={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=t.getActiveAttrib(e,r),o=s.name;let a=1;s.type===t.FLOAT_MAT2&&(a=2),s.type===t.FLOAT_MAT3&&(a=3),s.type===t.FLOAT_MAT4&&(a=4),n[o]={type:s.type,location:t.getAttribLocation(e,o),locationSize:a}}return n}function ry(t){return t!==""}function Hz(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Vz(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const iue=/^[ \t]*#include +<([\w\d./]+)>/gm;function oL(t){return t.replace(iue,rue)}function rue(t,e){const n=tn[e];if(n===void 0)throw new Error("Can not resolve #include <"+e+">");return oL(n)}const sue=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function jz(t){return t.replace(sue,oue)}function oue(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function Wz(t){let e="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function aue(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===YM?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===Sy?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Oa&&(e="SHADOWMAP_TYPE_VSM"),e}function lue(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case Hh:case Vh:e="ENVMAP_TYPE_CUBE";break;case uv:e="ENVMAP_TYPE_CUBE_UV";break}return e}function cue(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case Vh:e="ENVMAP_MODE_REFRACTION";break}return e}function uue(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case s1:e="ENVMAP_BLENDING_MULTIPLY";break;case $X:e="ENVMAP_BLENDING_MIX";break;case e7:e="ENVMAP_BLENDING_ADD";break}return e}function hue(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:i,maxMip:n}}function due(t,e,n,i){const r=t.getContext(),s=n.defines;let o=n.vertexShader,a=n.fragmentShader;const l=aue(n),c=lue(n),h=cue(n),u=uue(n),d=hue(n),f=n.isWebGL2?"":eue(n),p=tue(s),v=r.createProgram();let g,m,y=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(g=[p].filter(ry).join(`
`),g.length>0&&(g+=`
`),m=[f,p].filter(ry).join(`
`),m.length>0&&(m+=`
`)):(g=[Wz(n),"#define SHADER_NAME "+n.shaderName,p,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(ry).join(`
`),m=[f,Wz(n),"#define SHADER_NAME "+n.shaderName,p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+h:"",n.envMap?"#define "+u:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Ya?"#define TONE_MAPPING":"",n.toneMapping!==Ya?tn.tonemapping_pars_fragment:"",n.toneMapping!==Ya?$ce("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",tn.encodings_pars_fragment,Zce("linearToOutputTexel",n.outputColorSpace),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(ry).join(`
`)),o=oL(o),o=Hz(o,n),o=Vz(o,n),a=oL(a),a=Hz(a,n),a=Vz(a,n),o=jz(o),a=jz(a),n.isWebGL2&&n.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,m=["#define varying in",n.glslVersion===iL?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===iL?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+m);const w=y+g+o,b=y+m+a,A=zz(r,r.VERTEX_SHADER,w),S=zz(r,r.FRAGMENT_SHADER,b);if(r.attachShader(v,A),r.attachShader(v,S),n.index0AttributeName!==void 0?r.bindAttribLocation(v,0,n.index0AttributeName):n.morphTargets===!0&&r.bindAttribLocation(v,0,"position"),r.linkProgram(v),t.debug.checkShaderErrors){const E=r.getProgramInfoLog(v).trim(),P=r.getShaderInfoLog(A).trim(),R=r.getShaderInfoLog(S).trim();let F=!0,B=!0;if(r.getProgramParameter(v,r.LINK_STATUS)===!1)if(F=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(r,v,A,S);else{const k=Gz(r,A,"vertex"),j=Gz(r,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(v,r.VALIDATE_STATUS)+`

Program Info Log: `+E+`
`+k+`
`+j)}else E!==""?console.warn("THREE.WebGLProgram: Program Info Log:",E):(P===""||R==="")&&(B=!1);B&&(this.diagnostics={runnable:F,programLog:E,vertexShader:{log:P,prefix:g},fragmentShader:{log:R,prefix:m}})}r.deleteShader(A),r.deleteShader(S);let T;this.getUniforms=function(){return T===void 0&&(T=new TS(r,v)),T};let M;return this.getAttributes=function(){return M===void 0&&(M=nue(r,v)),M},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(v),this.program=void 0},this.name=n.shaderName,this.id=Qce++,this.cacheKey=e,this.usedTimes=1,this.program=v,this.vertexShader=A,this.fragmentShader=S,this}let fue=0;class pue{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(n),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const i of n)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let i=n.get(e);return i===void 0&&(i=new Set,n.set(e,i)),i}_getShaderStage(e){const n=this.shaderCache;let i=n.get(e);return i===void 0&&(i=new mue(e),n.set(e,i)),i}}class mue{constructor(e){this.id=fue++,this.code=e,this.usedTimes=0}}function gue(t,e,n,i,r,s,o){const a=new gf,l=new pue,c=[],h=r.isWebGL2,u=r.logarithmicDepthBuffer,d=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(E){return E===1?"uv1":E===2?"uv2":E===3?"uv3":"uv"}function g(E,P,R,F,B){const k=F.fog,j=B.geometry,Z=E.isMeshStandardMaterial?F.environment:null,ee=(E.isMeshStandardMaterial?n:e).get(E.envMap||Z),O=ee&&ee.mapping===uv?ee.image.height:null,W=p[E.type];E.precision!==null&&(f=r.getMaxPrecision(E.precision),f!==E.precision&&console.warn("THREE.WebGLProgram.getParameters:",E.precision,"not supported, using",f,"instead."));const H=j.morphAttributes.position||j.morphAttributes.normal||j.morphAttributes.color,Y=H!==void 0?H.length:0;let z=0;j.morphAttributes.position!==void 0&&(z=1),j.morphAttributes.normal!==void 0&&(z=2),j.morphAttributes.color!==void 0&&(z=3);let X,q,re,G;if(W){const vt=Ua[W];X=vt.vertexShader,q=vt.fragmentShader}else X=E.vertexShader,q=E.fragmentShader,l.update(E),re=l.getVertexShaderID(E),G=l.getFragmentShaderID(E);const K=t.getRenderTarget(),oe=B.isInstancedMesh===!0,ve=!!E.map,$=!!E.matcap,se=!!ee,ne=!!E.aoMap,ie=!!E.lightMap,me=!!E.bumpMap,xe=!!E.normalMap,Ae=!!E.displacementMap,_e=!!E.emissiveMap,Ee=!!E.metalnessMap,Re=!!E.roughnessMap,Ue=E.clearcoat>0,Ne=E.iridescence>0,U=E.sheen>0,L=E.transmission>0,te=Ue&&!!E.clearcoatMap,we=Ue&&!!E.clearcoatNormalMap,Te=Ue&&!!E.clearcoatRoughnessMap,Ie=Ne&&!!E.iridescenceMap,Qe=Ne&&!!E.iridescenceThicknessMap,Ge=U&&!!E.sheenColorMap,ye=U&&!!E.sheenRoughnessMap,Ve=!!E.specularMap,ue=!!E.specularColorMap,Me=!!E.specularIntensityMap,Be=L&&!!E.transmissionMap,ze=L&&!!E.thicknessMap,$e=!!E.gradientMap,dt=!!E.alphaMap,Bt=E.alphaTest>0,J=!!E.extensions,fe=!!j.attributes.uv1,Se=!!j.attributes.uv2,Oe=!!j.attributes.uv3;return{isWebGL2:h,shaderID:W,shaderName:E.type,vertexShader:X,fragmentShader:q,defines:E.defines,customVertexShaderID:re,customFragmentShaderID:G,isRawShaderMaterial:E.isRawShaderMaterial===!0,glslVersion:E.glslVersion,precision:f,instancing:oe,instancingColor:oe&&B.instanceColor!==null,supportsVertexTextures:d,outputColorSpace:K===null?t.outputColorSpace:K.isXRRenderTarget===!0?K.texture.colorSpace:Ja,map:ve,matcap:$,envMap:se,envMapMode:se&&ee.mapping,envMapCubeUVHeight:O,aoMap:ne,lightMap:ie,bumpMap:me,normalMap:xe,displacementMap:d&&Ae,emissiveMap:_e,normalMapObjectSpace:xe&&E.normalMapType===E7,normalMapTangentSpace:xe&&E.normalMapType===ed,metalnessMap:Ee,roughnessMap:Re,clearcoat:Ue,clearcoatMap:te,clearcoatNormalMap:we,clearcoatRoughnessMap:Te,iridescence:Ne,iridescenceMap:Ie,iridescenceThicknessMap:Qe,sheen:U,sheenColorMap:Ge,sheenRoughnessMap:ye,specularMap:Ve,specularColorMap:ue,specularIntensityMap:Me,transmission:L,transmissionMap:Be,thicknessMap:ze,gradientMap:$e,opaque:E.transparent===!1&&E.blending===df,alphaMap:dt,alphaTest:Bt,combine:E.combine,mapUv:ve&&v(E.map.channel),aoMapUv:ne&&v(E.aoMap.channel),lightMapUv:ie&&v(E.lightMap.channel),bumpMapUv:me&&v(E.bumpMap.channel),normalMapUv:xe&&v(E.normalMap.channel),displacementMapUv:Ae&&v(E.displacementMap.channel),emissiveMapUv:_e&&v(E.emissiveMap.channel),metalnessMapUv:Ee&&v(E.metalnessMap.channel),roughnessMapUv:Re&&v(E.roughnessMap.channel),clearcoatMapUv:te&&v(E.clearcoatMap.channel),clearcoatNormalMapUv:we&&v(E.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Te&&v(E.clearcoatRoughnessMap.channel),iridescenceMapUv:Ie&&v(E.iridescenceMap.channel),iridescenceThicknessMapUv:Qe&&v(E.iridescenceThicknessMap.channel),sheenColorMapUv:Ge&&v(E.sheenColorMap.channel),sheenRoughnessMapUv:ye&&v(E.sheenRoughnessMap.channel),specularMapUv:Ve&&v(E.specularMap.channel),specularColorMapUv:ue&&v(E.specularColorMap.channel),specularIntensityMapUv:Me&&v(E.specularIntensityMap.channel),transmissionMapUv:Be&&v(E.transmissionMap.channel),thicknessMapUv:ze&&v(E.thicknessMap.channel),alphaMapUv:dt&&v(E.alphaMap.channel),vertexTangents:xe&&!!j.attributes.tangent,vertexColors:E.vertexColors,vertexAlphas:E.vertexColors===!0&&!!j.attributes.color&&j.attributes.color.itemSize===4,vertexUv1s:fe,vertexUv2s:Se,vertexUv3s:Oe,pointsUvs:B.isPoints===!0&&!!j.attributes.uv&&(ve||dt),fog:!!k,useFog:E.fog===!0,fogExp2:k&&k.isFogExp2,flatShading:E.flatShading===!0,sizeAttenuation:E.sizeAttenuation===!0,logarithmicDepthBuffer:u,skinning:B.isSkinnedMesh===!0,morphTargets:j.morphAttributes.position!==void 0,morphNormals:j.morphAttributes.normal!==void 0,morphColors:j.morphAttributes.color!==void 0,morphTargetsCount:Y,morphTextureStride:z,numDirLights:P.directional.length,numPointLights:P.point.length,numSpotLights:P.spot.length,numSpotLightMaps:P.spotLightMap.length,numRectAreaLights:P.rectArea.length,numHemiLights:P.hemi.length,numDirLightShadows:P.directionalShadowMap.length,numPointLightShadows:P.pointShadowMap.length,numSpotLightShadows:P.spotShadowMap.length,numSpotLightShadowsWithMaps:P.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:E.dithering,shadowMapEnabled:t.shadowMap.enabled&&R.length>0,shadowMapType:t.shadowMap.type,toneMapping:E.toneMapped?t.toneMapping:Ya,useLegacyLights:t.useLegacyLights,premultipliedAlpha:E.premultipliedAlpha,doubleSided:E.side===na,flipSided:E.side===gs,useDepthPacking:E.depthPacking>=0,depthPacking:E.depthPacking||0,index0AttributeName:E.index0AttributeName,extensionDerivatives:J&&E.extensions.derivatives===!0,extensionFragDepth:J&&E.extensions.fragDepth===!0,extensionDrawBuffers:J&&E.extensions.drawBuffers===!0,extensionShaderTextureLOD:J&&E.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:h||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||i.has("EXT_shader_texture_lod"),customProgramCacheKey:E.customProgramCacheKey()}}function m(E){const P=[];if(E.shaderID?P.push(E.shaderID):(P.push(E.customVertexShaderID),P.push(E.customFragmentShaderID)),E.defines!==void 0)for(const R in E.defines)P.push(R),P.push(E.defines[R]);return E.isRawShaderMaterial===!1&&(y(P,E),w(P,E),P.push(t.outputColorSpace)),P.push(E.customProgramCacheKey),P.join()}function y(E,P){E.push(P.precision),E.push(P.outputColorSpace),E.push(P.envMapMode),E.push(P.envMapCubeUVHeight),E.push(P.mapUv),E.push(P.alphaMapUv),E.push(P.lightMapUv),E.push(P.aoMapUv),E.push(P.bumpMapUv),E.push(P.normalMapUv),E.push(P.displacementMapUv),E.push(P.emissiveMapUv),E.push(P.metalnessMapUv),E.push(P.roughnessMapUv),E.push(P.clearcoatMapUv),E.push(P.clearcoatNormalMapUv),E.push(P.clearcoatRoughnessMapUv),E.push(P.iridescenceMapUv),E.push(P.iridescenceThicknessMapUv),E.push(P.sheenColorMapUv),E.push(P.sheenRoughnessMapUv),E.push(P.specularMapUv),E.push(P.specularColorMapUv),E.push(P.specularIntensityMapUv),E.push(P.transmissionMapUv),E.push(P.thicknessMapUv),E.push(P.combine),E.push(P.fogExp2),E.push(P.sizeAttenuation),E.push(P.morphTargetsCount),E.push(P.morphAttributeCount),E.push(P.numDirLights),E.push(P.numPointLights),E.push(P.numSpotLights),E.push(P.numSpotLightMaps),E.push(P.numHemiLights),E.push(P.numRectAreaLights),E.push(P.numDirLightShadows),E.push(P.numPointLightShadows),E.push(P.numSpotLightShadows),E.push(P.numSpotLightShadowsWithMaps),E.push(P.shadowMapType),E.push(P.toneMapping),E.push(P.numClippingPlanes),E.push(P.numClipIntersection),E.push(P.depthPacking)}function w(E,P){a.disableAll(),P.isWebGL2&&a.enable(0),P.supportsVertexTextures&&a.enable(1),P.instancing&&a.enable(2),P.instancingColor&&a.enable(3),P.matcap&&a.enable(4),P.envMap&&a.enable(5),P.normalMapObjectSpace&&a.enable(6),P.normalMapTangentSpace&&a.enable(7),P.clearcoat&&a.enable(8),P.iridescence&&a.enable(9),P.alphaTest&&a.enable(10),P.vertexColors&&a.enable(11),P.vertexAlphas&&a.enable(12),P.vertexUv1s&&a.enable(13),P.vertexUv2s&&a.enable(14),P.vertexUv3s&&a.enable(15),P.vertexTangents&&a.enable(16),E.push(a.mask),a.disableAll(),P.fog&&a.enable(0),P.useFog&&a.enable(1),P.flatShading&&a.enable(2),P.logarithmicDepthBuffer&&a.enable(3),P.skinning&&a.enable(4),P.morphTargets&&a.enable(5),P.morphNormals&&a.enable(6),P.morphColors&&a.enable(7),P.premultipliedAlpha&&a.enable(8),P.shadowMapEnabled&&a.enable(9),P.useLegacyLights&&a.enable(10),P.doubleSided&&a.enable(11),P.flipSided&&a.enable(12),P.useDepthPacking&&a.enable(13),P.dithering&&a.enable(14),P.transmission&&a.enable(15),P.sheen&&a.enable(16),P.opaque&&a.enable(17),P.pointsUvs&&a.enable(18),E.push(a.mask)}function b(E){const P=p[E.type];let R;if(P){const F=Ua[P];R=B7.clone(F.uniforms)}else R=E.uniforms;return R}function A(E,P){let R;for(let F=0,B=c.length;F<B;F++){const k=c[F];if(k.cacheKey===P){R=k,++R.usedTimes;break}}return R===void 0&&(R=new due(t,P,E,s),c.push(R)),R}function S(E){if(--E.usedTimes===0){const P=c.indexOf(E);c[P]=c[c.length-1],c.pop(),E.destroy()}}function T(E){l.remove(E)}function M(){l.dispose()}return{getParameters:g,getProgramCacheKey:m,getUniforms:b,acquireProgram:A,releaseProgram:S,releaseShaderCache:T,programs:c,dispose:M}}function vue(){let t=new WeakMap;function e(s){let o=t.get(s);return o===void 0&&(o={},t.set(s,o)),o}function n(s){t.delete(s)}function i(s,o,a){t.get(s)[o]=a}function r(){t=new WeakMap}return{get:e,remove:n,update:i,dispose:r}}function yue(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Xz(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Yz(){const t=[];let e=0;const n=[],i=[],r=[];function s(){e=0,n.length=0,i.length=0,r.length=0}function o(u,d,f,p,v,g){let m=t[e];return m===void 0?(m={id:u.id,object:u,geometry:d,material:f,groupOrder:p,renderOrder:u.renderOrder,z:v,group:g},t[e]=m):(m.id=u.id,m.object=u,m.geometry=d,m.material=f,m.groupOrder=p,m.renderOrder=u.renderOrder,m.z=v,m.group=g),e++,m}function a(u,d,f,p,v,g){const m=o(u,d,f,p,v,g);f.transmission>0?i.push(m):f.transparent===!0?r.push(m):n.push(m)}function l(u,d,f,p,v,g){const m=o(u,d,f,p,v,g);f.transmission>0?i.unshift(m):f.transparent===!0?r.unshift(m):n.unshift(m)}function c(u,d){n.length>1&&n.sort(u||yue),i.length>1&&i.sort(d||Xz),r.length>1&&r.sort(d||Xz)}function h(){for(let u=e,d=t.length;u<d;u++){const f=t[u];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:n,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:h,sort:c}}function xue(){let t=new WeakMap;function e(i,r){const s=t.get(i);let o;return s===void 0?(o=new Yz,t.set(i,[o])):r>=s.length?(o=new Yz,s.push(o)):o=s[r],o}function n(){t=new WeakMap}return{get:e,dispose:n}}function wue(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new ae,color:new st};break;case"SpotLight":n={position:new ae,direction:new ae,color:new st,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new ae,color:new st,distance:0,decay:0};break;case"HemisphereLight":n={direction:new ae,skyColor:new st,groundColor:new st};break;case"RectAreaLight":n={color:new st,position:new ae,halfWidth:new ae,halfHeight:new ae};break}return t[e.id]=n,n}}}function _ue(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ye};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ye};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ye,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let bue=0;function Sue(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function Aue(t,e){const n=new wue,i=_ue(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let h=0;h<9;h++)r.probe.push(new ae);const s=new ae,o=new kt,a=new kt;function l(h,u){let d=0,f=0,p=0;for(let R=0;R<9;R++)r.probe[R].set(0,0,0);let v=0,g=0,m=0,y=0,w=0,b=0,A=0,S=0,T=0,M=0;h.sort(Sue);const E=u===!0?Math.PI:1;for(let R=0,F=h.length;R<F;R++){const B=h[R],k=B.color,j=B.intensity,Z=B.distance,ee=B.shadow&&B.shadow.map?B.shadow.map.texture:null;if(B.isAmbientLight)d+=k.r*j*E,f+=k.g*j*E,p+=k.b*j*E;else if(B.isLightProbe)for(let O=0;O<9;O++)r.probe[O].addScaledVector(B.sh.coefficients[O],j);else if(B.isDirectionalLight){const O=n.get(B);if(O.color.copy(B.color).multiplyScalar(B.intensity*E),B.castShadow){const W=B.shadow,H=i.get(B);H.shadowBias=W.bias,H.shadowNormalBias=W.normalBias,H.shadowRadius=W.radius,H.shadowMapSize=W.mapSize,r.directionalShadow[v]=H,r.directionalShadowMap[v]=ee,r.directionalShadowMatrix[v]=B.shadow.matrix,b++}r.directional[v]=O,v++}else if(B.isSpotLight){const O=n.get(B);O.position.setFromMatrixPosition(B.matrixWorld),O.color.copy(k).multiplyScalar(j*E),O.distance=Z,O.coneCos=Math.cos(B.angle),O.penumbraCos=Math.cos(B.angle*(1-B.penumbra)),O.decay=B.decay,r.spot[m]=O;const W=B.shadow;if(B.map&&(r.spotLightMap[T]=B.map,T++,W.updateMatrices(B),B.castShadow&&M++),r.spotLightMatrix[m]=W.matrix,B.castShadow){const H=i.get(B);H.shadowBias=W.bias,H.shadowNormalBias=W.normalBias,H.shadowRadius=W.radius,H.shadowMapSize=W.mapSize,r.spotShadow[m]=H,r.spotShadowMap[m]=ee,S++}m++}else if(B.isRectAreaLight){const O=n.get(B);O.color.copy(k).multiplyScalar(j),O.halfWidth.set(B.width*.5,0,0),O.halfHeight.set(0,B.height*.5,0),r.rectArea[y]=O,y++}else if(B.isPointLight){const O=n.get(B);if(O.color.copy(B.color).multiplyScalar(B.intensity*E),O.distance=B.distance,O.decay=B.decay,B.castShadow){const W=B.shadow,H=i.get(B);H.shadowBias=W.bias,H.shadowNormalBias=W.normalBias,H.shadowRadius=W.radius,H.shadowMapSize=W.mapSize,H.shadowCameraNear=W.camera.near,H.shadowCameraFar=W.camera.far,r.pointShadow[g]=H,r.pointShadowMap[g]=ee,r.pointShadowMatrix[g]=B.shadow.matrix,A++}r.point[g]=O,g++}else if(B.isHemisphereLight){const O=n.get(B);O.skyColor.copy(B.color).multiplyScalar(j*E),O.groundColor.copy(B.groundColor).multiplyScalar(j*E),r.hemi[w]=O,w++}}y>0&&(e.isWebGL2||t.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=rt.LTC_FLOAT_1,r.rectAreaLTC2=rt.LTC_FLOAT_2):t.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=rt.LTC_HALF_1,r.rectAreaLTC2=rt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;const P=r.hash;(P.directionalLength!==v||P.pointLength!==g||P.spotLength!==m||P.rectAreaLength!==y||P.hemiLength!==w||P.numDirectionalShadows!==b||P.numPointShadows!==A||P.numSpotShadows!==S||P.numSpotMaps!==T)&&(r.directional.length=v,r.spot.length=m,r.rectArea.length=y,r.point.length=g,r.hemi.length=w,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=A,r.pointShadowMap.length=A,r.spotShadow.length=S,r.spotShadowMap.length=S,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=A,r.spotLightMatrix.length=S+T-M,r.spotLightMap.length=T,r.numSpotLightShadowsWithMaps=M,P.directionalLength=v,P.pointLength=g,P.spotLength=m,P.rectAreaLength=y,P.hemiLength=w,P.numDirectionalShadows=b,P.numPointShadows=A,P.numSpotShadows=S,P.numSpotMaps=T,r.version=bue++)}function c(h,u){let d=0,f=0,p=0,v=0,g=0;const m=u.matrixWorldInverse;for(let y=0,w=h.length;y<w;y++){const b=h[y];if(b.isDirectionalLight){const A=r.directional[d];A.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),A.direction.sub(s),A.direction.transformDirection(m),d++}else if(b.isSpotLight){const A=r.spot[p];A.position.setFromMatrixPosition(b.matrixWorld),A.position.applyMatrix4(m),A.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),A.direction.sub(s),A.direction.transformDirection(m),p++}else if(b.isRectAreaLight){const A=r.rectArea[v];A.position.setFromMatrixPosition(b.matrixWorld),A.position.applyMatrix4(m),a.identity(),o.copy(b.matrixWorld),o.premultiply(m),a.extractRotation(o),A.halfWidth.set(b.width*.5,0,0),A.halfHeight.set(0,b.height*.5,0),A.halfWidth.applyMatrix4(a),A.halfHeight.applyMatrix4(a),v++}else if(b.isPointLight){const A=r.point[f];A.position.setFromMatrixPosition(b.matrixWorld),A.position.applyMatrix4(m),f++}else if(b.isHemisphereLight){const A=r.hemi[g];A.direction.setFromMatrixPosition(b.matrixWorld),A.direction.transformDirection(m),g++}}}return{setup:l,setupView:c,state:r}}function qz(t,e){const n=new Aue(t,e),i=[],r=[];function s(){i.length=0,r.length=0}function o(u){i.push(u)}function a(u){r.push(u)}function l(u){n.setup(i,u)}function c(u){n.setupView(i,u)}return{init:s,state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function Mue(t,e){let n=new WeakMap;function i(s,o=0){const a=n.get(s);let l;return a===void 0?(l=new qz(t,e),n.set(s,[l])):o>=a.length?(l=new qz(t,e),a.push(l)):l=a[o],l}function r(){n=new WeakMap}return{get:i,dispose:r}}class TB extends Vi{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=A7,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class PB extends Vi{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const Eue=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Cue=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Tue(t,e,n){let i=new ZM;const r=new Ye,s=new Ye,o=new Dn,a=new TB({depthPacking:M7}),l=new PB,c={},h=n.maxTextureSize,u={[Zl]:gs,[gs]:Zl,[na]:na},d=new ec({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ye},radius:{value:4}},vertexShader:Eue,fragmentShader:Cue}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new Kt;p.setAttribute("position",new Sn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const v=new yr(p,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=YM;let m=this.type;this.render=function(A,S,T){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||A.length===0)return;const M=t.getRenderTarget(),E=t.getActiveCubeFace(),P=t.getActiveMipmapLevel(),R=t.state;R.setBlending(Qc),R.buffers.color.setClear(1,1,1,1),R.buffers.depth.setTest(!0),R.setScissorTest(!1);const F=m!==Oa&&this.type===Oa,B=m===Oa&&this.type!==Oa;for(let k=0,j=A.length;k<j;k++){const Z=A[k],ee=Z.shadow;if(ee===void 0){console.warn("THREE.WebGLShadowMap:",Z,"has no shadow.");continue}if(ee.autoUpdate===!1&&ee.needsUpdate===!1)continue;r.copy(ee.mapSize);const O=ee.getFrameExtents();if(r.multiply(O),s.copy(ee.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(s.x=Math.floor(h/O.x),r.x=s.x*O.x,ee.mapSize.x=s.x),r.y>h&&(s.y=Math.floor(h/O.y),r.y=s.y*O.y,ee.mapSize.y=s.y)),ee.map===null||F===!0||B===!0){const H=this.type!==Oa?{minFilter:yi,magFilter:yi}:{};ee.map!==null&&ee.map.dispose(),ee.map=new Za(r.x,r.y,H),ee.map.texture.name=Z.name+".shadowMap",ee.camera.updateProjectionMatrix()}t.setRenderTarget(ee.map),t.clear();const W=ee.getViewportCount();for(let H=0;H<W;H++){const Y=ee.getViewport(H);o.set(s.x*Y.x,s.y*Y.y,s.x*Y.z,s.y*Y.w),R.viewport(o),ee.updateMatrices(Z,H),i=ee.getFrustum(),b(S,T,ee.camera,Z,this.type)}ee.isPointLightShadow!==!0&&this.type===Oa&&y(ee,T),ee.needsUpdate=!1}m=this.type,g.needsUpdate=!1,t.setRenderTarget(M,E,P)};function y(A,S){const T=e.update(v);d.defines.VSM_SAMPLES!==A.blurSamples&&(d.defines.VSM_SAMPLES=A.blurSamples,f.defines.VSM_SAMPLES=A.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),A.mapPass===null&&(A.mapPass=new Za(r.x,r.y)),d.uniforms.shadow_pass.value=A.map.texture,d.uniforms.resolution.value=A.mapSize,d.uniforms.radius.value=A.radius,t.setRenderTarget(A.mapPass),t.clear(),t.renderBufferDirect(S,null,T,d,v,null),f.uniforms.shadow_pass.value=A.mapPass.texture,f.uniforms.resolution.value=A.mapSize,f.uniforms.radius.value=A.radius,t.setRenderTarget(A.map),t.clear(),t.renderBufferDirect(S,null,T,f,v,null)}function w(A,S,T,M){let E=null;const P=T.isPointLight===!0?A.customDistanceMaterial:A.customDepthMaterial;if(P!==void 0)E=P;else if(E=T.isPointLight===!0?l:a,t.localClippingEnabled&&S.clipShadows===!0&&Array.isArray(S.clippingPlanes)&&S.clippingPlanes.length!==0||S.displacementMap&&S.displacementScale!==0||S.alphaMap&&S.alphaTest>0||S.map&&S.alphaTest>0){const R=E.uuid,F=S.uuid;let B=c[R];B===void 0&&(B={},c[R]=B);let k=B[F];k===void 0&&(k=E.clone(),B[F]=k),E=k}if(E.visible=S.visible,E.wireframe=S.wireframe,M===Oa?E.side=S.shadowSide!==null?S.shadowSide:S.side:E.side=S.shadowSide!==null?S.shadowSide:u[S.side],E.alphaMap=S.alphaMap,E.alphaTest=S.alphaTest,E.map=S.map,E.clipShadows=S.clipShadows,E.clippingPlanes=S.clippingPlanes,E.clipIntersection=S.clipIntersection,E.displacementMap=S.displacementMap,E.displacementScale=S.displacementScale,E.displacementBias=S.displacementBias,E.wireframeLinewidth=S.wireframeLinewidth,E.linewidth=S.linewidth,T.isPointLight===!0&&E.isMeshDistanceMaterial===!0){const R=t.properties.get(E);R.light=T}return E}function b(A,S,T,M,E){if(A.visible===!1)return;if(A.layers.test(S.layers)&&(A.isMesh||A.isLine||A.isPoints)&&(A.castShadow||A.receiveShadow&&E===Oa)&&(!A.frustumCulled||i.intersectsObject(A))){A.modelViewMatrix.multiplyMatrices(T.matrixWorldInverse,A.matrixWorld);const F=e.update(A),B=A.material;if(Array.isArray(B)){const k=F.groups;for(let j=0,Z=k.length;j<Z;j++){const ee=k[j],O=B[ee.materialIndex];if(O&&O.visible){const W=w(A,O,M,E);t.renderBufferDirect(T,null,F,W,A,ee)}}}else if(B.visible){const k=w(A,B,M,E);t.renderBufferDirect(T,null,F,k,A,null)}}const R=A.children;for(let F=0,B=R.length;F<B;F++)b(R[F],S,T,M,E)}}function Pue(t,e,n){const i=n.isWebGL2;function r(){let J=!1;const fe=new Dn;let Se=null;const Oe=new Dn(0,0,0,0);return{setMask:function(qe){Se!==qe&&!J&&(t.colorMask(qe,qe,qe,qe),Se=qe)},setLocked:function(qe){J=qe},setClear:function(qe,vt,Et,un,Wi){Wi===!0&&(qe*=un,vt*=un,Et*=un),fe.set(qe,vt,Et,un),Oe.equals(fe)===!1&&(t.clearColor(qe,vt,Et,un),Oe.copy(fe))},reset:function(){J=!1,Se=null,Oe.set(-1,0,0,0)}}}function s(){let J=!1,fe=null,Se=null,Oe=null;return{setTest:function(qe){qe?K(t.DEPTH_TEST):oe(t.DEPTH_TEST)},setMask:function(qe){fe!==qe&&!J&&(t.depthMask(qe),fe=qe)},setFunc:function(qe){if(Se!==qe){switch(qe){case XX:t.depthFunc(t.NEVER);break;case YX:t.depthFunc(t.ALWAYS);break;case qX:t.depthFunc(t.LESS);break;case yA:t.depthFunc(t.LEQUAL);break;case QX:t.depthFunc(t.EQUAL);break;case KX:t.depthFunc(t.GEQUAL);break;case JX:t.depthFunc(t.GREATER);break;case ZX:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}Se=qe}},setLocked:function(qe){J=qe},setClear:function(qe){Oe!==qe&&(t.clearDepth(qe),Oe=qe)},reset:function(){J=!1,fe=null,Se=null,Oe=null}}}function o(){let J=!1,fe=null,Se=null,Oe=null,qe=null,vt=null,Et=null,un=null,Wi=null;return{setTest:function(Ot){J||(Ot?K(t.STENCIL_TEST):oe(t.STENCIL_TEST))},setMask:function(Ot){fe!==Ot&&!J&&(t.stencilMask(Ot),fe=Ot)},setFunc:function(Ot,Wn,Xn){(Se!==Ot||Oe!==Wn||qe!==Xn)&&(t.stencilFunc(Ot,Wn,Xn),Se=Ot,Oe=Wn,qe=Xn)},setOp:function(Ot,Wn,Xn){(vt!==Ot||Et!==Wn||un!==Xn)&&(t.stencilOp(Ot,Wn,Xn),vt=Ot,Et=Wn,un=Xn)},setLocked:function(Ot){J=Ot},setClear:function(Ot){Wi!==Ot&&(t.clearStencil(Ot),Wi=Ot)},reset:function(){J=!1,fe=null,Se=null,Oe=null,qe=null,vt=null,Et=null,un=null,Wi=null}}}const a=new r,l=new s,c=new o,h=new WeakMap,u=new WeakMap;let d={},f={},p=new WeakMap,v=[],g=null,m=!1,y=null,w=null,b=null,A=null,S=null,T=null,M=null,E=!1,P=null,R=null,F=null,B=null,k=null;const j=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Z=!1,ee=0;const O=t.getParameter(t.VERSION);O.indexOf("WebGL")!==-1?(ee=parseFloat(/^WebGL (\d)/.exec(O)[1]),Z=ee>=1):O.indexOf("OpenGL ES")!==-1&&(ee=parseFloat(/^OpenGL ES (\d)/.exec(O)[1]),Z=ee>=2);let W=null,H={};const Y=t.getParameter(t.SCISSOR_BOX),z=t.getParameter(t.VIEWPORT),X=new Dn().fromArray(Y),q=new Dn().fromArray(z);function re(J,fe,Se,Oe){const qe=new Uint8Array(4),vt=t.createTexture();t.bindTexture(J,vt),t.texParameteri(J,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(J,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let Et=0;Et<Se;Et++)i&&(J===t.TEXTURE_3D||J===t.TEXTURE_2D_ARRAY)?t.texImage3D(fe,0,t.RGBA,1,1,Oe,0,t.RGBA,t.UNSIGNED_BYTE,qe):t.texImage2D(fe+Et,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,qe);return vt}const G={};G[t.TEXTURE_2D]=re(t.TEXTURE_2D,t.TEXTURE_2D,1),G[t.TEXTURE_CUBE_MAP]=re(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(G[t.TEXTURE_2D_ARRAY]=re(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),G[t.TEXTURE_3D]=re(t.TEXTURE_3D,t.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),K(t.DEPTH_TEST),l.setFunc(yA),Ae(!1),_e(TR),K(t.CULL_FACE),me(Qc);function K(J){d[J]!==!0&&(t.enable(J),d[J]=!0)}function oe(J){d[J]!==!1&&(t.disable(J),d[J]=!1)}function ve(J,fe){return f[J]!==fe?(t.bindFramebuffer(J,fe),f[J]=fe,i&&(J===t.DRAW_FRAMEBUFFER&&(f[t.FRAMEBUFFER]=fe),J===t.FRAMEBUFFER&&(f[t.DRAW_FRAMEBUFFER]=fe)),!0):!1}function $(J,fe){let Se=v,Oe=!1;if(J)if(Se=p.get(fe),Se===void 0&&(Se=[],p.set(fe,Se)),J.isWebGLMultipleRenderTargets){const qe=J.texture;if(Se.length!==qe.length||Se[0]!==t.COLOR_ATTACHMENT0){for(let vt=0,Et=qe.length;vt<Et;vt++)Se[vt]=t.COLOR_ATTACHMENT0+vt;Se.length=qe.length,Oe=!0}}else Se[0]!==t.COLOR_ATTACHMENT0&&(Se[0]=t.COLOR_ATTACHMENT0,Oe=!0);else Se[0]!==t.BACK&&(Se[0]=t.BACK,Oe=!0);Oe&&(n.isWebGL2?t.drawBuffers(Se):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Se))}function se(J){return g!==J?(t.useProgram(J),g=J,!0):!1}const ne={[Wd]:t.FUNC_ADD,[OX]:t.FUNC_SUBTRACT,[FX]:t.FUNC_REVERSE_SUBTRACT};if(i)ne[LR]=t.MIN,ne[IR]=t.MAX;else{const J=e.get("EXT_blend_minmax");J!==null&&(ne[LR]=J.MIN_EXT,ne[IR]=J.MAX_EXT)}const ie={[NX]:t.ZERO,[UX]:t.ONE,[kX]:t.SRC_COLOR,[dB]:t.SRC_ALPHA,[WX]:t.SRC_ALPHA_SATURATE,[VX]:t.DST_COLOR,[GX]:t.DST_ALPHA,[zX]:t.ONE_MINUS_SRC_COLOR,[fB]:t.ONE_MINUS_SRC_ALPHA,[jX]:t.ONE_MINUS_DST_COLOR,[HX]:t.ONE_MINUS_DST_ALPHA};function me(J,fe,Se,Oe,qe,vt,Et,un){if(J===Qc){m===!0&&(oe(t.BLEND),m=!1);return}if(m===!1&&(K(t.BLEND),m=!0),J!==BX){if(J!==y||un!==E){if((w!==Wd||S!==Wd)&&(t.blendEquation(t.FUNC_ADD),w=Wd,S=Wd),un)switch(J){case df:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case PR:t.blendFunc(t.ONE,t.ONE);break;case DR:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case RR:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",J);break}else switch(J){case df:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case PR:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case DR:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case RR:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",J);break}b=null,A=null,T=null,M=null,y=J,E=un}return}qe=qe||fe,vt=vt||Se,Et=Et||Oe,(fe!==w||qe!==S)&&(t.blendEquationSeparate(ne[fe],ne[qe]),w=fe,S=qe),(Se!==b||Oe!==A||vt!==T||Et!==M)&&(t.blendFuncSeparate(ie[Se],ie[Oe],ie[vt],ie[Et]),b=Se,A=Oe,T=vt,M=Et),y=J,E=!1}function xe(J,fe){J.side===na?oe(t.CULL_FACE):K(t.CULL_FACE);let Se=J.side===gs;fe&&(Se=!Se),Ae(Se),J.blending===df&&J.transparent===!1?me(Qc):me(J.blending,J.blendEquation,J.blendSrc,J.blendDst,J.blendEquationAlpha,J.blendSrcAlpha,J.blendDstAlpha,J.premultipliedAlpha),l.setFunc(J.depthFunc),l.setTest(J.depthTest),l.setMask(J.depthWrite),a.setMask(J.colorWrite);const Oe=J.stencilWrite;c.setTest(Oe),Oe&&(c.setMask(J.stencilWriteMask),c.setFunc(J.stencilFunc,J.stencilRef,J.stencilFuncMask),c.setOp(J.stencilFail,J.stencilZFail,J.stencilZPass)),Re(J.polygonOffset,J.polygonOffsetFactor,J.polygonOffsetUnits),J.alphaToCoverage===!0?K(t.SAMPLE_ALPHA_TO_COVERAGE):oe(t.SAMPLE_ALPHA_TO_COVERAGE)}function Ae(J){P!==J&&(J?t.frontFace(t.CW):t.frontFace(t.CCW),P=J)}function _e(J){J!==RX?(K(t.CULL_FACE),J!==R&&(J===TR?t.cullFace(t.BACK):J===LX?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):oe(t.CULL_FACE),R=J}function Ee(J){J!==F&&(Z&&t.lineWidth(J),F=J)}function Re(J,fe,Se){J?(K(t.POLYGON_OFFSET_FILL),(B!==fe||k!==Se)&&(t.polygonOffset(fe,Se),B=fe,k=Se)):oe(t.POLYGON_OFFSET_FILL)}function Ue(J){J?K(t.SCISSOR_TEST):oe(t.SCISSOR_TEST)}function Ne(J){J===void 0&&(J=t.TEXTURE0+j-1),W!==J&&(t.activeTexture(J),W=J)}function U(J,fe,Se){Se===void 0&&(W===null?Se=t.TEXTURE0+j-1:Se=W);let Oe=H[Se];Oe===void 0&&(Oe={type:void 0,texture:void 0},H[Se]=Oe),(Oe.type!==J||Oe.texture!==fe)&&(W!==Se&&(t.activeTexture(Se),W=Se),t.bindTexture(J,fe||G[J]),Oe.type=J,Oe.texture=fe)}function L(){const J=H[W];J!==void 0&&J.type!==void 0&&(t.bindTexture(J.type,null),J.type=void 0,J.texture=void 0)}function te(){try{t.compressedTexImage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function we(){try{t.compressedTexImage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Te(){try{t.texSubImage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Ie(){try{t.texSubImage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Qe(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Ge(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function ye(){try{t.texStorage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Ve(){try{t.texStorage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function ue(){try{t.texImage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Me(){try{t.texImage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Be(J){X.equals(J)===!1&&(t.scissor(J.x,J.y,J.z,J.w),X.copy(J))}function ze(J){q.equals(J)===!1&&(t.viewport(J.x,J.y,J.z,J.w),q.copy(J))}function $e(J,fe){let Se=u.get(fe);Se===void 0&&(Se=new WeakMap,u.set(fe,Se));let Oe=Se.get(J);Oe===void 0&&(Oe=t.getUniformBlockIndex(fe,J.name),Se.set(J,Oe))}function dt(J,fe){const Oe=u.get(fe).get(J);h.get(fe)!==Oe&&(t.uniformBlockBinding(fe,Oe,J.__bindingPointIndex),h.set(fe,Oe))}function Bt(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),i===!0&&(t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),d={},W=null,H={},f={},p=new WeakMap,v=[],g=null,m=!1,y=null,w=null,b=null,A=null,S=null,T=null,M=null,E=!1,P=null,R=null,F=null,B=null,k=null,X.set(0,0,t.canvas.width,t.canvas.height),q.set(0,0,t.canvas.width,t.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:K,disable:oe,bindFramebuffer:ve,drawBuffers:$,useProgram:se,setBlending:me,setMaterial:xe,setFlipSided:Ae,setCullFace:_e,setLineWidth:Ee,setPolygonOffset:Re,setScissorTest:Ue,activeTexture:Ne,bindTexture:U,unbindTexture:L,compressedTexImage2D:te,compressedTexImage3D:we,texImage2D:ue,texImage3D:Me,updateUBOMapping:$e,uniformBlockBinding:dt,texStorage2D:ye,texStorage3D:Ve,texSubImage2D:Te,texSubImage3D:Ie,compressedTexSubImage2D:Qe,compressedTexSubImage3D:Ge,scissor:Be,viewport:ze,reset:Bt}}function Due(t,e,n,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,h=r.maxTextureSize,u=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let v;const g=new WeakMap;let m=!1;try{m=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(U,L){return m?new OffscreenCanvas(U,L):xx("canvas")}function w(U,L,te,we){let Te=1;if((U.width>we||U.height>we)&&(Te=we/Math.max(U.width,U.height)),Te<1||L===!0)if(typeof HTMLImageElement<"u"&&U instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&U instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&U instanceof ImageBitmap){const Ie=L?P7:Math.floor,Qe=Ie(Te*U.width),Ge=Ie(Te*U.height);v===void 0&&(v=y(Qe,Ge));const ye=te?y(Qe,Ge):v;return ye.width=Qe,ye.height=Ge,ye.getContext("2d").drawImage(U,0,0,Qe,Ge),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+U.width+"x"+U.height+") to ("+Qe+"x"+Ge+")."),ye}else return"data"in U&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+U.width+"x"+U.height+")."),U;return U}function b(U){return rL(U.width)&&rL(U.height)}function A(U){return a?!1:U.wrapS!==Pr||U.wrapT!==Pr||U.minFilter!==yi&&U.minFilter!==ai}function S(U,L){return U.generateMipmaps&&L&&U.minFilter!==yi&&U.minFilter!==ai}function T(U){t.generateMipmap(U)}function M(U,L,te,we,Te=!1){if(a===!1)return L;if(U!==null){if(t[U]!==void 0)return t[U];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+U+"'")}let Ie=L;return L===t.RED&&(te===t.FLOAT&&(Ie=t.R32F),te===t.HALF_FLOAT&&(Ie=t.R16F),te===t.UNSIGNED_BYTE&&(Ie=t.R8)),L===t.RG&&(te===t.FLOAT&&(Ie=t.RG32F),te===t.HALF_FLOAT&&(Ie=t.RG16F),te===t.UNSIGNED_BYTE&&(Ie=t.RG8)),L===t.RGBA&&(te===t.FLOAT&&(Ie=t.RGBA32F),te===t.HALF_FLOAT&&(Ie=t.RGBA16F),te===t.UNSIGNED_BYTE&&(Ie=we===Jt&&Te===!1?t.SRGB8_ALPHA8:t.RGBA8),te===t.UNSIGNED_SHORT_4_4_4_4&&(Ie=t.RGBA4),te===t.UNSIGNED_SHORT_5_5_5_1&&(Ie=t.RGB5_A1)),(Ie===t.R16F||Ie===t.R32F||Ie===t.RG16F||Ie===t.RG32F||Ie===t.RGBA16F||Ie===t.RGBA32F)&&e.get("EXT_color_buffer_float"),Ie}function E(U,L,te){return S(U,te)===!0||U.isFramebufferTexture&&U.minFilter!==yi&&U.minFilter!==ai?Math.log2(Math.max(L.width,L.height))+1:U.mipmaps!==void 0&&U.mipmaps.length>0?U.mipmaps.length:U.isCompressedTexture&&Array.isArray(U.image)?L.mipmaps.length:1}function P(U){return U===yi||U===gx||U===ag?t.NEAREST:t.LINEAR}function R(U){const L=U.target;L.removeEventListener("dispose",R),B(L),L.isVideoTexture&&p.delete(L)}function F(U){const L=U.target;L.removeEventListener("dispose",F),j(L)}function B(U){const L=i.get(U);if(L.__webglInit===void 0)return;const te=U.source,we=g.get(te);if(we){const Te=we[L.__cacheKey];Te.usedTimes--,Te.usedTimes===0&&k(U),Object.keys(we).length===0&&g.delete(te)}i.remove(U)}function k(U){const L=i.get(U);t.deleteTexture(L.__webglTexture);const te=U.source,we=g.get(te);delete we[L.__cacheKey],o.memory.textures--}function j(U){const L=U.texture,te=i.get(U),we=i.get(L);if(we.__webglTexture!==void 0&&(t.deleteTexture(we.__webglTexture),o.memory.textures--),U.depthTexture&&U.depthTexture.dispose(),U.isWebGLCubeRenderTarget)for(let Te=0;Te<6;Te++)t.deleteFramebuffer(te.__webglFramebuffer[Te]),te.__webglDepthbuffer&&t.deleteRenderbuffer(te.__webglDepthbuffer[Te]);else{if(t.deleteFramebuffer(te.__webglFramebuffer),te.__webglDepthbuffer&&t.deleteRenderbuffer(te.__webglDepthbuffer),te.__webglMultisampledFramebuffer&&t.deleteFramebuffer(te.__webglMultisampledFramebuffer),te.__webglColorRenderbuffer)for(let Te=0;Te<te.__webglColorRenderbuffer.length;Te++)te.__webglColorRenderbuffer[Te]&&t.deleteRenderbuffer(te.__webglColorRenderbuffer[Te]);te.__webglDepthRenderbuffer&&t.deleteRenderbuffer(te.__webglDepthRenderbuffer)}if(U.isWebGLMultipleRenderTargets)for(let Te=0,Ie=L.length;Te<Ie;Te++){const Qe=i.get(L[Te]);Qe.__webglTexture&&(t.deleteTexture(Qe.__webglTexture),o.memory.textures--),i.remove(L[Te])}i.remove(L),i.remove(U)}let Z=0;function ee(){Z=0}function O(){const U=Z;return U>=l&&console.warn("THREE.WebGLTextures: Trying to use "+U+" texture units while this GPU supports only "+l),Z+=1,U}function W(U){const L=[];return L.push(U.wrapS),L.push(U.wrapT),L.push(U.wrapR||0),L.push(U.magFilter),L.push(U.minFilter),L.push(U.anisotropy),L.push(U.internalFormat),L.push(U.format),L.push(U.type),L.push(U.generateMipmaps),L.push(U.premultiplyAlpha),L.push(U.flipY),L.push(U.unpackAlignment),L.push(U.colorSpace),L.join()}function H(U,L){const te=i.get(U);if(U.isVideoTexture&&Ue(U),U.isRenderTargetTexture===!1&&U.version>0&&te.__version!==U.version){const we=U.image;if(we===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(we.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{oe(te,U,L);return}}n.bindTexture(t.TEXTURE_2D,te.__webglTexture,t.TEXTURE0+L)}function Y(U,L){const te=i.get(U);if(U.version>0&&te.__version!==U.version){oe(te,U,L);return}n.bindTexture(t.TEXTURE_2D_ARRAY,te.__webglTexture,t.TEXTURE0+L)}function z(U,L){const te=i.get(U);if(U.version>0&&te.__version!==U.version){oe(te,U,L);return}n.bindTexture(t.TEXTURE_3D,te.__webglTexture,t.TEXTURE0+L)}function X(U,L){const te=i.get(U);if(U.version>0&&te.__version!==U.version){ve(te,U,L);return}n.bindTexture(t.TEXTURE_CUBE_MAP,te.__webglTexture,t.TEXTURE0+L)}const q={[jh]:t.REPEAT,[Pr]:t.CLAMP_TO_EDGE,[Ig]:t.MIRRORED_REPEAT},re={[yi]:t.NEAREST,[gx]:t.NEAREST_MIPMAP_NEAREST,[ag]:t.NEAREST_MIPMAP_LINEAR,[ai]:t.LINEAR,[QM]:t.LINEAR_MIPMAP_NEAREST,[$l]:t.LINEAR_MIPMAP_LINEAR};function G(U,L,te){if(te?(t.texParameteri(U,t.TEXTURE_WRAP_S,q[L.wrapS]),t.texParameteri(U,t.TEXTURE_WRAP_T,q[L.wrapT]),(U===t.TEXTURE_3D||U===t.TEXTURE_2D_ARRAY)&&t.texParameteri(U,t.TEXTURE_WRAP_R,q[L.wrapR]),t.texParameteri(U,t.TEXTURE_MAG_FILTER,re[L.magFilter]),t.texParameteri(U,t.TEXTURE_MIN_FILTER,re[L.minFilter])):(t.texParameteri(U,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(U,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),(U===t.TEXTURE_3D||U===t.TEXTURE_2D_ARRAY)&&t.texParameteri(U,t.TEXTURE_WRAP_R,t.CLAMP_TO_EDGE),(L.wrapS!==Pr||L.wrapT!==Pr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(U,t.TEXTURE_MAG_FILTER,P(L.magFilter)),t.texParameteri(U,t.TEXTURE_MIN_FILTER,P(L.minFilter)),L.minFilter!==yi&&L.minFilter!==ai&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const we=e.get("EXT_texture_filter_anisotropic");if(L.magFilter===yi||L.minFilter!==ag&&L.minFilter!==$l||L.type===Hc&&e.has("OES_texture_float_linear")===!1||a===!1&&L.type===Bg&&e.has("OES_texture_half_float_linear")===!1)return;(L.anisotropy>1||i.get(L).__currentAnisotropy)&&(t.texParameterf(U,we.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(L.anisotropy,r.getMaxAnisotropy())),i.get(L).__currentAnisotropy=L.anisotropy)}}function K(U,L){let te=!1;U.__webglInit===void 0&&(U.__webglInit=!0,L.addEventListener("dispose",R));const we=L.source;let Te=g.get(we);Te===void 0&&(Te={},g.set(we,Te));const Ie=W(L);if(Ie!==U.__cacheKey){Te[Ie]===void 0&&(Te[Ie]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,te=!0),Te[Ie].usedTimes++;const Qe=Te[U.__cacheKey];Qe!==void 0&&(Te[U.__cacheKey].usedTimes--,Qe.usedTimes===0&&k(L)),U.__cacheKey=Ie,U.__webglTexture=Te[Ie].texture}return te}function oe(U,L,te){let we=t.TEXTURE_2D;(L.isDataArrayTexture||L.isCompressedArrayTexture)&&(we=t.TEXTURE_2D_ARRAY),L.isData3DTexture&&(we=t.TEXTURE_3D);const Te=K(U,L),Ie=L.source;n.bindTexture(we,U.__webglTexture,t.TEXTURE0+te);const Qe=i.get(Ie);if(Ie.version!==Qe.__version||Te===!0){n.activeTexture(t.TEXTURE0+te),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,L.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,L.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,L.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE);const Ge=A(L)&&b(L.image)===!1;let ye=w(L.image,Ge,!1,h);ye=Ne(L,ye);const Ve=b(ye)||a,ue=s.convert(L.format,L.colorSpace);let Me=s.convert(L.type),Be=M(L.internalFormat,ue,Me,L.colorSpace);G(we,L,Ve);let ze;const $e=L.mipmaps,dt=a&&L.isVideoTexture!==!0,Bt=Qe.__version===void 0||Te===!0,J=E(L,ye,Ve);if(L.isDepthTexture)Be=t.DEPTH_COMPONENT,a?L.type===Hc?Be=t.DEPTH_COMPONENT32F:L.type===dh?Be=t.DEPTH_COMPONENT24:L.type===ff?Be=t.DEPTH24_STENCIL8:Be=t.DEPTH_COMPONENT16:L.type===Hc&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),L.format===Rh&&Be===t.DEPTH_COMPONENT&&L.type!==mB&&L.type!==dh&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),L.type=dh,Me=s.convert(L.type)),L.format===Rf&&Be===t.DEPTH_COMPONENT&&(Be=t.DEPTH_STENCIL,L.type!==ff&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),L.type=ff,Me=s.convert(L.type))),Bt&&(dt?n.texStorage2D(t.TEXTURE_2D,1,Be,ye.width,ye.height):n.texImage2D(t.TEXTURE_2D,0,Be,ye.width,ye.height,0,ue,Me,null));else if(L.isDataTexture)if($e.length>0&&Ve){dt&&Bt&&n.texStorage2D(t.TEXTURE_2D,J,Be,$e[0].width,$e[0].height);for(let fe=0,Se=$e.length;fe<Se;fe++)ze=$e[fe],dt?n.texSubImage2D(t.TEXTURE_2D,fe,0,0,ze.width,ze.height,ue,Me,ze.data):n.texImage2D(t.TEXTURE_2D,fe,Be,ze.width,ze.height,0,ue,Me,ze.data);L.generateMipmaps=!1}else dt?(Bt&&n.texStorage2D(t.TEXTURE_2D,J,Be,ye.width,ye.height),n.texSubImage2D(t.TEXTURE_2D,0,0,0,ye.width,ye.height,ue,Me,ye.data)):n.texImage2D(t.TEXTURE_2D,0,Be,ye.width,ye.height,0,ue,Me,ye.data);else if(L.isCompressedTexture)if(L.isCompressedArrayTexture){dt&&Bt&&n.texStorage3D(t.TEXTURE_2D_ARRAY,J,Be,$e[0].width,$e[0].height,ye.depth);for(let fe=0,Se=$e.length;fe<Se;fe++)ze=$e[fe],L.format!==Ps?ue!==null?dt?n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,fe,0,0,0,ze.width,ze.height,ye.depth,ue,ze.data,0,0):n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,fe,Be,ze.width,ze.height,ye.depth,0,ze.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):dt?n.texSubImage3D(t.TEXTURE_2D_ARRAY,fe,0,0,0,ze.width,ze.height,ye.depth,ue,Me,ze.data):n.texImage3D(t.TEXTURE_2D_ARRAY,fe,Be,ze.width,ze.height,ye.depth,0,ue,Me,ze.data)}else{dt&&Bt&&n.texStorage2D(t.TEXTURE_2D,J,Be,$e[0].width,$e[0].height);for(let fe=0,Se=$e.length;fe<Se;fe++)ze=$e[fe],L.format!==Ps?ue!==null?dt?n.compressedTexSubImage2D(t.TEXTURE_2D,fe,0,0,ze.width,ze.height,ue,ze.data):n.compressedTexImage2D(t.TEXTURE_2D,fe,Be,ze.width,ze.height,0,ze.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):dt?n.texSubImage2D(t.TEXTURE_2D,fe,0,0,ze.width,ze.height,ue,Me,ze.data):n.texImage2D(t.TEXTURE_2D,fe,Be,ze.width,ze.height,0,ue,Me,ze.data)}else if(L.isDataArrayTexture)dt?(Bt&&n.texStorage3D(t.TEXTURE_2D_ARRAY,J,Be,ye.width,ye.height,ye.depth),n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,ye.width,ye.height,ye.depth,ue,Me,ye.data)):n.texImage3D(t.TEXTURE_2D_ARRAY,0,Be,ye.width,ye.height,ye.depth,0,ue,Me,ye.data);else if(L.isData3DTexture)dt?(Bt&&n.texStorage3D(t.TEXTURE_3D,J,Be,ye.width,ye.height,ye.depth),n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,ye.width,ye.height,ye.depth,ue,Me,ye.data)):n.texImage3D(t.TEXTURE_3D,0,Be,ye.width,ye.height,ye.depth,0,ue,Me,ye.data);else if(L.isFramebufferTexture){if(Bt)if(dt)n.texStorage2D(t.TEXTURE_2D,J,Be,ye.width,ye.height);else{let fe=ye.width,Se=ye.height;for(let Oe=0;Oe<J;Oe++)n.texImage2D(t.TEXTURE_2D,Oe,Be,fe,Se,0,ue,Me,null),fe>>=1,Se>>=1}}else if($e.length>0&&Ve){dt&&Bt&&n.texStorage2D(t.TEXTURE_2D,J,Be,$e[0].width,$e[0].height);for(let fe=0,Se=$e.length;fe<Se;fe++)ze=$e[fe],dt?n.texSubImage2D(t.TEXTURE_2D,fe,0,0,ue,Me,ze):n.texImage2D(t.TEXTURE_2D,fe,Be,ue,Me,ze);L.generateMipmaps=!1}else dt?(Bt&&n.texStorage2D(t.TEXTURE_2D,J,Be,ye.width,ye.height),n.texSubImage2D(t.TEXTURE_2D,0,0,0,ue,Me,ye)):n.texImage2D(t.TEXTURE_2D,0,Be,ue,Me,ye);S(L,Ve)&&T(we),Qe.__version=Ie.version,L.onUpdate&&L.onUpdate(L)}U.__version=L.version}function ve(U,L,te){if(L.image.length!==6)return;const we=K(U,L),Te=L.source;n.bindTexture(t.TEXTURE_CUBE_MAP,U.__webglTexture,t.TEXTURE0+te);const Ie=i.get(Te);if(Te.version!==Ie.__version||we===!0){n.activeTexture(t.TEXTURE0+te),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,L.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,L.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,L.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE);const Qe=L.isCompressedTexture||L.image[0].isCompressedTexture,Ge=L.image[0]&&L.image[0].isDataTexture,ye=[];for(let fe=0;fe<6;fe++)!Qe&&!Ge?ye[fe]=w(L.image[fe],!1,!0,c):ye[fe]=Ge?L.image[fe].image:L.image[fe],ye[fe]=Ne(L,ye[fe]);const Ve=ye[0],ue=b(Ve)||a,Me=s.convert(L.format,L.colorSpace),Be=s.convert(L.type),ze=M(L.internalFormat,Me,Be,L.colorSpace),$e=a&&L.isVideoTexture!==!0,dt=Ie.__version===void 0||we===!0;let Bt=E(L,Ve,ue);G(t.TEXTURE_CUBE_MAP,L,ue);let J;if(Qe){$e&&dt&&n.texStorage2D(t.TEXTURE_CUBE_MAP,Bt,ze,Ve.width,Ve.height);for(let fe=0;fe<6;fe++){J=ye[fe].mipmaps;for(let Se=0;Se<J.length;Se++){const Oe=J[Se];L.format!==Ps?Me!==null?$e?n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,Se,0,0,Oe.width,Oe.height,Me,Oe.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,Se,ze,Oe.width,Oe.height,0,Oe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):$e?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,Se,0,0,Oe.width,Oe.height,Me,Be,Oe.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,Se,ze,Oe.width,Oe.height,0,Me,Be,Oe.data)}}}else{J=L.mipmaps,$e&&dt&&(J.length>0&&Bt++,n.texStorage2D(t.TEXTURE_CUBE_MAP,Bt,ze,ye[0].width,ye[0].height));for(let fe=0;fe<6;fe++)if(Ge){$e?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,0,0,0,ye[fe].width,ye[fe].height,Me,Be,ye[fe].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,0,ze,ye[fe].width,ye[fe].height,0,Me,Be,ye[fe].data);for(let Se=0;Se<J.length;Se++){const qe=J[Se].image[fe].image;$e?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,Se+1,0,0,qe.width,qe.height,Me,Be,qe.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,Se+1,ze,qe.width,qe.height,0,Me,Be,qe.data)}}else{$e?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,0,0,0,Me,Be,ye[fe]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,0,ze,Me,Be,ye[fe]);for(let Se=0;Se<J.length;Se++){const Oe=J[Se];$e?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,Se+1,0,0,Me,Be,Oe.image[fe]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,Se+1,ze,Me,Be,Oe.image[fe])}}}S(L,ue)&&T(t.TEXTURE_CUBE_MAP),Ie.__version=Te.version,L.onUpdate&&L.onUpdate(L)}U.__version=L.version}function $(U,L,te,we,Te){const Ie=s.convert(te.format,te.colorSpace),Qe=s.convert(te.type),Ge=M(te.internalFormat,Ie,Qe,te.colorSpace);i.get(L).__hasExternalTextures||(Te===t.TEXTURE_3D||Te===t.TEXTURE_2D_ARRAY?n.texImage3D(Te,0,Ge,L.width,L.height,L.depth,0,Ie,Qe,null):n.texImage2D(Te,0,Ge,L.width,L.height,0,Ie,Qe,null)),n.bindFramebuffer(t.FRAMEBUFFER,U),Re(L)?d.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,we,Te,i.get(te).__webglTexture,0,Ee(L)):(Te===t.TEXTURE_2D||Te>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&Te<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,we,Te,i.get(te).__webglTexture,0),n.bindFramebuffer(t.FRAMEBUFFER,null)}function se(U,L,te){if(t.bindRenderbuffer(t.RENDERBUFFER,U),L.depthBuffer&&!L.stencilBuffer){let we=t.DEPTH_COMPONENT16;if(te||Re(L)){const Te=L.depthTexture;Te&&Te.isDepthTexture&&(Te.type===Hc?we=t.DEPTH_COMPONENT32F:Te.type===dh&&(we=t.DEPTH_COMPONENT24));const Ie=Ee(L);Re(L)?d.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Ie,we,L.width,L.height):t.renderbufferStorageMultisample(t.RENDERBUFFER,Ie,we,L.width,L.height)}else t.renderbufferStorage(t.RENDERBUFFER,we,L.width,L.height);t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,U)}else if(L.depthBuffer&&L.stencilBuffer){const we=Ee(L);te&&Re(L)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,we,t.DEPTH24_STENCIL8,L.width,L.height):Re(L)?d.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,we,t.DEPTH24_STENCIL8,L.width,L.height):t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,L.width,L.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,U)}else{const we=L.isWebGLMultipleRenderTargets===!0?L.texture:[L.texture];for(let Te=0;Te<we.length;Te++){const Ie=we[Te],Qe=s.convert(Ie.format,Ie.colorSpace),Ge=s.convert(Ie.type),ye=M(Ie.internalFormat,Qe,Ge,Ie.colorSpace),Ve=Ee(L);te&&Re(L)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,Ve,ye,L.width,L.height):Re(L)?d.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Ve,ye,L.width,L.height):t.renderbufferStorage(t.RENDERBUFFER,ye,L.width,L.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function ne(U,L){if(L&&L.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,U),!(L.depthTexture&&L.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(L.depthTexture).__webglTexture||L.depthTexture.image.width!==L.width||L.depthTexture.image.height!==L.height)&&(L.depthTexture.image.width=L.width,L.depthTexture.image.height=L.height,L.depthTexture.needsUpdate=!0),H(L.depthTexture,0);const we=i.get(L.depthTexture).__webglTexture,Te=Ee(L);if(L.depthTexture.format===Rh)Re(L)?d.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,we,0,Te):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,we,0);else if(L.depthTexture.format===Rf)Re(L)?d.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,we,0,Te):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,we,0);else throw new Error("Unknown depthTexture format")}function ie(U){const L=i.get(U),te=U.isWebGLCubeRenderTarget===!0;if(U.depthTexture&&!L.__autoAllocateDepthBuffer){if(te)throw new Error("target.depthTexture not supported in Cube render targets");ne(L.__webglFramebuffer,U)}else if(te){L.__webglDepthbuffer=[];for(let we=0;we<6;we++)n.bindFramebuffer(t.FRAMEBUFFER,L.__webglFramebuffer[we]),L.__webglDepthbuffer[we]=t.createRenderbuffer(),se(L.__webglDepthbuffer[we],U,!1)}else n.bindFramebuffer(t.FRAMEBUFFER,L.__webglFramebuffer),L.__webglDepthbuffer=t.createRenderbuffer(),se(L.__webglDepthbuffer,U,!1);n.bindFramebuffer(t.FRAMEBUFFER,null)}function me(U,L,te){const we=i.get(U);L!==void 0&&$(we.__webglFramebuffer,U,U.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),te!==void 0&&ie(U)}function xe(U){const L=U.texture,te=i.get(U),we=i.get(L);U.addEventListener("dispose",F),U.isWebGLMultipleRenderTargets!==!0&&(we.__webglTexture===void 0&&(we.__webglTexture=t.createTexture()),we.__version=L.version,o.memory.textures++);const Te=U.isWebGLCubeRenderTarget===!0,Ie=U.isWebGLMultipleRenderTargets===!0,Qe=b(U)||a;if(Te){te.__webglFramebuffer=[];for(let Ge=0;Ge<6;Ge++)te.__webglFramebuffer[Ge]=t.createFramebuffer()}else{if(te.__webglFramebuffer=t.createFramebuffer(),Ie)if(r.drawBuffers){const Ge=U.texture;for(let ye=0,Ve=Ge.length;ye<Ve;ye++){const ue=i.get(Ge[ye]);ue.__webglTexture===void 0&&(ue.__webglTexture=t.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&U.samples>0&&Re(U)===!1){const Ge=Ie?L:[L];te.__webglMultisampledFramebuffer=t.createFramebuffer(),te.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,te.__webglMultisampledFramebuffer);for(let ye=0;ye<Ge.length;ye++){const Ve=Ge[ye];te.__webglColorRenderbuffer[ye]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,te.__webglColorRenderbuffer[ye]);const ue=s.convert(Ve.format,Ve.colorSpace),Me=s.convert(Ve.type),Be=M(Ve.internalFormat,ue,Me,Ve.colorSpace,U.isXRRenderTarget===!0),ze=Ee(U);t.renderbufferStorageMultisample(t.RENDERBUFFER,ze,Be,U.width,U.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+ye,t.RENDERBUFFER,te.__webglColorRenderbuffer[ye])}t.bindRenderbuffer(t.RENDERBUFFER,null),U.depthBuffer&&(te.__webglDepthRenderbuffer=t.createRenderbuffer(),se(te.__webglDepthRenderbuffer,U,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(Te){n.bindTexture(t.TEXTURE_CUBE_MAP,we.__webglTexture),G(t.TEXTURE_CUBE_MAP,L,Qe);for(let Ge=0;Ge<6;Ge++)$(te.__webglFramebuffer[Ge],U,L,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Ge);S(L,Qe)&&T(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(Ie){const Ge=U.texture;for(let ye=0,Ve=Ge.length;ye<Ve;ye++){const ue=Ge[ye],Me=i.get(ue);n.bindTexture(t.TEXTURE_2D,Me.__webglTexture),G(t.TEXTURE_2D,ue,Qe),$(te.__webglFramebuffer,U,ue,t.COLOR_ATTACHMENT0+ye,t.TEXTURE_2D),S(ue,Qe)&&T(t.TEXTURE_2D)}n.unbindTexture()}else{let Ge=t.TEXTURE_2D;(U.isWebGL3DRenderTarget||U.isWebGLArrayRenderTarget)&&(a?Ge=U.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(Ge,we.__webglTexture),G(Ge,L,Qe),$(te.__webglFramebuffer,U,L,t.COLOR_ATTACHMENT0,Ge),S(L,Qe)&&T(Ge),n.unbindTexture()}U.depthBuffer&&ie(U)}function Ae(U){const L=b(U)||a,te=U.isWebGLMultipleRenderTargets===!0?U.texture:[U.texture];for(let we=0,Te=te.length;we<Te;we++){const Ie=te[we];if(S(Ie,L)){const Qe=U.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,Ge=i.get(Ie).__webglTexture;n.bindTexture(Qe,Ge),T(Qe),n.unbindTexture()}}}function _e(U){if(a&&U.samples>0&&Re(U)===!1){const L=U.isWebGLMultipleRenderTargets?U.texture:[U.texture],te=U.width,we=U.height;let Te=t.COLOR_BUFFER_BIT;const Ie=[],Qe=U.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ge=i.get(U),ye=U.isWebGLMultipleRenderTargets===!0;if(ye)for(let Ve=0;Ve<L.length;Ve++)n.bindFramebuffer(t.FRAMEBUFFER,Ge.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ve,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,Ge.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ve,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,Ge.__webglMultisampledFramebuffer),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,Ge.__webglFramebuffer);for(let Ve=0;Ve<L.length;Ve++){Ie.push(t.COLOR_ATTACHMENT0+Ve),U.depthBuffer&&Ie.push(Qe);const ue=Ge.__ignoreDepthValues!==void 0?Ge.__ignoreDepthValues:!1;if(ue===!1&&(U.depthBuffer&&(Te|=t.DEPTH_BUFFER_BIT),U.stencilBuffer&&(Te|=t.STENCIL_BUFFER_BIT)),ye&&t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,Ge.__webglColorRenderbuffer[Ve]),ue===!0&&(t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[Qe]),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[Qe])),ye){const Me=i.get(L[Ve]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,Me,0)}t.blitFramebuffer(0,0,te,we,0,0,te,we,Te,t.NEAREST),f&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,Ie)}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),ye)for(let Ve=0;Ve<L.length;Ve++){n.bindFramebuffer(t.FRAMEBUFFER,Ge.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ve,t.RENDERBUFFER,Ge.__webglColorRenderbuffer[Ve]);const ue=i.get(L[Ve]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,Ge.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ve,t.TEXTURE_2D,ue,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,Ge.__webglMultisampledFramebuffer)}}function Ee(U){return Math.min(u,U.samples)}function Re(U){const L=i.get(U);return a&&U.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&L.__useRenderToTexture!==!1}function Ue(U){const L=o.render.frame;p.get(U)!==L&&(p.set(U,L),U.update())}function Ne(U,L){const te=U.colorSpace,we=U.format,Te=U.type;return U.isCompressedTexture===!0||U.format===wA||te!==Ja&&te!==Lh&&(te===Jt?a===!1?e.has("EXT_sRGB")===!0&&we===Ps?(U.format=wA,U.minFilter=ai,U.generateMipmaps=!1):L=_B.sRGBToLinear(L):(we!==Ps||Te!==su)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",te)),L}this.allocateTextureUnit=O,this.resetTextureUnits=ee,this.setTexture2D=H,this.setTexture2DArray=Y,this.setTexture3D=z,this.setTextureCube=X,this.rebindTextures=me,this.setupRenderTarget=xe,this.updateRenderTargetMipmap=Ae,this.updateMultisampleRenderTarget=_e,this.setupDepthRenderbuffer=ie,this.setupFrameBufferTexture=$,this.useMultisampledRTT=Re}function z7(t,e,n){const i=n.isWebGL2;function r(s,o=Lh){let a;if(s===su)return t.UNSIGNED_BYTE;if(s===l7)return t.UNSIGNED_SHORT_4_4_4_4;if(s===c7)return t.UNSIGNED_SHORT_5_5_5_1;if(s===s7)return t.BYTE;if(s===o7)return t.SHORT;if(s===mB)return t.UNSIGNED_SHORT;if(s===a7)return t.INT;if(s===dh)return t.UNSIGNED_INT;if(s===Hc)return t.FLOAT;if(s===Bg)return i?t.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===u7)return t.ALPHA;if(s===Ps)return t.RGBA;if(s===h7)return t.LUMINANCE;if(s===d7)return t.LUMINANCE_ALPHA;if(s===Rh)return t.DEPTH_COMPONENT;if(s===Rf)return t.DEPTH_STENCIL;if(s===wA)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===f7)return t.RED;if(s===p7)return t.RED_INTEGER;if(s===m7)return t.RG;if(s===g7)return t.RG_INTEGER;if(s===v7)return t.RGBA_INTEGER;if(s===_S||s===bS||s===SS||s===AS)if(o===Jt)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===_S)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===bS)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===SS)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===AS)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===_S)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===bS)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===SS)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===AS)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===BR||s===OR||s===FR||s===NR)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===BR)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===OR)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===FR)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===NR)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===y7)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===UR||s===kR)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===UR)return o===Jt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===kR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===zR||s===GR||s===HR||s===VR||s===jR||s===WR||s===XR||s===YR||s===qR||s===QR||s===KR||s===JR||s===ZR||s===$R)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===zR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===GR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===HR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===VR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===jR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===WR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===XR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===YR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===qR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===QR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===KR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===JR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===ZR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===$R)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===MS)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===MS)return o===Jt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===x7||s===eL||s===tL||s===nL)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===MS)return a.COMPRESSED_RED_RGTC1_EXT;if(s===eL)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===tL)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===nL)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===ff?i?t.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):t[s]!==void 0?t[s]:null}return{convert:r}}class G7 extends Gn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Vc extends mn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Rue={type:"move"};class eP{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Vc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Vc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ae,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ae),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Vc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ae,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ae),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const i of e.hand.values())this._getHandJoint(n,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(const v of e.hand.values()){const g=n.getJointPose(v,i),m=this._getHandJoint(c,v);g!==null&&(m.matrix.fromArray(g.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,m.jointRadius=g.radius),m.visible=g!==null}const h=c.joints["index-finger-tip"],u=c.joints["thumb-tip"],d=h.position.distanceTo(u.position),f=.02,p=.005;c.inputState.pinching&&d>f+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&d<=f-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=n.getPose(e.gripSpace,i),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=n.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(Rue)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const i=new Vc;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[n.jointName]=i,e.add(i)}return e.joints[n.jointName]}}class H7 extends ii{constructor(e,n,i,r,s,o,a,l,c,h){if(h=h!==void 0?h:Rh,h!==Rh&&h!==Rf)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&h===Rh&&(i=dh),i===void 0&&h===Rf&&(i=ff),super(null,r,s,o,a,l,h,i,c),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=a!==void 0?a:yi,this.minFilter=l!==void 0?l:yi,this.flipY=!1,this.generateMipmaps=!1}}class Lue extends sc{constructor(e,n){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,h=null,u=null,d=null,f=null,p=null;const v=n.getContextAttributes();let g=null,m=null;const y=[],w=[],b=new Set,A=new Map,S=new Gn;S.layers.enable(1),S.viewport=new Dn;const T=new Gn;T.layers.enable(2),T.viewport=new Dn;const M=[S,T],E=new G7;E.layers.enable(1),E.layers.enable(2);let P=null,R=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(X){let q=y[X];return q===void 0&&(q=new eP,y[X]=q),q.getTargetRaySpace()},this.getControllerGrip=function(X){let q=y[X];return q===void 0&&(q=new eP,y[X]=q),q.getGripSpace()},this.getHand=function(X){let q=y[X];return q===void 0&&(q=new eP,y[X]=q),q.getHandSpace()};function F(X){const q=w.indexOf(X.inputSource);if(q===-1)return;const re=y[q];re!==void 0&&(re.update(X.inputSource,X.frame,c||o),re.dispatchEvent({type:X.type,data:X.inputSource}))}function B(){r.removeEventListener("select",F),r.removeEventListener("selectstart",F),r.removeEventListener("selectend",F),r.removeEventListener("squeeze",F),r.removeEventListener("squeezestart",F),r.removeEventListener("squeezeend",F),r.removeEventListener("end",B),r.removeEventListener("inputsourceschange",k);for(let X=0;X<y.length;X++){const q=w[X];q!==null&&(w[X]=null,y[X].disconnect(q))}P=null,R=null,e.setRenderTarget(g),f=null,d=null,u=null,r=null,m=null,z.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(X){s=X,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(X){a=X,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(X){c=X},this.getBaseLayer=function(){return d!==null?d:f},this.getBinding=function(){return u},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(X){if(r=X,r!==null){if(g=e.getRenderTarget(),r.addEventListener("select",F),r.addEventListener("selectstart",F),r.addEventListener("selectend",F),r.addEventListener("squeeze",F),r.addEventListener("squeezestart",F),r.addEventListener("squeezeend",F),r.addEventListener("end",B),r.addEventListener("inputsourceschange",k),v.xrCompatible!==!0&&await n.makeXRCompatible(),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const q={antialias:r.renderState.layers===void 0?v.antialias:!0,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(r,n,q),r.updateRenderState({baseLayer:f}),m=new Za(f.framebufferWidth,f.framebufferHeight,{format:Ps,type:su,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil})}else{let q=null,re=null,G=null;v.depth&&(G=v.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,q=v.stencil?Rf:Rh,re=v.stencil?ff:dh);const K={colorFormat:n.RGBA8,depthFormat:G,scaleFactor:s};u=new XRWebGLBinding(r,n),d=u.createProjectionLayer(K),r.updateRenderState({layers:[d]}),m=new Za(d.textureWidth,d.textureHeight,{format:Ps,type:su,depthTexture:new H7(d.textureWidth,d.textureHeight,re,void 0,void 0,void 0,void 0,void 0,void 0,q),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0});const oe=e.properties.get(m);oe.__ignoreDepthValues=d.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await r.requestReferenceSpace(a),z.setContext(r),z.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function k(X){for(let q=0;q<X.removed.length;q++){const re=X.removed[q],G=w.indexOf(re);G>=0&&(w[G]=null,y[G].disconnect(re))}for(let q=0;q<X.added.length;q++){const re=X.added[q];let G=w.indexOf(re);if(G===-1){for(let oe=0;oe<y.length;oe++)if(oe>=w.length){w.push(re),G=oe;break}else if(w[oe]===null){w[oe]=re,G=oe;break}if(G===-1)break}const K=y[G];K&&K.connect(re)}}const j=new ae,Z=new ae;function ee(X,q,re){j.setFromMatrixPosition(q.matrixWorld),Z.setFromMatrixPosition(re.matrixWorld);const G=j.distanceTo(Z),K=q.projectionMatrix.elements,oe=re.projectionMatrix.elements,ve=K[14]/(K[10]-1),$=K[14]/(K[10]+1),se=(K[9]+1)/K[5],ne=(K[9]-1)/K[5],ie=(K[8]-1)/K[0],me=(oe[8]+1)/oe[0],xe=ve*ie,Ae=ve*me,_e=G/(-ie+me),Ee=_e*-ie;q.matrixWorld.decompose(X.position,X.quaternion,X.scale),X.translateX(Ee),X.translateZ(_e),X.matrixWorld.compose(X.position,X.quaternion,X.scale),X.matrixWorldInverse.copy(X.matrixWorld).invert();const Re=ve+_e,Ue=$+_e,Ne=xe-Ee,U=Ae+(G-Ee),L=se*$/Ue*Re,te=ne*$/Ue*Re;X.projectionMatrix.makePerspective(Ne,U,L,te,Re,Ue),X.projectionMatrixInverse.copy(X.projectionMatrix).invert()}function O(X,q){q===null?X.matrixWorld.copy(X.matrix):X.matrixWorld.multiplyMatrices(q.matrixWorld,X.matrix),X.matrixWorldInverse.copy(X.matrixWorld).invert()}this.updateCamera=function(X){if(r===null)return;E.near=T.near=S.near=X.near,E.far=T.far=S.far=X.far,(P!==E.near||R!==E.far)&&(r.updateRenderState({depthNear:E.near,depthFar:E.far}),P=E.near,R=E.far);const q=X.parent,re=E.cameras;O(E,q);for(let G=0;G<re.length;G++)O(re[G],q);re.length===2?ee(E,S,T):E.projectionMatrix.copy(S.projectionMatrix),W(X,E,q)};function W(X,q,re){re===null?X.matrix.copy(q.matrixWorld):(X.matrix.copy(re.matrixWorld),X.matrix.invert(),X.matrix.multiply(q.matrixWorld)),X.matrix.decompose(X.position,X.quaternion,X.scale),X.updateMatrixWorld(!0);const G=X.children;for(let K=0,oe=G.length;K<oe;K++)G[K].updateMatrixWorld(!0);X.projectionMatrix.copy(q.projectionMatrix),X.projectionMatrixInverse.copy(q.projectionMatrixInverse),X.isPerspectiveCamera&&(X.fov=Fg*2*Math.atan(1/X.projectionMatrix.elements[5]),X.zoom=1)}this.getCamera=function(){return E},this.getFoveation=function(){if(!(d===null&&f===null))return l},this.setFoveation=function(X){l=X,d!==null&&(d.fixedFoveation=X),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=X)},this.getPlanes=function(){return b};let H=null;function Y(X,q){if(h=q.getViewerPose(c||o),p=q,h!==null){const re=h.views;f!==null&&(e.setRenderTargetFramebuffer(m,f.framebuffer),e.setRenderTarget(m));let G=!1;re.length!==E.cameras.length&&(E.cameras.length=0,G=!0);for(let K=0;K<re.length;K++){const oe=re[K];let ve=null;if(f!==null)ve=f.getViewport(oe);else{const se=u.getViewSubImage(d,oe);ve=se.viewport,K===0&&(e.setRenderTargetTextures(m,se.colorTexture,d.ignoreDepthValues?void 0:se.depthStencilTexture),e.setRenderTarget(m))}let $=M[K];$===void 0&&($=new Gn,$.layers.enable(K),$.viewport=new Dn,M[K]=$),$.matrix.fromArray(oe.transform.matrix),$.matrix.decompose($.position,$.quaternion,$.scale),$.projectionMatrix.fromArray(oe.projectionMatrix),$.projectionMatrixInverse.copy($.projectionMatrix).invert(),$.viewport.set(ve.x,ve.y,ve.width,ve.height),K===0&&(E.matrix.copy($.matrix),E.matrix.decompose(E.position,E.quaternion,E.scale)),G===!0&&E.cameras.push($)}}for(let re=0;re<y.length;re++){const G=w[re],K=y[re];G!==null&&K!==void 0&&K.update(G,q,c||o)}if(H&&H(X,q),q.detectedPlanes){i.dispatchEvent({type:"planesdetected",data:q.detectedPlanes});let re=null;for(const G of b)q.detectedPlanes.has(G)||(re===null&&(re=[]),re.push(G));if(re!==null)for(const G of re)b.delete(G),A.delete(G),i.dispatchEvent({type:"planeremoved",data:G});for(const G of q.detectedPlanes)if(!b.has(G))b.add(G),A.set(G,q.lastChangedTime),i.dispatchEvent({type:"planeadded",data:G});else{const K=A.get(G);G.lastChangedTime>K&&(A.set(G,G.lastChangedTime),i.dispatchEvent({type:"planechanged",data:G}))}}p=null}const z=new O7;z.setAnimationLoop(Y),this.setAnimationLoop=function(X){H=X},this.dispose=function(){}}}function Iue(t,e){function n(g,m){g.matrixAutoUpdate===!0&&g.updateMatrix(),m.value.copy(g.matrix)}function i(g,m){m.color.getRGB(g.fogColor.value,I7(t)),m.isFog?(g.fogNear.value=m.near,g.fogFar.value=m.far):m.isFogExp2&&(g.fogDensity.value=m.density)}function r(g,m,y,w,b){m.isMeshBasicMaterial||m.isMeshLambertMaterial?s(g,m):m.isMeshToonMaterial?(s(g,m),u(g,m)):m.isMeshPhongMaterial?(s(g,m),h(g,m)):m.isMeshStandardMaterial?(s(g,m),d(g,m),m.isMeshPhysicalMaterial&&f(g,m,b)):m.isMeshMatcapMaterial?(s(g,m),p(g,m)):m.isMeshDepthMaterial?s(g,m):m.isMeshDistanceMaterial?(s(g,m),v(g,m)):m.isMeshNormalMaterial?s(g,m):m.isLineBasicMaterial?(o(g,m),m.isLineDashedMaterial&&a(g,m)):m.isPointsMaterial?l(g,m,y,w):m.isSpriteMaterial?c(g,m):m.isShadowMaterial?(g.color.value.copy(m.color),g.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}function s(g,m){g.opacity.value=m.opacity,m.color&&g.diffuse.value.copy(m.color),m.emissive&&g.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(g.map.value=m.map,n(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,n(m.alphaMap,g.alphaMapTransform)),m.bumpMap&&(g.bumpMap.value=m.bumpMap,n(m.bumpMap,g.bumpMapTransform),g.bumpScale.value=m.bumpScale,m.side===gs&&(g.bumpScale.value*=-1)),m.normalMap&&(g.normalMap.value=m.normalMap,n(m.normalMap,g.normalMapTransform),g.normalScale.value.copy(m.normalScale),m.side===gs&&g.normalScale.value.negate()),m.displacementMap&&(g.displacementMap.value=m.displacementMap,n(m.displacementMap,g.displacementMapTransform),g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias),m.emissiveMap&&(g.emissiveMap.value=m.emissiveMap,n(m.emissiveMap,g.emissiveMapTransform)),m.specularMap&&(g.specularMap.value=m.specularMap,n(m.specularMap,g.specularMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);const y=e.get(m).envMap;if(y&&(g.envMap.value=y,g.flipEnvMap.value=y.isCubeTexture&&y.isRenderTargetTexture===!1?-1:1,g.reflectivity.value=m.reflectivity,g.ior.value=m.ior,g.refractionRatio.value=m.refractionRatio),m.lightMap){g.lightMap.value=m.lightMap;const w=t.useLegacyLights===!0?Math.PI:1;g.lightMapIntensity.value=m.lightMapIntensity*w,n(m.lightMap,g.lightMapTransform)}m.aoMap&&(g.aoMap.value=m.aoMap,g.aoMapIntensity.value=m.aoMapIntensity,n(m.aoMap,g.aoMapTransform))}function o(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,m.map&&(g.map.value=m.map,n(m.map,g.mapTransform))}function a(g,m){g.dashSize.value=m.dashSize,g.totalSize.value=m.dashSize+m.gapSize,g.scale.value=m.scale}function l(g,m,y,w){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.size.value=m.size*y,g.scale.value=w*.5,m.map&&(g.map.value=m.map,n(m.map,g.uvTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}function c(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.rotation.value=m.rotation,m.map&&(g.map.value=m.map,n(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}function h(g,m){g.specular.value.copy(m.specular),g.shininess.value=Math.max(m.shininess,1e-4)}function u(g,m){m.gradientMap&&(g.gradientMap.value=m.gradientMap)}function d(g,m){g.metalness.value=m.metalness,m.metalnessMap&&(g.metalnessMap.value=m.metalnessMap,n(m.metalnessMap,g.metalnessMapTransform)),g.roughness.value=m.roughness,m.roughnessMap&&(g.roughnessMap.value=m.roughnessMap,n(m.roughnessMap,g.roughnessMapTransform)),e.get(m).envMap&&(g.envMapIntensity.value=m.envMapIntensity)}function f(g,m,y){g.ior.value=m.ior,m.sheen>0&&(g.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),g.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(g.sheenColorMap.value=m.sheenColorMap,n(m.sheenColorMap,g.sheenColorMapTransform)),m.sheenRoughnessMap&&(g.sheenRoughnessMap.value=m.sheenRoughnessMap,n(m.sheenRoughnessMap,g.sheenRoughnessMapTransform))),m.clearcoat>0&&(g.clearcoat.value=m.clearcoat,g.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(g.clearcoatMap.value=m.clearcoatMap,n(m.clearcoatMap,g.clearcoatMapTransform)),m.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap,n(m.clearcoatRoughnessMap,g.clearcoatRoughnessMapTransform)),m.clearcoatNormalMap&&(g.clearcoatNormalMap.value=m.clearcoatNormalMap,n(m.clearcoatNormalMap,g.clearcoatNormalMapTransform),g.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),m.side===gs&&g.clearcoatNormalScale.value.negate())),m.iridescence>0&&(g.iridescence.value=m.iridescence,g.iridescenceIOR.value=m.iridescenceIOR,g.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(g.iridescenceMap.value=m.iridescenceMap,n(m.iridescenceMap,g.iridescenceMapTransform)),m.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=m.iridescenceThicknessMap,n(m.iridescenceThicknessMap,g.iridescenceThicknessMapTransform))),m.transmission>0&&(g.transmission.value=m.transmission,g.transmissionSamplerMap.value=y.texture,g.transmissionSamplerSize.value.set(y.width,y.height),m.transmissionMap&&(g.transmissionMap.value=m.transmissionMap,n(m.transmissionMap,g.transmissionMapTransform)),g.thickness.value=m.thickness,m.thicknessMap&&(g.thicknessMap.value=m.thicknessMap,n(m.thicknessMap,g.thicknessMapTransform)),g.attenuationDistance.value=m.attenuationDistance,g.attenuationColor.value.copy(m.attenuationColor)),g.specularIntensity.value=m.specularIntensity,g.specularColor.value.copy(m.specularColor),m.specularColorMap&&(g.specularColorMap.value=m.specularColorMap,n(m.specularColorMap,g.specularColorMapTransform)),m.specularIntensityMap&&(g.specularIntensityMap.value=m.specularIntensityMap,n(m.specularIntensityMap,g.specularIntensityMapTransform))}function p(g,m){m.matcap&&(g.matcap.value=m.matcap)}function v(g,m){const y=e.get(m).light;g.referencePosition.value.setFromMatrixPosition(y.matrixWorld),g.nearDistance.value=y.shadow.camera.near,g.farDistance.value=y.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function Bue(t,e,n,i){let r={},s={},o=[];const a=n.isWebGL2?t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(y,w){const b=w.program;i.uniformBlockBinding(y,b)}function c(y,w){let b=r[y.id];b===void 0&&(p(y),b=h(y),r[y.id]=b,y.addEventListener("dispose",g));const A=w.program;i.updateUBOMapping(y,A);const S=e.render.frame;s[y.id]!==S&&(d(y),s[y.id]=S)}function h(y){const w=u();y.__bindingPointIndex=w;const b=t.createBuffer(),A=y.__size,S=y.usage;return t.bindBuffer(t.UNIFORM_BUFFER,b),t.bufferData(t.UNIFORM_BUFFER,A,S),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,w,b),b}function u(){for(let y=0;y<a;y++)if(o.indexOf(y)===-1)return o.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(y){const w=r[y.id],b=y.uniforms,A=y.__cache;t.bindBuffer(t.UNIFORM_BUFFER,w);for(let S=0,T=b.length;S<T;S++){const M=b[S];if(f(M,S,A)===!0){const E=M.__offset,P=Array.isArray(M.value)?M.value:[M.value];let R=0;for(let F=0;F<P.length;F++){const B=P[F],k=v(B);typeof B=="number"?(M.__data[0]=B,t.bufferSubData(t.UNIFORM_BUFFER,E+R,M.__data)):B.isMatrix3?(M.__data[0]=B.elements[0],M.__data[1]=B.elements[1],M.__data[2]=B.elements[2],M.__data[3]=B.elements[0],M.__data[4]=B.elements[3],M.__data[5]=B.elements[4],M.__data[6]=B.elements[5],M.__data[7]=B.elements[0],M.__data[8]=B.elements[6],M.__data[9]=B.elements[7],M.__data[10]=B.elements[8],M.__data[11]=B.elements[0]):(B.toArray(M.__data,R),R+=k.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,E,M.__data)}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function f(y,w,b){const A=y.value;if(b[w]===void 0){if(typeof A=="number")b[w]=A;else{const S=Array.isArray(A)?A:[A],T=[];for(let M=0;M<S.length;M++)T.push(S[M].clone());b[w]=T}return!0}else if(typeof A=="number"){if(b[w]!==A)return b[w]=A,!0}else{const S=Array.isArray(b[w])?b[w]:[b[w]],T=Array.isArray(A)?A:[A];for(let M=0;M<S.length;M++){const E=S[M];if(E.equals(T[M])===!1)return E.copy(T[M]),!0}}return!1}function p(y){const w=y.uniforms;let b=0;const A=16;let S=0;for(let T=0,M=w.length;T<M;T++){const E=w[T],P={boundary:0,storage:0},R=Array.isArray(E.value)?E.value:[E.value];for(let F=0,B=R.length;F<B;F++){const k=R[F],j=v(k);P.boundary+=j.boundary,P.storage+=j.storage}if(E.__data=new Float32Array(P.storage/Float32Array.BYTES_PER_ELEMENT),E.__offset=b,T>0){S=b%A;const F=A-S;S!==0&&F-P.boundary<0&&(b+=A-S,E.__offset=b)}b+=P.storage}return S=b%A,S>0&&(b+=A-S),y.__size=b,y.__cache={},this}function v(y){const w={boundary:0,storage:0};return typeof y=="number"?(w.boundary=4,w.storage=4):y.isVector2?(w.boundary=8,w.storage=8):y.isVector3||y.isColor?(w.boundary=16,w.storage=12):y.isVector4?(w.boundary=16,w.storage=16):y.isMatrix3?(w.boundary=48,w.storage=48):y.isMatrix4?(w.boundary=64,w.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),w}function g(y){const w=y.target;w.removeEventListener("dispose",g);const b=o.indexOf(w.__bindingPointIndex);o.splice(b,1),t.deleteBuffer(r[w.id]),delete r[w.id],delete s[w.id]}function m(){for(const y in r)t.deleteBuffer(r[y]);o=[],r={},s={}}return{bind:l,update:c,dispose:m}}function Oue(){const t=xx("canvas");return t.style.display="block",t}class DB{constructor(e={}){const{canvas:n=Oue(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:h="default",failIfMajorPerformanceCaveat:u=!1}=e;this.isWebGLRenderer=!0;let d;i!==null?d=i.getContextAttributes().alpha:d=o;let f=null,p=null;const v=[],g=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=Jt,this.useLegacyLights=!0,this.toneMapping=Ya,this.toneMappingExposure=1;const m=this;let y=!1,w=0,b=0,A=null,S=-1,T=null;const M=new Dn,E=new Dn;let P=null,R=n.width,F=n.height,B=1,k=null,j=null;const Z=new Dn(0,0,R,F),ee=new Dn(0,0,R,F);let O=!1;const W=new ZM;let H=!1,Y=!1,z=null;const X=new kt,q=new ae,re={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function G(){return A===null?B:1}let K=i;function oe(Q,de){for(let le=0;le<Q.length;le++){const ce=Q[le],De=n.getContext(ce,de);if(De!==null)return De}return null}try{const Q={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:h,failIfMajorPerformanceCaveat:u};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${XM}`),n.addEventListener("webglcontextlost",ze,!1),n.addEventListener("webglcontextrestored",$e,!1),n.addEventListener("webglcontextcreationerror",dt,!1),K===null){const de=["webgl2","webgl","experimental-webgl"];if(m.isWebGL1Renderer===!0&&de.shift(),K=oe(de,Q),K===null)throw oe(de)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}K.getShaderPrecisionFormat===void 0&&(K.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Q){throw console.error("THREE.WebGLRenderer: "+Q.message),Q}let ve,$,se,ne,ie,me,xe,Ae,_e,Ee,Re,Ue,Ne,U,L,te,we,Te,Ie,Qe,Ge,ye,Ve,ue;function Me(){ve=new Jle(K),$=new Wle(K,ve,e),ve.init($),ye=new z7(K,ve,$),se=new Pue(K,ve,$),ne=new ece(K),ie=new vue,me=new Due(K,ve,se,ie,$,ye,ne),xe=new Yle(m),Ae=new Kle(m),_e=new doe(K,$),Ve=new Vle(K,ve,_e,$),Ee=new Zle(K,_e,ne,Ve),Re=new rce(K,Ee,_e,ne),Ie=new ice(K,$,me),te=new Xle(ie),Ue=new gue(m,xe,Ae,ve,$,Ve,te),Ne=new Iue(m,ie),U=new xue,L=new Mue(ve,$),Te=new Hle(m,xe,Ae,se,Re,d,l),we=new Tue(m,Re,$),ue=new Bue(K,ne,$,se),Qe=new jle(K,ve,ne,$),Ge=new $le(K,ve,ne,$),ne.programs=Ue.programs,m.capabilities=$,m.extensions=ve,m.properties=ie,m.renderLists=U,m.shadowMap=we,m.state=se,m.info=ne}Me();const Be=new Lue(m,K);this.xr=Be,this.getContext=function(){return K},this.getContextAttributes=function(){return K.getContextAttributes()},this.forceContextLoss=function(){const Q=ve.get("WEBGL_lose_context");Q&&Q.loseContext()},this.forceContextRestore=function(){const Q=ve.get("WEBGL_lose_context");Q&&Q.restoreContext()},this.getPixelRatio=function(){return B},this.setPixelRatio=function(Q){Q!==void 0&&(B=Q,this.setSize(R,F,!1))},this.getSize=function(Q){return Q.set(R,F)},this.setSize=function(Q,de,le=!0){if(Be.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}R=Q,F=de,n.width=Math.floor(Q*B),n.height=Math.floor(de*B),le===!0&&(n.style.width=Q+"px",n.style.height=de+"px"),this.setViewport(0,0,Q,de)},this.getDrawingBufferSize=function(Q){return Q.set(R*B,F*B).floor()},this.setDrawingBufferSize=function(Q,de,le){R=Q,F=de,B=le,n.width=Math.floor(Q*le),n.height=Math.floor(de*le),this.setViewport(0,0,Q,de)},this.getCurrentViewport=function(Q){return Q.copy(M)},this.getViewport=function(Q){return Q.copy(Z)},this.setViewport=function(Q,de,le,ce){Q.isVector4?Z.set(Q.x,Q.y,Q.z,Q.w):Z.set(Q,de,le,ce),se.viewport(M.copy(Z).multiplyScalar(B).floor())},this.getScissor=function(Q){return Q.copy(ee)},this.setScissor=function(Q,de,le,ce){Q.isVector4?ee.set(Q.x,Q.y,Q.z,Q.w):ee.set(Q,de,le,ce),se.scissor(E.copy(ee).multiplyScalar(B).floor())},this.getScissorTest=function(){return O},this.setScissorTest=function(Q){se.setScissorTest(O=Q)},this.setOpaqueSort=function(Q){k=Q},this.setTransparentSort=function(Q){j=Q},this.getClearColor=function(Q){return Q.copy(Te.getClearColor())},this.setClearColor=function(){Te.setClearColor.apply(Te,arguments)},this.getClearAlpha=function(){return Te.getClearAlpha()},this.setClearAlpha=function(){Te.setClearAlpha.apply(Te,arguments)},this.clear=function(Q=!0,de=!0,le=!0){let ce=0;Q&&(ce|=K.COLOR_BUFFER_BIT),de&&(ce|=K.DEPTH_BUFFER_BIT),le&&(ce|=K.STENCIL_BUFFER_BIT),K.clear(ce)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",ze,!1),n.removeEventListener("webglcontextrestored",$e,!1),n.removeEventListener("webglcontextcreationerror",dt,!1),U.dispose(),L.dispose(),ie.dispose(),xe.dispose(),Ae.dispose(),Re.dispose(),Ve.dispose(),ue.dispose(),Ue.dispose(),Be.dispose(),Be.removeEventListener("sessionstart",qe),Be.removeEventListener("sessionend",vt),z&&(z.dispose(),z=null),Et.stop()};function ze(Q){Q.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),y=!0}function $e(){console.log("THREE.WebGLRenderer: Context Restored."),y=!1;const Q=ne.autoReset,de=we.enabled,le=we.autoUpdate,ce=we.needsUpdate,De=we.type;Me(),ne.autoReset=Q,we.enabled=de,we.autoUpdate=le,we.needsUpdate=ce,we.type=De}function dt(Q){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Q.statusMessage)}function Bt(Q){const de=Q.target;de.removeEventListener("dispose",Bt),J(de)}function J(Q){fe(Q),ie.remove(Q)}function fe(Q){const de=ie.get(Q).programs;de!==void 0&&(de.forEach(function(le){Ue.releaseProgram(le)}),Q.isShaderMaterial&&Ue.releaseShaderCache(Q))}this.renderBufferDirect=function(Q,de,le,ce,De,Ke){de===null&&(de=re);const Ze=De.isMesh&&De.matrixWorld.determinant()<0,it=rp(Q,de,le,ce,De);se.setMaterial(ce,Ze);let ht=le.index,lt=1;ce.wireframe===!0&&(ht=Ee.getWireframeAttribute(le),lt=2);const ot=le.drawRange,Mt=le.attributes.position;let Vt=ot.start*lt,Un=(ot.start+ot.count)*lt;Ke!==null&&(Vt=Math.max(Vt,Ke.start*lt),Un=Math.min(Un,(Ke.start+Ke.count)*lt)),ht!==null?(Vt=Math.max(Vt,0),Un=Math.min(Un,ht.count)):Mt!=null&&(Vt=Math.max(Vt,0),Un=Math.min(Un,Mt.count));const Si=Un-Vt;if(Si<0||Si===1/0)return;Ve.setup(De,ce,it,le,ht);let vn,yt=Qe;if(ht!==null&&(vn=_e.get(ht),yt=Ge,yt.setIndex(vn)),De.isMesh)ce.wireframe===!0?(se.setLineWidth(ce.wireframeLinewidth*G()),yt.setMode(K.LINES)):yt.setMode(K.TRIANGLES);else if(De.isLine){let Qt=ce.linewidth;Qt===void 0&&(Qt=1),se.setLineWidth(Qt*G()),De.isLineSegments?yt.setMode(K.LINES):De.isLineLoop?yt.setMode(K.LINE_LOOP):yt.setMode(K.LINE_STRIP)}else De.isPoints?yt.setMode(K.POINTS):De.isSprite&&yt.setMode(K.TRIANGLES);if(De.isInstancedMesh)yt.renderInstances(Vt,Si,De.count);else if(le.isInstancedBufferGeometry){const Qt=le._maxInstanceCount!==void 0?le._maxInstanceCount:1/0,ga=Math.min(le.instanceCount,Qt);yt.renderInstances(Vt,Si,ga)}else yt.render(Vt,Si)},this.compile=function(Q,de){function le(ce,De,Ke){ce.transparent===!0&&ce.side===na&&ce.forceSinglePass===!1?(ce.side=gs,ce.needsUpdate=!0,cc(ce,De,Ke),ce.side=Zl,ce.needsUpdate=!0,cc(ce,De,Ke),ce.side=na):cc(ce,De,Ke)}p=L.get(Q),p.init(),g.push(p),Q.traverseVisible(function(ce){ce.isLight&&ce.layers.test(de.layers)&&(p.pushLight(ce),ce.castShadow&&p.pushShadow(ce))}),p.setupLights(m.useLegacyLights),Q.traverse(function(ce){const De=ce.material;if(De)if(Array.isArray(De))for(let Ke=0;Ke<De.length;Ke++){const Ze=De[Ke];le(Ze,Q,ce)}else le(De,Q,ce)}),g.pop(),p=null};let Se=null;function Oe(Q){Se&&Se(Q)}function qe(){Et.stop()}function vt(){Et.start()}const Et=new O7;Et.setAnimationLoop(Oe),typeof self<"u"&&Et.setContext(self),this.setAnimationLoop=function(Q){Se=Q,Be.setAnimationLoop(Q),Q===null?Et.stop():Et.start()},Be.addEventListener("sessionstart",qe),Be.addEventListener("sessionend",vt),this.render=function(Q,de){if(de!==void 0&&de.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(y===!0)return;Q.matrixWorldAutoUpdate===!0&&Q.updateMatrixWorld(),de.parent===null&&de.matrixWorldAutoUpdate===!0&&de.updateMatrixWorld(),Be.enabled===!0&&Be.isPresenting===!0&&(Be.cameraAutoUpdate===!0&&Be.updateCamera(de),de=Be.getCamera()),Q.isScene===!0&&Q.onBeforeRender(m,Q,de,A),p=L.get(Q,g.length),p.init(),g.push(p),X.multiplyMatrices(de.projectionMatrix,de.matrixWorldInverse),W.setFromProjectionMatrix(X),Y=this.localClippingEnabled,H=te.init(this.clippingPlanes,Y),f=U.get(Q,v.length),f.init(),v.push(f),un(Q,de,0,m.sortObjects),f.finish(),m.sortObjects===!0&&f.sort(k,j),H===!0&&te.beginShadows();const le=p.state.shadowsArray;if(we.render(le,Q,de),H===!0&&te.endShadows(),this.info.autoReset===!0&&this.info.reset(),Te.render(f,Q),p.setupLights(m.useLegacyLights),de.isArrayCamera){const ce=de.cameras;for(let De=0,Ke=ce.length;De<Ke;De++){const Ze=ce[De];Wi(f,Q,Ze,Ze.viewport)}}else Wi(f,Q,de);A!==null&&(me.updateMultisampleRenderTarget(A),me.updateRenderTargetMipmap(A)),Q.isScene===!0&&Q.onAfterRender(m,Q,de),Ve.resetDefaultState(),S=-1,T=null,g.pop(),g.length>0?p=g[g.length-1]:p=null,v.pop(),v.length>0?f=v[v.length-1]:f=null};function un(Q,de,le,ce){if(Q.visible===!1)return;if(Q.layers.test(de.layers)){if(Q.isGroup)le=Q.renderOrder;else if(Q.isLOD)Q.autoUpdate===!0&&Q.update(de);else if(Q.isLight)p.pushLight(Q),Q.castShadow&&p.pushShadow(Q);else if(Q.isSprite){if(!Q.frustumCulled||W.intersectsSprite(Q)){ce&&q.setFromMatrixPosition(Q.matrixWorld).applyMatrix4(X);const Ze=Re.update(Q),it=Q.material;it.visible&&f.push(Q,Ze,it,le,q.z,null)}}else if((Q.isMesh||Q.isLine||Q.isPoints)&&(!Q.frustumCulled||W.intersectsObject(Q))){Q.isSkinnedMesh&&Q.skeleton.frame!==ne.render.frame&&(Q.skeleton.update(),Q.skeleton.frame=ne.render.frame);const Ze=Re.update(Q),it=Q.material;if(ce&&(Ze.boundingSphere===null&&Ze.computeBoundingSphere(),q.copy(Ze.boundingSphere.center).applyMatrix4(Q.matrixWorld).applyMatrix4(X)),Array.isArray(it)){const ht=Ze.groups;for(let lt=0,ot=ht.length;lt<ot;lt++){const Mt=ht[lt],Vt=it[Mt.materialIndex];Vt&&Vt.visible&&f.push(Q,Ze,Vt,le,q.z,Mt)}}else it.visible&&f.push(Q,Ze,it,le,q.z,null)}}const Ke=Q.children;for(let Ze=0,it=Ke.length;Ze<it;Ze++)un(Ke[Ze],de,le,ce)}function Wi(Q,de,le,ce){const De=Q.opaque,Ke=Q.transmissive,Ze=Q.transparent;p.setupLightsView(le),H===!0&&te.setGlobalState(m.clippingPlanes,le),Ke.length>0&&Ot(De,Ke,de,le),ce&&se.viewport(M.copy(ce)),De.length>0&&Wn(De,de,le),Ke.length>0&&Wn(Ke,de,le),Ze.length>0&&Wn(Ze,de,le),se.buffers.depth.setTest(!0),se.buffers.depth.setMask(!0),se.buffers.color.setMask(!0),se.setPolygonOffset(!1)}function Ot(Q,de,le,ce){if(z===null){const it=$.isWebGL2;z=new Za(1024,1024,{generateMipmaps:!0,type:ve.has("EXT_color_buffer_half_float")?Bg:su,minFilter:$l,samples:it&&a===!0?4:0})}const De=m.getRenderTarget();m.setRenderTarget(z),m.clear();const Ke=m.toneMapping;m.toneMapping=Ya,Wn(Q,le,ce),me.updateMultisampleRenderTarget(z),me.updateRenderTargetMipmap(z);let Ze=!1;for(let it=0,ht=de.length;it<ht;it++){const lt=de[it],ot=lt.object,Mt=lt.geometry,Vt=lt.material,Un=lt.group;if(Vt.side===na&&ot.layers.test(ce.layers)){const Si=Vt.side;Vt.side=gs,Vt.needsUpdate=!0,Xn(ot,le,ce,Mt,Vt,Un),Vt.side=Si,Vt.needsUpdate=!0,Ze=!0}}Ze===!0&&(me.updateMultisampleRenderTarget(z),me.updateRenderTargetMipmap(z)),m.setRenderTarget(De),m.toneMapping=Ke}function Wn(Q,de,le){const ce=de.isScene===!0?de.overrideMaterial:null;for(let De=0,Ke=Q.length;De<Ke;De++){const Ze=Q[De],it=Ze.object,ht=Ze.geometry,lt=ce===null?Ze.material:ce,ot=Ze.group;it.layers.test(le.layers)&&Xn(it,de,le,ht,lt,ot)}}function Xn(Q,de,le,ce,De,Ke){Q.onBeforeRender(m,de,le,ce,De,Ke),Q.modelViewMatrix.multiplyMatrices(le.matrixWorldInverse,Q.matrixWorld),Q.normalMatrix.getNormalMatrix(Q.modelViewMatrix),De.onBeforeRender(m,de,le,ce,Q,Ke),De.transparent===!0&&De.side===na&&De.forceSinglePass===!1?(De.side=gs,De.needsUpdate=!0,m.renderBufferDirect(le,de,ce,De,Q,Ke),De.side=Zl,De.needsUpdate=!0,m.renderBufferDirect(le,de,ce,De,Q,Ke),De.side=na):m.renderBufferDirect(le,de,ce,De,Q,Ke),Q.onAfterRender(m,de,le,ce,De,Ke)}function cc(Q,de,le){de.isScene!==!0&&(de=re);const ce=ie.get(Q),De=p.state.lights,Ke=p.state.shadowsArray,Ze=De.state.version,it=Ue.getParameters(Q,De.state,Ke,de,le),ht=Ue.getProgramCacheKey(it);let lt=ce.programs;ce.environment=Q.isMeshStandardMaterial?de.environment:null,ce.fog=de.fog,ce.envMap=(Q.isMeshStandardMaterial?Ae:xe).get(Q.envMap||ce.environment),lt===void 0&&(Q.addEventListener("dispose",Bt),lt=new Map,ce.programs=lt);let ot=lt.get(ht);if(ot!==void 0){if(ce.currentProgram===ot&&ce.lightsStateVersion===Ze)return ip(Q,it),ot}else it.uniforms=Ue.getUniforms(Q),Q.onBuild(le,it,m),Q.onBeforeCompile(it,m),ot=Ue.acquireProgram(it,ht),lt.set(ht,ot),ce.uniforms=it.uniforms;const Mt=ce.uniforms;(!Q.isShaderMaterial&&!Q.isRawShaderMaterial||Q.clipping===!0)&&(Mt.clippingPlanes=te.uniform),ip(Q,it),ce.needsLights=he(Q),ce.lightsStateVersion=Ze,ce.needsLights&&(Mt.ambientLightColor.value=De.state.ambient,Mt.lightProbe.value=De.state.probe,Mt.directionalLights.value=De.state.directional,Mt.directionalLightShadows.value=De.state.directionalShadow,Mt.spotLights.value=De.state.spot,Mt.spotLightShadows.value=De.state.spotShadow,Mt.rectAreaLights.value=De.state.rectArea,Mt.ltc_1.value=De.state.rectAreaLTC1,Mt.ltc_2.value=De.state.rectAreaLTC2,Mt.pointLights.value=De.state.point,Mt.pointLightShadows.value=De.state.pointShadow,Mt.hemisphereLights.value=De.state.hemi,Mt.directionalShadowMap.value=De.state.directionalShadowMap,Mt.directionalShadowMatrix.value=De.state.directionalShadowMatrix,Mt.spotShadowMap.value=De.state.spotShadowMap,Mt.spotLightMatrix.value=De.state.spotLightMatrix,Mt.spotLightMap.value=De.state.spotLightMap,Mt.pointShadowMap.value=De.state.pointShadowMap,Mt.pointShadowMatrix.value=De.state.pointShadowMatrix);const Vt=ot.getUniforms(),Un=TS.seqWithValue(Vt.seq,Mt);return ce.currentProgram=ot,ce.uniformsList=Un,ot}function ip(Q,de){const le=ie.get(Q);le.outputColorSpace=de.outputColorSpace,le.instancing=de.instancing,le.skinning=de.skinning,le.morphTargets=de.morphTargets,le.morphNormals=de.morphNormals,le.morphColors=de.morphColors,le.morphTargetsCount=de.morphTargetsCount,le.numClippingPlanes=de.numClippingPlanes,le.numIntersection=de.numClipIntersection,le.vertexAlphas=de.vertexAlphas,le.vertexTangents=de.vertexTangents,le.toneMapping=de.toneMapping}function rp(Q,de,le,ce,De){de.isScene!==!0&&(de=re),me.resetTextureUnits();const Ke=de.fog,Ze=ce.isMeshStandardMaterial?de.environment:null,it=A===null?m.outputColorSpace:A.isXRRenderTarget===!0?A.texture.colorSpace:Ja,ht=(ce.isMeshStandardMaterial?Ae:xe).get(ce.envMap||Ze),lt=ce.vertexColors===!0&&!!le.attributes.color&&le.attributes.color.itemSize===4,ot=!!ce.normalMap&&!!le.attributes.tangent,Mt=!!le.morphAttributes.position,Vt=!!le.morphAttributes.normal,Un=!!le.morphAttributes.color,Si=ce.toneMapped?m.toneMapping:Ya,vn=le.morphAttributes.position||le.morphAttributes.normal||le.morphAttributes.color,yt=vn!==void 0?vn.length:0,Qt=ie.get(ce),ga=p.state.lights;if(H===!0&&(Y===!0||Q!==T)){const yn=Q===T&&ce.id===S;te.setState(ce,Q,yn)}let Bn=!1;ce.version===Qt.__version?(Qt.needsLights&&Qt.lightsStateVersion!==ga.state.version||Qt.outputColorSpace!==it||De.isInstancedMesh&&Qt.instancing===!1||!De.isInstancedMesh&&Qt.instancing===!0||De.isSkinnedMesh&&Qt.skinning===!1||!De.isSkinnedMesh&&Qt.skinning===!0||Qt.envMap!==ht||ce.fog===!0&&Qt.fog!==Ke||Qt.numClippingPlanes!==void 0&&(Qt.numClippingPlanes!==te.numPlanes||Qt.numIntersection!==te.numIntersection)||Qt.vertexAlphas!==lt||Qt.vertexTangents!==ot||Qt.morphTargets!==Mt||Qt.morphNormals!==Vt||Qt.morphColors!==Un||Qt.toneMapping!==Si||$.isWebGL2===!0&&Qt.morphTargetsCount!==yt)&&(Bn=!0):(Bn=!0,Qt.__version=ce.version);let bs=Qt.currentProgram;Bn===!0&&(bs=cc(ce,de,De));let es=!1,ar=!1,Gt=!1;const It=bs.getUniforms(),Li=Qt.uniforms;if(se.useProgram(bs.program)&&(es=!0,ar=!0,Gt=!0),ce.id!==S&&(S=ce.id,ar=!0),es||T!==Q){if(It.setValue(K,"projectionMatrix",Q.projectionMatrix),$.logarithmicDepthBuffer&&It.setValue(K,"logDepthBufFC",2/(Math.log(Q.far+1)/Math.LN2)),T!==Q&&(T=Q,ar=!0,Gt=!0),ce.isShaderMaterial||ce.isMeshPhongMaterial||ce.isMeshToonMaterial||ce.isMeshStandardMaterial||ce.envMap){const yn=It.map.cameraPosition;yn!==void 0&&yn.setValue(K,q.setFromMatrixPosition(Q.matrixWorld))}(ce.isMeshPhongMaterial||ce.isMeshToonMaterial||ce.isMeshLambertMaterial||ce.isMeshBasicMaterial||ce.isMeshStandardMaterial||ce.isShaderMaterial)&&It.setValue(K,"isOrthographic",Q.isOrthographicCamera===!0),(ce.isMeshPhongMaterial||ce.isMeshToonMaterial||ce.isMeshLambertMaterial||ce.isMeshBasicMaterial||ce.isMeshStandardMaterial||ce.isShaderMaterial||ce.isShadowMaterial||De.isSkinnedMesh)&&It.setValue(K,"viewMatrix",Q.matrixWorldInverse)}if(De.isSkinnedMesh){It.setOptional(K,De,"bindMatrix"),It.setOptional(K,De,"bindMatrixInverse");const yn=De.skeleton;yn&&($.floatVertexTextures?(yn.boneTexture===null&&yn.computeBoneTexture(),It.setValue(K,"boneTexture",yn.boneTexture,me),It.setValue(K,"boneTextureSize",yn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const dn=le.morphAttributes;if((dn.position!==void 0||dn.normal!==void 0||dn.color!==void 0&&$.isWebGL2===!0)&&Ie.update(De,le,bs),(ar||Qt.receiveShadow!==De.receiveShadow)&&(Qt.receiveShadow=De.receiveShadow,It.setValue(K,"receiveShadow",De.receiveShadow)),ce.isMeshGouraudMaterial&&ce.envMap!==null&&(Li.envMap.value=ht,Li.flipEnvMap.value=ht.isCubeTexture&&ht.isRenderTargetTexture===!1?-1:1),ar&&(It.setValue(K,"toneMappingExposure",m.toneMappingExposure),Qt.needsLights&&ad(Li,Gt),Ke&&ce.fog===!0&&Ne.refreshFogUniforms(Li,Ke),Ne.refreshMaterialUniforms(Li,ce,B,F,z),TS.upload(K,Qt.uniformsList,Li,me)),ce.isShaderMaterial&&ce.uniformsNeedUpdate===!0&&(TS.upload(K,Qt.uniformsList,Li,me),ce.uniformsNeedUpdate=!1),ce.isSpriteMaterial&&It.setValue(K,"center",De.center),It.setValue(K,"modelViewMatrix",De.modelViewMatrix),It.setValue(K,"normalMatrix",De.normalMatrix),It.setValue(K,"modelMatrix",De.matrixWorld),ce.isShaderMaterial||ce.isRawShaderMaterial){const yn=ce.uniformsGroups;for(let js=0,va=yn.length;js<va;js++)if($.isWebGL2){const Mr=yn[js];ue.update(Mr,bs),ue.bind(Mr,bs)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return bs}function ad(Q,de){Q.ambientLightColor.needsUpdate=de,Q.lightProbe.needsUpdate=de,Q.directionalLights.needsUpdate=de,Q.directionalLightShadows.needsUpdate=de,Q.pointLights.needsUpdate=de,Q.pointLightShadows.needsUpdate=de,Q.spotLights.needsUpdate=de,Q.spotLightShadows.needsUpdate=de,Q.rectAreaLights.needsUpdate=de,Q.hemisphereLights.needsUpdate=de}function he(Q){return Q.isMeshLambertMaterial||Q.isMeshToonMaterial||Q.isMeshPhongMaterial||Q.isMeshStandardMaterial||Q.isShadowMaterial||Q.isShaderMaterial&&Q.lights===!0}this.getActiveCubeFace=function(){return w},this.getActiveMipmapLevel=function(){return b},this.getRenderTarget=function(){return A},this.setRenderTargetTextures=function(Q,de,le){ie.get(Q.texture).__webglTexture=de,ie.get(Q.depthTexture).__webglTexture=le;const ce=ie.get(Q);ce.__hasExternalTextures=!0,ce.__hasExternalTextures&&(ce.__autoAllocateDepthBuffer=le===void 0,ce.__autoAllocateDepthBuffer||ve.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ce.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Q,de){const le=ie.get(Q);le.__webglFramebuffer=de,le.__useDefaultFramebuffer=de===void 0},this.setRenderTarget=function(Q,de=0,le=0){A=Q,w=de,b=le;let ce=!0,De=null,Ke=!1,Ze=!1;if(Q){const ht=ie.get(Q);ht.__useDefaultFramebuffer!==void 0?(se.bindFramebuffer(K.FRAMEBUFFER,null),ce=!1):ht.__webglFramebuffer===void 0?me.setupRenderTarget(Q):ht.__hasExternalTextures&&me.rebindTextures(Q,ie.get(Q.texture).__webglTexture,ie.get(Q.depthTexture).__webglTexture);const lt=Q.texture;(lt.isData3DTexture||lt.isDataArrayTexture||lt.isCompressedArrayTexture)&&(Ze=!0);const ot=ie.get(Q).__webglFramebuffer;Q.isWebGLCubeRenderTarget?(De=ot[de],Ke=!0):$.isWebGL2&&Q.samples>0&&me.useMultisampledRTT(Q)===!1?De=ie.get(Q).__webglMultisampledFramebuffer:De=ot,M.copy(Q.viewport),E.copy(Q.scissor),P=Q.scissorTest}else M.copy(Z).multiplyScalar(B).floor(),E.copy(ee).multiplyScalar(B).floor(),P=O;if(se.bindFramebuffer(K.FRAMEBUFFER,De)&&$.drawBuffers&&ce&&se.drawBuffers(Q,De),se.viewport(M),se.scissor(E),se.setScissorTest(P),Ke){const ht=ie.get(Q.texture);K.framebufferTexture2D(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0,K.TEXTURE_CUBE_MAP_POSITIVE_X+de,ht.__webglTexture,le)}else if(Ze){const ht=ie.get(Q.texture),lt=de||0;K.framebufferTextureLayer(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0,ht.__webglTexture,le||0,lt)}S=-1},this.readRenderTargetPixels=function(Q,de,le,ce,De,Ke,Ze){if(!(Q&&Q.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let it=ie.get(Q).__webglFramebuffer;if(Q.isWebGLCubeRenderTarget&&Ze!==void 0&&(it=it[Ze]),it){se.bindFramebuffer(K.FRAMEBUFFER,it);try{const ht=Q.texture,lt=ht.format,ot=ht.type;if(lt!==Ps&&ye.convert(lt)!==K.getParameter(K.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Mt=ot===Bg&&(ve.has("EXT_color_buffer_half_float")||$.isWebGL2&&ve.has("EXT_color_buffer_float"));if(ot!==su&&ye.convert(ot)!==K.getParameter(K.IMPLEMENTATION_COLOR_READ_TYPE)&&!(ot===Hc&&($.isWebGL2||ve.has("OES_texture_float")||ve.has("WEBGL_color_buffer_float")))&&!Mt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}de>=0&&de<=Q.width-ce&&le>=0&&le<=Q.height-De&&K.readPixels(de,le,ce,De,ye.convert(lt),ye.convert(ot),Ke)}finally{const ht=A!==null?ie.get(A).__webglFramebuffer:null;se.bindFramebuffer(K.FRAMEBUFFER,ht)}}},this.copyFramebufferToTexture=function(Q,de,le=0){const ce=Math.pow(2,-le),De=Math.floor(de.image.width*ce),Ke=Math.floor(de.image.height*ce);me.setTexture2D(de,0),K.copyTexSubImage2D(K.TEXTURE_2D,le,0,0,Q.x,Q.y,De,Ke),se.unbindTexture()},this.copyTextureToTexture=function(Q,de,le,ce=0){const De=de.image.width,Ke=de.image.height,Ze=ye.convert(le.format),it=ye.convert(le.type);me.setTexture2D(le,0),K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,le.flipY),K.pixelStorei(K.UNPACK_PREMULTIPLY_ALPHA_WEBGL,le.premultiplyAlpha),K.pixelStorei(K.UNPACK_ALIGNMENT,le.unpackAlignment),de.isDataTexture?K.texSubImage2D(K.TEXTURE_2D,ce,Q.x,Q.y,De,Ke,Ze,it,de.image.data):de.isCompressedTexture?K.compressedTexSubImage2D(K.TEXTURE_2D,ce,Q.x,Q.y,de.mipmaps[0].width,de.mipmaps[0].height,Ze,de.mipmaps[0].data):K.texSubImage2D(K.TEXTURE_2D,ce,Q.x,Q.y,Ze,it,de.image),ce===0&&le.generateMipmaps&&K.generateMipmap(K.TEXTURE_2D),se.unbindTexture()},this.copyTextureToTexture3D=function(Q,de,le,ce,De=0){if(m.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Ke=Q.max.x-Q.min.x+1,Ze=Q.max.y-Q.min.y+1,it=Q.max.z-Q.min.z+1,ht=ye.convert(ce.format),lt=ye.convert(ce.type);let ot;if(ce.isData3DTexture)me.setTexture3D(ce,0),ot=K.TEXTURE_3D;else if(ce.isDataArrayTexture)me.setTexture2DArray(ce,0),ot=K.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,ce.flipY),K.pixelStorei(K.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ce.premultiplyAlpha),K.pixelStorei(K.UNPACK_ALIGNMENT,ce.unpackAlignment);const Mt=K.getParameter(K.UNPACK_ROW_LENGTH),Vt=K.getParameter(K.UNPACK_IMAGE_HEIGHT),Un=K.getParameter(K.UNPACK_SKIP_PIXELS),Si=K.getParameter(K.UNPACK_SKIP_ROWS),vn=K.getParameter(K.UNPACK_SKIP_IMAGES),yt=le.isCompressedTexture?le.mipmaps[0]:le.image;K.pixelStorei(K.UNPACK_ROW_LENGTH,yt.width),K.pixelStorei(K.UNPACK_IMAGE_HEIGHT,yt.height),K.pixelStorei(K.UNPACK_SKIP_PIXELS,Q.min.x),K.pixelStorei(K.UNPACK_SKIP_ROWS,Q.min.y),K.pixelStorei(K.UNPACK_SKIP_IMAGES,Q.min.z),le.isDataTexture||le.isData3DTexture?K.texSubImage3D(ot,De,de.x,de.y,de.z,Ke,Ze,it,ht,lt,yt.data):le.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),K.compressedTexSubImage3D(ot,De,de.x,de.y,de.z,Ke,Ze,it,ht,yt.data)):K.texSubImage3D(ot,De,de.x,de.y,de.z,Ke,Ze,it,ht,lt,yt),K.pixelStorei(K.UNPACK_ROW_LENGTH,Mt),K.pixelStorei(K.UNPACK_IMAGE_HEIGHT,Vt),K.pixelStorei(K.UNPACK_SKIP_PIXELS,Un),K.pixelStorei(K.UNPACK_SKIP_ROWS,Si),K.pixelStorei(K.UNPACK_SKIP_IMAGES,vn),De===0&&ce.generateMipmaps&&K.generateMipmap(ot),se.unbindTexture()},this.initTexture=function(Q){Q.isCubeTexture?me.setTextureCube(Q,0):Q.isData3DTexture?me.setTexture3D(Q,0):Q.isDataArrayTexture||Q.isCompressedArrayTexture?me.setTexture2DArray(Q,0):me.setTexture2D(Q,0),se.unbindTexture()},this.resetState=function(){w=0,b=0,A=null,se.reset(),Ve.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Jt?yo:yB}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===yo?Jt:Ja}}class V7 extends DB{}V7.prototype.isWebGL1Renderer=!0;class eE{constructor(e,n=25e-5){this.isFogExp2=!0,this.name="",this.color=new st(e),this.density=n}clone(){return new eE(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class tE{constructor(e,n=1,i=1e3){this.isFog=!0,this.name="",this.color=new st(e),this.near=n,this.far=i}clone(){return new tE(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class _A extends mn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class u1{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=yx,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=xo()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,i){e*=this.stride,i*=n.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=n.array[i+r];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=xo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(n,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=xo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const is=new ae;class Wh{constructor(e,n,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,i=this.data.count;n<i;n++)is.fromBufferAttribute(this,n),is.applyMatrix4(e),this.setXYZ(n,is.x,is.y,is.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)is.fromBufferAttribute(this,n),is.applyNormalMatrix(e),this.setXYZ(n,is.x,is.y,is.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)is.fromBufferAttribute(this,n),is.transformDirection(e),this.setXYZ(n,is.x,is.y,is.z);return this}setX(e,n){return this.normalized&&(n=nn(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=nn(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=nn(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=nn(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=ao(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=ao(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=ao(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=ao(n,this.array)),n}setXY(e,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(n=nn(n,this.array),i=nn(i,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this}setXYZ(e,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(n=nn(n,this.array),i=nn(i,this.array),r=nn(r,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(n=nn(n,this.array),i=nn(i,this.array),r=nn(r,this.array),s=nn(s,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return new Sn(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Wh(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class RB extends Vi{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new st(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Bp;const l0=new ae,Op=new ae,Fp=new ae,Np=new Ye,c0=new Ye,j7=new kt,A_=new ae,u0=new ae,M_=new ae,Qz=new Ye,tP=new Ye,Kz=new Ye;class W7 extends mn{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",Bp===void 0){Bp=new Kt;const n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new u1(n,5);Bp.setIndex([0,1,2,0,2,3]),Bp.setAttribute("position",new Wh(i,3,0,!1)),Bp.setAttribute("uv",new Wh(i,2,3,!1))}this.geometry=Bp,this.material=e!==void 0?e:new RB,this.center=new Ye(.5,.5)}raycast(e,n){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Op.setFromMatrixScale(this.matrixWorld),j7.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Fp.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Op.multiplyScalar(-Fp.z);const i=this.material.rotation;let r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;E_(A_.set(-.5,-.5,0),Fp,o,Op,r,s),E_(u0.set(.5,-.5,0),Fp,o,Op,r,s),E_(M_.set(.5,.5,0),Fp,o,Op,r,s),Qz.set(0,0),tP.set(1,0),Kz.set(1,1);let a=e.ray.intersectTriangle(A_,u0,M_,!1,l0);if(a===null&&(E_(u0.set(-.5,.5,0),Fp,o,Op,r,s),tP.set(0,1),a=e.ray.intersectTriangle(A_,M_,u0,!1,l0),a===null))return;const l=e.ray.origin.distanceTo(l0);l<e.near||l>e.far||n.push({distance:l,point:l0.clone(),uv:Ts.getInterpolation(l0,A_,u0,M_,Qz,tP,Kz,new Ye),face:null,object:this})}copy(e,n){return super.copy(e,n),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function E_(t,e,n,i,r,s){Np.subVectors(t,n).addScalar(.5).multiply(i),r!==void 0?(c0.x=s*Np.x-r*Np.y,c0.y=r*Np.x+s*Np.y):c0.copy(Np),t.copy(e),t.x+=c0.x,t.y+=c0.y,t.applyMatrix4(j7)}const C_=new ae,Jz=new ae;class X7 extends mn{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const n=e.levels;for(let i=0,r=n.length;i<r;i++){const s=n[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,n=0,i=0){n=Math.abs(n);const r=this.levels;let s;for(s=0;s<r.length&&!(n<r[s].distance);s++);return r.splice(s,0,{distance:n,hysteresis:i,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const n=this.levels;if(n.length>0){let i,r;for(i=1,r=n.length;i<r;i++){let s=n[i].distance;if(n[i].object.visible&&(s-=s*n[i].hysteresis),e<s)break}return n[i-1].object}return null}raycast(e,n){if(this.levels.length>0){C_.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(C_);this.getObjectForDistance(r).raycast(e,n)}}update(e){const n=this.levels;if(n.length>1){C_.setFromMatrixPosition(e.matrixWorld),Jz.setFromMatrixPosition(this.matrixWorld);const i=C_.distanceTo(Jz)/e.zoom;n[0].object.visible=!0;let r,s;for(r=1,s=n.length;r<s;r++){let o=n[r].distance;if(n[r].object.visible&&(o-=o*n[r].hysteresis),i>=o)n[r-1].object.visible=!1,n[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)n[r].object.visible=!1}}toJSON(e){const n=super.toJSON(e);this.autoUpdate===!1&&(n.object.autoUpdate=!1),n.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const o=i[r];n.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return n}}const Zz=new ae,$z=new Dn,e4=new Dn,Fue=new ae,t4=new kt,Up=new ae;class LB extends yr{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new kt,this.bindMatrixInverse=new kt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new il),this.boundingBox.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)Up.fromBufferAttribute(n,i),this.applyBoneTransform(i,Up),this.boundingBox.expandByPoint(Up)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new rl),this.boundingSphere.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)Up.fromBufferAttribute(n,i),this.applyBoneTransform(i,Up),this.boundingSphere.expandByPoint(Up)}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}getVertexPosition(e,n){return super.getVertexPosition(e,n),this.applyBoneTransform(e,n),n}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Dn,n=this.geometry.attributes.skinWeight;for(let i=0,r=n.count;i<r;i++){e.fromBufferAttribute(n,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),n.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,n){const i=this.skeleton,r=this.geometry;$z.fromBufferAttribute(r.attributes.skinIndex,e),e4.fromBufferAttribute(r.attributes.skinWeight,e),Zz.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let s=0;s<4;s++){const o=e4.getComponent(s);if(o!==0){const a=$z.getComponent(s);t4.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),n.addScaledVector(Fue.copy(Zz).applyMatrix4(t4),o)}}return n.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,n){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,n)}}class nE extends mn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class cg extends ii{constructor(e=null,n=1,i=1,r,s,o,a,l,c=yi,h=yi,u,d){super(null,o,a,l,c,h,r,s,u,d),this.isDataTexture=!0,this.image={data:e,width:n,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const n4=new kt,Nue=new kt;class h1{constructor(e=[],n=[]){this.uuid=xo(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new kt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){const i=new kt;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,n=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:Nue;n4.multiplyMatrices(a,n[s]),n4.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new h1(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=T7(e),e=Math.max(e,4);const n=new Float32Array(e*e*4);n.set(this.boneMatrices);const i=new cg(n,e,e,Ps,Hc);return i.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let n=0,i=this.bones.length;n<i;n++){const r=this.bones[n];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=n[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new nE),this.bones.push(o),this.boneInverses.push(new kt().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const n=this.bones,i=this.boneInverses;for(let r=0,s=n.length;r<s;r++){const o=n[r];e.bones.push(o.uuid);const a=i[r];e.boneInverses.push(a.toArray())}return e}}class Ug extends Sn{constructor(e,n,i,r=1){super(e,n,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const kp=new kt,i4=new kt,T_=[],r4=new il,Uue=new kt,h0=new yr,d0=new rl;class IB extends yr{constructor(e,n,i){super(e,n),this.isInstancedMesh=!0,this.instanceMatrix=new Ug(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,Uue)}computeBoundingBox(){const e=this.geometry,n=this.count;this.boundingBox===null&&(this.boundingBox=new il),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,kp),r4.copy(e.boundingBox).applyMatrix4(kp),this.boundingBox.union(r4)}computeBoundingSphere(){const e=this.geometry,n=this.count;this.boundingSphere===null&&(this.boundingSphere=new rl),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,kp),d0.copy(e.boundingSphere).applyMatrix4(kp),this.boundingSphere.union(d0)}copy(e,n){return super.copy(e,n),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,n){n.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,n){n.fromArray(this.instanceMatrix.array,e*16)}raycast(e,n){const i=this.matrixWorld,r=this.count;if(h0.geometry=this.geometry,h0.material=this.material,h0.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),d0.copy(this.boundingSphere),d0.applyMatrix4(i),e.ray.intersectsSphere(d0)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,kp),i4.multiplyMatrices(i,kp),h0.matrixWorld=i4,h0.raycast(e,T_);for(let o=0,a=T_.length;o<a;o++){const l=T_[o];l.instanceId=s,l.object=this,n.push(l)}T_.length=0}}setColorAt(e,n){this.instanceColor===null&&(this.instanceColor=new Ug(new Float32Array(this.instanceMatrix.count*3),3)),n.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,n){n.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class $r extends Vi{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new st(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const s4=new ae,o4=new ae,a4=new kt,nP=new o1,P_=new rl;class ou extends mn{constructor(e=new Kt,n=new $r){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[0];for(let r=1,s=n.count;r<s;r++)s4.fromBufferAttribute(n,r-1),o4.fromBufferAttribute(n,r),i[r]=i[r-1],i[r]+=s4.distanceTo(o4);e.setAttribute("lineDistance",new xt(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),P_.copy(i.boundingSphere),P_.applyMatrix4(r),P_.radius+=s,e.ray.intersectsSphere(P_)===!1)return;a4.copy(r).invert(),nP.copy(e.ray).applyMatrix4(a4);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new ae,h=new ae,u=new ae,d=new ae,f=this.isLineSegments?2:1,p=i.index,g=i.attributes.position;if(p!==null){const m=Math.max(0,o.start),y=Math.min(p.count,o.start+o.count);for(let w=m,b=y-1;w<b;w+=f){const A=p.getX(w),S=p.getX(w+1);if(c.fromBufferAttribute(g,A),h.fromBufferAttribute(g,S),nP.distanceSqToSegment(c,h,d,u)>l)continue;d.applyMatrix4(this.matrixWorld);const M=e.ray.origin.distanceTo(d);M<e.near||M>e.far||n.push({distance:M,point:u.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}else{const m=Math.max(0,o.start),y=Math.min(g.count,o.start+o.count);for(let w=m,b=y-1;w<b;w+=f){if(c.fromBufferAttribute(g,w),h.fromBufferAttribute(g,w+1),nP.distanceSqToSegment(c,h,d,u)>l)continue;d.applyMatrix4(this.matrixWorld);const S=e.ray.origin.distanceTo(d);S<e.near||S>e.far||n.push({distance:S,point:u.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const l4=new ae,c4=new ae;class sl extends ou{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[];for(let r=0,s=n.count;r<s;r+=2)l4.fromBufferAttribute(n,r),c4.fromBufferAttribute(n,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+l4.distanceTo(c4);e.setAttribute("lineDistance",new xt(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class BB extends ou{constructor(e,n){super(e,n),this.isLineLoop=!0,this.type="LineLoop"}}class d1 extends Vi{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new st(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const u4=new kt,aL=new o1,D_=new rl,R_=new ae;let OB=class extends mn{constructor(e=new Kt,n=new d1){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=e.material,this.geometry=e.geometry,this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),D_.copy(i.boundingSphere),D_.applyMatrix4(r),D_.radius+=s,e.ray.intersectsSphere(D_)===!1)return;u4.copy(r).invert(),aL.copy(e.ray).applyMatrix4(u4);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=i.index,u=i.attributes.position;if(c!==null){const d=Math.max(0,o.start),f=Math.min(c.count,o.start+o.count);for(let p=d,v=f;p<v;p++){const g=c.getX(p);R_.fromBufferAttribute(u,g),h4(R_,g,l,r,e,n,this)}}else{const d=Math.max(0,o.start),f=Math.min(u.count,o.start+o.count);for(let p=d,v=f;p<v;p++)R_.fromBufferAttribute(u,p),h4(R_,p,l,r,e,n,this)}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};function h4(t,e,n,i,r,s,o){const a=aL.distanceSqToPoint(t);if(a<n){const l=new ae;aL.closestPointToPoint(t,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class kue extends ii{constructor(e,n,i,r,s,o,a,l,c){super(e,n,i,r,s,o,a,l,c),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:ai,this.magFilter=s!==void 0?s:ai,this.generateMipmaps=!1;const h=this;function u(){h.needsUpdate=!0,e.requestVideoFrameCallback(u)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(u)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class zue extends ii{constructor(e,n,i){super({width:e,height:n}),this.isFramebufferTexture=!0,this.format=i,this.magFilter=yi,this.minFilter=yi,this.generateMipmaps=!1,this.needsUpdate=!0}}class FB extends ii{constructor(e,n,i,r,s,o,a,l,c,h,u,d){super(null,o,a,l,c,h,r,s,u,d),this.isCompressedTexture=!0,this.image={width:n,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class Gue extends FB{constructor(e,n,i,r,s,o){super(e,n,i,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=Pr}}class Hue extends ii{constructor(e,n,i,r,s,o,a,l,c){super(e,n,i,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class ol{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,n){const i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,r=this.getPoint(0),s=0;n.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),n.push(s),r=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n){const i=this.getLengths();let r=0;const s=i.length;let o;n?o=n:o=e*i[s-1];let a=0,l=s-1,c;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=i[r]-o,c<0)a=r+1;else if(c>0)l=r-1;else{l=r;break}if(r=l,i[r]===o)return r/(s-1);const h=i[r],d=i[r+1]-h,f=(o-h)/d;return(r+f)/(s-1)}getTangent(e,n){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=n||(o.isVector2?new Ye:new ae);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,n){const i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n){const i=new ae,r=[],s=[],o=[],a=new ae,l=new kt;for(let f=0;f<=e;f++){const p=f/e;r[f]=this.getTangentAt(p,new ae)}s[0]=new ae,o[0]=new ae;let c=Number.MAX_VALUE;const h=Math.abs(r[0].x),u=Math.abs(r[0].y),d=Math.abs(r[0].z);h<=c&&(c=h,i.set(1,0,0)),u<=c&&(c=u,i.set(0,1,0)),d<=c&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();const p=Math.acos(xi(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(l.makeRotationAxis(a,p))}o[f].crossVectors(r[f],s[f])}if(n===!0){let f=Math.acos(xi(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(r[p],f*p)),o[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class iE extends ol{constructor(e=0,n=0,i=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,n){const i=n||new Ye,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const h=Math.cos(this.aRotation),u=Math.sin(this.aRotation),d=l-this.aX,f=c-this.aY;l=d*h-f*u+this.aX,c=d*u+f*h+this.aY}return i.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Y7 extends iE{constructor(e,n,i,r,s,o){super(e,n,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function NB(){let t=0,e=0,n=0,i=0;function r(s,o,a,l){t=s,e=a,n=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,h,u){let d=(o-s)/c-(a-s)/(c+h)+(a-o)/h,f=(a-o)/h-(l-o)/(h+u)+(l-a)/u;d*=h,f*=h,r(o,a,d,f)},calc:function(s){const o=s*s,a=o*s;return t+e*s+n*o+i*a}}}const L_=new ae,iP=new NB,rP=new NB,sP=new NB;class q7 extends ol{constructor(e=[],n=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=i,this.tension=r}getPoint(e,n=new ae){const i=n,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let c,h;this.closed||a>0?c=r[(a-1)%s]:(L_.subVectors(r[0],r[1]).add(r[0]),c=L_);const u=r[a%s],d=r[(a+1)%s];if(this.closed||a+2<s?h=r[(a+2)%s]:(L_.subVectors(r[s-1],r[s-2]).add(r[s-1]),h=L_),this.curveType==="centripetal"||this.curveType==="chordal"){const f=this.curveType==="chordal"?.5:.25;let p=Math.pow(c.distanceToSquared(u),f),v=Math.pow(u.distanceToSquared(d),f),g=Math.pow(d.distanceToSquared(h),f);v<1e-4&&(v=1),p<1e-4&&(p=v),g<1e-4&&(g=v),iP.initNonuniformCatmullRom(c.x,u.x,d.x,h.x,p,v,g),rP.initNonuniformCatmullRom(c.y,u.y,d.y,h.y,p,v,g),sP.initNonuniformCatmullRom(c.z,u.z,d.z,h.z,p,v,g)}else this.curveType==="catmullrom"&&(iP.initCatmullRom(c.x,u.x,d.x,h.x,this.tension),rP.initCatmullRom(c.y,u.y,d.y,h.y,this.tension),sP.initCatmullRom(c.z,u.z,d.z,h.z,this.tension));return i.set(iP.calc(l),rP.calc(l),sP.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new ae().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function d4(t,e,n,i,r){const s=(i-e)*.5,o=(r-n)*.5,a=t*t,l=t*a;return(2*n-2*i+s+o)*l+(-3*n+3*i-2*s-o)*a+s*t+n}function Vue(t,e){const n=1-t;return n*n*e}function jue(t,e){return 2*(1-t)*t*e}function Wue(t,e){return t*t*e}function Ey(t,e,n,i){return Vue(t,e)+jue(t,n)+Wue(t,i)}function Xue(t,e){const n=1-t;return n*n*n*e}function Yue(t,e){const n=1-t;return 3*n*n*t*e}function que(t,e){return 3*(1-t)*t*t*e}function Que(t,e){return t*t*t*e}function Cy(t,e,n,i,r){return Xue(t,e)+Yue(t,n)+que(t,i)+Que(t,r)}class UB extends ol{constructor(e=new Ye,n=new Ye,i=new Ye,r=new Ye){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new Ye){const i=n,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(Cy(e,r.x,s.x,o.x,a.x),Cy(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Q7 extends ol{constructor(e=new ae,n=new ae,i=new ae,r=new ae){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new ae){const i=n,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(Cy(e,r.x,s.x,o.x,a.x),Cy(e,r.y,s.y,o.y,a.y),Cy(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class rE extends ol{constructor(e=new Ye,n=new Ye){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new Ye){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new Ye){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class K7 extends ol{constructor(e=new ae,n=new ae){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new ae){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new ae){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class kB extends ol{constructor(e=new Ye,n=new Ye,i=new Ye){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new Ye){const i=n,r=this.v0,s=this.v1,o=this.v2;return i.set(Ey(e,r.x,s.x,o.x),Ey(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class zB extends ol{constructor(e=new ae,n=new ae,i=new ae){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new ae){const i=n,r=this.v0,s=this.v1,o=this.v2;return i.set(Ey(e,r.x,s.x,o.x),Ey(e,r.y,s.y,o.y),Ey(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class GB extends ol{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new Ye){const i=n,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],c=r[o],h=r[o>r.length-2?r.length-1:o+1],u=r[o>r.length-3?r.length-1:o+2];return i.set(d4(a,l.x,c.x,h.x,u.x),d4(a,l.y,c.y,h.y,u.y)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new Ye().fromArray(r))}return this}}var HB=Object.freeze({__proto__:null,ArcCurve:Y7,CatmullRomCurve3:q7,CubicBezierCurve:UB,CubicBezierCurve3:Q7,EllipseCurve:iE,LineCurve:rE,LineCurve3:K7,QuadraticBezierCurve:kB,QuadraticBezierCurve3:zB,SplineCurve:GB});class J7 extends ol{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);e.equals(n)||this.curves.push(new rE(n,e))}getPoint(e,n){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],l=a.getLength(),c=l===0?0:1-o/l;return a.getPointAt(c,n)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let n=0;for(let i=0,r=this.curves.length;i<r;i++)n+=this.curves[i].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){const n=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let c=0;c<l.length;c++){const h=l[c];i&&i.equals(h)||(n.push(h),i=h)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,i=this.curves.length;n<i;n++){const r=this.curves[n];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(new HB[r.type]().fromJSON(r))}return this}}class wx extends J7{constructor(e){super(),this.type="Path",this.currentPoint=new Ye,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,i=e.length;n<i;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){const i=new rE(this.currentPoint.clone(),new Ye(e,n));return this.curves.push(i),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,i,r){const s=new kB(this.currentPoint.clone(),new Ye(e,n),new Ye(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,n,i,r,s,o){const a=new UB(this.currentPoint.clone(),new Ye(e,n),new Ye(i,r),new Ye(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const n=[this.currentPoint.clone()].concat(e),i=new GB(n);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,i,r,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,n+l,i,r,s,o),this}absarc(e,n,i,r,s,o){return this.absellipse(e,n,i,i,r,s,o),this}ellipse(e,n,i,r,s,o,a,l){const c=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(e+c,n+h,i,r,s,o,a,l),this}absellipse(e,n,i,r,s,o,a,l){const c=new iE(e,n,i,r,s,o,a,l);if(this.curves.length>0){const u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);const h=c.getPoint(1);return this.currentPoint.copy(h),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class fv extends Kt{constructor(e=[new Ye(0,-.5),new Ye(.5,0),new Ye(0,.5)],n=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:i,phiLength:r},n=Math.floor(n),r=xi(r,0,Math.PI*2);const s=[],o=[],a=[],l=[],c=[],h=1/n,u=new ae,d=new Ye,f=new ae,p=new ae,v=new ae;let g=0,m=0;for(let y=0;y<=e.length-1;y++)switch(y){case 0:g=e[y+1].x-e[y].x,m=e[y+1].y-e[y].y,f.x=m*1,f.y=-g,f.z=m*0,v.copy(f),f.normalize(),l.push(f.x,f.y,f.z);break;case e.length-1:l.push(v.x,v.y,v.z);break;default:g=e[y+1].x-e[y].x,m=e[y+1].y-e[y].y,f.x=m*1,f.y=-g,f.z=m*0,p.copy(f),f.x+=v.x,f.y+=v.y,f.z+=v.z,f.normalize(),l.push(f.x,f.y,f.z),v.copy(p)}for(let y=0;y<=n;y++){const w=i+y*h*r,b=Math.sin(w),A=Math.cos(w);for(let S=0;S<=e.length-1;S++){u.x=e[S].x*b,u.y=e[S].y,u.z=e[S].x*A,o.push(u.x,u.y,u.z),d.x=y/n,d.y=S/(e.length-1),a.push(d.x,d.y);const T=l[3*S+0]*b,M=l[3*S+1],E=l[3*S+0]*A;c.push(T,M,E)}}for(let y=0;y<n;y++)for(let w=0;w<e.length-1;w++){const b=w+y*e.length,A=b,S=b+e.length,T=b+e.length+1,M=b+1;s.push(A,S,M),s.push(T,M,S)}this.setIndex(s),this.setAttribute("position",new xt(o,3)),this.setAttribute("uv",new xt(a,2)),this.setAttribute("normal",new xt(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fv(e.points,e.segments,e.phiStart,e.phiLength)}}class f1 extends fv{constructor(e=1,n=1,i=4,r=8){const s=new wx;s.absarc(0,-n/2,e,Math.PI*1.5,0),s.absarc(0,n/2,e,0,Math.PI*.5),super(s.getPoints(i),r),this.type="CapsuleGeometry",this.parameters={radius:e,height:n,capSegments:i,radialSegments:r}}static fromJSON(e){return new f1(e.radius,e.length,e.capSegments,e.radialSegments)}}class p1 extends Kt{constructor(e=1,n=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:i,thetaLength:r},n=Math.max(3,n);const s=[],o=[],a=[],l=[],c=new ae,h=new Ye;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let u=0,d=3;u<=n;u++,d+=3){const f=i+u/n*r;c.x=e*Math.cos(f),c.y=e*Math.sin(f),o.push(c.x,c.y,c.z),a.push(0,0,1),h.x=(o[d]/e+1)/2,h.y=(o[d+1]/e+1)/2,l.push(h.x,h.y)}for(let u=1;u<=n;u++)s.push(u,u+1,0);this.setIndex(s),this.setAttribute("position",new xt(o,3)),this.setAttribute("normal",new xt(a,3)),this.setAttribute("uv",new xt(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new p1(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Xf extends Kt{constructor(e=1,n=1,i=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const h=[],u=[],d=[],f=[];let p=0;const v=[],g=i/2;let m=0;y(),o===!1&&(e>0&&w(!0),n>0&&w(!1)),this.setIndex(h),this.setAttribute("position",new xt(u,3)),this.setAttribute("normal",new xt(d,3)),this.setAttribute("uv",new xt(f,2));function y(){const b=new ae,A=new ae;let S=0;const T=(n-e)/i;for(let M=0;M<=s;M++){const E=[],P=M/s,R=P*(n-e)+e;for(let F=0;F<=r;F++){const B=F/r,k=B*l+a,j=Math.sin(k),Z=Math.cos(k);A.x=R*j,A.y=-P*i+g,A.z=R*Z,u.push(A.x,A.y,A.z),b.set(j,T,Z).normalize(),d.push(b.x,b.y,b.z),f.push(B,1-P),E.push(p++)}v.push(E)}for(let M=0;M<r;M++)for(let E=0;E<s;E++){const P=v[E][M],R=v[E+1][M],F=v[E+1][M+1],B=v[E][M+1];h.push(P,R,B),h.push(R,F,B),S+=6}c.addGroup(m,S,0),m+=S}function w(b){const A=p,S=new Ye,T=new ae;let M=0;const E=b===!0?e:n,P=b===!0?1:-1;for(let F=1;F<=r;F++)u.push(0,g*P,0),d.push(0,P,0),f.push(.5,.5),p++;const R=p;for(let F=0;F<=r;F++){const k=F/r*l+a,j=Math.cos(k),Z=Math.sin(k);T.x=E*Z,T.y=g*P,T.z=E*j,u.push(T.x,T.y,T.z),d.push(0,P,0),S.x=j*.5+.5,S.y=Z*.5*P+.5,f.push(S.x,S.y),p++}for(let F=0;F<r;F++){const B=A+F,k=R+F;b===!0?h.push(k,k+1,B):h.push(k+1,k,B),M+=3}c.addGroup(m,M,b===!0?1:2),m+=M}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Xf(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class m1 extends Xf{constructor(e=1,n=1,i=32,r=1,s=!1,o=0,a=Math.PI*2){super(0,e,n,i,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new m1(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class pu extends Kt{constructor(e=[],n=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:i,detail:r};const s=[],o=[];a(r),c(i),h(),this.setAttribute("position",new xt(s,3)),this.setAttribute("normal",new xt(s.slice(),3)),this.setAttribute("uv",new xt(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(y){const w=new ae,b=new ae,A=new ae;for(let S=0;S<n.length;S+=3)f(n[S+0],w),f(n[S+1],b),f(n[S+2],A),l(w,b,A,y)}function l(y,w,b,A){const S=A+1,T=[];for(let M=0;M<=S;M++){T[M]=[];const E=y.clone().lerp(b,M/S),P=w.clone().lerp(b,M/S),R=S-M;for(let F=0;F<=R;F++)F===0&&M===S?T[M][F]=E:T[M][F]=E.clone().lerp(P,F/R)}for(let M=0;M<S;M++)for(let E=0;E<2*(S-M)-1;E++){const P=Math.floor(E/2);E%2===0?(d(T[M][P+1]),d(T[M+1][P]),d(T[M][P])):(d(T[M][P+1]),d(T[M+1][P+1]),d(T[M+1][P]))}}function c(y){const w=new ae;for(let b=0;b<s.length;b+=3)w.x=s[b+0],w.y=s[b+1],w.z=s[b+2],w.normalize().multiplyScalar(y),s[b+0]=w.x,s[b+1]=w.y,s[b+2]=w.z}function h(){const y=new ae;for(let w=0;w<s.length;w+=3){y.x=s[w+0],y.y=s[w+1],y.z=s[w+2];const b=g(y)/2/Math.PI+.5,A=m(y)/Math.PI+.5;o.push(b,1-A)}p(),u()}function u(){for(let y=0;y<o.length;y+=6){const w=o[y+0],b=o[y+2],A=o[y+4],S=Math.max(w,b,A),T=Math.min(w,b,A);S>.9&&T<.1&&(w<.2&&(o[y+0]+=1),b<.2&&(o[y+2]+=1),A<.2&&(o[y+4]+=1))}}function d(y){s.push(y.x,y.y,y.z)}function f(y,w){const b=y*3;w.x=e[b+0],w.y=e[b+1],w.z=e[b+2]}function p(){const y=new ae,w=new ae,b=new ae,A=new ae,S=new Ye,T=new Ye,M=new Ye;for(let E=0,P=0;E<s.length;E+=9,P+=6){y.set(s[E+0],s[E+1],s[E+2]),w.set(s[E+3],s[E+4],s[E+5]),b.set(s[E+6],s[E+7],s[E+8]),S.set(o[P+0],o[P+1]),T.set(o[P+2],o[P+3]),M.set(o[P+4],o[P+5]),A.copy(y).add(w).add(b).divideScalar(3);const R=g(A);v(S,P+0,y,R),v(T,P+2,w,R),v(M,P+4,b,R)}}function v(y,w,b,A){A<0&&y.x===1&&(o[w]=y.x-1),b.x===0&&b.z===0&&(o[w]=A/2/Math.PI+.5)}function g(y){return Math.atan2(y.z,-y.x)}function m(y){return Math.atan2(-y.y,Math.sqrt(y.x*y.x+y.z*y.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pu(e.vertices,e.indices,e.radius,e.details)}}class g1 extends pu{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,n),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new g1(e.radius,e.detail)}}const I_=new ae,B_=new ae,oP=new ae,O_=new Ts;class Z7 extends Kt{constructor(e=null,n=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:n},e!==null){const r=Math.pow(10,4),s=Math.cos(mf*n),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],h=["a","b","c"],u=new Array(3),d={},f=[];for(let p=0;p<l;p+=3){o?(c[0]=o.getX(p),c[1]=o.getX(p+1),c[2]=o.getX(p+2)):(c[0]=p,c[1]=p+1,c[2]=p+2);const{a:v,b:g,c:m}=O_;if(v.fromBufferAttribute(a,c[0]),g.fromBufferAttribute(a,c[1]),m.fromBufferAttribute(a,c[2]),O_.getNormal(oP),u[0]=`${Math.round(v.x*r)},${Math.round(v.y*r)},${Math.round(v.z*r)}`,u[1]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,u[2]=`${Math.round(m.x*r)},${Math.round(m.y*r)},${Math.round(m.z*r)}`,!(u[0]===u[1]||u[1]===u[2]||u[2]===u[0]))for(let y=0;y<3;y++){const w=(y+1)%3,b=u[y],A=u[w],S=O_[h[y]],T=O_[h[w]],M=`${b}_${A}`,E=`${A}_${b}`;E in d&&d[E]?(oP.dot(d[E].normal)<=s&&(f.push(S.x,S.y,S.z),f.push(T.x,T.y,T.z)),d[E]=null):M in d||(d[M]={index0:c[y],index1:c[w],normal:oP.clone()})}}for(const p in d)if(d[p]){const{index0:v,index1:g}=d[p];I_.fromBufferAttribute(a,v),B_.fromBufferAttribute(a,g),f.push(I_.x,I_.y,I_.z),f.push(B_.x,B_.y,B_.z)}this.setAttribute("position",new xt(f,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class vf extends wx{constructor(e){super(e),this.uuid=xo(),this.type="Shape",this.holes=[]}getPointsHoles(e){const n=[];for(let i=0,r=this.holes.length;i<r;i++)n[i]=this.holes[i].getPoints(e);return n}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,i=this.holes.length;n<i;n++){const r=this.holes[n];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(new wx().fromJSON(r))}return this}}const Kue={triangulate:function(t,e,n=2){const i=e&&e.length,r=i?e[0]*n:t.length;let s=$7(t,0,r,n,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,h,u,d,f;if(i&&(s=the(t,e,s,n)),t.length>80*n){a=c=t[0],l=h=t[1];for(let p=n;p<r;p+=n)u=t[p],d=t[p+1],u<a&&(a=u),d<l&&(l=d),u>c&&(c=u),d>h&&(h=d);f=Math.max(c-a,h-l),f=f!==0?32767/f:0}return _x(s,o,n,a,l,f,0),o}};function $7(t,e,n,i,r){let s,o;if(r===dhe(t,e,n,i)>0)for(s=e;s<n;s+=i)o=f4(s,t[s],t[s+1],o);else for(s=n-i;s>=e;s-=i)o=f4(s,t[s],t[s+1],o);return o&&sE(o,o.next)&&(Sx(o),o=o.next),o}function If(t,e){if(!t)return t;e||(e=t);let n=t,i;do if(i=!1,!n.steiner&&(sE(n,n.next)||li(n.prev,n,n.next)===0)){if(Sx(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function _x(t,e,n,i,r,s,o){if(!t)return;!o&&s&&ohe(t,i,r,s);let a=t,l,c;for(;t.prev!==t.next;){if(l=t.prev,c=t.next,s?Zue(t,i,r,s):Jue(t)){e.push(l.i/n|0),e.push(t.i/n|0),e.push(c.i/n|0),Sx(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=$ue(If(t),e,n),_x(t,e,n,i,r,s,2)):o===2&&ehe(t,e,n,i,r,s):_x(If(t),e,n,i,r,s,1);break}}}function Jue(t){const e=t.prev,n=t,i=t.next;if(li(e,n,i)>=0)return!1;const r=e.x,s=n.x,o=i.x,a=e.y,l=n.y,c=i.y,h=r<s?r<o?r:o:s<o?s:o,u=a<l?a<c?a:c:l<c?l:c,d=r>s?r>o?r:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c;let p=i.next;for(;p!==e;){if(p.x>=h&&p.x<=d&&p.y>=u&&p.y<=f&&km(r,a,s,l,o,c,p.x,p.y)&&li(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Zue(t,e,n,i){const r=t.prev,s=t,o=t.next;if(li(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,h=r.y,u=s.y,d=o.y,f=a<l?a<c?a:c:l<c?l:c,p=h<u?h<d?h:d:u<d?u:d,v=a>l?a>c?a:c:l>c?l:c,g=h>u?h>d?h:d:u>d?u:d,m=lL(f,p,e,n,i),y=lL(v,g,e,n,i);let w=t.prevZ,b=t.nextZ;for(;w&&w.z>=m&&b&&b.z<=y;){if(w.x>=f&&w.x<=v&&w.y>=p&&w.y<=g&&w!==r&&w!==o&&km(a,h,l,u,c,d,w.x,w.y)&&li(w.prev,w,w.next)>=0||(w=w.prevZ,b.x>=f&&b.x<=v&&b.y>=p&&b.y<=g&&b!==r&&b!==o&&km(a,h,l,u,c,d,b.x,b.y)&&li(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;w&&w.z>=m;){if(w.x>=f&&w.x<=v&&w.y>=p&&w.y<=g&&w!==r&&w!==o&&km(a,h,l,u,c,d,w.x,w.y)&&li(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;b&&b.z<=y;){if(b.x>=f&&b.x<=v&&b.y>=p&&b.y<=g&&b!==r&&b!==o&&km(a,h,l,u,c,d,b.x,b.y)&&li(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function $ue(t,e,n){let i=t;do{const r=i.prev,s=i.next.next;!sE(r,s)&&eY(r,i,i.next,s)&&bx(r,s)&&bx(s,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(s.i/n|0),Sx(i),Sx(i.next),i=t=s),i=i.next}while(i!==t);return If(i)}function ehe(t,e,n,i,r,s){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&che(o,a)){let l=tY(o,a);o=If(o,o.next),l=If(l,l.next),_x(o,e,n,i,r,s,0),_x(l,e,n,i,r,s,0);return}a=a.next}o=o.next}while(o!==t)}function the(t,e,n,i){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:t.length,c=$7(t,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(lhe(c));for(r.sort(nhe),s=0;s<r.length;s++)n=ihe(r[s],n);return n}function nhe(t,e){return t.x-e.x}function ihe(t,e){const n=rhe(t,e);if(!n)return e;const i=tY(n,t);return If(i,i.next),If(n,n.next)}function rhe(t,e){let n=e,i=-1/0,r;const s=t.x,o=t.y;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){const d=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(d<=s&&d>i&&(i=d,r=n.x<n.next.x?n:n.next,d===s))return r}n=n.next}while(n!==e);if(!r)return null;const a=r,l=r.x,c=r.y;let h=1/0,u;n=r;do s>=n.x&&n.x>=l&&s!==n.x&&km(o<c?s:i,o,l,c,o<c?i:s,o,n.x,n.y)&&(u=Math.abs(o-n.y)/(s-n.x),bx(n,t)&&(u<h||u===h&&(n.x>r.x||n.x===r.x&&she(r,n)))&&(r=n,h=u)),n=n.next;while(n!==a);return r}function she(t,e){return li(t.prev,t,e.prev)<0&&li(e.next,t,t.next)<0}function ohe(t,e,n,i){let r=t;do r.z===0&&(r.z=lL(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,ahe(r)}function ahe(t){let e,n,i,r,s,o,a,l,c=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,i=n,a=0,e=0;e<c&&(a++,i=i.nextZ,!!i);e++);for(l=c;a>0||l>0&&i;)a!==0&&(l===0||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,c*=2}while(o>1);return t}function lL(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function lhe(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function km(t,e,n,i,r,s,o,a){return(r-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(i-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(r-o)*(i-a)}function che(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!uhe(t,e)&&(bx(t,e)&&bx(e,t)&&hhe(t,e)&&(li(t.prev,t,e.prev)||li(t,e.prev,e))||sE(t,e)&&li(t.prev,t,t.next)>0&&li(e.prev,e,e.next)>0)}function li(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function sE(t,e){return t.x===e.x&&t.y===e.y}function eY(t,e,n,i){const r=N_(li(t,e,n)),s=N_(li(t,e,i)),o=N_(li(n,i,t)),a=N_(li(n,i,e));return!!(r!==s&&o!==a||r===0&&F_(t,n,e)||s===0&&F_(t,i,e)||o===0&&F_(n,t,i)||a===0&&F_(n,e,i))}function F_(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function N_(t){return t>0?1:t<0?-1:0}function uhe(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&eY(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function bx(t,e){return li(t.prev,t,t.next)<0?li(t,e,t.next)>=0&&li(t,t.prev,e)>=0:li(t,e,t.prev)<0||li(t,t.next,e)<0}function hhe(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function tY(t,e){const n=new cL(t.i,t.x,t.y),i=new cL(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function f4(t,e,n,i){const r=new cL(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Sx(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function cL(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function dhe(t,e,n,i){let r=0;for(let s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}class Xl{static area(e){const n=e.length;let i=0;for(let r=n-1,s=0;s<n;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return Xl.area(e)<0}static triangulateShape(e,n){const i=[],r=[],s=[];p4(e),m4(i,e);let o=e.length;n.forEach(p4);for(let l=0;l<n.length;l++)r.push(o),o+=n[l].length,m4(i,n[l]);const a=Kue.triangulate(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function p4(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function m4(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class v1 extends Kt{constructor(e=new vf([new Ye(.5,.5),new Ye(-.5,.5),new Ye(-.5,-.5),new Ye(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++){const c=e[a];o(c)}this.setAttribute("position",new xt(r,3)),this.setAttribute("uv",new xt(s,2)),this.computeVertexNormals();function o(a){const l=[],c=n.curveSegments!==void 0?n.curveSegments:12,h=n.steps!==void 0?n.steps:1,u=n.depth!==void 0?n.depth:1;let d=n.bevelEnabled!==void 0?n.bevelEnabled:!0,f=n.bevelThickness!==void 0?n.bevelThickness:.2,p=n.bevelSize!==void 0?n.bevelSize:f-.1,v=n.bevelOffset!==void 0?n.bevelOffset:0,g=n.bevelSegments!==void 0?n.bevelSegments:3;const m=n.extrudePath,y=n.UVGenerator!==void 0?n.UVGenerator:fhe;let w,b=!1,A,S,T,M;m&&(w=m.getSpacedPoints(h),b=!0,d=!1,A=m.computeFrenetFrames(h,!1),S=new ae,T=new ae,M=new ae),d||(g=0,f=0,p=0,v=0);const E=a.extractPoints(c);let P=E.shape;const R=E.holes;if(!Xl.isClockWise(P)){P=P.reverse();for(let ne=0,ie=R.length;ne<ie;ne++){const me=R[ne];Xl.isClockWise(me)&&(R[ne]=me.reverse())}}const B=Xl.triangulateShape(P,R),k=P;for(let ne=0,ie=R.length;ne<ie;ne++){const me=R[ne];P=P.concat(me)}function j(ne,ie,me){return ie||console.error("THREE.ExtrudeGeometry: vec does not exist"),ne.clone().addScaledVector(ie,me)}const Z=P.length,ee=B.length;function O(ne,ie,me){let xe,Ae,_e;const Ee=ne.x-ie.x,Re=ne.y-ie.y,Ue=me.x-ne.x,Ne=me.y-ne.y,U=Ee*Ee+Re*Re,L=Ee*Ne-Re*Ue;if(Math.abs(L)>Number.EPSILON){const te=Math.sqrt(U),we=Math.sqrt(Ue*Ue+Ne*Ne),Te=ie.x-Re/te,Ie=ie.y+Ee/te,Qe=me.x-Ne/we,Ge=me.y+Ue/we,ye=((Qe-Te)*Ne-(Ge-Ie)*Ue)/(Ee*Ne-Re*Ue);xe=Te+Ee*ye-ne.x,Ae=Ie+Re*ye-ne.y;const Ve=xe*xe+Ae*Ae;if(Ve<=2)return new Ye(xe,Ae);_e=Math.sqrt(Ve/2)}else{let te=!1;Ee>Number.EPSILON?Ue>Number.EPSILON&&(te=!0):Ee<-Number.EPSILON?Ue<-Number.EPSILON&&(te=!0):Math.sign(Re)===Math.sign(Ne)&&(te=!0),te?(xe=-Re,Ae=Ee,_e=Math.sqrt(U)):(xe=Ee,Ae=Re,_e=Math.sqrt(U/2))}return new Ye(xe/_e,Ae/_e)}const W=[];for(let ne=0,ie=k.length,me=ie-1,xe=ne+1;ne<ie;ne++,me++,xe++)me===ie&&(me=0),xe===ie&&(xe=0),W[ne]=O(k[ne],k[me],k[xe]);const H=[];let Y,z=W.concat();for(let ne=0,ie=R.length;ne<ie;ne++){const me=R[ne];Y=[];for(let xe=0,Ae=me.length,_e=Ae-1,Ee=xe+1;xe<Ae;xe++,_e++,Ee++)_e===Ae&&(_e=0),Ee===Ae&&(Ee=0),Y[xe]=O(me[xe],me[_e],me[Ee]);H.push(Y),z=z.concat(Y)}for(let ne=0;ne<g;ne++){const ie=ne/g,me=f*Math.cos(ie*Math.PI/2),xe=p*Math.sin(ie*Math.PI/2)+v;for(let Ae=0,_e=k.length;Ae<_e;Ae++){const Ee=j(k[Ae],W[Ae],xe);K(Ee.x,Ee.y,-me)}for(let Ae=0,_e=R.length;Ae<_e;Ae++){const Ee=R[Ae];Y=H[Ae];for(let Re=0,Ue=Ee.length;Re<Ue;Re++){const Ne=j(Ee[Re],Y[Re],xe);K(Ne.x,Ne.y,-me)}}}const X=p+v;for(let ne=0;ne<Z;ne++){const ie=d?j(P[ne],z[ne],X):P[ne];b?(T.copy(A.normals[0]).multiplyScalar(ie.x),S.copy(A.binormals[0]).multiplyScalar(ie.y),M.copy(w[0]).add(T).add(S),K(M.x,M.y,M.z)):K(ie.x,ie.y,0)}for(let ne=1;ne<=h;ne++)for(let ie=0;ie<Z;ie++){const me=d?j(P[ie],z[ie],X):P[ie];b?(T.copy(A.normals[ne]).multiplyScalar(me.x),S.copy(A.binormals[ne]).multiplyScalar(me.y),M.copy(w[ne]).add(T).add(S),K(M.x,M.y,M.z)):K(me.x,me.y,u/h*ne)}for(let ne=g-1;ne>=0;ne--){const ie=ne/g,me=f*Math.cos(ie*Math.PI/2),xe=p*Math.sin(ie*Math.PI/2)+v;for(let Ae=0,_e=k.length;Ae<_e;Ae++){const Ee=j(k[Ae],W[Ae],xe);K(Ee.x,Ee.y,u+me)}for(let Ae=0,_e=R.length;Ae<_e;Ae++){const Ee=R[Ae];Y=H[Ae];for(let Re=0,Ue=Ee.length;Re<Ue;Re++){const Ne=j(Ee[Re],Y[Re],xe);b?K(Ne.x,Ne.y+w[h-1].y,w[h-1].x+me):K(Ne.x,Ne.y,u+me)}}}q(),re();function q(){const ne=r.length/3;if(d){let ie=0,me=Z*ie;for(let xe=0;xe<ee;xe++){const Ae=B[xe];oe(Ae[2]+me,Ae[1]+me,Ae[0]+me)}ie=h+g*2,me=Z*ie;for(let xe=0;xe<ee;xe++){const Ae=B[xe];oe(Ae[0]+me,Ae[1]+me,Ae[2]+me)}}else{for(let ie=0;ie<ee;ie++){const me=B[ie];oe(me[2],me[1],me[0])}for(let ie=0;ie<ee;ie++){const me=B[ie];oe(me[0]+Z*h,me[1]+Z*h,me[2]+Z*h)}}i.addGroup(ne,r.length/3-ne,0)}function re(){const ne=r.length/3;let ie=0;G(k,ie),ie+=k.length;for(let me=0,xe=R.length;me<xe;me++){const Ae=R[me];G(Ae,ie),ie+=Ae.length}i.addGroup(ne,r.length/3-ne,1)}function G(ne,ie){let me=ne.length;for(;--me>=0;){const xe=me;let Ae=me-1;Ae<0&&(Ae=ne.length-1);for(let _e=0,Ee=h+g*2;_e<Ee;_e++){const Re=Z*_e,Ue=Z*(_e+1),Ne=ie+xe+Re,U=ie+Ae+Re,L=ie+Ae+Ue,te=ie+xe+Ue;ve(Ne,U,L,te)}}}function K(ne,ie,me){l.push(ne),l.push(ie),l.push(me)}function oe(ne,ie,me){$(ne),$(ie),$(me);const xe=r.length/3,Ae=y.generateTopUV(i,r,xe-3,xe-2,xe-1);se(Ae[0]),se(Ae[1]),se(Ae[2])}function ve(ne,ie,me,xe){$(ne),$(ie),$(xe),$(ie),$(me),$(xe);const Ae=r.length/3,_e=y.generateSideWallUV(i,r,Ae-6,Ae-3,Ae-2,Ae-1);se(_e[0]),se(_e[1]),se(_e[3]),se(_e[1]),se(_e[2]),se(_e[3])}function $(ne){r.push(l[ne*3+0]),r.push(l[ne*3+1]),r.push(l[ne*3+2])}function se(ne){s.push(ne.x),s.push(ne.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes,i=this.parameters.options;return phe(n,i,e)}static fromJSON(e,n){const i=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=n[e.shapes[s]];i.push(a)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new HB[r.type]().fromJSON(r)),new v1(i,e.options)}}const fhe={generateTopUV:function(t,e,n,i,r){const s=e[n*3],o=e[n*3+1],a=e[i*3],l=e[i*3+1],c=e[r*3],h=e[r*3+1];return[new Ye(s,o),new Ye(a,l),new Ye(c,h)]},generateSideWallUV:function(t,e,n,i,r,s){const o=e[n*3],a=e[n*3+1],l=e[n*3+2],c=e[i*3],h=e[i*3+1],u=e[i*3+2],d=e[r*3],f=e[r*3+1],p=e[r*3+2],v=e[s*3],g=e[s*3+1],m=e[s*3+2];return Math.abs(a-h)<Math.abs(o-c)?[new Ye(o,1-l),new Ye(c,1-u),new Ye(d,1-p),new Ye(v,1-m)]:[new Ye(a,1-l),new Ye(h,1-u),new Ye(f,1-p),new Ye(g,1-m)]}};function phe(t,e,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++){const s=t[i];n.shapes.push(s.uuid)}else n.shapes.push(t.uuid);return n.options=Object.assign({},e),e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class y1 extends pu{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,n),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new y1(e.radius,e.detail)}}class pv extends pu{constructor(e=1,n=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,n),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new pv(e.radius,e.detail)}}class x1 extends Kt{constructor(e=.5,n=1,i=32,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:o},i=Math.max(3,i),r=Math.max(1,r);const a=[],l=[],c=[],h=[];let u=e;const d=(n-e)/r,f=new ae,p=new Ye;for(let v=0;v<=r;v++){for(let g=0;g<=i;g++){const m=s+g/i*o;f.x=u*Math.cos(m),f.y=u*Math.sin(m),l.push(f.x,f.y,f.z),c.push(0,0,1),p.x=(f.x/n+1)/2,p.y=(f.y/n+1)/2,h.push(p.x,p.y)}u+=d}for(let v=0;v<r;v++){const g=v*(i+1);for(let m=0;m<i;m++){const y=m+g,w=y,b=y+i+1,A=y+i+2,S=y+1;a.push(w,b,S),a.push(b,A,S)}}this.setIndex(a),this.setAttribute("position",new xt(l,3)),this.setAttribute("normal",new xt(c,3)),this.setAttribute("uv",new xt(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new x1(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class w1 extends Kt{constructor(e=new vf([new Ye(0,.5),new Ye(-.5,-.5),new Ye(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:n};const i=[],r=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let h=0;h<e.length;h++)c(e[h]),this.addGroup(a,l,h),a+=l,l=0;this.setIndex(i),this.setAttribute("position",new xt(r,3)),this.setAttribute("normal",new xt(s,3)),this.setAttribute("uv",new xt(o,2));function c(h){const u=r.length/3,d=h.extractPoints(n);let f=d.shape;const p=d.holes;Xl.isClockWise(f)===!1&&(f=f.reverse());for(let g=0,m=p.length;g<m;g++){const y=p[g];Xl.isClockWise(y)===!0&&(p[g]=y.reverse())}const v=Xl.triangulateShape(f,p);for(let g=0,m=p.length;g<m;g++){const y=p[g];f=f.concat(y)}for(let g=0,m=f.length;g<m;g++){const y=f[g];r.push(y.x,y.y,0),s.push(0,0,1),o.push(y.x,y.y)}for(let g=0,m=v.length;g<m;g++){const y=v[g],w=y[0]+u,b=y[1]+u,A=y[2]+u;i.push(w,b,A),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes;return mhe(n,e)}static fromJSON(e,n){const i=[];for(let r=0,s=e.shapes.length;r<s;r++){const o=n[e.shapes[r]];i.push(o)}return new w1(i,e.curveSegments)}}function mhe(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){const r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}class mv extends Kt{constructor(e=1,n=32,i=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let c=0;const h=[],u=new ae,d=new ae,f=[],p=[],v=[],g=[];for(let m=0;m<=i;m++){const y=[],w=m/i;let b=0;m===0&&o===0?b=.5/n:m===i&&l===Math.PI&&(b=-.5/n);for(let A=0;A<=n;A++){const S=A/n;u.x=-e*Math.cos(r+S*s)*Math.sin(o+w*a),u.y=e*Math.cos(o+w*a),u.z=e*Math.sin(r+S*s)*Math.sin(o+w*a),p.push(u.x,u.y,u.z),d.copy(u).normalize(),v.push(d.x,d.y,d.z),g.push(S+b,1-w),y.push(c++)}h.push(y)}for(let m=0;m<i;m++)for(let y=0;y<n;y++){const w=h[m][y+1],b=h[m][y],A=h[m+1][y],S=h[m+1][y+1];(m!==0||o>0)&&f.push(w,b,S),(m!==i-1||l<Math.PI)&&f.push(b,A,S)}this.setIndex(f),this.setAttribute("position",new xt(p,3)),this.setAttribute("normal",new xt(v,3)),this.setAttribute("uv",new xt(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new mv(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class _1 extends pu{constructor(e=1,n=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,n),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new _1(e.radius,e.detail)}}class b1 extends Kt{constructor(e=1,n=.4,i=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],a=[],l=[],c=[],h=new ae,u=new ae,d=new ae;for(let f=0;f<=i;f++)for(let p=0;p<=r;p++){const v=p/r*s,g=f/i*Math.PI*2;u.x=(e+n*Math.cos(g))*Math.cos(v),u.y=(e+n*Math.cos(g))*Math.sin(v),u.z=n*Math.sin(g),a.push(u.x,u.y,u.z),h.x=e*Math.cos(v),h.y=e*Math.sin(v),d.subVectors(u,h).normalize(),l.push(d.x,d.y,d.z),c.push(p/r),c.push(f/i)}for(let f=1;f<=i;f++)for(let p=1;p<=r;p++){const v=(r+1)*f+p-1,g=(r+1)*(f-1)+p-1,m=(r+1)*(f-1)+p,y=(r+1)*f+p;o.push(v,g,y),o.push(g,m,y)}this.setIndex(o),this.setAttribute("position",new xt(a,3)),this.setAttribute("normal",new xt(l,3)),this.setAttribute("uv",new xt(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new b1(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class S1 extends Kt{constructor(e=1,n=.4,i=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:i,radialSegments:r,p:s,q:o},i=Math.floor(i),r=Math.floor(r);const a=[],l=[],c=[],h=[],u=new ae,d=new ae,f=new ae,p=new ae,v=new ae,g=new ae,m=new ae;for(let w=0;w<=i;++w){const b=w/i*s*Math.PI*2;y(b,s,o,e,f),y(b+.01,s,o,e,p),g.subVectors(p,f),m.addVectors(p,f),v.crossVectors(g,m),m.crossVectors(v,g),v.normalize(),m.normalize();for(let A=0;A<=r;++A){const S=A/r*Math.PI*2,T=-n*Math.cos(S),M=n*Math.sin(S);u.x=f.x+(T*m.x+M*v.x),u.y=f.y+(T*m.y+M*v.y),u.z=f.z+(T*m.z+M*v.z),l.push(u.x,u.y,u.z),d.subVectors(u,f).normalize(),c.push(d.x,d.y,d.z),h.push(w/i),h.push(A/r)}}for(let w=1;w<=i;w++)for(let b=1;b<=r;b++){const A=(r+1)*(w-1)+(b-1),S=(r+1)*w+(b-1),T=(r+1)*w+b,M=(r+1)*(w-1)+b;a.push(A,S,M),a.push(S,T,M)}this.setIndex(a),this.setAttribute("position",new xt(l,3)),this.setAttribute("normal",new xt(c,3)),this.setAttribute("uv",new xt(h,2));function y(w,b,A,S,T){const M=Math.cos(w),E=Math.sin(w),P=A/b*w,R=Math.cos(P);T.x=S*(2+R)*.5*M,T.y=S*(2+R)*E*.5,T.z=S*Math.sin(P)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new S1(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class A1 extends Kt{constructor(e=new zB(new ae(-1,-1,0),new ae(-1,1,0),new ae(1,1,0)),n=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:i,radialSegments:r,closed:s};const o=e.computeFrenetFrames(n,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new ae,l=new ae,c=new Ye;let h=new ae;const u=[],d=[],f=[],p=[];v(),this.setIndex(p),this.setAttribute("position",new xt(u,3)),this.setAttribute("normal",new xt(d,3)),this.setAttribute("uv",new xt(f,2));function v(){for(let w=0;w<n;w++)g(w);g(s===!1?n:0),y(),m()}function g(w){h=e.getPointAt(w/n,h);const b=o.normals[w],A=o.binormals[w];for(let S=0;S<=r;S++){const T=S/r*Math.PI*2,M=Math.sin(T),E=-Math.cos(T);l.x=E*b.x+M*A.x,l.y=E*b.y+M*A.y,l.z=E*b.z+M*A.z,l.normalize(),d.push(l.x,l.y,l.z),a.x=h.x+i*l.x,a.y=h.y+i*l.y,a.z=h.z+i*l.z,u.push(a.x,a.y,a.z)}}function m(){for(let w=1;w<=n;w++)for(let b=1;b<=r;b++){const A=(r+1)*(w-1)+(b-1),S=(r+1)*w+(b-1),T=(r+1)*w+b,M=(r+1)*(w-1)+b;p.push(A,S,M),p.push(S,T,M)}}function y(){for(let w=0;w<=n;w++)for(let b=0;b<=r;b++)c.x=w/n,c.y=b/r,f.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new A1(new HB[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class nY extends Kt{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],i=new Set,r=new ae,s=new ae;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,h=l.length;c<h;++c){const u=l[c],d=u.start,f=u.count;for(let p=d,v=d+f;p<v;p+=3)for(let g=0;g<3;g++){const m=a.getX(p+g),y=a.getX(p+(g+1)%3);r.fromBufferAttribute(o,m),s.fromBufferAttribute(o,y),g4(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const h=3*a+c,u=3*a+(c+1)%3;r.fromBufferAttribute(o,h),s.fromBufferAttribute(o,u),g4(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}this.setAttribute("position",new xt(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function g4(t,e,n){const i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return n.has(i)===!0||n.has(r)===!0?!1:(n.add(i),n.add(r),!0)}var v4=Object.freeze({__proto__:null,BoxGeometry:td,CapsuleGeometry:f1,CircleGeometry:p1,ConeGeometry:m1,CylinderGeometry:Xf,DodecahedronGeometry:g1,EdgesGeometry:Z7,ExtrudeGeometry:v1,IcosahedronGeometry:y1,LatheGeometry:fv,OctahedronGeometry:pv,PlaneGeometry:hv,PolyhedronGeometry:pu,RingGeometry:x1,ShapeGeometry:w1,SphereGeometry:mv,TetrahedronGeometry:_1,TorusGeometry:b1,TorusKnotGeometry:S1,TubeGeometry:A1,WireframeGeometry:nY});class iY extends Vi{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new st(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class rY extends ec{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class M1 extends Vi{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new st(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new st(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ed,this.normalScale=new Ye(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class mu extends M1{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ye(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return xi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new st(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new st(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new st(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class sY extends Vi{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new st(16777215),this.specular=new st(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new st(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ed,this.normalScale=new Ye(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=s1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class oY extends Vi{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new st(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new st(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ed,this.normalScale=new Ye(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class aY extends Vi{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ed,this.normalScale=new Ye(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class lY extends Vi{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new st(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new st(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ed,this.normalScale=new Ye(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=s1,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class cY extends Vi{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new st(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ed,this.normalScale=new Ye(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class uY extends $r{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Yo(t,e,n){return VB(t)?new t.constructor(t.subarray(e,n!==void 0?n:t.length)):t.slice(e,n)}function sf(t,e,n){return!t||!n&&t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function VB(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function hY(t){function e(r,s){return t[r]-t[s]}const n=t.length,i=new Array(n);for(let r=0;r!==n;++r)i[r]=r;return i.sort(e),i}function uL(t,e,n){const i=t.length,r=new t.constructor(i);for(let s=0,o=0;o!==i;++s){const a=n[s]*e;for(let l=0;l!==e;++l)r[o++]=t[a+l]}return r}function jB(t,e,n,i){let r=1,s=t[0];for(;s!==void 0&&s[i]===void 0;)s=t[r++];if(s===void 0)return;let o=s[i];if(o!==void 0)if(Array.isArray(o))do o=s[i],o!==void 0&&(e.push(s.time),n.push.apply(n,o)),s=t[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[i],o!==void 0&&(e.push(s.time),o.toArray(n,n.length)),s=t[r++];while(s!==void 0);else do o=s[i],o!==void 0&&(e.push(s.time),n.push(o)),s=t[r++];while(s!==void 0)}function ghe(t,e,n,i,r=30){const s=t.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],h=c.getValueSize(),u=[],d=[];for(let f=0;f<c.times.length;++f){const p=c.times[f]*r;if(!(p<n||p>=i)){u.push(c.times[f]);for(let v=0;v<h;++v)d.push(c.values[f*h+v])}}u.length!==0&&(c.times=sf(u,c.times.constructor),c.values=sf(d,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function vhe(t,e=0,n=t,i=30){i<=0&&(i=30);const r=n.tracks.length,s=e/i;for(let o=0;o<r;++o){const a=n.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const c=t.tracks.find(function(m){return m.name===a.name&&m.ValueTypeName===l});if(c===void 0)continue;let h=0;const u=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=u/3);let d=0;const f=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=f/3);const p=a.times.length-1;let v;if(s<=a.times[0]){const m=h,y=u-h;v=Yo(a.values,m,y)}else if(s>=a.times[p]){const m=p*u+h,y=m+u-h;v=Yo(a.values,m,y)}else{const m=a.createInterpolant(),y=h,w=u-h;m.evaluate(s),v=Yo(m.resultBuffer,y,w)}l==="quaternion"&&new _r().fromArray(v).normalize().conjugate().toArray(v);const g=c.times.length;for(let m=0;m<g;++m){const y=m*f+d;if(l==="quaternion")_r.multiplyQuaternionsFlat(c.values,y,v,0,c.values,y);else{const w=f-d*2;for(let b=0;b<w;++b)c.values[y+b]-=v[b]}}}return t.blendMode=gB,t}const yhe={arraySlice:Yo,convertArray:sf,isTypedArray:VB,getKeyframeOrder:hY,sortedArray:uL,flattenJSON:jB,subclip:ghe,makeClipAdditive:vhe};class gv{constructor(e,n,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let i=this._cachedIndex,r=n[i],s=n[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<s)break i;return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=n[++i],e<r)break t}o=n.length;break n}if(!(e>=s)){const a=n[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=n[--i-1],e>=s)break t}o=i,i=0;break n}break e}for(;i<o;){const a=i+o>>>1;e<n[a]?o=a:i=a+1}if(r=n[i],s=n[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)n[o]=i[s+o];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class dY extends gv{constructor(e,n,i,r){super(e,n,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:tf,endingEnd:tf}}intervalChanged_(e,n,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case nf:s=e,a=2*n-i;break;case vx:s=r.length-2,a=n+r[s]-r[s+1];break;default:s=e,a=i}if(l===void 0)switch(this.getSettings_().endingEnd){case nf:o=e,l=2*i-n;break;case vx:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=n}const c=(i-n)*.5,h=this.valueSize;this._weightPrev=c/(n-a),this._weightNext=c/(l-i),this._offsetPrev=s*h,this._offsetNext=o*h}interpolate_(e,n,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,h=this._offsetPrev,u=this._offsetNext,d=this._weightPrev,f=this._weightNext,p=(i-n)/(r-n),v=p*p,g=v*p,m=-d*g+2*d*v-d*p,y=(1+d)*g+(-1.5-2*d)*v+(-.5+d)*p+1,w=(-1-f)*g+(1.5+f)*v+.5*p,b=f*g-f*v;for(let A=0;A!==a;++A)s[A]=m*o[h+A]+y*o[c+A]+w*o[l+A]+b*o[u+A];return s}}class WB extends gv{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,h=(i-n)/(r-n),u=1-h;for(let d=0;d!==a;++d)s[d]=o[c+d]*u+o[l+d]*h;return s}}class fY extends gv{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class al{constructor(e,n,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=sf(n,this.TimeBufferType),this.values=sf(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let i;if(n.toJSON!==this.toJSON)i=n.toJSON(e);else{i={name:e.name,times:sf(e.times,Array),values:sf(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new fY(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new WB(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new dY(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case Og:n=this.InterpolantFactoryMethodDiscrete;break;case Lf:n=this.InterpolantFactoryMethodLinear;break;case ES:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Og;case this.InterpolantFactoryMethodLinear:return Lf;case this.InterpolantFactoryMethodSmooth:return ES}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]*=e}return this}trim(e,n){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;o!==-1&&i[o]>n;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=Yo(i,s,o),this.values=Yo(this.values,s*a,o*a)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(r!==void 0&&VB(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=Yo(this.times),n=Yo(this.values),i=this.getValueSize(),r=this.getInterpolation()===ES,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a],h=e[a+1];if(c!==h&&(a!==1||c!==e[0]))if(r)l=!0;else{const u=a*i,d=u-i,f=u+i;for(let p=0;p!==i;++p){const v=n[u+p];if(v!==n[d+p]||v!==n[f+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const u=a*i,d=o*i;for(let f=0;f!==i;++f)n[d+f]=n[u+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)n[l+c]=n[a+c];++o}return o!==e.length?(this.times=Yo(e,0,o),this.values=Yo(n,0,o*i)):(this.times=e,this.values=n),this}clone(){const e=Yo(this.times,0),n=Yo(this.values,0),i=this.constructor,r=new i(this.name,e,n);return r.createInterpolant=this.createInterpolant,r}}al.prototype.TimeBufferType=Float32Array;al.prototype.ValueBufferType=Float32Array;al.prototype.DefaultInterpolation=Lf;class Yf extends al{}Yf.prototype.ValueTypeName="bool";Yf.prototype.ValueBufferType=Array;Yf.prototype.DefaultInterpolation=Og;Yf.prototype.InterpolantFactoryMethodLinear=void 0;Yf.prototype.InterpolantFactoryMethodSmooth=void 0;class XB extends al{}XB.prototype.ValueTypeName="color";class kg extends al{}kg.prototype.ValueTypeName="number";class pY extends gv{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-n)/(r-n);let c=e*a;for(let h=c+a;c!==h;c+=4)_r.slerpFlat(s,0,o,c-a,o,c,l);return s}}class Xh extends al{InterpolantFactoryMethodLinear(e){return new pY(this.times,this.values,this.getValueSize(),e)}}Xh.prototype.ValueTypeName="quaternion";Xh.prototype.DefaultInterpolation=Lf;Xh.prototype.InterpolantFactoryMethodSmooth=void 0;class qf extends al{}qf.prototype.ValueTypeName="string";qf.prototype.ValueBufferType=Array;qf.prototype.DefaultInterpolation=Og;qf.prototype.InterpolantFactoryMethodLinear=void 0;qf.prototype.InterpolantFactoryMethodSmooth=void 0;class zg extends al{}zg.prototype.ValueTypeName="vector";class Gg{constructor(e,n=-1,i,r=KM){this.name=e,this.tracks=i,this.duration=n,this.blendMode=r,this.uuid=xo(),this.duration<0&&this.resetDuration()}static parse(e){const n=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)n.push(whe(i[o]).scale(r));const s=new this(e.name,e.duration,n,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const n=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)n.push(al.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,n,i,r){const s=n.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const h=hY(l);l=uL(l,1,h),c=uL(c,1,h),!r&&l[0]===0&&(l.push(s),c.push(c[0])),o.push(new kg(".morphTargetInfluences["+n[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,n){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===n)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,n,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],h=c.name.match(s);if(h&&h.length>1){const u=h[1];let d=r[u];d||(r[u]=d=[]),d.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],n,i));return o}static parseAnimation(e,n){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(u,d,f,p,v){if(f.length!==0){const g=[],m=[];jB(f,g,m,p),g.length!==0&&v.push(new u(d,g,m))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let u=0;u<c.length;u++){const d=c[u].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const f={};let p;for(p=0;p<d.length;p++)if(d[p].morphTargets)for(let v=0;v<d[p].morphTargets.length;v++)f[d[p].morphTargets[v]]=-1;for(const v in f){const g=[],m=[];for(let y=0;y!==d[p].morphTargets.length;++y){const w=d[p];g.push(w.time),m.push(w.morphTarget===v?1:0)}r.push(new kg(".morphTargetInfluence["+v+"]",g,m))}l=f.length*o}else{const f=".bones["+n[u].name+"]";i(zg,f+".position",d,"pos",r),i(Xh,f+".quaternion",d,"rot",r),i(zg,f+".scale",d,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){const e=this.tracks;let n=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];n=Math.max(n,s.times[s.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function xhe(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return kg;case"vector":case"vector2":case"vector3":case"vector4":return zg;case"color":return XB;case"quaternion":return Xh;case"bool":case"boolean":return Yf;case"string":return qf}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function whe(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=xhe(t.type);if(t.times===void 0){const n=[],i=[];jB(t.keys,n,i,"value"),t.times=n,t.values=i}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const Bf={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class YB{constructor(e,n,i){const r=this;let s=!1,o=0,a=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this.itemStart=function(h){a++,s===!1&&r.onStart!==void 0&&r.onStart(h,o,a),s=!0},this.itemEnd=function(h){o++,r.onProgress!==void 0&&r.onProgress(h,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(h){r.onError!==void 0&&r.onError(h)},this.resolveURL=function(h){return l?l(h):h},this.setURLModifier=function(h){return l=h,this},this.addHandler=function(h,u){return c.push(h,u),this},this.removeHandler=function(h){const u=c.indexOf(h);return u!==-1&&c.splice(u,2),this},this.getHandler=function(h){for(let u=0,d=c.length;u<d;u+=2){const f=c[u],p=c[u+1];if(f.global&&(f.lastIndex=0),f.test(h))return p}return null}}}const zm=new YB;class ws{constructor(e){this.manager=e!==void 0?e:zm,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const i=this;return new Promise(function(r,s){i.load(e,r,n,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const bc={};class _he extends Error{constructor(e,n){super(e),this.response=n}}class bo extends ws{constructor(e){super(e)}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Bf.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(s),this.manager.itemEnd(e)},0),s;if(bc[e]!==void 0){bc[e].push({onLoad:n,onProgress:i,onError:r});return}bc[e]=[],bc[e].push({onLoad:n,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const h=bc[e],u=c.body.getReader(),d=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),f=d?parseInt(d):0,p=f!==0;let v=0;const g=new ReadableStream({start(m){y();function y(){u.read().then(({done:w,value:b})=>{if(w)m.close();else{v+=b.byteLength;const A=new ProgressEvent("progress",{lengthComputable:p,loaded:v,total:f});for(let S=0,T=h.length;S<T;S++){const M=h[S];M.onProgress&&M.onProgress(A)}m.enqueue(b),y()}})}}});return new Response(g)}else throw new _he(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(h=>new DOMParser().parseFromString(h,a));case"json":return c.json();default:if(a===void 0)return c.text();{const u=/charset="?([^;"\s]*)"?/i.exec(a),d=u&&u[1]?u[1].toLowerCase():void 0,f=new TextDecoder(d);return c.arrayBuffer().then(p=>f.decode(p))}}}).then(c=>{Bf.add(e,c);const h=bc[e];delete bc[e];for(let u=0,d=h.length;u<d;u++){const f=h[u];f.onLoad&&f.onLoad(c)}}).catch(c=>{const h=bc[e];if(h===void 0)throw this.manager.itemError(e),c;delete bc[e];for(let u=0,d=h.length;u<d;u++){const f=h[u];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class bhe extends ws{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new bo(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const n=[];for(let i=0;i<e.length;i++){const r=Gg.parse(e[i]);n.push(r)}return n}}class She extends ws{constructor(e){super(e)}load(e,n,i,r){const s=this,o=[],a=new FB,l=new bo(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function h(u){l.load(e[u],function(d){const f=s.parse(d,!0);o[u]={width:f.width,height:f.height,format:f.format,mipmaps:f.mipmaps},c+=1,c===6&&(f.mipmapCount===1&&(a.minFilter=ai),a.image=o,a.format=f.format,a.needsUpdate=!0,n&&n(a))},i,r)}if(Array.isArray(e))for(let u=0,d=e.length;u<d;++u)h(u);else l.load(e,function(u){const d=s.parse(u,!0);if(d.isCubemap){const f=d.mipmaps.length/d.mipmapCount;for(let p=0;p<f;p++){o[p]={mipmaps:[]};for(let v=0;v<d.mipmapCount;v++)o[p].mipmaps.push(d.mipmaps[p*d.mipmapCount+v]),o[p].format=d.format,o[p].width=d.width,o[p].height=d.height}a.image=o}else a.image.width=d.width,a.image.height=d.height,a.mipmaps=d.mipmaps;d.mipmapCount===1&&(a.minFilter=ai),a.format=d.format,a.needsUpdate=!0,n&&n(a)},i,r);return a}}class Ax extends ws{constructor(e){super(e)}load(e,n,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Bf.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){n&&n(o),s.manager.itemEnd(e)},0),o;const a=xx("img");function l(){h(),Bf.add(e,this),n&&n(this),s.manager.itemEnd(e)}function c(u){h(),r&&r(u),s.manager.itemError(e),s.manager.itemEnd(e)}function h(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class Ahe extends ws{constructor(e){super(e)}load(e,n,i,r){const s=new c1,o=new Ax(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(h){s.images[c]=h,a++,a===6&&(s.needsUpdate=!0,n&&n(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class Mhe extends ws{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new cg,a=new bo(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){const c=s.parse(l);c&&(c.image!==void 0?o.image=c.image:c.data!==void 0&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=c.wrapS!==void 0?c.wrapS:Pr,o.wrapT=c.wrapT!==void 0?c.wrapT:Pr,o.magFilter=c.magFilter!==void 0?c.magFilter:ai,o.minFilter=c.minFilter!==void 0?c.minFilter:ai,o.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0?o.colorSpace=c.colorSpace:c.encoding!==void 0&&(o.encoding=c.encoding),c.flipY!==void 0&&(o.flipY=c.flipY),c.format!==void 0&&(o.format=c.format),c.type!==void 0&&(o.type=c.type),c.mipmaps!==void 0&&(o.mipmaps=c.mipmaps,o.minFilter=$l),c.mipmapCount===1&&(o.minFilter=ai),c.generateMipmaps!==void 0&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,n&&n(o,c))},i,r),o}}class mY extends ws{constructor(e){super(e)}load(e,n,i,r){const s=new ii,o=new Ax(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,n!==void 0&&n(s)},i,r),s}}class nd extends mn{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new st(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),n}}class gY extends nd{constructor(e,n,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(mn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new st(n)}copy(e,n){return super.copy(e,n),this.groundColor.copy(e.groundColor),this}}const aP=new kt,y4=new ae,x4=new ae;class qB{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ye(512,512),this.map=null,this.mapPass=null,this.matrix=new kt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ZM,this._frameExtents=new Ye(1,1),this._viewportCount=1,this._viewports=[new Dn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,i=this.matrix;y4.setFromMatrixPosition(e.matrixWorld),n.position.copy(y4),x4.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(x4),n.updateMatrixWorld(),aP.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(aP),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(aP)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Ehe extends qB{constructor(){super(new Gn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,i=Fg*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||n.far;(i!==n.fov||r!==n.aspect||s!==n.far)&&(n.fov=i,n.aspect=r,n.far=s,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class QB extends nd{constructor(e,n,i=0,r=Math.PI/3,s=0,o=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(mn.DEFAULT_UP),this.updateMatrix(),this.target=new mn,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new Ehe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const w4=new kt,f0=new ae,lP=new ae;class Che extends qB{constructor(){super(new Gn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ye(4,2),this._viewportCount=6,this._viewports=[new Dn(2,1,1,1),new Dn(0,1,1,1),new Dn(3,1,1,1),new Dn(1,1,1,1),new Dn(3,0,1,1),new Dn(1,0,1,1)],this._cubeDirections=[new ae(1,0,0),new ae(-1,0,0),new ae(0,0,1),new ae(0,0,-1),new ae(0,1,0),new ae(0,-1,0)],this._cubeUps=[new ae(0,1,0),new ae(0,1,0),new ae(0,1,0),new ae(0,1,0),new ae(0,0,1),new ae(0,0,-1)]}updateMatrices(e,n=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),f0.setFromMatrixPosition(e.matrixWorld),i.position.copy(f0),lP.copy(i.position),lP.add(this._cubeDirections[n]),i.up.copy(this._cubeUps[n]),i.lookAt(lP),i.updateMatrixWorld(),r.makeTranslation(-f0.x,-f0.y,-f0.z),w4.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(w4)}}class KB extends nd{constructor(e,n,i=0,r=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new Che}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class The extends qB{constructor(){super(new qa(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class JB extends nd{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(mn.DEFAULT_UP),this.updateMatrix(),this.target=new mn,this.shadow=new The}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class vY extends nd{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class yY extends nd{constructor(e,n,i=10,r=10){super(e,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}}class xY{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ae)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return n.copy(o[0]).multiplyScalar(.282095),n.addScaledVector(o[1],.488603*r),n.addScaledVector(o[2],.488603*s),n.addScaledVector(o[3],.488603*i),n.addScaledVector(o[4],1.092548*(i*r)),n.addScaledVector(o[5],1.092548*(r*s)),n.addScaledVector(o[6],.315392*(3*s*s-1)),n.addScaledVector(o[7],1.092548*(i*s)),n.addScaledVector(o[8],.546274*(i*i-r*r)),n}getIrradianceAt(e,n){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return n.copy(o[0]).multiplyScalar(.886227),n.addScaledVector(o[1],2*.511664*r),n.addScaledVector(o[2],2*.511664*s),n.addScaledVector(o[3],2*.511664*i),n.addScaledVector(o[4],2*.429043*i*r),n.addScaledVector(o[5],2*.429043*r*s),n.addScaledVector(o[6],.743125*s*s-.247708),n.addScaledVector(o[7],2*.429043*i*s),n.addScaledVector(o[8],.429043*(i*i-r*r)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,n+r*3);return this}toArray(e=[],n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,n+r*3);return e}static getBasisAt(e,n){const i=e.x,r=e.y,s=e.z;n[0]=.282095,n[1]=.488603*r,n[2]=.488603*s,n[3]=.488603*i,n[4]=1.092548*i*r,n[5]=1.092548*r*s,n[6]=.315392*(3*s*s-1),n[7]=1.092548*i*s,n[8]=.546274*(i*i-r*r)}}class oE extends nd{constructor(e=new xY,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}}class aE extends ws{constructor(e){super(e),this.textures={}}load(e,n,i,r){const s=this,o=new bo(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const n=this.textures;function i(s){return n[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),n[s]}const r=aE.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new st().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==1&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=i(o.value);break;case"c":r.uniforms[s].value=new st().setHex(o.value);break;case"v2":r.uniforms[s].value=new Ye().fromArray(o.value);break;case"v3":r.uniforms[s].value=new ae().fromArray(o.value);break;case"v4":r.uniforms[s].value=new Dn().fromArray(o.value);break;case"m3":r.uniforms[s].value=new ln().fromArray(o.value);break;case"m4":r.uniforms[s].value=new kt().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=i(e.map)),e.matcap!==void 0&&(r.matcap=i(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new Ye().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=i(e.envMap)),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new Ye().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=i(e.thicknessMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const n={ShadowMaterial:iY,SpriteMaterial:RB,RawShaderMaterial:rY,ShaderMaterial:ec,PointsMaterial:d1,MeshPhysicalMaterial:mu,MeshStandardMaterial:M1,MeshPhongMaterial:sY,MeshToonMaterial:oY,MeshNormalMaterial:aY,MeshLambertMaterial:lY,MeshDepthMaterial:TB,MeshDistanceMaterial:PB,MeshBasicMaterial:lo,MeshMatcapMaterial:cY,LineDashedMaterial:uY,LineBasicMaterial:$r,Material:Vi};return new n[e]}}class Hg{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let n="";for(let i=0,r=e.length;i<r;i++)n+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(n))}catch{return n}}static extractUrlBase(e){const n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}class wY extends Kt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class _Y extends ws{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new bo(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const n={},i={};function r(f,p){if(n[p]!==void 0)return n[p];const g=f.interleavedBuffers[p],m=s(f,g.buffer),y=Nm(g.type,m),w=new u1(y,g.stride);return w.uuid=g.uuid,n[p]=w,w}function s(f,p){if(i[p]!==void 0)return i[p];const g=f.arrayBuffers[p],m=new Uint32Array(g).buffer;return i[p]=m,m}const o=e.isInstancedBufferGeometry?new wY:new Kt,a=e.data.index;if(a!==void 0){const f=Nm(a.type,a.array);o.setIndex(new Sn(f,1))}const l=e.data.attributes;for(const f in l){const p=l[f];let v;if(p.isInterleavedBufferAttribute){const g=r(e.data,p.data);v=new Wh(g,p.itemSize,p.offset,p.normalized)}else{const g=Nm(p.type,p.array),m=p.isInstancedBufferAttribute?Ug:Sn;v=new m(g,p.itemSize,p.normalized)}p.name!==void 0&&(v.name=p.name),p.usage!==void 0&&v.setUsage(p.usage),p.updateRange!==void 0&&(v.updateRange.offset=p.updateRange.offset,v.updateRange.count=p.updateRange.count),o.setAttribute(f,v)}const c=e.data.morphAttributes;if(c)for(const f in c){const p=c[f],v=[];for(let g=0,m=p.length;g<m;g++){const y=p[g];let w;if(y.isInterleavedBufferAttribute){const b=r(e.data,y.data);w=new Wh(b,y.itemSize,y.offset,y.normalized)}else{const b=Nm(y.type,y.array);w=new Sn(b,y.itemSize,y.normalized)}y.name!==void 0&&(w.name=y.name),v.push(w)}o.morphAttributes[f]=v}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const u=e.data.groups||e.data.drawcalls||e.data.offsets;if(u!==void 0)for(let f=0,p=u.length;f!==p;++f){const v=u[f];o.addGroup(v.start,v.count,v.materialIndex)}const d=e.data.boundingSphere;if(d!==void 0){const f=new ae;d.center!==void 0&&f.fromArray(d.center),o.boundingSphere=new rl(f,d.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class Phe extends ws{constructor(e){super(e)}load(e,n,i,r){const s=this,o=this.path===""?Hg.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new bo(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(u){r!==void 0&&r(u),console.error("THREE:ObjectLoader: Can't parse "+e+".",u.message);return}const h=c.metadata;if(h===void 0||h.type===void 0||h.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(c,n)},i,r)}async loadAsync(e,n){const i=this,r=this.path===""?Hg.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new bo(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,n),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(a)}parse(e,n){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){n!==void 0&&n(c)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,s,l,a,i),h=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,h),n!==void 0){let u=!1;for(const d in o)if(o[d].data instanceof HTMLImageElement){u=!0;break}u===!1&&n(c)}return c}async parseAsync(e){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,r,a,o,n),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),l}parseShapes(e){const n={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){const s=new vf().fromJSON(e[i]);n[s.uuid]=s}return n}parseSkeletons(e,n){const i={},r={};if(n.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new h1().fromJSON(e[s],r);i[a.uuid]=a}return i}parseGeometries(e,n){const i={};if(e!==void 0){const r=new _Y;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(l);break;default:l.type in v4?a=v4[l.type].fromJSON(l,n):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),i[l.uuid]=a}}return i}parseMaterials(e,n){const i={},r={};if(e!==void 0){const s=new aE;s.setTextures(n);for(let o=0,a=e.length;o<a;o++){const l=e[o];i[l.uuid]===void 0&&(i[l.uuid]=s.parse(l)),r[l.uuid]=i[l.uuid]}}return r}parseAnimations(e){const n={};if(e!==void 0)for(let i=0;i<e.length;i++){const r=e[i],s=Gg.parse(r);n[s.uuid]=s}return n}parseImages(e,n){const i=this,r={};let s;function o(l){return i.manager.itemStart(l),s.load(l,function(){i.manager.itemEnd(l)},void 0,function(){i.manager.itemError(l),i.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const c=l,h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:i.resourcePath+c;return o(h)}else return l.data?{data:Nm(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new YB(n);s=new Ax(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,h=e.length;c<h;c++){const u=e[c],d=u.url;if(Array.isArray(d)){const f=[];for(let p=0,v=d.length;p<v;p++){const g=d[p],m=a(g);m!==null&&(m instanceof HTMLImageElement?f.push(m):f.push(new cg(m.data,m.width,m.height)))}r[u.uuid]=new rf(f)}else{const f=a(u.url);r[u.uuid]=new rf(f)}}}return r}async parseImagesAsync(e){const n=this,i={};let r;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:n.resourcePath+a;return await r.loadAsync(l)}else return o.data?{data:Nm(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){r=new Ax(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.url;if(Array.isArray(c)){const h=[];for(let u=0,d=c.length;u<d;u++){const f=c[u],p=await s(f);p!==null&&(p instanceof HTMLImageElement?h.push(p):h.push(new cg(p.data,p.width,p.height)))}i[l.uuid]=new rf(h)}else{const h=await s(l.url);i[l.uuid]=new rf(h)}}}return i}parseTextures(e,n){function i(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),n[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=n[a.image],c=l.data;let h;Array.isArray(c)?(h=new c1,c.length===6&&(h.needsUpdate=!0)):(c&&c.data?h=new cg:h=new ii,c&&(h.needsUpdate=!0)),h.source=l,h.uuid=a.uuid,a.name!==void 0&&(h.name=a.name),a.mapping!==void 0&&(h.mapping=i(a.mapping,Dhe)),a.channel!==void 0&&(h.channel=a.channel),a.offset!==void 0&&h.offset.fromArray(a.offset),a.repeat!==void 0&&h.repeat.fromArray(a.repeat),a.center!==void 0&&h.center.fromArray(a.center),a.rotation!==void 0&&(h.rotation=a.rotation),a.wrap!==void 0&&(h.wrapS=i(a.wrap[0],_4),h.wrapT=i(a.wrap[1],_4)),a.format!==void 0&&(h.format=a.format),a.internalFormat!==void 0&&(h.internalFormat=a.internalFormat),a.type!==void 0&&(h.type=a.type),a.colorSpace!==void 0&&(h.colorSpace=a.colorSpace),a.encoding!==void 0&&(h.encoding=a.encoding),a.minFilter!==void 0&&(h.minFilter=i(a.minFilter,b4)),a.magFilter!==void 0&&(h.magFilter=i(a.magFilter,b4)),a.anisotropy!==void 0&&(h.anisotropy=a.anisotropy),a.flipY!==void 0&&(h.flipY=a.flipY),a.generateMipmaps!==void 0&&(h.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(h.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(h.unpackAlignment=a.unpackAlignment),a.userData!==void 0&&(h.userData=a.userData),r[a.uuid]=h}return r}parseObject(e,n,i,r,s){let o;function a(d){return n[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",d),n[d]}function l(d){if(d!==void 0){if(Array.isArray(d)){const f=[];for(let p=0,v=d.length;p<v;p++){const g=d[p];i[g]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",g),f.push(i[g])}return f}return i[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",d),i[d]}}function c(d){return r[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",d),r[d]}let h,u;switch(e.type){case"Scene":o=new _A,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new st(e.background):o.background=c(e.background)),e.environment!==void 0&&(o.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new tE(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new eE(e.fog.color,e.fog.density))),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":o=new Gn(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new qa(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new vY(e.color,e.intensity);break;case"DirectionalLight":o=new JB(e.color,e.intensity);break;case"PointLight":o=new KB(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new yY(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new QB(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new gY(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new oE().fromJSON(e);break;case"SkinnedMesh":h=a(e.geometry),u=l(e.material),o=new LB(h,u),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":h=a(e.geometry),u=l(e.material),o=new yr(h,u);break;case"InstancedMesh":h=a(e.geometry),u=l(e.material);const d=e.count,f=e.instanceMatrix,p=e.instanceColor;o=new IB(h,u,d),o.instanceMatrix=new Ug(new Float32Array(f.array),16),p!==void 0&&(o.instanceColor=new Ug(new Float32Array(p.array),p.itemSize));break;case"LOD":o=new X7;break;case"Line":o=new ou(a(e.geometry),l(e.material));break;case"LineLoop":o=new BB(a(e.geometry),l(e.material));break;case"LineSegments":o=new sl(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new OB(a(e.geometry),l(e.material));break;case"Sprite":o=new W7(l(e.material));break;case"Group":o=new Vc;break;case"Bone":o=new nE;break;default:o=new mn}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const d=e.children;for(let f=0;f<d.length;f++)o.add(this.parseObject(d[f],n,i,r,s))}if(e.animations!==void 0){const d=e.animations;for(let f=0;f<d.length;f++){const p=d[f];o.animations.push(s[p])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const d=e.levels;for(let f=0;f<d.length;f++){const p=d[f],v=o.getObjectByProperty("uuid",p.object);v!==void 0&&o.addLevel(v,p.distance,p.hysteresis)}}return o}bindSkeletons(e,n){Object.keys(n).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const r=n[i.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}}const Dhe={UVMapping:qM,CubeReflectionMapping:Hh,CubeRefractionMapping:Vh,EquirectangularReflectionMapping:px,EquirectangularRefractionMapping:mx,CubeUVReflectionMapping:uv},_4={RepeatWrapping:jh,ClampToEdgeWrapping:Pr,MirroredRepeatWrapping:Ig},b4={NearestFilter:yi,NearestMipmapNearestFilter:gx,NearestMipmapLinearFilter:ag,LinearFilter:ai,LinearMipmapNearestFilter:QM,LinearMipmapLinearFilter:$l};class bY extends ws{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Bf.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){n&&n(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){Bf.add(e,l),n&&n(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}let U_,ZB=class{static getContext(){return U_===void 0&&(U_=new(window.AudioContext||window.webkitAudioContext)),U_}static setContext(e){U_=e}};class Rhe extends ws{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new bo(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const c=l.slice(0);ZB.getContext().decodeAudioData(c,function(u){n(u)},a)}catch(c){a(c)}},i,r);function a(l){r?r(l):console.error(l),s.manager.itemError(e)}}}class Lhe extends oE{constructor(e,n,i=1){super(void 0,i),this.isHemisphereLightProbe=!0;const r=new st().set(e),s=new st().set(n),o=new ae(r.r,r.g,r.b),a=new ae(s.r,s.g,s.b),l=Math.sqrt(Math.PI),c=l*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(l),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(c)}}class Ihe extends oE{constructor(e,n=1){super(void 0,n),this.isAmbientLightProbe=!0;const i=new st().set(e);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const S4=new kt,A4=new kt,wd=new kt;class Bhe{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Gn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Gn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const n=this._cache;if(n.focus!==e.focus||n.fov!==e.fov||n.aspect!==e.aspect*this.aspect||n.near!==e.near||n.far!==e.far||n.zoom!==e.zoom||n.eyeSep!==this.eyeSep){n.focus=e.focus,n.fov=e.fov,n.aspect=e.aspect*this.aspect,n.near=e.near,n.far=e.far,n.zoom=e.zoom,n.eyeSep=this.eyeSep,wd.copy(e.projectionMatrix);const r=n.eyeSep/2,s=r*n.near/n.focus,o=n.near*Math.tan(mf*n.fov*.5)/n.zoom;let a,l;A4.elements[12]=-r,S4.elements[12]=r,a=-o*n.aspect+s,l=o*n.aspect+s,wd.elements[0]=2*n.near/(l-a),wd.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(wd),a=-o*n.aspect-s,l=o*n.aspect-s,wd.elements[0]=2*n.near/(l-a),wd.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(wd)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(A4),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(S4)}}class $B{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=M4(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=M4();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}function M4(){return(typeof performance>"u"?Date:performance).now()}const _d=new ae,E4=new _r,Ohe=new ae,bd=new ae;class Fhe extends mn{constructor(){super(),this.type="AudioListener",this.context=ZB.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new $B}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const n=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(_d,E4,Ohe),bd.set(0,0,-1).applyQuaternion(E4),n.positionX){const r=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(_d.x,r),n.positionY.linearRampToValueAtTime(_d.y,r),n.positionZ.linearRampToValueAtTime(_d.z,r),n.forwardX.linearRampToValueAtTime(bd.x,r),n.forwardY.linearRampToValueAtTime(bd.y,r),n.forwardZ.linearRampToValueAtTime(bd.z,r),n.upX.linearRampToValueAtTime(i.x,r),n.upY.linearRampToValueAtTime(i.y,r),n.upZ.linearRampToValueAtTime(i.z,r)}else n.setPosition(_d.x,_d.y,_d.z),n.setOrientation(bd.x,bd.y,bd.z,i.x,i.y,i.z)}}let SY=class extends mn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}};const Sd=new ae,C4=new _r,Nhe=new ae,Ad=new ae;class Uhe extends SY{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,n,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Sd,C4,Nhe),Ad.set(0,0,1).applyQuaternion(C4);const n=this.panner;if(n.positionX){const i=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(Sd.x,i),n.positionY.linearRampToValueAtTime(Sd.y,i),n.positionZ.linearRampToValueAtTime(Sd.z,i),n.orientationX.linearRampToValueAtTime(Ad.x,i),n.orientationY.linearRampToValueAtTime(Ad.y,i),n.orientationZ.linearRampToValueAtTime(Ad.z,i)}else n.setPosition(Sd.x,Sd.y,Sd.z),n.setOrientation(Ad.x,Ad.y,Ad.z)}}class khe{constructor(e,n=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const n=this.getFrequencyData();for(let i=0;i<n.length;i++)e+=n[i];return e/n.length}}class AY{constructor(e,n,i){this.binding=e,this.valueSize=i;let r,s,o;switch(n){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,n){const i=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)i[s+a]=i[a];o=n}else{o+=n;const a=n/o;this._mixBufferRegion(i,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(e){const n=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const n=this.valueSize,i=this.buffer,r=e*n+n,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=n*this._origIndex;this._mixBufferRegion(i,r,l,1-s,n)}o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*n,1,n);for(let l=n,c=n+n;l!==c;++l)if(i[l]!==i[l+n]){a.setValue(i,r);break}}saveOriginalState(){const e=this.binding,n=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(n,r);for(let s=i,o=r;s!==o;++s)n[s]=n[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,n=e+this.valueSize;for(let i=e;i<n;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[n+i]=this.buffer[e+i]}_select(e,n,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[n+o]=e[i+o]}_slerp(e,n,i,r){_r.slerpFlat(e,n,e,n,e,i,r)}_slerpAdditive(e,n,i,r,s){const o=this._workIndex*s;_r.multiplyQuaternionsFlat(e,o,e,n,e,i),_r.slerpFlat(e,n,e,n,e,o,r)}_lerp(e,n,i,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=n+a;e[l]=e[l]*o+e[i+a]*r}}_lerpAdditive(e,n,i,r,s){for(let o=0;o!==s;++o){const a=n+o;e[a]=e[a]+e[i+o]*r}}}const eO="\\[\\]\\.:\\/",zhe=new RegExp("["+eO+"]","g"),tO="[^"+eO+"]",Ghe="[^"+eO.replace("\\.","")+"]",Hhe=/((?:WC+[\/:])*)/.source.replace("WC",tO),Vhe=/(WCOD+)?/.source.replace("WCOD",Ghe),jhe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",tO),Whe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",tO),Xhe=new RegExp("^"+Hhe+Vhe+jhe+Whe+"$"),Yhe=["material","materials","bones","map"];class qhe{constructor(e,n,i){const r=i||fn.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,r)}getValue(e,n){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,n)}setValue(e,n){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].unbind()}}class fn{constructor(e,n,i){this.path=n,this.parsedPath=i||fn.parseTrackName(n),this.node=fn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,i){return e&&e.isAnimationObjectGroup?new fn.Composite(e,n,i):new fn(e,n,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(zhe,"")}static parseTrackName(e){const n=Xhe.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);Yhe.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(n);if(i!==void 0)return i}if(e.children){const i=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===n||a.uuid===n)return a;const l=i(a.children);if(l)return l}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[n++]=i[r]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,i=n.objectName,r=n.propertyName;let s=n.propertyIndex;if(e||(e=fn.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(i){let c=n.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let h=0;h<e.length;h++)if(e[h].name===c){c=h;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const o=e[r];if(o===void 0){const c=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}fn.Composite=qhe;fn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};fn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};fn.prototype.GetterByBindingType=[fn.prototype._getValue_direct,fn.prototype._getValue_array,fn.prototype._getValue_arrayElement,fn.prototype._getValue_toArray];fn.prototype.SetterByBindingTypeAndVersioning=[[fn.prototype._setValue_direct,fn.prototype._setValue_direct_setNeedsUpdate,fn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[fn.prototype._setValue_array,fn.prototype._setValue_array_setNeedsUpdate,fn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[fn.prototype._setValue_arrayElement,fn.prototype._setValue_arrayElement_setNeedsUpdate,fn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[fn.prototype._setValue_fromArray,fn.prototype._setValue_fromArray_setNeedsUpdate,fn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Qhe{constructor(){this.isAnimationObjectGroup=!0,this.uuid=xo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}add(){const e=this._objects,n=this._indicesByUUID,i=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,c=this.nCachedObjects_;for(let h=0,u=arguments.length;h!==u;++h){const d=arguments[h],f=d.uuid;let p=n[f];if(p===void 0){p=l++,n[f]=p,e.push(d);for(let v=0,g=o;v!==g;++v)s[v].push(new fn(d,i[v],r[v]))}else if(p<c){a=e[p];const v=--c,g=e[v];n[g.uuid]=p,e[p]=g,n[f]=v,e[v]=d;for(let m=0,y=o;m!==y;++m){const w=s[m],b=w[v];let A=w[p];w[p]=b,A===void 0&&(A=new fn(d,i[m],r[m])),w[v]=A}}else e[p]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,h=n[c];if(h!==void 0&&h>=s){const u=s++,d=e[u];n[d.uuid]=h,e[h]=d,n[c]=u,e[u]=l;for(let f=0,p=r;f!==p;++f){const v=i[f],g=v[u],m=v[h];v[h]=g,v[u]=m}}}this.nCachedObjects_=s}uncache(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const c=arguments[a],h=c.uuid,u=n[h];if(u!==void 0)if(delete n[h],u<s){const d=--s,f=e[d],p=--o,v=e[p];n[f.uuid]=u,e[u]=f,n[v.uuid]=d,e[d]=v,e.pop();for(let g=0,m=r;g!==m;++g){const y=i[g],w=y[d],b=y[p];y[u]=w,y[d]=b,y.pop()}}else{const d=--o,f=e[d];d>0&&(n[f.uuid]=u),e[u]=f,e.pop();for(let p=0,v=r;p!==v;++p){const g=i[p];g[u]=g[d],g.pop()}}}this.nCachedObjects_=s}subscribe_(e,n){const i=this._bindingsIndicesByPath;let r=i[e];const s=this._bindings;if(r!==void 0)return s[r];const o=this._paths,a=this._parsedPaths,l=this._objects,c=l.length,h=this.nCachedObjects_,u=new Array(c);r=s.length,i[e]=r,o.push(e),a.push(n),s.push(u);for(let d=h,f=l.length;d!==f;++d){const p=l[d];u[d]=new fn(p,e,n)}return u}unsubscribe_(e){const n=this._bindingsIndicesByPath,i=n[e];if(i!==void 0){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],c=e[a];n[c]=i,o[i]=l,o.pop(),s[i]=s[a],s.pop(),r[i]=r[a],r.pop()}}}class MY{constructor(e,n,i=null,r=n.blendMode){this._mixer=e,this._clip=n,this._localRoot=i,this.blendMode=r;const s=n.tracks,o=s.length,a=new Array(o),l={endingStart:tf,endingEnd:tf};for(let c=0;c!==o;++c){const h=s[c].createInterpolant(null);a[c]=h,h.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=_7,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,i){if(e.fadeOut(n),this.fadeIn(n),i){const r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,n),this.warp(a,1,n)}return this}crossFadeTo(e,n,i){return e.crossFadeFrom(this,n,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+i,c[0]=e/o,c[1]=n/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,i,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*i;l<0||i===0?n=0:(this._startTime=null,n=i*l)}n*=this._updateTimeScale(e);const o=this._updateTime(n),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case gB:for(let h=0,u=l.length;h!==u;++h)l[h].evaluate(o),c[h].accumulateAdditive(a);break;case KM:default:for(let h=0,u=l.length;h!==u;++h)l[h].evaluate(o),c[h].accumulate(r,a)}}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n}_updateTime(e){const n=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=i===b7;if(e===0)return s===-1?r:o&&(s&1)===1?n-r:r;if(i===w7){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=n)r=n;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=n||r<0){const a=Math.floor(r/n);r-=n*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?n:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return n-r}return r}_setEndings(e,n,i){const r=this._interpolantSettings;i?(r.endingStart=nf,r.endingEnd=nf):(e?r.endingStart=this.zeroSlopeAtStart?nf:tf:r.endingStart=vx,n?r.endingEnd=this.zeroSlopeAtEnd?nf:tf:r.endingEnd=vx)}_scheduleFading(e,n,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=n,a[1]=s+e,l[1]=i,this}}const Khe=new Float32Array(1);class Jhe extends sc{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,n){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=i.uuid,c=this._bindingsByRootAndName;let h=c[l];h===void 0&&(h={},c[l]=h);for(let u=0;u!==s;++u){const d=r[u],f=d.name;let p=h[f];if(p!==void 0)++p.referenceCount,o[u]=p;else{if(p=o[u],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,l,f));continue}const v=n&&n._propertyBindings[u].binding.parsedPath;p=new AY(fn.create(i,f,v),d.ValueTypeName,d.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,f),o[u]=p}a[u].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const n=e._cacheIndex;return n!==null&&n<this._nActiveActions}_addInactiveAction(e,n,i){const r=this._actions,s=this._actionsByClip;let o=s[n];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[n]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const n=this._actions,i=n[n.length-1],r=e._cacheIndex;i._cacheIndex=r,n[r]=i,n.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],h=e._byClipCacheIndex;c._byClipCacheIndex=h,l[h]=c,l.pop(),e._byClipCacheIndex=null;const u=a.actionByRoot,d=(e._localRoot||this._root).uuid;delete u[d],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const n=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackAction(e){const n=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_addInactiveBinding(e,n,i){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[n];o===void 0&&(o={},r[n]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const n=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],l=n[n.length-1],c=e._cacheIndex;l._cacheIndex=c,n[c]=l,n.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(e){const n=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackBinding(e){const n=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,n=this._nActiveControlInterpolants++;let i=e[n];return i===void 0&&(i=new WB(new Float32Array(2),new Float32Array(2),1,Khe),i.__cacheIndex=n,e[n]=i),i}_takeBackControlInterpolant(e){const n=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=n[r];e.__cacheIndex=r,n[r]=e,s.__cacheIndex=i,n[i]=s}clipAction(e,n,i){const r=n||this._root,s=r.uuid;let o=typeof e=="string"?Gg.findByName(r,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let c=null;if(i===void 0&&(o!==null?i=o.blendMode:i=KM),l!==void 0){const u=l.actionByRoot[s];if(u!==void 0&&u.blendMode===i)return u;c=l.knownActions[0],o===null&&(o=c._clip)}if(o===null)return null;const h=new MY(this,o,n,i);return this._bindAction(h,c),this._addInactiveAction(h,a,s),h}existingAction(e,n){const i=n||this._root,r=i.uuid,s=typeof e=="string"?Gg.findByName(i,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions,n=this._nActiveActions;for(let i=n-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const n=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==i;++c)n[c]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const n=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const h=c._cacheIndex,u=n[n.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,u._cacheIndex=h,n[h]=u,n.pop(),this._removeInactiveBindingsForAction(c)}delete r[i]}}uncacheRoot(e){const n=e.uuid,i=this._actionsByClip;for(const o in i){const a=i[o].actionByRoot,l=a[n];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const r=this._bindingsByRootAndName,s=r[n];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,n){const i=this.existingAction(e,n);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class nO{constructor(e){this.value=e}clone(){return new nO(this.value.clone===void 0?this.value:this.value.clone())}}let Zhe=0;class $he extends sc{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Zhe++}),this.name="",this.usage=yx,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const n=e.uniforms;this.uniforms.length=0;for(let i=0,r=n.length;i<r;i++)this.uniforms.push(n[i].clone());return this}clone(){return new this.constructor().copy(this)}}class ede extends u1{constructor(e,n,i=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}class tde{constructor(e,n,i,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=n,this.itemSize=i,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,n){return this.type=e,this.elementSize=n,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class EY{constructor(e,n,i=0,r=1/0){this.ray=new o1(e,n),this.near=i,this.far=r,this.camera=null,this.layers=new gf,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}intersectObject(e,n=!0,i=[]){return hL(e,this,i,n),i.sort(T4),i}intersectObjects(e,n=!0,i=[]){for(let r=0,s=e.length;r<s;r++)hL(e[r],this,i,n);return i.sort(T4),i}}function T4(t,e){return t.distance-e.distance}function hL(t,e,n,i){if(t.layers.test(e.layers)&&t.raycast(e,n),i===!0){const r=t.children;for(let s=0,o=r.length;s<o;s++)hL(r[s],e,n,!0)}}class dL{constructor(e=1,n=0,i=0){return this.radius=e,this.phi=n,this.theta=i,this}set(e,n,i){return this.radius=e,this.phi=n,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+n*n+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(xi(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class nde{constructor(e=1,n=0,i=0){return this.radius=e,this.theta=n,this.y=i,this}set(e,n,i){return this.radius=e,this.theta=n,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=n,this}clone(){return new this.constructor().copy(this)}}const P4=new Ye;class ide{constructor(e=new Ye(1/0,1/0),n=new Ye(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=P4.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,P4).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const D4=new ae,k_=new ae;class rde{constructor(e=new ae,n=new ae){this.start=e,this.end=n}set(e,n){return this.start.copy(e),this.end.copy(n),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,n){return this.delta(n).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,n){D4.subVectors(e,this.start),k_.subVectors(this.end,this.start);const i=k_.dot(k_);let s=k_.dot(D4)/i;return n&&(s=xi(s,0,1)),s}closestPointToPoint(e,n,i){const r=this.closestPointToPointParameter(e,n);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const R4=new ae;class sde extends mn{constructor(e,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="SpotLightHelper";const i=new Kt,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,h=a/l*Math.PI*2;r.push(Math.cos(c),Math.sin(c),1,Math.cos(h),Math.sin(h),1)}i.setAttribute("position",new xt(r,3));const s=new $r({fog:!1,toneMapped:!1});this.cone=new sl(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),R4.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(R4),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Lu=new ae,z_=new kt,cP=new kt;class ode extends sl{constructor(e){const n=CY(e),i=new Kt,r=[],s=[],o=new st(0,0,1),a=new st(0,1,0);for(let c=0;c<n.length;c++){const h=n[c];h.parent&&h.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}i.setAttribute("position",new xt(r,3)),i.setAttribute("color",new xt(s,3));const l=new $r({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const n=this.bones,i=this.geometry,r=i.getAttribute("position");cP.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<n.length;s++){const a=n[s];a.parent&&a.parent.isBone&&(z_.multiplyMatrices(cP,a.matrixWorld),Lu.setFromMatrixPosition(z_),r.setXYZ(o,Lu.x,Lu.y,Lu.z),z_.multiplyMatrices(cP,a.parent.matrixWorld),Lu.setFromMatrixPosition(z_),r.setXYZ(o+1,Lu.x,Lu.y,Lu.z),o+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function CY(t){const e=[];t.isBone===!0&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,CY(t.children[n]));return e}class ade extends yr{constructor(e,n,i){const r=new mv(n,4,2),s=new lo({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const lde=new ae,L4=new st,I4=new st;class cde extends mn{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const r=new pv(n);r.rotateY(Math.PI*.5),this.material=new lo({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new Sn(o,3)),this.add(new yr(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const n=e.geometry.getAttribute("color");L4.copy(this.light.color),I4.copy(this.light.groundColor);for(let i=0,r=n.count;i<r;i++){const s=i<r/2?L4:I4;n.setXYZ(i,s.r,s.g,s.b)}n.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(lde.setFromMatrixPosition(this.light.matrixWorld).negate())}}class ude extends sl{constructor(e=10,n=10,i=4473924,r=8947848){i=new st(i),r=new st(r);const s=n/2,o=e/n,a=e/2,l=[],c=[];for(let d=0,f=0,p=-a;d<=n;d++,p+=o){l.push(-a,0,p,a,0,p),l.push(p,0,-a,p,0,a);const v=d===s?i:r;v.toArray(c,f),f+=3,v.toArray(c,f),f+=3,v.toArray(c,f),f+=3,v.toArray(c,f),f+=3}const h=new Kt;h.setAttribute("position",new xt(l,3)),h.setAttribute("color",new xt(c,3));const u=new $r({vertexColors:!0,toneMapped:!1});super(h,u),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class hde extends sl{constructor(e=10,n=16,i=8,r=64,s=4473924,o=8947848){s=new st(s),o=new st(o);const a=[],l=[];if(n>1)for(let u=0;u<n;u++){const d=u/n*(Math.PI*2),f=Math.sin(d)*e,p=Math.cos(d)*e;a.push(0,0,0),a.push(f,0,p);const v=u&1?s:o;l.push(v.r,v.g,v.b),l.push(v.r,v.g,v.b)}for(let u=0;u<i;u++){const d=u&1?s:o,f=e-e/i*u;for(let p=0;p<r;p++){let v=p/r*(Math.PI*2),g=Math.sin(v)*f,m=Math.cos(v)*f;a.push(g,0,m),l.push(d.r,d.g,d.b),v=(p+1)/r*(Math.PI*2),g=Math.sin(v)*f,m=Math.cos(v)*f,a.push(g,0,m),l.push(d.r,d.g,d.b)}}const c=new Kt;c.setAttribute("position",new xt(a,3)),c.setAttribute("color",new xt(l,3));const h=new $r({vertexColors:!0,toneMapped:!1});super(c,h),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const B4=new ae,G_=new ae,O4=new ae;class dde extends mn{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",n===void 0&&(n=1);let r=new Kt;r.setAttribute("position",new xt([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));const s=new $r({fog:!1,toneMapped:!1});this.lightPlane=new ou(r,s),this.add(this.lightPlane),r=new Kt,r.setAttribute("position",new xt([0,0,0,0,0,1],3)),this.targetLine=new ou(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),B4.setFromMatrixPosition(this.light.matrixWorld),G_.setFromMatrixPosition(this.light.target.matrixWorld),O4.subVectors(G_,B4),this.lightPlane.lookAt(G_),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(G_),this.targetLine.scale.z=O4.length()}}const H_=new ae,mi=new l1;class fde extends sl{constructor(e){const n=new Kt,i=new $r({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(p,v){l(p),l(v)}function l(p){r.push(0,0,0),s.push(0,0,0),o[p]===void 0&&(o[p]=[]),o[p].push(r.length/3-1)}n.setAttribute("position",new xt(r,3)),n.setAttribute("color",new xt(s,3)),super(n,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new st(16755200),h=new st(16711680),u=new st(43775),d=new st(16777215),f=new st(3355443);this.setColors(c,h,u,d,f)}setColors(e,n,i,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,n.r,n.g,n.b),a.setXYZ(25,n.r,n.g,n.b),a.setXYZ(26,n.r,n.g,n.b),a.setXYZ(27,n.r,n.g,n.b),a.setXYZ(28,n.r,n.g,n.b),a.setXYZ(29,n.r,n.g,n.b),a.setXYZ(30,n.r,n.g,n.b),a.setXYZ(31,n.r,n.g,n.b),a.setXYZ(32,i.r,i.g,i.b),a.setXYZ(33,i.r,i.g,i.b),a.setXYZ(34,i.r,i.g,i.b),a.setXYZ(35,i.r,i.g,i.b),a.setXYZ(36,i.r,i.g,i.b),a.setXYZ(37,i.r,i.g,i.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,n=this.pointMap,i=1,r=1;mi.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Mi("c",n,e,mi,0,0,-1),Mi("t",n,e,mi,0,0,1),Mi("n1",n,e,mi,-i,-r,-1),Mi("n2",n,e,mi,i,-r,-1),Mi("n3",n,e,mi,-i,r,-1),Mi("n4",n,e,mi,i,r,-1),Mi("f1",n,e,mi,-i,-r,1),Mi("f2",n,e,mi,i,-r,1),Mi("f3",n,e,mi,-i,r,1),Mi("f4",n,e,mi,i,r,1),Mi("u1",n,e,mi,i*.7,r*1.1,-1),Mi("u2",n,e,mi,-i*.7,r*1.1,-1),Mi("u3",n,e,mi,0,r*2,-1),Mi("cf1",n,e,mi,-i,0,1),Mi("cf2",n,e,mi,i,0,1),Mi("cf3",n,e,mi,0,-r,1),Mi("cf4",n,e,mi,0,r,1),Mi("cn1",n,e,mi,-i,0,-1),Mi("cn2",n,e,mi,i,0,-1),Mi("cn3",n,e,mi,0,-r,-1),Mi("cn4",n,e,mi,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Mi(t,e,n,i,r,s,o){H_.set(r,s,o).unproject(i);const a=e[t];if(a!==void 0){const l=n.getAttribute("position");for(let c=0,h=a.length;c<h;c++)l.setXYZ(a[c],H_.x,H_.y,H_.z)}}const V_=new il;class pde extends sl{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new Kt;s.setIndex(new Sn(i,1)),s.setAttribute("position",new Sn(r,3)),super(s,new $r({color:n,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&V_.setFromObject(this.object),V_.isEmpty())return;const n=V_.min,i=V_.max,r=this.geometry.attributes.position,s=r.array;s[0]=i.x,s[1]=i.y,s[2]=i.z,s[3]=n.x,s[4]=i.y,s[5]=i.z,s[6]=n.x,s[7]=n.y,s[8]=i.z,s[9]=i.x,s[10]=n.y,s[11]=i.z,s[12]=i.x,s[13]=i.y,s[14]=n.z,s[15]=n.x,s[16]=i.y,s[17]=n.z,s[18]=n.x,s[19]=n.y,s[20]=n.z,s[21]=i.x,s[22]=n.y,s[23]=n.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,n){return super.copy(e,n),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class mde extends sl{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Kt;s.setIndex(new Sn(i,1)),s.setAttribute("position",new xt(r,3)),super(s,new $r({color:n,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class gde extends ou{constructor(e,n=1,i=16776960){const r=i,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new Kt;o.setAttribute("position",new xt(s,3)),o.computeBoundingSphere(),super(o,new $r({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=n;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new Kt;l.setAttribute("position",new xt(a,3)),l.computeBoundingSphere(),this.add(new yr(l,new lo({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const F4=new ae;let j_,uP;class vde extends mn{constructor(e=new ae(0,0,1),n=new ae(0,0,0),i=1,r=16776960,s=i*.2,o=s*.2){super(),this.type="ArrowHelper",j_===void 0&&(j_=new Kt,j_.setAttribute("position",new xt([0,0,0,0,1,0],3)),uP=new Xf(0,.5,1,5,1),uP.translate(0,-.5,0)),this.position.copy(n),this.line=new ou(j_,new $r({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new yr(uP,new lo({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{F4.set(e.z,0,-e.x).normalize();const n=Math.acos(e.y);this.quaternion.setFromAxisAngle(F4,n)}}setLength(e,n=e*.2,i=n*.2){this.line.scale.set(1,Math.max(1e-4,e-n),1),this.line.updateMatrix(),this.cone.scale.set(i,n,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class yde extends sl{constructor(e=1){const n=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Kt;r.setAttribute("position",new xt(n,3)),r.setAttribute("color",new xt(i,3));const s=new $r({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,n,i){const r=new st,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(n),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class xde{constructor(){this.type="ShapePath",this.color=new st,this.subPaths=[],this.currentPath=null}moveTo(e,n){return this.currentPath=new wx,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n),this}lineTo(e,n){return this.currentPath.lineTo(e,n),this}quadraticCurveTo(e,n,i,r){return this.currentPath.quadraticCurveTo(e,n,i,r),this}bezierCurveTo(e,n,i,r,s,o){return this.currentPath.bezierCurveTo(e,n,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(m){const y=[];for(let w=0,b=m.length;w<b;w++){const A=m[w],S=new vf;S.curves=A.curves,y.push(S)}return y}function i(m,y){const w=y.length;let b=!1;for(let A=w-1,S=0;S<w;A=S++){let T=y[A],M=y[S],E=M.x-T.x,P=M.y-T.y;if(Math.abs(P)>Number.EPSILON){if(P<0&&(T=y[S],E=-E,M=y[A],P=-P),m.y<T.y||m.y>M.y)continue;if(m.y===T.y){if(m.x===T.x)return!0}else{const R=P*(m.x-T.x)-E*(m.y-T.y);if(R===0)return!0;if(R<0)continue;b=!b}}else{if(m.y!==T.y)continue;if(M.x<=m.x&&m.x<=T.x||T.x<=m.x&&m.x<=M.x)return!0}}return b}const r=Xl.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const c=[];if(s.length===1)return a=s[0],l=new vf,l.curves=a.curves,c.push(l),c;let h=!r(s[0].getPoints());h=e?!h:h;const u=[],d=[];let f=[],p=0,v;d[p]=void 0,f[p]=[];for(let m=0,y=s.length;m<y;m++)a=s[m],v=a.getPoints(),o=r(v),o=e?!o:o,o?(!h&&d[p]&&p++,d[p]={s:new vf,p:v},d[p].s.curves=a.curves,h&&p++,f[p]=[]):f[p].push({h:a,p:v[0]});if(!d[0])return n(s);if(d.length>1){let m=!1,y=0;for(let w=0,b=d.length;w<b;w++)u[w]=[];for(let w=0,b=d.length;w<b;w++){const A=f[w];for(let S=0;S<A.length;S++){const T=A[S];let M=!0;for(let E=0;E<d.length;E++)i(T.p,d[E].p)&&(w!==E&&y++,M?(M=!1,u[E].push(T)):m=!0);M&&u[w].push(T)}}y>0&&m===!1&&(f=u)}let g;for(let m=0,y=d.length;m<y;m++){l=d[m].s,c.push(l),g=f[m];for(let w=0,b=g.length;w<b;w++)l.holes.push(g[w].h)}return c}}class wde extends td{constructor(e,n,i,r,s,o){console.warn("THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry."),super(e,n,i,r,s,o)}}class _de extends f1{constructor(e,n,i,r){console.warn("THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry."),super(e,n,i,r)}}class bde extends p1{constructor(e,n,i,r){console.warn("THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry."),super(e,n,i,r)}}class Sde extends m1{constructor(e,n,i,r,s,o,a){console.warn("THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry."),super(e,n,i,r,s,o,a)}}class Ade extends Xf{constructor(e,n,i,r,s,o,a,l){console.warn("THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry."),super(e,n,i,r,s,o,a,l)}}class Mde extends g1{constructor(e,n){console.warn("THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry."),super(e,n)}}class Ede extends v1{constructor(e,n){console.warn("THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry."),super(e,n)}}class Cde extends y1{constructor(e,n){console.warn("THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry."),super(e,n)}}class Tde extends fv{constructor(e,n,i,r){console.warn("THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry."),super(e,n,i,r)}}class Pde extends pv{constructor(e,n){console.warn("THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry."),super(e,n)}}class Dde extends hv{constructor(e,n,i,r){console.warn("THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry."),super(e,n,i,r)}}class Rde extends pu{constructor(e,n,i,r){console.warn("THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry."),super(e,n,i,r)}}class Lde extends x1{constructor(e,n,i,r,s,o){console.warn("THREE.RingBufferGeometry has been renamed to THREE.RingGeometry."),super(e,n,i,r,s,o)}}class Ide extends w1{constructor(e,n){console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),super(e,n)}}class Bde extends mv{constructor(e,n,i,r,s,o,a){console.warn("THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry."),super(e,n,i,r,s,o,a)}}class Ode extends _1{constructor(e,n){console.warn("THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry."),super(e,n)}}class Fde extends b1{constructor(e,n,i,r,s){console.warn("THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry."),super(e,n,i,r,s)}}class Nde extends S1{constructor(e,n,i,r,s,o){console.warn("THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry."),super(e,n,i,r,s,o)}}class Ude extends A1{constructor(e,n,i,r,s){console.warn("THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry."),super(e,n,i,r,s)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:XM}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=XM);const kde=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:pB,AddEquation:Wd,AddOperation:e7,AdditiveAnimationBlendMode:gB,AdditiveBlending:PR,AlphaFormat:u7,AlwaysDepth:YX,AlwaysStencilFunc:C7,AmbientLight:vY,AmbientLightProbe:Ihe,AnimationAction:MY,AnimationClip:Gg,AnimationLoader:bhe,AnimationMixer:Jhe,AnimationObjectGroup:Qhe,AnimationUtils:yhe,ArcCurve:Y7,ArrayCamera:G7,ArrowHelper:vde,Audio:SY,AudioAnalyser:khe,AudioContext:ZB,AudioListener:Fhe,AudioLoader:Rhe,AxesHelper:yde,BackSide:gs,BasicDepthPacking:A7,BasicShadowMap:IX,Bone:nE,BooleanKeyframeTrack:Yf,Box2:ide,Box3:il,Box3Helper:mde,BoxBufferGeometry:wde,BoxGeometry:td,BoxHelper:pde,BufferAttribute:Sn,BufferGeometry:Kt,BufferGeometryLoader:_Y,ByteType:s7,Cache:Bf,Camera:l1,CameraHelper:fde,CanvasTexture:Hue,CapsuleBufferGeometry:_de,CapsuleGeometry:f1,CatmullRomCurve3:q7,CineonToneMapping:i7,CircleBufferGeometry:bde,CircleGeometry:p1,ClampToEdgeWrapping:Pr,Clock:$B,Color:st,ColorKeyframeTrack:XB,ColorManagement:jo,CompressedArrayTexture:Gue,CompressedTexture:FB,CompressedTextureLoader:She,ConeBufferGeometry:Sde,ConeGeometry:m1,CubeCamera:MB,CubeReflectionMapping:Hh,CubeRefractionMapping:Vh,CubeTexture:c1,CubeTextureLoader:Ahe,CubeUVReflectionMapping:uv,CubicBezierCurve:UB,CubicBezierCurve3:Q7,CubicInterpolant:dY,CullFaceBack:TR,CullFaceFront:LX,CullFaceFrontBack:jre,CullFaceNone:RX,Curve:ol,CurvePath:J7,CustomBlending:BX,CustomToneMapping:r7,CylinderBufferGeometry:Ade,CylinderGeometry:Xf,Cylindrical:nde,Data3DTexture:bB,DataArrayTexture:JM,DataTexture:cg,DataTextureLoader:Mhe,DataUtils:Jse,DecrementStencilOp:$re,DecrementWrapStencilOp:tse,DefaultLoadingManager:zm,DepthFormat:Rh,DepthStencilFormat:Rf,DepthTexture:H7,DirectionalLight:JB,DirectionalLightHelper:dde,DiscreteInterpolant:fY,DisplayP3ColorSpace:xB,DodecahedronBufferGeometry:Mde,DodecahedronGeometry:g1,DoubleSide:na,DstAlphaFactor:GX,DstColorFactor:VX,DynamicCopyUsage:mse,DynamicDrawUsage:pf,DynamicReadUsage:dse,EdgesGeometry:Z7,EllipseCurve:iE,EqualDepth:QX,EqualStencilFunc:sse,EquirectangularReflectionMapping:px,EquirectangularRefractionMapping:mx,Euler:a1,EventDispatcher:sc,ExtrudeBufferGeometry:Ede,ExtrudeGeometry:v1,FileLoader:bo,Float16BufferAttribute:ioe,Float32BufferAttribute:xt,Float64BufferAttribute:roe,FloatType:Hc,Fog:tE,FogExp2:eE,FramebufferTexture:zue,FrontSide:Zl,Frustum:ZM,GLBufferAttribute:tde,GLSL1:vse,GLSL3:iL,GreaterDepth:JX,GreaterEqualDepth:KX,GreaterEqualStencilFunc:cse,GreaterStencilFunc:ase,GridHelper:ude,Group:Vc,HalfFloatType:Bg,HemisphereLight:gY,HemisphereLightHelper:cde,HemisphereLightProbe:Lhe,IcosahedronBufferGeometry:Cde,IcosahedronGeometry:y1,ImageBitmapLoader:bY,ImageLoader:Ax,ImageUtils:_B,IncrementStencilOp:Zre,IncrementWrapStencilOp:ese,InstancedBufferAttribute:Ug,InstancedBufferGeometry:wY,InstancedInterleavedBuffer:ede,InstancedMesh:IB,Int16BufferAttribute:toe,Int32BufferAttribute:noe,Int8BufferAttribute:Zse,IntType:a7,InterleavedBuffer:u1,InterleavedBufferAttribute:Wh,Interpolant:gv,InterpolateDiscrete:Og,InterpolateLinear:Lf,InterpolateSmooth:ES,InvertStencilOp:nse,KeepStencilOp:CS,KeyframeTrack:al,LOD:X7,LatheBufferGeometry:Tde,LatheGeometry:fv,Layers:gf,LessDepth:qX,LessEqualDepth:yA,LessEqualStencilFunc:ose,LessStencilFunc:rse,Light:nd,LightProbe:oE,Line:ou,Line3:rde,LineBasicMaterial:$r,LineCurve:rE,LineCurve3:K7,LineDashedMaterial:uY,LineLoop:BB,LineSegments:sl,LinearEncoding:yB,LinearFilter:ai,LinearInterpolant:WB,LinearMipMapLinearFilter:Qre,LinearMipMapNearestFilter:qre,LinearMipmapLinearFilter:$l,LinearMipmapNearestFilter:QM,LinearSRGBColorSpace:Ja,LinearToneMapping:t7,Loader:ws,LoaderUtils:Hg,LoadingManager:YB,LoopOnce:w7,LoopPingPong:b7,LoopRepeat:_7,LuminanceAlphaFormat:d7,LuminanceFormat:h7,MOUSE:Fd,Material:Vi,MaterialLoader:aE,MathUtils:D7,Matrix3:ln,Matrix4:kt,MaxEquation:IR,Mesh:yr,MeshBasicMaterial:lo,MeshDepthMaterial:TB,MeshDistanceMaterial:PB,MeshLambertMaterial:lY,MeshMatcapMaterial:cY,MeshNormalMaterial:aY,MeshPhongMaterial:sY,MeshPhysicalMaterial:mu,MeshStandardMaterial:M1,MeshToonMaterial:oY,MinEquation:LR,MirroredRepeatWrapping:Ig,MixOperation:$X,MultiplyBlending:RR,MultiplyOperation:s1,NearestFilter:yi,NearestMipMapLinearFilter:Yre,NearestMipMapNearestFilter:Xre,NearestMipmapLinearFilter:ag,NearestMipmapNearestFilter:gx,NeverDepth:XX,NeverStencilFunc:ise,NoBlending:Qc,NoColorSpace:Lh,NoToneMapping:Ya,NormalAnimationBlendMode:KM,NormalBlending:df,NotEqualDepth:ZX,NotEqualStencilFunc:lse,NumberKeyframeTrack:kg,Object3D:mn,ObjectLoader:Phe,ObjectSpaceNormalMap:E7,OctahedronBufferGeometry:Pde,OctahedronGeometry:pv,OneFactor:UX,OneMinusDstAlphaFactor:HX,OneMinusDstColorFactor:jX,OneMinusSrcAlphaFactor:fB,OneMinusSrcColorFactor:zX,OrthographicCamera:qa,PCFShadowMap:YM,PCFSoftShadowMap:Sy,PMREMGenerator:sL,Path:wx,PerspectiveCamera:Gn,Plane:$u,PlaneBufferGeometry:Dde,PlaneGeometry:hv,PlaneHelper:gde,PointLight:KB,PointLightHelper:ade,Points:OB,PointsMaterial:d1,PolarGridHelper:hde,PolyhedronBufferGeometry:Rde,PolyhedronGeometry:pu,PositionalAudio:Uhe,PropertyBinding:fn,PropertyMixer:AY,QuadraticBezierCurve:kB,QuadraticBezierCurve3:zB,Quaternion:_r,QuaternionKeyframeTrack:Xh,QuaternionLinearInterpolant:pY,RED_GREEN_RGTC2_Format:tL,RED_RGTC1_Format:x7,REVISION:XM,RGBADepthPacking:M7,RGBAFormat:Ps,RGBAIntegerFormat:v7,RGBA_ASTC_10x10_Format:JR,RGBA_ASTC_10x5_Format:qR,RGBA_ASTC_10x6_Format:QR,RGBA_ASTC_10x8_Format:KR,RGBA_ASTC_12x10_Format:ZR,RGBA_ASTC_12x12_Format:$R,RGBA_ASTC_4x4_Format:zR,RGBA_ASTC_5x4_Format:GR,RGBA_ASTC_5x5_Format:HR,RGBA_ASTC_6x5_Format:VR,RGBA_ASTC_6x6_Format:jR,RGBA_ASTC_8x5_Format:WR,RGBA_ASTC_8x6_Format:XR,RGBA_ASTC_8x8_Format:YR,RGBA_BPTC_Format:MS,RGBA_ETC2_EAC_Format:kR,RGBA_PVRTC_2BPPV1_Format:NR,RGBA_PVRTC_4BPPV1_Format:FR,RGBA_S3TC_DXT1_Format:bS,RGBA_S3TC_DXT3_Format:SS,RGBA_S3TC_DXT5_Format:AS,RGB_ETC1_Format:y7,RGB_ETC2_Format:UR,RGB_PVRTC_2BPPV1_Format:OR,RGB_PVRTC_4BPPV1_Format:BR,RGB_S3TC_DXT1_Format:_S,RGFormat:m7,RGIntegerFormat:g7,RawShaderMaterial:rY,Ray:o1,Raycaster:EY,RectAreaLight:yY,RedFormat:f7,RedIntegerFormat:p7,ReinhardToneMapping:n7,RepeatWrapping:jh,ReplaceStencilOp:Jre,ReverseSubtractEquation:FX,RingBufferGeometry:Lde,RingGeometry:x1,SIGNED_RED_GREEN_RGTC2_Format:nL,SIGNED_RED_RGTC1_Format:eL,SRGBColorSpace:Jt,Scene:_A,ShaderChunk:tn,ShaderLib:Ua,ShaderMaterial:ec,ShadowMaterial:iY,Shape:vf,ShapeBufferGeometry:Ide,ShapeGeometry:w1,ShapePath:xde,ShapeUtils:Xl,ShortType:o7,Skeleton:h1,SkeletonHelper:ode,SkinnedMesh:LB,Source:rf,Sphere:rl,SphereBufferGeometry:Bde,SphereGeometry:mv,Spherical:dL,SphericalHarmonics3:xY,SplineCurve:GB,SpotLight:QB,SpotLightHelper:sde,Sprite:W7,SpriteMaterial:RB,SrcAlphaFactor:dB,SrcAlphaSaturateFactor:WX,SrcColorFactor:kX,StaticCopyUsage:pse,StaticDrawUsage:yx,StaticReadUsage:hse,StereoCamera:Bhe,StreamCopyUsage:gse,StreamDrawUsage:use,StreamReadUsage:fse,StringKeyframeTrack:qf,SubtractEquation:OX,SubtractiveBlending:DR,TOUCH:Nd,TangentSpaceNormalMap:ed,TetrahedronBufferGeometry:Ode,TetrahedronGeometry:_1,Texture:ii,TextureLoader:mY,TorusBufferGeometry:Fde,TorusGeometry:b1,TorusKnotBufferGeometry:Nde,TorusKnotGeometry:S1,Triangle:Ts,TriangleFanDrawMode:xA,TriangleStripDrawMode:vB,TrianglesDrawMode:S7,TubeBufferGeometry:Ude,TubeGeometry:A1,TwoPassDoubleSide:Wre,UVMapping:qM,Uint16BufferAttribute:SB,Uint32BufferAttribute:AB,Uint8BufferAttribute:$se,Uint8ClampedBufferAttribute:eoe,Uniform:nO,UniformsGroup:$he,UniformsLib:rt,UniformsUtils:B7,UnsignedByteType:su,UnsignedInt248Type:ff,UnsignedIntType:dh,UnsignedShort4444Type:l7,UnsignedShort5551Type:c7,UnsignedShortType:mB,VSMShadowMap:Oa,Vector2:Ye,Vector3:ae,Vector4:Dn,VectorKeyframeTrack:zg,VideoTexture:kue,WebGL1Renderer:V7,WebGL3DRenderTarget:zse,WebGLArrayRenderTarget:kse,WebGLCubeRenderTarget:EB,WebGLMultipleRenderTargets:Gse,WebGLRenderTarget:Za,WebGLRenderer:DB,WebGLUtils:z7,WireframeGeometry:nY,WrapAroundEnding:vx,ZeroCurvatureEnding:tf,ZeroFactor:NX,ZeroSlopeEnding:nf,ZeroStencilOp:Kre,_SRGBAFormat:wA,sRGBEncoding:yo},Symbol.toStringTag,{value:"Module"}));var TY={exports:{}},Qf={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Qf.ConcurrentRoot=1;Qf.ContinuousEventPriority=4;Qf.DefaultEventPriority=16;Qf.DiscreteEventPriority=1;Qf.IdleEventPriority=536870912;Qf.LegacyRoot=0;TY.exports=Qf;var Gm=TY.exports;function zde(t){let e;const n=new Set,i=(c,h)=>{const u=typeof c=="function"?c(e):c;if(u!==e){const d=e;e=h?u:Object.assign({},e,u),n.forEach(f=>f(e,d))}},r=()=>e,s=(c,h=r,u=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let d=h(e);function f(){const p=h(e);if(!u(d,p)){const v=d;c(d=p,v)}}return n.add(f),()=>n.delete(f)},l={setState:i,getState:r,subscribe:(c,h,u)=>h||u?s(c,h,u):(n.add(c),()=>n.delete(c)),destroy:()=>n.clear()};return e=t(i,r,l),l}const Gde=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),N4=Gde?ge.useEffect:ge.useLayoutEffect;function PY(t){const e=typeof t=="function"?zde(t):t,n=(i=e.getState,r=Object.is)=>{const[,s]=ge.useReducer(g=>g+1,0),o=e.getState(),a=ge.useRef(o),l=ge.useRef(i),c=ge.useRef(r),h=ge.useRef(!1),u=ge.useRef();u.current===void 0&&(u.current=i(o));let d,f=!1;(a.current!==o||l.current!==i||c.current!==r||h.current)&&(d=i(o),f=!r(u.current,d)),N4(()=>{f&&(u.current=d),a.current=o,l.current=i,c.current=r,h.current=!1});const p=ge.useRef(o);N4(()=>{const g=()=>{try{const y=e.getState(),w=l.current(y);c.current(u.current,w)||(a.current=y,u.current=w,s())}catch{h.current=!0,s()}},m=e.subscribe(g);return e.getState()!==p.current&&g(),m},[]);const v=f?d:u.current;return ge.useDebugValue(v),v};return Object.assign(n,e),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const i=[n,e];return{next(){const r=i.length<=0;return{value:i.shift(),done:r}}}},n}var DY={exports:{}},hP={exports:{}},dP={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U4;function Hde(){return U4||(U4=1,function(t){function e(O,W){var H=O.length;O.push(W);e:for(;0<H;){var Y=H-1>>>1,z=O[Y];if(0<r(z,W))O[Y]=W,O[H]=z,H=Y;else break e}}function n(O){return O.length===0?null:O[0]}function i(O){if(O.length===0)return null;var W=O[0],H=O.pop();if(H!==W){O[0]=H;e:for(var Y=0,z=O.length,X=z>>>1;Y<X;){var q=2*(Y+1)-1,re=O[q],G=q+1,K=O[G];if(0>r(re,H))G<z&&0>r(K,re)?(O[Y]=K,O[G]=H,Y=G):(O[Y]=re,O[q]=H,Y=q);else if(G<z&&0>r(K,H))O[Y]=K,O[G]=H,Y=G;else break e}}return W}function r(O,W){var H=O.sortIndex-W.sortIndex;return H!==0?H:O.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,u=null,d=3,f=!1,p=!1,v=!1,g=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(O){for(var W=n(c);W!==null;){if(W.callback===null)i(c);else if(W.startTime<=O)i(c),W.sortIndex=W.expirationTime,e(l,W);else break;W=n(c)}}function b(O){if(v=!1,w(O),!p)if(n(l)!==null)p=!0,Z(A);else{var W=n(c);W!==null&&ee(b,W.startTime-O)}}function A(O,W){p=!1,v&&(v=!1,m(M),M=-1),f=!0;var H=d;try{for(w(W),u=n(l);u!==null&&(!(u.expirationTime>W)||O&&!R());){var Y=u.callback;if(typeof Y=="function"){u.callback=null,d=u.priorityLevel;var z=Y(u.expirationTime<=W);W=t.unstable_now(),typeof z=="function"?u.callback=z:u===n(l)&&i(l),w(W)}else i(l);u=n(l)}if(u!==null)var X=!0;else{var q=n(c);q!==null&&ee(b,q.startTime-W),X=!1}return X}finally{u=null,d=H,f=!1}}var S=!1,T=null,M=-1,E=5,P=-1;function R(){return!(t.unstable_now()-P<E)}function F(){if(T!==null){var O=t.unstable_now();P=O;var W=!0;try{W=T(!0,O)}finally{W?B():(S=!1,T=null)}}else S=!1}var B;if(typeof y=="function")B=function(){y(F)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,j=k.port2;k.port1.onmessage=F,B=function(){j.postMessage(null)}}else B=function(){g(F,0)};function Z(O){T=O,S||(S=!0,B())}function ee(O,W){M=g(function(){O(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,Z(A))},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(O){switch(d){case 1:case 2:case 3:var W=3;break;default:W=d}var H=d;d=W;try{return O()}finally{d=H}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(O,W){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var H=d;d=O;try{return W()}finally{d=H}},t.unstable_scheduleCallback=function(O,W,H){var Y=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?Y+H:Y):H=Y,O){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=H+z,O={id:h++,callback:W,priorityLevel:O,startTime:H,expirationTime:z,sortIndex:-1},H>Y?(O.sortIndex=H,e(c,O),n(l)===null&&O===n(c)&&(v?(m(M),M=-1):v=!0,ee(b,H-Y))):(O.sortIndex=z,e(l,O),p||f||(p=!0,Z(A))),O},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(O){var W=d;return function(){var H=d;d=W;try{return O.apply(this,arguments)}finally{d=H}}}}(dP)),dP}var k4;function Vde(){return k4||(k4=1,hP.exports=Hde()),hP.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jde=function(e){var n={},i=ge,r=Vde(),s=Object.assign;function o(x){for(var _="https://reactjs.org/docs/error-decoder.html?invariant="+x,C=1;C<arguments.length;C++)_+="&args[]="+encodeURIComponent(arguments[C]);return"Minified React error #"+x+"; visit "+_+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),f=Symbol.for("react.provider"),p=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.suspense_list"),y=Symbol.for("react.memo"),w=Symbol.for("react.lazy"),b=Symbol.for("react.offscreen"),A=Symbol.iterator;function S(x){return x===null||typeof x!="object"?null:(x=A&&x[A]||x["@@iterator"],typeof x=="function"?x:null)}function T(x){if(x==null)return null;if(typeof x=="function")return x.displayName||x.name||null;if(typeof x=="string")return x;switch(x){case h:return"Fragment";case c:return"Portal";case d:return"Profiler";case u:return"StrictMode";case g:return"Suspense";case m:return"SuspenseList"}if(typeof x=="object")switch(x.$$typeof){case p:return(x.displayName||"Context")+".Consumer";case f:return(x._context.displayName||"Context")+".Provider";case v:var _=x.render;return x=x.displayName,x||(x=_.displayName||_.name||"",x=x!==""?"ForwardRef("+x+")":"ForwardRef"),x;case y:return _=x.displayName||null,_!==null?_:T(x.type)||"Memo";case w:_=x._payload,x=x._init;try{return T(x(_))}catch{}}return null}function M(x){var _=x.type;switch(x.tag){case 24:return"Cache";case 9:return(_.displayName||"Context")+".Consumer";case 10:return(_._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return x=_.render,x=x.displayName||x.name||"",_.displayName||(x!==""?"ForwardRef("+x+")":"ForwardRef");case 7:return"Fragment";case 5:return _;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return T(_);case 8:return _===u?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof _=="function")return _.displayName||_.name||null;if(typeof _=="string")return _}return null}function E(x){var _=x,C=x;if(x.alternate)for(;_.return;)_=_.return;else{x=_;do _=x,_.flags&4098&&(C=_.return),x=_.return;while(x)}return _.tag===3?C:null}function P(x){if(E(x)!==x)throw Error(o(188))}function R(x){var _=x.alternate;if(!_){if(_=E(x),_===null)throw Error(o(188));return _!==x?null:x}for(var C=x,D=_;;){var I=C.return;if(I===null)break;var V=I.alternate;if(V===null){if(D=I.return,D!==null){C=D;continue}break}if(I.child===V.child){for(V=I.child;V;){if(V===C)return P(I),x;if(V===D)return P(I),_;V=V.sibling}throw Error(o(188))}if(C.return!==D.return)C=I,D=V;else{for(var pe=!1,Ce=I.child;Ce;){if(Ce===C){pe=!0,C=I,D=V;break}if(Ce===D){pe=!0,D=I,C=V;break}Ce=Ce.sibling}if(!pe){for(Ce=V.child;Ce;){if(Ce===C){pe=!0,C=V,D=I;break}if(Ce===D){pe=!0,D=V,C=I;break}Ce=Ce.sibling}if(!pe)throw Error(o(189))}}if(C.alternate!==D)throw Error(o(190))}if(C.tag!==3)throw Error(o(188));return C.stateNode.current===C?x:_}function F(x){return x=R(x),x!==null?B(x):null}function B(x){if(x.tag===5||x.tag===6)return x;for(x=x.child;x!==null;){var _=B(x);if(_!==null)return _;x=x.sibling}return null}function k(x){if(x.tag===5||x.tag===6)return x;for(x=x.child;x!==null;){if(x.tag!==4){var _=k(x);if(_!==null)return _}x=x.sibling}return null}var j=Array.isArray,Z=e.getPublicInstance,ee=e.getRootHostContext,O=e.getChildHostContext,W=e.prepareForCommit,H=e.resetAfterCommit,Y=e.createInstance,z=e.appendInitialChild,X=e.finalizeInitialChildren,q=e.prepareUpdate,re=e.shouldSetTextContent,G=e.createTextInstance,K=e.scheduleTimeout,oe=e.cancelTimeout,ve=e.noTimeout,$=e.isPrimaryRenderer,se=e.supportsMutation,ne=e.supportsPersistence,ie=e.supportsHydration,me=e.getInstanceFromNode,xe=e.preparePortalMount,Ae=e.getCurrentEventPriority,_e=e.detachDeletedInstance,Ee=e.supportsMicrotasks,Re=e.scheduleMicrotask,Ue=e.supportsTestSelectors,Ne=e.findFiberRoot,U=e.getBoundingRect,L=e.getTextContent,te=e.isHiddenSubtree,we=e.matchAccessibilityRole,Te=e.setFocusIfFocusable,Ie=e.setupIntersectionObserver,Qe=e.appendChild,Ge=e.appendChildToContainer,ye=e.commitTextUpdate,Ve=e.commitMount,ue=e.commitUpdate,Me=e.insertBefore,Be=e.insertInContainerBefore,ze=e.removeChild,$e=e.removeChildFromContainer,dt=e.resetTextContent,Bt=e.hideInstance,J=e.hideTextInstance,fe=e.unhideInstance,Se=e.unhideTextInstance,Oe=e.clearContainer,qe=e.cloneInstance,vt=e.createContainerChildSet,Et=e.appendChildToContainerChildSet,un=e.finalizeContainerChildren,Wi=e.replaceContainerChildren,Ot=e.cloneHiddenInstance,Wn=e.cloneHiddenTextInstance,Xn=e.canHydrateInstance,cc=e.canHydrateTextInstance,ip=e.canHydrateSuspenseInstance,rp=e.isSuspenseInstancePending,ad=e.isSuspenseInstanceFallback,he=e.registerSuspenseInstanceRetry,Q=e.getNextHydratableSibling,de=e.getFirstHydratableChild,le=e.getFirstHydratableChildWithinContainer,ce=e.getFirstHydratableChildWithinSuspenseInstance,De=e.hydrateInstance,Ke=e.hydrateTextInstance,Ze=e.hydrateSuspenseInstance,it=e.getNextHydratableInstanceAfterSuspenseInstance,ht=e.commitHydratedContainer,lt=e.commitHydratedSuspenseInstance,ot=e.clearSuspenseBoundary,Mt=e.clearSuspenseBoundaryFromContainer,Vt=e.shouldDeleteUnhydratedTailInstances,Un=e.didNotMatchHydratedContainerTextInstance,Si=e.didNotMatchHydratedTextInstance,vn;function yt(x){if(vn===void 0)try{throw Error()}catch(C){var _=C.stack.trim().match(/\n( *(at )?)/);vn=_&&_[1]||""}return`
`+vn+x}var Qt=!1;function ga(x,_){if(!x||Qt)return"";Qt=!0;var C=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(_)if(_=function(){throw Error()},Object.defineProperty(_.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_,[])}catch(et){var D=et}Reflect.construct(x,[],_)}else{try{_.call()}catch(et){D=et}x.call(_.prototype)}else{try{throw Error()}catch(et){D=et}x()}}catch(et){if(et&&D&&typeof et.stack=="string"){for(var I=et.stack.split(`
`),V=D.stack.split(`
`),pe=I.length-1,Ce=V.length-1;1<=pe&&0<=Ce&&I[pe]!==V[Ce];)Ce--;for(;1<=pe&&0<=Ce;pe--,Ce--)if(I[pe]!==V[Ce]){if(pe!==1||Ce!==1)do if(pe--,Ce--,0>Ce||I[pe]!==V[Ce]){var je=`
`+I[pe].replace(" at new "," at ");return x.displayName&&je.includes("<anonymous>")&&(je=je.replace("<anonymous>",x.displayName)),je}while(1<=pe&&0<=Ce);break}}}finally{Qt=!1,Error.prepareStackTrace=C}return(x=x?x.displayName||x.name:"")?yt(x):""}var Bn=Object.prototype.hasOwnProperty,bs=[],es=-1;function ar(x){return{current:x}}function Gt(x){0>es||(x.current=bs[es],bs[es]=null,es--)}function It(x,_){es++,bs[es]=x.current,x.current=_}var Li={},dn=ar(Li),yn=ar(!1),js=Li;function va(x,_){var C=x.type.contextTypes;if(!C)return Li;var D=x.stateNode;if(D&&D.__reactInternalMemoizedUnmaskedChildContext===_)return D.__reactInternalMemoizedMaskedChildContext;var I={},V;for(V in C)I[V]=_[V];return D&&(x=x.stateNode,x.__reactInternalMemoizedUnmaskedChildContext=_,x.__reactInternalMemoizedMaskedChildContext=I),I}function Mr(x){return x=x.childContextTypes,x!=null}function Y1(){Gt(yn),Gt(dn)}function gN(x,_,C){if(dn.current!==Li)throw Error(o(168));It(dn,_),It(yn,C)}function vN(x,_,C){var D=x.stateNode;if(_=_.childContextTypes,typeof D.getChildContext!="function")return C;D=D.getChildContext();for(var I in D)if(!(I in _))throw Error(o(108,M(x)||"Unknown",I));return s({},C,D)}function q1(x){return x=(x=x.stateNode)&&x.__reactInternalMemoizedMergedChildContext||Li,js=dn.current,It(dn,x),It(yn,yn.current),!0}function yN(x,_,C){var D=x.stateNode;if(!D)throw Error(o(169));C?(x=vN(x,_,js),D.__reactInternalMemoizedMergedChildContext=x,Gt(yn),Gt(dn),It(dn,x)):Gt(yn),It(yn,C)}var ya=Math.clz32?Math.clz32:Pee,Cee=Math.log,Tee=Math.LN2;function Pee(x){return x>>>=0,x===0?32:31-(Cee(x)/Tee|0)|0}var Q1=64,K1=4194304;function Rv(x){switch(x&-x){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return x&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return x&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return x}}function J1(x,_){var C=x.pendingLanes;if(C===0)return 0;var D=0,I=x.suspendedLanes,V=x.pingedLanes,pe=C&268435455;if(pe!==0){var Ce=pe&~I;Ce!==0?D=Rv(Ce):(V&=pe,V!==0&&(D=Rv(V)))}else pe=C&~I,pe!==0?D=Rv(pe):V!==0&&(D=Rv(V));if(D===0)return 0;if(_!==0&&_!==D&&!(_&I)&&(I=D&-D,V=_&-_,I>=V||I===16&&(V&4194240)!==0))return _;if(D&4&&(D|=C&16),_=x.entangledLanes,_!==0)for(x=x.entanglements,_&=D;0<_;)C=31-ya(_),I=1<<C,D|=x[C],_&=~I;return D}function Dee(x,_){switch(x){case 1:case 2:case 4:return _+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return _+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ree(x,_){for(var C=x.suspendedLanes,D=x.pingedLanes,I=x.expirationTimes,V=x.pendingLanes;0<V;){var pe=31-ya(V),Ce=1<<pe,je=I[pe];je===-1?(!(Ce&C)||Ce&D)&&(I[pe]=Dee(Ce,_)):je<=_&&(x.expiredLanes|=Ce),V&=~Ce}}function iC(x){return x=x.pendingLanes&-1073741825,x!==0?x:x&1073741824?1073741824:0}function rC(x){for(var _=[],C=0;31>C;C++)_.push(x);return _}function Lv(x,_,C){x.pendingLanes|=_,_!==536870912&&(x.suspendedLanes=0,x.pingedLanes=0),x=x.eventTimes,_=31-ya(_),x[_]=C}function Lee(x,_){var C=x.pendingLanes&~_;x.pendingLanes=_,x.suspendedLanes=0,x.pingedLanes=0,x.expiredLanes&=_,x.mutableReadLanes&=_,x.entangledLanes&=_,_=x.entanglements;var D=x.eventTimes;for(x=x.expirationTimes;0<C;){var I=31-ya(C),V=1<<I;_[I]=0,D[I]=-1,x[I]=-1,C&=~V}}function sC(x,_){var C=x.entangledLanes|=_;for(x=x.entanglements;C;){var D=31-ya(C),I=1<<D;I&_|x[D]&_&&(x[D]|=_),C&=~I}}var xn=0;function xN(x){return x&=-x,1<x?4<x?x&268435455?16:536870912:4:1}var oC=r.unstable_scheduleCallback,wN=r.unstable_cancelCallback,Iee=r.unstable_shouldYield,Bee=r.unstable_requestPaint,lr=r.unstable_now,aC=r.unstable_ImmediatePriority,Oee=r.unstable_UserBlockingPriority,lC=r.unstable_NormalPriority,Fee=r.unstable_IdlePriority,Z1=null,cl=null;function Nee(x){if(cl&&typeof cl.onCommitFiberRoot=="function")try{cl.onCommitFiberRoot(Z1,x,void 0,(x.current.flags&128)===128)}catch{}}function Uee(x,_){return x===_&&(x!==0||1/x===1/_)||x!==x&&_!==_}var ul=typeof Object.is=="function"?Object.is:Uee,uc=null,$1=!1,cC=!1;function _N(x){uc===null?uc=[x]:uc.push(x)}function kee(x){$1=!0,_N(x)}function hl(){if(!cC&&uc!==null){cC=!0;var x=0,_=xn;try{var C=uc;for(xn=1;x<C.length;x++){var D=C[x];do D=D(!0);while(D!==null)}uc=null,$1=!1}catch(I){throw uc!==null&&(uc=uc.slice(x+1)),oC(aC,hl),I}finally{xn=_,cC=!1}}return null}var zee=a.ReactCurrentBatchConfig;function ew(x,_){if(ul(x,_))return!0;if(typeof x!="object"||x===null||typeof _!="object"||_===null)return!1;var C=Object.keys(x),D=Object.keys(_);if(C.length!==D.length)return!1;for(D=0;D<C.length;D++){var I=C[D];if(!Bn.call(_,I)||!ul(x[I],_[I]))return!1}return!0}function Gee(x){switch(x.tag){case 5:return yt(x.type);case 16:return yt("Lazy");case 13:return yt("Suspense");case 19:return yt("SuspenseList");case 0:case 2:case 15:return x=ga(x.type,!1),x;case 11:return x=ga(x.type.render,!1),x;case 1:return x=ga(x.type,!0),x;default:return""}}function xa(x,_){if(x&&x.defaultProps){_=s({},_),x=x.defaultProps;for(var C in x)_[C]===void 0&&(_[C]=x[C]);return _}return _}var tw=ar(null),nw=null,sp=null,uC=null;function hC(){uC=sp=nw=null}function bN(x,_,C){$?(It(tw,_._currentValue),_._currentValue=C):(It(tw,_._currentValue2),_._currentValue2=C)}function dC(x){var _=tw.current;Gt(tw),$?x._currentValue=_:x._currentValue2=_}function fC(x,_,C){for(;x!==null;){var D=x.alternate;if((x.childLanes&_)!==_?(x.childLanes|=_,D!==null&&(D.childLanes|=_)):D!==null&&(D.childLanes&_)!==_&&(D.childLanes|=_),x===C)break;x=x.return}}function op(x,_){nw=x,uC=sp=null,x=x.dependencies,x!==null&&x.firstContext!==null&&(x.lanes&_&&(Ys=!0),x.firstContext=null)}function To(x){var _=$?x._currentValue:x._currentValue2;if(uC!==x)if(x={context:x,memoizedValue:_,next:null},sp===null){if(nw===null)throw Error(o(308));sp=x,nw.dependencies={lanes:0,firstContext:x}}else sp=sp.next=x;return _}var dl=null,xu=!1;function pC(x){x.updateQueue={baseState:x.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function SN(x,_){x=x.updateQueue,_.updateQueue===x&&(_.updateQueue={baseState:x.baseState,firstBaseUpdate:x.firstBaseUpdate,lastBaseUpdate:x.lastBaseUpdate,shared:x.shared,effects:x.effects})}function hc(x,_){return{eventTime:x,lane:_,tag:0,payload:null,callback:null,next:null}}function wu(x,_){var C=x.updateQueue;C!==null&&(C=C.shared,Ii!==null&&x.mode&1&&!(rn&2)?(x=C.interleaved,x===null?(_.next=_,dl===null?dl=[C]:dl.push(C)):(_.next=x.next,x.next=_),C.interleaved=_):(x=C.pending,x===null?_.next=_:(_.next=x.next,x.next=_),C.pending=_))}function iw(x,_,C){if(_=_.updateQueue,_!==null&&(_=_.shared,(C&4194240)!==0)){var D=_.lanes;D&=x.pendingLanes,C|=D,_.lanes=C,sC(x,C)}}function AN(x,_){var C=x.updateQueue,D=x.alternate;if(D!==null&&(D=D.updateQueue,C===D)){var I=null,V=null;if(C=C.firstBaseUpdate,C!==null){do{var pe={eventTime:C.eventTime,lane:C.lane,tag:C.tag,payload:C.payload,callback:C.callback,next:null};V===null?I=V=pe:V=V.next=pe,C=C.next}while(C!==null);V===null?I=V=_:V=V.next=_}else I=V=_;C={baseState:D.baseState,firstBaseUpdate:I,lastBaseUpdate:V,shared:D.shared,effects:D.effects},x.updateQueue=C;return}x=C.lastBaseUpdate,x===null?C.firstBaseUpdate=_:x.next=_,C.lastBaseUpdate=_}function rw(x,_,C,D){var I=x.updateQueue;xu=!1;var V=I.firstBaseUpdate,pe=I.lastBaseUpdate,Ce=I.shared.pending;if(Ce!==null){I.shared.pending=null;var je=Ce,et=je.next;je.next=null,pe===null?V=et:pe.next=et,pe=je;var mt=x.alternate;mt!==null&&(mt=mt.updateQueue,Ce=mt.lastBaseUpdate,Ce!==pe&&(Ce===null?mt.firstBaseUpdate=et:Ce.next=et,mt.lastBaseUpdate=je))}if(V!==null){var Xt=I.baseState;pe=0,mt=et=je=null,Ce=V;do{var Tt=Ce.lane,kn=Ce.eventTime;if((D&Tt)===Tt){mt!==null&&(mt=mt.next={eventTime:kn,lane:0,tag:Ce.tag,payload:Ce.payload,callback:Ce.callback,next:null});e:{var St=x,zr=Ce;switch(Tt=_,kn=C,zr.tag){case 1:if(St=zr.payload,typeof St=="function"){Xt=St.call(kn,Xt,Tt);break e}Xt=St;break e;case 3:St.flags=St.flags&-65537|128;case 0:if(St=zr.payload,Tt=typeof St=="function"?St.call(kn,Xt,Tt):St,Tt==null)break e;Xt=s({},Xt,Tt);break e;case 2:xu=!0}}Ce.callback!==null&&Ce.lane!==0&&(x.flags|=64,Tt=I.effects,Tt===null?I.effects=[Ce]:Tt.push(Ce))}else kn={eventTime:kn,lane:Tt,tag:Ce.tag,payload:Ce.payload,callback:Ce.callback,next:null},mt===null?(et=mt=kn,je=Xt):mt=mt.next=kn,pe|=Tt;if(Ce=Ce.next,Ce===null){if(Ce=I.shared.pending,Ce===null)break;Tt=Ce,Ce=Tt.next,Tt.next=null,I.lastBaseUpdate=Tt,I.shared.pending=null}}while(1);if(mt===null&&(je=Xt),I.baseState=je,I.firstBaseUpdate=et,I.lastBaseUpdate=mt,_=I.shared.interleaved,_!==null){I=_;do pe|=I.lane,I=I.next;while(I!==_)}else V===null&&(I.shared.lanes=0);mp|=pe,x.lanes=pe,x.memoizedState=Xt}}function MN(x,_,C){if(x=_.effects,_.effects=null,x!==null)for(_=0;_<x.length;_++){var D=x[_],I=D.callback;if(I!==null){if(D.callback=null,D=C,typeof I!="function")throw Error(o(191,I));I.call(D)}}}var EN=new i.Component().refs;function mC(x,_,C,D){_=x.memoizedState,C=C(D,_),C=C==null?_:s({},_,C),x.memoizedState=C,x.lanes===0&&(x.updateQueue.baseState=C)}var sw={isMounted:function(x){return(x=x._reactInternals)?E(x)===x:!1},enqueueSetState:function(x,_,C){x=x._reactInternals;var D=ns(),I=Su(x),V=hc(D,I);V.payload=_,C!=null&&(V.callback=C),wu(x,V),_=Io(x,I,D),_!==null&&iw(_,x,I)},enqueueReplaceState:function(x,_,C){x=x._reactInternals;var D=ns(),I=Su(x),V=hc(D,I);V.tag=1,V.payload=_,C!=null&&(V.callback=C),wu(x,V),_=Io(x,I,D),_!==null&&iw(_,x,I)},enqueueForceUpdate:function(x,_){x=x._reactInternals;var C=ns(),D=Su(x),I=hc(C,D);I.tag=2,_!=null&&(I.callback=_),wu(x,I),_=Io(x,D,C),_!==null&&iw(_,x,D)}};function CN(x,_,C,D,I,V,pe){return x=x.stateNode,typeof x.shouldComponentUpdate=="function"?x.shouldComponentUpdate(D,V,pe):_.prototype&&_.prototype.isPureReactComponent?!ew(C,D)||!ew(I,V):!0}function TN(x,_,C){var D=!1,I=Li,V=_.contextType;return typeof V=="object"&&V!==null?V=To(V):(I=Mr(_)?js:dn.current,D=_.contextTypes,V=(D=D!=null)?va(x,I):Li),_=new _(C,V),x.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=sw,x.stateNode=_,_._reactInternals=x,D&&(x=x.stateNode,x.__reactInternalMemoizedUnmaskedChildContext=I,x.__reactInternalMemoizedMaskedChildContext=V),_}function PN(x,_,C,D){x=_.state,typeof _.componentWillReceiveProps=="function"&&_.componentWillReceiveProps(C,D),typeof _.UNSAFE_componentWillReceiveProps=="function"&&_.UNSAFE_componentWillReceiveProps(C,D),_.state!==x&&sw.enqueueReplaceState(_,_.state,null)}function gC(x,_,C,D){var I=x.stateNode;I.props=C,I.state=x.memoizedState,I.refs=EN,pC(x);var V=_.contextType;typeof V=="object"&&V!==null?I.context=To(V):(V=Mr(_)?js:dn.current,I.context=va(x,V)),I.state=x.memoizedState,V=_.getDerivedStateFromProps,typeof V=="function"&&(mC(x,_,V,C),I.state=x.memoizedState),typeof _.getDerivedStateFromProps=="function"||typeof I.getSnapshotBeforeUpdate=="function"||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(_=I.state,typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount(),_!==I.state&&sw.enqueueReplaceState(I,I.state,null),rw(x,C,I,D),I.state=x.memoizedState),typeof I.componentDidMount=="function"&&(x.flags|=4194308)}var ap=[],lp=0,ow=null,aw=0,Po=[],Do=0,ld=null,dc=1,fc="";function cd(x,_){ap[lp++]=aw,ap[lp++]=ow,ow=x,aw=_}function DN(x,_,C){Po[Do++]=dc,Po[Do++]=fc,Po[Do++]=ld,ld=x;var D=dc;x=fc;var I=32-ya(D)-1;D&=~(1<<I),C+=1;var V=32-ya(_)+I;if(30<V){var pe=I-I%5;V=(D&(1<<pe)-1).toString(32),D>>=pe,I-=pe,dc=1<<32-ya(_)+I|C<<I|D,fc=V+x}else dc=1<<V|C<<I|D,fc=x}function vC(x){x.return!==null&&(cd(x,1),DN(x,1,0))}function yC(x){for(;x===ow;)ow=ap[--lp],ap[lp]=null,aw=ap[--lp],ap[lp]=null;for(;x===ld;)ld=Po[--Do],Po[Do]=null,fc=Po[--Do],Po[Do]=null,dc=Po[--Do],Po[Do]=null}var Ws=null,Xs=null,Zn=!1,Iv=!1,wa=null;function RN(x,_){var C=Bo(5,null,null,0);C.elementType="DELETED",C.stateNode=_,C.return=x,_=x.deletions,_===null?(x.deletions=[C],x.flags|=16):_.push(C)}function LN(x,_){switch(x.tag){case 5:return _=Xn(_,x.type,x.pendingProps),_!==null?(x.stateNode=_,Ws=x,Xs=de(_),!0):!1;case 6:return _=cc(_,x.pendingProps),_!==null?(x.stateNode=_,Ws=x,Xs=null,!0):!1;case 13:if(_=ip(_),_!==null){var C=ld!==null?{id:dc,overflow:fc}:null;return x.memoizedState={dehydrated:_,treeContext:C,retryLane:1073741824},C=Bo(18,null,null,0),C.stateNode=_,C.return=x,x.child=C,Ws=x,Xs=null,!0}return!1;default:return!1}}function xC(x){return(x.mode&1)!==0&&(x.flags&128)===0}function wC(x){if(Zn){var _=Xs;if(_){var C=_;if(!LN(x,_)){if(xC(x))throw Error(o(418));_=Q(C);var D=Ws;_&&LN(x,_)?RN(D,C):(x.flags=x.flags&-4097|2,Zn=!1,Ws=x)}}else{if(xC(x))throw Error(o(418));x.flags=x.flags&-4097|2,Zn=!1,Ws=x}}}function IN(x){for(x=x.return;x!==null&&x.tag!==5&&x.tag!==3&&x.tag!==13;)x=x.return;Ws=x}function Bv(x){if(!ie||x!==Ws)return!1;if(!Zn)return IN(x),Zn=!0,!1;if(x.tag!==3&&(x.tag!==5||Vt(x.type)&&!re(x.type,x.memoizedProps))){var _=Xs;if(_){if(xC(x)){for(x=Xs;x;)x=Q(x);throw Error(o(418))}for(;_;)RN(x,_),_=Q(_)}}if(IN(x),x.tag===13){if(!ie)throw Error(o(316));if(x=x.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(o(317));Xs=it(x)}else Xs=Ws?Q(x.stateNode):null;return!0}function cp(){ie&&(Xs=Ws=null,Iv=Zn=!1)}function _C(x){wa===null?wa=[x]:wa.push(x)}function Ov(x,_,C){if(x=C.ref,x!==null&&typeof x!="function"&&typeof x!="object"){if(C._owner){if(C=C._owner,C){if(C.tag!==1)throw Error(o(309));var D=C.stateNode}if(!D)throw Error(o(147,x));var I=D,V=""+x;return _!==null&&_.ref!==null&&typeof _.ref=="function"&&_.ref._stringRef===V?_.ref:(_=function(pe){var Ce=I.refs;Ce===EN&&(Ce=I.refs={}),pe===null?delete Ce[V]:Ce[V]=pe},_._stringRef=V,_)}if(typeof x!="string")throw Error(o(284));if(!C._owner)throw Error(o(290,x))}return x}function lw(x,_){throw x=Object.prototype.toString.call(_),Error(o(31,x==="[object Object]"?"object with keys {"+Object.keys(_).join(", ")+"}":x))}function BN(x){var _=x._init;return _(x._payload)}function ON(x){function _(Fe,Pe){if(x){var He=Fe.deletions;He===null?(Fe.deletions=[Pe],Fe.flags|=16):He.push(Pe)}}function C(Fe,Pe){if(!x)return null;for(;Pe!==null;)_(Fe,Pe),Pe=Pe.sibling;return null}function D(Fe,Pe){for(Fe=new Map;Pe!==null;)Pe.key!==null?Fe.set(Pe.key,Pe):Fe.set(Pe.index,Pe),Pe=Pe.sibling;return Fe}function I(Fe,Pe){return Fe=Mu(Fe,Pe),Fe.index=0,Fe.sibling=null,Fe}function V(Fe,Pe,He){return Fe.index=He,x?(He=Fe.alternate,He!==null?(He=He.index,He<Pe?(Fe.flags|=2,Pe):He):(Fe.flags|=2,Pe)):(Fe.flags|=1048576,Pe)}function pe(Fe){return x&&Fe.alternate===null&&(Fe.flags|=2),Fe}function Ce(Fe,Pe,He,ct){return Pe===null||Pe.tag!==6?(Pe=rT(He,Fe.mode,ct),Pe.return=Fe,Pe):(Pe=I(Pe,He),Pe.return=Fe,Pe)}function je(Fe,Pe,He,ct){var bt=He.type;return bt===h?mt(Fe,Pe,He.props.children,ct,He.key):Pe!==null&&(Pe.elementType===bt||typeof bt=="object"&&bt!==null&&bt.$$typeof===w&&BN(bt)===Pe.type)?(ct=I(Pe,He.props),ct.ref=Ov(Fe,Pe,He),ct.return=Fe,ct):(ct=kw(He.type,He.key,He.props,null,Fe.mode,ct),ct.ref=Ov(Fe,Pe,He),ct.return=Fe,ct)}function et(Fe,Pe,He,ct){return Pe===null||Pe.tag!==4||Pe.stateNode.containerInfo!==He.containerInfo||Pe.stateNode.implementation!==He.implementation?(Pe=sT(He,Fe.mode,ct),Pe.return=Fe,Pe):(Pe=I(Pe,He.children||[]),Pe.return=Fe,Pe)}function mt(Fe,Pe,He,ct,bt){return Pe===null||Pe.tag!==7?(Pe=gd(He,Fe.mode,ct,bt),Pe.return=Fe,Pe):(Pe=I(Pe,He),Pe.return=Fe,Pe)}function Xt(Fe,Pe,He){if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number")return Pe=rT(""+Pe,Fe.mode,He),Pe.return=Fe,Pe;if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case l:return He=kw(Pe.type,Pe.key,Pe.props,null,Fe.mode,He),He.ref=Ov(Fe,null,Pe),He.return=Fe,He;case c:return Pe=sT(Pe,Fe.mode,He),Pe.return=Fe,Pe;case w:var ct=Pe._init;return Xt(Fe,ct(Pe._payload),He)}if(j(Pe)||S(Pe))return Pe=gd(Pe,Fe.mode,He,null),Pe.return=Fe,Pe;lw(Fe,Pe)}return null}function Tt(Fe,Pe,He,ct){var bt=Pe!==null?Pe.key:null;if(typeof He=="string"&&He!==""||typeof He=="number")return bt!==null?null:Ce(Fe,Pe,""+He,ct);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case l:return He.key===bt?je(Fe,Pe,He,ct):null;case c:return He.key===bt?et(Fe,Pe,He,ct):null;case w:return bt=He._init,Tt(Fe,Pe,bt(He._payload),ct)}if(j(He)||S(He))return bt!==null?null:mt(Fe,Pe,He,ct,null);lw(Fe,He)}return null}function kn(Fe,Pe,He,ct,bt){if(typeof ct=="string"&&ct!==""||typeof ct=="number")return Fe=Fe.get(He)||null,Ce(Pe,Fe,""+ct,bt);if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case l:return Fe=Fe.get(ct.key===null?He:ct.key)||null,je(Pe,Fe,ct,bt);case c:return Fe=Fe.get(ct.key===null?He:ct.key)||null,et(Pe,Fe,ct,bt);case w:var en=ct._init;return kn(Fe,Pe,He,en(ct._payload),bt)}if(j(ct)||S(ct))return Fe=Fe.get(He)||null,mt(Pe,Fe,ct,bt,null);lw(Pe,ct)}return null}function St(Fe,Pe,He,ct){for(var bt=null,en=null,Yt=Pe,wn=Pe=0,ur=null;Yt!==null&&wn<He.length;wn++){Yt.index>wn?(ur=Yt,Yt=null):ur=Yt.sibling;var _n=Tt(Fe,Yt,He[wn],ct);if(_n===null){Yt===null&&(Yt=ur);break}x&&Yt&&_n.alternate===null&&_(Fe,Yt),Pe=V(_n,Pe,wn),en===null?bt=_n:en.sibling=_n,en=_n,Yt=ur}if(wn===He.length)return C(Fe,Yt),Zn&&cd(Fe,wn),bt;if(Yt===null){for(;wn<He.length;wn++)Yt=Xt(Fe,He[wn],ct),Yt!==null&&(Pe=V(Yt,Pe,wn),en===null?bt=Yt:en.sibling=Yt,en=Yt);return Zn&&cd(Fe,wn),bt}for(Yt=D(Fe,Yt);wn<He.length;wn++)ur=kn(Yt,Fe,wn,He[wn],ct),ur!==null&&(x&&ur.alternate!==null&&Yt.delete(ur.key===null?wn:ur.key),Pe=V(ur,Pe,wn),en===null?bt=ur:en.sibling=ur,en=ur);return x&&Yt.forEach(function(Eu){return _(Fe,Eu)}),Zn&&cd(Fe,wn),bt}function zr(Fe,Pe,He,ct){var bt=S(He);if(typeof bt!="function")throw Error(o(150));if(He=bt.call(He),He==null)throw Error(o(151));for(var en=bt=null,Yt=Pe,wn=Pe=0,ur=null,_n=He.next();Yt!==null&&!_n.done;wn++,_n=He.next()){Yt.index>wn?(ur=Yt,Yt=null):ur=Yt.sibling;var Eu=Tt(Fe,Yt,_n.value,ct);if(Eu===null){Yt===null&&(Yt=ur);break}x&&Yt&&Eu.alternate===null&&_(Fe,Yt),Pe=V(Eu,Pe,wn),en===null?bt=Eu:en.sibling=Eu,en=Eu,Yt=ur}if(_n.done)return C(Fe,Yt),Zn&&cd(Fe,wn),bt;if(Yt===null){for(;!_n.done;wn++,_n=He.next())_n=Xt(Fe,_n.value,ct),_n!==null&&(Pe=V(_n,Pe,wn),en===null?bt=_n:en.sibling=_n,en=_n);return Zn&&cd(Fe,wn),bt}for(Yt=D(Fe,Yt);!_n.done;wn++,_n=He.next())_n=kn(Yt,Fe,wn,_n.value,ct),_n!==null&&(x&&_n.alternate!==null&&Yt.delete(_n.key===null?wn:_n.key),Pe=V(_n,Pe,wn),en===null?bt=_n:en.sibling=_n,en=_n);return x&&Yt.forEach(function(vte){return _(Fe,vte)}),Zn&&cd(Fe,wn),bt}function Oo(Fe,Pe,He,ct){if(typeof He=="object"&&He!==null&&He.type===h&&He.key===null&&(He=He.props.children),typeof He=="object"&&He!==null){switch(He.$$typeof){case l:e:{for(var bt=He.key,en=Pe;en!==null;){if(en.key===bt){if(bt=He.type,bt===h){if(en.tag===7){C(Fe,en.sibling),Pe=I(en,He.props.children),Pe.return=Fe,Fe=Pe;break e}}else if(en.elementType===bt||typeof bt=="object"&&bt!==null&&bt.$$typeof===w&&BN(bt)===en.type){C(Fe,en.sibling),Pe=I(en,He.props),Pe.ref=Ov(Fe,en,He),Pe.return=Fe,Fe=Pe;break e}C(Fe,en);break}else _(Fe,en);en=en.sibling}He.type===h?(Pe=gd(He.props.children,Fe.mode,ct,He.key),Pe.return=Fe,Fe=Pe):(ct=kw(He.type,He.key,He.props,null,Fe.mode,ct),ct.ref=Ov(Fe,Pe,He),ct.return=Fe,Fe=ct)}return pe(Fe);case c:e:{for(en=He.key;Pe!==null;){if(Pe.key===en)if(Pe.tag===4&&Pe.stateNode.containerInfo===He.containerInfo&&Pe.stateNode.implementation===He.implementation){C(Fe,Pe.sibling),Pe=I(Pe,He.children||[]),Pe.return=Fe,Fe=Pe;break e}else{C(Fe,Pe);break}else _(Fe,Pe);Pe=Pe.sibling}Pe=sT(He,Fe.mode,ct),Pe.return=Fe,Fe=Pe}return pe(Fe);case w:return en=He._init,Oo(Fe,Pe,en(He._payload),ct)}if(j(He))return St(Fe,Pe,He,ct);if(S(He))return zr(Fe,Pe,He,ct);lw(Fe,He)}return typeof He=="string"&&He!==""||typeof He=="number"?(He=""+He,Pe!==null&&Pe.tag===6?(C(Fe,Pe.sibling),Pe=I(Pe,He),Pe.return=Fe,Fe=Pe):(C(Fe,Pe),Pe=rT(He,Fe.mode,ct),Pe.return=Fe,Fe=Pe),pe(Fe)):C(Fe,Pe)}return Oo}var up=ON(!0),FN=ON(!1),Fv={},Ro=ar(Fv),Nv=ar(Fv),hp=ar(Fv);function fl(x){if(x===Fv)throw Error(o(174));return x}function bC(x,_){It(hp,_),It(Nv,x),It(Ro,Fv),x=ee(_),Gt(Ro),It(Ro,x)}function dp(){Gt(Ro),Gt(Nv),Gt(hp)}function NN(x){var _=fl(hp.current),C=fl(Ro.current);_=O(C,x.type,_),C!==_&&(It(Nv,x),It(Ro,_))}function SC(x){Nv.current===x&&(Gt(Ro),Gt(Nv))}var ri=ar(0);function cw(x){for(var _=x;_!==null;){if(_.tag===13){var C=_.memoizedState;if(C!==null&&(C=C.dehydrated,C===null||rp(C)||ad(C)))return _}else if(_.tag===19&&_.memoizedProps.revealOrder!==void 0){if(_.flags&128)return _}else if(_.child!==null){_.child.return=_,_=_.child;continue}if(_===x)break;for(;_.sibling===null;){if(_.return===null||_.return===x)return null;_=_.return}_.sibling.return=_.return,_=_.sibling}return null}var AC=[];function MC(){for(var x=0;x<AC.length;x++){var _=AC[x];$?_._workInProgressVersionPrimary=null:_._workInProgressVersionSecondary=null}AC.length=0}var uw=a.ReactCurrentDispatcher,Lo=a.ReactCurrentBatchConfig,fp=0,pi=null,Nr=null,cr=null,hw=!1,Uv=!1,kv=0,Hee=0;function Ur(){throw Error(o(321))}function EC(x,_){if(_===null)return!1;for(var C=0;C<_.length&&C<x.length;C++)if(!ul(x[C],_[C]))return!1;return!0}function CC(x,_,C,D,I,V){if(fp=V,pi=_,_.memoizedState=null,_.updateQueue=null,_.lanes=0,uw.current=x===null||x.memoizedState===null?Xee:Yee,x=C(D,I),Uv){V=0;do{if(Uv=!1,kv=0,25<=V)throw Error(o(301));V+=1,cr=Nr=null,_.updateQueue=null,uw.current=qee,x=C(D,I)}while(Uv)}if(uw.current=gw,_=Nr!==null&&Nr.next!==null,fp=0,cr=Nr=pi=null,hw=!1,_)throw Error(o(300));return x}function TC(){var x=kv!==0;return kv=0,x}function pc(){var x={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return cr===null?pi.memoizedState=cr=x:cr=cr.next=x,cr}function pl(){if(Nr===null){var x=pi.alternate;x=x!==null?x.memoizedState:null}else x=Nr.next;var _=cr===null?pi.memoizedState:cr.next;if(_!==null)cr=_,Nr=x;else{if(x===null)throw Error(o(310));Nr=x,x={memoizedState:Nr.memoizedState,baseState:Nr.baseState,baseQueue:Nr.baseQueue,queue:Nr.queue,next:null},cr===null?pi.memoizedState=cr=x:cr=cr.next=x}return cr}function ud(x,_){return typeof _=="function"?_(x):_}function dw(x){var _=pl(),C=_.queue;if(C===null)throw Error(o(311));C.lastRenderedReducer=x;var D=Nr,I=D.baseQueue,V=C.pending;if(V!==null){if(I!==null){var pe=I.next;I.next=V.next,V.next=pe}D.baseQueue=I=V,C.pending=null}if(I!==null){V=I.next,D=D.baseState;var Ce=pe=null,je=null,et=V;do{var mt=et.lane;if((fp&mt)===mt)je!==null&&(je=je.next={lane:0,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null}),D=et.hasEagerState?et.eagerState:x(D,et.action);else{var Xt={lane:mt,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null};je===null?(Ce=je=Xt,pe=D):je=je.next=Xt,pi.lanes|=mt,mp|=mt}et=et.next}while(et!==null&&et!==V);je===null?pe=D:je.next=Ce,ul(D,_.memoizedState)||(Ys=!0),_.memoizedState=D,_.baseState=pe,_.baseQueue=je,C.lastRenderedState=D}if(x=C.interleaved,x!==null){I=x;do V=I.lane,pi.lanes|=V,mp|=V,I=I.next;while(I!==x)}else I===null&&(C.lanes=0);return[_.memoizedState,C.dispatch]}function fw(x){var _=pl(),C=_.queue;if(C===null)throw Error(o(311));C.lastRenderedReducer=x;var D=C.dispatch,I=C.pending,V=_.memoizedState;if(I!==null){C.pending=null;var pe=I=I.next;do V=x(V,pe.action),pe=pe.next;while(pe!==I);ul(V,_.memoizedState)||(Ys=!0),_.memoizedState=V,_.baseQueue===null&&(_.baseState=V),C.lastRenderedState=V}return[V,D]}function UN(){}function kN(x,_){var C=pi,D=pl(),I=_(),V=!ul(D.memoizedState,I);if(V&&(D.memoizedState=I,Ys=!0),D=D.queue,Gv(HN.bind(null,C,D,x),[x]),D.getSnapshot!==_||V||cr!==null&&cr.memoizedState.tag&1){if(C.flags|=2048,zv(9,GN.bind(null,C,D,I,_),void 0,null),Ii===null)throw Error(o(349));fp&30||zN(C,_,I)}return I}function zN(x,_,C){x.flags|=16384,x={getSnapshot:_,value:C},_=pi.updateQueue,_===null?(_={lastEffect:null,stores:null},pi.updateQueue=_,_.stores=[x]):(C=_.stores,C===null?_.stores=[x]:C.push(x))}function GN(x,_,C,D){_.value=C,_.getSnapshot=D,VN(_)&&Io(x,1,-1)}function HN(x,_,C){return C(function(){VN(_)&&Io(x,1,-1)})}function VN(x){var _=x.getSnapshot;x=x.value;try{var C=_();return!ul(x,C)}catch{return!0}}function PC(x){var _=pc();return typeof x=="function"&&(x=x()),_.memoizedState=_.baseState=x,x={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ud,lastRenderedState:x},_.queue=x,x=x.dispatch=Wee.bind(null,pi,x),[_.memoizedState,x]}function zv(x,_,C,D){return x={tag:x,create:_,destroy:C,deps:D,next:null},_=pi.updateQueue,_===null?(_={lastEffect:null,stores:null},pi.updateQueue=_,_.lastEffect=x.next=x):(C=_.lastEffect,C===null?_.lastEffect=x.next=x:(D=C.next,C.next=x,x.next=D,_.lastEffect=x)),x}function jN(){return pl().memoizedState}function pw(x,_,C,D){var I=pc();pi.flags|=x,I.memoizedState=zv(1|_,C,void 0,D===void 0?null:D)}function mw(x,_,C,D){var I=pl();D=D===void 0?null:D;var V=void 0;if(Nr!==null){var pe=Nr.memoizedState;if(V=pe.destroy,D!==null&&EC(D,pe.deps)){I.memoizedState=zv(_,C,V,D);return}}pi.flags|=x,I.memoizedState=zv(1|_,C,V,D)}function DC(x,_){return pw(8390656,8,x,_)}function Gv(x,_){return mw(2048,8,x,_)}function WN(x,_){return mw(4,2,x,_)}function XN(x,_){return mw(4,4,x,_)}function YN(x,_){if(typeof _=="function")return x=x(),_(x),function(){_(null)};if(_!=null)return x=x(),_.current=x,function(){_.current=null}}function qN(x,_,C){return C=C!=null?C.concat([x]):null,mw(4,4,YN.bind(null,_,x),C)}function RC(){}function QN(x,_){var C=pl();_=_===void 0?null:_;var D=C.memoizedState;return D!==null&&_!==null&&EC(_,D[1])?D[0]:(C.memoizedState=[x,_],x)}function KN(x,_){var C=pl();_=_===void 0?null:_;var D=C.memoizedState;return D!==null&&_!==null&&EC(_,D[1])?D[0]:(x=x(),C.memoizedState=[x,_],x)}function Vee(x,_){var C=xn;xn=C!==0&&4>C?C:4,x(!0);var D=Lo.transition;Lo.transition={};try{x(!1),_()}finally{xn=C,Lo.transition=D}}function JN(){return pl().memoizedState}function jee(x,_,C){var D=Su(x);C={lane:D,action:C,hasEagerState:!1,eagerState:null,next:null},ZN(x)?$N(_,C):(eU(x,_,C),C=ns(),x=Io(x,D,C),x!==null&&tU(x,_,D))}function Wee(x,_,C){var D=Su(x),I={lane:D,action:C,hasEagerState:!1,eagerState:null,next:null};if(ZN(x))$N(_,I);else{eU(x,_,I);var V=x.alternate;if(x.lanes===0&&(V===null||V.lanes===0)&&(V=_.lastRenderedReducer,V!==null))try{var pe=_.lastRenderedState,Ce=V(pe,C);if(I.hasEagerState=!0,I.eagerState=Ce,ul(Ce,pe))return}catch{}finally{}C=ns(),x=Io(x,D,C),x!==null&&tU(x,_,D)}}function ZN(x){var _=x.alternate;return x===pi||_!==null&&_===pi}function $N(x,_){Uv=hw=!0;var C=x.pending;C===null?_.next=_:(_.next=C.next,C.next=_),x.pending=_}function eU(x,_,C){Ii!==null&&x.mode&1&&!(rn&2)?(x=_.interleaved,x===null?(C.next=C,dl===null?dl=[_]:dl.push(_)):(C.next=x.next,x.next=C),_.interleaved=C):(x=_.pending,x===null?C.next=C:(C.next=x.next,x.next=C),_.pending=C)}function tU(x,_,C){if(C&4194240){var D=_.lanes;D&=x.pendingLanes,C|=D,_.lanes=C,sC(x,C)}}var gw={readContext:To,useCallback:Ur,useContext:Ur,useEffect:Ur,useImperativeHandle:Ur,useInsertionEffect:Ur,useLayoutEffect:Ur,useMemo:Ur,useReducer:Ur,useRef:Ur,useState:Ur,useDebugValue:Ur,useDeferredValue:Ur,useTransition:Ur,useMutableSource:Ur,useSyncExternalStore:Ur,useId:Ur,unstable_isNewReconciler:!1},Xee={readContext:To,useCallback:function(x,_){return pc().memoizedState=[x,_===void 0?null:_],x},useContext:To,useEffect:DC,useImperativeHandle:function(x,_,C){return C=C!=null?C.concat([x]):null,pw(4194308,4,YN.bind(null,_,x),C)},useLayoutEffect:function(x,_){return pw(4194308,4,x,_)},useInsertionEffect:function(x,_){return pw(4,2,x,_)},useMemo:function(x,_){var C=pc();return _=_===void 0?null:_,x=x(),C.memoizedState=[x,_],x},useReducer:function(x,_,C){var D=pc();return _=C!==void 0?C(_):_,D.memoizedState=D.baseState=_,x={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:x,lastRenderedState:_},D.queue=x,x=x.dispatch=jee.bind(null,pi,x),[D.memoizedState,x]},useRef:function(x){var _=pc();return x={current:x},_.memoizedState=x},useState:PC,useDebugValue:RC,useDeferredValue:function(x){var _=PC(x),C=_[0],D=_[1];return DC(function(){var I=Lo.transition;Lo.transition={};try{D(x)}finally{Lo.transition=I}},[x]),C},useTransition:function(){var x=PC(!1),_=x[0];return x=Vee.bind(null,x[1]),pc().memoizedState=x,[_,x]},useMutableSource:function(){},useSyncExternalStore:function(x,_,C){var D=pi,I=pc();if(Zn){if(C===void 0)throw Error(o(407));C=C()}else{if(C=_(),Ii===null)throw Error(o(349));fp&30||zN(D,_,C)}I.memoizedState=C;var V={value:C,getSnapshot:_};return I.queue=V,DC(HN.bind(null,D,V,x),[x]),D.flags|=2048,zv(9,GN.bind(null,D,V,C,_),void 0,null),C},useId:function(){var x=pc(),_=Ii.identifierPrefix;if(Zn){var C=fc,D=dc;C=(D&~(1<<32-ya(D)-1)).toString(32)+C,_=":"+_+"R"+C,C=kv++,0<C&&(_+="H"+C.toString(32)),_+=":"}else C=Hee++,_=":"+_+"r"+C.toString(32)+":";return x.memoizedState=_},unstable_isNewReconciler:!1},Yee={readContext:To,useCallback:QN,useContext:To,useEffect:Gv,useImperativeHandle:qN,useInsertionEffect:WN,useLayoutEffect:XN,useMemo:KN,useReducer:dw,useRef:jN,useState:function(){return dw(ud)},useDebugValue:RC,useDeferredValue:function(x){var _=dw(ud),C=_[0],D=_[1];return Gv(function(){var I=Lo.transition;Lo.transition={};try{D(x)}finally{Lo.transition=I}},[x]),C},useTransition:function(){var x=dw(ud)[0],_=pl().memoizedState;return[x,_]},useMutableSource:UN,useSyncExternalStore:kN,useId:JN,unstable_isNewReconciler:!1},qee={readContext:To,useCallback:QN,useContext:To,useEffect:Gv,useImperativeHandle:qN,useInsertionEffect:WN,useLayoutEffect:XN,useMemo:KN,useReducer:fw,useRef:jN,useState:function(){return fw(ud)},useDebugValue:RC,useDeferredValue:function(x){var _=fw(ud),C=_[0],D=_[1];return Gv(function(){var I=Lo.transition;Lo.transition={};try{D(x)}finally{Lo.transition=I}},[x]),C},useTransition:function(){var x=fw(ud)[0],_=pl().memoizedState;return[x,_]},useMutableSource:UN,useSyncExternalStore:kN,useId:JN,unstable_isNewReconciler:!1};function LC(x,_){try{var C="",D=_;do C+=Gee(D),D=D.return;while(D);var I=C}catch(V){I=`
Error generating stack: `+V.message+`
`+V.stack}return{value:x,source:_,stack:I}}function IC(x,_){try{console.error(_.value)}catch(C){setTimeout(function(){throw C})}}var Qee=typeof WeakMap=="function"?WeakMap:Map;function nU(x,_,C){C=hc(-1,C),C.tag=3,C.payload={element:null};var D=_.value;return C.callback=function(){Lw||(Lw=!0,JC=D),IC(x,_)},C}function iU(x,_,C){C=hc(-1,C),C.tag=3;var D=x.type.getDerivedStateFromError;if(typeof D=="function"){var I=_.value;C.payload=function(){return D(I)},C.callback=function(){IC(x,_)}}var V=x.stateNode;return V!==null&&typeof V.componentDidCatch=="function"&&(C.callback=function(){IC(x,_),typeof D!="function"&&(_u===null?_u=new Set([this]):_u.add(this));var pe=_.stack;this.componentDidCatch(_.value,{componentStack:pe!==null?pe:""})}),C}function rU(x,_,C){var D=x.pingCache;if(D===null){D=x.pingCache=new Qee;var I=new Set;D.set(_,I)}else I=D.get(_),I===void 0&&(I=new Set,D.set(_,I));I.has(C)||(I.add(C),x=cte.bind(null,x,_,C),_.then(x,x))}function sU(x){do{var _;if((_=x.tag===13)&&(_=x.memoizedState,_=_!==null?_.dehydrated!==null:!0),_)return x;x=x.return}while(x!==null);return null}function oU(x,_,C,D,I){return x.mode&1?(x.flags|=65536,x.lanes=I,x):(x===_?x.flags|=65536:(x.flags|=128,C.flags|=131072,C.flags&=-52805,C.tag===1&&(C.alternate===null?C.tag=17:(_=hc(-1,1),_.tag=2,wu(C,_))),C.lanes|=1),x)}function ml(x){x.flags|=4}function aU(x,_){if(x!==null&&x.child===_.child)return!0;if(_.flags&16)return!1;for(x=_.child;x!==null;){if(x.flags&12854||x.subtreeFlags&12854)return!1;x=x.sibling}return!0}var Hv,Vv,vw,yw;if(se)Hv=function(x,_){for(var C=_.child;C!==null;){if(C.tag===5||C.tag===6)z(x,C.stateNode);else if(C.tag!==4&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===_)break;for(;C.sibling===null;){if(C.return===null||C.return===_)return;C=C.return}C.sibling.return=C.return,C=C.sibling}},Vv=function(){},vw=function(x,_,C,D,I){if(x=x.memoizedProps,x!==D){var V=_.stateNode,pe=fl(Ro.current);C=q(V,C,x,D,I,pe),(_.updateQueue=C)&&ml(_)}},yw=function(x,_,C,D){C!==D&&ml(_)};else if(ne){Hv=function(x,_,C,D){for(var I=_.child;I!==null;){if(I.tag===5){var V=I.stateNode;C&&D&&(V=Ot(V,I.type,I.memoizedProps,I)),z(x,V)}else if(I.tag===6)V=I.stateNode,C&&D&&(V=Wn(V,I.memoizedProps,I)),z(x,V);else if(I.tag!==4){if(I.tag===22&&I.memoizedState!==null)V=I.child,V!==null&&(V.return=I),Hv(x,I,!0,!0);else if(I.child!==null){I.child.return=I,I=I.child;continue}}if(I===_)break;for(;I.sibling===null;){if(I.return===null||I.return===_)return;I=I.return}I.sibling.return=I.return,I=I.sibling}};var lU=function(x,_,C,D){for(var I=_.child;I!==null;){if(I.tag===5){var V=I.stateNode;C&&D&&(V=Ot(V,I.type,I.memoizedProps,I)),Et(x,V)}else if(I.tag===6)V=I.stateNode,C&&D&&(V=Wn(V,I.memoizedProps,I)),Et(x,V);else if(I.tag!==4){if(I.tag===22&&I.memoizedState!==null)V=I.child,V!==null&&(V.return=I),lU(x,I,!0,!0);else if(I.child!==null){I.child.return=I,I=I.child;continue}}if(I===_)break;for(;I.sibling===null;){if(I.return===null||I.return===_)return;I=I.return}I.sibling.return=I.return,I=I.sibling}};Vv=function(x,_){var C=_.stateNode;if(!aU(x,_)){x=C.containerInfo;var D=vt(x);lU(D,_,!1,!1),C.pendingChildren=D,ml(_),un(x,D)}},vw=function(x,_,C,D,I){var V=x.stateNode,pe=x.memoizedProps;if((x=aU(x,_))&&pe===D)_.stateNode=V;else{var Ce=_.stateNode,je=fl(Ro.current),et=null;pe!==D&&(et=q(Ce,C,pe,D,I,je)),x&&et===null?_.stateNode=V:(V=qe(V,et,C,pe,D,_,x,Ce),X(V,C,D,I,je)&&ml(_),_.stateNode=V,x?ml(_):Hv(V,_,!1,!1))}},yw=function(x,_,C,D){C!==D?(x=fl(hp.current),C=fl(Ro.current),_.stateNode=G(D,x,C,_),ml(_)):_.stateNode=x.stateNode}}else Vv=function(){},vw=function(){},yw=function(){};function jv(x,_){if(!Zn)switch(x.tailMode){case"hidden":_=x.tail;for(var C=null;_!==null;)_.alternate!==null&&(C=_),_=_.sibling;C===null?x.tail=null:C.sibling=null;break;case"collapsed":C=x.tail;for(var D=null;C!==null;)C.alternate!==null&&(D=C),C=C.sibling;D===null?_||x.tail===null?x.tail=null:x.tail.sibling=null:D.sibling=null}}function kr(x){var _=x.alternate!==null&&x.alternate.child===x.child,C=0,D=0;if(_)for(var I=x.child;I!==null;)C|=I.lanes|I.childLanes,D|=I.subtreeFlags&14680064,D|=I.flags&14680064,I.return=x,I=I.sibling;else for(I=x.child;I!==null;)C|=I.lanes|I.childLanes,D|=I.subtreeFlags,D|=I.flags,I.return=x,I=I.sibling;return x.subtreeFlags|=D,x.childLanes=C,_}function Kee(x,_,C){var D=_.pendingProps;switch(yC(_),_.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kr(_),null;case 1:return Mr(_.type)&&Y1(),kr(_),null;case 3:return D=_.stateNode,dp(),Gt(yn),Gt(dn),MC(),D.pendingContext&&(D.context=D.pendingContext,D.pendingContext=null),(x===null||x.child===null)&&(Bv(_)?ml(_):x===null||x.memoizedState.isDehydrated&&!(_.flags&256)||(_.flags|=1024,wa!==null&&(eT(wa),wa=null))),Vv(x,_),kr(_),null;case 5:SC(_),C=fl(hp.current);var I=_.type;if(x!==null&&_.stateNode!=null)vw(x,_,I,D,C),x.ref!==_.ref&&(_.flags|=512,_.flags|=2097152);else{if(!D){if(_.stateNode===null)throw Error(o(166));return kr(_),null}if(x=fl(Ro.current),Bv(_)){if(!ie)throw Error(o(175));x=De(_.stateNode,_.type,_.memoizedProps,C,x,_,!Iv),_.updateQueue=x,x!==null&&ml(_)}else{var V=Y(I,D,C,x,_);Hv(V,_,!1,!1),_.stateNode=V,X(V,I,D,C,x)&&ml(_)}_.ref!==null&&(_.flags|=512,_.flags|=2097152)}return kr(_),null;case 6:if(x&&_.stateNode!=null)yw(x,_,x.memoizedProps,D);else{if(typeof D!="string"&&_.stateNode===null)throw Error(o(166));if(x=fl(hp.current),C=fl(Ro.current),Bv(_)){if(!ie)throw Error(o(176));if(x=_.stateNode,D=_.memoizedProps,(C=Ke(x,D,_,!Iv))&&(I=Ws,I!==null))switch(V=(I.mode&1)!==0,I.tag){case 3:Un(I.stateNode.containerInfo,x,D,V);break;case 5:Si(I.type,I.memoizedProps,I.stateNode,x,D,V)}C&&ml(_)}else _.stateNode=G(D,x,C,_)}return kr(_),null;case 13:if(Gt(ri),D=_.memoizedState,Zn&&Xs!==null&&_.mode&1&&!(_.flags&128)){for(x=Xs;x;)x=Q(x);return cp(),_.flags|=98560,_}if(D!==null&&D.dehydrated!==null){if(D=Bv(_),x===null){if(!D)throw Error(o(318));if(!ie)throw Error(o(344));if(x=_.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(o(317));Ze(x,_)}else cp(),!(_.flags&128)&&(_.memoizedState=null),_.flags|=4;return kr(_),null}return wa!==null&&(eT(wa),wa=null),_.flags&128?(_.lanes=C,_):(D=D!==null,C=!1,x===null?Bv(_):C=x.memoizedState!==null,D&&!C&&(_.child.flags|=8192,_.mode&1&&(x===null||ri.current&1?Xi===0&&(Xi=3):nT())),_.updateQueue!==null&&(_.flags|=4),kr(_),null);case 4:return dp(),Vv(x,_),x===null&&xe(_.stateNode.containerInfo),kr(_),null;case 10:return dC(_.type._context),kr(_),null;case 17:return Mr(_.type)&&Y1(),kr(_),null;case 19:if(Gt(ri),I=_.memoizedState,I===null)return kr(_),null;if(D=(_.flags&128)!==0,V=I.rendering,V===null)if(D)jv(I,!1);else{if(Xi!==0||x!==null&&x.flags&128)for(x=_.child;x!==null;){if(V=cw(x),V!==null){for(_.flags|=128,jv(I,!1),x=V.updateQueue,x!==null&&(_.updateQueue=x,_.flags|=4),_.subtreeFlags=0,x=C,D=_.child;D!==null;)C=D,I=x,C.flags&=14680066,V=C.alternate,V===null?(C.childLanes=0,C.lanes=I,C.child=null,C.subtreeFlags=0,C.memoizedProps=null,C.memoizedState=null,C.updateQueue=null,C.dependencies=null,C.stateNode=null):(C.childLanes=V.childLanes,C.lanes=V.lanes,C.child=V.child,C.subtreeFlags=0,C.deletions=null,C.memoizedProps=V.memoizedProps,C.memoizedState=V.memoizedState,C.updateQueue=V.updateQueue,C.type=V.type,I=V.dependencies,C.dependencies=I===null?null:{lanes:I.lanes,firstContext:I.firstContext}),D=D.sibling;return It(ri,ri.current&1|2),_.child}x=x.sibling}I.tail!==null&&lr()>KC&&(_.flags|=128,D=!0,jv(I,!1),_.lanes=4194304)}else{if(!D)if(x=cw(V),x!==null){if(_.flags|=128,D=!0,x=x.updateQueue,x!==null&&(_.updateQueue=x,_.flags|=4),jv(I,!0),I.tail===null&&I.tailMode==="hidden"&&!V.alternate&&!Zn)return kr(_),null}else 2*lr()-I.renderingStartTime>KC&&C!==1073741824&&(_.flags|=128,D=!0,jv(I,!1),_.lanes=4194304);I.isBackwards?(V.sibling=_.child,_.child=V):(x=I.last,x!==null?x.sibling=V:_.child=V,I.last=V)}return I.tail!==null?(_=I.tail,I.rendering=_,I.tail=_.sibling,I.renderingStartTime=lr(),_.sibling=null,x=ri.current,It(ri,D?x&1|2:x&1),_):(kr(_),null);case 22:case 23:return tT(),D=_.memoizedState!==null,x!==null&&x.memoizedState!==null!==D&&(_.flags|=8192),D&&_.mode&1?qs&1073741824&&(kr(_),se&&_.subtreeFlags&6&&(_.flags|=8192)):kr(_),null;case 24:return null;case 25:return null}throw Error(o(156,_.tag))}var Jee=a.ReactCurrentOwner,Ys=!1;function ts(x,_,C,D){_.child=x===null?FN(_,null,C,D):up(_,x.child,C,D)}function cU(x,_,C,D,I){C=C.render;var V=_.ref;return op(_,I),D=CC(x,_,C,D,V,I),C=TC(),x!==null&&!Ys?(_.updateQueue=x.updateQueue,_.flags&=-2053,x.lanes&=~I,mc(x,_,I)):(Zn&&C&&vC(_),_.flags|=1,ts(x,_,D,I),_.child)}function uU(x,_,C,D,I){if(x===null){var V=C.type;return typeof V=="function"&&!iT(V)&&V.defaultProps===void 0&&C.compare===null&&C.defaultProps===void 0?(_.tag=15,_.type=V,hU(x,_,V,D,I)):(x=kw(C.type,null,D,_,_.mode,I),x.ref=_.ref,x.return=_,_.child=x)}if(V=x.child,!(x.lanes&I)){var pe=V.memoizedProps;if(C=C.compare,C=C!==null?C:ew,C(pe,D)&&x.ref===_.ref)return mc(x,_,I)}return _.flags|=1,x=Mu(V,D),x.ref=_.ref,x.return=_,_.child=x}function hU(x,_,C,D,I){if(x!==null&&ew(x.memoizedProps,D)&&x.ref===_.ref)if(Ys=!1,(x.lanes&I)!==0)x.flags&131072&&(Ys=!0);else return _.lanes=x.lanes,mc(x,_,I);return BC(x,_,C,D,I)}function dU(x,_,C){var D=_.pendingProps,I=D.children,V=x!==null?x.memoizedState:null;if(D.mode==="hidden")if(!(_.mode&1))_.memoizedState={baseLanes:0,cachePool:null},It(pp,qs),qs|=C;else if(C&1073741824)_.memoizedState={baseLanes:0,cachePool:null},D=V!==null?V.baseLanes:C,It(pp,qs),qs|=D;else return x=V!==null?V.baseLanes|C:C,_.lanes=_.childLanes=1073741824,_.memoizedState={baseLanes:x,cachePool:null},_.updateQueue=null,It(pp,qs),qs|=x,null;else V!==null?(D=V.baseLanes|C,_.memoizedState=null):D=C,It(pp,qs),qs|=D;return ts(x,_,I,C),_.child}function fU(x,_){var C=_.ref;(x===null&&C!==null||x!==null&&x.ref!==C)&&(_.flags|=512,_.flags|=2097152)}function BC(x,_,C,D,I){var V=Mr(C)?js:dn.current;return V=va(_,V),op(_,I),C=CC(x,_,C,D,V,I),D=TC(),x!==null&&!Ys?(_.updateQueue=x.updateQueue,_.flags&=-2053,x.lanes&=~I,mc(x,_,I)):(Zn&&D&&vC(_),_.flags|=1,ts(x,_,C,I),_.child)}function pU(x,_,C,D,I){if(Mr(C)){var V=!0;q1(_)}else V=!1;if(op(_,I),_.stateNode===null)x!==null&&(x.alternate=null,_.alternate=null,_.flags|=2),TN(_,C,D),gC(_,C,D,I),D=!0;else if(x===null){var pe=_.stateNode,Ce=_.memoizedProps;pe.props=Ce;var je=pe.context,et=C.contextType;typeof et=="object"&&et!==null?et=To(et):(et=Mr(C)?js:dn.current,et=va(_,et));var mt=C.getDerivedStateFromProps,Xt=typeof mt=="function"||typeof pe.getSnapshotBeforeUpdate=="function";Xt||typeof pe.UNSAFE_componentWillReceiveProps!="function"&&typeof pe.componentWillReceiveProps!="function"||(Ce!==D||je!==et)&&PN(_,pe,D,et),xu=!1;var Tt=_.memoizedState;pe.state=Tt,rw(_,D,pe,I),je=_.memoizedState,Ce!==D||Tt!==je||yn.current||xu?(typeof mt=="function"&&(mC(_,C,mt,D),je=_.memoizedState),(Ce=xu||CN(_,C,Ce,D,Tt,je,et))?(Xt||typeof pe.UNSAFE_componentWillMount!="function"&&typeof pe.componentWillMount!="function"||(typeof pe.componentWillMount=="function"&&pe.componentWillMount(),typeof pe.UNSAFE_componentWillMount=="function"&&pe.UNSAFE_componentWillMount()),typeof pe.componentDidMount=="function"&&(_.flags|=4194308)):(typeof pe.componentDidMount=="function"&&(_.flags|=4194308),_.memoizedProps=D,_.memoizedState=je),pe.props=D,pe.state=je,pe.context=et,D=Ce):(typeof pe.componentDidMount=="function"&&(_.flags|=4194308),D=!1)}else{pe=_.stateNode,SN(x,_),Ce=_.memoizedProps,et=_.type===_.elementType?Ce:xa(_.type,Ce),pe.props=et,Xt=_.pendingProps,Tt=pe.context,je=C.contextType,typeof je=="object"&&je!==null?je=To(je):(je=Mr(C)?js:dn.current,je=va(_,je));var kn=C.getDerivedStateFromProps;(mt=typeof kn=="function"||typeof pe.getSnapshotBeforeUpdate=="function")||typeof pe.UNSAFE_componentWillReceiveProps!="function"&&typeof pe.componentWillReceiveProps!="function"||(Ce!==Xt||Tt!==je)&&PN(_,pe,D,je),xu=!1,Tt=_.memoizedState,pe.state=Tt,rw(_,D,pe,I);var St=_.memoizedState;Ce!==Xt||Tt!==St||yn.current||xu?(typeof kn=="function"&&(mC(_,C,kn,D),St=_.memoizedState),(et=xu||CN(_,C,et,D,Tt,St,je)||!1)?(mt||typeof pe.UNSAFE_componentWillUpdate!="function"&&typeof pe.componentWillUpdate!="function"||(typeof pe.componentWillUpdate=="function"&&pe.componentWillUpdate(D,St,je),typeof pe.UNSAFE_componentWillUpdate=="function"&&pe.UNSAFE_componentWillUpdate(D,St,je)),typeof pe.componentDidUpdate=="function"&&(_.flags|=4),typeof pe.getSnapshotBeforeUpdate=="function"&&(_.flags|=1024)):(typeof pe.componentDidUpdate!="function"||Ce===x.memoizedProps&&Tt===x.memoizedState||(_.flags|=4),typeof pe.getSnapshotBeforeUpdate!="function"||Ce===x.memoizedProps&&Tt===x.memoizedState||(_.flags|=1024),_.memoizedProps=D,_.memoizedState=St),pe.props=D,pe.state=St,pe.context=je,D=et):(typeof pe.componentDidUpdate!="function"||Ce===x.memoizedProps&&Tt===x.memoizedState||(_.flags|=4),typeof pe.getSnapshotBeforeUpdate!="function"||Ce===x.memoizedProps&&Tt===x.memoizedState||(_.flags|=1024),D=!1)}return OC(x,_,C,D,V,I)}function OC(x,_,C,D,I,V){fU(x,_);var pe=(_.flags&128)!==0;if(!D&&!pe)return I&&yN(_,C,!1),mc(x,_,V);D=_.stateNode,Jee.current=_;var Ce=pe&&typeof C.getDerivedStateFromError!="function"?null:D.render();return _.flags|=1,x!==null&&pe?(_.child=up(_,x.child,null,V),_.child=up(_,null,Ce,V)):ts(x,_,Ce,V),_.memoizedState=D.state,I&&yN(_,C,!0),_.child}function mU(x){var _=x.stateNode;_.pendingContext?gN(x,_.pendingContext,_.pendingContext!==_.context):_.context&&gN(x,_.context,!1),bC(x,_.containerInfo)}function gU(x,_,C,D,I){return cp(),_C(I),_.flags|=256,ts(x,_,C,D),_.child}var xw={dehydrated:null,treeContext:null,retryLane:0};function ww(x){return{baseLanes:x,cachePool:null}}function vU(x,_,C){var D=_.pendingProps,I=ri.current,V=!1,pe=(_.flags&128)!==0,Ce;if((Ce=pe)||(Ce=x!==null&&x.memoizedState===null?!1:(I&2)!==0),Ce?(V=!0,_.flags&=-129):(x===null||x.memoizedState!==null)&&(I|=1),It(ri,I&1),x===null)return wC(_),x=_.memoizedState,x!==null&&(x=x.dehydrated,x!==null)?(_.mode&1?ad(x)?_.lanes=8:_.lanes=1073741824:_.lanes=1,null):(I=D.children,x=D.fallback,V?(D=_.mode,V=_.child,I={mode:"hidden",children:I},!(D&1)&&V!==null?(V.childLanes=0,V.pendingProps=I):V=zw(I,D,0,null),x=gd(x,D,C,null),V.return=_,x.return=_,V.sibling=x,_.child=V,_.child.memoizedState=ww(C),_.memoizedState=xw,x):FC(_,I));if(I=x.memoizedState,I!==null){if(Ce=I.dehydrated,Ce!==null){if(pe)return _.flags&256?(_.flags&=-257,_w(x,_,C,Error(o(422)))):_.memoizedState!==null?(_.child=x.child,_.flags|=128,null):(V=D.fallback,I=_.mode,D=zw({mode:"visible",children:D.children},I,0,null),V=gd(V,I,C,null),V.flags|=2,D.return=_,V.return=_,D.sibling=V,_.child=D,_.mode&1&&up(_,x.child,null,C),_.child.memoizedState=ww(C),_.memoizedState=xw,V);if(!(_.mode&1))_=_w(x,_,C,null);else if(ad(Ce))_=_w(x,_,C,Error(o(419)));else if(D=(C&x.childLanes)!==0,Ys||D){if(D=Ii,D!==null){switch(C&-C){case 4:V=2;break;case 16:V=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:V=32;break;case 536870912:V=268435456;break;default:V=0}D=V&(D.suspendedLanes|C)?0:V,D!==0&&D!==I.retryLane&&(I.retryLane=D,Io(x,D,-1))}nT(),_=_w(x,_,C,Error(o(421)))}else rp(Ce)?(_.flags|=128,_.child=x.child,_=ute.bind(null,x),he(Ce,_),_=null):(C=I.treeContext,ie&&(Xs=ce(Ce),Ws=_,Zn=!0,wa=null,Iv=!1,C!==null&&(Po[Do++]=dc,Po[Do++]=fc,Po[Do++]=ld,dc=C.id,fc=C.overflow,ld=_)),_=FC(_,_.pendingProps.children),_.flags|=4096);return _}return V?(D=xU(x,_,D.children,D.fallback,C),V=_.child,I=x.child.memoizedState,V.memoizedState=I===null?ww(C):{baseLanes:I.baseLanes|C,cachePool:null},V.childLanes=x.childLanes&~C,_.memoizedState=xw,D):(C=yU(x,_,D.children,C),_.memoizedState=null,C)}return V?(D=xU(x,_,D.children,D.fallback,C),V=_.child,I=x.child.memoizedState,V.memoizedState=I===null?ww(C):{baseLanes:I.baseLanes|C,cachePool:null},V.childLanes=x.childLanes&~C,_.memoizedState=xw,D):(C=yU(x,_,D.children,C),_.memoizedState=null,C)}function FC(x,_){return _=zw({mode:"visible",children:_},x.mode,0,null),_.return=x,x.child=_}function yU(x,_,C,D){var I=x.child;return x=I.sibling,C=Mu(I,{mode:"visible",children:C}),!(_.mode&1)&&(C.lanes=D),C.return=_,C.sibling=null,x!==null&&(D=_.deletions,D===null?(_.deletions=[x],_.flags|=16):D.push(x)),_.child=C}function xU(x,_,C,D,I){var V=_.mode;x=x.child;var pe=x.sibling,Ce={mode:"hidden",children:C};return!(V&1)&&_.child!==x?(C=_.child,C.childLanes=0,C.pendingProps=Ce,_.deletions=null):(C=Mu(x,Ce),C.subtreeFlags=x.subtreeFlags&14680064),pe!==null?D=Mu(pe,D):(D=gd(D,V,I,null),D.flags|=2),D.return=_,C.return=_,C.sibling=D,_.child=C,D}function _w(x,_,C,D){return D!==null&&_C(D),up(_,x.child,null,C),x=FC(_,_.pendingProps.children),x.flags|=2,_.memoizedState=null,x}function wU(x,_,C){x.lanes|=_;var D=x.alternate;D!==null&&(D.lanes|=_),fC(x.return,_,C)}function NC(x,_,C,D,I){var V=x.memoizedState;V===null?x.memoizedState={isBackwards:_,rendering:null,renderingStartTime:0,last:D,tail:C,tailMode:I}:(V.isBackwards=_,V.rendering=null,V.renderingStartTime=0,V.last=D,V.tail=C,V.tailMode=I)}function _U(x,_,C){var D=_.pendingProps,I=D.revealOrder,V=D.tail;if(ts(x,_,D.children,C),D=ri.current,D&2)D=D&1|2,_.flags|=128;else{if(x!==null&&x.flags&128)e:for(x=_.child;x!==null;){if(x.tag===13)x.memoizedState!==null&&wU(x,C,_);else if(x.tag===19)wU(x,C,_);else if(x.child!==null){x.child.return=x,x=x.child;continue}if(x===_)break e;for(;x.sibling===null;){if(x.return===null||x.return===_)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}D&=1}if(It(ri,D),!(_.mode&1))_.memoizedState=null;else switch(I){case"forwards":for(C=_.child,I=null;C!==null;)x=C.alternate,x!==null&&cw(x)===null&&(I=C),C=C.sibling;C=I,C===null?(I=_.child,_.child=null):(I=C.sibling,C.sibling=null),NC(_,!1,I,C,V);break;case"backwards":for(C=null,I=_.child,_.child=null;I!==null;){if(x=I.alternate,x!==null&&cw(x)===null){_.child=I;break}x=I.sibling,I.sibling=C,C=I,I=x}NC(_,!0,C,null,V);break;case"together":NC(_,!1,null,null,void 0);break;default:_.memoizedState=null}return _.child}function mc(x,_,C){if(x!==null&&(_.dependencies=x.dependencies),mp|=_.lanes,!(C&_.childLanes))return null;if(x!==null&&_.child!==x.child)throw Error(o(153));if(_.child!==null){for(x=_.child,C=Mu(x,x.pendingProps),_.child=C,C.return=_;x.sibling!==null;)x=x.sibling,C=C.sibling=Mu(x,x.pendingProps),C.return=_;C.sibling=null}return _.child}function Zee(x,_,C){switch(_.tag){case 3:mU(_),cp();break;case 5:NN(_);break;case 1:Mr(_.type)&&q1(_);break;case 4:bC(_,_.stateNode.containerInfo);break;case 10:bN(_,_.type._context,_.memoizedProps.value);break;case 13:var D=_.memoizedState;if(D!==null)return D.dehydrated!==null?(It(ri,ri.current&1),_.flags|=128,null):C&_.child.childLanes?vU(x,_,C):(It(ri,ri.current&1),x=mc(x,_,C),x!==null?x.sibling:null);It(ri,ri.current&1);break;case 19:if(D=(C&_.childLanes)!==0,x.flags&128){if(D)return _U(x,_,C);_.flags|=128}var I=_.memoizedState;if(I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),It(ri,ri.current),D)break;return null;case 22:case 23:return _.lanes=0,dU(x,_,C)}return mc(x,_,C)}function $ee(x,_){switch(yC(_),_.tag){case 1:return Mr(_.type)&&Y1(),x=_.flags,x&65536?(_.flags=x&-65537|128,_):null;case 3:return dp(),Gt(yn),Gt(dn),MC(),x=_.flags,x&65536&&!(x&128)?(_.flags=x&-65537|128,_):null;case 5:return SC(_),null;case 13:if(Gt(ri),x=_.memoizedState,x!==null&&x.dehydrated!==null){if(_.alternate===null)throw Error(o(340));cp()}return x=_.flags,x&65536?(_.flags=x&-65537|128,_):null;case 19:return Gt(ri),null;case 4:return dp(),null;case 10:return dC(_.type._context),null;case 22:case 23:return tT(),null;case 24:return null;default:return null}}var bw=!1,hd=!1,ete=typeof WeakSet=="function"?WeakSet:Set,at=null;function Sw(x,_){var C=x.ref;if(C!==null)if(typeof C=="function")try{C(null)}catch(D){Ms(x,_,D)}else C.current=null}function UC(x,_,C){try{C()}catch(D){Ms(x,_,D)}}var bU=!1;function tte(x,_){for(W(x.containerInfo),at=_;at!==null;)if(x=at,_=x.child,(x.subtreeFlags&1028)!==0&&_!==null)_.return=x,at=_;else for(;at!==null;){x=at;try{var C=x.alternate;if(x.flags&1024)switch(x.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var D=C.memoizedProps,I=C.memoizedState,V=x.stateNode,pe=V.getSnapshotBeforeUpdate(x.elementType===x.type?D:xa(x.type,D),I);V.__reactInternalSnapshotBeforeUpdate=pe}break;case 3:se&&Oe(x.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(Ce){Ms(x,x.return,Ce)}if(_=x.sibling,_!==null){_.return=x.return,at=_;break}at=x.return}return C=bU,bU=!1,C}function dd(x,_,C){var D=_.updateQueue;if(D=D!==null?D.lastEffect:null,D!==null){var I=D=D.next;do{if((I.tag&x)===x){var V=I.destroy;I.destroy=void 0,V!==void 0&&UC(_,C,V)}I=I.next}while(I!==D)}}function Wv(x,_){if(_=_.updateQueue,_=_!==null?_.lastEffect:null,_!==null){var C=_=_.next;do{if((C.tag&x)===x){var D=C.create;C.destroy=D()}C=C.next}while(C!==_)}}function kC(x){var _=x.ref;if(_!==null){var C=x.stateNode;switch(x.tag){case 5:x=Z(C);break;default:x=C}typeof _=="function"?_(x):_.current=x}}function SU(x,_,C){if(cl&&typeof cl.onCommitFiberUnmount=="function")try{cl.onCommitFiberUnmount(Z1,_)}catch{}switch(_.tag){case 0:case 11:case 14:case 15:if(x=_.updateQueue,x!==null&&(x=x.lastEffect,x!==null)){var D=x=x.next;do{var I=D,V=I.destroy;I=I.tag,V!==void 0&&(I&2||I&4)&&UC(_,C,V),D=D.next}while(D!==x)}break;case 1:if(Sw(_,C),x=_.stateNode,typeof x.componentWillUnmount=="function")try{x.props=_.memoizedProps,x.state=_.memoizedState,x.componentWillUnmount()}catch(pe){Ms(_,C,pe)}break;case 5:Sw(_,C);break;case 4:se?PU(x,_,C):ne&&ne&&(_=_.stateNode.containerInfo,C=vt(_),Wi(_,C))}}function AU(x,_,C){for(var D=_;;)if(SU(x,D,C),D.child===null||se&&D.tag===4){if(D===_)break;for(;D.sibling===null;){if(D.return===null||D.return===_)return;D=D.return}D.sibling.return=D.return,D=D.sibling}else D.child.return=D,D=D.child}function MU(x){var _=x.alternate;_!==null&&(x.alternate=null,MU(_)),x.child=null,x.deletions=null,x.sibling=null,x.tag===5&&(_=x.stateNode,_!==null&&_e(_)),x.stateNode=null,x.return=null,x.dependencies=null,x.memoizedProps=null,x.memoizedState=null,x.pendingProps=null,x.stateNode=null,x.updateQueue=null}function EU(x){return x.tag===5||x.tag===3||x.tag===4}function CU(x){e:for(;;){for(;x.sibling===null;){if(x.return===null||EU(x.return))return null;x=x.return}for(x.sibling.return=x.return,x=x.sibling;x.tag!==5&&x.tag!==6&&x.tag!==18;){if(x.flags&2||x.child===null||x.tag===4)continue e;x.child.return=x,x=x.child}if(!(x.flags&2))return x.stateNode}}function TU(x){if(se){e:{for(var _=x.return;_!==null;){if(EU(_))break e;_=_.return}throw Error(o(160))}var C=_;switch(C.tag){case 5:_=C.stateNode,C.flags&32&&(dt(_),C.flags&=-33),C=CU(x),GC(x,C,_);break;case 3:case 4:_=C.stateNode.containerInfo,C=CU(x),zC(x,C,_);break;default:throw Error(o(161))}}}function zC(x,_,C){var D=x.tag;if(D===5||D===6)x=x.stateNode,_?Be(C,x,_):Ge(C,x);else if(D!==4&&(x=x.child,x!==null))for(zC(x,_,C),x=x.sibling;x!==null;)zC(x,_,C),x=x.sibling}function GC(x,_,C){var D=x.tag;if(D===5||D===6)x=x.stateNode,_?Me(C,x,_):Qe(C,x);else if(D!==4&&(x=x.child,x!==null))for(GC(x,_,C),x=x.sibling;x!==null;)GC(x,_,C),x=x.sibling}function PU(x,_,C){for(var D=_,I=!1,V,pe;;){if(!I){I=D.return;e:for(;;){if(I===null)throw Error(o(160));switch(V=I.stateNode,I.tag){case 5:pe=!1;break e;case 3:V=V.containerInfo,pe=!0;break e;case 4:V=V.containerInfo,pe=!0;break e}I=I.return}I=!0}if(D.tag===5||D.tag===6)AU(x,D,C),pe?$e(V,D.stateNode):ze(V,D.stateNode);else if(D.tag===18)pe?Mt(V,D.stateNode):ot(V,D.stateNode);else if(D.tag===4){if(D.child!==null){V=D.stateNode.containerInfo,pe=!0,D.child.return=D,D=D.child;continue}}else if(SU(x,D,C),D.child!==null){D.child.return=D,D=D.child;continue}if(D===_)break;for(;D.sibling===null;){if(D.return===null||D.return===_)return;D=D.return,D.tag===4&&(I=!1)}D.sibling.return=D.return,D=D.sibling}}function HC(x,_){if(se){switch(_.tag){case 0:case 11:case 14:case 15:dd(3,_,_.return),Wv(3,_),dd(5,_,_.return);return;case 1:return;case 5:var C=_.stateNode;if(C!=null){var D=_.memoizedProps;x=x!==null?x.memoizedProps:D;var I=_.type,V=_.updateQueue;_.updateQueue=null,V!==null&&ue(C,V,I,x,D,_)}return;case 6:if(_.stateNode===null)throw Error(o(162));C=_.memoizedProps,ye(_.stateNode,x!==null?x.memoizedProps:C,C);return;case 3:ie&&x!==null&&x.memoizedState.isDehydrated&&ht(_.stateNode.containerInfo);return;case 12:return;case 13:Aw(_);return;case 19:Aw(_);return;case 17:return}throw Error(o(163))}switch(_.tag){case 0:case 11:case 14:case 15:dd(3,_,_.return),Wv(3,_),dd(5,_,_.return);return;case 12:return;case 13:Aw(_);return;case 19:Aw(_);return;case 3:ie&&x!==null&&x.memoizedState.isDehydrated&&ht(_.stateNode.containerInfo);break;case 22:case 23:return}e:if(ne){switch(_.tag){case 1:case 5:case 6:break e;case 3:case 4:_=_.stateNode,Wi(_.containerInfo,_.pendingChildren);break e}throw Error(o(163))}}function Aw(x){var _=x.updateQueue;if(_!==null){x.updateQueue=null;var C=x.stateNode;C===null&&(C=x.stateNode=new ete),_.forEach(function(D){var I=hte.bind(null,x,D);C.has(D)||(C.add(D),D.then(I,I))})}}function nte(x,_){for(at=_;at!==null;){_=at;var C=_.deletions;if(C!==null)for(var D=0;D<C.length;D++){var I=C[D];try{var V=x;se?PU(V,I,_):AU(V,I,_);var pe=I.alternate;pe!==null&&(pe.return=null),I.return=null}catch(bt){Ms(I,_,bt)}}if(C=_.child,_.subtreeFlags&12854&&C!==null)C.return=_,at=C;else for(;at!==null;){_=at;try{var Ce=_.flags;if(Ce&32&&se&&dt(_.stateNode),Ce&512){var je=_.alternate;if(je!==null){var et=je.ref;et!==null&&(typeof et=="function"?et(null):et.current=null)}}if(Ce&8192)switch(_.tag){case 13:if(_.memoizedState!==null){var mt=_.alternate;(mt===null||mt.memoizedState===null)&&(QC=lr())}break;case 22:var Xt=_.memoizedState!==null,Tt=_.alternate,kn=Tt!==null&&Tt.memoizedState!==null;if(C=_,se){e:if(D=C,I=Xt,V=null,se)for(var St=D;;){if(St.tag===5){if(V===null){V=St;var zr=St.stateNode;I?Bt(zr):fe(St.stateNode,St.memoizedProps)}}else if(St.tag===6){if(V===null){var Oo=St.stateNode;I?J(Oo):Se(Oo,St.memoizedProps)}}else if((St.tag!==22&&St.tag!==23||St.memoizedState===null||St===D)&&St.child!==null){St.child.return=St,St=St.child;continue}if(St===D)break;for(;St.sibling===null;){if(St.return===null||St.return===D)break e;V===St&&(V=null),St=St.return}V===St&&(V=null),St.sibling.return=St.return,St=St.sibling}}if(Xt&&!kn&&C.mode&1){at=C;for(var Fe=C.child;Fe!==null;){for(C=at=Fe;at!==null;){D=at;var Pe=D.child;switch(D.tag){case 0:case 11:case 14:case 15:dd(4,D,D.return);break;case 1:Sw(D,D.return);var He=D.stateNode;if(typeof He.componentWillUnmount=="function"){var ct=D.return;try{He.props=D.memoizedProps,He.state=D.memoizedState,He.componentWillUnmount()}catch(bt){Ms(D,ct,bt)}}break;case 5:Sw(D,D.return);break;case 22:if(D.memoizedState!==null){LU(C);continue}}Pe!==null?(Pe.return=D,at=Pe):LU(C)}Fe=Fe.sibling}}}switch(Ce&4102){case 2:TU(_),_.flags&=-3;break;case 6:TU(_),_.flags&=-3,HC(_.alternate,_);break;case 4096:_.flags&=-4097;break;case 4100:_.flags&=-4097,HC(_.alternate,_);break;case 4:HC(_.alternate,_)}}catch(bt){Ms(_,_.return,bt)}if(C=_.sibling,C!==null){C.return=_.return,at=C;break}at=_.return}}}function ite(x,_,C){at=x,DU(x)}function DU(x,_,C){for(var D=(x.mode&1)!==0;at!==null;){var I=at,V=I.child;if(I.tag===22&&D){var pe=I.memoizedState!==null||bw;if(!pe){var Ce=I.alternate,je=Ce!==null&&Ce.memoizedState!==null||hd;Ce=bw;var et=hd;if(bw=pe,(hd=je)&&!et)for(at=I;at!==null;)pe=at,je=pe.child,pe.tag===22&&pe.memoizedState!==null?IU(I):je!==null?(je.return=pe,at=je):IU(I);for(;V!==null;)at=V,DU(V),V=V.sibling;at=I,bw=Ce,hd=et}RU(x)}else I.subtreeFlags&8772&&V!==null?(V.return=I,at=V):RU(x)}}function RU(x){for(;at!==null;){var _=at;if(_.flags&8772){var C=_.alternate;try{if(_.flags&8772)switch(_.tag){case 0:case 11:case 15:hd||Wv(5,_);break;case 1:var D=_.stateNode;if(_.flags&4&&!hd)if(C===null)D.componentDidMount();else{var I=_.elementType===_.type?C.memoizedProps:xa(_.type,C.memoizedProps);D.componentDidUpdate(I,C.memoizedState,D.__reactInternalSnapshotBeforeUpdate)}var V=_.updateQueue;V!==null&&MN(_,V,D);break;case 3:var pe=_.updateQueue;if(pe!==null){if(C=null,_.child!==null)switch(_.child.tag){case 5:C=Z(_.child.stateNode);break;case 1:C=_.child.stateNode}MN(_,pe,C)}break;case 5:var Ce=_.stateNode;C===null&&_.flags&4&&Ve(Ce,_.type,_.memoizedProps,_);break;case 6:break;case 4:break;case 12:break;case 13:if(ie&&_.memoizedState===null){var je=_.alternate;if(je!==null){var et=je.memoizedState;if(et!==null){var mt=et.dehydrated;mt!==null&&lt(mt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}hd||_.flags&512&&kC(_)}catch(Xt){Ms(_,_.return,Xt)}}if(_===x){at=null;break}if(C=_.sibling,C!==null){C.return=_.return,at=C;break}at=_.return}}function LU(x){for(;at!==null;){var _=at;if(_===x){at=null;break}var C=_.sibling;if(C!==null){C.return=_.return,at=C;break}at=_.return}}function IU(x){for(;at!==null;){var _=at;try{switch(_.tag){case 0:case 11:case 15:var C=_.return;try{Wv(4,_)}catch(je){Ms(_,C,je)}break;case 1:var D=_.stateNode;if(typeof D.componentDidMount=="function"){var I=_.return;try{D.componentDidMount()}catch(je){Ms(_,I,je)}}var V=_.return;try{kC(_)}catch(je){Ms(_,V,je)}break;case 5:var pe=_.return;try{kC(_)}catch(je){Ms(_,pe,je)}}}catch(je){Ms(_,_.return,je)}if(_===x){at=null;break}var Ce=_.sibling;if(Ce!==null){Ce.return=_.return,at=Ce;break}at=_.return}}var Mw=0,Ew=1,Cw=2,Tw=3,Pw=4;if(typeof Symbol=="function"&&Symbol.for){var Xv=Symbol.for;Mw=Xv("selector.component"),Ew=Xv("selector.has_pseudo_class"),Cw=Xv("selector.role"),Tw=Xv("selector.test_id"),Pw=Xv("selector.text")}function VC(x){var _=me(x);if(_!=null){if(typeof _.memoizedProps["data-testname"]!="string")throw Error(o(364));return _}if(x=Ne(x),x===null)throw Error(o(362));return x.stateNode.current}function jC(x,_){switch(_.$$typeof){case Mw:if(x.type===_.value)return!0;break;case Ew:e:{_=_.value,x=[x,0];for(var C=0;C<x.length;){var D=x[C++],I=x[C++],V=_[I];if(D.tag!==5||!te(D)){for(;V!=null&&jC(D,V);)I++,V=_[I];if(I===_.length){_=!0;break e}else for(D=D.child;D!==null;)x.push(D,I),D=D.sibling}}_=!1}return _;case Cw:if(x.tag===5&&we(x.stateNode,_.value))return!0;break;case Pw:if((x.tag===5||x.tag===6)&&(x=L(x),x!==null&&0<=x.indexOf(_.value)))return!0;break;case Tw:if(x.tag===5&&(x=x.memoizedProps["data-testname"],typeof x=="string"&&x.toLowerCase()===_.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function WC(x){switch(x.$$typeof){case Mw:return"<"+(T(x.value)||"Unknown")+">";case Ew:return":has("+(WC(x)||"")+")";case Cw:return'[role="'+x.value+'"]';case Pw:return'"'+x.value+'"';case Tw:return'[data-testname="'+x.value+'"]';default:throw Error(o(365))}}function BU(x,_){var C=[];x=[x,0];for(var D=0;D<x.length;){var I=x[D++],V=x[D++],pe=_[V];if(I.tag!==5||!te(I)){for(;pe!=null&&jC(I,pe);)V++,pe=_[V];if(V===_.length)C.push(I);else for(I=I.child;I!==null;)x.push(I,V),I=I.sibling}}return C}function XC(x,_){if(!Ue)throw Error(o(363));x=VC(x),x=BU(x,_),_=[],x=Array.from(x);for(var C=0;C<x.length;){var D=x[C++];if(D.tag===5)te(D)||_.push(D.stateNode);else for(D=D.child;D!==null;)x.push(D),D=D.sibling}return _}var rte=Math.ceil,Dw=a.ReactCurrentDispatcher,YC=a.ReactCurrentOwner,Ai=a.ReactCurrentBatchConfig,rn=0,Ii=null,Bi=null,Er=0,qs=0,pp=ar(0),Xi=0,Yv=null,mp=0,Rw=0,qC=0,qv=null,Ss=null,QC=0,KC=1/0;function gp(){KC=lr()+500}var Lw=!1,JC=null,_u=null,Iw=!1,bu=null,Bw=0,Qv=0,ZC=null,Ow=-1,Fw=0;function ns(){return rn&6?lr():Ow!==-1?Ow:Ow=lr()}function Su(x){return x.mode&1?rn&2&&Er!==0?Er&-Er:zee.transition!==null?(Fw===0&&(x=Q1,Q1<<=1,!(Q1&4194240)&&(Q1=64),Fw=x),Fw):(x=xn,x!==0?x:Ae()):1}function Io(x,_,C){if(50<Qv)throw Qv=0,ZC=null,Error(o(185));var D=Nw(x,_);return D===null?null:(Lv(D,_,C),(!(rn&2)||D!==Ii)&&(D===Ii&&(!(rn&2)&&(Rw|=_),Xi===4&&Au(D,Er)),As(D,C),_===1&&rn===0&&!(x.mode&1)&&(gp(),$1&&hl())),D)}function Nw(x,_){x.lanes|=_;var C=x.alternate;for(C!==null&&(C.lanes|=_),C=x,x=x.return;x!==null;)x.childLanes|=_,C=x.alternate,C!==null&&(C.childLanes|=_),C=x,x=x.return;return C.tag===3?C.stateNode:null}function As(x,_){var C=x.callbackNode;Ree(x,_);var D=J1(x,x===Ii?Er:0);if(D===0)C!==null&&wN(C),x.callbackNode=null,x.callbackPriority=0;else if(_=D&-D,x.callbackPriority!==_){if(C!=null&&wN(C),_===1)x.tag===0?kee(FU.bind(null,x)):_N(FU.bind(null,x)),Ee?Re(function(){rn===0&&hl()}):oC(aC,hl),C=null;else{switch(xN(D)){case 1:C=aC;break;case 4:C=Oee;break;case 16:C=lC;break;case 536870912:C=Fee;break;default:C=lC}C=WU(C,OU.bind(null,x))}x.callbackPriority=_,x.callbackNode=C}}function OU(x,_){if(Ow=-1,Fw=0,rn&6)throw Error(o(327));var C=x.callbackNode;if(md()&&x.callbackNode!==C)return null;var D=J1(x,x===Ii?Er:0);if(D===0)return null;if(D&30||D&x.expiredLanes||_)_=Uw(x,D);else{_=D;var I=rn;rn|=2;var V=kU();(Ii!==x||Er!==_)&&(gp(),fd(x,_));do try{ate();break}catch(Ce){UU(x,Ce)}while(1);hC(),Dw.current=V,rn=I,Bi!==null?_=0:(Ii=null,Er=0,_=Xi)}if(_!==0){if(_===2&&(I=iC(x),I!==0&&(D=I,_=$C(x,I))),_===1)throw C=Yv,fd(x,0),Au(x,D),As(x,lr()),C;if(_===6)Au(x,D);else{if(I=x.current.alternate,!(D&30)&&!ste(I)&&(_=Uw(x,D),_===2&&(V=iC(x),V!==0&&(D=V,_=$C(x,V))),_===1))throw C=Yv,fd(x,0),Au(x,D),As(x,lr()),C;switch(x.finishedWork=I,x.finishedLanes=D,_){case 0:case 1:throw Error(o(345));case 2:pd(x,Ss);break;case 3:if(Au(x,D),(D&130023424)===D&&(_=QC+500-lr(),10<_)){if(J1(x,0)!==0)break;if(I=x.suspendedLanes,(I&D)!==D){ns(),x.pingedLanes|=x.suspendedLanes&I;break}x.timeoutHandle=K(pd.bind(null,x,Ss),_);break}pd(x,Ss);break;case 4:if(Au(x,D),(D&4194240)===D)break;for(_=x.eventTimes,I=-1;0<D;){var pe=31-ya(D);V=1<<pe,pe=_[pe],pe>I&&(I=pe),D&=~V}if(D=I,D=lr()-D,D=(120>D?120:480>D?480:1080>D?1080:1920>D?1920:3e3>D?3e3:4320>D?4320:1960*rte(D/1960))-D,10<D){x.timeoutHandle=K(pd.bind(null,x,Ss),D);break}pd(x,Ss);break;case 5:pd(x,Ss);break;default:throw Error(o(329))}}}return As(x,lr()),x.callbackNode===C?OU.bind(null,x):null}function $C(x,_){var C=qv;return x.current.memoizedState.isDehydrated&&(fd(x,_).flags|=256),x=Uw(x,_),x!==2&&(_=Ss,Ss=C,_!==null&&eT(_)),x}function eT(x){Ss===null?Ss=x:Ss.push.apply(Ss,x)}function ste(x){for(var _=x;;){if(_.flags&16384){var C=_.updateQueue;if(C!==null&&(C=C.stores,C!==null))for(var D=0;D<C.length;D++){var I=C[D],V=I.getSnapshot;I=I.value;try{if(!ul(V(),I))return!1}catch{return!1}}}if(C=_.child,_.subtreeFlags&16384&&C!==null)C.return=_,_=C;else{if(_===x)break;for(;_.sibling===null;){if(_.return===null||_.return===x)return!0;_=_.return}_.sibling.return=_.return,_=_.sibling}}return!0}function Au(x,_){for(_&=~qC,_&=~Rw,x.suspendedLanes|=_,x.pingedLanes&=~_,x=x.expirationTimes;0<_;){var C=31-ya(_),D=1<<C;x[C]=-1,_&=~D}}function FU(x){if(rn&6)throw Error(o(327));md();var _=J1(x,0);if(!(_&1))return As(x,lr()),null;var C=Uw(x,_);if(x.tag!==0&&C===2){var D=iC(x);D!==0&&(_=D,C=$C(x,D))}if(C===1)throw C=Yv,fd(x,0),Au(x,_),As(x,lr()),C;if(C===6)throw Error(o(345));return x.finishedWork=x.current.alternate,x.finishedLanes=_,pd(x,Ss),As(x,lr()),null}function NU(x){bu!==null&&bu.tag===0&&!(rn&6)&&md();var _=rn;rn|=1;var C=Ai.transition,D=xn;try{if(Ai.transition=null,xn=1,x)return x()}finally{xn=D,Ai.transition=C,rn=_,!(rn&6)&&hl()}}function tT(){qs=pp.current,Gt(pp)}function fd(x,_){x.finishedWork=null,x.finishedLanes=0;var C=x.timeoutHandle;if(C!==ve&&(x.timeoutHandle=ve,oe(C)),Bi!==null)for(C=Bi.return;C!==null;){var D=C;switch(yC(D),D.tag){case 1:D=D.type.childContextTypes,D!=null&&Y1();break;case 3:dp(),Gt(yn),Gt(dn),MC();break;case 5:SC(D);break;case 4:dp();break;case 13:Gt(ri);break;case 19:Gt(ri);break;case 10:dC(D.type._context);break;case 22:case 23:tT()}C=C.return}if(Ii=x,Bi=x=Mu(x.current,null),Er=qs=_,Xi=0,Yv=null,qC=Rw=mp=0,Ss=qv=null,dl!==null){for(_=0;_<dl.length;_++)if(C=dl[_],D=C.interleaved,D!==null){C.interleaved=null;var I=D.next,V=C.pending;if(V!==null){var pe=V.next;V.next=I,D.next=pe}C.pending=D}dl=null}return x}function UU(x,_){do{var C=Bi;try{if(hC(),uw.current=gw,hw){for(var D=pi.memoizedState;D!==null;){var I=D.queue;I!==null&&(I.pending=null),D=D.next}hw=!1}if(fp=0,cr=Nr=pi=null,Uv=!1,kv=0,YC.current=null,C===null||C.return===null){Xi=1,Yv=_,Bi=null;break}e:{var V=x,pe=C.return,Ce=C,je=_;if(_=Er,Ce.flags|=32768,je!==null&&typeof je=="object"&&typeof je.then=="function"){var et=je,mt=Ce,Xt=mt.tag;if(!(mt.mode&1)&&(Xt===0||Xt===11||Xt===15)){var Tt=mt.alternate;Tt?(mt.updateQueue=Tt.updateQueue,mt.memoizedState=Tt.memoizedState,mt.lanes=Tt.lanes):(mt.updateQueue=null,mt.memoizedState=null)}var kn=sU(pe);if(kn!==null){kn.flags&=-257,oU(kn,pe,Ce,V,_),kn.mode&1&&rU(V,et,_),_=kn,je=et;var St=_.updateQueue;if(St===null){var zr=new Set;zr.add(je),_.updateQueue=zr}else St.add(je);break e}else{if(!(_&1)){rU(V,et,_),nT();break e}je=Error(o(426))}}else if(Zn&&Ce.mode&1){var Oo=sU(pe);if(Oo!==null){!(Oo.flags&65536)&&(Oo.flags|=256),oU(Oo,pe,Ce,V,_),_C(je);break e}}V=je,Xi!==4&&(Xi=2),qv===null?qv=[V]:qv.push(V),je=LC(je,Ce),Ce=pe;do{switch(Ce.tag){case 3:Ce.flags|=65536,_&=-_,Ce.lanes|=_;var Fe=nU(Ce,je,_);AN(Ce,Fe);break e;case 1:V=je;var Pe=Ce.type,He=Ce.stateNode;if(!(Ce.flags&128)&&(typeof Pe.getDerivedStateFromError=="function"||He!==null&&typeof He.componentDidCatch=="function"&&(_u===null||!_u.has(He)))){Ce.flags|=65536,_&=-_,Ce.lanes|=_;var ct=iU(Ce,V,_);AN(Ce,ct);break e}}Ce=Ce.return}while(Ce!==null)}GU(C)}catch(bt){_=bt,Bi===C&&C!==null&&(Bi=C=C.return);continue}break}while(1)}function kU(){var x=Dw.current;return Dw.current=gw,x===null?gw:x}function nT(){(Xi===0||Xi===3||Xi===2)&&(Xi=4),Ii===null||!(mp&268435455)&&!(Rw&268435455)||Au(Ii,Er)}function Uw(x,_){var C=rn;rn|=2;var D=kU();Ii===x&&Er===_||fd(x,_);do try{ote();break}catch(I){UU(x,I)}while(1);if(hC(),rn=C,Dw.current=D,Bi!==null)throw Error(o(261));return Ii=null,Er=0,Xi}function ote(){for(;Bi!==null;)zU(Bi)}function ate(){for(;Bi!==null&&!Iee();)zU(Bi)}function zU(x){var _=jU(x.alternate,x,qs);x.memoizedProps=x.pendingProps,_===null?GU(x):Bi=_,YC.current=null}function GU(x){var _=x;do{var C=_.alternate;if(x=_.return,_.flags&32768){if(C=$ee(C,_),C!==null){C.flags&=32767,Bi=C;return}if(x!==null)x.flags|=32768,x.subtreeFlags=0,x.deletions=null;else{Xi=6,Bi=null;return}}else if(C=Kee(C,_,qs),C!==null){Bi=C;return}if(_=_.sibling,_!==null){Bi=_;return}Bi=_=x}while(_!==null);Xi===0&&(Xi=5)}function pd(x,_){var C=xn,D=Ai.transition;try{Ai.transition=null,xn=1,lte(x,_,C)}finally{Ai.transition=D,xn=C}return null}function lte(x,_,C){do md();while(bu!==null);if(rn&6)throw Error(o(327));var D=x.finishedWork,I=x.finishedLanes;if(D===null)return null;if(x.finishedWork=null,x.finishedLanes=0,D===x.current)throw Error(o(177));x.callbackNode=null,x.callbackPriority=0;var V=D.lanes|D.childLanes;if(Lee(x,V),x===Ii&&(Bi=Ii=null,Er=0),!(D.subtreeFlags&2064)&&!(D.flags&2064)||Iw||(Iw=!0,WU(lC,function(){return md(),null})),V=(D.flags&15990)!==0,D.subtreeFlags&15990||V){V=Ai.transition,Ai.transition=null;var pe=xn;xn=1;var Ce=rn;rn|=4,YC.current=null,tte(x,D),nte(x,D),H(x.containerInfo),x.current=D,ite(D),Bee(),rn=Ce,xn=pe,Ai.transition=V}else x.current=D;if(Iw&&(Iw=!1,bu=x,Bw=I),V=x.pendingLanes,V===0&&(_u=null),Nee(D.stateNode),As(x,lr()),_!==null)for(C=x.onRecoverableError,D=0;D<_.length;D++)C(_[D]);if(Lw)throw Lw=!1,x=JC,JC=null,x;return Bw&1&&x.tag!==0&&md(),V=x.pendingLanes,V&1?x===ZC?Qv++:(Qv=0,ZC=x):Qv=0,hl(),null}function md(){if(bu!==null){var x=xN(Bw),_=Ai.transition,C=xn;try{if(Ai.transition=null,xn=16>x?16:x,bu===null)var D=!1;else{if(x=bu,bu=null,Bw=0,rn&6)throw Error(o(331));var I=rn;for(rn|=4,at=x.current;at!==null;){var V=at,pe=V.child;if(at.flags&16){var Ce=V.deletions;if(Ce!==null){for(var je=0;je<Ce.length;je++){var et=Ce[je];for(at=et;at!==null;){var mt=at;switch(mt.tag){case 0:case 11:case 15:dd(8,mt,V)}var Xt=mt.child;if(Xt!==null)Xt.return=mt,at=Xt;else for(;at!==null;){mt=at;var Tt=mt.sibling,kn=mt.return;if(MU(mt),mt===et){at=null;break}if(Tt!==null){Tt.return=kn,at=Tt;break}at=kn}}}var St=V.alternate;if(St!==null){var zr=St.child;if(zr!==null){St.child=null;do{var Oo=zr.sibling;zr.sibling=null,zr=Oo}while(zr!==null)}}at=V}}if(V.subtreeFlags&2064&&pe!==null)pe.return=V,at=pe;else e:for(;at!==null;){if(V=at,V.flags&2048)switch(V.tag){case 0:case 11:case 15:dd(9,V,V.return)}var Fe=V.sibling;if(Fe!==null){Fe.return=V.return,at=Fe;break e}at=V.return}}var Pe=x.current;for(at=Pe;at!==null;){pe=at;var He=pe.child;if(pe.subtreeFlags&2064&&He!==null)He.return=pe,at=He;else e:for(pe=Pe;at!==null;){if(Ce=at,Ce.flags&2048)try{switch(Ce.tag){case 0:case 11:case 15:Wv(9,Ce)}}catch(bt){Ms(Ce,Ce.return,bt)}if(Ce===pe){at=null;break e}var ct=Ce.sibling;if(ct!==null){ct.return=Ce.return,at=ct;break e}at=Ce.return}}if(rn=I,hl(),cl&&typeof cl.onPostCommitFiberRoot=="function")try{cl.onPostCommitFiberRoot(Z1,x)}catch{}D=!0}return D}finally{xn=C,Ai.transition=_}}return!1}function HU(x,_,C){_=LC(C,_),_=nU(x,_,1),wu(x,_),_=ns(),x=Nw(x,1),x!==null&&(Lv(x,1,_),As(x,_))}function Ms(x,_,C){if(x.tag===3)HU(x,x,C);else for(;_!==null;){if(_.tag===3){HU(_,x,C);break}else if(_.tag===1){var D=_.stateNode;if(typeof _.type.getDerivedStateFromError=="function"||typeof D.componentDidCatch=="function"&&(_u===null||!_u.has(D))){x=LC(C,x),x=iU(_,x,1),wu(_,x),x=ns(),_=Nw(_,1),_!==null&&(Lv(_,1,x),As(_,x));break}}_=_.return}}function cte(x,_,C){var D=x.pingCache;D!==null&&D.delete(_),_=ns(),x.pingedLanes|=x.suspendedLanes&C,Ii===x&&(Er&C)===C&&(Xi===4||Xi===3&&(Er&130023424)===Er&&500>lr()-QC?fd(x,0):qC|=C),As(x,_)}function VU(x,_){_===0&&(x.mode&1?(_=K1,K1<<=1,!(K1&130023424)&&(K1=4194304)):_=1);var C=ns();x=Nw(x,_),x!==null&&(Lv(x,_,C),As(x,C))}function ute(x){var _=x.memoizedState,C=0;_!==null&&(C=_.retryLane),VU(x,C)}function hte(x,_){var C=0;switch(x.tag){case 13:var D=x.stateNode,I=x.memoizedState;I!==null&&(C=I.retryLane);break;case 19:D=x.stateNode;break;default:throw Error(o(314))}D!==null&&D.delete(_),VU(x,C)}var jU;jU=function(x,_,C){if(x!==null)if(x.memoizedProps!==_.pendingProps||yn.current)Ys=!0;else{if(!(x.lanes&C)&&!(_.flags&128))return Ys=!1,Zee(x,_,C);Ys=!!(x.flags&131072)}else Ys=!1,Zn&&_.flags&1048576&&DN(_,aw,_.index);switch(_.lanes=0,_.tag){case 2:var D=_.type;x!==null&&(x.alternate=null,_.alternate=null,_.flags|=2),x=_.pendingProps;var I=va(_,dn.current);op(_,C),I=CC(null,_,D,x,I,C);var V=TC();return _.flags|=1,typeof I=="object"&&I!==null&&typeof I.render=="function"&&I.$$typeof===void 0?(_.tag=1,_.memoizedState=null,_.updateQueue=null,Mr(D)?(V=!0,q1(_)):V=!1,_.memoizedState=I.state!==null&&I.state!==void 0?I.state:null,pC(_),I.updater=sw,_.stateNode=I,I._reactInternals=_,gC(_,D,x,C),_=OC(null,_,D,!0,V,C)):(_.tag=0,Zn&&V&&vC(_),ts(null,_,I,C),_=_.child),_;case 16:D=_.elementType;e:{switch(x!==null&&(x.alternate=null,_.alternate=null,_.flags|=2),x=_.pendingProps,I=D._init,D=I(D._payload),_.type=D,I=_.tag=fte(D),x=xa(D,x),I){case 0:_=BC(null,_,D,x,C);break e;case 1:_=pU(null,_,D,x,C);break e;case 11:_=cU(null,_,D,x,C);break e;case 14:_=uU(null,_,D,xa(D.type,x),C);break e}throw Error(o(306,D,""))}return _;case 0:return D=_.type,I=_.pendingProps,I=_.elementType===D?I:xa(D,I),BC(x,_,D,I,C);case 1:return D=_.type,I=_.pendingProps,I=_.elementType===D?I:xa(D,I),pU(x,_,D,I,C);case 3:e:{if(mU(_),x===null)throw Error(o(387));D=_.pendingProps,V=_.memoizedState,I=V.element,SN(x,_),rw(_,D,null,C);var pe=_.memoizedState;if(D=pe.element,ie&&V.isDehydrated)if(V={element:D,isDehydrated:!1,cache:pe.cache,transitions:pe.transitions},_.updateQueue.baseState=V,_.memoizedState=V,_.flags&256){I=Error(o(423)),_=gU(x,_,D,C,I);break e}else if(D!==I){I=Error(o(424)),_=gU(x,_,D,C,I);break e}else for(ie&&(Xs=le(_.stateNode.containerInfo),Ws=_,Zn=!0,wa=null,Iv=!1),C=FN(_,null,D,C),_.child=C;C;)C.flags=C.flags&-3|4096,C=C.sibling;else{if(cp(),D===I){_=mc(x,_,C);break e}ts(x,_,D,C)}_=_.child}return _;case 5:return NN(_),x===null&&wC(_),D=_.type,I=_.pendingProps,V=x!==null?x.memoizedProps:null,pe=I.children,re(D,I)?pe=null:V!==null&&re(D,V)&&(_.flags|=32),fU(x,_),ts(x,_,pe,C),_.child;case 6:return x===null&&wC(_),null;case 13:return vU(x,_,C);case 4:return bC(_,_.stateNode.containerInfo),D=_.pendingProps,x===null?_.child=up(_,null,D,C):ts(x,_,D,C),_.child;case 11:return D=_.type,I=_.pendingProps,I=_.elementType===D?I:xa(D,I),cU(x,_,D,I,C);case 7:return ts(x,_,_.pendingProps,C),_.child;case 8:return ts(x,_,_.pendingProps.children,C),_.child;case 12:return ts(x,_,_.pendingProps.children,C),_.child;case 10:e:{if(D=_.type._context,I=_.pendingProps,V=_.memoizedProps,pe=I.value,bN(_,D,pe),V!==null)if(ul(V.value,pe)){if(V.children===I.children&&!yn.current){_=mc(x,_,C);break e}}else for(V=_.child,V!==null&&(V.return=_);V!==null;){var Ce=V.dependencies;if(Ce!==null){pe=V.child;for(var je=Ce.firstContext;je!==null;){if(je.context===D){if(V.tag===1){je=hc(-1,C&-C),je.tag=2;var et=V.updateQueue;if(et!==null){et=et.shared;var mt=et.pending;mt===null?je.next=je:(je.next=mt.next,mt.next=je),et.pending=je}}V.lanes|=C,je=V.alternate,je!==null&&(je.lanes|=C),fC(V.return,C,_),Ce.lanes|=C;break}je=je.next}}else if(V.tag===10)pe=V.type===_.type?null:V.child;else if(V.tag===18){if(pe=V.return,pe===null)throw Error(o(341));pe.lanes|=C,Ce=pe.alternate,Ce!==null&&(Ce.lanes|=C),fC(pe,C,_),pe=V.sibling}else pe=V.child;if(pe!==null)pe.return=V;else for(pe=V;pe!==null;){if(pe===_){pe=null;break}if(V=pe.sibling,V!==null){V.return=pe.return,pe=V;break}pe=pe.return}V=pe}ts(x,_,I.children,C),_=_.child}return _;case 9:return I=_.type,D=_.pendingProps.children,op(_,C),I=To(I),D=D(I),_.flags|=1,ts(x,_,D,C),_.child;case 14:return D=_.type,I=xa(D,_.pendingProps),I=xa(D.type,I),uU(x,_,D,I,C);case 15:return hU(x,_,_.type,_.pendingProps,C);case 17:return D=_.type,I=_.pendingProps,I=_.elementType===D?I:xa(D,I),x!==null&&(x.alternate=null,_.alternate=null,_.flags|=2),_.tag=1,Mr(D)?(x=!0,q1(_)):x=!1,op(_,C),TN(_,D,I),gC(_,D,I,C),OC(null,_,D,!0,x,C);case 19:return _U(x,_,C);case 22:return dU(x,_,C)}throw Error(o(156,_.tag))};function WU(x,_){return oC(x,_)}function dte(x,_,C,D){this.tag=x,this.key=C,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=_,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=D,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bo(x,_,C,D){return new dte(x,_,C,D)}function iT(x){return x=x.prototype,!(!x||!x.isReactComponent)}function fte(x){if(typeof x=="function")return iT(x)?1:0;if(x!=null){if(x=x.$$typeof,x===v)return 11;if(x===y)return 14}return 2}function Mu(x,_){var C=x.alternate;return C===null?(C=Bo(x.tag,_,x.key,x.mode),C.elementType=x.elementType,C.type=x.type,C.stateNode=x.stateNode,C.alternate=x,x.alternate=C):(C.pendingProps=_,C.type=x.type,C.flags=0,C.subtreeFlags=0,C.deletions=null),C.flags=x.flags&14680064,C.childLanes=x.childLanes,C.lanes=x.lanes,C.child=x.child,C.memoizedProps=x.memoizedProps,C.memoizedState=x.memoizedState,C.updateQueue=x.updateQueue,_=x.dependencies,C.dependencies=_===null?null:{lanes:_.lanes,firstContext:_.firstContext},C.sibling=x.sibling,C.index=x.index,C.ref=x.ref,C}function kw(x,_,C,D,I,V){var pe=2;if(D=x,typeof x=="function")iT(x)&&(pe=1);else if(typeof x=="string")pe=5;else e:switch(x){case h:return gd(C.children,I,V,_);case u:pe=8,I|=8;break;case d:return x=Bo(12,C,_,I|2),x.elementType=d,x.lanes=V,x;case g:return x=Bo(13,C,_,I),x.elementType=g,x.lanes=V,x;case m:return x=Bo(19,C,_,I),x.elementType=m,x.lanes=V,x;case b:return zw(C,I,V,_);default:if(typeof x=="object"&&x!==null)switch(x.$$typeof){case f:pe=10;break e;case p:pe=9;break e;case v:pe=11;break e;case y:pe=14;break e;case w:pe=16,D=null;break e}throw Error(o(130,x==null?x:typeof x,""))}return _=Bo(pe,C,_,I),_.elementType=x,_.type=D,_.lanes=V,_}function gd(x,_,C,D){return x=Bo(7,x,D,_),x.lanes=C,x}function zw(x,_,C,D){return x=Bo(22,x,D,_),x.elementType=b,x.lanes=C,x.stateNode={},x}function rT(x,_,C){return x=Bo(6,x,null,_),x.lanes=C,x}function sT(x,_,C){return _=Bo(4,x.children!==null?x.children:[],x.key,_),_.lanes=C,_.stateNode={containerInfo:x.containerInfo,pendingChildren:null,implementation:x.implementation},_}function pte(x,_,C,D,I){this.tag=_,this.containerInfo=x,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ve,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rC(0),this.expirationTimes=rC(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rC(0),this.identifierPrefix=D,this.onRecoverableError=I,ie&&(this.mutableSourceEagerHydrationData=null)}function XU(x,_,C,D,I,V,pe,Ce,je){return x=new pte(x,_,C,Ce,je),_===1?(_=1,V===!0&&(_|=8)):_=0,V=Bo(3,null,null,_),x.current=V,V.stateNode=x,V.memoizedState={element:D,isDehydrated:C,cache:null,transitions:null},pC(V),x}function YU(x){if(!x)return Li;x=x._reactInternals;e:{if(E(x)!==x||x.tag!==1)throw Error(o(170));var _=x;do{switch(_.tag){case 3:_=_.stateNode.context;break e;case 1:if(Mr(_.type)){_=_.stateNode.__reactInternalMemoizedMergedChildContext;break e}}_=_.return}while(_!==null);throw Error(o(171))}if(x.tag===1){var C=x.type;if(Mr(C))return vN(x,C,_)}return _}function qU(x){var _=x._reactInternals;if(_===void 0)throw typeof x.render=="function"?Error(o(188)):(x=Object.keys(x).join(","),Error(o(268,x)));return x=F(_),x===null?null:x.stateNode}function QU(x,_){if(x=x.memoizedState,x!==null&&x.dehydrated!==null){var C=x.retryLane;x.retryLane=C!==0&&C<_?C:_}}function oT(x,_){QU(x,_),(x=x.alternate)&&QU(x,_)}function mte(x){return x=F(x),x===null?null:x.stateNode}function gte(){return null}return n.attemptContinuousHydration=function(x){if(x.tag===13){var _=ns();Io(x,134217728,_),oT(x,134217728)}},n.attemptHydrationAtCurrentPriority=function(x){if(x.tag===13){var _=ns(),C=Su(x);Io(x,C,_),oT(x,C)}},n.attemptSynchronousHydration=function(x){switch(x.tag){case 3:var _=x.stateNode;if(_.current.memoizedState.isDehydrated){var C=Rv(_.pendingLanes);C!==0&&(sC(_,C|1),As(_,lr()),!(rn&6)&&(gp(),hl()))}break;case 13:var D=ns();NU(function(){return Io(x,1,D)}),oT(x,1)}},n.batchedUpdates=function(x,_){var C=rn;rn|=1;try{return x(_)}finally{rn=C,rn===0&&(gp(),$1&&hl())}},n.createComponentSelector=function(x){return{$$typeof:Mw,value:x}},n.createContainer=function(x,_,C,D,I,V,pe){return XU(x,_,!1,null,C,D,I,V,pe)},n.createHasPseudoClassSelector=function(x){return{$$typeof:Ew,value:x}},n.createHydrationContainer=function(x,_,C,D,I,V,pe,Ce,je){return x=XU(C,D,!0,x,I,V,pe,Ce,je),x.context=YU(null),C=x.current,D=ns(),I=Su(C),V=hc(D,I),V.callback=_??null,wu(C,V),x.current.lanes=I,Lv(x,I,D),As(x,D),x},n.createPortal=function(x,_,C){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:D==null?null:""+D,children:x,containerInfo:_,implementation:C}},n.createRoleSelector=function(x){return{$$typeof:Cw,value:x}},n.createTestNameSelector=function(x){return{$$typeof:Tw,value:x}},n.createTextSelector=function(x){return{$$typeof:Pw,value:x}},n.deferredUpdates=function(x){var _=xn,C=Ai.transition;try{return Ai.transition=null,xn=16,x()}finally{xn=_,Ai.transition=C}},n.discreteUpdates=function(x,_,C,D,I){var V=xn,pe=Ai.transition;try{return Ai.transition=null,xn=1,x(_,C,D,I)}finally{xn=V,Ai.transition=pe,rn===0&&gp()}},n.findAllNodes=XC,n.findBoundingRects=function(x,_){if(!Ue)throw Error(o(363));_=XC(x,_),x=[];for(var C=0;C<_.length;C++)x.push(U(_[C]));for(_=x.length-1;0<_;_--){C=x[_];for(var D=C.x,I=D+C.width,V=C.y,pe=V+C.height,Ce=_-1;0<=Ce;Ce--)if(_!==Ce){var je=x[Ce],et=je.x,mt=et+je.width,Xt=je.y,Tt=Xt+je.height;if(D>=et&&V>=Xt&&I<=mt&&pe<=Tt){x.splice(_,1);break}else if(D!==et||C.width!==je.width||Tt<V||Xt>pe){if(!(V!==Xt||C.height!==je.height||mt<D||et>I)){et>D&&(je.width+=et-D,je.x=D),mt<I&&(je.width=I-et),x.splice(_,1);break}}else{Xt>V&&(je.height+=Xt-V,je.y=V),Tt<pe&&(je.height=pe-Xt),x.splice(_,1);break}}}return x},n.findHostInstance=qU,n.findHostInstanceWithNoPortals=function(x){return x=R(x),x=x!==null?k(x):null,x===null?null:x.stateNode},n.findHostInstanceWithWarning=function(x){return qU(x)},n.flushControlled=function(x){var _=rn;rn|=1;var C=Ai.transition,D=xn;try{Ai.transition=null,xn=1,x()}finally{xn=D,Ai.transition=C,rn=_,rn===0&&(gp(),hl())}},n.flushPassiveEffects=md,n.flushSync=NU,n.focusWithin=function(x,_){if(!Ue)throw Error(o(363));for(x=VC(x),_=BU(x,_),_=Array.from(_),x=0;x<_.length;){var C=_[x++];if(!te(C)){if(C.tag===5&&Te(C.stateNode))return!0;for(C=C.child;C!==null;)_.push(C),C=C.sibling}}return!1},n.getCurrentUpdatePriority=function(){return xn},n.getFindAllNodesFailureDescription=function(x,_){if(!Ue)throw Error(o(363));var C=0,D=[];x=[VC(x),0];for(var I=0;I<x.length;){var V=x[I++],pe=x[I++],Ce=_[pe];if((V.tag!==5||!te(V))&&(jC(V,Ce)&&(D.push(WC(Ce)),pe++,pe>C&&(C=pe)),pe<_.length))for(V=V.child;V!==null;)x.push(V,pe),V=V.sibling}if(C<_.length){for(x=[];C<_.length;C++)x.push(WC(_[C]));return`findAllNodes was able to match part of the selector:
  `+(D.join(" > ")+`

No matching component was found for:
  `)+x.join(" > ")}return null},n.getPublicRootInstance=function(x){if(x=x.current,!x.child)return null;switch(x.child.tag){case 5:return Z(x.child.stateNode);default:return x.child.stateNode}},n.injectIntoDevTools=function(x){if(x={bundleType:x.bundleType,version:x.version,rendererPackageName:x.rendererPackageName,rendererConfig:x.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:mte,findFiberByHostInstance:x.findFiberByHostInstance||gte,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")x=!1;else{var _=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(_.isDisabled||!_.supportsFiber)x=!0;else{try{Z1=_.inject(x),cl=_}catch{}x=!!_.checkDCE}}return x},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(x,_,C,D){if(!Ue)throw Error(o(363));x=XC(x,_);var I=Ie(x,C,D).disconnect;return{disconnect:function(){I()}}},n.registerMutableSourceForHydration=function(x,_){var C=_._getVersion;C=C(_._source),x.mutableSourceEagerHydrationData==null?x.mutableSourceEagerHydrationData=[_,C]:x.mutableSourceEagerHydrationData.push(_,C)},n.runWithPriority=function(x,_){var C=xn;try{return xn=x,_()}finally{xn=C}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(x,_,C,D){var I=_.current,V=ns(),pe=Su(I);return C=YU(C),_.context===null?_.context=C:_.pendingContext=C,_=hc(V,pe),_.payload={element:x},D=D===void 0?null:D,D!==null&&(_.callback=D),wu(I,_),x=Io(I,pe,V),x!==null&&iw(x,I,pe),pe},n};DY.exports=jde;var Wde=DY.exports;const Xde=Zx(Wde);var RY={exports:{}},LY={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(O,W){var H=O.length;O.push(W);e:for(;0<H;){var Y=H-1>>>1,z=O[Y];if(0<r(z,W))O[Y]=W,O[H]=z,H=Y;else break e}}function n(O){return O.length===0?null:O[0]}function i(O){if(O.length===0)return null;var W=O[0],H=O.pop();if(H!==W){O[0]=H;e:for(var Y=0,z=O.length,X=z>>>1;Y<X;){var q=2*(Y+1)-1,re=O[q],G=q+1,K=O[G];if(0>r(re,H))G<z&&0>r(K,re)?(O[Y]=K,O[G]=H,Y=G):(O[Y]=re,O[q]=H,Y=q);else if(G<z&&0>r(K,H))O[Y]=K,O[G]=H,Y=G;else break e}}return W}function r(O,W){var H=O.sortIndex-W.sortIndex;return H!==0?H:O.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,u=null,d=3,f=!1,p=!1,v=!1,g=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(O){for(var W=n(c);W!==null;){if(W.callback===null)i(c);else if(W.startTime<=O)i(c),W.sortIndex=W.expirationTime,e(l,W);else break;W=n(c)}}function b(O){if(v=!1,w(O),!p)if(n(l)!==null)p=!0,Z(A);else{var W=n(c);W!==null&&ee(b,W.startTime-O)}}function A(O,W){p=!1,v&&(v=!1,m(M),M=-1),f=!0;var H=d;try{for(w(W),u=n(l);u!==null&&(!(u.expirationTime>W)||O&&!R());){var Y=u.callback;if(typeof Y=="function"){u.callback=null,d=u.priorityLevel;var z=Y(u.expirationTime<=W);W=t.unstable_now(),typeof z=="function"?u.callback=z:u===n(l)&&i(l),w(W)}else i(l);u=n(l)}if(u!==null)var X=!0;else{var q=n(c);q!==null&&ee(b,q.startTime-W),X=!1}return X}finally{u=null,d=H,f=!1}}var S=!1,T=null,M=-1,E=5,P=-1;function R(){return!(t.unstable_now()-P<E)}function F(){if(T!==null){var O=t.unstable_now();P=O;var W=!0;try{W=T(!0,O)}finally{W?B():(S=!1,T=null)}}else S=!1}var B;if(typeof y=="function")B=function(){y(F)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,j=k.port2;k.port1.onmessage=F,B=function(){j.postMessage(null)}}else B=function(){g(F,0)};function Z(O){T=O,S||(S=!0,B())}function ee(O,W){M=g(function(){O(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,Z(A))},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(O){switch(d){case 1:case 2:case 3:var W=3;break;default:W=d}var H=d;d=W;try{return O()}finally{d=H}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(O,W){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var H=d;d=O;try{return W()}finally{d=H}},t.unstable_scheduleCallback=function(O,W,H){var Y=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?Y+H:Y):H=Y,O){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=H+z,O={id:h++,callback:W,priorityLevel:O,startTime:H,expirationTime:z,sortIndex:-1},H>Y?(O.sortIndex=H,e(c,O),n(l)===null&&O===n(c)&&(v?(m(M),M=-1):v=!0,ee(b,H-Y))):(O.sortIndex=z,e(l,O),p||f||(p=!0,Z(A))),O},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(O){var W=d;return function(){var H=d;d=W;try{return O.apply(this,arguments)}finally{d=H}}}})(LY);RY.exports=LY;var z4=RY.exports;function IY(t,e,n=(i,r)=>i===r){if(t===e)return!0;if(!t||!e)return!1;const i=t.length;if(e.length!==i)return!1;for(let r=0;r<i;r++)if(!n(t[r],e[r]))return!1;return!0}const kc=[];function BY(t,e,n=!1,i={}){for(const s of kc)if(IY(e,s.keys,s.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return s.response;if(!n)throw s.promise}const r={keys:e,equal:i.equal,promise:t(...e).then(s=>r.response=s).then(()=>{i.lifespan&&i.lifespan>0&&setTimeout(()=>{const s=kc.indexOf(r);s!==-1&&kc.splice(s,1)},i.lifespan)}).catch(s=>r.error=s)};if(kc.push(r),!n)throw r.promise}const Yde=(t,e,n)=>BY(t,e,!1,n),qde=(t,e,n)=>void BY(t,e,!0,n),Qde=t=>{if(t===void 0||t.length===0)kc.splice(0,kc.length);else{const e=kc.find(n=>IY(t,n.keys,n.equal));if(e){const n=kc.indexOf(e);n!==-1&&kc.splice(n,1)}}},iO={},Kde=t=>void Object.assign(iO,t);function Jde(t,e){function n(h,{args:u=[],attach:d,...f},p){let v=`${h[0].toUpperCase()}${h.slice(1)}`,g;if(h==="primitive"){if(f.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const m=f.object;g=vm(m,{type:h,root:p,attach:d,primitive:!0})}else{const m=iO[v];if(!m)throw new Error(`R3F: ${v} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(u))throw new Error("R3F: The args prop must be an array!");g=vm(new m(...u),{type:h,root:p,attach:d,memoizedProps:{args:u}})}return g.__r3f.attach===void 0&&(g instanceof Kt?g.__r3f.attach="geometry":g instanceof Vi&&(g.__r3f.attach="material")),v!=="inject"&&mP(g,f),g}function i(h,u){let d=!1;if(u){var f,p;(f=u.__r3f)!=null&&f.attach?pP(h,u,u.__r3f.attach):u.isObject3D&&h.isObject3D&&(h.add(u),d=!0),d||(p=h.__r3f)==null||p.objects.push(u),u.__r3f||vm(u,{}),u.__r3f.parent=h,pL(u),ym(u)}}function r(h,u,d){let f=!1;if(u){var p,v;if((p=u.__r3f)!=null&&p.attach)pP(h,u,u.__r3f.attach);else if(u.isObject3D&&h.isObject3D){u.parent=h,u.dispatchEvent({type:"added"});const g=h.children.filter(y=>y!==u),m=g.indexOf(d);h.children=[...g.slice(0,m),u,...g.slice(m)],f=!0}f||(v=h.__r3f)==null||v.objects.push(u),u.__r3f||vm(u,{}),u.__r3f.parent=h,pL(u),ym(u)}}function s(h,u,d=!1){h&&[...h].forEach(f=>o(u,f,d))}function o(h,u,d){if(u){var f,p,v;if(u.__r3f&&(u.__r3f.parent=null),(f=h.__r3f)!=null&&f.objects&&(h.__r3f.objects=h.__r3f.objects.filter(b=>b!==u)),(p=u.__r3f)!=null&&p.attach)W4(h,u,u.__r3f.attach);else if(u.isObject3D&&h.isObject3D){var g;h.remove(u),(g=u.__r3f)!=null&&g.root&&sfe(u.__r3f.root,u)}const y=(v=u.__r3f)==null?void 0:v.primitive,w=d===void 0?u.dispose!==null&&!y:d;if(!y){var m;s((m=u.__r3f)==null?void 0:m.objects,u,w),s(u.children,u,w)}u.__r3f&&(delete u.__r3f.root,delete u.__r3f.objects,delete u.__r3f.handlers,delete u.__r3f.memoizedProps,y||delete u.__r3f),w&&u.dispose&&u.type!=="Scene"&&z4.unstable_scheduleCallback(z4.unstable_IdlePriority,()=>{try{u.dispose()}catch{}}),ym(h)}}function a(h,u,d,f){var p;const v=(p=h.__r3f)==null?void 0:p.parent;if(!v)return;const g=n(u,d,h.__r3f.root);if(h.children){for(const m of h.children)m.__r3f&&i(g,m);h.children=h.children.filter(m=>!m.__r3f)}h.__r3f.objects.forEach(m=>i(g,m)),h.__r3f.objects=[],h.__r3f.autoRemovedBeforeAppend||o(v,h),g.parent&&(g.__r3f.autoRemovedBeforeAppend=!0),i(v,g),g.raycast&&g.__r3f.eventCount&&g.__r3f.root.getState().internal.interaction.push(g),[f,f.alternate].forEach(m=>{m!==null&&(m.stateNode=g,m.ref&&(typeof m.ref=="function"?m.ref(g):m.ref.current=g))})}const l=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:Xde({createInstance:n,removeChild:o,appendChild:i,appendInitialChild:i,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(h,u)=>{if(!u)return;const d=h.getState().scene;d.__r3f&&(d.__r3f.root=h,i(d,u))},removeChildFromContainer:(h,u)=>{u&&o(h.getState().scene,u)},insertInContainerBefore:(h,u,d)=>{if(!u||!d)return;const f=h.getState().scene;f.__r3f&&r(f,u,d)},getRootHostContext:()=>null,getChildHostContext:h=>h,finalizeInitialChildren(h){var u;return!!((u=h==null?void 0:h.__r3f)!=null?u:{}).handlers},prepareUpdate(h,u,d,f){if(h.__r3f.primitive&&f.object&&f.object!==h)return[!0];{const{args:p=[],children:v,...g}=f,{args:m=[],children:y,...w}=d;if(!Array.isArray(p))throw new Error("R3F: the args prop must be an array!");if(p.some((A,S)=>A!==m[S]))return[!0];const b=GY(h,g,w,!0);return b.changes.length?[!1,b]:null}},commitUpdate(h,[u,d],f,p,v,g){u?a(h,f,v,g):mP(h,d)},commitMount(h,u,d,f){var p;const v=(p=h.__r3f)!=null?p:{};h.raycast&&v.handlers&&v.eventCount&&h.__r3f.root.getState().internal.interaction.push(h)},getPublicInstance:h=>h,prepareForCommit:()=>null,preparePortalMount:h=>vm(h.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(h){var u;const{attach:d,parent:f}=(u=h.__r3f)!=null?u:{};d&&f&&W4(f,h,d),h.isObject3D&&(h.visible=!1),ym(h)},unhideInstance(h,u){var d;const{attach:f,parent:p}=(d=h.__r3f)!=null?d:{};f&&p&&pP(p,h,f),(h.isObject3D&&u.visible==null||u.visible)&&(h.visible=!0),ym(h)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():Gm.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&Kn.fun(performance.now)?performance.now:Kn.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Kn.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Kn.fun(clearTimeout)?clearTimeout:void 0}),applyProps:mP}}var G4,H4;const fP=t=>"colorSpace"in t||"outputColorSpace"in t,OY=()=>{var t;return(t=iO.ColorManagement)!=null?t:null},FY=t=>t&&t.isOrthographicCamera,Zde=t=>t&&t.hasOwnProperty("current"),E1=typeof window<"u"&&((G4=window.document)!=null&&G4.createElement||((H4=window.navigator)==null?void 0:H4.product)==="ReactNative")?ge.useLayoutEffect:ge.useEffect;function NY(t){const e=ge.useRef(t);return E1(()=>void(e.current=t),[t]),e}function $de({set:t}){return E1(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}class UY extends ge.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}UY.getDerivedStateFromError=()=>({error:!0});const kY="__default",V4=new Map,efe=t=>t&&!!t.memoized&&!!t.changes;function zY(t){var e;const n=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(t)?Math.min(Math.max(t[0],n),t[1]):t}const p0=t=>{var e;return(e=t.__r3f)==null?void 0:e.root.getState()},Kn={obj:t=>t===Object(t)&&!Kn.arr(t)&&typeof t!="function",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",boo:t=>typeof t=="boolean",und:t=>t===void 0,arr:t=>Array.isArray(t),equ(t,e,{arrays:n="shallow",objects:i="reference",strict:r=!0}={}){if(typeof t!=typeof e||!!t!=!!e)return!1;if(Kn.str(t)||Kn.num(t))return t===e;const s=Kn.obj(t);if(s&&i==="reference")return t===e;const o=Kn.arr(t);if(o&&n==="reference")return t===e;if((o||s)&&t===e)return!0;let a;for(a in t)if(!(a in e))return!1;if(s&&n==="shallow"&&i==="shallow"){for(a in r?e:t)if(!Kn.equ(t[a],e[a],{strict:r,objects:"reference"}))return!1}else for(a in r?e:t)if(t[a]!==e[a])return!1;if(Kn.und(a)){if(o&&t.length===0&&e.length===0||s&&Object.keys(t).length===0&&Object.keys(e).length===0)return!0;if(t!==e)return!1}return!0}};function tfe(t){const e={nodes:{},materials:{}};return t&&t.traverse(n=>{n.name&&(e.nodes[n.name]=n),n.material&&!e.materials[n.material.name]&&(e.materials[n.material.name]=n.material)}),e}function nfe(t){t.dispose&&t.type!=="Scene"&&t.dispose();for(const e in t)e.dispose==null||e.dispose(),delete t[e]}function vm(t,e){const n=t;return(e!=null&&e.primitive||!n.__r3f)&&(n.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e}),t}function fL(t,e){let n=t;if(e.includes("-")){const i=e.split("-"),r=i.pop();return n=i.reduce((s,o)=>s[o],t),{target:n,key:r}}else return{target:n,key:e}}const j4=/-\d+$/;function pP(t,e,n){if(Kn.str(n)){if(j4.test(n)){const s=n.replace(j4,""),{target:o,key:a}=fL(t,s);Array.isArray(o[a])||(o[a]=[])}const{target:i,key:r}=fL(t,n);e.__r3f.previousAttach=i[r],i[r]=e}else e.__r3f.previousAttach=n(t,e)}function W4(t,e,n){var i,r;if(Kn.str(n)){const{target:s,key:o}=fL(t,n),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(i=e.__r3f)==null||i.previousAttach==null||i.previousAttach(t,e);(r=e.__r3f)==null||delete r.previousAttach}function GY(t,{children:e,key:n,ref:i,...r},{children:s,key:o,ref:a,...l}={},c=!1){var h;const u=(h=t==null?void 0:t.__r3f)!=null?h:{},d=Object.entries(r),f=[];if(c){const v=Object.keys(l);for(let g=0;g<v.length;g++)r.hasOwnProperty(v[g])||d.unshift([v[g],kY+"remove"])}d.forEach(([v,g])=>{var m;if((m=t.__r3f)!=null&&m.primitive&&v==="object"||Kn.equ(g,l[v]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(v))return f.push([v,g,!0,[]]);let y=[];v.includes("-")&&(y=v.split("-")),f.push([v,g,!1,y]);for(const w in r){const b=r[w];w.startsWith(`${v}-`)&&f.push([w,b,!1,w.split("-")])}});const p={...r};return u.memoizedProps&&u.memoizedProps.args&&(p.args=u.memoizedProps.args),u.memoizedProps&&u.memoizedProps.attach&&(p.attach=u.memoizedProps.attach),{memoized:p,changes:f}}function mP(t,e){var n,i,r;const s=(n=t.__r3f)!=null?n:{},o=s.root,a=(i=o==null||o.getState==null?void 0:o.getState())!=null?i:{},{memoized:l,changes:c}=efe(e)?e:GY(t,e),h=s.eventCount;t.__r3f&&(t.__r3f.memoizedProps=l);for(let d=0;d<c.length;d++){let[f,p,v,g]=c[d];if(fP(t)){const b="srgb",A="srgb-linear";f==="encoding"?(f="colorSpace",p=p===3001?b:A):f==="outputEncoding"&&(f="outputColorSpace",p=p===3001?b:A)}let m=t,y=m[f];if(g.length&&(y=g.reduce((w,b)=>w[b],t),!(y&&y.set))){const[w,...b]=g.reverse();m=b.reverse().reduce((A,S)=>A[S],t),f=w}if(p===kY+"remove")if(m.constructor){let w=V4.get(m.constructor);w||(w=new m.constructor,V4.set(m.constructor,w)),p=w[f]}else p=0;if(v)p?s.handlers[f]=p:delete s.handlers[f],s.eventCount=Object.keys(s.handlers).length;else if(y&&y.set&&(y.copy||y instanceof gf)){if(Array.isArray(p))y.fromArray?y.fromArray(p):y.set(...p);else if(y.copy&&p&&p.constructor&&y.constructor===p.constructor)y.copy(p);else if(p!==void 0){const w=y instanceof st;!w&&y.setScalar?y.setScalar(p):y instanceof gf&&p instanceof gf?y.mask=p.mask:y.set(p),!OY()&&!a.linear&&w&&y.convertSRGBToLinear()}}else if(m[f]=p,m[f]instanceof ii&&m[f].format===Ps&&m[f].type===su){const w=m[f];fP(w)&&fP(a.gl)?w.colorSpace=a.gl.outputColorSpace:w.encoding=a.gl.outputEncoding}ym(t)}if(s.parent&&a.internal&&t.raycast&&h!==s.eventCount){const d=a.internal.interaction.indexOf(t);d>-1&&a.internal.interaction.splice(d,1),s.eventCount&&a.internal.interaction.push(t)}return!(c.length===1&&c[0][0]==="onUpdate")&&c.length&&(r=t.__r3f)!=null&&r.parent&&pL(t),t}function ym(t){var e,n;const i=(e=t.__r3f)==null||(n=e.root)==null||n.getState==null?void 0:n.getState();i&&i.internal.frames===0&&i.invalidate()}function pL(t){t.onUpdate==null||t.onUpdate(t)}function ife(t,e){t.manual||(FY(t)?(t.left=e.width/-2,t.right=e.width/2,t.top=e.height/2,t.bottom=e.height/-2):t.aspect=e.width/e.height,t.updateProjectionMatrix(),t.updateMatrixWorld())}function W_(t){return(t.eventObject||t.object).uuid+"/"+t.index+t.instanceId}function rfe(){var t;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return Gm.DefaultEventPriority;switch((t=e.event)==null?void 0:t.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Gm.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Gm.ContinuousEventPriority;default:return Gm.DefaultEventPriority}}function HY(t,e,n,i){const r=n.get(e);r&&(n.delete(e),n.size===0&&(t.delete(i),r.target.releasePointerCapture(i)))}function sfe(t,e){const{internal:n}=t.getState();n.interaction=n.interaction.filter(i=>i!==e),n.initialHits=n.initialHits.filter(i=>i!==e),n.hovered.forEach((i,r)=>{(i.eventObject===e||i.object===e)&&n.hovered.delete(r)}),n.capturedMap.forEach((i,r)=>{HY(n.capturedMap,e,i,r)})}function ofe(t){function e(l){const{internal:c}=t.getState(),h=l.offsetX-c.initialClick[0],u=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(h*h+u*u))}function n(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(h=>{var u;return(u=c.__r3f)==null?void 0:u.handlers["onPointer"+h]}))}function i(l,c){const h=t.getState(),u=new Set,d=[],f=c?c(h.internal.interaction):h.internal.interaction;for(let m=0;m<f.length;m++){const y=p0(f[m]);y&&(y.raycaster.camera=void 0)}h.previousRoot||h.events.compute==null||h.events.compute(l,h);function p(m){const y=p0(m);if(!y||!y.events.enabled||y.raycaster.camera===null)return[];if(y.raycaster.camera===void 0){var w;y.events.compute==null||y.events.compute(l,y,(w=y.previousRoot)==null?void 0:w.getState()),y.raycaster.camera===void 0&&(y.raycaster.camera=null)}return y.raycaster.camera?y.raycaster.intersectObject(m,!0):[]}let v=f.flatMap(p).sort((m,y)=>{const w=p0(m.object),b=p0(y.object);return!w||!b?m.distance-y.distance:b.events.priority-w.events.priority||m.distance-y.distance}).filter(m=>{const y=W_(m);return u.has(y)?!1:(u.add(y),!0)});h.events.filter&&(v=h.events.filter(v,h));for(const m of v){let y=m.object;for(;y;){var g;(g=y.__r3f)!=null&&g.eventCount&&d.push({...m,eventObject:y}),y=y.parent}}if("pointerId"in l&&h.internal.capturedMap.has(l.pointerId))for(let m of h.internal.capturedMap.get(l.pointerId).values())u.has(W_(m.intersection))||d.push(m.intersection);return d}function r(l,c,h,u){const d=t.getState();if(l.length){const f={stopped:!1};for(const p of l){const v=p0(p.object)||d,{raycaster:g,pointer:m,camera:y,internal:w}=v,b=new ae(m.x,m.y,0).unproject(y),A=P=>{var R,F;return(R=(F=w.capturedMap.get(P))==null?void 0:F.has(p.eventObject))!=null?R:!1},S=P=>{const R={intersection:p,target:c.target};w.capturedMap.has(P)?w.capturedMap.get(P).set(p.eventObject,R):w.capturedMap.set(P,new Map([[p.eventObject,R]])),c.target.setPointerCapture(P)},T=P=>{const R=w.capturedMap.get(P);R&&HY(w.capturedMap,p.eventObject,R,P)};let M={};for(let P in c){let R=c[P];typeof R!="function"&&(M[P]=R)}let E={...p,...M,pointer:m,intersections:l,stopped:f.stopped,delta:h,unprojectedPoint:b,ray:g.ray,camera:y,stopPropagation(){const P="pointerId"in c&&w.capturedMap.get(c.pointerId);if((!P||P.has(p.eventObject))&&(E.stopped=f.stopped=!0,w.hovered.size&&Array.from(w.hovered.values()).find(R=>R.eventObject===p.eventObject))){const R=l.slice(0,l.indexOf(p));s([...R,p])}},target:{hasPointerCapture:A,setPointerCapture:S,releasePointerCapture:T},currentTarget:{hasPointerCapture:A,setPointerCapture:S,releasePointerCapture:T},nativeEvent:c};if(u(E),f.stopped===!0)break}}return l}function s(l){const{internal:c}=t.getState();for(const h of c.hovered.values())if(!l.length||!l.find(u=>u.object===h.object&&u.index===h.index&&u.instanceId===h.instanceId)){const d=h.eventObject.__r3f,f=d==null?void 0:d.handlers;if(c.hovered.delete(W_(h)),d!=null&&d.eventCount){const p={...h,intersections:l};f.onPointerOut==null||f.onPointerOut(p),f.onPointerLeave==null||f.onPointerLeave(p)}}}function o(l,c){for(let h=0;h<c.length;h++){const u=c[h].__r3f;u==null||u.handlers.onPointerMissed==null||u.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return c=>{const{internal:h}=t.getState();"pointerId"in c&&h.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{h.capturedMap.has(c.pointerId)&&(h.capturedMap.delete(c.pointerId),s([]))})}}return function(h){const{onPointerMissed:u,internal:d}=t.getState();d.lastEvent.current=h;const f=l==="onPointerMove",p=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",g=i(h,f?n:void 0),m=p?e(h):0;l==="onPointerDown"&&(d.initialClick=[h.offsetX,h.offsetY],d.initialHits=g.map(w=>w.eventObject)),p&&!g.length&&m<=2&&(o(h,d.interaction),u&&u(h)),f&&s(g);function y(w){const b=w.eventObject,A=b.__r3f,S=A==null?void 0:A.handlers;if(A!=null&&A.eventCount)if(f){if(S.onPointerOver||S.onPointerEnter||S.onPointerOut||S.onPointerLeave){const T=W_(w),M=d.hovered.get(T);M?M.stopped&&w.stopPropagation():(d.hovered.set(T,w),S.onPointerOver==null||S.onPointerOver(w),S.onPointerEnter==null||S.onPointerEnter(w))}S.onPointerMove==null||S.onPointerMove(w)}else{const T=S[l];T?(!p||d.initialHits.includes(b))&&(o(h,d.interaction.filter(M=>!d.initialHits.includes(M))),T(w)):p&&d.initialHits.includes(b)&&o(h,d.interaction.filter(M=>!d.initialHits.includes(M)))}}r(g,h,m,y)}}return{handlePointer:a}}const VY=t=>!!(t!=null&&t.render),jY=ge.createContext(null),afe=(t,e)=>{const n=PY((a,l)=>{const c=new ae,h=new ae,u=new ae;function d(m=l().camera,y=h,w=l().size){const{width:b,height:A,top:S,left:T}=w,M=b/A;y instanceof ae?u.copy(y):u.set(...y);const E=m.getWorldPosition(c).distanceTo(u);if(FY(m))return{width:b/m.zoom,height:A/m.zoom,top:S,left:T,factor:1,distance:E,aspect:M};{const P=m.fov*Math.PI/180,R=2*Math.tan(P/2)*E,F=R*(b/A);return{width:F,height:R,top:S,left:T,factor:b/F,distance:E,aspect:M}}}let f;const p=m=>a(y=>({performance:{...y.performance,current:m}})),v=new Ye;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(m=1)=>t(l(),m),advance:(m,y)=>e(m,y,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new $B,pointer:v,mouse:v,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const m=l();f&&clearTimeout(f),m.performance.current!==m.performance.min&&p(m.performance.min),f=setTimeout(()=>p(l().performance.max),m.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:d},setEvents:m=>a(y=>({...y,events:{...y.events,...m}})),setSize:(m,y,w,b,A)=>{const S=l().camera,T={width:m,height:y,top:b||0,left:A||0,updateStyle:w};a(M=>({size:T,viewport:{...M.viewport,...d(S,h,T)}}))},setDpr:m=>a(y=>{const w=zY(m);return{viewport:{...y.viewport,dpr:w,initialDpr:y.viewport.initialDpr||w}}}),setFrameloop:(m="always")=>{const y=l().clock;y.stop(),y.elapsedTime=0,m!=="never"&&(y.start(),y.elapsedTime=0),a(()=>({frameloop:m}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:ge.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(m,y,w)=>{const b=l().internal;return b.priority=b.priority+(y>0?1:0),b.subscribers.push({ref:m,priority:y,store:w}),b.subscribers=b.subscribers.sort((A,S)=>A.priority-S.priority),()=>{const A=l().internal;A!=null&&A.subscribers&&(A.priority=A.priority-(y>0?1:0),A.subscribers=A.subscribers.filter(S=>S.ref!==m))}}}}}),i=n.getState();let r=i.size,s=i.viewport.dpr,o=i.camera;return n.subscribe(()=>{const{camera:a,size:l,viewport:c,gl:h,set:u}=n.getState();if(l!==r||c.dpr!==s){var d;r=l,s=c.dpr,ife(a,l),h.setPixelRatio(c.dpr);const f=(d=l.updateStyle)!=null?d:typeof HTMLCanvasElement<"u"&&h.domElement instanceof HTMLCanvasElement;h.setSize(l.width,l.height,f)}a!==o&&(o=a,u(f=>({viewport:{...f.viewport,...f.viewport.getCurrentViewport(a)}})))}),n.subscribe(a=>t(a)),n};let X_,lfe=new Set,cfe=new Set,ufe=new Set;function gP(t,e){if(t.size)for(const{callback:n}of t.values())n(e)}function m0(t,e){switch(t){case"before":return gP(lfe,e);case"after":return gP(cfe,e);case"tail":return gP(ufe,e)}}let vP,yP;function xP(t,e,n){let i=e.clock.getDelta();for(e.frameloop==="never"&&typeof t=="number"&&(i=t-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=t),vP=e.internal.subscribers,X_=0;X_<vP.length;X_++)yP=vP[X_],yP.ref.current(yP.store.getState(),i,n);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function hfe(t){let e=!1,n,i,r;function s(l){i=requestAnimationFrame(s),e=!0,n=0,m0("before",l);for(const h of t.values()){var c;r=h.store.getState(),r.internal.active&&(r.frameloop==="always"||r.internal.frames>0)&&!((c=r.gl.xr)!=null&&c.isPresenting)&&(n+=xP(l,r))}if(m0("after",l),n===0)return m0("tail",l),e=!1,cancelAnimationFrame(i)}function o(l,c=1){var h;if(!l)return t.forEach(u=>o(u.store.getState()),c);(h=l.gl.xr)!=null&&h.isPresenting||!l.internal.active||l.frameloop==="never"||(l.internal.frames=Math.min(60,l.internal.frames+c),e||(e=!0,requestAnimationFrame(s)))}function a(l,c=!0,h,u){if(c&&m0("before",l),h)xP(l,h,u);else for(const d of t.values())xP(l,d.store.getState());c&&m0("after",l)}return{loop:s,invalidate:o,advance:a}}function WY(){const t=ge.useContext(jY);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function qo(t=n=>n,e){return WY()(t,e)}function C1(t,e=0){const n=WY(),i=n.getState().internal.subscribe,r=NY(t);return E1(()=>i(r,e,n),[e,i,n]),null}function XY(t,e){return function(n,...i){const r=new n;return t&&t(r),Promise.all(i.map(s=>new Promise((o,a)=>r.load(s,l=>{l.scene&&Object.assign(l,tfe(l.scene)),o(l)},e,l=>a(new Error(`Could not load ${s}: ${l.message})`))))))}}function T1(t,e,n,i){const r=Array.isArray(e)?e:[e],s=Yde(XY(n,i),[t,...r],{equal:Kn.equ});return Array.isArray(e)?s:s[0]}T1.preload=function(t,e,n){const i=Array.isArray(e)?e:[e];return qde(XY(n),[t,...i])};T1.clear=function(t,e){const n=Array.isArray(e)?e:[e];return Qde([t,...n])};const Vg=new Map,{invalidate:X4,advance:Y4}=hfe(Vg),{reconciler:bA,applyProps:zp}=Jde(Vg,rfe),Gp={objects:"shallow",strict:!1},dfe=(t,e)=>{const n=typeof t=="function"?t(e):t;return VY(n)?n:new DB({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...t})};function ffe(t,e){if(e)return e;if(typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&t.parentElement){const{width:n,height:i,top:r,left:s}=t.parentElement.getBoundingClientRect();return{width:n,height:i,top:r,left:s}}else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height,top:0,left:0};return{width:0,height:0,top:0,left:0}}function pfe(t){const e=Vg.get(t),n=e==null?void 0:e.fiber,i=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=i||afe(X4,Y4),o=n||bA.createContainer(s,Gm.ConcurrentRoot,null,!1,null,"",r,null);e||Vg.set(t,{fiber:o,store:s});let a,l=!1,c;return{configure(h={}){let{gl:u,size:d,scene:f,events:p,onCreated:v,shadows:g=!1,linear:m=!1,flat:y=!1,legacy:w=!1,orthographic:b=!1,frameloop:A="always",dpr:S=[1,2],performance:T,raycaster:M,camera:E,onPointerMissed:P}=h,R=s.getState(),F=R.gl;R.gl||R.set({gl:F=dfe(u,t)});let B=R.raycaster;B||R.set({raycaster:B=new EY});const{params:k,...j}=M||{};if(Kn.equ(j,B,Gp)||zp(B,{...j}),Kn.equ(k,B.params,Gp)||zp(B,{params:{...B.params,...k}}),!R.camera||R.camera===c&&!Kn.equ(c,E,Gp)){c=E;const Y=E instanceof l1,z=Y?E:b?new qa(0,0,0,0,.1,1e3):new Gn(75,0,.1,1e3);Y||(z.position.z=5,E&&zp(z,E),!R.camera&&!(E!=null&&E.rotation)&&z.lookAt(0,0,0)),R.set({camera:z})}if(!R.scene){let Y;f instanceof _A?Y=f:(Y=new _A,f&&zp(Y,f)),R.set({scene:vm(Y)})}if(!R.xr){const Y=(q,re)=>{const G=s.getState();G.frameloop!=="never"&&Y4(q,!0,G,re)},z=()=>{const q=s.getState();q.gl.xr.enabled=q.gl.xr.isPresenting,q.gl.xr.setAnimationLoop(q.gl.xr.isPresenting?Y:null),q.gl.xr.isPresenting||X4(q)},X={connect(){const q=s.getState().gl;q.xr.addEventListener("sessionstart",z),q.xr.addEventListener("sessionend",z)},disconnect(){const q=s.getState().gl;q.xr.removeEventListener("sessionstart",z),q.xr.removeEventListener("sessionend",z)}};F.xr&&X.connect(),R.set({xr:X})}if(F.shadowMap){const Y=F.shadowMap.enabled,z=F.shadowMap.type;if(F.shadowMap.enabled=!!g,Kn.boo(g))F.shadowMap.type=Sy;else if(Kn.str(g)){var Z;const X={basic:IX,percentage:YM,soft:Sy,variance:Oa};F.shadowMap.type=(Z=X[g])!=null?Z:Sy}else Kn.obj(g)&&Object.assign(F.shadowMap,g);(Y!==F.shadowMap.enabled||z!==F.shadowMap.type)&&(F.shadowMap.needsUpdate=!0)}const ee=OY();ee&&("enabled"in ee?ee.enabled=!w:"legacyMode"in ee&&(ee.legacyMode=w)),zp(F,{outputEncoding:m?3e3:3001,toneMapping:y?Ya:pB}),R.legacy!==w&&R.set(()=>({legacy:w})),R.linear!==m&&R.set(()=>({linear:m})),R.flat!==y&&R.set(()=>({flat:y})),u&&!Kn.fun(u)&&!VY(u)&&!Kn.equ(u,F,Gp)&&zp(F,u),p&&!R.events.handlers&&R.set({events:p(s)});const H=ffe(t,d);return Kn.equ(H,R.size,Gp)||R.setSize(H.width,H.height,H.updateStyle,H.top,H.left),S&&R.viewport.dpr!==zY(S)&&R.setDpr(S),R.frameloop!==A&&R.setFrameloop(A),R.onPointerMissed||R.set({onPointerMissed:P}),T&&!Kn.equ(T,R.performance,Gp)&&R.set(Y=>({performance:{...Y.performance,...T}})),a=v,l=!0,this},render(h){return l||this.configure(),bA.updateContainer(ge.createElement(mfe,{store:s,children:h,onCreated:a,rootElement:t}),o,null,()=>{}),s},unmount(){YY(t)}}}function mfe({store:t,children:e,onCreated:n,rootElement:i}){return E1(()=>{const r=t.getState();r.set(s=>({internal:{...s.internal,active:!0}})),n&&n(r),t.getState().events.connected||r.events.connect==null||r.events.connect(i)},[]),ge.createElement(jY.Provider,{value:t},e)}function YY(t,e){const n=Vg.get(t),i=n==null?void 0:n.fiber;if(i){const r=n==null?void 0:n.store.getState();r&&(r.internal.active=!1),bA.updateContainer(null,i,null,()=>{r&&setTimeout(()=>{try{var s,o,a,l;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=r.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=r.gl)!=null&&l.xr&&r.xr.disconnect(),nfe(r),Vg.delete(t),e&&e(t)}catch{}},500)})}}bA.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:ge.version});function $a(){return $a=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},$a.apply(this,arguments)}function mL(t,e,n){var i,r,s,o,a;e==null&&(e=100);function l(){var h=Date.now()-o;h<e&&h>=0?i=setTimeout(l,e-h):(i=null,n||(a=t.apply(s,r),s=r=null))}var c=function(){s=this,r=arguments,o=Date.now();var h=n&&!i;return i||(i=setTimeout(l,e)),h&&(a=t.apply(s,r),s=r=null),a};return c.clear=function(){i&&(clearTimeout(i),i=null)},c.flush=function(){i&&(a=t.apply(s,r),s=r=null,clearTimeout(i),i=null)},c}mL.debounce=mL;var gfe=mL;const q4=Zx(gfe);function vfe(t){let{debounce:e,scroll:n,polyfill:i,offsetSize:r}=t===void 0?{debounce:0,scroll:!1,offsetSize:!1}:t;const s=i||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,a]=ge.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=ge.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o}),c=e?typeof e=="number"?e:e.scroll:null,h=e?typeof e=="number"?e:e.resize:null,u=ge.useRef(!1);ge.useEffect(()=>(u.current=!0,()=>void(u.current=!1)));const[d,f,p]=ge.useMemo(()=>{const y=()=>{if(!l.current.element)return;const{left:w,top:b,width:A,height:S,bottom:T,right:M,x:E,y:P}=l.current.element.getBoundingClientRect(),R={left:w,top:b,width:A,height:S,bottom:T,right:M,x:E,y:P};l.current.element instanceof HTMLElement&&r&&(R.height=l.current.element.offsetHeight,R.width=l.current.element.offsetWidth),Object.freeze(R),u.current&&!_fe(l.current.lastBounds,R)&&a(l.current.lastBounds=R)};return[y,h?q4(y,h):y,c?q4(y,c):y]},[a,r,c,h]);function v(){l.current.scrollContainers&&(l.current.scrollContainers.forEach(y=>y.removeEventListener("scroll",p,!0)),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null)}function g(){l.current.element&&(l.current.resizeObserver=new s(p),l.current.resizeObserver.observe(l.current.element),n&&l.current.scrollContainers&&l.current.scrollContainers.forEach(y=>y.addEventListener("scroll",p,{capture:!0,passive:!0})))}const m=y=>{!y||y===l.current.element||(v(),l.current.element=y,l.current.scrollContainers=qY(y),g())};return xfe(p,!!n),yfe(f),ge.useEffect(()=>{v(),g()},[n,p,f]),ge.useEffect(()=>v,[]),[m,o,d]}function yfe(t){ge.useEffect(()=>{const e=t;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[t])}function xfe(t,e){ge.useEffect(()=>{if(e){const n=t;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[t,e])}function qY(t){const e=[];if(!t||t===document.body)return e;const{overflow:n,overflowX:i,overflowY:r}=window.getComputedStyle(t);return[n,i,r].some(s=>s==="auto"||s==="scroll")&&e.push(t),[...e,...qY(t.parentElement)]}const wfe=["x","y","top","bottom","left","right","width","height"],_fe=(t,e)=>wfe.every(n=>t[n]===e[n]);var bfe=Object.defineProperty,Sfe=Object.defineProperties,Afe=Object.getOwnPropertyDescriptors,Q4=Object.getOwnPropertySymbols,Mfe=Object.prototype.hasOwnProperty,Efe=Object.prototype.propertyIsEnumerable,K4=(t,e,n)=>e in t?bfe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,J4=(t,e)=>{for(var n in e||(e={}))Mfe.call(e,n)&&K4(t,n,e[n]);if(Q4)for(var n of Q4(e))Efe.call(e,n)&&K4(t,n,e[n]);return t},Cfe=(t,e)=>Sfe(t,Afe(e));function QY(t,e,n){if(!t)return;if(n(t)===!0)return t;let i=e?t.return:t.child;for(;i;){const r=QY(i,e,n);if(r)return r;i=e?null:i.sibling}}function KY(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const rO=KY(ge.createContext(null));class JY extends ge.Component{render(){return ge.createElement(rO.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:Z4,ReactCurrentDispatcher:$4}=ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function Tfe(){const t=ge.useContext(rO);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=ge.useId();return ge.useMemo(()=>{for(const i of[Z4==null?void 0:Z4.current,t,t==null?void 0:t.alternate]){if(!i)continue;const r=QY(i,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(r)return r}},[t,e])}function Pfe(){var t,e;const n=Tfe(),[i]=ge.useState(()=>new Map);i.clear();let r=n;for(;r;){const s=(t=r.type)==null?void 0:t._context;s&&s!==rO&&!i.has(s)&&i.set(s,(e=$4==null?void 0:$4.current)==null?void 0:e.readContext(KY(s))),r=r.return}return i}function Dfe(){const t=Pfe();return ge.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>i=>ge.createElement(e,null,ge.createElement(n.Provider,Cfe(J4({},i),{value:t.get(n)}))),e=>ge.createElement(JY,J4({},e))),[t])}const wP={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Rfe(t){const{handlePointer:e}=ofe(t);return{priority:1,enabled:!0,compute(n,i,r){i.pointer.set(n.offsetX/i.size.width*2-1,-(n.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(wP).reduce((n,i)=>({...n,[i]:e(i)}),{}),update:()=>{var n;const{events:i,internal:r}=t.getState();(n=r.lastEvent)!=null&&n.current&&i.handlers&&i.handlers.onPointerMove(r.lastEvent.current)},connect:n=>{var i;const{set:r,events:s}=t.getState();s.disconnect==null||s.disconnect(),r(o=>({events:{...o.events,connected:n}})),Object.entries((i=s.handlers)!=null?i:[]).forEach(([o,a])=>{const[l,c]=wP[o];n.addEventListener(l,a,{passive:c})})},disconnect:()=>{const{set:n,events:i}=t.getState();if(i.connected){var r;Object.entries((r=i.handlers)!=null?r:[]).forEach(([s,o])=>{if(i&&i.connected instanceof HTMLElement){const[a]=wP[s];i.connected.removeEventListener(a,o)}}),n(s=>({events:{...s.events,connected:void 0}}))}}}}const Lfe=ge.forwardRef(function({children:e,fallback:n,resize:i,style:r,gl:s,events:o=Rfe,eventSource:a,eventPrefix:l,shadows:c,linear:h,flat:u,legacy:d,orthographic:f,frameloop:p,dpr:v,performance:g,raycaster:m,camera:y,onPointerMissed:w,onCreated:b,...A},S){ge.useMemo(()=>Kde(kde),[]);const T=Dfe(),[M,E]=vfe({scroll:!0,debounce:{scroll:50,resize:0},...i}),P=ge.useRef(null),R=ge.useRef(null);ge.useImperativeHandle(S,()=>P.current);const F=NY(w),[B,k]=ge.useState(!1),[j,Z]=ge.useState(!1);if(B)throw B;if(j)throw j;const ee=ge.useRef(null);E1(()=>{const W=P.current;E.width>0&&E.height>0&&W&&(ee.current||(ee.current=pfe(W)),ee.current.configure({gl:s,events:o,shadows:c,linear:h,flat:u,legacy:d,orthographic:f,frameloop:p,dpr:v,performance:g,raycaster:m,camera:y,size:E,onPointerMissed:(...H)=>F.current==null?void 0:F.current(...H),onCreated:H=>{H.events.connect==null||H.events.connect(a?Zde(a)?a.current:a:R.current),l&&H.setEvents({compute:(Y,z)=>{const X=Y[l+"X"],q=Y[l+"Y"];z.pointer.set(X/z.size.width*2-1,-(q/z.size.height)*2+1),z.raycaster.setFromCamera(z.pointer,z.camera)}}),b==null||b(H)}}),ee.current.render(ge.createElement(T,null,ge.createElement(UY,{set:Z},ge.createElement(ge.Suspense,{fallback:ge.createElement($de,{set:k})},e)))))}),ge.useEffect(()=>{const W=P.current;if(W)return()=>YY(W)},[]);const O=a?"none":"auto";return ge.createElement("div",$a({ref:R,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:O,...r}},A),ge.createElement("div",{ref:M,style:{width:"100%",height:"100%"}},ge.createElement("canvas",{ref:P,style:{display:"block"}},n)))}),ZY=ge.forwardRef(function(e,n){return ge.createElement(JY,null,ge.createElement(Lfe,$a({},e,{ref:n})))}),P1=new ae,sO=new ae,Ife=new ae;function Bfe(t,e,n){const i=P1.setFromMatrixPosition(t.matrixWorld);i.project(e);const r=n.width/2,s=n.height/2;return[i.x*r+r,-(i.y*s)+s]}function Ofe(t,e){const n=P1.setFromMatrixPosition(t.matrixWorld),i=sO.setFromMatrixPosition(e.matrixWorld),r=n.sub(i),s=e.getWorldDirection(Ife);return r.angleTo(s)>Math.PI/2}function Ffe(t,e,n,i){const r=P1.setFromMatrixPosition(t.matrixWorld),s=r.clone();s.project(e),n.setFromCamera(s,e);const o=n.intersectObjects(i,!0);if(o.length){const a=o[0].distance;return r.distanceTo(n.ray.origin)<a}return!0}function Nfe(t,e){if(e instanceof qa)return e.zoom;if(e instanceof Gn){const n=P1.setFromMatrixPosition(t.matrixWorld),i=sO.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,s=n.distanceTo(i);return 1/(2*Math.tan(r/2)*s)}else return 1}function Ufe(t,e,n){if(e instanceof Gn||e instanceof qa){const i=P1.setFromMatrixPosition(t.matrixWorld),r=sO.setFromMatrixPosition(e.matrixWorld),s=i.distanceTo(r),o=(n[1]-n[0])/(e.far-e.near),a=n[1]-o*e.far;return Math.round(o*s+a)}}const gL=t=>Math.abs(t)<1e-10?0:t;function $Y(t,e,n=""){let i="matrix3d(";for(let r=0;r!==16;r++)i+=gL(e[r]*t.elements[r])+(r!==15?",":")");return n+i}const kfe=(t=>e=>$Y(e,t))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),zfe=(t=>(e,n)=>$Y(e,t(n),"translate(-50%,-50%)"))(t=>[1/t,1/t,1/t,1,-1/t,-1/t,-1/t,-1,1/t,1/t,1/t,1,1,1,1,1]);function Gfe(t){return t&&typeof t=="object"&&"current"in t}const Hfe=ge.forwardRef(({children:t,eps:e=.001,style:n,className:i,prepend:r,center:s,fullscreen:o,portal:a,distanceFactor:l,sprite:c=!1,transform:h=!1,occlude:u,onOcclude:d,castShadow:f,receiveShadow:p,material:v,geometry:g,zIndexRange:m=[16777271,0],calculatePosition:y=Bfe,as:w="div",wrapperClass:b,pointerEvents:A="auto",...S},T)=>{const{gl:M,camera:E,scene:P,size:R,raycaster:F,events:B,viewport:k}=qo(),[j]=ge.useState(()=>document.createElement(w)),Z=ge.useRef(),ee=ge.useRef(null),O=ge.useRef(0),W=ge.useRef([0,0]),H=ge.useRef(null),Y=ge.useRef(null),z=(a==null?void 0:a.current)||B.connected||M.domElement.parentNode,X=ge.useRef(null),q=ge.useRef(!1),re=ge.useMemo(()=>u&&u!=="blending"||Array.isArray(u)&&u.length&&Gfe(u[0]),[u]);ge.useLayoutEffect(()=>{const $=M.domElement;u&&u==="blending"?($.style.zIndex=`${Math.floor(m[0]/2)}`,$.style.position="absolute",$.style.pointerEvents="none"):($.style.zIndex=null,$.style.position=null,$.style.pointerEvents=null)},[u]),ge.useLayoutEffect(()=>{if(ee.current){const $=Z.current=_X(j);if(P.updateMatrixWorld(),h)j.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const se=y(ee.current,E,R);j.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${se[0]}px,${se[1]}px,0);transform-origin:0 0;`}return z&&(r?z.prepend(j):z.appendChild(j)),()=>{z&&z.removeChild(j),$.unmount()}}},[z,h]),ge.useLayoutEffect(()=>{b&&(j.className=b)},[b]);const G=ge.useMemo(()=>h?{position:"absolute",top:0,left:0,width:R.width,height:R.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...o&&{top:-R.height/2,left:-R.width/2,width:R.width,height:R.height},...n},[n,s,o,R,h]),K=ge.useMemo(()=>({position:"absolute",pointerEvents:A}),[A]);ge.useLayoutEffect(()=>{if(q.current=!1,h){var $;($=Z.current)==null||$.render(ge.createElement("div",{ref:H,style:G},ge.createElement("div",{ref:Y,style:K},ge.createElement("div",{ref:T,className:i,style:n,children:t}))))}else{var se;(se=Z.current)==null||se.render(ge.createElement("div",{ref:T,style:G,className:i,children:t}))}});const oe=ge.useRef(!0);C1($=>{if(ee.current){E.updateMatrixWorld(),ee.current.updateWorldMatrix(!0,!1);const se=h?W.current:y(ee.current,E,R);if(h||Math.abs(O.current-E.zoom)>e||Math.abs(W.current[0]-se[0])>e||Math.abs(W.current[1]-se[1])>e){const ne=Ofe(ee.current,E);let ie=!1;re&&(u!=="blending"?ie=[P]:Array.isArray(u)&&(ie=u.map(_e=>_e.current)));const me=oe.current;if(ie){const _e=Ffe(ee.current,E,F,ie);oe.current=_e&&!ne}else oe.current=!ne;me!==oe.current&&(d?d(!oe.current):j.style.display=oe.current?"block":"none");const xe=Math.floor(m[0]/2),Ae=u?re?[m[0],xe]:[xe-1,0]:m;if(j.style.zIndex=`${Ufe(ee.current,E,Ae)}`,h){const[_e,Ee]=[R.width/2,R.height/2],Re=E.projectionMatrix.elements[5]*Ee,{isOrthographicCamera:Ue,top:Ne,left:U,bottom:L,right:te}=E,we=kfe(E.matrixWorldInverse),Te=Ue?`scale(${Re})translate(${gL(-(te+U)/2)}px,${gL((Ne+L)/2)}px)`:`translateZ(${Re}px)`;let Ie=ee.current.matrixWorld;c&&(Ie=E.matrixWorldInverse.clone().transpose().copyPosition(Ie).scale(ee.current.scale),Ie.elements[3]=Ie.elements[7]=Ie.elements[11]=0,Ie.elements[15]=1),j.style.width=R.width+"px",j.style.height=R.height+"px",j.style.perspective=Ue?"":`${Re}px`,H.current&&Y.current&&(H.current.style.transform=`${Te}${we}translate(${_e}px,${Ee}px)`,Y.current.style.transform=zfe(Ie,1/((l||10)/400)))}else{const _e=l===void 0?1:Nfe(ee.current,E)*l;j.style.transform=`translate3d(${se[0]}px,${se[1]}px,0) scale(${_e})`}W.current=se,O.current=E.zoom}}if(!re&&X.current&&!q.current)if(h){if(H.current){const se=H.current.children[0];if(se!=null&&se.clientWidth&&se!=null&&se.clientHeight){const{isOrthographicCamera:ne}=E;if(ne||g)S.scale&&(Array.isArray(S.scale)?S.scale instanceof ae?X.current.scale.copy(S.scale.clone().divideScalar(1)):X.current.scale.set(1/S.scale[0],1/S.scale[1],1/S.scale[2]):X.current.scale.setScalar(1/S.scale));else{const ie=(l||10)/400,me=se.clientWidth*ie,xe=se.clientHeight*ie;X.current.scale.set(me,xe,1)}q.current=!0}}}else{const se=j.children[0];if(se!=null&&se.clientWidth&&se!=null&&se.clientHeight){const ne=1/k.factor,ie=se.clientWidth*ne,me=se.clientHeight*ne;X.current.scale.set(ie,me,1),q.current=!0}X.current.lookAt($.camera.position)}});const ve=ge.useMemo(()=>({vertexShader:h?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom" 
            is false. 
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;
            
            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[h]);return ge.createElement("group",$a({},S,{ref:ee}),u&&!re&&ge.createElement("mesh",{castShadow:f,receiveShadow:p,ref:X},g||ge.createElement("planeGeometry",null),v||ge.createElement("shaderMaterial",{side:na,vertexShader:ve.vertexShader,fragmentShader:ve.fragmentShader})))});let g0=0;const Vfe=PY(t=>(zm.onStart=(e,n,i)=>{t({active:!0,item:e,loaded:n,total:i,progress:(n-g0)/(i-g0)*100})},zm.onLoad=()=>{t({active:!1})},zm.onError=e=>t(n=>({errors:[...n.errors,e]})),zm.onProgress=(e,n,i)=>{n===i&&(g0=i),t({active:!0,item:e,loaded:n,total:i,progress:(n-g0)/(i-g0)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0}));function eq(t){return function(e){t.forEach(function(n){typeof n=="function"?n(e):n!=null&&(n.current=e)})}}function ug(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eG(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function tG(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?eG(Object(n),!0).forEach(function(i){ug(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):eG(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}new Ye;new Ye;function tq(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var No=function t(e,n,i){var r=this;tq(this,t),ug(this,"dot2",function(s,o){return r.x*s+r.y*o}),ug(this,"dot3",function(s,o,a){return r.x*s+r.y*o+r.z*a}),this.x=e,this.y=n,this.z=i},jfe=[new No(1,1,0),new No(-1,1,0),new No(1,-1,0),new No(-1,-1,0),new No(1,0,1),new No(-1,0,1),new No(1,0,-1),new No(-1,0,-1),new No(0,1,1),new No(0,-1,1),new No(0,1,-1),new No(0,-1,-1)],nG=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],iG=new Array(512),rG=new Array(512),Wfe=function(e){e>0&&e<1&&(e*=65536),e=Math.floor(e),e<256&&(e|=e<<8);for(var n=0;n<256;n++){var i;n&1?i=nG[n]^e&255:i=nG[n]^e>>8&255,iG[n]=iG[n+256]=i,rG[n]=rG[n+256]=jfe[i%12]}};Wfe(0);function Xfe(t){if(typeof t=="number")t=Math.abs(t);else if(typeof t=="string"){var e=t;t=0;for(var n=0;n<e.length;n++)t=(t+(n+1)*(e.charCodeAt(n)%96))%2147483647}return t===0&&(t=311),t}function sG(t){var e=Xfe(t);return function(){var n=e*48271%2147483647;return e=n,n/2147483647}}var Yfe=function t(e){var n=this;tq(this,t),ug(this,"seed",0),ug(this,"init",function(i){n.seed=i,n.value=sG(i)}),ug(this,"value",sG(this.seed)),this.init(e)},qfe=new Yfe(Math.random()),Qfe={radius:1,center:[0,0,0]};function Kfe(t,e){for(var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:qfe,i=tG(tG({},Qfe),e),r=i.radius,s=i.center,o=0;o<t.length;o+=3){var a=Math.pow(n.value(),.3333333333333333),l=n.value()*2-1,c=n.value()*2-1,h=n.value()*2-1,u=Math.sqrt(l*l+c*c+h*h);l=a*l/u,c=a*c/u,h=a*h/u,t[o]=l*r+s[0],t[o+1]=c*r+s[1],t[o+2]=h*r+s[2]}return t}function Mx(t){return Mx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mx(t)}function Jfe(t,e){if(Mx(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Mx(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zfe(t){var e=Jfe(t,"string");return Mx(e)==="symbol"?e:String(e)}function qt(t,e,n){return e=Zfe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oG(t,e){if(e===S7)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(e===xA||e===vB){let n=t.getIndex();if(n===null){const o=[],a=t.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);t.setIndex(o),n=t.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t}const i=n.count-2,r=[];if(n)if(e===xA)for(let o=1;o<=i;o++)r.push(n.getX(0)),r.push(n.getX(o)),r.push(n.getX(o+1));else for(let o=0;o<i;o++)o%2===0?(r.push(n.getX(o)),r.push(n.getX(o+1)),r.push(n.getX(o+2))):(r.push(n.getX(o+2)),r.push(n.getX(o+1)),r.push(n.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=t.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),t}const aG=(t,e)=>(t%e+e)%e;let $fe=class extends sc{constructor(e,n){super(),qt(this,"object",void 0),qt(this,"domElement",void 0),qt(this,"enabled",!0),qt(this,"target",new ae),qt(this,"minDistance",0),qt(this,"maxDistance",1/0),qt(this,"minZoom",0),qt(this,"maxZoom",1/0),qt(this,"minPolarAngle",0),qt(this,"maxPolarAngle",Math.PI),qt(this,"minAzimuthAngle",-1/0),qt(this,"maxAzimuthAngle",1/0),qt(this,"enableDamping",!1),qt(this,"dampingFactor",.05),qt(this,"enableZoom",!0),qt(this,"zoomSpeed",1),qt(this,"enableRotate",!0),qt(this,"rotateSpeed",1),qt(this,"enablePan",!0),qt(this,"panSpeed",1),qt(this,"screenSpacePanning",!0),qt(this,"keyPanSpeed",7),qt(this,"autoRotate",!1),qt(this,"autoRotateSpeed",2),qt(this,"reverseOrbit",!1),qt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),qt(this,"mouseButtons",{LEFT:Fd.ROTATE,MIDDLE:Fd.DOLLY,RIGHT:Fd.PAN}),qt(this,"touches",{ONE:Nd.ROTATE,TWO:Nd.DOLLY_PAN}),qt(this,"target0",void 0),qt(this,"position0",void 0),qt(this,"zoom0",void 0),qt(this,"_domElementKeyEvents",null),qt(this,"getPolarAngle",void 0),qt(this,"getAzimuthalAngle",void 0),qt(this,"setPolarAngle",void 0),qt(this,"setAzimuthalAngle",void 0),qt(this,"getDistance",void 0),qt(this,"listenToKeyEvents",void 0),qt(this,"saveState",void 0),qt(this,"reset",void 0),qt(this,"update",void 0),qt(this,"connect",void 0),qt(this,"dispose",void 0),this.object=e,this.domElement=n,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object instanceof Gn?this.object.zoom:1,this.getPolarAngle=()=>h.phi,this.getAzimuthalAngle=()=>h.theta,this.setPolarAngle=ue=>{let Me=aG(ue,2*Math.PI),Be=h.phi;Be<0&&(Be+=2*Math.PI),Me<0&&(Me+=2*Math.PI);let ze=Math.abs(Me-Be);2*Math.PI-ze<ze&&(Me<Be?Me+=2*Math.PI:Be+=2*Math.PI),u.phi=Me-Be,i.update()},this.setAzimuthalAngle=ue=>{let Me=aG(ue,2*Math.PI),Be=h.theta;Be<0&&(Be+=2*Math.PI),Me<0&&(Me+=2*Math.PI);let ze=Math.abs(Me-Be);2*Math.PI-ze<ze&&(Me<Be?Me+=2*Math.PI:Be+=2*Math.PI),u.theta=Me-Be,i.update()},this.getDistance=()=>i.object.position.distanceTo(i.target),this.listenToKeyEvents=ue=>{ue.addEventListener("keydown",te),this._domElementKeyEvents=ue},this.saveState=()=>{i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object instanceof Gn?i.object.zoom:1},this.reset=()=>{i.target.copy(i.target0),i.object.position.copy(i.position0),i.object instanceof Gn&&(i.object.zoom=i.zoom0,i.object.updateProjectionMatrix()),i.dispatchEvent(r),i.update(),l=a.NONE},this.update=(()=>{const ue=new ae,Me=new _r().setFromUnitVectors(e.up,new ae(0,1,0)),Be=Me.clone().invert(),ze=new ae,$e=new _r,dt=2*Math.PI;return function(){const J=i.object.position;ue.copy(J).sub(i.target),ue.applyQuaternion(Me),h.setFromVector3(ue),i.autoRotate&&l===a.NONE&&F(P()),i.enableDamping?(h.theta+=u.theta*i.dampingFactor,h.phi+=u.phi*i.dampingFactor):(h.theta+=u.theta,h.phi+=u.phi);let fe=i.minAzimuthAngle,Se=i.maxAzimuthAngle;return isFinite(fe)&&isFinite(Se)&&(fe<-Math.PI?fe+=dt:fe>Math.PI&&(fe-=dt),Se<-Math.PI?Se+=dt:Se>Math.PI&&(Se-=dt),fe<=Se?h.theta=Math.max(fe,Math.min(Se,h.theta)):h.theta=h.theta>(fe+Se)/2?Math.max(fe,h.theta):Math.min(Se,h.theta)),h.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,h.phi)),h.makeSafe(),h.radius*=d,h.radius=Math.max(i.minDistance,Math.min(i.maxDistance,h.radius)),i.enableDamping===!0?i.target.addScaledVector(f,i.dampingFactor):i.target.add(f),ue.setFromSpherical(h),ue.applyQuaternion(Be),J.copy(i.target).add(ue),i.object.lookAt(i.target),i.enableDamping===!0?(u.theta*=1-i.dampingFactor,u.phi*=1-i.dampingFactor,f.multiplyScalar(1-i.dampingFactor)):(u.set(0,0,0),f.set(0,0,0)),d=1,p||ze.distanceToSquared(i.object.position)>c||8*(1-$e.dot(i.object.quaternion))>c?(i.dispatchEvent(r),ze.copy(i.object.position),$e.copy(i.object.quaternion),p=!1,!0):!1}})(),this.connect=ue=>{ue===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),i.domElement=ue,i.domElement.style.touchAction="none",i.domElement.addEventListener("contextmenu",Ie),i.domElement.addEventListener("pointerdown",_e),i.domElement.addEventListener("pointercancel",Ue),i.domElement.addEventListener("wheel",L)},this.dispose=()=>{var ue,Me,Be,ze,$e,dt;(ue=i.domElement)===null||ue===void 0||ue.removeEventListener("contextmenu",Ie),(Me=i.domElement)===null||Me===void 0||Me.removeEventListener("pointerdown",_e),(Be=i.domElement)===null||Be===void 0||Be.removeEventListener("pointercancel",Ue),(ze=i.domElement)===null||ze===void 0||ze.removeEventListener("wheel",L),($e=i.domElement)===null||$e===void 0||$e.ownerDocument.removeEventListener("pointermove",Ee),(dt=i.domElement)===null||dt===void 0||dt.ownerDocument.removeEventListener("pointerup",Re),i._domElementKeyEvents!==null&&i._domElementKeyEvents.removeEventListener("keydown",te)};const i=this,r={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const c=1e-6,h=new dL,u=new dL;let d=1;const f=new ae;let p=!1;const v=new Ye,g=new Ye,m=new Ye,y=new Ye,w=new Ye,b=new Ye,A=new Ye,S=new Ye,T=new Ye,M=[],E={};function P(){return 2*Math.PI/60/60*i.autoRotateSpeed}function R(){return Math.pow(.95,i.zoomSpeed)}function F(ue){i.reverseOrbit?u.theta+=ue:u.theta-=ue}function B(ue){i.reverseOrbit?u.phi+=ue:u.phi-=ue}const k=(()=>{const ue=new ae;return function(Be,ze){ue.setFromMatrixColumn(ze,0),ue.multiplyScalar(-Be),f.add(ue)}})(),j=(()=>{const ue=new ae;return function(Be,ze){i.screenSpacePanning===!0?ue.setFromMatrixColumn(ze,1):(ue.setFromMatrixColumn(ze,0),ue.crossVectors(i.object.up,ue)),ue.multiplyScalar(Be),f.add(ue)}})(),Z=(()=>{const ue=new ae;return function(Be,ze){const $e=i.domElement;if($e&&i.object instanceof Gn&&i.object.isPerspectiveCamera){const dt=i.object.position;ue.copy(dt).sub(i.target);let Bt=ue.length();Bt*=Math.tan(i.object.fov/2*Math.PI/180),k(2*Be*Bt/$e.clientHeight,i.object.matrix),j(2*ze*Bt/$e.clientHeight,i.object.matrix)}else $e&&i.object instanceof qa&&i.object.isOrthographicCamera?(k(Be*(i.object.right-i.object.left)/i.object.zoom/$e.clientWidth,i.object.matrix),j(ze*(i.object.top-i.object.bottom)/i.object.zoom/$e.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}})();function ee(ue){i.object instanceof Gn&&i.object.isPerspectiveCamera?d/=ue:i.object instanceof qa&&i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*ue)),i.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function O(ue){i.object instanceof Gn&&i.object.isPerspectiveCamera?d*=ue:i.object instanceof qa&&i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/ue)),i.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function W(ue){v.set(ue.clientX,ue.clientY)}function H(ue){A.set(ue.clientX,ue.clientY)}function Y(ue){y.set(ue.clientX,ue.clientY)}function z(ue){g.set(ue.clientX,ue.clientY),m.subVectors(g,v).multiplyScalar(i.rotateSpeed);const Me=i.domElement;Me&&(F(2*Math.PI*m.x/Me.clientHeight),B(2*Math.PI*m.y/Me.clientHeight)),v.copy(g),i.update()}function X(ue){S.set(ue.clientX,ue.clientY),T.subVectors(S,A),T.y>0?ee(R()):T.y<0&&O(R()),A.copy(S),i.update()}function q(ue){w.set(ue.clientX,ue.clientY),b.subVectors(w,y).multiplyScalar(i.panSpeed),Z(b.x,b.y),y.copy(w),i.update()}function re(ue){ue.deltaY<0?O(R()):ue.deltaY>0&&ee(R()),i.update()}function G(ue){let Me=!1;switch(ue.code){case i.keys.UP:Z(0,i.keyPanSpeed),Me=!0;break;case i.keys.BOTTOM:Z(0,-i.keyPanSpeed),Me=!0;break;case i.keys.LEFT:Z(i.keyPanSpeed,0),Me=!0;break;case i.keys.RIGHT:Z(-i.keyPanSpeed,0),Me=!0;break}Me&&(ue.preventDefault(),i.update())}function K(){if(M.length==1)v.set(M[0].pageX,M[0].pageY);else{const ue=.5*(M[0].pageX+M[1].pageX),Me=.5*(M[0].pageY+M[1].pageY);v.set(ue,Me)}}function oe(){if(M.length==1)y.set(M[0].pageX,M[0].pageY);else{const ue=.5*(M[0].pageX+M[1].pageX),Me=.5*(M[0].pageY+M[1].pageY);y.set(ue,Me)}}function ve(){const ue=M[0].pageX-M[1].pageX,Me=M[0].pageY-M[1].pageY,Be=Math.sqrt(ue*ue+Me*Me);A.set(0,Be)}function $(){i.enableZoom&&ve(),i.enablePan&&oe()}function se(){i.enableZoom&&ve(),i.enableRotate&&K()}function ne(ue){if(M.length==1)g.set(ue.pageX,ue.pageY);else{const Be=Ve(ue),ze=.5*(ue.pageX+Be.x),$e=.5*(ue.pageY+Be.y);g.set(ze,$e)}m.subVectors(g,v).multiplyScalar(i.rotateSpeed);const Me=i.domElement;Me&&(F(2*Math.PI*m.x/Me.clientHeight),B(2*Math.PI*m.y/Me.clientHeight)),v.copy(g)}function ie(ue){if(M.length==1)w.set(ue.pageX,ue.pageY);else{const Me=Ve(ue),Be=.5*(ue.pageX+Me.x),ze=.5*(ue.pageY+Me.y);w.set(Be,ze)}b.subVectors(w,y).multiplyScalar(i.panSpeed),Z(b.x,b.y),y.copy(w)}function me(ue){const Me=Ve(ue),Be=ue.pageX-Me.x,ze=ue.pageY-Me.y,$e=Math.sqrt(Be*Be+ze*ze);S.set(0,$e),T.set(0,Math.pow(S.y/A.y,i.zoomSpeed)),ee(T.y),A.copy(S)}function xe(ue){i.enableZoom&&me(ue),i.enablePan&&ie(ue)}function Ae(ue){i.enableZoom&&me(ue),i.enableRotate&&ne(ue)}function _e(ue){if(i.enabled!==!1){if(M.length===0){var Me,Be;(Me=i.domElement)===null||Me===void 0||Me.ownerDocument.addEventListener("pointermove",Ee),(Be=i.domElement)===null||Be===void 0||Be.ownerDocument.addEventListener("pointerup",Re)}Qe(ue),ue.pointerType==="touch"?we(ue):Ne(ue)}}function Ee(ue){i.enabled!==!1&&(ue.pointerType==="touch"?Te(ue):U(ue))}function Re(ue){if(Ge(ue),M.length===0){var Me,Be,ze;(Me=i.domElement)===null||Me===void 0||Me.releasePointerCapture(ue.pointerId),(Be=i.domElement)===null||Be===void 0||Be.ownerDocument.removeEventListener("pointermove",Ee),(ze=i.domElement)===null||ze===void 0||ze.ownerDocument.removeEventListener("pointerup",Re)}i.dispatchEvent(o),l=a.NONE}function Ue(ue){Ge(ue)}function Ne(ue){let Me;switch(ue.button){case 0:Me=i.mouseButtons.LEFT;break;case 1:Me=i.mouseButtons.MIDDLE;break;case 2:Me=i.mouseButtons.RIGHT;break;default:Me=-1}switch(Me){case Fd.DOLLY:if(i.enableZoom===!1)return;H(ue),l=a.DOLLY;break;case Fd.ROTATE:if(ue.ctrlKey||ue.metaKey||ue.shiftKey){if(i.enablePan===!1)return;Y(ue),l=a.PAN}else{if(i.enableRotate===!1)return;W(ue),l=a.ROTATE}break;case Fd.PAN:if(ue.ctrlKey||ue.metaKey||ue.shiftKey){if(i.enableRotate===!1)return;W(ue),l=a.ROTATE}else{if(i.enablePan===!1)return;Y(ue),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&i.dispatchEvent(s)}function U(ue){if(i.enabled!==!1)switch(l){case a.ROTATE:if(i.enableRotate===!1)return;z(ue);break;case a.DOLLY:if(i.enableZoom===!1)return;X(ue);break;case a.PAN:if(i.enablePan===!1)return;q(ue);break}}function L(ue){i.enabled===!1||i.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||(ue.preventDefault(),i.dispatchEvent(s),re(ue),i.dispatchEvent(o))}function te(ue){i.enabled===!1||i.enablePan===!1||G(ue)}function we(ue){switch(ye(ue),M.length){case 1:switch(i.touches.ONE){case Nd.ROTATE:if(i.enableRotate===!1)return;K(),l=a.TOUCH_ROTATE;break;case Nd.PAN:if(i.enablePan===!1)return;oe(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(i.touches.TWO){case Nd.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;$(),l=a.TOUCH_DOLLY_PAN;break;case Nd.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;se(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&i.dispatchEvent(s)}function Te(ue){switch(ye(ue),l){case a.TOUCH_ROTATE:if(i.enableRotate===!1)return;ne(ue),i.update();break;case a.TOUCH_PAN:if(i.enablePan===!1)return;ie(ue),i.update();break;case a.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;xe(ue),i.update();break;case a.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;Ae(ue),i.update();break;default:l=a.NONE}}function Ie(ue){i.enabled!==!1&&ue.preventDefault()}function Qe(ue){M.push(ue)}function Ge(ue){delete E[ue.pointerId];for(let Me=0;Me<M.length;Me++)if(M[Me].pointerId==ue.pointerId){M.splice(Me,1);return}}function ye(ue){let Me=E[ue.pointerId];Me===void 0&&(Me=new Ye,E[ue.pointerId]=Me),Me.set(ue.pageX,ue.pageY)}function Ve(ue){const Me=ue.pointerId===M[0].pointerId?M[1]:M[0];return E[Me.pointerId]}n!==void 0&&this.connect(n),this.update()}};class oO extends ws{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(n){return new rpe(n)}),this.register(function(n){return new hpe(n)}),this.register(function(n){return new dpe(n)}),this.register(function(n){return new fpe(n)}),this.register(function(n){return new ope(n)}),this.register(function(n){return new ape(n)}),this.register(function(n){return new lpe(n)}),this.register(function(n){return new cpe(n)}),this.register(function(n){return new ipe(n)}),this.register(function(n){return new upe(n)}),this.register(function(n){return new spe(n)}),this.register(function(n){return new tpe(n)}),this.register(function(n){return new ppe(n)}),this.register(function(n){return new mpe(n)})}load(e,n,i,r){const s=this;let o;this.resourcePath!==""?o=this.resourcePath:this.path!==""?o=this.path:o=Hg.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new bo(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(h){n(h),s.manager.itemEnd(e)},a)}catch(h){a(h)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,n,i,r){let s;const o={},a={},l=new TextDecoder;if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===nq){try{o[pn.KHR_BINARY_GLTF]=new gpe(e)}catch(u){r&&r(u);return}s=JSON.parse(o[pn.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const c=new Ppe(s,{path:n||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const u=this.pluginCallbacks[h](c);a[u.name]=u,o[u.name]=!0}if(s.extensionsUsed)for(let h=0;h<s.extensionsUsed.length;++h){const u=s.extensionsUsed[h],d=s.extensionsRequired||[];switch(u){case pn.KHR_MATERIALS_UNLIT:o[u]=new npe;break;case pn.KHR_DRACO_MESH_COMPRESSION:o[u]=new vpe(s,this.dracoLoader);break;case pn.KHR_TEXTURE_TRANSFORM:o[u]=new ype;break;case pn.KHR_MESH_QUANTIZATION:o[u]=new xpe;break;default:d.indexOf(u)>=0&&a[u]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+u+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(i,r)}parseAsync(e,n){const i=this;return new Promise(function(r,s){i.parse(e,n,r,s)})}}function epe(){let t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}}}}const pn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class tpe{constructor(e){this.parser=e,this.name=pn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,n=this.parser.json.nodes||[];for(let i=0,r=n.length;i<r;i++){const s=n[i];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const n=this.parser,i="light:"+e;let r=n.cache.get(i);if(r)return r;const s=n.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const h=new st(16777215);l.color!==void 0&&h.fromArray(l.color);const u=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new JB(h),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new KB(h),c.distance=u;break;case"spot":c=new QB(h),c.distance=u,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,eh(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=n.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),n.cache.add(i,r),r}getDependency(e,n){if(e==="light")return this._loadLight(n)}createNodeAttachment(e){const n=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return i._getNodeRef(n.cache,a,l)})}}class npe{constructor(){this.name=pn.KHR_MATERIALS_UNLIT}getMaterialType(){return lo}extendParams(e,n,i){const r=[];e.color=new st(1,1,1),e.opacity=1;const s=n.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}s.baseColorTexture!==void 0&&r.push(i.assignTexture(e,"map",s.baseColorTexture,yo))}return Promise.all(r)}}class ipe{constructor(e){this.parser=e,this.name=pn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,n){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(n.emissiveIntensity=s),Promise.resolve()}}class rpe{constructor(e){this.parser=e,this.name=pn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:mu}extendMaterialParams(e,n){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(o.clearcoatFactor!==void 0&&(n.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(i.assignTexture(n,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(n.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(i.assignTexture(n,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(i.assignTexture(n,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;n.clearcoatNormalScale=new Ye(a,a)}return Promise.all(s)}}class spe{constructor(e){this.parser=e,this.name=pn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:mu}extendMaterialParams(e,n){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.iridescenceFactor!==void 0&&(n.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(i.assignTexture(n,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(n.iridescenceIOR=o.iridescenceIor),n.iridescenceThicknessRange===void 0&&(n.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(n.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(n.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(i.assignTexture(n,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class ope{constructor(e){this.parser=e,this.name=pn.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:mu}extendMaterialParams(e,n){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];n.sheenColor=new st(0,0,0),n.sheenRoughness=0,n.sheen=1;const o=r.extensions[this.name];return o.sheenColorFactor!==void 0&&n.sheenColor.fromArray(o.sheenColorFactor),o.sheenRoughnessFactor!==void 0&&(n.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(i.assignTexture(n,"sheenColorMap",o.sheenColorTexture,yo)),o.sheenRoughnessTexture!==void 0&&s.push(i.assignTexture(n,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class ape{constructor(e){this.parser=e,this.name=pn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:mu}extendMaterialParams(e,n){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.transmissionFactor!==void 0&&(n.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(i.assignTexture(n,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class lpe{constructor(e){this.parser=e,this.name=pn.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:mu}extendMaterialParams(e,n){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];n.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(i.assignTexture(n,"thicknessMap",o.thicknessTexture)),n.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return n.attenuationColor=new st(a[0],a[1],a[2]),Promise.all(s)}}class cpe{constructor(e){this.parser=e,this.name=pn.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:mu}extendMaterialParams(e,n){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return n.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class upe{constructor(e){this.parser=e,this.name=pn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:mu}extendMaterialParams(e,n){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];n.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(i.assignTexture(n,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return n.specularColor=new st(a[0],a[1],a[2]),o.specularColorTexture!==void 0&&s.push(i.assignTexture(n,"specularColorMap",o.specularColorTexture,yo)),Promise.all(s)}}class hpe{constructor(e){this.parser=e,this.name=pn.KHR_TEXTURE_BASISU}loadTexture(e){const n=this.parser,i=n.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=n.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return n.loadTextureImage(e,s.source,o)}}class dpe{constructor(e){this.parser=e,this.name=pn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const n=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[n])return null;const o=s.extensions[n],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class fpe{constructor(e){this.parser=e,this.name=pn.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const n=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[n])return null;const o=s.extensions[n],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class ppe{constructor(e){this.name=pn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const n=this.parser.json,i=n.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const l=r.byteOffset||0,c=r.byteLength||0,h=r.count,u=r.byteStride,d=new Uint8Array(a,l,c);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(h,u,d,r.mode,r.filter).then(function(f){return f.buffer}):o.ready.then(function(){const f=new ArrayBuffer(h*u);return o.decodeGltfBuffer(new Uint8Array(f),h,u,d,r.mode,r.filter),f})})}else return null}}class mpe{constructor(e){this.name=pn.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const n=this.parser.json,i=n.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const r=n.meshes[i.mesh];for(const c of r.primitives)if(c.mode!==Wo.TRIANGLES&&c.mode!==Wo.TRIANGLE_STRIP&&c.mode!==Wo.TRIANGLE_FAN&&c.mode!==void 0)return null;const o=i.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(h=>(l[c]=h,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const h=c.pop(),u=h.isGroup?h.children:[h],d=c[0].count,f=[];for(const p of u){const v=new kt,g=new ae,m=new _r,y=new ae(1,1,1),w=new IB(p.geometry,p.material,d);for(let b=0;b<d;b++)l.TRANSLATION&&g.fromBufferAttribute(l.TRANSLATION,b),l.ROTATION&&m.fromBufferAttribute(l.ROTATION,b),l.SCALE&&y.fromBufferAttribute(l.SCALE,b),w.setMatrixAt(b,v.compose(g,m,y));for(const b in l)b!=="TRANSLATION"&&b!=="ROTATION"&&b!=="SCALE"&&p.geometry.setAttribute(b,l[b]);mn.prototype.copy.call(w,p),this.parser.assignFinalMaterial(w),f.push(w)}return h.isGroup?(h.clear(),h.add(...f),h):f[0]}))}}const nq="glTF",v0=12,lG={JSON:1313821514,BIN:5130562};class gpe{constructor(e){this.name=pn.KHR_BINARY_GLTF,this.content=null,this.body=null;const n=new DataView(e,0,v0),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==nq)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-v0,s=new DataView(e,v0);let o=0;for(;o<r;){const a=s.getUint32(o,!0);o+=4;const l=s.getUint32(o,!0);if(o+=4,l===lG.JSON){const c=new Uint8Array(e,v0+o,a);this.content=i.decode(c)}else if(l===lG.BIN){const c=v0+o;this.body=e.slice(c,c+a)}o+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class vpe{constructor(e,n){if(!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=pn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=n,this.dracoLoader.preload()}decodePrimitive(e,n){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const h in o){const u=vL[h]||h.toLowerCase();a[u]=o[h]}for(const h in e.attributes){const u=vL[h]||h.toLowerCase();if(o[h]!==void 0){const d=i.accessors[e.attributes[h]],f=hg[d.componentType];c[u]=f.name,l[u]=d.normalized===!0}}return n.getDependency("bufferView",s).then(function(h){return new Promise(function(u){r.decodeDracoFile(h,function(d){for(const f in d.attributes){const p=d.attributes[f],v=l[f];v!==void 0&&(p.normalized=v)}u(d)},a,c)})})}}class ype{constructor(){this.name=pn.KHR_TEXTURE_TRANSFORM}extendTexture(e,n){return(n.texCoord===void 0||n.texCoord===e.channel)&&n.offset===void 0&&n.rotation===void 0&&n.scale===void 0||(e=e.clone(),n.texCoord!==void 0&&(e.channel=n.texCoord),n.offset!==void 0&&e.offset.fromArray(n.offset),n.rotation!==void 0&&(e.rotation=n.rotation),n.scale!==void 0&&e.repeat.fromArray(n.scale),e.needsUpdate=!0),e}}class xpe{constructor(){this.name=pn.KHR_MESH_QUANTIZATION}}class iq extends gv{constructor(e,n,i,r){super(e,n,i,r)}copySampleValue_(e){const n=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)n[o]=i[s+o];return n}interpolate_(e,n,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,c=a*3,h=r-n,u=(i-n)/h,d=u*u,f=d*u,p=e*c,v=p-c,g=-2*f+3*d,m=f-d,y=1-g,w=m-d+u;for(let b=0;b!==a;b++){const A=o[v+b+a],S=o[v+b+l]*h,T=o[p+b+a],M=o[p+b]*h;s[b]=y*A+w*S+g*T+m*M}return s}}const wpe=new _r;class _pe extends iq{interpolate_(e,n,i,r){const s=super.interpolate_(e,n,i,r);return wpe.fromArray(s).normalize().toArray(s),s}}const Wo={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},hg={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},cG={9728:yi,9729:ai,9984:gx,9985:QM,9986:ag,9987:$l},uG={33071:Pr,33648:Ig,10497:jh},_P={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},vL={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Iu={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},bpe={CUBICSPLINE:void 0,LINEAR:Lf,STEP:Og},bP={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Spe(t){return t.DefaultMaterial===void 0&&(t.DefaultMaterial=new M1({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Zl})),t.DefaultMaterial}function y0(t,e,n){for(const i in n.extensions)t[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=n.extensions[i])}function eh(t,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Ape(t,e,n){let i=!1,r=!1,s=!1;for(let c=0,h=e.length;c<h;c++){const u=e[c];if(u.POSITION!==void 0&&(i=!0),u.NORMAL!==void 0&&(r=!0),u.COLOR_0!==void 0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(t);const o=[],a=[],l=[];for(let c=0,h=e.length;c<h;c++){const u=e[c];if(i){const d=u.POSITION!==void 0?n.getDependency("accessor",u.POSITION):t.attributes.position;o.push(d)}if(r){const d=u.NORMAL!==void 0?n.getDependency("accessor",u.NORMAL):t.attributes.normal;a.push(d)}if(s){const d=u.COLOR_0!==void 0?n.getDependency("accessor",u.COLOR_0):t.attributes.color;l.push(d)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const h=c[0],u=c[1],d=c[2];return i&&(t.morphAttributes.position=h),r&&(t.morphAttributes.normal=u),s&&(t.morphAttributes.color=d),t.morphTargetsRelative=!0,t})}function Mpe(t,e){if(t.updateMorphTargets(),e.weights!==void 0)for(let n=0,i=e.weights.length;n<i;n++)t.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){const n=e.extras.targetNames;if(t.morphTargetInfluences.length===n.length){t.morphTargetDictionary={};for(let i=0,r=n.length;i<r;i++)t.morphTargetDictionary[n[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Epe(t){const e=t.extensions&&t.extensions[pn.KHR_DRACO_MESH_COMPRESSION];let n;return e?n="draco:"+e.bufferView+":"+e.indices+":"+hG(e.attributes):n=t.indices+":"+hG(t.attributes)+":"+t.mode,n}function hG(t){let e="";const n=Object.keys(t).sort();for(let i=0,r=n.length;i<r;i++)e+=n[i]+":"+t[n[i]]+";";return e}function yL(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Cpe(t){return t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0?"image/jpeg":t.search(/\.webp($|\?)/i)>0||t.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const Tpe=new kt;class Ppe{constructor(e={},n={}){this.json=e,this.extensions={},this.plugins={},this.options=n,this.cache=new epe,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||i||r&&s<98?this.textureLoader=new mY(this.options.manager):this.textureLoader=new bY(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new bo(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,n){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};y0(s,a,r),eh(a,r),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(n)}_markDefs(){const e=this.json.nodes||[],n=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=n.length;r<s;r++){const o=n[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(i[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,n){n!==void 0&&(e.refs[n]===void 0&&(e.refs[n]=e.uses[n]=0),e.refs[n]++)}_getNodeRef(e,n,i){if(e.refs[n]<=1)return i;const r=i.clone(),s=(o,a)=>{const l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(const[c,h]of o.children.entries())s(h,a.children[c])};return s(i,r),r.name+="_instance_"+e.uses[n]++,r}_invokeOne(e){const n=Object.values(this.plugins);n.push(this);for(let i=0;i<n.length;i++){const r=e(n[i]);if(r)return r}return null}_invokeAll(e){const n=Object.values(this.plugins);n.unshift(this);const i=[];for(let r=0;r<n.length;r++){const s=e(n[r]);s&&i.push(s)}return i}getDependency(e,n){const i=e+":"+n;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(n);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(n)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(n)});break;case"accessor":r=this.loadAccessor(n);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(n)});break;case"buffer":r=this.loadBuffer(n);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(n)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(n)});break;case"skin":r=this.loadSkin(n);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(n)});break;case"camera":r=this.loadCamera(n);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,n)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(i,r)}return r}getDependencies(e){let n=this.cache.get(e);if(!n){const i=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];n=Promise.all(r.map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,n)}return n}loadBuffer(e){const n=this.json.buffers[e],i=this.fileLoader;if(n.type&&n.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(n.uri===void 0&&e===0)return Promise.resolve(this.extensions[pn.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(Hg.resolveURL(n.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})}loadBufferView(e){const n=this.json.bufferViews[e];return this.getDependency("buffer",n.buffer).then(function(i){const r=n.byteLength||0,s=n.byteOffset||0;return i.slice(s,s+r)})}loadAccessor(e){const n=this,i=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const o=_P[r.type],a=hg[r.componentType],l=r.normalized===!0,c=new a(r.count*o);return Promise.resolve(new Sn(c,o,l))}const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=_P[r.type],c=hg[r.componentType],h=c.BYTES_PER_ELEMENT,u=h*l,d=r.byteOffset||0,f=r.bufferView!==void 0?i.bufferViews[r.bufferView].byteStride:void 0,p=r.normalized===!0;let v,g;if(f&&f!==u){const m=Math.floor(d/f),y="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+m+":"+r.count;let w=n.cache.get(y);w||(v=new c(a,m*f,r.count*f/h),w=new u1(v,f/h),n.cache.add(y,w)),g=new Wh(w,l,d%f/h,p)}else a===null?v=new c(r.count*l):v=new c(a,d,r.count*l),g=new Sn(v,l,p);if(r.sparse!==void 0){const m=_P.SCALAR,y=hg[r.sparse.indices.componentType],w=r.sparse.indices.byteOffset||0,b=r.sparse.values.byteOffset||0,A=new y(o[1],w,r.sparse.count*m),S=new c(o[2],b,r.sparse.count*l);a!==null&&(g=new Sn(g.array.slice(),g.itemSize,g.normalized));for(let T=0,M=A.length;T<M;T++){const E=A[T];if(g.setX(E,S[T*l]),l>=2&&g.setY(E,S[T*l+1]),l>=3&&g.setZ(E,S[T*l+2]),l>=4&&g.setW(E,S[T*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){const n=this.json,i=this.options,s=n.textures[e].source,o=n.images[s];let a=this.textureLoader;if(o.uri){const l=i.manager.getHandler(o.uri);l!==null&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,n,i){const r=this,s=this.json,o=s.textures[e],a=s.images[n],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(n,i).then(function(h){h.flipY=!1,h.name=o.name||a.name||"",h.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(h.name=a.uri);const d=(s.samplers||{})[o.sampler]||{};return h.magFilter=cG[d.magFilter]||ai,h.minFilter=cG[d.minFilter]||$l,h.wrapS=uG[d.wrapS]||jh,h.wrapT=uG[d.wrapT]||jh,r.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,n){const i=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(u=>u.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(o.bufferView!==void 0)l=i.getDependency("bufferView",o.bufferView).then(function(u){c=!0;const d=new Blob([u],{type:o.mimeType});return l=a.createObjectURL(d),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(l).then(function(u){return new Promise(function(d,f){let p=d;n.isImageBitmapLoader===!0&&(p=function(v){const g=new ii(v);g.needsUpdate=!0,d(g)}),n.load(Hg.resolveURL(u,s.path),p,void 0,f)})}).then(function(u){return c===!0&&a.revokeObjectURL(l),u.userData.mimeType=o.mimeType||Cpe(o.uri),u}).catch(function(u){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),u});return this.sourceCache[e]=h,h}assignTexture(e,n,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(o=o.clone(),o.channel=i.texCoord),s.extensions[pn.KHR_TEXTURE_TRANSFORM]){const a=i.extensions!==void 0?i.extensions[pn.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[pn.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return r!==void 0&&(o.encoding=r),e[n]=o,o})}assignFinalMaterial(e){const n=e.geometry;let i=e.material;const r=n.attributes.tangent===void 0,s=n.attributes.color!==void 0,o=n.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new d1,Vi.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new $r,Vi.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,this.cache.add(a,l)),i=l}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}e.material=i}getMaterialType(){return M1}loadMaterial(e){const n=this,i=this.json,r=this.extensions,s=i.materials[e];let o;const a={},l=s.extensions||{},c=[];if(l[pn.KHR_MATERIALS_UNLIT]){const u=r[pn.KHR_MATERIALS_UNLIT];o=u.getMaterialType(),c.push(u.extendParams(a,s,n))}else{const u=s.pbrMetallicRoughness||{};if(a.color=new st(1,1,1),a.opacity=1,Array.isArray(u.baseColorFactor)){const d=u.baseColorFactor;a.color.fromArray(d),a.opacity=d[3]}u.baseColorTexture!==void 0&&c.push(n.assignTexture(a,"map",u.baseColorTexture,yo)),a.metalness=u.metallicFactor!==void 0?u.metallicFactor:1,a.roughness=u.roughnessFactor!==void 0?u.roughnessFactor:1,u.metallicRoughnessTexture!==void 0&&(c.push(n.assignTexture(a,"metalnessMap",u.metallicRoughnessTexture)),c.push(n.assignTexture(a,"roughnessMap",u.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=na);const h=s.alphaMode||bP.OPAQUE;if(h===bP.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,h===bP.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==lo&&(c.push(n.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Ye(1,1),s.normalTexture.scale!==void 0)){const u=s.normalTexture.scale;a.normalScale.set(u,u)}return s.occlusionTexture!==void 0&&o!==lo&&(c.push(n.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==lo&&(a.emissive=new st().fromArray(s.emissiveFactor)),s.emissiveTexture!==void 0&&o!==lo&&c.push(n.assignTexture(a,"emissiveMap",s.emissiveTexture,yo)),Promise.all(c).then(function(){const u=new o(a);return s.name&&(u.name=s.name),eh(u,s),n.associations.set(u,{materials:e}),s.extensions&&y0(r,u,s),u})}createUniqueName(e){const n=fn.sanitizeNodeName(e||"");let i=n;for(let r=1;this.nodeNamesUsed[i];++r)i=n+"_"+r;return this.nodeNamesUsed[i]=!0,i}loadGeometries(e){const n=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[pn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,n).then(function(l){return dG(l,a,n)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],h=Epe(c),u=r[h];if(u)o.push(u.promise);else{let d;c.extensions&&c.extensions[pn.KHR_DRACO_MESH_COMPRESSION]?d=s(c):d=dG(new Kt,c,n),r[h]={primitive:c,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(e){const n=this,i=this.json,r=this.extensions,s=i.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const h=o[l].material===void 0?Spe(this.cache):this.getDependency("material",o[l].material);a.push(h)}return a.push(n.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),h=l[l.length-1],u=[];for(let f=0,p=h.length;f<p;f++){const v=h[f],g=o[f];let m;const y=c[f];if(g.mode===Wo.TRIANGLES||g.mode===Wo.TRIANGLE_STRIP||g.mode===Wo.TRIANGLE_FAN||g.mode===void 0)m=s.isSkinnedMesh===!0?new LB(v,y):new yr(v,y),m.isSkinnedMesh===!0&&m.normalizeSkinWeights(),g.mode===Wo.TRIANGLE_STRIP?m.geometry=oG(m.geometry,vB):g.mode===Wo.TRIANGLE_FAN&&(m.geometry=oG(m.geometry,xA));else if(g.mode===Wo.LINES)m=new sl(v,y);else if(g.mode===Wo.LINE_STRIP)m=new ou(v,y);else if(g.mode===Wo.LINE_LOOP)m=new BB(v,y);else if(g.mode===Wo.POINTS)m=new OB(v,y);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);Object.keys(m.geometry.morphAttributes).length>0&&Mpe(m,s),m.name=n.createUniqueName(s.name||"mesh_"+e),eh(m,s),g.extensions&&y0(r,m,g),n.assignFinalMaterial(m),u.push(m)}for(let f=0,p=u.length;f<p;f++)n.associations.set(u[f],{meshes:e,primitives:f});if(u.length===1)return u[0];const d=new Vc;n.associations.set(d,{meshes:e});for(let f=0,p=u.length;f<p;f++)d.add(u[f]);return d})}loadCamera(e){let n;const i=this.json.cameras[e],r=i[i.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?n=new Gn(D7.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):i.type==="orthographic"&&(n=new qa(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(n.name=this.createUniqueName(i.name)),eh(n,i),Promise.resolve(n)}loadSkin(e){const n=this.json.skins[e],i=[];for(let r=0,s=n.joints.length;r<s;r++)i.push(this._loadNodeShallow(n.joints[r]));return n.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",n.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let c=0,h=o.length;c<h;c++){const u=o[c];if(u){a.push(u);const d=new kt;s!==null&&d.fromArray(s.array,c*16),l.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',n.joints[c])}return new h1(a,l)})}loadAnimation(e){const i=this.json.animations[e],r=i.name?i.name:"animation_"+e,s=[],o=[],a=[],l=[],c=[];for(let h=0,u=i.channels.length;h<u;h++){const d=i.channels[h],f=i.samplers[d.sampler],p=d.target,v=p.node,g=i.parameters!==void 0?i.parameters[f.input]:f.input,m=i.parameters!==void 0?i.parameters[f.output]:f.output;p.node!==void 0&&(s.push(this.getDependency("node",v)),o.push(this.getDependency("accessor",g)),a.push(this.getDependency("accessor",m)),l.push(f),c.push(p))}return Promise.all([Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c)]).then(function(h){const u=h[0],d=h[1],f=h[2],p=h[3],v=h[4],g=[];for(let m=0,y=u.length;m<y;m++){const w=u[m],b=d[m],A=f[m],S=p[m],T=v[m];if(w===void 0)continue;w.updateMatrix();let M;switch(Iu[T.path]){case Iu.weights:M=kg;break;case Iu.rotation:M=Xh;break;case Iu.position:case Iu.scale:default:M=zg;break}const E=w.name?w.name:w.uuid,P=S.interpolation!==void 0?bpe[S.interpolation]:Lf,R=[];Iu[T.path]===Iu.weights?w.traverse(function(B){B.morphTargetInfluences&&R.push(B.name?B.name:B.uuid)}):R.push(E);let F=A.array;if(A.normalized){const B=yL(F.constructor),k=new Float32Array(F.length);for(let j=0,Z=F.length;j<Z;j++)k[j]=F[j]*B;F=k}for(let B=0,k=R.length;B<k;B++){const j=new M(R[B]+"."+Iu[T.path],b.array,F,P);S.interpolation==="CUBICSPLINE"&&(j.createInterpolant=function(ee){const O=this instanceof Xh?_pe:iq;return new O(this.times,this.values,this.getValueSize()/3,ee)},j.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),g.push(j)}}return new Gg(r,void 0,g)})}createNodeMesh(e){const n=this.json,i=this,r=n.nodes[e];return r.mesh===void 0?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return r.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const n=this.json,i=this,r=n.nodes[e],s=i._loadNodeShallow(e),o=[],a=r.children||[];for(let c=0,h=a.length;c<h;c++)o.push(i.getDependency("node",a[c]));const l=r.skin===void 0?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const h=c[0],u=c[1],d=c[2];d!==null&&h.traverse(function(f){f.isSkinnedMesh&&f.bind(d,Tpe)});for(let f=0,p=u.length;f<p;f++)h.add(u[f]);return h})}_loadNodeShallow(e){const n=this.json,i=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=n.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let h;if(s.isBone===!0?h=new nE:c.length>1?h=new Vc:c.length===1?h=c[0]:h=new mn,h!==c[0])for(let u=0,d=c.length;u<d;u++)h.add(c[u]);if(s.name&&(h.userData.name=s.name,h.name=o),eh(h,s),s.extensions&&y0(i,h,s),s.matrix!==void 0){const u=new kt;u.fromArray(s.matrix),h.applyMatrix4(u)}else s.translation!==void 0&&h.position.fromArray(s.translation),s.rotation!==void 0&&h.quaternion.fromArray(s.rotation),s.scale!==void 0&&h.scale.fromArray(s.scale);return r.associations.has(h)||r.associations.set(h,{}),r.associations.get(h).nodes=e,h}),this.nodeCache[e]}loadScene(e){const n=this.extensions,i=this.json.scenes[e],r=this,s=new Vc;i.name&&(s.name=r.createUniqueName(i.name)),eh(s,i),i.extensions&&y0(n,s,i);const o=i.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let h=0,u=l.length;h<u;h++)s.add(l[h]);const c=h=>{const u=new Map;for(const[d,f]of r.associations)(d instanceof Vi||d instanceof ii)&&u.set(d,f);return h.traverse(d=>{const f=r.associations.get(d);f!=null&&u.set(d,f)}),u};return r.associations=c(s),s})}}function Dpe(t,e,n){const i=e.attributes,r=new il;if(i.POSITION!==void 0){const a=n.json.accessors[i.POSITION],l=a.min,c=a.max;if(l!==void 0&&c!==void 0){if(r.set(new ae(l[0],l[1],l[2]),new ae(c[0],c[1],c[2])),a.normalized){const h=yL(hg[a.componentType]);r.min.multiplyScalar(h),r.max.multiplyScalar(h)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new ae,l=new ae;for(let c=0,h=s.length;c<h;c++){const u=s[c];if(u.POSITION!==void 0){const d=n.json.accessors[u.POSITION],f=d.min,p=d.max;if(f!==void 0&&p!==void 0){if(l.setX(Math.max(Math.abs(f[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(f[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(f[2]),Math.abs(p[2]))),d.normalized){const v=yL(hg[d.componentType]);l.multiplyScalar(v)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}t.boundingBox=r;const o=new rl;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,t.boundingSphere=o}function dG(t,e,n){const i=e.attributes,r=[];function s(o,a){return n.getDependency("accessor",o).then(function(l){t.setAttribute(a,l)})}for(const o in i){const a=vL[o]||o.toLowerCase();a in t.attributes||r.push(s(i[o],a))}if(e.indices!==void 0&&!t.index){const o=n.getDependency("accessor",e.indices).then(function(a){t.setIndex(a)});r.push(o)}return eh(t,e),Dpe(t,e,n),Promise.all(r).then(function(){return e.targets!==void 0?Ape(t,e.targets,n):t})}const SP=new WeakMap;class Rpe extends ws{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,n,i,r){const s=new bo(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{const a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,a).then(n).catch(r)},i,r)}decodeDracoFile(e,n,i,r){const s={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!i};this.decodeGeometry(e,s).then(n)}decodeGeometry(e,n){for(const l in n.attributeTypes){const c=n.attributeTypes[l];c.BYTES_PER_ELEMENT!==void 0&&(n.attributeTypes[l]=c.name)}const i=JSON.stringify(n);if(SP.has(e)){const l=SP.get(e);if(l.key===i)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,o=e.byteLength,a=this._getWorker(s,o).then(l=>(r=l,new Promise((c,h)=>{r._callbacks[s]={resolve:c,reject:h},r.postMessage({type:"decode",id:s,taskConfig:n,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),SP.set(e,{key:i,promise:a}),a}_createGeometry(e){const n=new Kt;e.index&&n.setIndex(new Sn(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const r=e.attributes[i],s=r.name,o=r.array,a=r.itemSize;n.setAttribute(s,new Sn(o,a))}return n}_loadLibrary(e,n){const i=new bo(this.manager);return i.setPath(this.decoderPath),i.setResponseType(n),i.setWithCredentials(this.withCredentials),new Promise((r,s)=>{i.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",n=[];return e?n.push(this._loadLibrary("draco_decoder.js","text")):(n.push(this._loadLibrary("draco_wasm_wrapper.js","text")),n.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(n).then(i=>{const r=i[0];e||(this.decoderConfig.wasmBinary=i[1]);const s=Lpe.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,n){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=n,i._taskLoad+=n,i})}_releaseTask(e,n){e._taskLoad-=e._taskCosts[n],delete e._callbacks[n],delete e._taskCosts[n]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function Lpe(){let t,e;onmessage=function(o){const a=o.data;switch(a.type){case"init":t=a.decoderConfig,e=new Promise(function(h){t.onModuleLoaded=function(u){h({draco:u})},DracoDecoderModule(t)});break;case"decode":const l=a.buffer,c=a.taskConfig;e.then(h=>{const u=h.draco,d=new u.Decoder,f=new u.DecoderBuffer;f.Init(new Int8Array(l),l.byteLength);try{const p=n(u,d,f,c),v=p.attributes.map(g=>g.array.buffer);p.index&&v.push(p.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:p},v)}catch(p){console.error(p),self.postMessage({type:"error",id:a.id,error:p.message})}finally{u.destroy(f),u.destroy(d)}});break}};function n(o,a,l,c){const h=c.attributeIDs,u=c.attributeTypes;let d,f;const p=a.GetEncodedGeometryType(l);if(p===o.TRIANGULAR_MESH)d=new o.Mesh,f=a.DecodeBufferToMesh(l,d);else if(p===o.POINT_CLOUD)d=new o.PointCloud,f=a.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!f.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());const v={index:null,attributes:[]};for(const g in h){const m=self[u[g]];let y,w;if(c.useUniqueIDs)w=h[g],y=a.GetAttributeByUniqueId(d,w);else{if(w=a.GetAttributeId(d,o[h[g]]),w===-1)continue;y=a.GetAttribute(d,w)}v.attributes.push(r(o,a,d,g,m,y))}return p===o.TRIANGULAR_MESH&&(v.index=i(o,a,d)),o.destroy(d),v}function i(o,a,l){const h=l.num_faces()*3,u=h*4,d=o._malloc(u);a.GetTrianglesUInt32Array(l,u,d);const f=new Uint32Array(o.HEAPF32.buffer,d,h).slice();return o._free(d),{array:f,itemSize:1}}function r(o,a,l,c,h,u){const d=u.num_components(),p=l.num_points()*d,v=p*h.BYTES_PER_ELEMENT,g=s(o,h),m=o._malloc(v);a.GetAttributeDataArrayForAllPoints(l,u,g,v,m);const y=new h(o.HEAPF32.buffer,m,p).slice();return o._free(m),{name:c,array:y,itemSize:d}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}let Y_;const AP=()=>{if(Y_)return Y_;const t="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",n=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),i=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let r=t;WebAssembly.validate(n)&&(r=e);let s;const o=WebAssembly.instantiate(a(r),{}).then(u=>{s=u.instance,s.exports.__wasm_call_ctors()});function a(u){const d=new Uint8Array(u.length);for(let p=0;p<u.length;++p){const v=u.charCodeAt(p);d[p]=v>96?v-71:v>64?v-65:v>47?v+4:v>46?63:62}let f=0;for(let p=0;p<u.length;++p)d[f++]=d[p]<60?i[d[p]]:(d[p]-60)*64+d[++p];return d.buffer.slice(0,f)}function l(u,d,f,p,v,g){const m=s.exports.sbrk,y=f+3&-4,w=m(y*p),b=m(v.length),A=new Uint8Array(s.exports.memory.buffer);A.set(v,b);const S=u(w,f,p,b,v.length);if(S===0&&g&&g(w,y,p),d.set(A.subarray(w,w+f*p)),m(w-m(0)),S!==0)throw new Error(`Malformed buffer data: ${S}`)}const c={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},h={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return Y_={ready:o,supported:!0,decodeVertexBuffer(u,d,f,p,v){l(s.exports.meshopt_decodeVertexBuffer,u,d,f,p,s.exports[c[v]])},decodeIndexBuffer(u,d,f,p){l(s.exports.meshopt_decodeIndexBuffer,u,d,f,p)},decodeIndexSequence(u,d,f,p){l(s.exports.meshopt_decodeIndexSequence,u,d,f,p)},decodeGltfBuffer(u,d,f,p,v,g){l(s.exports[h[v]],u,d,f,p,s.exports[c[g]])}},Y_};let q_=null;function rq(t,e,n){return i=>{n&&n(i),t&&(q_||(q_=new Rpe),q_.setDecoderPath(typeof t=="string"?t:"https://www.gstatic.com/draco/versioned/decoders/1.5.5/"),i.setDRACOLoader(q_)),e&&i.setMeshoptDecoder(typeof AP=="function"?AP():AP)}}function aO(t,e=!0,n=!0,i){return T1(oO,t,rq(e,n,i))}aO.preload=(t,e=!0,n=!0,i)=>T1.preload(oO,t,rq(e,n,i));aO.clear=t=>T1.clear(oO,t);const Ipe=ge.forwardRef(({makeDefault:t,camera:e,regress:n,domElement:i,enableDamping:r=!0,onChange:s,onStart:o,onEnd:a,...l},c)=>{const h=qo(A=>A.invalidate),u=qo(A=>A.camera),d=qo(A=>A.gl),f=qo(A=>A.events),p=qo(A=>A.setEvents),v=qo(A=>A.set),g=qo(A=>A.get),m=qo(A=>A.performance),y=e||u,w=i||f.connected||d.domElement,b=ge.useMemo(()=>new $fe(y),[y]);return C1(()=>{b.enabled&&b.update()},-1),ge.useEffect(()=>(b.connect(w),()=>void b.dispose()),[w,n,b,h]),ge.useEffect(()=>{const A=M=>{h(),n&&m.regress(),s&&s(M)},S=M=>{o&&o(M)},T=M=>{a&&a(M)};return b.addEventListener("change",A),b.addEventListener("start",S),b.addEventListener("end",T),()=>{b.removeEventListener("start",S),b.removeEventListener("end",T),b.removeEventListener("change",A)}},[s,o,a,b,h,p]),ge.useEffect(()=>{if(t){const A=g().controls;return v({controls:b}),()=>v({controls:A})}},[t,b]),ge.createElement("primitive",$a({ref:c,object:b,enableDamping:r},l))});class Bpe extends d1{constructor(e){super(e),this.onBeforeCompile=(n,i)=>{const{isWebGL2:r}=i.capabilities;n.fragmentShader=n.fragmentShader.replace("#include <output_fragment>",`
        ${r?"#include <output_fragment>":`#extension GL_OES_standard_derivatives : enable
#include <output_fragment>`}
      vec2 cxy = 2.0 * gl_PointCoord - 1.0;
      float r = dot(cxy, cxy);
      float delta = fwidth(r);     
      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);
      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );
      #include <tonemapping_fragment>
      #include <encodings_fragment>
      `)}}}const Ope=ge.forwardRef((t,e)=>{const[n]=ge.useState(()=>new Bpe(null));return ge.createElement("primitive",$a({},t,{object:n,ref:e,attach:"material"}))});let Md,x0;const Fpe=ge.createContext(null),fG=new kt,pG=new ae,Npe=ge.forwardRef(({children:t,range:e,limit:n=1e3,...i},r)=>{const s=ge.useRef(null),[o,a]=ge.useState([]),[[l,c,h]]=ge.useState(()=>[new Float32Array(n*3),Float32Array.from({length:n*3},()=>1),Float32Array.from({length:n},()=>1)]);ge.useEffect(()=>{s.current.geometry.attributes.position.needsUpdate=!0}),C1(()=>{for(s.current.updateMatrix(),s.current.updateMatrixWorld(),fG.copy(s.current.matrixWorld).invert(),s.current.geometry.drawRange.count=Math.min(n,e!==void 0?e:n,o.length),Md=0;Md<o.length;Md++)x0=o[Md].current,x0.getWorldPosition(pG).applyMatrix4(fG),pG.toArray(l,Md*3),s.current.geometry.attributes.position.needsUpdate=!0,x0.matrixWorldNeedsUpdate=!0,x0.color.toArray(c,Md*3),s.current.geometry.attributes.color.needsUpdate=!0,h.set([x0.size],Md),s.current.geometry.attributes.size.needsUpdate=!0});const u=ge.useMemo(()=>({getParent:()=>s,subscribe:d=>(a(f=>[...f,d]),()=>a(f=>f.filter(p=>p.current!==d.current)))}),[]);return ge.createElement("points",$a({userData:{instances:o},matrixAutoUpdate:!1,ref:eq([r,s]),raycast:()=>null},i),ge.createElement("bufferGeometry",null,ge.createElement("bufferAttribute",{attach:"attributes-position",count:l.length/3,array:l,itemSize:3,usage:pf}),ge.createElement("bufferAttribute",{attach:"attributes-color",count:c.length/3,array:c,itemSize:3,usage:pf}),ge.createElement("bufferAttribute",{attach:"attributes-size",count:h.length,array:h,itemSize:1,usage:pf})),ge.createElement(Fpe.Provider,{value:u},t))}),Upe=ge.forwardRef(({children:t,positions:e,colors:n,sizes:i,stride:r=3,...s},o)=>{const a=ge.useRef(null);return C1(()=>{const l=a.current.geometry.attributes;l.position.needsUpdate=!0,n&&(l.color.needsUpdate=!0),i&&(l.size.needsUpdate=!0)}),ge.createElement("points",$a({ref:eq([o,a])},s),ge.createElement("bufferGeometry",null,ge.createElement("bufferAttribute",{attach:"attributes-position",count:e.length/r,array:e,itemSize:r,usage:pf}),n&&ge.createElement("bufferAttribute",{attach:"attributes-color",count:n.length/r,array:n,itemSize:3,usage:pf}),i&&ge.createElement("bufferAttribute",{attach:"attributes-size",count:i.length/r,array:i,itemSize:1,usage:pf})),t)}),kpe=ge.forwardRef((t,e)=>t.positions instanceof Float32Array?ge.createElement(Upe,$a({},t,{ref:e})):ge.createElement(Npe,$a({},t,{ref:e})));var sq={exports:{}},zpe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Gpe=zpe,Hpe=Gpe;function oq(){}function aq(){}aq.resetWarningCache=oq;var Vpe=function(){function t(i,r,s,o,a,l){if(l!==Hpe){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:aq,resetWarningCache:oq};return n.PropTypes=n,n};sq.exports=Vpe();var lO=sq.exports;const Hp=Zx(lO);function lq({all:t,scene:e,camera:n}){const i=qo(({gl:o})=>o),r=qo(({camera:o})=>o),s=qo(({scene:o})=>o);return ge.useLayoutEffect(()=>{const o=[];t&&(e||s).traverse(c=>{c.visible===!1&&(o.push(c),c.visible=!0)}),i.compile(e||s,n||r);const a=new EB(128);new MB(.01,1e5,a).update(i,e||s),a.dispose(),o.forEach(c=>c.visible=!1)},[]),null}const jpe=()=>{const{progress:t}=Vfe();return We.jsxs(Hfe,{as:"div",center:!0,style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[We.jsx("span",{className:"canvas-loader"}),We.jsxs("p",{style:{fontSize:14,color:"#F1F1F1",fontWeight:800,marginTop:40},children:[t.toFixed(2),"%"]})]})},Wpe=()=>{const t=aO("./public/signs/scene.gltf");return We.jsx("primitive",{object:t.scene,scale:1.5,"position-y":0,"position-x":3,"rotation-y":0})},Xpe=()=>We.jsx(ZY,{shadows:!0,frameloop:"demand",dpr:[1,2],gl:{preserveDrawingBuffer:!0},camera:{fov:45,near:.1,far:200,position:[-4,3,6]},children:We.jsxs(ge.Suspense,{fallback:We.jsx(jpe,{}),children:[We.jsx(Ipe,{autoRotate:!0,enableZoom:!1,maxPolarAngle:Math.PI/2,minPolarAngle:Math.PI/2}),We.jsx(Wpe,{}),We.jsx(lq,{all:!0})]})}),Ype=t=>{const e=ge.useRef(),[n]=ge.useState(()=>Kfe(new Float32Array(1500),{radius:1.1}));return C1((i,r)=>{e.current.rotation.x-=r/15,e.current.rotation.y-=r/20}),We.jsx("group",{rotation:[0,0,Math.PI/4],children:We.jsx(kpe,{ref:e,positions:n,frustumCulled:!0,children:We.jsx(Ope,{transparent:!0,color:"#46B5FE",size:.002,sizeAttenuation:!0,depthWrite:!1,opacity:.3})})})},qpe=()=>We.jsx("div",{className:"w-auto h-auto absolute inset-0 z-[-1]",children:We.jsxs(ZY,{camera:{position:[0,0,1]},children:[We.jsx(ge.Suspense,{fallback:null,children:We.jsx(Ype,{})}),We.jsx(lq,{all:!0})]})}),au={paddingX:"sm:px-16 px-6",paddingY:"sm:py-16 py-6",padding:"sm:px-16 px-6 sm:py-16 py-10",heroHeadText:"font-black text-white lg:text-[80px] sm:text-[60px] xs:text-[50px] text-[40px] lg:leading-[98px] mt-2",heroSubText:"text-[#dfd9ff] font-medium lg:text-[30px] sm:text-[26px] xs:text-[20px] text-[16px] lg:leading-[40px]",sectionHeadText:"text-[#08B6F9] font-black md:text-[60px] sm:text-[50px] xs:text-[40px] text-[30px]",sectionSubText:"sm:text-[18px] text-[14px] text-secondary uppercase tracking-wider"},Qpe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEbElEQVR4nO2a3WscVRiHz7+huQoUsk1i1nSt1qrBr2IxqcVKNZFKpa3bxAqpqG1ihQaapFoRLELk2EhShESyWZtsstk22WSz5oNe2KtCyY2CKRb0TuOFgZZH3nEnTnYiJTkDMyvzwHNx3nnP4TfvzrKwjFIhISEhISEhIfehvIV95S3kylv4s/xtCKT/ZJspP0GD8pJtzXRva4GSsplOT26+Is6+yHGoOM7q9uOcqjjBgyqgSLZInNOSVTJHmj14EirfIlcVh8o4p1WJUBmnTTJXxZk2PqzmKCs1xyAW5wFZd87S25nnblceHHaoACFZJXPNMf4wPqz2KIj2um+Ku/1TYNs3Fayb/6/cW2bnERDtdTYNa45zVgWU4txbZtebINrrpe+gYGBvfqPcW+aJwyDa6zsJuDMU7JvfKPeWqXsDRHv9SyKY3/n75d4yzx4C0eSM1gWaWhdYPbkIrQvca13kfHHPyUU+lmuFntV3F2j0O7fFntdBVAa8P4/+YAEc/lDcIzVnj+zxO7fF3iYQlQFn5tFn5sH2w3n3AKTm7JE9fue2qG8EURnQMYfumAPbs3PuAUjN2SN7/M5tsf9VEJUBXXl0dx5su2bdA5Daup682QC8yG1x4CCIyoALOfSns2B7YYMBSG1dT85sAF7ktjj4CojKgIs59MUcOHQNQGpFPdrv3BZNB0BUBvRk0T3TsGbWPQCpFfVov3NbHHoZRGVAbxbdmwWHty7NEHMqtaIe7Xdui8P7QVQGXJ5EX56CTTlpNgAvclsceQlEZcDAJHpwEjaj7PE7t0W8AURlQCKDHr4Km1H2+J3boqUeRGVAKoNOZWCTar9zW7zzIojKgEwanZkAh7eujRNzKrV1PWmzAXiR26J1L4jKgGwaPZ0G22za/TMotaIe7Xdui/deAFEZkE+hvx8D23zKPQCpFfVov3NbnNoDojLgegp9PQVrjroHILV1PYYD8CK3RfvzICoDboygb4yCQ9cApLauZ8RsAF7ktvjoORCVATevoG9eAYeuAUitqEf7ndui4xkQlQFLSbTj32SWku4BSK2oR/ud2+Lc0yAqA35Mon9KwprD7gFIzdkje/zObdFdB6IyYHmIxtsJ/ro9DMvD3FtO0O3qSXBerkmP9P48zGt+57b45CkQVYnhWe7PngRRlRie5f58N4iqxPAs9xePg6hKDM9y9zwGoioxPMv91aMg9u4O7qsxxXy5izI7t/FhX++Egm2qRLj0CO12buPD+mMg9sVY7YvR1lsb3CehP0pZ/w7aJaud2/jQb3ZAKWs8gMGHQfy2lrqBKBMDUX6zawH018Eoaclq14wHMBQFUZUYnuVO1rCSrIGRAH/3ixmKUiaZkw/xu/Fho9XMjFbDSLX7V0DqYlDWjnp7IbP5i5LpKhrGq2C8itXxStpGKv59Egp1grIei1I2Vkm7lVWuVVOvvCAToTOzHUrJiQjnlJdcjdAwGWH6WgUrkxEIooVs01MRjz75kJCQkJCQEPV/5m+L1LKWlm8XNwAAAABJRU5ErkJggg==",Kpe="/assets/menu-242d80a8.svg",Jpe="/assets/close-ad0e0ca6.svg",mG="/assets/meta-e386841a.png",Zpe="/assets/shopify-c0fdbc80.png",$pe="/assets/starbucks-af2a76fc.png",eme="/assets/tesla-4c857950.png",gG=[{id:"about",title:"About"},{id:"project",title:"Project"},{id:"contact",title:"Contact"}],tme=[{title:"Personal Site",tech:"React, Three.js, framer, Render, Spline",icon:mG,iconBg:"#46B5FE",textBgColor:"#0A1835",date:"May 2023",points:["Implemented an interactive and visually stunning personal website using React, leveraging its component-based architecture to create reusable UI elements and manage the website's state effectively.","Employed spline-based animations, providing a visually engaging and intuitive user interface.","Leveraged the Render platform to deploy and host the website, ensuring high performance, scalability, and reliable uptime, allowing visitors to access the website seamlessly.","Utilized Three.js, a powerful JavaScript library for creating 3D graphics in the browser, to incorporate captivating and immersive 3D elements, enhancing the overall visual experience of the website."]},{title:"Queuing System | OuterEdge LA Hackathon",tech:"PostgreSQL, React, Express, NodeJS, Prisma, Render, REST, JWT Auth",icon:$pe,iconBg:"#6666ff",textBgColor:"#000033",date:"March 2023",points:["Collaborated with a team to design and integrate database schemas for a queuing system","Developed frontend logic to ensure secure access control and redirect unauthorized and authorized users to appropriate page","Implemented a user-friendly purchase page with concurrent user limits and a timer, optimizing system performance and user experience","Developed frontend functionality to redirect users based on real-time backend data, enabling efficient and secure access to web application resources"]},{title:"Interactive Game",tech:"PostgreSQL, Express, React, NodeJS, OpenAI, REST, JWT Auth",icon:eme,iconBg:"#8071DF",textBgColor:"#241C31",date:"November 2022",points:["Developed a text-based web game using the P.E.R.N. stack","Implemented AI to ensure unique adventures","Set up JWT with PostgreSQL to allow for multiple separate users","Utilized PostgreSQL for temporary data to keep story coherent"]},{title:"Discord Monitor",tech:"Node Js, Forever, PM2, Discord.js",icon:Zpe,iconBg:"#5C3EF0",textBgColor:"#13042A",date:"June 2022 - July 2022",points:["Aggregated data from websites and discord servers through API and processed data to specification","Implement PM2 and Forever","Maintained code as incoming data changes","Utilized open source dependencies to aggregated data in real time"]},{title:"Traffic Light Controller",tech:"C,  Assembly, MPLA",icon:mG,iconBg:"#DE3EF0",textBgColor:"#1B0220",date:"Mar 2022 - April 2022",points:["Developing and maintaining web applications using React.js and other related technologies.","Collaborating with cross-functional teams including designers, product managers, and other developers to create high-quality products.","Implementing responsive design and ensuring cross-browser compatibility.","Participating in code reviews and providing constructive feedback to other developers."]}],nme="/assets/bubble_sound-a40c07be.mp3",ime=()=>{const[t,e]=ge.useState(""),[n,i]=ge.useState(!1),[r,s]=ge.useState(!1);function o(){new Audio(nme).play()}return We.jsx("nav",{className:`
        ${au.paddingX} w-full flex items-center py-5 fixed top-0 z-20 
        ${n?"bg-primary":"bg-transparent"}
        `,children:We.jsxs("div",{className:"w-full flex justify-between items-center max-w-8x1 mx-auto",children:[We.jsxs(Hre,{to:"/",className:"flex items-center gap-2",onClick:()=>{e(""),o(),window.scrollTo(0,0)},children:[We.jsx("img",{src:Qpe,alt:"logo",className:"w-9 h-9 object-contain"}),We.jsxs("p",{className:"text-white text-[18px] font-bold cursor-pointer flex ",children:["Steven ",We.jsx("span",{className:"sm:block hidden",children:" | Computer Engineer"})]})]}),We.jsx("ul",{className:"list-none hidden sm:flex flex-row gap-10",children:gG.map(a=>We.jsx("li",{className:`${t===a.title?"text-white":"text-secondary"} hover:text-white text-[19px] font-medium`,onClick:()=>{e(a.title)},children:We.jsxs("a",{href:`#${a.id}`,children:[" ",a.title," "]})},a.id))}),We.jsxs("div",{className:"sm:hidden flex flex-1 justify-end items-center",children:[We.jsx("img",{src:r?Jpe:Kpe,alt:"menu",className:"w-[28px] h-[28px] object-contain cursor-pointer",onClick:()=>s(!r)}),We.jsx("div",{className:`${r?"flex":"hidden"} p-6 black-gradient absolute top-20 right-0 mx-4 my-2 min-w[140px] z-10 rounded-xl`,children:We.jsx("ul",{className:"list-none flex justify-end items-start flex-col gap-4",children:gG.map(a=>We.jsx("li",{className:`${t===a.title?"text-whie":"text-secondary"} text-[16px] font-medium font-poppins`,onClick:()=>{e(a.title),s(!r)},children:We.jsxs("a",{href:`#${a.id}`,children:[" ",a.title]})},a.id))})})]})]})})},cq=ge.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),lE=ge.createContext({}),cO=ge.createContext(null),cE=typeof document<"u",vG=cE?ge.useLayoutEffect:ge.useEffect,uq=ge.createContext({strict:!1});function rme(t,e,n,i){const{visualElement:r}=ge.useContext(lE),s=ge.useContext(uq),o=ge.useContext(cO),a=ge.useContext(cq).reducedMotion,l=ge.useRef();i=i||s.renderer,!l.current&&i&&(l.current=i(t,{visualState:e,parent:r,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:a}));const c=l.current;return ge.useInsertionEffect(()=>{c&&c.update(n,o)}),vG(()=>{c&&c.render()}),ge.useEffect(()=>{c&&c.updateFeatures()}),(window.HandoffAppearAnimations?vG:ge.useEffect)(()=>{c&&c.animationState&&c.animationState.animateChanges()}),c}function Hm(t){return typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function sme(t,e,n){return ge.useCallback(i=>{i&&t.mount&&t.mount(i),e&&(i?e.mount(i):e.unmount()),n&&(typeof n=="function"?n(i):Hm(n)&&(n.current=i))},[e])}function Ex(t){return typeof t=="string"||Array.isArray(t)}function uE(t){return typeof t=="object"&&typeof t.start=="function"}const uO=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],hO=["initial",...uO];function hE(t){return uE(t.animate)||hO.some(e=>Ex(t[e]))}function hq(t){return!!(hE(t)||t.variants)}function ome(t,e){if(hE(t)){const{initial:n,animate:i}=t;return{initial:n===!1||Ex(n)?n:void 0,animate:Ex(i)?i:void 0}}return t.inherit!==!1?e:{}}function ame(t){const{initial:e,animate:n}=ome(t,ge.useContext(lE));return ge.useMemo(()=>({initial:e,animate:n}),[yG(e),yG(n)])}function yG(t){return Array.isArray(t)?t.join(" "):t}const xG={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Cx={};for(const t in xG)Cx[t]={isEnabled:e=>xG[t].some(n=>!!e[n])};function lme(t){for(const e in t)Cx[e]={...Cx[e],...t[e]}}const dq=ge.createContext({}),fq=ge.createContext({}),cme=Symbol.for("motionComponentSymbol");function ume({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:i,Component:r}){t&&lme(t);function s(a,l){let c;const h={...ge.useContext(cq),...a,layoutId:hme(a)},{isStatic:u}=h,d=ame(a),f=i(a,u);if(!u&&cE){d.visualElement=rme(r,f,h,e);const p=ge.useContext(fq),v=ge.useContext(uq).strict;d.visualElement&&(c=d.visualElement.loadFeatures(h,v,t,p))}return ge.createElement(lE.Provider,{value:d},c&&d.visualElement?ge.createElement(c,{visualElement:d.visualElement,...h}):null,n(r,a,sme(f,d.visualElement,l),f,u,d.visualElement))}const o=ge.forwardRef(s);return o[cme]=r,o}function hme({layoutId:t}){const e=ge.useContext(dq).id;return e&&t!==void 0?e+"-"+t:t}function dme(t){function e(i,r={}){return ume(t(i,r))}if(typeof Proxy>"u")return e;const n=new Map;return new Proxy(e,{get:(i,r)=>(n.has(r)||n.set(r,e(r)),n.get(r))})}const fme=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function dO(t){return typeof t!="string"||t.includes("-")?!1:!!(fme.indexOf(t)>-1||/[A-Z]/.test(t))}const SA={};function pme(t){Object.assign(SA,t)}const D1=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Kf=new Set(D1);function pq(t,{layout:e,layoutId:n}){return Kf.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!SA[t]||t==="opacity")}const Hs=t=>!!(t&&t.getVelocity),mme={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},gme=D1.length;function vme(t,{enableHardwareAcceleration:e=!0,allowTransformNone:n=!0},i,r){let s="";for(let o=0;o<gme;o++){const a=D1[o];if(t[a]!==void 0){const l=mme[a]||a;s+=`${l}(${t[a]}) `}}return e&&!t.z&&(s+="translateZ(0)"),s=s.trim(),r?s=r(t,i?"":s):n&&i&&(s="none"),s}const mq=t=>e=>typeof e=="string"&&e.startsWith(t),gq=mq("--"),xL=mq("var(--"),yme=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,xme=(t,e)=>e&&typeof t=="number"?e.transform(t):t,Of=(t,e,n)=>Math.min(Math.max(n,t),e),Jf={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Ty={...Jf,transform:t=>Of(0,1,t)},Q_={...Jf,default:1},Py=t=>Math.round(t*1e5)/1e5,dE=/(-)?([\d]*\.?[\d])+/g,vq=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,wme=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function R1(t){return typeof t=="string"}const L1=t=>({test:e=>R1(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Ku=L1("deg"),Yl=L1("%"),Ft=L1("px"),_me=L1("vh"),bme=L1("vw"),wG={...Yl,parse:t=>Yl.parse(t)/100,transform:t=>Yl.transform(t*100)},_G={...Jf,transform:Math.round},yq={borderWidth:Ft,borderTopWidth:Ft,borderRightWidth:Ft,borderBottomWidth:Ft,borderLeftWidth:Ft,borderRadius:Ft,radius:Ft,borderTopLeftRadius:Ft,borderTopRightRadius:Ft,borderBottomRightRadius:Ft,borderBottomLeftRadius:Ft,width:Ft,maxWidth:Ft,height:Ft,maxHeight:Ft,size:Ft,top:Ft,right:Ft,bottom:Ft,left:Ft,padding:Ft,paddingTop:Ft,paddingRight:Ft,paddingBottom:Ft,paddingLeft:Ft,margin:Ft,marginTop:Ft,marginRight:Ft,marginBottom:Ft,marginLeft:Ft,rotate:Ku,rotateX:Ku,rotateY:Ku,rotateZ:Ku,scale:Q_,scaleX:Q_,scaleY:Q_,scaleZ:Q_,skew:Ku,skewX:Ku,skewY:Ku,distance:Ft,translateX:Ft,translateY:Ft,translateZ:Ft,x:Ft,y:Ft,z:Ft,perspective:Ft,transformPerspective:Ft,opacity:Ty,originX:wG,originY:wG,originZ:Ft,zIndex:_G,fillOpacity:Ty,strokeOpacity:Ty,numOctaves:_G};function fO(t,e,n,i){const{style:r,vars:s,transform:o,transformOrigin:a}=t;let l=!1,c=!1,h=!0;for(const u in e){const d=e[u];if(gq(u)){s[u]=d;continue}const f=yq[u],p=xme(d,f);if(Kf.has(u)){if(l=!0,o[u]=p,!h)continue;d!==(f.default||0)&&(h=!1)}else u.startsWith("origin")?(c=!0,a[u]=p):r[u]=p}if(e.transform||(l||i?r.transform=vme(t.transform,n,h,i):r.transform&&(r.transform="none")),c){const{originX:u="50%",originY:d="50%",originZ:f=0}=a;r.transformOrigin=`${u} ${d} ${f}`}}const pO=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function xq(t,e,n){for(const i in e)!Hs(e[i])&&!pq(i,n)&&(t[i]=e[i])}function Sme({transformTemplate:t},e,n){return ge.useMemo(()=>{const i=pO();return fO(i,e,{enableHardwareAcceleration:!n},t),Object.assign({},i.vars,i.style)},[e])}function Ame(t,e,n){const i=t.style||{},r={};return xq(r,i,t),Object.assign(r,Sme(t,e,n)),t.transformValues?t.transformValues(r):r}function Mme(t,e,n){const i={},r=Ame(t,e,n);return t.drag&&t.dragListener!==!1&&(i.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(i.tabIndex=0),i.style=r,i}const Eme=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onLayoutAnimationStart","onLayoutAnimationComplete","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","ignoreStrict","viewport"]);function AA(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||Eme.has(t)}let wq=t=>!AA(t);function Cme(t){t&&(wq=e=>e.startsWith("on")?!AA(e):t(e))}try{Cme(require("@emotion/is-prop-valid").default)}catch{}function Tme(t,e,n){const i={};for(const r in t)r==="values"&&typeof t.values=="object"||(wq(r)||n===!0&&AA(r)||!e&&!AA(r)||t.draggable&&r.startsWith("onDrag"))&&(i[r]=t[r]);return i}function bG(t,e,n){return typeof t=="string"?t:Ft.transform(e+n*t)}function Pme(t,e,n){const i=bG(e,t.x,t.width),r=bG(n,t.y,t.height);return`${i} ${r}`}const Dme={offset:"stroke-dashoffset",array:"stroke-dasharray"},Rme={offset:"strokeDashoffset",array:"strokeDasharray"};function Lme(t,e,n=1,i=0,r=!0){t.pathLength=1;const s=r?Dme:Rme;t[s.offset]=Ft.transform(-i);const o=Ft.transform(e),a=Ft.transform(n);t[s.array]=`${o} ${a}`}function mO(t,{attrX:e,attrY:n,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},h,u,d){if(fO(t,c,h,d),u){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:f,style:p,dimensions:v}=t;f.transform&&(v&&(p.transform=f.transform),delete f.transform),v&&(r!==void 0||s!==void 0||p.transform)&&(p.transformOrigin=Pme(v,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(f.x=e),n!==void 0&&(f.y=n),i!==void 0&&(f.scale=i),o!==void 0&&Lme(f,o,a,l,!1)}const _q=()=>({...pO(),attrs:{}}),gO=t=>typeof t=="string"&&t.toLowerCase()==="svg";function Ime(t,e,n,i){const r=ge.useMemo(()=>{const s=_q();return mO(s,e,{enableHardwareAcceleration:!1},gO(i),t.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(t.style){const s={};xq(s,t.style,t),r.style={...s,...r.style}}return r}function Bme(t=!1){return(n,i,r,{latestValues:s},o)=>{const l=(dO(n)?Ime:Mme)(i,s,o,n),h={...Tme(i,typeof n=="string",t),...l,ref:r},{children:u}=i,d=ge.useMemo(()=>Hs(u)?u.get():u,[u]);return ge.createElement(n,{...h,children:d})}}const vO=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();function bq(t,{style:e,vars:n},i,r){Object.assign(t.style,e,r&&r.getProjectionStyles(i));for(const s in n)t.style.setProperty(s,n[s])}const Sq=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Aq(t,e,n,i){bq(t,e,void 0,i);for(const r in e.attrs)t.setAttribute(Sq.has(r)?r:vO(r),e.attrs[r])}function yO(t,e){const{style:n}=t,i={};for(const r in n)(Hs(n[r])||e.style&&Hs(e.style[r])||pq(r,t))&&(i[r]=n[r]);return i}function Mq(t,e){const n=yO(t,e);for(const i in t)if(Hs(t[i])||Hs(e[i])){const r=D1.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;n[r]=t[i]}return n}function xO(t,e,n,i={},r={}){return typeof e=="function"&&(e=e(n!==void 0?n:t.custom,i,r)),typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"&&(e=e(n!==void 0?n:t.custom,i,r)),e}function Ome(t){const e=ge.useRef(null);return e.current===null&&(e.current=t()),e.current}const MA=t=>Array.isArray(t),Fme=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),Nme=t=>MA(t)?t[t.length-1]||0:t;function PS(t){const e=Hs(t)?t.get():t;return Fme(e)?e.toValue():e}function Ume({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:n},i,r,s){const o={latestValues:kme(i,r,s,t),renderState:e()};return n&&(o.mount=a=>n(i,a,o)),o}const Eq=t=>(e,n)=>{const i=ge.useContext(lE),r=ge.useContext(cO),s=()=>Ume(t,e,i,r);return n?s():Ome(s)};function kme(t,e,n,i){const r={},s=i(t,{});for(const d in s)r[d]=PS(s[d]);let{initial:o,animate:a}=t;const l=hE(t),c=hq(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let h=n?n.initial===!1:!1;h=h||o===!1;const u=h?a:o;return u&&typeof u!="boolean"&&!uE(u)&&(Array.isArray(u)?u:[u]).forEach(f=>{const p=xO(t,f);if(!p)return;const{transitionEnd:v,transition:g,...m}=p;for(const y in m){let w=m[y];if(Array.isArray(w)){const b=h?w.length-1:0;w=w[b]}w!==null&&(r[y]=w)}for(const y in v)r[y]=v[y]}),r}const zme={useVisualState:Eq({scrapeMotionValuesFromProps:Mq,createRenderState:_q,onMount:(t,e,{renderState:n,latestValues:i})=>{try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}mO(n,i,{enableHardwareAcceleration:!1},gO(e.tagName),t.transformTemplate),Aq(e,n)}})},Gme={useVisualState:Eq({scrapeMotionValuesFromProps:yO,createRenderState:pO})};function Hme(t,{forwardMotionProps:e=!1},n,i){return{...dO(t)?zme:Gme,preloadedFeatures:n,useRender:Bme(e),createVisualElement:i,Component:t}}function jc(t,e,n,i={passive:!0}){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n)}const Cq=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function fE(t,e="page"){return{point:{x:t[e+"X"],y:t[e+"Y"]}}}const Vme=t=>e=>Cq(e)&&t(e,fE(e));function Kc(t,e,n,i){return jc(t,e,Vme(n),i)}const jme=(t,e)=>n=>e(t(n)),Ih=(...t)=>t.reduce(jme);function Tq(t){let e=null;return()=>{const n=()=>{e=null};return e===null?(e=t,n):!1}}const SG=Tq("dragHorizontal"),AG=Tq("dragVertical");function Pq(t){let e=!1;if(t==="y")e=AG();else if(t==="x")e=SG();else{const n=SG(),i=AG();n&&i?e=()=>{n(),i()}:(n&&n(),i&&i())}return e}function Dq(){const t=Pq(!0);return t?(t(),!1):!0}class id{constructor(e){this.isMounted=!1,this.node=e}update(){}}function Wme(t){let e=[],n=[],i=0,r=!1,s=!1;const o=new WeakSet,a={schedule:(l,c=!1,h=!1)=>{const u=h&&r,d=u?e:n;return c&&o.add(l),d.indexOf(l)===-1&&(d.push(l),u&&r&&(i=e.length)),l},cancel:l=>{const c=n.indexOf(l);c!==-1&&n.splice(c,1),o.delete(l)},process:l=>{if(r){s=!0;return}if(r=!0,[e,n]=[n,e],n.length=0,i=e.length,i)for(let c=0;c<i;c++){const h=e[c];h(l),o.has(h)&&(a.schedule(h),t())}r=!1,s&&(s=!1,a.process(l))}};return a}const vr={delta:0,timestamp:0,isProcessing:!1},Xme=40;let wL=!0,Tx=!1;const pE=["read","update","preRender","render","postRender"],dg=pE.reduce((t,e)=>(t[e]=Wme(()=>Tx=!0),t),{}),Yme=t=>dg[t].process(vr),Rq=t=>{Tx=!1,vr.delta=wL?1e3/60:Math.max(Math.min(t-vr.timestamp,Xme),1),vr.timestamp=t,vr.isProcessing=!0,pE.forEach(Yme),vr.isProcessing=!1,Tx&&(wL=!1,requestAnimationFrame(Rq))},qme=()=>{Tx=!0,wL=!0,vr.isProcessing||requestAnimationFrame(Rq)},hi=pE.reduce((t,e)=>{const n=dg[e];return t[e]=(i,r=!1,s=!1)=>(Tx||qme(),n.schedule(i,r,s)),t},{});function lu(t){pE.forEach(e=>dg[e].cancel(t))}function MG(t,e){const n="pointer"+(e?"enter":"leave"),i="onHover"+(e?"Start":"End"),r=(s,o)=>{if(s.type==="touch"||Dq())return;const a=t.getProps();t.animationState&&a.whileHover&&t.animationState.setActive("whileHover",e),a[i]&&hi.update(()=>a[i](s,o))};return Kc(t.current,n,r,{passive:!t.getProps()[i]})}class Qme extends id{mount(){this.unmount=Ih(MG(this.node,!0),MG(this.node,!1))}unmount(){}}class Kme extends id{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Ih(jc(this.node.current,"focus",()=>this.onFocus()),jc(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const Lq=(t,e)=>e?t===e?!0:Lq(t,e.parentElement):!1,Zi=t=>t;function MP(t,e){if(!e)return;const n=new PointerEvent("pointer"+t);e(n,fE(n))}class Jme extends id{constructor(){super(...arguments),this.removeStartListeners=Zi,this.removeEndListeners=Zi,this.removeAccessibleListeners=Zi,this.startPointerPress=(e,n)=>{if(this.removeEndListeners(),this.isPressing)return;const i=this.node.getProps(),s=Kc(window,"pointerup",(a,l)=>{if(!this.checkPressEnd())return;const{onTap:c,onTapCancel:h}=this.node.getProps();hi.update(()=>{Lq(this.node.current,a.target)?c&&c(a,l):h&&h(a,l)})},{passive:!(i.onTap||i.onPointerUp)}),o=Kc(window,"pointercancel",(a,l)=>this.cancelPress(a,l),{passive:!(i.onTapCancel||i.onPointerCancel)});this.removeEndListeners=Ih(s,o),this.startPress(e,n)},this.startAccessiblePress=()=>{const e=s=>{if(s.key!=="Enter"||this.isPressing)return;const o=a=>{a.key!=="Enter"||!this.checkPressEnd()||MP("up",(l,c)=>{const{onTap:h}=this.node.getProps();h&&hi.update(()=>h(l,c))})};this.removeEndListeners(),this.removeEndListeners=jc(this.node.current,"keyup",o),MP("down",(a,l)=>{this.startPress(a,l)})},n=jc(this.node.current,"keydown",e),i=()=>{this.isPressing&&MP("cancel",(s,o)=>this.cancelPress(s,o))},r=jc(this.node.current,"blur",i);this.removeAccessibleListeners=Ih(n,r)}}startPress(e,n){this.isPressing=!0;const{onTapStart:i,whileTap:r}=this.node.getProps();r&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),i&&hi.update(()=>i(e,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!Dq()}cancelPress(e,n){if(!this.checkPressEnd())return;const{onTapCancel:i}=this.node.getProps();i&&hi.update(()=>i(e,n))}mount(){const e=this.node.getProps(),n=Kc(this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),i=jc(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Ih(n,i)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const _L=new WeakMap,EP=new WeakMap,Zme=t=>{const e=_L.get(t.target);e&&e(t)},$me=t=>{t.forEach(Zme)};function ege({root:t,...e}){const n=t||document;EP.has(n)||EP.set(n,{});const i=EP.get(n),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver($me,{root:t,...e})),i[r]}function tge(t,e,n){const i=ege(e);return _L.set(t,n),i.observe(t),()=>{_L.delete(t),i.unobserve(t)}}const nge={some:0,all:1};class ige extends id{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:i,amount:r="some",once:s}=e,o={root:n?n.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:nge[r]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:h,onViewportLeave:u}=this.node.getProps(),d=c?h:u;d&&d(l)};return tge(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(rge(e,n))&&this.startObserver()}unmount(){}}function rge({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const sge={inView:{Feature:ige},tap:{Feature:Jme},focus:{Feature:Kme},hover:{Feature:Qme}};function Iq(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let i=0;i<n;i++)if(e[i]!==t[i])return!1;return!0}function oge(t){const e={};return t.values.forEach((n,i)=>e[i]=n.get()),e}function age(t){const e={};return t.values.forEach((n,i)=>e[i]=n.getVelocity()),e}function mE(t,e,n){const i=t.getProps();return xO(i,e,n!==void 0?n:i.custom,oge(t),age(t))}const lge="framerAppearId",cge="data-"+vO(lge);let uge=Zi,wO=Zi;const Bh=t=>t*1e3,Jc=t=>t/1e3,hge={current:!1},Bq=t=>Array.isArray(t)&&typeof t[0]=="number";function Oq(t){return!!(!t||typeof t=="string"&&Fq[t]||Bq(t)||Array.isArray(t)&&t.every(Oq))}const sy=([t,e,n,i])=>`cubic-bezier(${t}, ${e}, ${n}, ${i})`,Fq={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:sy([0,.65,.55,1]),circOut:sy([.55,0,1,.45]),backIn:sy([.31,.01,.66,-.59]),backOut:sy([.33,1.53,.69,.99])};function Nq(t){if(t)return Bq(t)?sy(t):Array.isArray(t)?t.map(Nq):Fq[t]}function dge(t,e,n,{delay:i=0,duration:r,repeat:s=0,repeatType:o="loop",ease:a,times:l}={}){const c={[e]:n};l&&(c.offset=l);const h=Nq(a);return Array.isArray(h)&&(c.easing=h),t.animate(c,{delay:i,duration:r,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const EG={waapi:()=>Object.hasOwnProperty.call(Element.prototype,"animate")},CP={},Uq={};for(const t in EG)Uq[t]=()=>(CP[t]===void 0&&(CP[t]=EG[t]()),CP[t]);function fge(t,{repeat:e,repeatType:n="loop"}){const i=e&&n!=="loop"&&e%2===1?0:t.length-1;return t[i]}const kq=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,pge=1e-7,mge=12;function gge(t,e,n,i,r){let s,o,a=0;do o=e+(n-e)/2,s=kq(o,i,r)-t,s>0?n=o:e=o;while(Math.abs(s)>pge&&++a<mge);return o}function I1(t,e,n,i){if(t===e&&n===i)return Zi;const r=s=>gge(s,0,1,t,n);return s=>s===0||s===1?s:kq(r(s),e,i)}const vge=I1(.42,0,1,1),yge=I1(0,0,.58,1),zq=I1(.42,0,.58,1),xge=t=>Array.isArray(t)&&typeof t[0]!="number",Gq=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,Hq=t=>e=>1-t(1-e),Vq=t=>1-Math.sin(Math.acos(t)),_O=Hq(Vq),wge=Gq(_O),jq=I1(.33,1.53,.69,.99),bO=Hq(jq),_ge=Gq(bO),bge=t=>(t*=2)<1?.5*bO(t):.5*(2-Math.pow(2,-10*(t-1))),Sge={linear:Zi,easeIn:vge,easeInOut:zq,easeOut:yge,circIn:Vq,circInOut:wge,circOut:_O,backIn:bO,backInOut:_ge,backOut:jq,anticipate:bge},CG=t=>{if(Array.isArray(t)){wO(t.length===4);const[e,n,i,r]=t;return I1(e,n,i,r)}else if(typeof t=="string")return Sge[t];return t},SO=(t,e)=>n=>!!(R1(n)&&wme.test(n)&&n.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(n,e)),Wq=(t,e,n)=>i=>{if(!R1(i))return i;const[r,s,o,a]=i.match(dE);return{[t]:parseFloat(r),[e]:parseFloat(s),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},Age=t=>Of(0,255,t),TP={...Jf,transform:t=>Math.round(Age(t))},of={test:SO("rgb","red"),parse:Wq("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:i=1})=>"rgba("+TP.transform(t)+", "+TP.transform(e)+", "+TP.transform(n)+", "+Py(Ty.transform(i))+")"};function Mge(t){let e="",n="",i="",r="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),i=t.substring(5,7),r=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),i=t.substring(3,4),r=t.substring(4,5),e+=e,n+=n,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const bL={test:SO("#"),parse:Mge,transform:of.transform},Vm={test:SO("hsl","hue"),parse:Wq("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:i=1})=>"hsla("+Math.round(t)+", "+Yl.transform(Py(e))+", "+Yl.transform(Py(n))+", "+Py(Ty.transform(i))+")"},hs={test:t=>of.test(t)||bL.test(t)||Vm.test(t),parse:t=>of.test(t)?of.parse(t):Vm.test(t)?Vm.parse(t):bL.parse(t),transform:t=>R1(t)?t:t.hasOwnProperty("red")?of.transform(t):Vm.transform(t)},ci=(t,e,n)=>-n*t+n*e+t;function PP(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Ege({hue:t,saturation:e,lightness:n,alpha:i}){t/=360,e/=100,n/=100;let r=0,s=0,o=0;if(!e)r=s=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;r=PP(l,a,t+1/3),s=PP(l,a,t),o=PP(l,a,t-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}const DP=(t,e,n)=>{const i=t*t;return Math.sqrt(Math.max(0,n*(e*e-i)+i))},Cge=[bL,of,Vm],Tge=t=>Cge.find(e=>e.test(t));function TG(t){const e=Tge(t);let n=e.parse(t);return e===Vm&&(n=Ege(n)),n}const Xq=(t,e)=>{const n=TG(t),i=TG(e),r={...n};return s=>(r.red=DP(n.red,i.red,s),r.green=DP(n.green,i.green,s),r.blue=DP(n.blue,i.blue,s),r.alpha=ci(n.alpha,i.alpha,s),of.transform(r))};function Pge(t){var e,n;return isNaN(t)&&R1(t)&&(((e=t.match(dE))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(vq))===null||n===void 0?void 0:n.length)||0)>0}const Yq={regex:yme,countKey:"Vars",token:"${v}",parse:Zi},qq={regex:vq,countKey:"Colors",token:"${c}",parse:hs.parse},Qq={regex:dE,countKey:"Numbers",token:"${n}",parse:Jf.parse};function RP(t,{regex:e,countKey:n,token:i,parse:r}){const s=t.tokenised.match(e);s&&(t["num"+n]=s.length,t.tokenised=t.tokenised.replace(e,i),t.values.push(...s.map(r)))}function EA(t){const e=t.toString(),n={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return n.value.includes("var(--")&&RP(n,Yq),RP(n,qq),RP(n,Qq),n}function Kq(t){return EA(t).values}function Jq(t){const{values:e,numColors:n,numVars:i,tokenised:r}=EA(t),s=e.length;return o=>{let a=r;for(let l=0;l<s;l++)l<i?a=a.replace(Yq.token,o[l]):l<i+n?a=a.replace(qq.token,hs.transform(o[l])):a=a.replace(Qq.token,Py(o[l]));return a}}const Dge=t=>typeof t=="number"?0:t;function Rge(t){const e=Kq(t);return Jq(t)(e.map(Dge))}const Yh={test:Pge,parse:Kq,createTransformer:Jq,getAnimatableNone:Rge},Zq=(t,e)=>n=>`${n>0?e:t}`;function $q(t,e){return typeof t=="number"?n=>ci(t,e,n):hs.test(t)?Xq(t,e):t.startsWith("var(")?Zq(t,e):tQ(t,e)}const eQ=(t,e)=>{const n=[...t],i=n.length,r=t.map((s,o)=>$q(s,e[o]));return s=>{for(let o=0;o<i;o++)n[o]=r[o](s);return n}},Lge=(t,e)=>{const n={...t,...e},i={};for(const r in n)t[r]!==void 0&&e[r]!==void 0&&(i[r]=$q(t[r],e[r]));return r=>{for(const s in i)n[s]=i[s](r);return n}},tQ=(t,e)=>{const n=Yh.createTransformer(e),i=EA(t),r=EA(e);return i.numVars===r.numVars&&i.numColors===r.numColors&&i.numNumbers>=r.numNumbers?Ih(eQ(i.values,r.values),n):Zq(t,e)},Px=(t,e,n)=>{const i=e-t;return i===0?1:(n-t)/i},PG=(t,e)=>n=>ci(t,e,n);function Ige(t){return typeof t=="number"?PG:typeof t=="string"?hs.test(t)?Xq:tQ:Array.isArray(t)?eQ:typeof t=="object"?Lge:PG}function Bge(t,e,n){const i=[],r=n||Ige(t[0]),s=t.length-1;for(let o=0;o<s;o++){let a=r(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||Zi:e;a=Ih(l,a)}i.push(a)}return i}function nQ(t,e,{clamp:n=!0,ease:i,mixer:r}={}){const s=t.length;if(wO(s===e.length),s===1)return()=>e[0];t[0]>t[s-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=Bge(e,i,r),a=o.length,l=c=>{let h=0;if(a>1)for(;h<t.length-2&&!(c<t[h+1]);h++);const u=Px(t[h],t[h+1],c);return o[h](u)};return n?c=>l(Of(t[0],t[s-1],c)):l}function Oge(t,e){const n=t[t.length-1];for(let i=1;i<=e;i++){const r=Px(0,e,i);t.push(ci(n,1,r))}}function Fge(t){const e=[0];return Oge(e,t.length-1),e}function Nge(t,e){return t.map(n=>n*e)}function Uge(t,e){return t.map(()=>e||zq).splice(0,t.length-1)}function CA({duration:t=300,keyframes:e,times:n,ease:i="easeInOut"}){const r=xge(i)?i.map(CG):CG(i),s={done:!1,value:e[0]},o=Nge(n&&n.length===e.length?n:Fge(e),t),a=nQ(o,e,{ease:Array.isArray(r)?r:Uge(e,r)});return{calculatedDuration:t,next:l=>(s.value=a(l),s.done=l>=t,s)}}function iQ(t,e){return e?t*(1e3/e):0}const kge=5;function rQ(t,e,n){const i=Math.max(e-kge,0);return iQ(n-t(i),e-i)}const LP=.001,zge=.01,DG=10,Gge=.05,Hge=1;function Vge({duration:t=800,bounce:e=.25,velocity:n=0,mass:i=1}){let r,s;uge(t<=Bh(DG));let o=1-e;o=Of(Gge,Hge,o),t=Of(zge,DG,Jc(t)),o<1?(r=c=>{const h=c*o,u=h*t,d=h-n,f=SL(c,o),p=Math.exp(-u);return LP-d/f*p},s=c=>{const u=c*o*t,d=u*n+n,f=Math.pow(o,2)*Math.pow(c,2)*t,p=Math.exp(-u),v=SL(Math.pow(c,2),o);return(-r(c)+LP>0?-1:1)*((d-f)*p)/v}):(r=c=>{const h=Math.exp(-c*t),u=(c-n)*t+1;return-LP+h*u},s=c=>{const h=Math.exp(-c*t),u=(n-c)*(t*t);return h*u});const a=5/t,l=Wge(r,s,a);if(t=Bh(t),isNaN(l))return{stiffness:100,damping:10,duration:t};{const c=Math.pow(l,2)*i;return{stiffness:c,damping:o*2*Math.sqrt(i*c),duration:t}}}const jge=12;function Wge(t,e,n){let i=n;for(let r=1;r<jge;r++)i=i-t(i)/e(i);return i}function SL(t,e){return t*Math.sqrt(1-e*e)}const Xge=["duration","bounce"],Yge=["stiffness","damping","mass"];function RG(t,e){return e.some(n=>t[n]!==void 0)}function qge(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!RG(t,Yge)&&RG(t,Xge)){const n=Vge(t);e={...e,...n,velocity:0,mass:1},e.isResolvedFromDuration=!0}return e}function sQ({keyframes:t,restDelta:e,restSpeed:n,...i}){const r=t[0],s=t[t.length-1],o={done:!1,value:r},{stiffness:a,damping:l,mass:c,velocity:h,duration:u,isResolvedFromDuration:d}=qge(i),f=h?-Jc(h):0,p=l/(2*Math.sqrt(a*c)),v=s-r,g=Jc(Math.sqrt(a/c)),m=Math.abs(v)<5;n||(n=m?.01:2),e||(e=m?.005:.5);let y;if(p<1){const w=SL(g,p);y=b=>{const A=Math.exp(-p*g*b);return s-A*((f+p*g*v)/w*Math.sin(w*b)+v*Math.cos(w*b))}}else if(p===1)y=w=>s-Math.exp(-g*w)*(v+(f+g*v)*w);else{const w=g*Math.sqrt(p*p-1);y=b=>{const A=Math.exp(-p*g*b),S=Math.min(w*b,300);return s-A*((f+p*g*v)*Math.sinh(S)+w*v*Math.cosh(S))/w}}return{calculatedDuration:d&&u||null,next:w=>{const b=y(w);if(d)o.done=w>=u;else{let A=f;w!==0&&(p<1?A=rQ(y,w,b):A=0);const S=Math.abs(A)<=n,T=Math.abs(s-b)<=e;o.done=S&&T}return o.value=o.done?s:b,o}}}function LG({keyframes:t,velocity:e=0,power:n=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:h}){const u=t[0],d={done:!1,value:u},f=M=>a!==void 0&&M<a||l!==void 0&&M>l,p=M=>a===void 0?l:l===void 0||Math.abs(a-M)<Math.abs(l-M)?a:l;let v=n*e;const g=u+v,m=o===void 0?g:o(g);m!==g&&(v=m-u);const y=M=>-v*Math.exp(-M/i),w=M=>m+y(M),b=M=>{const E=y(M),P=w(M);d.done=Math.abs(E)<=c,d.value=d.done?m:P};let A,S;const T=M=>{f(d.value)&&(A=M,S=sQ({keyframes:[d.value,p(d.value)],velocity:rQ(w,M,d.value),damping:r,stiffness:s,restDelta:c,restSpeed:h}))};return T(0),{calculatedDuration:null,next:M=>{let E=!1;return!S&&A===void 0&&(E=!0,b(M),T(M)),A!==void 0&&M>A?S.next(M-A):(!E&&b(M),d)}}}const Qge=t=>{const e=({timestamp:n})=>t(n);return{start:()=>hi.update(e,!0),stop:()=>lu(e),now:()=>vr.isProcessing?vr.timestamp:performance.now()}},IG=2e4;function BG(t){let e=0;const n=50;let i=t.next(e);for(;!i.done&&e<IG;)e+=n,i=t.next(e);return e>=IG?1/0:e}const Kge={decay:LG,inertia:LG,tween:CA,keyframes:CA,spring:sQ};function TA({autoplay:t=!0,delay:e=0,driver:n=Qge,keyframes:i,type:r="keyframes",repeat:s=0,repeatDelay:o=0,repeatType:a="loop",onPlay:l,onStop:c,onComplete:h,onUpdate:u,...d}){let f=1,p=!1,v,g;const m=()=>{v&&v(),g=new Promise(Y=>{v=Y})};m();let y;const w=Kge[r]||CA;let b;w!==CA&&typeof i[0]!="number"&&(b=nQ([0,100],i,{clamp:!1}),i=[0,100]);const A=w({...d,keyframes:i});let S;a==="mirror"&&(S=w({...d,keyframes:[...i].reverse(),velocity:-(d.velocity||0)}));let T="idle",M=null,E=null,P=null;A.calculatedDuration===null&&s&&(A.calculatedDuration=BG(A));const{calculatedDuration:R}=A;let F=1/0,B=1/0;R!==null&&(F=R+o,B=F*(s+1)-o);let k=0;const j=Y=>{if(E===null)return;f>0&&(E=Math.min(E,Y)),M!==null?k=M:k=(Y-E)*f;const z=k-e,X=z<0;k=Math.max(z,0),T==="finished"&&M===null&&(k=B);let q=k,re=A;if(s){const ve=k/F;let $=Math.floor(ve),se=ve%1;!se&&ve>=1&&(se=1),se===1&&$--,$=Math.min($,s+1);const ne=!!($%2);ne&&(a==="reverse"?(se=1-se,o&&(se-=o/F)):a==="mirror"&&(re=S));let ie=Of(0,1,se);k>B&&(ie=a==="reverse"&&ne?1:0),q=ie*F}const G=X?{done:!1,value:i[0]}:re.next(q);b&&(G.value=b(G.value));let{done:K}=G;!X&&R!==null&&(K=k>=B);const oe=M===null&&(T==="finished"||T==="running"&&K||f<0&&k<=0);return u&&u(G.value),oe&&O(),G},Z=()=>{y&&y.stop(),y=void 0},ee=()=>{T="idle",Z(),m(),E=P=null},O=()=>{T="finished",h&&h(),Z(),m()},W=()=>{if(p)return;y||(y=n(j));const Y=y.now();l&&l(),M!==null?E=Y-M:(!E||T==="finished")&&(E=Y),P=E,M=null,T="running",y.start()};t&&W();const H={then(Y,z){return g.then(Y,z)},get time(){return Jc(k)},set time(Y){Y=Bh(Y),k=Y,M!==null||!y||f===0?M=Y:E=y.now()-Y/f},get duration(){const Y=A.calculatedDuration===null?BG(A):A.calculatedDuration;return Jc(Y)},get speed(){return f},set speed(Y){Y===f||!y||(f=Y,H.time=Jc(k))},get state(){return T},play:W,pause:()=>{T="paused",M=k},stop:()=>{p=!0,T!=="idle"&&(T="idle",c&&c(),ee())},cancel:()=>{P!==null&&j(P),ee()},complete:()=>{T="finished"},sample:Y=>(E=0,j(Y))};return H}const Jge=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),K_=10,Zge=2e4,$ge=(t,e)=>e.type==="spring"||t==="backgroundColor"||!Oq(e.ease);function eve(t,e,{onUpdate:n,onComplete:i,...r}){if(!(Uq.waapi()&&Jge.has(e)&&!r.repeatDelay&&r.repeatType!=="mirror"&&r.damping!==0&&r.type!=="inertia"))return!1;let o=!1,a,l;const c=()=>{l=new Promise(m=>{a=m})};c();let{keyframes:h,duration:u=300,ease:d,times:f}=r;if($ge(e,r)){const m=TA({...r,repeat:0,delay:0});let y={done:!1,value:h[0]};const w=[];let b=0;for(;!y.done&&b<Zge;)y=m.sample(b),w.push(y.value),b+=K_;f=void 0,h=w,u=b-K_,d="linear"}const p=dge(t.owner.current,e,h,{...r,duration:u,ease:d,times:f}),v=()=>p.cancel(),g=()=>{hi.update(v),a(),c()};return p.onfinish=()=>{t.set(fge(h,r)),i&&i(),g()},{then(m,y){return l.then(m,y)},get time(){return Jc(p.currentTime||0)},set time(m){p.currentTime=Bh(m)},get speed(){return p.playbackRate},set speed(m){p.playbackRate=m},get duration(){return Jc(u)},play:()=>{o||(p.play(),lu(v))},pause:()=>p.pause(),stop:()=>{if(o=!0,p.playState==="idle")return;const{currentTime:m}=p;if(m){const y=TA({...r,autoplay:!1});t.setWithVelocity(y.sample(m-K_).value,y.sample(m).value,K_)}g()},complete:()=>p.finish(),cancel:g}}function tve({keyframes:t,delay:e,onUpdate:n,onComplete:i}){const r=()=>(n&&n(t[t.length-1]),i&&i(),{time:0,speed:1,duration:0,play:Zi,pause:Zi,stop:Zi,then:s=>(s(),Promise.resolve()),cancel:Zi,complete:Zi});return e?TA({keyframes:[0,1],duration:0,delay:e,onComplete:r}):r()}const nve={type:"spring",stiffness:500,damping:25,restSpeed:10},ive=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),rve={type:"keyframes",duration:.8},sve={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},ove=(t,{keyframes:e})=>e.length>2?rve:Kf.has(t)?t.startsWith("scale")?ive(e[1]):nve:sve,AL=(t,e)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Yh.test(e)||e==="0")&&!e.startsWith("url(")),ave=new Set(["brightness","contrast","saturate","opacity"]);function lve(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[i]=n.match(dE)||[];if(!i)return t;const r=n.replace(i,"");let s=ave.has(e)?1:0;return i!==n&&(s*=100),e+"("+s+r+")"}const cve=/([a-z-]*)\(.*?\)/g,ML={...Yh,getAnimatableNone:t=>{const e=t.match(cve);return e?e.map(lve).join(" "):t}},uve={...yq,color:hs,backgroundColor:hs,outlineColor:hs,fill:hs,stroke:hs,borderColor:hs,borderTopColor:hs,borderRightColor:hs,borderBottomColor:hs,borderLeftColor:hs,filter:ML,WebkitFilter:ML},AO=t=>uve[t];function oQ(t,e){let n=AO(t);return n!==ML&&(n=Yh),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const aQ=t=>/^0[^.\s]+$/.test(t);function hve(t){if(typeof t=="number")return t===0;if(t!==null)return t==="none"||t==="0"||aQ(t)}function dve(t,e,n,i){const r=AL(e,n);let s;Array.isArray(n)?s=[...n]:s=[null,n];const o=i.from!==void 0?i.from:t.get();let a;const l=[];for(let c=0;c<s.length;c++)s[c]===null&&(s[c]=c===0?o:s[c-1]),hve(s[c])?l.push(c):typeof s[c]=="string"&&(a=s[c]);if(r&&l.length&&a)for(let c=0;c<l.length;c++){const h=l[c];s[h]=oQ(e,a)}return s}function fve({when:t,delay:e,delayChildren:n,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:a,from:l,elapsed:c,...h}){return!!Object.keys(h).length}function lQ(t,e){return t[e]||t.default||t}const MO=(t,e,n,i={})=>r=>{const s=lQ(i,t)||{},o=s.delay||i.delay||0;let{elapsed:a=0}=i;a=a-Bh(o);const l=dve(e,t,n,s),c=l[0],h=l[l.length-1],u=AL(t,c),d=AL(t,h);let f={keyframes:l,velocity:e.getVelocity(),ease:"easeOut",...s,delay:-a,onUpdate:p=>{e.set(p),s.onUpdate&&s.onUpdate(p)},onComplete:()=>{r(),s.onComplete&&s.onComplete()}};if(fve(s)||(f={...f,...ove(t,f)}),f.duration&&(f.duration=Bh(f.duration)),f.repeatDelay&&(f.repeatDelay=Bh(f.repeatDelay)),!u||!d||hge.current||s.type===!1)return tve(f);if(e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const p=eve(e,t,f);if(p)return p}return TA(f)};function PA(t){return!!(Hs(t)&&t.add)}const pve=t=>/^\-?\d*\.?\d+$/.test(t);function EO(t,e){t.indexOf(e)===-1&&t.push(e)}function CO(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class TO{constructor(){this.subscriptions=[]}add(e){return EO(this.subscriptions,e),()=>CO(this.subscriptions,e)}notify(e,n,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,n,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,n,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const mve=t=>!isNaN(parseFloat(t));class gve{constructor(e,n={}){this.version="10.12.8",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(i,r=!0)=>{this.prev=this.current,this.current=i;const{delta:s,timestamp:o}=vr;this.lastUpdated!==o&&(this.timeDelta=s,this.lastUpdated=o,hi.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>hi.postRender(this.velocityCheck),this.velocityCheck=({timestamp:i})=>{i!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=mve(this.current),this.owner=n.owner}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new TO);const i=this.events[e].add(n);return e==="change"?()=>{i(),hi.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,i){this.set(n),this.prev=e,this.timeDelta=i}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?iQ(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function jg(t,e){return new gve(t,e)}const cQ=t=>e=>e.test(t),vve={test:t=>t==="auto",parse:t=>t},uQ=[Jf,Ft,Yl,Ku,bme,_me,vve],w0=t=>uQ.find(cQ(t)),yve=[...uQ,hs,Yh],xve=t=>yve.find(cQ(t));function wve(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,jg(n))}function _ve(t,e){const n=mE(t,e);let{transitionEnd:i={},transition:r={},...s}=n?t.makeTargetAnimatable(n,!1):{};s={...s,...i};for(const o in s){const a=Nme(s[o]);wve(t,o,a)}}function bve(t,e,n){var i,r;const s=Object.keys(e).filter(a=>!t.hasValue(a)),o=s.length;if(o)for(let a=0;a<o;a++){const l=s[a],c=e[l];let h=null;Array.isArray(c)&&(h=c[0]),h===null&&(h=(r=(i=n[l])!==null&&i!==void 0?i:t.readValue(l))!==null&&r!==void 0?r:e[l]),h!=null&&(typeof h=="string"&&(pve(h)||aQ(h))?h=parseFloat(h):!xve(h)&&Yh.test(c)&&(h=oQ(l,c)),t.addValue(l,jg(h,{owner:t})),n[l]===void 0&&(n[l]=h),h!==null&&t.setBaseTarget(l,h))}}function Sve(t,e){return e?(e[t]||e.default||e).from:void 0}function Ave(t,e,n){const i={};for(const r in t){const s=Sve(r,e);if(s!==void 0)i[r]=s;else{const o=n.getValue(r);o&&(i[r]=o.get())}}return i}function Mve({protectedKeys:t,needsAnimating:e},n){const i=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,i}function hQ(t,e,{delay:n=0,transitionOverride:i,type:r}={}){let{transition:s=t.getDefaultTransition(),transitionEnd:o,...a}=t.makeTargetAnimatable(e);const l=t.getValue("willChange");i&&(s=i);const c=[],h=r&&t.animationState&&t.animationState.getState()[r];for(const u in a){const d=t.getValue(u),f=a[u];if(!d||f===void 0||h&&Mve(h,u))continue;const p={delay:n,elapsed:0,...s};if(window.HandoffAppearAnimations&&!d.hasAnimated){const g=t.getProps()[cge];g&&(p.elapsed=window.HandoffAppearAnimations(g,u,d,hi))}d.start(MO(u,d,f,t.shouldReduceMotion&&Kf.has(u)?{type:!1}:p));const v=d.animation;PA(l)&&(l.add(u),v.then(()=>l.remove(u))),c.push(v)}return o&&Promise.all(c).then(()=>{o&&_ve(t,o)}),c}function EL(t,e,n={}){const i=mE(t,e,n.custom);let{transition:r=t.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(r=n.transitionOverride);const s=i?()=>Promise.all(hQ(t,i,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(l=0)=>{const{delayChildren:c=0,staggerChildren:h,staggerDirection:u}=r;return Eve(t,e,c+l,h,u,n)}:()=>Promise.resolve(),{when:a}=r;if(a){const[l,c]=a==="beforeChildren"?[s,o]:[o,s];return l().then(()=>c())}else return Promise.all([s(),o(n.delay)])}function Eve(t,e,n=0,i=0,r=1,s){const o=[],a=(t.variantChildren.size-1)*i,l=r===1?(c=0)=>c*i:(c=0)=>a-c*i;return Array.from(t.variantChildren).sort(Cve).forEach((c,h)=>{c.notify("AnimationStart",e),o.push(EL(c,e,{...s,delay:n+l(h)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(o)}function Cve(t,e){return t.sortNodePosition(e)}function Tve(t,e,n={}){t.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>EL(t,s,n));i=Promise.all(r)}else if(typeof e=="string")i=EL(t,e,n);else{const r=typeof e=="function"?mE(t,e,n.custom):e;i=Promise.all(hQ(t,r,n))}return i.then(()=>t.notify("AnimationComplete",e))}const Pve=[...uO].reverse(),Dve=uO.length;function Rve(t){return e=>Promise.all(e.map(({animation:n,options:i})=>Tve(t,n,i)))}function Lve(t){let e=Rve(t);const n=Bve();let i=!0;const r=(l,c)=>{const h=mE(t,c);if(h){const{transition:u,transitionEnd:d,...f}=h;l={...l,...f,...d}}return l};function s(l){e=l(t)}function o(l,c){const h=t.getProps(),u=t.getVariantContext(!0)||{},d=[],f=new Set;let p={},v=1/0;for(let m=0;m<Dve;m++){const y=Pve[m],w=n[y],b=h[y]!==void 0?h[y]:u[y],A=Ex(b),S=y===c?w.isActive:null;S===!1&&(v=m);let T=b===u[y]&&b!==h[y]&&A;if(T&&i&&t.manuallyAnimateOnMount&&(T=!1),w.protectedKeys={...p},!w.isActive&&S===null||!b&&!w.prevProp||uE(b)||typeof b=="boolean")continue;const M=Ive(w.prevProp,b);let E=M||y===c&&w.isActive&&!T&&A||m>v&&A;const P=Array.isArray(b)?b:[b];let R=P.reduce(r,{});S===!1&&(R={});const{prevResolvedValues:F={}}=w,B={...F,...R},k=j=>{E=!0,f.delete(j),w.needsAnimating[j]=!0};for(const j in B){const Z=R[j],ee=F[j];p.hasOwnProperty(j)||(Z!==ee?MA(Z)&&MA(ee)?!Iq(Z,ee)||M?k(j):w.protectedKeys[j]=!0:Z!==void 0?k(j):f.add(j):Z!==void 0&&f.has(j)?k(j):w.protectedKeys[j]=!0)}w.prevProp=b,w.prevResolvedValues=R,w.isActive&&(p={...p,...R}),i&&t.blockInitialAnimation&&(E=!1),E&&!T&&d.push(...P.map(j=>({animation:j,options:{type:y,...l}})))}if(f.size){const m={};f.forEach(y=>{const w=t.getBaseTarget(y);w!==void 0&&(m[y]=w)}),d.push({animation:m})}let g=!!d.length;return i&&h.initial===!1&&!t.manuallyAnimateOnMount&&(g=!1),i=!1,g?e(d):Promise.resolve()}function a(l,c,h){var u;if(n[l].isActive===c)return Promise.resolve();(u=t.variantChildren)===null||u===void 0||u.forEach(f=>{var p;return(p=f.animationState)===null||p===void 0?void 0:p.setActive(l,c)}),n[l].isActive=c;const d=o(h,l);for(const f in n)n[f].protectedKeys={};return d}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>n}}function Ive(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!Iq(e,t):!1}function Ed(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Bve(){return{animate:Ed(!0),whileInView:Ed(),whileHover:Ed(),whileTap:Ed(),whileDrag:Ed(),whileFocus:Ed(),exit:Ed()}}class Ove extends id{constructor(e){super(e),e.animationState||(e.animationState=Lve(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),uE(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){}}let Fve=0;class Nve extends id{constructor(){super(...arguments),this.id=Fve++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n,custom:i}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const s=this.node.animationState.setActive("exit",!e,{custom:i??this.node.getProps().custom});n&&!e&&s.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Uve={animation:{Feature:Ove},exit:{Feature:Nve}},OG=(t,e)=>Math.abs(t-e);function kve(t,e){const n=OG(t.x,e.x),i=OG(t.y,e.y);return Math.sqrt(n**2+i**2)}class dQ{constructor(e,n,{transformPagePoint:i}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const c=BP(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,u=kve(c.offset,{x:0,y:0})>=3;if(!h&&!u)return;const{point:d}=c,{timestamp:f}=vr;this.history.push({...d,timestamp:f});const{onStart:p,onMove:v}=this.handlers;h||(p&&p(this.lastMoveEvent,c),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,c)},this.handlePointerMove=(c,h)=>{this.lastMoveEvent=c,this.lastMoveEventInfo=IP(h,this.transformPagePoint),hi.update(this.updatePoint,!0)},this.handlePointerUp=(c,h)=>{if(this.end(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const{onEnd:u,onSessionEnd:d}=this.handlers,f=BP(c.type==="pointercancel"?this.lastMoveEventInfo:IP(h,this.transformPagePoint),this.history);this.startEvent&&u&&u(c,f),d&&d(c,f)},!Cq(e))return;this.handlers=n,this.transformPagePoint=i;const r=fE(e),s=IP(r,this.transformPagePoint),{point:o}=s,{timestamp:a}=vr;this.history=[{...o,timestamp:a}];const{onSessionStart:l}=n;l&&l(e,BP(s,this.history)),this.removeListeners=Ih(Kc(window,"pointermove",this.handlePointerMove),Kc(window,"pointerup",this.handlePointerUp),Kc(window,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),lu(this.updatePoint)}}function IP(t,e){return e?{point:e(t.point)}:t}function FG(t,e){return{x:t.x-e.x,y:t.y-e.y}}function BP({point:t},e){return{point:t,delta:FG(t,fQ(e)),offset:FG(t,zve(e)),velocity:Gve(e,.1)}}function zve(t){return t[0]}function fQ(t){return t[t.length-1]}function Gve(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,i=null;const r=fQ(t);for(;n>=0&&(i=t[n],!(r.timestamp-i.timestamp>Bh(e)));)n--;if(!i)return{x:0,y:0};const s=Jc(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function So(t){return t.max-t.min}function CL(t,e=0,n=.01){return Math.abs(t-e)<=n}function NG(t,e,n,i=.5){t.origin=i,t.originPoint=ci(e.min,e.max,t.origin),t.scale=So(n)/So(e),(CL(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=ci(n.min,n.max,t.origin)-t.originPoint,(CL(t.translate)||isNaN(t.translate))&&(t.translate=0)}function Dy(t,e,n,i){NG(t.x,e.x,n.x,i?i.originX:void 0),NG(t.y,e.y,n.y,i?i.originY:void 0)}function UG(t,e,n){t.min=n.min+e.min,t.max=t.min+So(e)}function Hve(t,e,n){UG(t.x,e.x,n.x),UG(t.y,e.y,n.y)}function kG(t,e,n){t.min=e.min-n.min,t.max=t.min+So(e)}function Ry(t,e,n){kG(t.x,e.x,n.x),kG(t.y,e.y,n.y)}function Vve(t,{min:e,max:n},i){return e!==void 0&&t<e?t=i?ci(e,t,i.min):Math.max(t,e):n!==void 0&&t>n&&(t=i?ci(n,t,i.max):Math.min(t,n)),t}function zG(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function jve(t,{top:e,left:n,bottom:i,right:r}){return{x:zG(t.x,n,r),y:zG(t.y,e,i)}}function GG(t,e){let n=e.min-t.min,i=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,i]=[i,n]),{min:n,max:i}}function Wve(t,e){return{x:GG(t.x,e.x),y:GG(t.y,e.y)}}function Xve(t,e){let n=.5;const i=So(t),r=So(e);return r>i?n=Px(e.min,e.max-i,t.min):i>r&&(n=Px(t.min,t.max-r,e.min)),Of(0,1,n)}function Yve(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const TL=.35;function qve(t=TL){return t===!1?t=0:t===!0&&(t=TL),{x:HG(t,"left","right"),y:HG(t,"top","bottom")}}function HG(t,e,n){return{min:VG(t,e),max:VG(t,n)}}function VG(t,e){return typeof t=="number"?t:t[e]||0}const jG=()=>({translate:0,scale:1,origin:0,originPoint:0}),Ly=()=>({x:jG(),y:jG()}),WG=()=>({min:0,max:0}),Ui=()=>({x:WG(),y:WG()});function Rl(t){return[t("x"),t("y")]}function pQ({top:t,left:e,right:n,bottom:i}){return{x:{min:e,max:n},y:{min:t,max:i}}}function Qve({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function Kve(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),i=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:i.y,right:i.x}}function OP(t){return t===void 0||t===1}function PL({scale:t,scaleX:e,scaleY:n}){return!OP(t)||!OP(e)||!OP(n)}function kd(t){return PL(t)||mQ(t)||t.z||t.rotate||t.rotateX||t.rotateY}function mQ(t){return XG(t.x)||XG(t.y)}function XG(t){return t&&t!=="0%"}function DA(t,e,n){const i=t-n,r=e*i;return n+r}function YG(t,e,n,i,r){return r!==void 0&&(t=DA(t,r,i)),DA(t,n,i)+e}function DL(t,e=0,n=1,i,r){t.min=YG(t.min,e,n,i,r),t.max=YG(t.max,e,n,i,r)}function gQ(t,{x:e,y:n}){DL(t.x,e.translate,e.scale,e.originPoint),DL(t.y,n.translate,n.scale,n.originPoint)}function Jve(t,e,n,i=!1){const r=n.length;if(!r)return;e.x=e.y=1;let s,o;for(let a=0;a<r;a++){s=n[a],o=s.projectionDelta;const l=s.instance;l&&l.style&&l.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&jm(t,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,gQ(t,o)),i&&kd(s.latestValues)&&jm(t,s.latestValues))}e.x=qG(e.x),e.y=qG(e.y)}function qG(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function th(t,e){t.min=t.min+e,t.max=t.max+e}function QG(t,e,[n,i,r]){const s=e[r]!==void 0?e[r]:.5,o=ci(t.min,t.max,s);DL(t,e[n],e[i],o,e.scale)}const Zve=["x","scaleX","originX"],$ve=["y","scaleY","originY"];function jm(t,e){QG(t.x,e,Zve),QG(t.y,e,$ve)}function vQ(t,e){return pQ(Kve(t.getBoundingClientRect(),e))}function e0e(t,e,n){const i=vQ(t,n),{scroll:r}=e;return r&&(th(i.x,r.offset.x),th(i.y,r.offset.y)),i}const t0e=new WeakMap;class n0e{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ui(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=l=>{this.stopAnimation(),n&&this.snapToCursor(fE(l,"page").point)},s=(l,c)=>{const{drag:h,dragPropagation:u,onDragStart:d}=this.getProps();if(h&&!u&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=Pq(h),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Rl(p=>{let v=this.getAxisMotionValue(p).get()||0;if(Yl.test(v)){const{projection:g}=this.visualElement;if(g&&g.layout){const m=g.layout.layoutBox[p];m&&(v=So(m)*(parseFloat(v)/100))}}this.originPoint[p]=v}),d&&hi.update(()=>d(l,c),!1,!0);const{animationState:f}=this.visualElement;f&&f.setActive("whileDrag",!0)},o=(l,c)=>{const{dragPropagation:h,dragDirectionLock:u,onDirectionLock:d,onDrag:f}=this.getProps();if(!h&&!this.openGlobalLock)return;const{offset:p}=c;if(u&&this.currentDirection===null){this.currentDirection=i0e(p),this.currentDirection!==null&&d&&d(this.currentDirection);return}this.updateAxis("x",c.point,p),this.updateAxis("y",c.point,p),this.visualElement.render(),f&&f(l,c)},a=(l,c)=>this.stop(l,c);this.panSession=new dQ(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:a},{transformPagePoint:this.visualElement.getTransformPagePoint()})}stop(e,n){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=n;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&hi.update(()=>s(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,i){const{drag:r}=this.getProps();if(!i||!J_(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=Vve(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:n}=this.getProps(),{layout:i}=this.visualElement.projection||{},r=this.constraints;e&&Hm(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&i?this.constraints=jve(i.layoutBox,e):this.constraints=!1,this.elastic=qve(n),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Rl(s=>{this.getAxisMotionValue(s)&&(this.constraints[s]=Yve(i.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Hm(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=e0e(i,r.root,this.visualElement.getTransformPagePoint());let o=Wve(r.layout.layoutBox,s);if(n){const a=n(Qve(o));this.hasMutatedConstraints=!!a,a&&(o=pQ(a))}return o}startAnimation(e){const{drag:n,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=Rl(h=>{if(!J_(h,n,this.currentDirection))return;let u=l&&l[h]||{};o&&(u={min:0,max:0});const d=r?200:1e6,f=r?40:1e7,p={type:"inertia",velocity:i?e[h]:0,bounceStiffness:d,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...s,...u};return this.startAxisValueAnimation(h,p)});return Promise.all(c).then(a)}startAxisValueAnimation(e,n){const i=this.getAxisMotionValue(e);return i.start(MO(e,i,0,n))}stopAnimation(){Rl(e=>this.getAxisMotionValue(e).stop())}getAxisMotionValue(e){const n="_drag"+e.toUpperCase(),i=this.visualElement.getProps(),r=i[n];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){Rl(n=>{const{drag:i}=this.getProps();if(!J_(n,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(n);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[n];s.set(e[n]-ci(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:i}=this.visualElement;if(!Hm(n)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Rl(o=>{const a=this.getAxisMotionValue(o);if(a){const l=a.get();r[o]=Xve({min:l,max:l},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Rl(o=>{if(!J_(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(ci(l,c,r[o]))})}addListeners(){if(!this.visualElement.current)return;t0e.set(this.visualElement,this);const e=this.visualElement.current,n=Kc(e,"pointerdown",l=>{const{drag:c,dragListener:h=!0}=this.getProps();c&&h&&this.start(l)}),i=()=>{const{dragConstraints:l}=this.getProps();Hm(l)&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),i();const o=jc(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Rl(h=>{const u=this.getAxisMotionValue(h);u&&(this.originPoint[h]+=l[h].translate,u.set(u.get()+l[h].translate))}),this.visualElement.render())});return()=>{o(),n(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=TL,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function J_(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function i0e(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class r0e extends id{constructor(e){super(e),this.removeGroupControls=Zi,this.removeListeners=Zi,this.controls=new n0e(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Zi}unmount(){this.removeGroupControls(),this.removeListeners()}}const KG=t=>(e,n)=>{t&&hi.update(()=>t(e,n))};class s0e extends id{constructor(){super(...arguments),this.removePointerDownListener=Zi}onPointerDown(e){this.session=new dQ(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint()})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:KG(e),onStart:KG(n),onMove:i,onEnd:(s,o)=>{delete this.session,r&&hi.update(()=>r(s,o))}}}mount(){this.removePointerDownListener=Kc(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function o0e(){const t=ge.useContext(cO);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:n,register:i}=t,r=ge.useId();return ge.useEffect(()=>i(r),[]),!e&&n?[!1,()=>n&&n(r)]:[!0]}const DS={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function JG(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const _0={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Ft.test(t))t=parseFloat(t);else return t;const n=JG(t,e.target.x),i=JG(t,e.target.y);return`${n}% ${i}%`}},a0e={correct:(t,{treeScale:e,projectionDelta:n})=>{const i=t,r=Yh.parse(t);if(r.length>5)return i;const s=Yh.createTransformer(t),o=typeof r[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;r[0+o]/=a,r[1+o]/=l;const c=ci(a,l,.5);return typeof r[2+o]=="number"&&(r[2+o]/=c),typeof r[3+o]=="number"&&(r[3+o]/=c),s(r)}};class l0e extends du.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;pme(c0e),s&&(n.group&&n.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),DS.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||hi.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function yQ(t){const[e,n]=o0e(),i=ge.useContext(dq);return du.createElement(l0e,{...t,layoutGroup:i,switchLayoutGroup:ge.useContext(fq),isPresent:e,safeToRemove:n})}const c0e={borderRadius:{..._0,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:_0,borderTopRightRadius:_0,borderBottomLeftRadius:_0,borderBottomRightRadius:_0,boxShadow:a0e},xQ=["TopLeft","TopRight","BottomLeft","BottomRight"],u0e=xQ.length,ZG=t=>typeof t=="string"?parseFloat(t):t,$G=t=>typeof t=="number"||Ft.test(t);function h0e(t,e,n,i,r,s){r?(t.opacity=ci(0,n.opacity!==void 0?n.opacity:1,d0e(i)),t.opacityExit=ci(e.opacity!==void 0?e.opacity:1,0,f0e(i))):s&&(t.opacity=ci(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,i));for(let o=0;o<u0e;o++){const a=`border${xQ[o]}Radius`;let l=eH(e,a),c=eH(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||$G(l)===$G(c)?(t[a]=Math.max(ci(ZG(l),ZG(c),i),0),(Yl.test(c)||Yl.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||n.rotate)&&(t.rotate=ci(e.rotate||0,n.rotate||0,i))}function eH(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const d0e=wQ(0,.5,_O),f0e=wQ(.5,.95,Zi);function wQ(t,e,n){return i=>i<t?0:i>e?1:n(Px(t,e,i))}function tH(t,e){t.min=e.min,t.max=e.max}function Uo(t,e){tH(t.x,e.x),tH(t.y,e.y)}function nH(t,e,n,i,r){return t-=e,t=DA(t,1/n,i),r!==void 0&&(t=DA(t,1/r,i)),t}function p0e(t,e=0,n=1,i=.5,r,s=t,o=t){if(Yl.test(e)&&(e=parseFloat(e),e=ci(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=ci(s.min,s.max,i);t===s&&(a-=e),t.min=nH(t.min,e,n,a,r),t.max=nH(t.max,e,n,a,r)}function iH(t,e,[n,i,r],s,o){p0e(t,e[n],e[i],e[r],e.scale,s,o)}const m0e=["x","scaleX","originX"],g0e=["y","scaleY","originY"];function rH(t,e,n,i){iH(t.x,e,m0e,n?n.x:void 0,i?i.x:void 0),iH(t.y,e,g0e,n?n.y:void 0,i?i.y:void 0)}function sH(t){return t.translate===0&&t.scale===1}function _Q(t){return sH(t.x)&&sH(t.y)}function RL(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function oH(t){return So(t.x)/So(t.y)}class v0e{constructor(){this.members=[]}add(e){EO(this.members,e),e.scheduleRender()}remove(e){if(CO(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(r=>e===r);if(n===0)return!1;let i;for(let r=n;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,n){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,n&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:i}=e;n.onExitComplete&&n.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function aH(t,e,n){let i="";const r=t.x.translate/e.x,s=t.y.translate/e.y;if((r||s)&&(i=`translate3d(${r}px, ${s}px, 0) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),n){const{rotate:l,rotateX:c,rotateY:h}=n;l&&(i+=`rotate(${l}deg) `),c&&(i+=`rotateX(${c}deg) `),h&&(i+=`rotateY(${h}deg) `)}const o=t.x.scale*e.x,a=t.y.scale*e.y;return(o!==1||a!==1)&&(i+=`scale(${o}, ${a})`),i||"none"}const y0e=(t,e)=>t.depth-e.depth;class x0e{constructor(){this.children=[],this.isDirty=!1}add(e){EO(this.children,e),this.isDirty=!0}remove(e){CO(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(y0e),this.isDirty=!1,this.children.forEach(e)}}function w0e(t,e){const n=performance.now(),i=({timestamp:r})=>{const s=r-n;s>=e&&(lu(i),t(s-e))};return hi.read(i,!0),()=>lu(i)}function _0e(t){window.MotionDebug&&window.MotionDebug.record(t)}function b0e(t){return t instanceof SVGElement&&t.tagName!=="svg"}function S0e(t,e,n){const i=Hs(t)?t:jg(t);return i.start(MO("",i,e,n)),i.animation}const lH=["","X","Y","Z"],cH=1e3;let A0e=0;const zd={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function bQ({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},a=e==null?void 0:e()){this.id=A0e++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{zd.totalNodes=zd.resolvedTargetDeltas=zd.recalculatedProjection=0,this.nodes.forEach(C0e),this.nodes.forEach(R0e),this.nodes.forEach(L0e),this.nodes.forEach(T0e),_0e(zd)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new x0e)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new TO),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=b0e(o),this.instance=o;const{layoutId:l,layout:c,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(c||l)&&(this.isLayoutDirty=!0),t){let u;const d=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,u&&u(),u=w0e(d,250),DS.hasAnimatedSinceResize&&(DS.hasAnimatedSinceResize=!1,this.nodes.forEach(hH))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||c)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeTargetChanged:f,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||h.getDefaultTransition()||N0e,{onLayoutAnimationStart:g,onLayoutAnimationComplete:m}=h.getProps(),y=!this.targetLayout||!RL(this.targetLayout,p)||f,w=!d&&f;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||w||d&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(u,w);const b={...lQ(v,"layout"),onPlay:g,onComplete:m};(h.shouldReduceMotion||this.options.layoutRoot)&&(b.delay=0,b.type=!1),this.startAnimation(b)}else!d&&this.animationProgress===0&&hH(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,lu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(I0e),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const u=this.path[h];u.shouldResetTransform=!0,u.updateScroll("snapshot"),u.options.layoutRoot&&u.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(uH);return}this.isUpdating&&(this.isUpdating=!1,this.nodes.forEach(D0e),this.nodes.forEach(M0e),this.nodes.forEach(E0e),this.clearAllSnapshots(),dg.update.process(vr),dg.preRender.process(vr),dg.render.process(vr))}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(P0e),this.sharedNodes.forEach(B0e)}scheduleUpdateProjection(){hi.preRender(this.updateProjection,!1,!0)}scheduleCheckAfterUnmount(){hi.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ui(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:i(this.instance),offset:n(this.instance)})}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform,a=this.projectionDelta&&!_Q(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,h=c!==this.prevTransformTemplateValue;o&&(a||kd(this.latestValues)||h)&&(r(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),U0e(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return Ui();const a=o.measureViewportBox(),{scroll:l}=this.root;return l&&(th(a.x,l.offset.x),th(a.y,l.offset.y)),a}removeElementScroll(o){const a=Ui();Uo(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l],{scroll:h,options:u}=c;if(c!==this.root&&h&&u.layoutScroll){if(h.isRoot){Uo(a,o);const{scroll:d}=this.root;d&&(th(a.x,-d.offset.x),th(a.y,-d.offset.y))}th(a.x,h.offset.x),th(a.y,h.offset.y)}}return a}applyTransform(o,a=!1){const l=Ui();Uo(l,o);for(let c=0;c<this.path.length;c++){const h=this.path[c];!a&&h.options.layoutScroll&&h.scroll&&h!==h.root&&jm(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),kd(h.latestValues)&&jm(l,h.latestValues)}return kd(this.latestValues)&&jm(l,this.latestValues),l}removeTransform(o){const a=Ui();Uo(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!kd(c.latestValues))continue;PL(c.latestValues)&&c.updateSnapshot();const h=Ui(),u=c.measurePageBox();Uo(h,u),rH(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,h)}return kd(this.latestValues)&&rH(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==vr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:u,layoutId:d}=this.options;if(!(!this.layout||!(u||d))){if(this.resolvedRelativeTargetAt=vr.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ui(),this.relativeTargetOrigin=Ui(),Ry(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),Uo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ui(),this.targetWithTransforms=Ui()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Hve(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Uo(this.target,this.layout.layoutBox),gQ(this.target,this.targetDelta)):Uo(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ui(),this.relativeTargetOrigin=Ui(),Ry(this.relativeTargetOrigin,this.target,f.target),Uo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}zd.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||PL(this.parent.latestValues)||mQ(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===vr.timestamp&&(c=!1),c)return;const{layout:h,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||u))return;Uo(this.layoutCorrected,this.layout.layoutBox),Jve(this.layoutCorrected,this.treeScale,this.path,l);const{target:d}=a;if(!d)return;this.projectionDelta||(this.projectionDelta=Ly(),this.projectionDeltaWithTransform=Ly());const f=this.treeScale.x,p=this.treeScale.y,v=this.projectionTransform;Dy(this.projectionDelta,this.layoutCorrected,d,this.latestValues),this.projectionTransform=aH(this.projectionDelta,this.treeScale),(this.projectionTransform!==v||this.treeScale.x!==f||this.treeScale.y!==p)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",d)),zd.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const a=this.getStack();a&&a.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},h={...this.latestValues},u=Ly();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const d=Ui(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,v=f!==p,g=this.getStack(),m=!g||g.members.length<=1,y=!!(v&&!m&&this.options.crossfade===!0&&!this.path.some(F0e));this.animationProgress=0;let w;this.mixTargetDelta=b=>{const A=b/1e3;dH(u.x,o.x,A),dH(u.y,o.y,A),this.setTargetDelta(u),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ry(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),O0e(this.relativeTarget,this.relativeTargetOrigin,d,A),w&&RL(this.relativeTarget,w)&&(this.isProjectionDirty=!1),w||(w=Ui()),Uo(w,this.relativeTarget)),v&&(this.animationValues=h,h0e(h,c,this.latestValues,A,y,m)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=A},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(lu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=hi.update(()=>{DS.hasAnimatedSinceResize=!0,this.currentAnimation=S0e(0,cH,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(cH),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:h}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&SQ(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Ui();const u=So(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+u;const d=So(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+d}Uo(a,l),jm(a,h),Dy(this.projectionDeltaWithTransform,this.layoutCorrected,a,h)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new v0e),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.rotate||l.rotateX||l.rotateY||l.rotateZ)&&(a=!0),!a)return;const c={};for(let h=0;h<lH.length;h++){const u="rotate"+lH[h];l[u]&&(c[u]=l[u],o.setStaticValue(u,0))}o.render();for(const h in c)o.setStaticValue(h,c[h]);o.scheduleRender()}getProjectionStyles(o={}){var a,l;const c={};if(!this.instance||this.isSVG)return c;if(this.isVisible)c.visibility="";else return{visibility:"hidden"};const h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=PS(o.pointerEvents)||"",c.transform=h?h(this.latestValues,""):"none",c;const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){const v={};return this.options.layoutId&&(v.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,v.pointerEvents=PS(o.pointerEvents)||""),this.hasProjected&&!kd(this.latestValues)&&(v.transform=h?h({},""):"none",this.hasProjected=!1),v}const d=u.animationValues||u.latestValues;this.applyTransformsToTarget(),c.transform=aH(this.projectionDeltaWithTransform,this.treeScale,d),h&&(c.transform=h(d,c.transform));const{x:f,y:p}=this.projectionDelta;c.transformOrigin=`${f.origin*100}% ${p.origin*100}% 0`,u.animationValues?c.opacity=u===this?(l=(a=d.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:c.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const v in SA){if(d[v]===void 0)continue;const{correct:g,applyTo:m}=SA[v],y=c.transform==="none"?d[v]:g(d[v],u);if(m){const w=m.length;for(let b=0;b<w;b++)c[m[b]]=y}else c[v]=y}return this.options.layoutId&&(c.pointerEvents=u===this?PS(o.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(uH),this.root.sharedNodes.clear()}}}function M0e(t){t.updateLayout()}function E0e(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=t.layout,{animationType:s}=t.options,o=n.source!==t.layout.source;s==="size"?Rl(u=>{const d=o?n.measuredBox[u]:n.layoutBox[u],f=So(d);d.min=i[u].min,d.max=d.min+f}):SQ(s,n.layoutBox,i)&&Rl(u=>{const d=o?n.measuredBox[u]:n.layoutBox[u],f=So(i[u]);d.max=d.min+f,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[u].max=t.relativeTarget[u].min+f)});const a=Ly();Dy(a,i,n.layoutBox);const l=Ly();o?Dy(l,t.applyTransform(r,!0),n.measuredBox):Dy(l,i,n.layoutBox);const c=!_Q(a);let h=!1;if(!t.resumeFrom){const u=t.getClosestProjectingParent();if(u&&!u.resumeFrom){const{snapshot:d,layout:f}=u;if(d&&f){const p=Ui();Ry(p,n.layoutBox,d.layoutBox);const v=Ui();Ry(v,i,f.layoutBox),RL(p,v)||(h=!0),u.options.layoutRoot&&(t.relativeTarget=v,t.relativeTargetOrigin=p,t.relativeParent=u)}}}t.notifyListeners("didUpdate",{layout:i,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeTargetChanged:h})}else if(t.isLead()){const{onExitComplete:i}=t.options;i&&i()}t.options.transition=void 0}function C0e(t){zd.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function T0e(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function P0e(t){t.clearSnapshot()}function uH(t){t.clearMeasurements()}function D0e(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function hH(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0}function R0e(t){t.resolveTargetDelta()}function L0e(t){t.calcProjection()}function I0e(t){t.resetRotation()}function B0e(t){t.removeLeadSnapshot()}function dH(t,e,n){t.translate=ci(e.translate,0,n),t.scale=ci(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function fH(t,e,n,i){t.min=ci(e.min,n.min,i),t.max=ci(e.max,n.max,i)}function O0e(t,e,n,i){fH(t.x,e.x,n.x,i),fH(t.y,e.y,n.y,i)}function F0e(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const N0e={duration:.45,ease:[.4,0,.1,1]};function pH(t){t.min=Math.round(t.min),t.max=Math.round(t.max)}function U0e(t){pH(t.x),pH(t.y)}function SQ(t,e,n){return t==="position"||t==="preserve-aspect"&&!CL(oH(e),oH(n),.2)}const k0e=bQ({attachResizeListener:(t,e)=>jc(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),FP={current:void 0},AQ=bQ({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!FP.current){const t=new k0e({});t.mount(window),t.setOptions({layoutScroll:!0}),FP.current=t}return FP.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),z0e={pan:{Feature:s0e},drag:{Feature:r0e,ProjectionNode:AQ,MeasureLayout:yQ}},G0e=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function H0e(t){const e=G0e.exec(t);if(!e)return[,];const[,n,i]=e;return[n,i]}function LL(t,e,n=1){const[i,r]=H0e(t);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);return s?s.trim():xL(r)?LL(r,e,n+1):r}function V0e(t,{...e},n){const i=t.current;if(!(i instanceof Element))return{target:e,transitionEnd:n};n&&(n={...n}),t.values.forEach(r=>{const s=r.get();if(!xL(s))return;const o=LL(s,i);o&&r.set(o)});for(const r in e){const s=e[r];if(!xL(s))continue;const o=LL(s,i);o&&(e[r]=o,n||(n={}),n[r]===void 0&&(n[r]=s))}return{target:e,transitionEnd:n}}const j0e=new Set(["width","height","top","left","right","bottom","x","y"]),MQ=t=>j0e.has(t),W0e=t=>Object.keys(t).some(MQ),mH=t=>t===Jf||t===Ft,gH=(t,e)=>parseFloat(t.split(", ")[e]),vH=(t,e)=>(n,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/);if(r)return gH(r[1],e);{const s=i.match(/^matrix\((.+)\)$/);return s?gH(s[1],t):0}},X0e=new Set(["x","y","z"]),Y0e=D1.filter(t=>!X0e.has(t));function q0e(t){const e=[];return Y0e.forEach(n=>{const i=t.getValue(n);i!==void 0&&(e.push([n,i.get()]),i.set(n.startsWith("scale")?1:0))}),e.length&&t.render(),e}const yH={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:vH(4,13),y:vH(5,14)},Q0e=(t,e,n)=>{const i=e.measureViewportBox(),r=e.current,s=getComputedStyle(r),{display:o}=s,a={};o==="none"&&e.setStaticValue("display",t.display||"block"),n.forEach(c=>{a[c]=yH[c](i,s)}),e.render();const l=e.measureViewportBox();return n.forEach(c=>{const h=e.getValue(c);h&&h.jump(a[c]),t[c]=yH[c](l,s)}),t},K0e=(t,e,n={},i={})=>{e={...e},i={...i};const r=Object.keys(e).filter(MQ);let s=[],o=!1;const a=[];if(r.forEach(l=>{const c=t.getValue(l);if(!t.hasValue(l))return;let h=n[l],u=w0(h);const d=e[l];let f;if(MA(d)){const p=d.length,v=d[0]===null?1:0;h=d[v],u=w0(h);for(let g=v;g<p&&d[g]!==null;g++)f?wO(w0(d[g])===f):f=w0(d[g])}else f=w0(d);if(u!==f)if(mH(u)&&mH(f)){const p=c.get();typeof p=="string"&&c.set(parseFloat(p)),typeof d=="string"?e[l]=parseFloat(d):Array.isArray(d)&&f===Ft&&(e[l]=d.map(parseFloat))}else u!=null&&u.transform&&(f!=null&&f.transform)&&(h===0||d===0)?h===0?c.set(f.transform(h)):e[l]=u.transform(d):(o||(s=q0e(t),o=!0),a.push(l),i[l]=i[l]!==void 0?i[l]:e[l],c.jump(d))}),a.length){const l=a.indexOf("height")>=0?window.pageYOffset:null,c=Q0e(e,t,a);return s.length&&s.forEach(([h,u])=>{t.getValue(h).set(u)}),t.render(),cE&&l!==null&&window.scrollTo({top:l}),{target:c,transitionEnd:i}}else return{target:e,transitionEnd:i}};function J0e(t,e,n,i){return W0e(e)?K0e(t,e,n,i):{target:e,transitionEnd:i}}const Z0e=(t,e,n,i)=>{const r=V0e(t,e,i);return e=r.target,i=r.transitionEnd,J0e(t,e,n,i)},IL={current:null},EQ={current:!1};function $0e(){if(EQ.current=!0,!!cE)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>IL.current=t.matches;t.addListener(e),e()}else IL.current=!1}function eye(t,e,n){const{willChange:i}=e;for(const r in e){const s=e[r],o=n[r];if(Hs(s))t.addValue(r,s),PA(i)&&i.add(r);else if(Hs(o))t.addValue(r,jg(s,{owner:t})),PA(i)&&i.remove(r);else if(o!==s)if(t.hasValue(r)){const a=t.getValue(r);!a.hasAnimated&&a.set(s)}else{const a=t.getStaticValue(r);t.addValue(r,jg(a!==void 0?a:s,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const xH=new WeakMap,CQ=Object.keys(Cx),tye=CQ.length,wH=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],nye=hO.length;class iye{constructor({parent:e,props:n,presenceContext:i,reducedMotionConfig:r,visualState:s},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>hi.render(this.render,!1,!0);const{latestValues:a,renderState:l}=s;this.latestValues=a,this.baseTarget={...a},this.initialValues=n.initial?{...a}:{},this.renderState=l,this.parent=e,this.props=n,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=o,this.isControllingVariants=hE(n),this.isVariantNode=hq(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:c,...h}=this.scrapeMotionValuesFromProps(n,{});for(const u in h){const d=h[u];a[u]!==void 0&&Hs(d)&&(d.set(a[u],!1),PA(c)&&c.add(u))}}scrapeMotionValuesFromProps(e,n){return{}}mount(e){this.current=e,xH.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,i)=>this.bindToMotionValue(i,n)),EQ.current||$0e(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:IL.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){xH.delete(this.current),this.projection&&this.projection.unmount(),lu(this.notifyUpdate),lu(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,n){const i=Kf.has(e),r=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&hi.update(this.notifyUpdate,!1,!0),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{r(),s()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...n},i,r,s){let o,a;for(let l=0;l<tye;l++){const c=CQ[l],{isEnabled:h,Feature:u,ProjectionNode:d,MeasureLayout:f}=Cx[c];d&&(o=d),h(n)&&(!this.features[c]&&u&&(this.features[c]=new u(this)),f&&(a=f))}if(!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:l,layout:c,drag:h,dragConstraints:u,layoutScroll:d,layoutRoot:f}=n;this.projection.setOptions({layoutId:l,layout:c,alwaysMeasureLayout:!!h||u&&Hm(u),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof c=="string"?c:"both",initialPromotionConfig:s,layoutScroll:d,layoutRoot:f})}return a}updateFeatures(){for(const e in this.features){const n=this.features[e];n.isMounted?n.update(this.props,this.prevProps):(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ui()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}makeTargetAnimatable(e,n=!0){return this.makeTargetAnimatableFromInstance(e,this.props,n)}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let i=0;i<wH.length;i++){const r=wH[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s=e["on"+r];s&&(this.propEventSubscriptions[r]=this.on(r,s))}this.prevMotionValues=eye(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const i=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(i.initial=this.props.initial),i}const n={};for(let i=0;i<nye;i++){const r=hO[i],s=this.props[r];(Ex(s)||s===!1)&&(n[r]=s)}return n}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){n!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,n)),this.values.set(e,n),this.latestValues[e]=n.get()}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&n!==void 0&&(i=jg(n,{owner:this}),this.addValue(e,i)),i}readValue(e){return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:i}=this.props,r=typeof i=="string"||typeof i=="object"?(n=xO(this.props,i))===null||n===void 0?void 0:n[e]:void 0;if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Hs(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new TO),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class TQ extends iye{sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:i}){delete n[e],delete i[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:n,...i},{transformValues:r},s){let o=Ave(i,e||{},this);if(r&&(n&&(n=r(n)),i&&(i=r(i)),o&&(o=r(o))),s){bve(this,i,o);const a=Z0e(this,i,o,n);n=a.transitionEnd,i=a.target}return{transition:e,transitionEnd:n,...i}}}function rye(t){return window.getComputedStyle(t)}class sye extends TQ{readValueFromInstance(e,n){if(Kf.has(n)){const i=AO(n);return i&&i.default||0}else{const i=rye(e),r=(gq(n)?i.getPropertyValue(n):i[n])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:n}){return vQ(e,n)}build(e,n,i,r){fO(e,n,i,r.transformTemplate)}scrapeMotionValuesFromProps(e,n){return yO(e,n)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Hs(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}renderInstance(e,n,i,r){bq(e,n,i,r)}}class oye extends TQ{constructor(){super(...arguments),this.isSVGTag=!1}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Kf.has(n)){const i=AO(n);return i&&i.default||0}return n=Sq.has(n)?n:vO(n),e.getAttribute(n)}measureInstanceViewportBox(){return Ui()}scrapeMotionValuesFromProps(e,n){return Mq(e,n)}build(e,n,i,r){mO(e,n,i,this.isSVGTag,r.transformTemplate)}renderInstance(e,n,i,r){Aq(e,n,i,r)}mount(e){this.isSVGTag=gO(e.tagName),super.mount(e)}}const aye=(t,e)=>dO(t)?new oye(e,{enableHardwareAcceleration:!1}):new sye(e,{enableHardwareAcceleration:!0}),lye={layout:{ProjectionNode:AQ,MeasureLayout:yQ}},cye={...Uve,...sge,...z0e,...lye},Wg=dme((t,e)=>Hme(t,e,cye,aye)),PQ=t=>({hidden:{y:-50,opacity:0},show:{y:0,opacity:1,transition:{type:"spring",duration:1.25,delay:t}}}),uye=(t,e,n,i)=>({hidden:{x:t==="left"?100:t==="right"?-100:0,y:t==="up"?100:t==="down"?-100:0,opacity:0},show:{x:0,y:0,opacity:1,transition:{type:e,delay:n,duration:i,ease:"easeOut"}}}),_H=(t,e,n,i)=>({hidden:{x:t==="left"?"-100%":t==="right"?"100%":0,y:t==="up"||t==="down"?"100%":0},show:{x:0,y:0,transition:{type:e,delay:n,duration:i,ease:"easeOut"}}}),hye=(t,e)=>({hidden:{},show:{transition:{staggerChildren:t,delayChildren:e||0}}}),PO=(t,e)=>function(){return We.jsx(Wg.section,{variants:hye(),initial:"hidden",whileInView:"show",viewport:{once:!0,amount:.3},className:`${au.padding} max-w-7xl mx-auto relative z-0`,children:We.jsx(t,{})})},dye=()=>We.jsxs(We.Fragment,{children:[We.jsxs(Wg.div,{variants:PQ(),children:[We.jsx("p",{className:au.sectionSubText,children:"Introduction"}),We.jsx("h2",{className:au.sectionHeadText,children:"Overview"})]}),We.jsx(Wg.p,{variants:uye("","",.1,1),className:"mt-4 text-secondary text-[17px] max-w-3xl leading-[30px]",children:"As a senior Computer Engineering student at California State Polytechnic University, Pomona, I embody a hands-on approach to learning, with a strong emphasis on practical program development and hands-on experimentation with electronic components. Through actively building real-world applications and exploring the intricacies of hardware, I have cultivated my skills in creating innovative solutions and adeptly problem-solving within the dynamic field of computer engineering."})]}),DQ=PO(dye),fye=()=>We.jsx(We.Fragment,{children:We.jsx("div",{children:We.jsx("h1",{children:"Software: Python / C++ / C# / C / Node Js / PostgreSQL / Express / React / OpenAIPspice / Arduino / MATLAB / MPLAB / PSpice (OrCAD) / VScode / Assembly Language / yolov7 / Forever / Linux / PM2 / REST API Hardware: : PIC18 Microcontroller / Oscilloscope / Digital Multimeter / FPGA / Arduino / AC PSU / DC PSU"})})});var gE={},RQ={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var i=[],r=0;r<arguments.length;r++){var s=arguments[r];if(s){var o=typeof s;if(o==="string"||o==="number")i.push(s);else if(Array.isArray(s)){if(s.length){var a=n.apply(null,s);a&&i.push(a)}}else if(o==="object"){if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]")){i.push(s.toString());continue}for(var l in s)e.call(s,l)&&s[l]&&i.push(l)}}}return i.join(" ")}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(RQ);var LQ=RQ.exports;gE.__esModule=!0;gE.default=void 0;var pye=DO(ge),Bu=DO(lO),mye=DO(LQ);function DO(t){return t&&t.__esModule?t:{default:t}}const IQ=({animate:t=!0,className:e="",layout:n="2-columns",lineColor:i="#FFF",children:r})=>(typeof window=="object"&&document.documentElement.style.setProperty("--line-color",i),pye.default.createElement("div",{className:(0,mye.default)(e,"vertical-timeline",{"vertical-timeline--animate":t,"vertical-timeline--two-columns":n==="2-columns","vertical-timeline--one-column-left":n==="1-column"||n==="1-column-left","vertical-timeline--one-column-right":n==="1-column-right"})},r));IQ.propTypes={children:Bu.default.oneOfType([Bu.default.arrayOf(Bu.default.node),Bu.default.node]).isRequired,className:Bu.default.string,animate:Bu.default.bool,layout:Bu.default.oneOf(["1-column-left","1-column","2-columns","1-column-right"]),lineColor:Bu.default.string};var gye=IQ;gE.default=gye;var vE={};function BL(){return BL=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},BL.apply(this,arguments)}function vye(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,OL(t,e)}function OL(t,e){return OL=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},OL(t,e)}function yye(t,e){if(t==null)return{};var n={},i=Object.keys(t),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}var FL=new Map,Z_=new WeakMap,bH=0,BQ=void 0;function xye(t){BQ=t}function wye(t){return t?(Z_.has(t)||(bH+=1,Z_.set(t,bH.toString())),Z_.get(t)):"0"}function _ye(t){return Object.keys(t).sort().filter(function(e){return t[e]!==void 0}).map(function(e){return e+"_"+(e==="root"?wye(t.root):t[e])}).toString()}function bye(t){var e=_ye(t),n=FL.get(e);if(!n){var i=new Map,r,s=new IntersectionObserver(function(o){o.forEach(function(a){var l,c=a.isIntersecting&&r.some(function(h){return a.intersectionRatio>=h});t.trackVisibility&&typeof a.isVisible>"u"&&(a.isVisible=c),(l=i.get(a.target))==null||l.forEach(function(h){h(c,a)})})},t);r=s.thresholds||(Array.isArray(t.threshold)?t.threshold:[t.threshold||0]),n={id:e,observer:s,elements:i},FL.set(e,n)}return n}function RO(t,e,n,i){if(n===void 0&&(n={}),i===void 0&&(i=BQ),typeof window.IntersectionObserver>"u"&&i!==void 0){var r=t.getBoundingClientRect();return e(i,{isIntersecting:i,target:t,intersectionRatio:typeof n.threshold=="number"?n.threshold:0,time:0,boundingClientRect:r,intersectionRect:r,rootBounds:r}),function(){}}var s=bye(n),o=s.id,a=s.observer,l=s.elements,c=l.get(t)||[];return l.has(t)||l.set(t,c),c.push(e),a.observe(t),function(){c.splice(c.indexOf(e),1),c.length===0&&(l.delete(t),a.unobserve(t)),l.size===0&&(a.disconnect(),FL.delete(o))}}var Sye=["children","as","triggerOnce","threshold","root","rootMargin","onChange","skip","trackVisibility","delay","initialInView","fallbackInView"];function SH(t){return typeof t.children!="function"}var RA=function(t){vye(e,t);function e(i){var r;return r=t.call(this,i)||this,r.node=null,r._unobserveCb=null,r.handleNode=function(s){r.node&&(r.unobserve(),!s&&!r.props.triggerOnce&&!r.props.skip&&r.setState({inView:!!r.props.initialInView,entry:void 0})),r.node=s||null,r.observeNode()},r.handleChange=function(s,o){s&&r.props.triggerOnce&&r.unobserve(),SH(r.props)||r.setState({inView:s,entry:o}),r.props.onChange&&r.props.onChange(s,o)},r.state={inView:!!i.initialInView,entry:void 0},r}var n=e.prototype;return n.componentDidUpdate=function(r){(r.rootMargin!==this.props.rootMargin||r.root!==this.props.root||r.threshold!==this.props.threshold||r.skip!==this.props.skip||r.trackVisibility!==this.props.trackVisibility||r.delay!==this.props.delay)&&(this.unobserve(),this.observeNode())},n.componentWillUnmount=function(){this.unobserve(),this.node=null},n.observeNode=function(){if(!(!this.node||this.props.skip)){var r=this.props,s=r.threshold,o=r.root,a=r.rootMargin,l=r.trackVisibility,c=r.delay,h=r.fallbackInView;this._unobserveCb=RO(this.node,this.handleChange,{threshold:s,root:o,rootMargin:a,trackVisibility:l,delay:c},h)}},n.unobserve=function(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)},n.render=function(){if(!SH(this.props)){var r=this.state,s=r.inView,o=r.entry;return this.props.children({inView:s,entry:o,ref:this.handleNode})}var a=this.props,l=a.children,c=a.as,h=yye(a,Sye);return ge.createElement(c||"div",BL({ref:this.handleNode},h),l)},e}(ge.Component);RA.displayName="InView";RA.defaultProps={threshold:0,triggerOnce:!1,initialInView:!1};function Aye(t){var e=t===void 0?{}:t,n=e.threshold,i=e.delay,r=e.trackVisibility,s=e.rootMargin,o=e.root,a=e.triggerOnce,l=e.skip,c=e.initialInView,h=e.fallbackInView,u=ge.useRef(),d=ge.useState({inView:!!c}),f=d[0],p=d[1],v=ge.useCallback(function(m){u.current!==void 0&&(u.current(),u.current=void 0),!l&&m&&(u.current=RO(m,function(y,w){p({inView:y,entry:w}),w.isIntersecting&&a&&u.current&&(u.current(),u.current=void 0)},{root:o,rootMargin:s,threshold:n,trackVisibility:r,delay:i},h))},[Array.isArray(n)?n.toString():n,o,s,a,l,r,h,i]);ge.useEffect(function(){!u.current&&f.entry&&!a&&!l&&p({inView:!!c})});var g=[v,f.inView,f.entry];return g.ref=g[0],g.inView=g[1],g.entry=g[2],g}const Mye=Object.freeze(Object.defineProperty({__proto__:null,InView:RA,default:RA,defaultFallbackInView:xye,observe:RO,useInView:Aye},Symbol.toStringTag,{value:"Module"})),Eye=wte(Mye);vE.__esModule=!0;vE.default=void 0;var Ou=LO(ge),$n=LO(lO),$_=LO(LQ),Cye=Eye;function LO(t){return t&&t.__esModule?t:{default:t}}const OQ=({children:t="",className:e="",contentArrowStyle:n=null,contentStyle:i=null,date:r="",dateClassName:s="",icon:o=null,iconClassName:a="",iconOnClick:l=null,onTimelineElementClick:c=null,iconStyle:h=null,id:u="",position:d="",style:f=null,textClassName:p="",intersectionObserverProps:v={rootMargin:"0px 0px -40px 0px",triggerOnce:!0},visible:g=!1})=>Ou.default.createElement(Cye.InView,v,({inView:m,ref:y})=>Ou.default.createElement("div",{ref:y,id:u,className:(0,$_.default)(e,"vertical-timeline-element",{"vertical-timeline-element--left":d==="left","vertical-timeline-element--right":d==="right","vertical-timeline-element--no-children":t===""}),style:f},Ou.default.createElement(Ou.default.Fragment,null,Ou.default.createElement("span",{style:h,onClick:l,className:(0,$_.default)(a,"vertical-timeline-element-icon",{"bounce-in":m||g,"is-hidden":!(m||g)})},o),Ou.default.createElement("div",{style:i,onClick:c,className:(0,$_.default)(p,"vertical-timeline-element-content",{"bounce-in":m||g,"is-hidden":!(m||g)})},Ou.default.createElement("div",{style:n,className:"vertical-timeline-element-content-arrow"}),t,Ou.default.createElement("span",{className:(0,$_.default)(s,"vertical-timeline-element-date")},r)))));OQ.propTypes={children:$n.default.oneOfType([$n.default.arrayOf($n.default.node),$n.default.node]),className:$n.default.string,contentArrowStyle:$n.default.shape({}),contentStyle:$n.default.shape({}),date:$n.default.node,dateClassName:$n.default.string,icon:$n.default.element,iconClassName:$n.default.string,iconStyle:$n.default.shape({}),iconOnClick:$n.default.func,onTimelineElementClick:$n.default.func,id:$n.default.string,position:$n.default.string,style:$n.default.shape({}),textClassName:$n.default.string,visible:$n.default.bool,intersectionObserverProps:$n.default.shape({root:$n.default.object,rootMargin:$n.default.string,threshold:$n.default.number,triggerOnce:$n.default.bool})};var Tye=OQ;vE.default=Tye;var FQ={VerticalTimeline:gE.default,VerticalTimelineElement:vE.default};const Pye=({projects:t})=>We.jsxs(FQ.VerticalTimelineElement,{contentStyle:{background:t.textBgColor,color:"#fff"},contentArrowStyle:{borderRight:"7px solid #FEFEFE"},date:t.date,iconStyle:{background:t.iconBg},children:[We.jsxs("div",{children:[We.jsx("h3",{className:"text-white text-[24px] font-bold",children:t.title}),We.jsx("p",{className:"text-secondary text-[24px] font-semibold",style:{margin:0},children:t.tech})]}),We.jsx("ul",{className:"mt-5 list-disc ml-5 space-y-2",children:t.points.map((e,n)=>We.jsx("li",{className:"text-white-100 text-[14px] pl-1 tracking-wider",children:e},`projects-points-${n}`))})]}),Dye=()=>We.jsxs(We.Fragment,{children:[We.jsx(Wg.div,{variants:PQ(),children:We.jsx("h2",{className:au.sectionHeadText,children:"Projects"})}),We.jsx("div",{className:"mt-20 flex flex-col",children:We.jsx(FQ.VerticalTimeline,{children:tme.map((t,e)=>We.jsx(Pye,{projects:t},e))})})]}),Rye=PO(Dye),Dx={_origin:"https://api.emailjs.com"},Lye=(t,e="https://api.emailjs.com")=>{Dx._userID=t,Dx._origin=e},NQ=(t,e,n)=>{if(!t)throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!e)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!n)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0};class AH{constructor(e){this.status=e?e.status:0,this.text=e?e.responseText:"Network Error"}}const UQ=(t,e,n={})=>new Promise((i,r)=>{const s=new XMLHttpRequest;s.addEventListener("load",({target:o})=>{const a=new AH(o);a.status===200||a.text==="OK"?i(a):r(a)}),s.addEventListener("error",({target:o})=>{r(new AH(o))}),s.open("POST",Dx._origin+t,!0),Object.keys(n).forEach(o=>{s.setRequestHeader(o,n[o])}),s.send(e)}),Iye=(t,e,n,i)=>{const r=i||Dx._userID;return NQ(r,t,e),UQ("/api/v1.0/email/send",JSON.stringify({lib_version:"3.11.0",user_id:r,service_id:t,template_id:e,template_params:n}),{"Content-type":"application/json"})},Bye=t=>{let e;if(typeof t=="string"?e=document.querySelector(t):e=t,!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of form";return e},Oye=(t,e,n,i)=>{const r=i||Dx._userID,s=Bye(n);NQ(r,t,e);const o=new FormData(s);return o.append("lib_version","3.11.0"),o.append("service_id",t),o.append("template_id",e),o.append("user_id",r),UQ("/api/v1.0/email/send-form",o)},Fye={init:Lye,send:Iye,sendForm:Oye},Nye=()=>{const t=ge.useRef(),[e,n]=ge.useState({name:"",email:"",message:""}),[i,r]=ge.useState(!1),s=a=>{const{name:l,value:c}=a.target;n({...e,[l]:c})},o=a=>{a.preventDefault(),r(!0),Fye.send("service_osuqsmg","template_1pppkh4",{from_name:e.name,to_name:"Steven",from_email:e.email,to_email:"tubbymop@gmail.com",message:e.message},"gwlyMV424JnVX_Bky").then(()=>{r(!1),alert("Thank You. I will get back to you as soon as possible."),n({name:"",email:"",message:""})},l=>{r(!1),console.log(l),alert("Something went wrong.")})};return We.jsxs("div",{className:"xl:mt-12 xl:flex-row flex-col-reverse flex gap-10 overflow-hidden",children:[We.jsxs(Wg.div,{variants:_H("left","tween",.2,1),className:"flex-[0.75] bg-black-100 p-8 rounded-2xl",children:[We.jsx("p",{className:au.sectionS,children:"Get in Touch"}),We.jsx("h3",{className:au.sectionHeadText,children:"Contact."}),We.jsxs("form",{ref:t,onSubmit:o,className:"mt-12 flex flex-col gap-8",children:[We.jsxs("label",{className:"flex flex-col",children:[We.jsx("span",{className:"text-white font-medium mb-4",children:" Your Name "}),We.jsx("input",{type:"text",name:"name",value:e.name,onChange:s,placeholder:"Your Name",className:"bg-tertiary py-4 px-6 placeholder:text-secondary text-white rounded-1g outlined-none border-none font-medium"})]}),We.jsxs("label",{className:"flex flex-col",children:[We.jsx("span",{className:"text-white font-medium mb-4",children:" Your Email "}),We.jsx("input",{type:"email",name:"email",value:e.email,onChange:s,placeholder:"Your Email",className:"bg-tertiary py-4 px-6 placeholder:text-secondary text-white rounded-1g outlined-none border-none font-medium"})]}),We.jsxs("label",{className:"flex flex-col",children:[We.jsx("span",{className:"text-white font-medium mb-4",children:" Your Message "}),We.jsx("textarea",{name:"message",value:e.message,onChange:s,placeholder:"Your Message",className:"bg-tertiary py-4 px-6 placeholder:text-secondary text-white rounded-1g outlined-none border-none font-medium"})]}),We.jsx("button",{type:"submit",className:"bg-tertiary py-3 px-8 outline-none w-fit text-white font-bold shadow-md shadow-primary primary-xl",children:i?"Sending...":"Send"})]})]}),We.jsx(Wg.div,{variants:_H("right","tween",.2,1),className:"xl:flex-1 xl:h-auto md:h-[550px] h-[350px]",children:We.jsx(Xpe,{})})]})},kQ=PO(Nye),Uye="modulepreload",kye=function(t){return"/"+t},MH={},yE=function(e,n,i){if(!n||n.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=kye(s),s in MH)return;MH[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!i)for(let h=r.length-1;h>=0;h--){const u=r[h];if(u.href===s&&(!o||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":Uye,o||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),o)return new Promise((h,u)=>{c.addEventListener("load",h),c.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e())};var zye=Object.create,IO=Object.defineProperty,Gye=Object.getOwnPropertyDescriptor,Hye=Object.getOwnPropertyNames,Vye=Object.getPrototypeOf,jye=Object.prototype.hasOwnProperty,xE=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Wye=(t,e)=>{for(var n in e)IO(t,n,{get:e[n],enumerable:!0})},Xye=(t,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of Hye(e))!jye.call(t,r)&&r!==n&&IO(t,r,{get:()=>e[r],enumerable:!(i=Gye(e,r))||i.enumerable});return t},B1=(t,e,n)=>(n=t!=null?zye(Vye(t)):{},Xye(e||!t||!t.__esModule?IO(n,"default",{value:t,enumerable:!0}):n,t)),Yye=xE((t,e)=>{(function(n,i){typeof t=="object"?e.exports=i():typeof define=="function"&&define.amd?define(i):n.Alea=i()})(t,function(){return n.importState=function(r){var s=new n;return s.importState(r),s},n;function n(){return function(r){var s=0,o=0,a=0,l=1;r.length==0&&(r=[+new Date]);var c=i();s=c(" "),o=c(" "),a=c(" ");for(var h=0;h<r.length;h++)s-=c(r[h]),s<0&&(s+=1),o-=c(r[h]),o<0&&(o+=1),a-=c(r[h]),a<0&&(a+=1);c=null;var u=function(){var d=2091639*s+l*23283064365386963e-26;return s=o,o=a,a=d-(l=d|0)};return u.next=u,u.uint32=function(){return u()*4294967296},u.fract53=function(){return u()+(u()*2097152|0)*11102230246251565e-32},u.version="Alea 0.9",u.args=r,u.exportState=function(){return[s,o,a,l]},u.importState=function(d){s=+d[0]||0,o=+d[1]||0,a=+d[2]||0,l=+d[3]||0},u}(Array.prototype.slice.call(arguments))}function i(){var r=4022871197,s=function(o){o=o.toString();for(var a=0;a<o.length;a++){r+=o.charCodeAt(a);var l=.02519603282416938*r;r=l>>>0,l-=r,l*=r,r=l>>>0,l-=r,r+=l*4294967296}return(r>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})}),zQ=xE((t,e)=>{(function(n,i){typeof t=="object"&&typeof e<"u"?i(t):typeof define=="function"&&define.amd?define(["exports"],i):i((n=typeof globalThis<"u"?globalThis:n||self).SVDJS={})})(t,function(n){n.SVD=function(i,r,s,o,a){if(r=r===void 0||r,s=s===void 0||s,a=1e-64/(o=o||Math.pow(2,-52)),!i)throw new TypeError("Matrix a is not defined");var l,c,h,u,d,f,p,v,g,m,y,w,b=i[0].length,A=i.length;if(A<b)throw new TypeError("Invalid matrix: m < n");for(var S=[],T=[],M=[],E=r==="f"?A:b,P=m=p=0;P<A;P++)T[P]=new Array(E).fill(0);for(P=0;P<b;P++)M[P]=new Array(b).fill(0);var R,F=new Array(b).fill(0);for(P=0;P<A;P++)for(l=0;l<b;l++)T[P][l]=i[P][l];for(P=0;P<b;P++){for(S[P]=p,g=0,h=P+1,l=P;l<A;l++)g+=Math.pow(T[l][P],2);if(g<a)p=0;else for(v=(f=T[P][P])*(p=f<0?Math.sqrt(g):-Math.sqrt(g))-g,T[P][P]=f-p,l=h;l<b;l++){for(g=0,c=P;c<A;c++)g+=T[c][P]*T[c][l];for(f=g/v,c=P;c<A;c++)T[c][l]=T[c][l]+f*T[c][P]}for(F[P]=p,g=0,l=h;l<b;l++)g+=Math.pow(T[P][l],2);if(g<a)p=0;else{for(v=(f=T[P][P+1])*(p=f<0?Math.sqrt(g):-Math.sqrt(g))-g,T[P][P+1]=f-p,l=h;l<b;l++)S[l]=T[P][l]/v;for(l=h;l<A;l++){for(g=0,c=h;c<b;c++)g+=T[l][c]*T[P][c];for(c=h;c<b;c++)T[l][c]=T[l][c]+g*S[c]}}m<(y=Math.abs(F[P])+Math.abs(S[P]))&&(m=y)}if(s)for(P=b-1;0<=P;P--){if(p!==0){for(v=T[P][P+1]*p,l=h;l<b;l++)M[l][P]=T[P][l]/v;for(l=h;l<b;l++){for(g=0,c=h;c<b;c++)g+=T[P][c]*M[c][l];for(c=h;c<b;c++)M[c][l]=M[c][l]+g*M[c][P]}}for(l=h;l<b;l++)M[P][l]=0,M[l][P]=0;M[P][P]=1,p=S[P],h=P}if(r){if(r==="f")for(P=b;P<A;P++){for(l=b;l<A;l++)T[P][l]=0;T[P][P]=1}for(P=b-1;0<=P;P--){for(h=P+1,p=F[P],l=h;l<E;l++)T[P][l]=0;if(p!==0){for(v=T[P][P]*p,l=h;l<E;l++){for(g=0,c=h;c<A;c++)g+=T[c][P]*T[c][l];for(f=g/v,c=P;c<A;c++)T[c][l]=T[c][l]+f*T[c][P]}for(l=P;l<A;l++)T[l][P]=T[l][P]/p}else for(l=P;l<A;l++)T[l][P]=0;T[P][P]=T[P][P]+1}}for(o*=m,c=b-1;0<=c;c--)for(var B=0;B<50;B++){for(R=!1,h=c;0<=h;h--){if(Math.abs(S[h])<=o){R=!0;break}if(Math.abs(F[h-1])<=o)break}if(!R){for(d=0,u=h-(g=1),P=h;P<c+1&&(f=g*S[P],S[P]=d*S[P],!(Math.abs(f)<=o));P++)if(p=F[P],F[P]=Math.sqrt(f*f+p*p),d=p/(v=F[P]),g=-f/v,r)for(l=0;l<A;l++)y=T[l][u],w=T[l][P],T[l][u]=y*d+w*g,T[l][P]=-y*g+w*d}if(w=F[c],h===c){if(w<0&&(F[c]=-w,s))for(l=0;l<b;l++)M[l][c]=-M[l][c];break}for(m=F[h],f=(((y=F[c-1])-w)*(y+w)+((p=S[c-1])-(v=S[c]))*(p+v))/(2*v*y),p=Math.sqrt(f*f+1),f=((m-w)*(m+w)+v*(y/(f<0?f-p:f+p)-v))/m,P=h+(g=d=1);P<c+1;P++){if(p=S[P],y=F[P],v=g*p,p*=d,w=Math.sqrt(f*f+v*v),f=m*(d=f/(S[P-1]=w))+p*(g=v/w),p=-m*g+p*d,v=y*g,y*=d,s)for(l=0;l<b;l++)m=M[l][P-1],w=M[l][P],M[l][P-1]=m*d+w*g,M[l][P]=-m*g+w*d;if(w=Math.sqrt(f*f+v*v),f=(d=f/(F[P-1]=w))*p+(g=v/w)*y,m=-g*p+d*y,r)for(l=0;l<A;l++)y=T[l][P-1],w=T[l][P],T[l][P-1]=y*d+w*g,T[l][P]=-y*g+w*d}S[h]=0,S[c]=f,F[c]=m}for(P=0;P<b;P++)F[P]<o&&(F[P]=0);return{u:T,q:F,v:M}},n.VERSION="1.1.1",Object.defineProperty(n,"__esModule",{value:!0})})}),qye=xE(t=>{(function(){var e=function(){this.init()};e.prototype={init:function(){var u=this||n;return u._counter=1e3,u._html5AudioPool=[],u.html5PoolSize=10,u._codecs={},u._howls=[],u._muted=!1,u._volume=1,u._canPlayEvent="canplaythrough",u._navigator=typeof window<"u"&&window.navigator?window.navigator:null,u.masterGain=null,u.noAudio=!1,u.usingWebAudio=!0,u.autoSuspend=!0,u.ctx=null,u.autoUnlock=!0,u._setup(),u},volume:function(u){var d=this||n;if(u=parseFloat(u),d.ctx||h(),typeof u<"u"&&u>=0&&u<=1){if(d._volume=u,d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(u,n.ctx.currentTime);for(var f=0;f<d._howls.length;f++)if(!d._howls[f]._webAudio)for(var p=d._howls[f]._getSoundIds(),v=0;v<p.length;v++){var g=d._howls[f]._soundById(p[v]);g&&g._node&&(g._node.volume=g._volume*u)}return d}return d._volume},mute:function(u){var d=this||n;d.ctx||h(),d._muted=u,d.usingWebAudio&&d.masterGain.gain.setValueAtTime(u?0:d._volume,n.ctx.currentTime);for(var f=0;f<d._howls.length;f++)if(!d._howls[f]._webAudio)for(var p=d._howls[f]._getSoundIds(),v=0;v<p.length;v++){var g=d._howls[f]._soundById(p[v]);g&&g._node&&(g._node.muted=u?!0:g._muted)}return d},stop:function(){for(var u=this||n,d=0;d<u._howls.length;d++)u._howls[d].stop();return u},unload:function(){for(var u=this||n,d=u._howls.length-1;d>=0;d--)u._howls[d].unload();return u.usingWebAudio&&u.ctx&&typeof u.ctx.close<"u"&&(u.ctx.close(),u.ctx=null,h()),u},codecs:function(u){return(this||n)._codecs[u.replace(/^x-/,"")]},_setup:function(){var u=this||n;if(u.state=u.ctx&&u.ctx.state||"suspended",u._autoSuspend(),!u.usingWebAudio)if(typeof Audio<"u")try{var d=new Audio;typeof d.oncanplaythrough>"u"&&(u._canPlayEvent="canplay")}catch{u.noAudio=!0}else u.noAudio=!0;try{var d=new Audio;d.muted&&(u.noAudio=!0)}catch{}return u.noAudio||u._setupCodecs(),u},_setupCodecs:function(){var u=this||n,d=null;try{d=typeof Audio<"u"?new Audio:null}catch{return u}if(!d||typeof d.canPlayType!="function")return u;var f=d.canPlayType("audio/mpeg;").replace(/^no$/,""),p=u._navigator?u._navigator.userAgent:"",v=p.match(/OPR\/([0-6].)/g),g=v&&parseInt(v[0].split("/")[1],10)<33,m=p.indexOf("Safari")!==-1&&p.indexOf("Chrome")===-1,y=p.match(/Version\/(.*?) /),w=m&&y&&parseInt(y[1],10)<15;return u._codecs={mp3:!!(!g&&(f||d.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!f,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(d.canPlayType('audio/wav; codecs="1"')||d.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(d.canPlayType("audio/x-m4b;")||d.canPlayType("audio/m4b;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!w&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!w&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")},u},_unlockAudio:function(){var u=this||n;if(!(u._audioUnlocked||!u.ctx)){u._audioUnlocked=!1,u.autoUnlock=!1,!u._mobileUnloaded&&u.ctx.sampleRate!==44100&&(u._mobileUnloaded=!0,u.unload()),u._scratchBuffer=u.ctx.createBuffer(1,1,22050);var d=function(f){for(;u._html5AudioPool.length<u.html5PoolSize;)try{var p=new Audio;p._unlocked=!0,u._releaseHtml5Audio(p)}catch{u.noAudio=!0;break}for(var v=0;v<u._howls.length;v++)if(!u._howls[v]._webAudio)for(var g=u._howls[v]._getSoundIds(),m=0;m<g.length;m++){var y=u._howls[v]._soundById(g[m]);y&&y._node&&!y._node._unlocked&&(y._node._unlocked=!0,y._node.load())}u._autoResume();var w=u.ctx.createBufferSource();w.buffer=u._scratchBuffer,w.connect(u.ctx.destination),typeof w.start>"u"?w.noteOn(0):w.start(0),typeof u.ctx.resume=="function"&&u.ctx.resume(),w.onended=function(){w.disconnect(0),u._audioUnlocked=!0,document.removeEventListener("touchstart",d,!0),document.removeEventListener("touchend",d,!0),document.removeEventListener("click",d,!0),document.removeEventListener("keydown",d,!0);for(var b=0;b<u._howls.length;b++)u._howls[b]._emit("unlock")}};return document.addEventListener("touchstart",d,!0),document.addEventListener("touchend",d,!0),document.addEventListener("click",d,!0),document.addEventListener("keydown",d,!0),u}},_obtainHtml5Audio:function(){var u=this||n;if(u._html5AudioPool.length)return u._html5AudioPool.pop();var d=new Audio().play();return d&&typeof Promise<"u"&&(d instanceof Promise||typeof d.then=="function")&&d.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(u){var d=this||n;return u._unlocked&&d._html5AudioPool.push(u),d},_autoSuspend:function(){var u=this;if(!(!u.autoSuspend||!u.ctx||typeof u.ctx.suspend>"u"||!n.usingWebAudio)){for(var d=0;d<u._howls.length;d++)if(u._howls[d]._webAudio){for(var f=0;f<u._howls[d]._sounds.length;f++)if(!u._howls[d]._sounds[f]._paused)return u}return u._suspendTimer&&clearTimeout(u._suspendTimer),u._suspendTimer=setTimeout(function(){if(u.autoSuspend){u._suspendTimer=null,u.state="suspending";var p=function(){u.state="suspended",u._resumeAfterSuspend&&(delete u._resumeAfterSuspend,u._autoResume())};u.ctx.suspend().then(p,p)}},3e4),u}},_autoResume:function(){var u=this;if(!(!u.ctx||typeof u.ctx.resume>"u"||!n.usingWebAudio))return u.state==="running"&&u.ctx.state!=="interrupted"&&u._suspendTimer?(clearTimeout(u._suspendTimer),u._suspendTimer=null):u.state==="suspended"||u.state==="running"&&u.ctx.state==="interrupted"?(u.ctx.resume().then(function(){u.state="running";for(var d=0;d<u._howls.length;d++)u._howls[d]._emit("resume")}),u._suspendTimer&&(clearTimeout(u._suspendTimer),u._suspendTimer=null)):u.state==="suspending"&&(u._resumeAfterSuspend=!0),u}};var n=new e,i=function(u){var d=this;if(!u.src||u.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}d.init(u)};i.prototype={init:function(u){var d=this;return n.ctx||h(),d._autoplay=u.autoplay||!1,d._format=typeof u.format!="string"?u.format:[u.format],d._html5=u.html5||!1,d._muted=u.mute||!1,d._loop=u.loop||!1,d._pool=u.pool||5,d._preload=typeof u.preload=="boolean"||u.preload==="metadata"?u.preload:!0,d._rate=u.rate||1,d._sprite=u.sprite||{},d._src=typeof u.src!="string"?u.src:[u.src],d._volume=u.volume!==void 0?u.volume:1,d._xhr={method:u.xhr&&u.xhr.method?u.xhr.method:"GET",headers:u.xhr&&u.xhr.headers?u.xhr.headers:null,withCredentials:u.xhr&&u.xhr.withCredentials?u.xhr.withCredentials:!1},d._duration=0,d._state="unloaded",d._sounds=[],d._endTimers={},d._queue=[],d._playLock=!1,d._onend=u.onend?[{fn:u.onend}]:[],d._onfade=u.onfade?[{fn:u.onfade}]:[],d._onload=u.onload?[{fn:u.onload}]:[],d._onloaderror=u.onloaderror?[{fn:u.onloaderror}]:[],d._onplayerror=u.onplayerror?[{fn:u.onplayerror}]:[],d._onpause=u.onpause?[{fn:u.onpause}]:[],d._onplay=u.onplay?[{fn:u.onplay}]:[],d._onstop=u.onstop?[{fn:u.onstop}]:[],d._onmute=u.onmute?[{fn:u.onmute}]:[],d._onvolume=u.onvolume?[{fn:u.onvolume}]:[],d._onrate=u.onrate?[{fn:u.onrate}]:[],d._onseek=u.onseek?[{fn:u.onseek}]:[],d._onunlock=u.onunlock?[{fn:u.onunlock}]:[],d._onresume=[],d._webAudio=n.usingWebAudio&&!d._html5,typeof n.ctx<"u"&&n.ctx&&n.autoUnlock&&n._unlockAudio(),n._howls.push(d),d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}}),d._preload&&d._preload!=="none"&&d.load(),d},load:function(){var u=this,d=null;if(n.noAudio){u._emit("loaderror",null,"No audio support.");return}typeof u._src=="string"&&(u._src=[u._src]);for(var f=0;f<u._src.length;f++){var p,v;if(u._format&&u._format[f])p=u._format[f];else{if(v=u._src[f],typeof v!="string"){u._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}p=/^data:audio\/([^;,]+);/i.exec(v),p||(p=/\.([^.]+)$/.exec(v.split("?",1)[0])),p&&(p=p[1].toLowerCase())}if(p||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),p&&n.codecs(p)){d=u._src[f];break}}if(!d){u._emit("loaderror",null,"No codec support for selected audio sources.");return}return u._src=d,u._state="loading",window.location.protocol==="https:"&&d.slice(0,5)==="http:"&&(u._html5=!0,u._webAudio=!1),new r(u),u._webAudio&&o(u),u},play:function(u,d){var f=this,p=null;if(typeof u=="number")p=u,u=null;else{if(typeof u=="string"&&f._state==="loaded"&&!f._sprite[u])return null;if(typeof u>"u"&&(u="__default",!f._playLock)){for(var v=0,g=0;g<f._sounds.length;g++)f._sounds[g]._paused&&!f._sounds[g]._ended&&(v++,p=f._sounds[g]._id);v===1?u=null:p=null}}var m=p?f._soundById(p):f._inactiveSound();if(!m)return null;if(p&&!u&&(u=m._sprite||"__default"),f._state!=="loaded"){m._sprite=u,m._ended=!1;var y=m._id;return f._queue.push({event:"play",action:function(){f.play(y)}}),y}if(p&&!m._paused)return d||f._loadQueue("play"),m._id;f._webAudio&&n._autoResume();var w=Math.max(0,m._seek>0?m._seek:f._sprite[u][0]/1e3),b=Math.max(0,(f._sprite[u][0]+f._sprite[u][1])/1e3-w),A=b*1e3/Math.abs(m._rate),S=f._sprite[u][0]/1e3,T=(f._sprite[u][0]+f._sprite[u][1])/1e3;m._sprite=u,m._ended=!1;var M=function(){m._paused=!1,m._seek=w,m._start=S,m._stop=T,m._loop=!!(m._loop||f._sprite[u][2])};if(w>=T){f._ended(m);return}var E=m._node;if(f._webAudio){var P=function(){f._playLock=!1,M(),f._refreshBuffer(m);var k=m._muted||f._muted?0:m._volume;E.gain.setValueAtTime(k,n.ctx.currentTime),m._playStart=n.ctx.currentTime,typeof E.bufferSource.start>"u"?m._loop?E.bufferSource.noteGrainOn(0,w,86400):E.bufferSource.noteGrainOn(0,w,b):m._loop?E.bufferSource.start(0,w,86400):E.bufferSource.start(0,w,b),A!==1/0&&(f._endTimers[m._id]=setTimeout(f._ended.bind(f,m),A)),d||setTimeout(function(){f._emit("play",m._id),f._loadQueue()},0)};n.state==="running"&&n.ctx.state!=="interrupted"?P():(f._playLock=!0,f.once("resume",P),f._clearTimer(m._id))}else{var R=function(){E.currentTime=w,E.muted=m._muted||f._muted||n._muted||E.muted,E.volume=m._volume*n.volume(),E.playbackRate=m._rate;try{var k=E.play();if(k&&typeof Promise<"u"&&(k instanceof Promise||typeof k.then=="function")?(f._playLock=!0,M(),k.then(function(){f._playLock=!1,E._unlocked=!0,d?f._loadQueue():f._emit("play",m._id)}).catch(function(){f._playLock=!1,f._emit("playerror",m._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),m._ended=!0,m._paused=!0})):d||(f._playLock=!1,M(),f._emit("play",m._id)),E.playbackRate=m._rate,E.paused){f._emit("playerror",m._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}u!=="__default"||m._loop?f._endTimers[m._id]=setTimeout(f._ended.bind(f,m),A):(f._endTimers[m._id]=function(){f._ended(m),E.removeEventListener("ended",f._endTimers[m._id],!1)},E.addEventListener("ended",f._endTimers[m._id],!1))}catch(j){f._emit("playerror",m._id,j)}};E.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(E.src=f._src,E.load());var F=window&&window.ejecta||!E.readyState&&n._navigator.isCocoonJS;if(E.readyState>=3||F)R();else{f._playLock=!0,f._state="loading";var B=function(){f._state="loaded",R(),E.removeEventListener(n._canPlayEvent,B,!1)};E.addEventListener(n._canPlayEvent,B,!1),f._clearTimer(m._id)}}return m._id},pause:function(u){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"pause",action:function(){d.pause(u)}}),d;for(var f=d._getSoundIds(u),p=0;p<f.length;p++){d._clearTimer(f[p]);var v=d._soundById(f[p]);if(v&&!v._paused&&(v._seek=d.seek(f[p]),v._rateSeek=0,v._paused=!0,d._stopFade(f[p]),v._node))if(d._webAudio){if(!v._node.bufferSource)continue;typeof v._node.bufferSource.stop>"u"?v._node.bufferSource.noteOff(0):v._node.bufferSource.stop(0),d._cleanBuffer(v._node)}else(!isNaN(v._node.duration)||v._node.duration===1/0)&&v._node.pause();arguments[1]||d._emit("pause",v?v._id:null)}return d},stop:function(u,d){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"stop",action:function(){f.stop(u)}}),f;for(var p=f._getSoundIds(u),v=0;v<p.length;v++){f._clearTimer(p[v]);var g=f._soundById(p[v]);g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,f._stopFade(p[v]),g._node&&(f._webAudio?g._node.bufferSource&&(typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),f._cleanBuffer(g._node)):(!isNaN(g._node.duration)||g._node.duration===1/0)&&(g._node.currentTime=g._start||0,g._node.pause(),g._node.duration===1/0&&f._clearSound(g._node))),d||f._emit("stop",g._id))}return f},mute:function(u,d){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"mute",action:function(){f.mute(u,d)}}),f;if(typeof d>"u")if(typeof u=="boolean")f._muted=u;else return f._muted;for(var p=f._getSoundIds(d),v=0;v<p.length;v++){var g=f._soundById(p[v]);g&&(g._muted=u,g._interval&&f._stopFade(g._id),f._webAudio&&g._node?g._node.gain.setValueAtTime(u?0:g._volume,n.ctx.currentTime):g._node&&(g._node.muted=n._muted?!0:u),f._emit("mute",g._id))}return f},volume:function(){var u=this,d=arguments,f,p;if(d.length===0)return u._volume;if(d.length===1||d.length===2&&typeof d[1]>"u"){var v=u._getSoundIds(),g=v.indexOf(d[0]);g>=0?p=parseInt(d[0],10):f=parseFloat(d[0])}else d.length>=2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));var m;if(typeof f<"u"&&f>=0&&f<=1){if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"volume",action:function(){u.volume.apply(u,d)}}),u;typeof p>"u"&&(u._volume=f),p=u._getSoundIds(p);for(var y=0;y<p.length;y++)m=u._soundById(p[y]),m&&(m._volume=f,d[2]||u._stopFade(p[y]),u._webAudio&&m._node&&!m._muted?m._node.gain.setValueAtTime(f,n.ctx.currentTime):m._node&&!m._muted&&(m._node.volume=f*n.volume()),u._emit("volume",m._id))}else return m=p?u._soundById(p):u._sounds[0],m?m._volume:0;return u},fade:function(u,d,f,p){var v=this;if(v._state!=="loaded"||v._playLock)return v._queue.push({event:"fade",action:function(){v.fade(u,d,f,p)}}),v;u=Math.min(Math.max(0,parseFloat(u)),1),d=Math.min(Math.max(0,parseFloat(d)),1),f=parseFloat(f),v.volume(u,p);for(var g=v._getSoundIds(p),m=0;m<g.length;m++){var y=v._soundById(g[m]);if(y){if(p||v._stopFade(g[m]),v._webAudio&&!y._muted){var w=n.ctx.currentTime,b=w+f/1e3;y._volume=u,y._node.gain.setValueAtTime(u,w),y._node.gain.linearRampToValueAtTime(d,b)}v._startFadeInterval(y,u,d,f,g[m],typeof p>"u")}}return v},_startFadeInterval:function(u,d,f,p,v,g){var m=this,y=d,w=f-d,b=Math.abs(w/.01),A=Math.max(4,b>0?p/b:p),S=Date.now();u._fadeTo=f,u._interval=setInterval(function(){var T=(Date.now()-S)/p;S=Date.now(),y+=w*T,y=Math.round(y*100)/100,w<0?y=Math.max(f,y):y=Math.min(f,y),m._webAudio?u._volume=y:m.volume(y,u._id,!0),g&&(m._volume=y),(f<d&&y<=f||f>d&&y>=f)&&(clearInterval(u._interval),u._interval=null,u._fadeTo=null,m.volume(f,u._id),m._emit("fade",u._id))},A)},_stopFade:function(u){var d=this,f=d._soundById(u);return f&&f._interval&&(d._webAudio&&f._node.gain.cancelScheduledValues(n.ctx.currentTime),clearInterval(f._interval),f._interval=null,d.volume(f._fadeTo,u),f._fadeTo=null,d._emit("fade",u)),d},loop:function(){var u=this,d=arguments,f,p,v;if(d.length===0)return u._loop;if(d.length===1)if(typeof d[0]=="boolean")f=d[0],u._loop=f;else return v=u._soundById(parseInt(d[0],10)),v?v._loop:!1;else d.length===2&&(f=d[0],p=parseInt(d[1],10));for(var g=u._getSoundIds(p),m=0;m<g.length;m++)v=u._soundById(g[m]),v&&(v._loop=f,u._webAudio&&v._node&&v._node.bufferSource&&(v._node.bufferSource.loop=f,f&&(v._node.bufferSource.loopStart=v._start||0,v._node.bufferSource.loopEnd=v._stop,u.playing(g[m])&&(u.pause(g[m],!0),u.play(g[m],!0)))));return u},rate:function(){var u=this,d=arguments,f,p;if(d.length===0)p=u._sounds[0]._id;else if(d.length===1){var v=u._getSoundIds(),g=v.indexOf(d[0]);g>=0?p=parseInt(d[0],10):f=parseFloat(d[0])}else d.length===2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));var m;if(typeof f=="number"){if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"rate",action:function(){u.rate.apply(u,d)}}),u;typeof p>"u"&&(u._rate=f),p=u._getSoundIds(p);for(var y=0;y<p.length;y++)if(m=u._soundById(p[y]),m){u.playing(p[y])&&(m._rateSeek=u.seek(p[y]),m._playStart=u._webAudio?n.ctx.currentTime:m._playStart),m._rate=f,u._webAudio&&m._node&&m._node.bufferSource?m._node.bufferSource.playbackRate.setValueAtTime(f,n.ctx.currentTime):m._node&&(m._node.playbackRate=f);var w=u.seek(p[y]),b=(u._sprite[m._sprite][0]+u._sprite[m._sprite][1])/1e3-w,A=b*1e3/Math.abs(m._rate);(u._endTimers[p[y]]||!m._paused)&&(u._clearTimer(p[y]),u._endTimers[p[y]]=setTimeout(u._ended.bind(u,m),A)),u._emit("rate",m._id)}}else return m=u._soundById(p),m?m._rate:u._rate;return u},seek:function(){var u=this,d=arguments,f,p;if(d.length===0)u._sounds.length&&(p=u._sounds[0]._id);else if(d.length===1){var v=u._getSoundIds(),g=v.indexOf(d[0]);g>=0?p=parseInt(d[0],10):u._sounds.length&&(p=u._sounds[0]._id,f=parseFloat(d[0]))}else d.length===2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));if(typeof p>"u")return 0;if(typeof f=="number"&&(u._state!=="loaded"||u._playLock))return u._queue.push({event:"seek",action:function(){u.seek.apply(u,d)}}),u;var m=u._soundById(p);if(m)if(typeof f=="number"&&f>=0){var y=u.playing(p);y&&u.pause(p,!0),m._seek=f,m._ended=!1,u._clearTimer(p),!u._webAudio&&m._node&&!isNaN(m._node.duration)&&(m._node.currentTime=f);var w=function(){y&&u.play(p,!0),u._emit("seek",p)};if(y&&!u._webAudio){var b=function(){u._playLock?setTimeout(b,0):w()};setTimeout(b,0)}else w()}else if(u._webAudio){var A=u.playing(p)?n.ctx.currentTime-m._playStart:0,S=m._rateSeek?m._rateSeek-m._seek:0;return m._seek+(S+A*Math.abs(m._rate))}else return m._node.currentTime;return u},playing:function(u){var d=this;if(typeof u=="number"){var f=d._soundById(u);return f?!f._paused:!1}for(var p=0;p<d._sounds.length;p++)if(!d._sounds[p]._paused)return!0;return!1},duration:function(u){var d=this,f=d._duration,p=d._soundById(u);return p&&(f=d._sprite[p._sprite][1]/1e3),f},state:function(){return this._state},unload:function(){for(var u=this,d=u._sounds,f=0;f<d.length;f++)d[f]._paused||u.stop(d[f]._id),u._webAudio||(u._clearSound(d[f]._node),d[f]._node.removeEventListener("error",d[f]._errorFn,!1),d[f]._node.removeEventListener(n._canPlayEvent,d[f]._loadFn,!1),d[f]._node.removeEventListener("ended",d[f]._endFn,!1),n._releaseHtml5Audio(d[f]._node)),delete d[f]._node,u._clearTimer(d[f]._id);var p=n._howls.indexOf(u);p>=0&&n._howls.splice(p,1);var v=!0;for(f=0;f<n._howls.length;f++)if(n._howls[f]._src===u._src||u._src.indexOf(n._howls[f]._src)>=0){v=!1;break}return s&&v&&delete s[u._src],n.noAudio=!1,u._state="unloaded",u._sounds=[],u=null,null},on:function(u,d,f,p){var v=this,g=v["_on"+u];return typeof d=="function"&&g.push(p?{id:f,fn:d,once:p}:{id:f,fn:d}),v},off:function(u,d,f){var p=this,v=p["_on"+u],g=0;if(typeof d=="number"&&(f=d,d=null),d||f)for(g=0;g<v.length;g++){var m=f===v[g].id;if(d===v[g].fn&&m||!d&&m){v.splice(g,1);break}}else if(u)p["_on"+u]=[];else{var y=Object.keys(p);for(g=0;g<y.length;g++)y[g].indexOf("_on")===0&&Array.isArray(p[y[g]])&&(p[y[g]]=[])}return p},once:function(u,d,f){var p=this;return p.on(u,d,f,1),p},_emit:function(u,d,f){for(var p=this,v=p["_on"+u],g=v.length-1;g>=0;g--)(!v[g].id||v[g].id===d||u==="load")&&(setTimeout(function(m){m.call(this,d,f)}.bind(p,v[g].fn),0),v[g].once&&p.off(u,v[g].fn,v[g].id));return p._loadQueue(u),p},_loadQueue:function(u){var d=this;if(d._queue.length>0){var f=d._queue[0];f.event===u&&(d._queue.shift(),d._loadQueue()),u||f.action()}return d},_ended:function(u){var d=this,f=u._sprite;if(!d._webAudio&&u._node&&!u._node.paused&&!u._node.ended&&u._node.currentTime<u._stop)return setTimeout(d._ended.bind(d,u),100),d;var p=!!(u._loop||d._sprite[f][2]);if(d._emit("end",u._id),!d._webAudio&&p&&d.stop(u._id,!0).play(u._id),d._webAudio&&p){d._emit("play",u._id),u._seek=u._start||0,u._rateSeek=0,u._playStart=n.ctx.currentTime;var v=(u._stop-u._start)*1e3/Math.abs(u._rate);d._endTimers[u._id]=setTimeout(d._ended.bind(d,u),v)}return d._webAudio&&!p&&(u._paused=!0,u._ended=!0,u._seek=u._start||0,u._rateSeek=0,d._clearTimer(u._id),d._cleanBuffer(u._node),n._autoSuspend()),!d._webAudio&&!p&&d.stop(u._id,!0),d},_clearTimer:function(u){var d=this;if(d._endTimers[u]){if(typeof d._endTimers[u]!="function")clearTimeout(d._endTimers[u]);else{var f=d._soundById(u);f&&f._node&&f._node.removeEventListener("ended",d._endTimers[u],!1)}delete d._endTimers[u]}return d},_soundById:function(u){for(var d=this,f=0;f<d._sounds.length;f++)if(u===d._sounds[f]._id)return d._sounds[f];return null},_inactiveSound:function(){var u=this;u._drain();for(var d=0;d<u._sounds.length;d++)if(u._sounds[d]._ended)return u._sounds[d].reset();return new r(u)},_drain:function(){var u=this,d=u._pool,f=0,p=0;if(!(u._sounds.length<d)){for(p=0;p<u._sounds.length;p++)u._sounds[p]._ended&&f++;for(p=u._sounds.length-1;p>=0;p--){if(f<=d)return;u._sounds[p]._ended&&(u._webAudio&&u._sounds[p]._node&&u._sounds[p]._node.disconnect(0),u._sounds.splice(p,1),f--)}}},_getSoundIds:function(u){var d=this;if(typeof u>"u"){for(var f=[],p=0;p<d._sounds.length;p++)f.push(d._sounds[p]._id);return f}else return[u]},_refreshBuffer:function(u){var d=this;return u._node.bufferSource=n.ctx.createBufferSource(),u._node.bufferSource.buffer=s[d._src],u._panner?u._node.bufferSource.connect(u._panner):u._node.bufferSource.connect(u._node),u._node.bufferSource.loop=u._loop,u._loop&&(u._node.bufferSource.loopStart=u._start||0,u._node.bufferSource.loopEnd=u._stop||0),u._node.bufferSource.playbackRate.setValueAtTime(u._rate,n.ctx.currentTime),d},_cleanBuffer:function(u){var d=this,f=n._navigator&&n._navigator.vendor.indexOf("Apple")>=0;if(n._scratchBuffer&&u.bufferSource&&(u.bufferSource.onended=null,u.bufferSource.disconnect(0),f))try{u.bufferSource.buffer=n._scratchBuffer}catch{}return u.bufferSource=null,d},_clearSound:function(u){var d=/MSIE |Trident\//.test(n._navigator&&n._navigator.userAgent);d||(u.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(u){this._parent=u,this.init()};r.prototype={init:function(){var u=this,d=u._parent;return u._muted=d._muted,u._loop=d._loop,u._volume=d._volume,u._rate=d._rate,u._seek=0,u._paused=!0,u._ended=!0,u._sprite="__default",u._id=++n._counter,d._sounds.push(u),u.create(),u},create:function(){var u=this,d=u._parent,f=n._muted||u._muted||u._parent._muted?0:u._volume;return d._webAudio?(u._node=typeof n.ctx.createGain>"u"?n.ctx.createGainNode():n.ctx.createGain(),u._node.gain.setValueAtTime(f,n.ctx.currentTime),u._node.paused=!0,u._node.connect(n.masterGain)):n.noAudio||(u._node=n._obtainHtml5Audio(),u._errorFn=u._errorListener.bind(u),u._node.addEventListener("error",u._errorFn,!1),u._loadFn=u._loadListener.bind(u),u._node.addEventListener(n._canPlayEvent,u._loadFn,!1),u._endFn=u._endListener.bind(u),u._node.addEventListener("ended",u._endFn,!1),u._node.src=d._src,u._node.preload=d._preload===!0?"auto":d._preload,u._node.volume=f*n.volume(),u._node.load()),u},reset:function(){var u=this,d=u._parent;return u._muted=d._muted,u._loop=d._loop,u._volume=d._volume,u._rate=d._rate,u._seek=0,u._rateSeek=0,u._paused=!0,u._ended=!0,u._sprite="__default",u._id=++n._counter,u},_errorListener:function(){var u=this;u._parent._emit("loaderror",u._id,u._node.error?u._node.error.code:0),u._node.removeEventListener("error",u._errorFn,!1)},_loadListener:function(){var u=this,d=u._parent;d._duration=Math.ceil(u._node.duration*10)/10,Object.keys(d._sprite).length===0&&(d._sprite={__default:[0,d._duration*1e3]}),d._state!=="loaded"&&(d._state="loaded",d._emit("load"),d._loadQueue()),u._node.removeEventListener(n._canPlayEvent,u._loadFn,!1)},_endListener:function(){var u=this,d=u._parent;d._duration===1/0&&(d._duration=Math.ceil(u._node.duration*10)/10,d._sprite.__default[1]===1/0&&(d._sprite.__default[1]=d._duration*1e3),d._ended(u)),u._node.removeEventListener("ended",u._endFn,!1)}};var s={},o=function(u){var d=u._src;if(s[d]){u._duration=s[d].duration,c(u);return}if(/^data:[^;]+;base64,/.test(d)){for(var f=atob(d.split(",")[1]),p=new Uint8Array(f.length),v=0;v<f.length;++v)p[v]=f.charCodeAt(v);l(p.buffer,u)}else{var g=new XMLHttpRequest;g.open(u._xhr.method,d,!0),g.withCredentials=u._xhr.withCredentials,g.responseType="arraybuffer",u._xhr.headers&&Object.keys(u._xhr.headers).forEach(function(m){g.setRequestHeader(m,u._xhr.headers[m])}),g.onload=function(){var m=(g.status+"")[0];if(m!=="0"&&m!=="2"&&m!=="3"){u._emit("loaderror",null,"Failed loading audio file with status: "+g.status+".");return}l(g.response,u)},g.onerror=function(){u._webAudio&&(u._html5=!0,u._webAudio=!1,u._sounds=[],delete s[d],u.load())},a(g)}},a=function(u){try{u.send()}catch{u.onerror()}},l=function(u,d){var f=function(){d._emit("loaderror",null,"Decoding audio data failed.")},p=function(v){v&&d._sounds.length>0?(s[d._src]=v,c(d,v)):f()};typeof Promise<"u"&&n.ctx.decodeAudioData.length===1?n.ctx.decodeAudioData(u).then(p).catch(f):n.ctx.decodeAudioData(u,p,f)},c=function(u,d){d&&!u._duration&&(u._duration=d.duration),Object.keys(u._sprite).length===0&&(u._sprite={__default:[0,u._duration*1e3]}),u._state!=="loaded"&&(u._state="loaded",u._emit("load"),u._loadQueue())},h=function(){if(n.usingWebAudio){try{typeof AudioContext<"u"?n.ctx=new AudioContext:typeof webkitAudioContext<"u"?n.ctx=new webkitAudioContext:n.usingWebAudio=!1}catch{n.usingWebAudio=!1}n.ctx||(n.usingWebAudio=!1);var u=/iP(hone|od|ad)/.test(n._navigator&&n._navigator.platform),d=n._navigator&&n._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),f=d?parseInt(d[1],10):null;if(u&&f&&f<9){var p=/safari/.test(n._navigator&&n._navigator.userAgent.toLowerCase());n._navigator&&!p&&(n.usingWebAudio=!1)}n.usingWebAudio&&(n.masterGain=typeof n.ctx.createGain>"u"?n.ctx.createGainNode():n.ctx.createGain(),n.masterGain.gain.setValueAtTime(n._muted?0:n._volume,n.ctx.currentTime),n.masterGain.connect(n.ctx.destination)),n._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:n,Howl:i}}),typeof t<"u"&&(t.Howler=n,t.Howl=i),typeof global<"u"?(global.HowlerGlobal=e,global.Howler=n,global.Howl=i,global.Sound=r):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=n,window.Howl=i,window.Sound=r)})(),function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(n){var i=this;if(!i.ctx||!i.ctx.listener)return i;for(var r=i._howls.length-1;r>=0;r--)i._howls[r].stereo(n);return i},HowlerGlobal.prototype.pos=function(n,i,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(i=typeof i!="number"?s._pos[1]:i,r=typeof r!="number"?s._pos[2]:r,typeof n=="number")s._pos=[n,i,r],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(n,i,r,s,o,a){var l=this;if(!l.ctx||!l.ctx.listener)return l;var c=l._orientation;if(i=typeof i!="number"?c[1]:i,r=typeof r!="number"?c[2]:r,s=typeof s!="number"?c[3]:s,o=typeof o!="number"?c[4]:o,a=typeof a!="number"?c[5]:a,typeof n=="number")l._orientation=[n,i,r,s,o,a],typeof l.ctx.listener.forwardX<"u"?(l.ctx.listener.forwardX.setTargetAtTime(n,Howler.ctx.currentTime,.1),l.ctx.listener.forwardY.setTargetAtTime(i,Howler.ctx.currentTime,.1),l.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),l.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),l.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),l.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):l.ctx.listener.setOrientation(n,i,r,s,o,a);else return c;return l},Howl.prototype.init=function(n){return function(i){var r=this;return r._orientation=i.orientation||[1,0,0],r._stereo=i.stereo||null,r._pos=i.pos||null,r._pannerAttr={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:360,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:360,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:0,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:"inverse",maxDistance:typeof i.maxDistance<"u"?i.maxDistance:1e4,panningModel:typeof i.panningModel<"u"?i.panningModel:"HRTF",refDistance:typeof i.refDistance<"u"?i.refDistance:1,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:1},r._onstereo=i.onstereo?[{fn:i.onstereo}]:[],r._onpos=i.onpos?[{fn:i.onpos}]:[],r._onorientation=i.onorientation?[{fn:i.onorientation}]:[],n.call(this,i)}}(Howl.prototype.init),Howl.prototype.stereo=function(n,i){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"stereo",action:function(){r.stereo(n,i)}}),r;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof i>"u")if(typeof n=="number")r._stereo=n,r._pos=[n,0,0];else return r._stereo;for(var o=r._getSoundIds(i),a=0;a<o.length;a++){var l=r._soundById(o[a]);if(l)if(typeof n=="number")l._stereo=n,l._pos=[n,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&e(l,s),s==="spatial"?typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(n,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(n,0,0):l._panner.pan.setValueAtTime(n,Howler.ctx.currentTime)),r._emit("stereo",l._id);else return l._stereo}return r},Howl.prototype.pos=function(n,i,r,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"pos",action:function(){o.pos(n,i,r,s)}}),o;if(i=typeof i!="number"?0:i,r=typeof r!="number"?-.5:r,typeof s>"u")if(typeof n=="number")o._pos=[n,i,r];else return o._pos;for(var a=o._getSoundIds(s),l=0;l<a.length;l++){var c=o._soundById(a[l]);if(c)if(typeof n=="number")c._pos=[n,i,r],c._node&&((!c._panner||c._panner.pan)&&e(c,"spatial"),typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(n,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):c._panner.setPosition(n,i,r)),o._emit("pos",c._id);else return c._pos}return o},Howl.prototype.orientation=function(n,i,r,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"orientation",action:function(){o.orientation(n,i,r,s)}}),o;if(i=typeof i!="number"?o._orientation[1]:i,r=typeof r!="number"?o._orientation[2]:r,typeof s>"u")if(typeof n=="number")o._orientation=[n,i,r];else return o._orientation;for(var a=o._getSoundIds(s),l=0;l<a.length;l++){var c=o._soundById(a[l]);if(c)if(typeof n=="number")c._orientation=[n,i,r],c._node&&(c._panner||(c._pos||(c._pos=o._pos||[0,0,-.5]),e(c,"spatial")),typeof c._panner.orientationX<"u"?(c._panner.orientationX.setValueAtTime(n,Howler.ctx.currentTime),c._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),c._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):c._panner.setOrientation(n,i,r)),o._emit("orientation",c._id);else return c._orientation}return o},Howl.prototype.pannerAttr=function(){var n=this,i=arguments,r,s,o;if(!n._webAudio)return n;if(i.length===0)return n._pannerAttr;if(i.length===1)if(typeof i[0]=="object")r=i[0],typeof s>"u"&&(r.pannerAttr||(r.pannerAttr={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel}),n._pannerAttr={coneInnerAngle:typeof r.pannerAttr.coneInnerAngle<"u"?r.pannerAttr.coneInnerAngle:n._coneInnerAngle,coneOuterAngle:typeof r.pannerAttr.coneOuterAngle<"u"?r.pannerAttr.coneOuterAngle:n._coneOuterAngle,coneOuterGain:typeof r.pannerAttr.coneOuterGain<"u"?r.pannerAttr.coneOuterGain:n._coneOuterGain,distanceModel:typeof r.pannerAttr.distanceModel<"u"?r.pannerAttr.distanceModel:n._distanceModel,maxDistance:typeof r.pannerAttr.maxDistance<"u"?r.pannerAttr.maxDistance:n._maxDistance,refDistance:typeof r.pannerAttr.refDistance<"u"?r.pannerAttr.refDistance:n._refDistance,rolloffFactor:typeof r.pannerAttr.rolloffFactor<"u"?r.pannerAttr.rolloffFactor:n._rolloffFactor,panningModel:typeof r.pannerAttr.panningModel<"u"?r.pannerAttr.panningModel:n._panningModel});else return o=n._soundById(parseInt(i[0],10)),o?o._pannerAttr:n._pannerAttr;else i.length===2&&(r=i[0],s=parseInt(i[1],10));for(var a=n._getSoundIds(s),l=0;l<a.length;l++)if(o=n._soundById(a[l]),o){var c=o._pannerAttr;c={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:c.coneInnerAngle,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:c.coneOuterAngle,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:c.coneOuterGain,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:c.distanceModel,maxDistance:typeof r.maxDistance<"u"?r.maxDistance:c.maxDistance,refDistance:typeof r.refDistance<"u"?r.refDistance:c.refDistance,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:c.rolloffFactor,panningModel:typeof r.panningModel<"u"?r.panningModel:c.panningModel};var h=o._panner;h?(h.coneInnerAngle=c.coneInnerAngle,h.coneOuterAngle=c.coneOuterAngle,h.coneOuterGain=c.coneOuterGain,h.distanceModel=c.distanceModel,h.maxDistance=c.maxDistance,h.refDistance=c.refDistance,h.rolloffFactor=c.rolloffFactor,h.panningModel=c.panningModel):(o._pos||(o._pos=n._pos||[0,0,-.5]),e(o,"spatial"))}return n},Sound.prototype.init=function(n){return function(){var i=this,r=i._parent;i._orientation=r._orientation,i._stereo=r._stereo,i._pos=r._pos,i._pannerAttr=r._pannerAttr,n.call(this),i._stereo?r.stereo(i._stereo):i._pos&&r.pos(i._pos[0],i._pos[1],i._pos[2],i._id)}}(Sound.prototype.init),Sound.prototype.reset=function(n){return function(){var i=this,r=i._parent;return i._orientation=r._orientation,i._stereo=r._stereo,i._pos=r._pos,i._pannerAttr=r._pannerAttr,i._stereo?r.stereo(i._stereo):i._pos?r.pos(i._pos[0],i._pos[1],i._pos[2],i._id):i._panner&&(i._panner.disconnect(0),i._panner=void 0,r._refreshBuffer(i)),n.call(this)}}(Sound.prototype.reset);var e=function(n,i){i=i||"spatial",i==="spatial"?(n._panner=Howler.ctx.createPanner(),n._panner.coneInnerAngle=n._pannerAttr.coneInnerAngle,n._panner.coneOuterAngle=n._pannerAttr.coneOuterAngle,n._panner.coneOuterGain=n._pannerAttr.coneOuterGain,n._panner.distanceModel=n._pannerAttr.distanceModel,n._panner.maxDistance=n._pannerAttr.maxDistance,n._panner.refDistance=n._pannerAttr.refDistance,n._panner.rolloffFactor=n._pannerAttr.rolloffFactor,n._panner.panningModel=n._pannerAttr.panningModel,typeof n._panner.positionX<"u"?(n._panner.positionX.setValueAtTime(n._pos[0],Howler.ctx.currentTime),n._panner.positionY.setValueAtTime(n._pos[1],Howler.ctx.currentTime),n._panner.positionZ.setValueAtTime(n._pos[2],Howler.ctx.currentTime)):n._panner.setPosition(n._pos[0],n._pos[1],n._pos[2]),typeof n._panner.orientationX<"u"?(n._panner.orientationX.setValueAtTime(n._orientation[0],Howler.ctx.currentTime),n._panner.orientationY.setValueAtTime(n._orientation[1],Howler.ctx.currentTime),n._panner.orientationZ.setValueAtTime(n._orientation[2],Howler.ctx.currentTime)):n._panner.setOrientation(n._orientation[0],n._orientation[1],n._orientation[2])):(n._panner=Howler.ctx.createStereoPanner(),n._panner.pan.setValueAtTime(n._stereo,Howler.ctx.currentTime)),n._panner.connect(n._node),n._paused||n._parent.pause(n._id,!0).play(n._id,!0)}}()}),Qye=xE((t,e)=>{e.exports=function(n,i){for(var r=n.split("."),s=i.split("."),o=0;o<3;o++){var a=Number(r[o]),l=Number(s[o]);if(a>l)return 1;if(l>a)return-1;if(!isNaN(a)&&isNaN(l))return 1;if(isNaN(a)&&!isNaN(l))return-1}return 0}}),vv="149",ko={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Kye=0,EH=1,Jye=2,BO=1,GQ=2,oy=3,el=0,xr=1,co=2,Ir=0,fg=1,CH=2,TH=3,PH=4,Zye=5,xm=100,$ye=101,exe=102,DH=103,RH=104,txe=200,nxe=201,ixe=202,rxe=203,HQ=204,VQ=205,sxe=206,oxe=207,axe=208,lxe=209,cxe=210,uxe=0,hxe=1,dxe=2,NL=3,fxe=4,pxe=5,mxe=6,gxe=7,jQ=0,vxe=1,yxe=2,Zc=0,xxe=1,wxe=2,_xe=3,bxe=4,Sxe=5,WQ=300,Ff=301,Nf=302,UL=303,kL=304,O1=306,Rx=1e3,ro=1001,zL=1002,oi=1003,LH=1004,NP=1005,En=1006,Axe=1007,Xg=1008,Zr=1009,Mxe=1010,Exe=1011,XQ=1012,Cxe=1013,fh=1014,ph=1015,Lx=1016,Txe=1017,Pxe=1018,yf=1020,Dxe=1021,ka=1023,Rxe=1024,Lxe=1025,xf=1026,Uf=1027,Ixe=1028,Bxe=1029,Oxe=1030,Fxe=1031,Nxe=1033,UP=33776,kP=33777,zP=33778,GP=33779,IH=35840,BH=35841,OH=35842,FH=35843,Uxe=36196,NH=37492,UH=37496,kH=37808,zH=37809,GH=37810,HH=37811,VH=37812,jH=37813,WH=37814,XH=37815,YH=37816,qH=37817,QH=37818,KH=37819,JH=37820,ZH=37821,HP=36492,kxe=36283,$H=36284,eV=36285,tV=36286,tc=3e3,Wt=3001,gu=3200,YQ=3201,zxe=0,Gxe=1,Ll="srgb",LA="srgb-linear",VP=7680,Hxe=519,GL=35044,nV="300 es",HL=1035,_s=class{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});let n=this._listeners;n[t]===void 0&&(n[t]=[]),n[t].indexOf(e)===-1&&n[t].push(e)}hasEventListener(t,e){if(this._listeners===void 0)return!1;let n=this._listeners;return n[t]!==void 0&&n[t].indexOf(e)!==-1}removeEventListener(t,e){if(this._listeners===void 0)return;let n=this._listeners[t];if(n!==void 0){let i=n.indexOf(e);i!==-1&&n.splice(i,1)}}dispatchEvent(t){if(this._listeners===void 0)return;let e=this._listeners[t.type];if(e!==void 0){t.target=this;let n=e.slice(0);for(let i=0,r=n.length;i<r;i++)n[i].call(this,t);t.target=null}}},Wr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],iV=1234567,Iy=Math.PI/180,Ix=180/Math.PI;function ql(){let t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Wr[t&255]+Wr[t>>8&255]+Wr[t>>16&255]+Wr[t>>24&255]+"-"+Wr[e&255]+Wr[e>>8&255]+"-"+Wr[e>>16&15|64]+Wr[e>>24&255]+"-"+Wr[n&63|128]+Wr[n>>8&255]+"-"+Wr[n>>16&255]+Wr[n>>24&255]+Wr[i&255]+Wr[i>>8&255]+Wr[i>>16&255]+Wr[i>>24&255]).toLowerCase()}function Ji(t,e,n){return Math.max(e,Math.min(n,t))}function OO(t,e){return(t%e+e)%e}function Vxe(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)}function jxe(t,e,n){return t!==e?(n-t)/(e-t):0}function By(t,e,n){return(1-n)*t+n*e}function Wxe(t,e,n,i){return By(t,e,1-Math.exp(-n*i))}function Xxe(t,e=1){return e-Math.abs(OO(t,e*2)-e)}function Yxe(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function qxe(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function Qxe(t,e){return t+Math.floor(Math.random()*(e-t+1))}function Kxe(t,e){return t+Math.random()*(e-t)}function Jxe(t){return t*(.5-Math.random())}function Zxe(t){t!==void 0&&(iV=t);let e=iV+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function $xe(t){return t*Iy}function e1e(t){return t*Ix}function VL(t){return(t&t-1)===0&&t!==0}function t1e(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function IA(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function n1e(t,e,n,i,r){let s=Math.cos,o=Math.sin,a=s(n/2),l=o(n/2),c=s((e+i)/2),h=o((e+i)/2),u=s((e-i)/2),d=o((e-i)/2),f=s((i-e)/2),p=o((i-e)/2);switch(r){case"XYX":t.set(a*h,l*u,l*d,a*c);break;case"YZY":t.set(l*d,a*h,l*u,a*c);break;case"ZXZ":t.set(l*u,l*d,a*h,a*c);break;case"XZX":t.set(a*h,l*p,l*f,a*c);break;case"YXY":t.set(l*f,a*h,l*p,a*c);break;case"ZYZ":t.set(l*p,l*f,a*h,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Wc(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function zn(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}var sn=Object.freeze({__proto__:null,DEG2RAD:Iy,RAD2DEG:Ix,ceilPowerOfTwo:t1e,clamp:Ji,damp:Wxe,degToRad:$xe,denormalize:Wc,euclideanModulo:OO,floorPowerOfTwo:IA,generateUUID:ql,inverseLerp:jxe,isPowerOfTwo:VL,lerp:By,mapLinear:Vxe,normalize:zn,pingpong:Xxe,radToDeg:e1e,randFloat:Kxe,randFloatSpread:Jxe,randInt:Qxe,seededRandom:Zxe,setQuaternionFromProperEuler:n1e,smootherstep:qxe,smoothstep:Yxe}),be=class{constructor(e=0,n=0){be.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let n=this.x,i=this.y,r=e.elements;return this.x=r[0]*n+r[3]*i+r[6],this.y=r[1]*n+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){let i=Math.cos(n),r=Math.sin(n),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Rr=class{constructor(){Rr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(t,e,n,i,r,s,o,a,l){let c=this.elements;return c[0]=t,c[1]=i,c[2]=o,c[3]=e,c[4]=r,c[5]=a,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){let e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){let e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){let n=t.elements,i=e.elements,r=this.elements,s=n[0],o=n[3],a=n[6],l=n[1],c=n[4],h=n[7],u=n[2],d=n[5],f=n[8],p=i[0],v=i[3],g=i[6],m=i[1],y=i[4],w=i[7],b=i[2],A=i[5],S=i[8];return r[0]=s*p+o*m+a*b,r[3]=s*v+o*y+a*A,r[6]=s*g+o*w+a*S,r[1]=l*p+c*m+h*b,r[4]=l*v+c*y+h*A,r[7]=l*g+c*w+h*S,r[2]=u*p+d*m+f*b,r[5]=u*v+d*y+f*A,r[8]=u*g+d*w+f*S,this}multiplyScalar(t){let e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){let t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8];return e*s*c-e*o*l-n*r*c+n*o*a+i*r*l-i*s*a}invert(){let t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],h=c*s-o*l,u=o*a-c*r,d=l*r-s*a,f=e*h+n*u+i*d;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);let p=1/f;return t[0]=h*p,t[1]=(i*l-c*n)*p,t[2]=(o*n-i*s)*p,t[3]=u*p,t[4]=(c*e-i*a)*p,t[5]=(i*r-o*e)*p,t[6]=d*p,t[7]=(n*a-l*e)*p,t[8]=(s*e-n*r)*p,this}transpose(){let t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){let e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,i,r,s,o){let a=Math.cos(r),l=Math.sin(r);return this.set(n*a,n*l,-n*(a*s+l*o)+s+t,-i*l,i*a,-i*(-l*s+a*o)+o+e,0,0,1),this}scale(t,e){return this.premultiply(jP.makeScale(t,e)),this}rotate(t){return this.premultiply(jP.makeRotation(-t)),this}translate(t,e){return this.premultiply(jP.makeTranslation(t,e)),this}makeTranslation(t,e){return this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){let e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,n,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){let e=this.elements,n=t.elements;for(let i=0;i<9;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){let n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return new this.constructor().fromArray(this.elements)}},jP=new Rr;function qQ(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}var i1e={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function eb(t,e){return new i1e[t](e)}function BA(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function wf(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function RS(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}var WP={[Ll]:{[LA]:wf},[LA]:{[Ll]:RS}},rs={legacyMode:!0,get workingColorSpace(){return LA},set workingColorSpace(t){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(t,e,n){if(this.legacyMode||e===n||!e||!n)return t;if(WP[e]&&WP[e][n]!==void 0){let i=WP[e][n];return t.r=i(t.r),t.g=i(t.g),t.b=i(t.b),t}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}},QQ={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Yi={r:0,g:0,b:0},Ma={h:0,s:0,l:0},tb={h:0,s:0,l:0};function XP(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}function nb(t,e){return e.r=t.r,e.g=t.g,e.b=t.b,e}var Rt=class{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,n===void 0&&i===void 0?this.set(e):this.setRGB(e,n,i)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=Ll){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,rs.toWorkingColorSpace(this,n),this}setRGB(e,n,i,r=rs.workingColorSpace){return this.r=e,this.g=n,this.b=i,rs.toWorkingColorSpace(this,r),this}setHSL(e,n,i,r=rs.workingColorSpace){if(e=OO(e,1),n=Ji(n,0,1),i=Ji(i,0,1),n===0)this.r=this.g=this.b=i;else{let s=i<=.5?i*(1+n):i+n-i*n,o=2*i-s;this.r=XP(o,s,e+1/3),this.g=XP(o,s,e),this.b=XP(o,s,e-1/3)}return rs.toWorkingColorSpace(this,r),this}setStyle(e,n=Ll){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let s,o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,rs.toWorkingColorSpace(this,n),i(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,rs.toWorkingColorSpace(this,n),i(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){let l=parseFloat(s[1])/360,c=parseFloat(s[2])/100,h=parseFloat(s[3])/100;return i(s[4]),this.setHSL(l,c,h,n)}break}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){let s=r[1],o=s.length;if(o===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,rs.toWorkingColorSpace(this,n),this;if(o===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,rs.toWorkingColorSpace(this,n),this}return e&&e.length>0?this.setColorName(e,n):this}setColorName(e,n=Ll){let i=QQ[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=wf(e.r),this.g=wf(e.g),this.b=wf(e.b),this}copyLinearToSRGB(e){return this.r=RS(e.r),this.g=RS(e.g),this.b=RS(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ll){return rs.fromWorkingColorSpace(nb(this,Yi),e),Ji(Yi.r*255,0,255)<<16^Ji(Yi.g*255,0,255)<<8^Ji(Yi.b*255,0,255)<<0}getHexString(e=Ll){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=rs.workingColorSpace){rs.fromWorkingColorSpace(nb(this,Yi),n);let i=Yi.r,r=Yi.g,s=Yi.b,o=Math.max(i,r,s),a=Math.min(i,r,s),l,c,h=(a+o)/2;if(a===o)l=0,c=0;else{let u=o-a;switch(c=h<=.5?u/(o+a):u/(2-o-a),o){case i:l=(r-s)/u+(r<s?6:0);break;case r:l=(s-i)/u+2;break;case s:l=(i-r)/u+4;break}l/=6}return e.h=l,e.s=c,e.l=h,e}getRGB(e,n=rs.workingColorSpace){return rs.fromWorkingColorSpace(nb(this,Yi),n),e.r=Yi.r,e.g=Yi.g,e.b=Yi.b,e}getStyle(e=Ll){return rs.fromWorkingColorSpace(nb(this,Yi),e),e!==Ll?`color(${e} ${Yi.r} ${Yi.g} ${Yi.b})`:`rgb(${Yi.r*255|0},${Yi.g*255|0},${Yi.b*255|0})`}offsetHSL(e,n,i){return this.getHSL(Ma),Ma.h+=e,Ma.s+=n,Ma.l+=i,this.setHSL(Ma.h,Ma.s,Ma.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(Ma),e.getHSL(tb);let i=By(Ma.h,tb.h,n),r=By(Ma.s,tb.s,n),s=By(Ma.l,tb.l,n);return this.setHSL(i,r,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};Rt.NAMES=QQ;var Vp,KQ=class{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{Vp===void 0&&(Vp=BA("canvas")),Vp.width=t.width,Vp.height=t.height;let n=Vp.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Vp}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){let e=BA("canvas");e.width=t.width,e.height=t.height;let n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);let i=n.getImageData(0,0,t.width,t.height),r=i.data;for(let s=0;s<r.length;s++)r[s]=wf(r[s]/255)*255;return n.putImageData(i,0,0),e}else if(t.data){let e=t.data.slice(0);for(let n=0;n<e.length;n++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[n]=Math.floor(wf(e[n]/255)*255):e[n]=wf(e[n]);return{data:e,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}},JQ=class{constructor(t=null){this.isSource=!0,this.uuid=ql(),this.data=t,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){let e=t===void 0||typeof t=="string";if(!e&&t.images[this.uuid]!==void 0)return t.images[this.uuid];let n={uuid:this.uuid,url:""},i=this.data;if(i!==null){let r;if(Array.isArray(i)){r=[];for(let s=0,o=i.length;s<o;s++)i[s].isDataTexture?r.push(YP(i[s].image)):r.push(YP(i[s]))}else r=YP(i);n.url=r}return e||(t.images[this.uuid]=n),n}};function YP(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?KQ.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var r1e=0,br=class extends _s{constructor(t=br.DEFAULT_IMAGE,e=br.DEFAULT_MAPPING,n=ro,i=ro,r=En,s=Xg,o=ka,a=Zr,l=br.DEFAULT_ANISOTROPY,c=tc){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:r1e++}),this.uuid=ql(),this.name="",this.source=new JQ(t),this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new be(0,0),this.repeat=new be(1,1),this.center=new be(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Rr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){let e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];let n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==WQ)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Rx:t.x=t.x-Math.floor(t.x);break;case ro:t.x=t.x<0?0:1;break;case zL:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case Rx:t.y=t.y-Math.floor(t.y);break;case ro:t.y=t.y<0?0:1;break;case zL:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}};br.DEFAULT_IMAGE=null;br.DEFAULT_MAPPING=WQ;br.DEFAULT_ANISOTROPY=1;var Zt=class{constructor(e=0,n=0,i=0,r=1){Zt.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let n=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*n+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*n+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*n+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*n+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,r,s,o=e.elements,a=o[0],l=o[4],c=o[8],h=o[1],u=o[5],d=o[9],f=o[2],p=o[6],v=o[10];if(Math.abs(l-h)<.01&&Math.abs(c-f)<.01&&Math.abs(d-p)<.01){if(Math.abs(l+h)<.1&&Math.abs(c+f)<.1&&Math.abs(d+p)<.1&&Math.abs(a+u+v-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;let m=(a+1)/2,y=(u+1)/2,w=(v+1)/2,b=(l+h)/4,A=(c+f)/4,S=(d+p)/4;return m>y&&m>w?m<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(m),r=b/i,s=A/i):y>w?y<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(y),i=b/r,s=S/r):w<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(w),i=A/s,r=S/s),this.set(i,r,s,n),this}let g=Math.sqrt((p-d)*(p-d)+(c-f)*(c-f)+(h-l)*(h-l));return Math.abs(g)<.001&&(g=1),this.x=(p-d)/g,this.y=(c-f)/g,this.z=(h-l)/g,this.w=Math.acos((a+u+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},er=class extends _s{constructor(t=1,e=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=t,this.height=e,this.depth=1,this.scissor=new Zt(0,0,t,e),this.scissorTest=!1,this.viewport=new Zt(0,0,t,e);let i={width:t,height:e,depth:1};this.texture=new br(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.internalFormat=n.internalFormat!==void 0?n.internalFormat:null,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:En,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!1,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null,this.samples=n.samples!==void 0?n.samples:0}setSize(t,e,n=1){(this.width!==t||this.height!==e||this.depth!==n)&&(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return new this.constructor().copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;let e=Object.assign({},t.texture.image);return this.texture.source=new JQ(e),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},ZQ=class extends br{constructor(t=null,e=1,n=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:n,depth:i},this.magFilter=oi,this.minFilter=oi,this.wrapR=ro,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},s1e=class extends br{constructor(t=null,e=1,n=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:n,depth:i},this.magFilter=oi,this.minFilter=oi,this.wrapR=ro,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},on=class{constructor(t=0,e=0,n=0,i=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=n,this._w=i}static slerpFlat(t,e,n,i,r,s,o){let a=n[i+0],l=n[i+1],c=n[i+2],h=n[i+3],u=r[s+0],d=r[s+1],f=r[s+2],p=r[s+3];if(o===0){t[e+0]=a,t[e+1]=l,t[e+2]=c,t[e+3]=h;return}if(o===1){t[e+0]=u,t[e+1]=d,t[e+2]=f,t[e+3]=p;return}if(h!==p||a!==u||l!==d||c!==f){let v=1-o,g=a*u+l*d+c*f+h*p,m=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){let b=Math.sqrt(y),A=Math.atan2(b,g*m);v=Math.sin(v*A)/b,o=Math.sin(o*A)/b}let w=o*m;if(a=a*v+u*w,l=l*v+d*w,c=c*v+f*w,h=h*v+p*w,v===1-o){let b=1/Math.sqrt(a*a+l*l+c*c+h*h);a*=b,l*=b,c*=b,h*=b}}t[e]=a,t[e+1]=l,t[e+2]=c,t[e+3]=h}static multiplyQuaternionsFlat(t,e,n,i,r,s){let o=n[i],a=n[i+1],l=n[i+2],c=n[i+3],h=r[s],u=r[s+1],d=r[s+2],f=r[s+3];return t[e]=o*f+c*h+a*d-l*u,t[e+1]=a*f+c*u+l*h-o*d,t[e+2]=l*f+c*d+o*u-a*h,t[e+3]=c*f-o*h-a*u-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){let n=t._x,i=t._y,r=t._z,s=t._order,o=Math.cos,a=Math.sin,l=o(n/2),c=o(i/2),h=o(r/2),u=a(n/2),d=a(i/2),f=a(r/2);switch(s){case"XYZ":this._x=u*c*h+l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h-u*d*f;break;case"YXZ":this._x=u*c*h+l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h+u*d*f;break;case"ZXY":this._x=u*c*h-l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h-u*d*f;break;case"ZYX":this._x=u*c*h-l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h+u*d*f;break;case"YZX":this._x=u*c*h+l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h-u*d*f;break;case"XZY":this._x=u*c*h-l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h+u*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,e){let n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){let e=t.elements,n=e[0],i=e[4],r=e[8],s=e[1],o=e[5],a=e[9],l=e[2],c=e[6],h=e[10],u=n+o+h;if(u>0){let d=.5/Math.sqrt(u+1);this._w=.25/d,this._x=(c-a)*d,this._y=(r-l)*d,this._z=(s-i)*d}else if(n>o&&n>h){let d=2*Math.sqrt(1+n-o-h);this._w=(c-a)/d,this._x=.25*d,this._y=(i+s)/d,this._z=(r+l)/d}else if(o>h){let d=2*Math.sqrt(1+o-n-h);this._w=(r-l)/d,this._x=(i+s)/d,this._y=.25*d,this._z=(a+c)/d}else{let d=2*Math.sqrt(1+h-n-o);this._w=(s-i)/d,this._x=(r+l)/d,this._y=(a+c)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Ji(this.dot(t),-1,1)))}rotateTowards(t,e){let n=this.angleTo(t);if(n===0)return this;let i=Math.min(1,e/n);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){let n=t._x,i=t._y,r=t._z,s=t._w,o=e._x,a=e._y,l=e._z,c=e._w;return this._x=n*c+s*o+i*l-r*a,this._y=i*c+s*a+r*o-n*l,this._z=r*c+s*l+n*a-i*o,this._w=s*c-n*o-i*a-r*l,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);let n=this._x,i=this._y,r=this._z,s=this._w,o=s*t._w+n*t._x+i*t._y+r*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=s,this._x=n,this._y=i,this._z=r,this;let a=1-o*o;if(a<=Number.EPSILON){let d=1-e;return this._w=d*s+e*this._w,this._x=d*n+e*this._x,this._y=d*i+e*this._y,this._z=d*r+e*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(a),c=Math.atan2(l,o),h=Math.sin((1-e)*c)/l,u=Math.sin(e*c)/l;return this._w=s*h+this._w*u,this._x=n*h+this._x*u,this._y=i*h+this._y*u,this._z=r*h+this._z*u,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){let t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),i=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(e*Math.cos(i),n*Math.sin(r),n*Math.cos(r),e*Math.sin(i))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},N=class{constructor(e=0,n=0,i=0){N.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(rV.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(rV.setFromAxisAngle(e,n))}applyMatrix3(e){let n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6]*r,this.y=s[1]*n+s[4]*i+s[7]*r,this.z=s[2]*n+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let n=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*n+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*n+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*n+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*n+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){let n=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*n+o*r-a*i,h=l*i+a*n-s*r,u=l*r+s*i-o*n,d=-s*n-o*i-a*r;return this.x=c*l+d*-s+h*-a-u*-o,this.y=h*l+d*-o+u*-s-c*-a,this.z=u*l+d*-a+c*-o-h*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[4]*i+s[8]*r,this.y=s[1]*n+s[5]*i+s[9]*r,this.z=s[2]*n+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){let i=e.x,r=e.y,s=e.z,o=n.x,a=n.y,l=n.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){let n=e.lengthSq();if(n===0)return this.set(0,0,0);let i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return qP.copy(this).projectOnVector(e),this.sub(qP)}reflect(e){return this.sub(qP.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;let i=this.dot(e)/n;return Math.acos(Ji(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let n=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return n*n+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){let r=Math.sin(n)*e;return this.x=r*Math.sin(i),this.y=Math.cos(n)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){let n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){let n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=r,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,n=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(n),this.y=i*Math.sin(n),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},qP=new N,rV=new on,ji=class{constructor(t=new N(1/0,1/0,1/0),e=new N(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,l=t.length;a<l;a+=3){let c=t[a],h=t[a+1],u=t[a+2];c<e&&(e=c),h<n&&(n=h),u<i&&(i=u),c>r&&(r=c),h>s&&(s=h),u>o&&(o=u)}return this.min.set(e,n,i),this.max.set(r,s,o),this}setFromBufferAttribute(t){let e=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,l=t.count;a<l;a++){let c=t.getX(a),h=t.getY(a),u=t.getZ(a);c<e&&(e=c),h<n&&(n=h),u<i&&(i=u),c>r&&(r=c),h>s&&(s=h),u>o&&(o=u)}return this.min.set(e,n,i),this.max.set(r,s,o),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){let n=Cd.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);let n=t.geometry;if(n!==void 0)if(e&&n.attributes!=null&&n.attributes.position!==void 0){let r=n.attributes.position;for(let s=0,o=r.count;s<o;s++)Cd.fromBufferAttribute(r,s).applyMatrix4(t.matrixWorld),this.expandByPoint(Cd)}else n.boundingBox===null&&n.computeBoundingBox(),QP.copy(n.boundingBox),QP.applyMatrix4(t.matrixWorld),this.union(QP);let i=t.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,Cd),Cd.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(b0),ib.subVectors(this.max,b0),jp.subVectors(t.a,b0),Wp.subVectors(t.b,b0),Xp.subVectors(t.c,b0),Fu.subVectors(Wp,jp),Nu.subVectors(Xp,Wp),Td.subVectors(jp,Xp);let e=[0,-Fu.z,Fu.y,0,-Nu.z,Nu.y,0,-Td.z,Td.y,Fu.z,0,-Fu.x,Nu.z,0,-Nu.x,Td.z,0,-Td.x,-Fu.y,Fu.x,0,-Nu.y,Nu.x,0,-Td.y,Td.x,0];return!KP(e,jp,Wp,Xp,ib)||(e=[1,0,0,0,1,0,0,0,1],!KP(e,jp,Wp,Xp,ib))?!1:(rb.crossVectors(Fu,Nu),e=[rb.x,rb.y,rb.z],KP(e,jp,Wp,Xp,ib))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return Cd.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=this.getSize(Cd).length()*.5,t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(Sc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Sc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Sc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Sc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Sc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Sc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Sc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Sc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Sc),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},Sc=[new N,new N,new N,new N,new N,new N,new N,new N],Cd=new N,QP=new ji,jp=new N,Wp=new N,Xp=new N,Fu=new N,Nu=new N,Td=new N,b0=new N,ib=new N,rb=new N,Pd=new N;function KP(t,e,n,i,r){for(let s=0,o=t.length-3;s<=o;s+=3){Pd.fromArray(t,s);let a=r.x*Math.abs(Pd.x)+r.y*Math.abs(Pd.y)+r.z*Math.abs(Pd.z),l=e.dot(Pd),c=n.dot(Pd),h=i.dot(Pd);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>a)return!1}return!0}var o1e=new ji,S0=new N,JP=new N,ha=class{constructor(t=new N,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){let n=this.center;e!==void 0?n.copy(e):o1e.setFromPoints(t).getCenter(n);let i=0;for(let r=0,s=t.length;r<s;r++)i=Math.max(i,n.distanceToSquared(t[r]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){let e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){let n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;S0.subVectors(t,this.center);let e=S0.lengthSq();if(e>this.radius*this.radius){let n=Math.sqrt(e),i=(n-this.radius)*.5;this.center.addScaledVector(S0,i/n),this.radius+=i}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(JP.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(S0.copy(t.center).add(JP)),this.expandByPoint(S0.copy(t.center).sub(JP))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}},Ac=new N,ZP=new N,sb=new N,Uu=new N,$P=new N,ob=new N,e2=new N,yv=class{constructor(t=new N,e=new N(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Ac)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);let n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){let e=Ac.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Ac.copy(this.direction).multiplyScalar(e).add(this.origin),Ac.distanceToSquared(t))}distanceSqToSegment(t,e,n,i){ZP.copy(t).add(e).multiplyScalar(.5),sb.copy(e).sub(t).normalize(),Uu.copy(this.origin).sub(ZP);let r=t.distanceTo(e)*.5,s=-this.direction.dot(sb),o=Uu.dot(this.direction),a=-Uu.dot(sb),l=Uu.lengthSq(),c=Math.abs(1-s*s),h,u,d,f;if(c>0)if(h=s*a-o,u=s*o-a,f=r*c,h>=0)if(u>=-f)if(u<=f){let p=1/c;h*=p,u*=p,d=h*(h+s*u+2*o)+u*(s*h+u+2*a)+l}else u=r,h=Math.max(0,-(s*u+o)),d=-h*h+u*(u+2*a)+l;else u=-r,h=Math.max(0,-(s*u+o)),d=-h*h+u*(u+2*a)+l;else u<=-f?(h=Math.max(0,-(-s*r+o)),u=h>0?-r:Math.min(Math.max(-r,-a),r),d=-h*h+u*(u+2*a)+l):u<=f?(h=0,u=Math.min(Math.max(-r,-a),r),d=u*(u+2*a)+l):(h=Math.max(0,-(s*r+o)),u=h>0?r:Math.min(Math.max(-r,-a),r),d=-h*h+u*(u+2*a)+l);else u=s>0?-r:r,h=Math.max(0,-(s*u+o)),d=-h*h+u*(u+2*a)+l;return n&&n.copy(this.direction).multiplyScalar(h).add(this.origin),i&&i.copy(sb).multiplyScalar(u).add(ZP),d}intersectSphere(t,e){Ac.subVectors(t.center,this.origin);let n=Ac.dot(this.direction),i=Ac.dot(Ac)-n*n,r=t.radius*t.radius;if(i>r)return null;let s=Math.sqrt(r-i),o=n-s,a=n+s;return o<0&&a<0?null:o<0?this.at(a,e):this.at(o,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){let e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;let n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){let n=this.distanceToPlane(t);return n===null?null:this.at(n,e)}intersectsPlane(t){let e=t.distanceToPoint(this.origin);return e===0||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,i,r,s,o,a,l=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,u=this.origin;return l>=0?(n=(t.min.x-u.x)*l,i=(t.max.x-u.x)*l):(n=(t.max.x-u.x)*l,i=(t.min.x-u.x)*l),c>=0?(r=(t.min.y-u.y)*c,s=(t.max.y-u.y)*c):(r=(t.max.y-u.y)*c,s=(t.min.y-u.y)*c),n>s||r>i||((r>n||isNaN(n))&&(n=r),(s<i||isNaN(i))&&(i=s),h>=0?(o=(t.min.z-u.z)*h,a=(t.max.z-u.z)*h):(o=(t.max.z-u.z)*h,a=(t.min.z-u.z)*h),n>a||o>i)||((o>n||n!==n)&&(n=o),(a<i||i!==i)&&(i=a),i<0)?null:this.at(n>=0?n:i,e)}intersectsBox(t){return this.intersectBox(t,Ac)!==null}intersectTriangle(t,e,n,i,r){$P.subVectors(e,t),ob.subVectors(n,t),e2.crossVectors($P,ob);let s=this.direction.dot(e2),o;if(s>0){if(i)return null;o=1}else if(s<0)o=-1,s=-s;else return null;Uu.subVectors(this.origin,t);let a=o*this.direction.dot(ob.crossVectors(Uu,ob));if(a<0)return null;let l=o*this.direction.dot($P.cross(Uu));if(l<0||a+l>s)return null;let c=-o*Uu.dot(e2);return c<0?null:this.at(c/s,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},nt=class{constructor(){nt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,n,i,r,s,o,a,l,c,h,u,d,f,p,v,g){let m=this.elements;return m[0]=e,m[4]=n,m[8]=i,m[12]=r,m[1]=s,m[5]=o,m[9]=a,m[13]=l,m[2]=c,m[6]=h,m[10]=u,m[14]=d,m[3]=f,m[7]=p,m[11]=v,m[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new nt().fromArray(this.elements)}copy(e){let n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){let n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){let n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){let n=this.elements,i=e.elements,r=1/Yp.setFromMatrixColumn(e,0).length(),s=1/Yp.setFromMatrixColumn(e,1).length(),o=1/Yp.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[3]=0,n[4]=i[4]*s,n[5]=i[5]*s,n[6]=i[6]*s,n[7]=0,n[8]=i[8]*o,n[9]=i[9]*o,n[10]=i[10]*o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){let n=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),h=Math.cos(s),u=Math.sin(s);if(e.order==="XYZ"){let d=o*h,f=o*u,p=a*h,v=a*u;n[0]=l*h,n[4]=-l*u,n[8]=c,n[1]=f+p*c,n[5]=d-v*c,n[9]=-a*l,n[2]=v-d*c,n[6]=p+f*c,n[10]=o*l}else if(e.order==="YXZ"){let d=l*h,f=l*u,p=c*h,v=c*u;n[0]=d+v*a,n[4]=p*a-f,n[8]=o*c,n[1]=o*u,n[5]=o*h,n[9]=-a,n[2]=f*a-p,n[6]=v+d*a,n[10]=o*l}else if(e.order==="ZXY"){let d=l*h,f=l*u,p=c*h,v=c*u;n[0]=d-v*a,n[4]=-o*u,n[8]=p+f*a,n[1]=f+p*a,n[5]=o*h,n[9]=v-d*a,n[2]=-o*c,n[6]=a,n[10]=o*l}else if(e.order==="ZYX"){let d=o*h,f=o*u,p=a*h,v=a*u;n[0]=l*h,n[4]=p*c-f,n[8]=d*c+v,n[1]=l*u,n[5]=v*c+d,n[9]=f*c-p,n[2]=-c,n[6]=a*l,n[10]=o*l}else if(e.order==="YZX"){let d=o*l,f=o*c,p=a*l,v=a*c;n[0]=l*h,n[4]=v-d*u,n[8]=p*u+f,n[1]=u,n[5]=o*h,n[9]=-a*h,n[2]=-c*h,n[6]=f*u+p,n[10]=d-v*u}else if(e.order==="XZY"){let d=o*l,f=o*c,p=a*l,v=a*c;n[0]=l*h,n[4]=-u,n[8]=c*h,n[1]=d*u+v,n[5]=o*h,n[9]=f*u-p,n[2]=p*u-f,n[6]=a*h,n[10]=v*u+d}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(a1e,e,l1e)}lookAt(e,n,i){let r=this.elements;return Js.subVectors(e,n),Js.lengthSq()===0&&(Js.z=1),Js.normalize(),ku.crossVectors(i,Js),ku.lengthSq()===0&&(Math.abs(i.z)===1?Js.x+=1e-4:Js.z+=1e-4,Js.normalize(),ku.crossVectors(i,Js)),ku.normalize(),ab.crossVectors(Js,ku),r[0]=ku.x,r[4]=ab.x,r[8]=Js.x,r[1]=ku.y,r[5]=ab.y,r[9]=Js.y,r[2]=ku.z,r[6]=ab.z,r[10]=Js.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){let i=e.elements,r=n.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],h=i[1],u=i[5],d=i[9],f=i[13],p=i[2],v=i[6],g=i[10],m=i[14],y=i[3],w=i[7],b=i[11],A=i[15],S=r[0],T=r[4],M=r[8],E=r[12],P=r[1],R=r[5],F=r[9],B=r[13],k=r[2],j=r[6],Z=r[10],ee=r[14],O=r[3],W=r[7],H=r[11],Y=r[15];return s[0]=o*S+a*P+l*k+c*O,s[4]=o*T+a*R+l*j+c*W,s[8]=o*M+a*F+l*Z+c*H,s[12]=o*E+a*B+l*ee+c*Y,s[1]=h*S+u*P+d*k+f*O,s[5]=h*T+u*R+d*j+f*W,s[9]=h*M+u*F+d*Z+f*H,s[13]=h*E+u*B+d*ee+f*Y,s[2]=p*S+v*P+g*k+m*O,s[6]=p*T+v*R+g*j+m*W,s[10]=p*M+v*F+g*Z+m*H,s[14]=p*E+v*B+g*ee+m*Y,s[3]=y*S+w*P+b*k+A*O,s[7]=y*T+w*R+b*j+A*W,s[11]=y*M+w*F+b*Z+A*H,s[15]=y*E+w*B+b*ee+A*Y,this}multiplyScalar(e){let n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){let e=this.elements,n=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],h=e[2],u=e[6],d=e[10],f=e[14],p=e[3],v=e[7],g=e[11],m=e[15];return p*(+s*l*u-r*c*u-s*a*d+i*c*d+r*a*f-i*l*f)+v*(+n*l*f-n*c*d+s*o*d-r*o*f+r*c*h-s*l*h)+g*(+n*c*u-n*a*f-s*o*u+i*o*f+s*a*h-i*c*h)+m*(-r*a*h-n*l*u+n*a*d+r*o*u-i*o*d+i*l*h)}transpose(){let e=this.elements,n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){let r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=n,r[14]=i),this}invert(){let e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8],u=e[9],d=e[10],f=e[11],p=e[12],v=e[13],g=e[14],m=e[15],y=u*g*c-v*d*c+v*l*f-a*g*f-u*l*m+a*d*m,w=p*d*c-h*g*c-p*l*f+o*g*f+h*l*m-o*d*m,b=h*v*c-p*u*c+p*a*f-o*v*f-h*a*m+o*u*m,A=p*u*l-h*v*l-p*a*d+o*v*d+h*a*g-o*u*g,S=n*y+i*w+r*b+s*A;if(S===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let T=1/S;return e[0]=y*T,e[1]=(v*d*s-u*g*s-v*r*f+i*g*f+u*r*m-i*d*m)*T,e[2]=(a*g*s-v*l*s+v*r*c-i*g*c-a*r*m+i*l*m)*T,e[3]=(u*l*s-a*d*s-u*r*c+i*d*c+a*r*f-i*l*f)*T,e[4]=w*T,e[5]=(h*g*s-p*d*s+p*r*f-n*g*f-h*r*m+n*d*m)*T,e[6]=(p*l*s-o*g*s-p*r*c+n*g*c+o*r*m-n*l*m)*T,e[7]=(o*d*s-h*l*s+h*r*c-n*d*c-o*r*f+n*l*f)*T,e[8]=b*T,e[9]=(p*u*s-h*v*s-p*i*f+n*v*f+h*i*m-n*u*m)*T,e[10]=(o*v*s-p*a*s+p*i*c-n*v*c-o*i*m+n*a*m)*T,e[11]=(h*a*s-o*u*s-h*i*c+n*u*c+o*i*f-n*a*f)*T,e[12]=A*T,e[13]=(h*v*r-p*u*r+p*i*d-n*v*d-h*i*g+n*u*g)*T,e[14]=(p*a*r-o*v*r-p*i*l+n*v*l+o*i*g-n*a*g)*T,e[15]=(o*u*r-h*a*r+h*i*l-n*u*l-o*i*d+n*a*d)*T,this}scale(e){let n=this.elements,i=e.x,r=e.y,s=e.z;return n[0]*=i,n[4]*=r,n[8]*=s,n[1]*=i,n[5]*=r,n[9]*=s,n[2]*=i,n[6]*=r,n[10]*=s,n[3]*=i,n[7]*=r,n[11]*=s,this}getMaxScaleOnAxis(){let e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,r))}makeTranslation(e,n,i){return this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){let n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){let n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){let n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){let i=Math.cos(n),r=Math.sin(n),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,h=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,h*a+i,h*l-r*o,0,c*l-r*a,h*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,n,r,1,0,0,0,0,1),this}compose(e,n,i){let r=this.elements,s=n._x,o=n._y,a=n._z,l=n._w,c=s+s,h=o+o,u=a+a,d=s*c,f=s*h,p=s*u,v=o*h,g=o*u,m=a*u,y=l*c,w=l*h,b=l*u,A=i.x,S=i.y,T=i.z;return r[0]=(1-(v+m))*A,r[1]=(f+b)*A,r[2]=(p-w)*A,r[3]=0,r[4]=(f-b)*S,r[5]=(1-(d+m))*S,r[6]=(g+y)*S,r[7]=0,r[8]=(p+w)*T,r[9]=(g-y)*T,r[10]=(1-(d+v))*T,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,n,i){let r=this.elements,s=Yp.set(r[0],r[1],r[2]).length(),o=Yp.set(r[4],r[5],r[6]).length(),a=Yp.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Ea.copy(this);let l=1/s,c=1/o,h=1/a;return Ea.elements[0]*=l,Ea.elements[1]*=l,Ea.elements[2]*=l,Ea.elements[4]*=c,Ea.elements[5]*=c,Ea.elements[6]*=c,Ea.elements[8]*=h,Ea.elements[9]*=h,Ea.elements[10]*=h,n.setFromRotationMatrix(Ea),i.x=s,i.y=o,i.z=a,this}makePerspective(e,n,i,r,s,o){let a=this.elements,l=2*s/(n-e),c=2*s/(i-r),h=(n+e)/(n-e),u=(i+r)/(i-r),d=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=l,a[4]=0,a[8]=h,a[12]=0,a[1]=0,a[5]=c,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,n,i,r,s,o){let a=this.elements,l=1/(n-e),c=1/(i-r),h=1/(o-s),u=(n+e)*l,d=(i+r)*c,f=(o+s)*h;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*h,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){let n=this.elements,i=e.elements;for(let r=0;r<16;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){let i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}},Yp=new N,Ea=new nt,a1e=new N(0,0,0),l1e=new N(1,1,1),ku=new N,ab=new N,Js=new N,sV=new nt,oV=new on,Dr=class{constructor(t=0,e=0,n=0,i=Dr.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=n,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,i=this._order){return this._x=t,this._y=e,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){let i=t.elements,r=i[0],s=i[4],o=i[8],a=i[1],l=i[5],c=i[9],h=i[2],u=i[6],d=i[10];switch(e){case"XYZ":this._y=Math.asin(Ji(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Ji(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-h,r),this._z=0);break;case"ZXY":this._x=Math.asin(Ji(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(a,r));break;case"ZYX":this._y=Math.asin(-Ji(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(u,d),this._z=Math.atan2(a,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(Ji(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-h,r)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-Ji(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(o,r)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,n===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return sV.makeRotationFromQuaternion(t),this.setFromRotationMatrix(sV,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return oV.setFromEuler(this),this.setFromQuaternion(oV,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};Dr.DEFAULT_ORDER="XYZ";var FO=class{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}},c1e=0,aV=new N,qp=new on,Mc=new nt,lb=new N,A0=new N,u1e=new N,h1e=new on,lV=new N(1,0,0),cV=new N(0,1,0),uV=new N(0,0,1),d1e={type:"added"},hV={type:"removed"},Nn=class extends _s{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:c1e++}),this.uuid=ql(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Nn.DEFAULT_UP.clone();let t=new N,e=new Dr,n=new on,i=new N(1,1,1);function r(){n.setFromEuler(e,!1)}function s(){e.setFromQuaternion(n,void 0,!1)}e._onChange(r),n._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new nt},normalMatrix:{value:new Rr}}),this.matrix=new nt,this.matrixWorld=new nt,this.matrixAutoUpdate=Nn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Nn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new FO,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return qp.setFromAxisAngle(t,e),this.quaternion.multiply(qp),this}rotateOnWorldAxis(t,e){return qp.setFromAxisAngle(t,e),this.quaternion.premultiply(qp),this}rotateX(t){return this.rotateOnAxis(lV,t)}rotateY(t){return this.rotateOnAxis(cV,t)}rotateZ(t){return this.rotateOnAxis(uV,t)}translateOnAxis(t,e){return aV.copy(t).applyQuaternion(this.quaternion),this.position.add(aV.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(lV,t)}translateY(t){return this.translateOnAxis(cV,t)}translateZ(t){return this.translateOnAxis(uV,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Mc.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?lb.copy(t):lb.set(t,e,n);let i=this.parent;this.updateWorldMatrix(!0,!1),A0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Mc.lookAt(A0,lb,this.up):Mc.lookAt(lb,A0,this.up),this.quaternion.setFromRotationMatrix(Mc),i&&(Mc.extractRotation(i.matrixWorld),qp.setFromRotationMatrix(Mc),this.quaternion.premultiply(qp.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(d1e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}let e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(hV)),this}removeFromParent(){let t=this.parent;return t!==null&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){let e=this.children[t];e.parent=null,e.dispatchEvent(hV)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Mc.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Mc.multiply(t.parent.matrixWorld)),t.applyMatrix4(Mc),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,i=this.children.length;n<i;n++){let r=this.children[n].getObjectByProperty(t,e);if(r!==void 0)return r}}getObjectsByProperty(t,e){let n=[];this[t]===e&&n.push(this);for(let i=0,r=this.children.length;i<r;i++){let s=this.children[i].getObjectsByProperty(t,e);s.length>0&&(n=n.concat(s))}return n}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(A0,t,u1e),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(A0,h1e,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);let e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);let e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}traverseAncestors(t){let e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);let e=this.children;for(let n=0,i=e.length;n<i;n++){let r=e[n];(r.matrixWorldAutoUpdate===!0||t===!0)&&r.updateMatrixWorld(t)}}updateWorldMatrix(t,e){let n=this.parent;if(t===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e===!0){let i=this.children;for(let r=0,s=i.length;r<s;r++){let o=i[r];o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!1,!0)}}}toJSON(t){let e=t===void 0||typeof t=="string",n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function r(o,a){return o[a.uuid]===void 0&&(o[a.uuid]=a.toJSON(t)),a.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(t.geometries,this.geometry);let o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){let a=o.shapes;if(Array.isArray(a))for(let l=0,c=a.length;l<c;l++){let h=a[l];r(t.shapes,h)}else r(t.shapes,a)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let o=[];for(let a=0,l=this.material.length;a<l;a++)o.push(r(t.materials,this.material[a]));i.material=o}else i.material=r(t.materials,this.material);if(this.children.length>0){i.children=[];for(let o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let o=0;o<this.animations.length;o++){let a=this.animations[o];i.animations.push(r(t.animations,a))}}if(e){let o=s(t.geometries),a=s(t.materials),l=s(t.textures),c=s(t.images),h=s(t.shapes),u=s(t.skeletons),d=s(t.animations),f=s(t.nodes);o.length>0&&(n.geometries=o),a.length>0&&(n.materials=a),l.length>0&&(n.textures=l),c.length>0&&(n.images=c),h.length>0&&(n.shapes=h),u.length>0&&(n.skeletons=u),d.length>0&&(n.animations=d),f.length>0&&(n.nodes=f)}return n.object=i,n;function s(o){let a=[];for(let l in o){let c=o[l];delete c.metadata,a.push(c)}return a}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let n=0;n<t.children.length;n++){let i=t.children[n];this.add(i.clone())}return this}};Nn.DEFAULT_UP=new N(0,1,0);Nn.DEFAULT_MATRIX_AUTO_UPDATE=!0;Nn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var Ca=new N,Ec=new N,t2=new N,Cc=new N,Qp=new N,Kp=new N,dV=new N,n2=new N,i2=new N,r2=new N,Ds=class{constructor(t=new N,e=new N,n=new N){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,i){i.subVectors(n,e),Ca.subVectors(t,e),i.cross(Ca);let r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(t,e,n,i,r){Ca.subVectors(i,e),Ec.subVectors(n,e),t2.subVectors(t,e);let s=Ca.dot(Ca),o=Ca.dot(Ec),a=Ca.dot(t2),l=Ec.dot(Ec),c=Ec.dot(t2),h=s*l-o*o;if(h===0)return r.set(-2,-1,-1);let u=1/h,d=(l*a-o*c)*u,f=(s*c-o*a)*u;return r.set(1-d-f,f,d)}static containsPoint(t,e,n,i){return this.getBarycoord(t,e,n,i,Cc),Cc.x>=0&&Cc.y>=0&&Cc.x+Cc.y<=1}static getUV(t,e,n,i,r,s,o,a){return this.getBarycoord(t,e,n,i,Cc),a.set(0,0),a.addScaledVector(r,Cc.x),a.addScaledVector(s,Cc.y),a.addScaledVector(o,Cc.z),a}static isFrontFacing(t,e,n,i){return Ca.subVectors(n,e),Ec.subVectors(t,e),Ca.cross(Ec).dot(i)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,e,n,i){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,i),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return Ca.subVectors(this.c,this.b),Ec.subVectors(this.a,this.b),Ca.cross(Ec).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Ds.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return Ds.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,i,r){return Ds.getUV(t,this.a,this.b,this.c,e,n,i,r)}containsPoint(t){return Ds.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Ds.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){let n=this.a,i=this.b,r=this.c,s,o;Qp.subVectors(i,n),Kp.subVectors(r,n),n2.subVectors(t,n);let a=Qp.dot(n2),l=Kp.dot(n2);if(a<=0&&l<=0)return e.copy(n);i2.subVectors(t,i);let c=Qp.dot(i2),h=Kp.dot(i2);if(c>=0&&h<=c)return e.copy(i);let u=a*h-c*l;if(u<=0&&a>=0&&c<=0)return s=a/(a-c),e.copy(n).addScaledVector(Qp,s);r2.subVectors(t,r);let d=Qp.dot(r2),f=Kp.dot(r2);if(f>=0&&d<=f)return e.copy(r);let p=d*l-a*f;if(p<=0&&l>=0&&f<=0)return o=l/(l-f),e.copy(n).addScaledVector(Kp,o);let v=c*f-d*h;if(v<=0&&h-c>=0&&d-f>=0)return dV.subVectors(r,i),o=(h-c)/(h-c+(d-f)),e.copy(i).addScaledVector(dV,o);let g=1/(v+p+u);return s=p*g,o=u*g,e.copy(n).addScaledVector(Qp,s).addScaledVector(Kp,o)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},f1e=0,F1=class extends _s{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:f1e++}),this.uuid=ql(),this.name="",this.type="Material",this.blending=fg,this.side=el,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=HQ,this.blendDst=VQ,this.blendEquation=xm,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=NL,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Hxe,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=VP,this.stencilZFail=VP,this.stencilZPass=VP,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(let e in t){let n=t[e];if(n===void 0){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}let i=this[e];if(i===void 0){console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.");continue}i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]=n}}toJSON(t){let e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});let n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==fg&&(n.blending=this.blending),this.side!==el&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(n.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function i(r){let s=[];for(let o in r){let a=r[o];delete a.metadata,s.push(a)}return s}if(e){let r=i(t.textures),s=i(t.images);r.length>0&&(n.textures=r),s.length>0&&(n.images=s)}return n}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;let e=t.clippingPlanes,n=null;if(e!==null){let i=e.length;n=new Array(i);for(let r=0;r!==i;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}},N1=class extends F1{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Rt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=jQ,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}},Fi=new N,cb=new be,Ut=class{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=GL,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=n.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)cb.fromBufferAttribute(this,n),cb.applyMatrix3(e),this.setXY(n,cb.x,cb.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)Fi.fromBufferAttribute(this,n),Fi.applyMatrix3(e),this.setXYZ(n,Fi.x,Fi.y,Fi.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)Fi.fromBufferAttribute(this,n),Fi.applyMatrix4(e),this.setXYZ(n,Fi.x,Fi.y,Fi.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)Fi.fromBufferAttribute(this,n),Fi.applyNormalMatrix(e),this.setXYZ(n,Fi.x,Fi.y,Fi.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)Fi.fromBufferAttribute(this,n),Fi.transformDirection(e),this.setXYZ(n,Fi.x,Fi.y,Fi.z);return this}set(e,n=0){return this.array.set(e,n),this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=Wc(n,this.array)),n}setX(e,n){return this.normalized&&(n=zn(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=Wc(n,this.array)),n}setY(e,n){return this.normalized&&(n=zn(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=Wc(n,this.array)),n}setZ(e,n){return this.normalized&&(n=zn(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=Wc(n,this.array)),n}setW(e,n){return this.normalized&&(n=zn(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=zn(n,this.array),i=zn(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=zn(n,this.array),i=zn(i,this.array),r=zn(r,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=zn(n,this.array),i=zn(i,this.array),r=zn(r,this.array),s=zn(s,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==GL&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},$Q=class extends Ut{constructor(t,e,n){super(new Uint16Array(t),e,n)}},Oy=class extends Ut{constructor(t,e,n){super(new Uint32Array(t),e,n)}},p1e=class extends Ut{constructor(t,e,n){super(new Uint16Array(t),e,n),this.isFloat16BufferAttribute=!0}},ft=class extends Ut{constructor(e,n,i){super(new Float32Array(e),n,i)}},m1e=0,zo=new nt,s2=new Nn,Jp=new N,Zs=new ji,M0=new ji,dr=new N,Lt=class extends _s{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:m1e++}),this.uuid=ql(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(qQ(e)?Oy:$Q)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){let n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let s=new Rr().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}let r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return zo.makeRotationFromQuaternion(e),this.applyMatrix4(zo),this}rotateX(e){return zo.makeRotationX(e),this.applyMatrix4(zo),this}rotateY(e){return zo.makeRotationY(e),this.applyMatrix4(zo),this}rotateZ(e){return zo.makeRotationZ(e),this.applyMatrix4(zo),this}translate(e,n,i){return zo.makeTranslation(e,n,i),this.applyMatrix4(zo),this}scale(e,n,i){return zo.makeScale(e,n,i),this.applyMatrix4(zo),this}lookAt(e){return s2.lookAt(e),s2.updateMatrix(),this.applyMatrix4(s2.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Jp).negate(),this.translate(Jp.x,Jp.y,Jp.z),this}setFromPoints(e){let n=[];for(let i=0,r=e.length;i<r;i++){let s=e[i];n.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new ft(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ji);let e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new N(-1/0,-1/0,-1/0),new N(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,r=n.length;i<r;i++){let s=n[i];Zs.setFromBufferAttribute(s),this.morphTargetsRelative?(dr.addVectors(this.boundingBox.min,Zs.min),this.boundingBox.expandByPoint(dr),dr.addVectors(this.boundingBox.max,Zs.max),this.boundingBox.expandByPoint(dr)):(this.boundingBox.expandByPoint(Zs.min),this.boundingBox.expandByPoint(Zs.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ha);let e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new N,1/0);return}if(e){let i=this.boundingSphere.center;if(Zs.setFromBufferAttribute(e),n)for(let s=0,o=n.length;s<o;s++){let a=n[s];M0.setFromBufferAttribute(a),this.morphTargetsRelative?(dr.addVectors(Zs.min,M0.min),Zs.expandByPoint(dr),dr.addVectors(Zs.max,M0.max),Zs.expandByPoint(dr)):(Zs.expandByPoint(M0.min),Zs.expandByPoint(M0.max))}Zs.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)dr.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(dr));if(n)for(let s=0,o=n.length;s<o;s++){let a=n[s],l=this.morphTargetsRelative;for(let c=0,h=a.count;c<h;c++)dr.fromBufferAttribute(a,c),l&&(Jp.fromBufferAttribute(e,c),dr.add(Jp)),r=Math.max(r,i.distanceToSquared(dr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=e.array,r=n.position.array,s=n.normal.array,o=n.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ut(new Float32Array(4*a),4));let l=this.getAttribute("tangent").array,c=[],h=[];for(let P=0;P<a;P++)c[P]=new N,h[P]=new N;let u=new N,d=new N,f=new N,p=new be,v=new be,g=new be,m=new N,y=new N;function w(P,R,F){u.fromArray(r,P*3),d.fromArray(r,R*3),f.fromArray(r,F*3),p.fromArray(o,P*2),v.fromArray(o,R*2),g.fromArray(o,F*2),d.sub(u),f.sub(u),v.sub(p),g.sub(p);let B=1/(v.x*g.y-g.x*v.y);!isFinite(B)||(m.copy(d).multiplyScalar(g.y).addScaledVector(f,-v.y).multiplyScalar(B),y.copy(f).multiplyScalar(v.x).addScaledVector(d,-g.x).multiplyScalar(B),c[P].add(m),c[R].add(m),c[F].add(m),h[P].add(y),h[R].add(y),h[F].add(y))}let b=this.groups;b.length===0&&(b=[{start:0,count:i.length}]);for(let P=0,R=b.length;P<R;++P){let F=b[P],B=F.start,k=F.count;for(let j=B,Z=B+k;j<Z;j+=3)w(i[j+0],i[j+1],i[j+2])}let A=new N,S=new N,T=new N,M=new N;function E(P){T.fromArray(s,P*3),M.copy(T);let R=c[P];A.copy(R),A.sub(T.multiplyScalar(T.dot(R))).normalize(),S.crossVectors(M,R);let F=S.dot(h[P])<0?-1:1;l[P*4]=A.x,l[P*4+1]=A.y,l[P*4+2]=A.z,l[P*4+3]=F}for(let P=0,R=b.length;P<R;++P){let F=b[P],B=F.start,k=F.count;for(let j=B,Z=B+k;j<Z;j+=3)E(i[j+0]),E(i[j+1]),E(i[j+2])}}computeVertexNormals(){let e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Ut(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let d=0,f=i.count;d<f;d++)i.setXYZ(d,0,0,0);let r=new N,s=new N,o=new N,a=new N,l=new N,c=new N,h=new N,u=new N;if(e)for(let d=0,f=e.count;d<f;d+=3){let p=e.getX(d+0),v=e.getX(d+1),g=e.getX(d+2);r.fromBufferAttribute(n,p),s.fromBufferAttribute(n,v),o.fromBufferAttribute(n,g),h.subVectors(o,s),u.subVectors(r,s),h.cross(u),a.fromBufferAttribute(i,p),l.fromBufferAttribute(i,v),c.fromBufferAttribute(i,g),a.add(h),l.add(h),c.add(h),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(v,l.x,l.y,l.z),i.setXYZ(g,c.x,c.y,c.z)}else for(let d=0,f=n.count;d<f;d+=3)r.fromBufferAttribute(n,d+0),s.fromBufferAttribute(n,d+1),o.fromBufferAttribute(n,d+2),h.subVectors(o,s),u.subVectors(r,s),h.cross(u),i.setXYZ(d+0,h.x,h.y,h.z),i.setXYZ(d+1,h.x,h.y,h.z),i.setXYZ(d+2,h.x,h.y,h.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)dr.fromBufferAttribute(e,n),dr.normalize(),e.setXYZ(n,dr.x,dr.y,dr.z)}toNonIndexed(){function e(a,l){let c=a.array,h=a.itemSize,u=a.normalized,d=new c.constructor(l.length*h),f=0,p=0;for(let v=0,g=l.length;v<g;v++){a.isInterleavedBufferAttribute?f=l[v]*a.data.stride+a.offset:f=l[v]*h;for(let m=0;m<h;m++)d[p++]=c[f++]}return new Ut(d,h,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let n=new Lt,i=this.index.array,r=this.attributes;for(let a in r){let l=r[a],c=e(l,i);n.setAttribute(a,c)}let s=this.morphAttributes;for(let a in s){let l=[],c=s[a];for(let h=0,u=c.length;h<u;h++){let d=c[h],f=e(d,i);l.push(f)}n.morphAttributes[a]=l}n.morphTargetsRelative=this.morphTargetsRelative;let o=this.groups;for(let a=0,l=o.length;a<l;a++){let c=o[a];n.addGroup(c.start,c.count,c.materialIndex)}return n}toJSON(){let e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let l=this.parameters;for(let c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};let n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});let i=this.attributes;for(let l in i){let c=i[l];e.data.attributes[l]=c.toJSON(e.data)}let r={},s=!1;for(let l in this.morphAttributes){let c=this.morphAttributes[l],h=[];for(let u=0,d=c.length;u<d;u++){let f=c[u];h.push(f.toJSON(e.data))}h.length>0&&(r[l]=h,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);let o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));let a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let n={};this.name=e.name;let i=e.index;i!==null&&this.setIndex(i.clone(n));let r=e.attributes;for(let c in r){let h=r[c];this.setAttribute(c,h.clone(n))}let s=e.morphAttributes;for(let c in s){let h=[],u=s[c];for(let d=0,f=u.length;d<f;d++)h.push(u[d].clone(n));this.morphAttributes[c]=h}this.morphTargetsRelative=e.morphTargetsRelative;let o=e.groups;for(let c=0,h=o.length;c<h;c++){let u=o[c];this.addGroup(u.start,u.count,u.materialIndex)}let a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());let l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},fV=new nt,Zp=new yv,o2=new ha,E0=new N,C0=new N,T0=new N,a2=new N,ub=new N,hb=new be,db=new be,fb=new be,l2=new N,pb=new N,uo=class extends Nn{constructor(t=new Lt,e=new N1){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){let t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){let n=t[e[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,r=n.length;i<r;i++){let s=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=i}}}}getVertexPosition(t,e){let n=this.geometry,i=n.attributes.position,r=n.morphAttributes.position,s=n.morphTargetsRelative;e.fromBufferAttribute(i,t);let o=this.morphTargetInfluences;if(r&&o){ub.set(0,0,0);for(let a=0,l=r.length;a<l;a++){let c=o[a],h=r[a];c!==0&&(a2.fromBufferAttribute(h,t),s?ub.addScaledVector(a2,c):ub.addScaledVector(a2.sub(e),c))}e.add(ub)}return this.isSkinnedMesh&&this.boneTransform(t,e),e}raycast(t,e){let n=this.geometry,i=this.material,r=this.matrixWorld;if(i===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),o2.copy(n.boundingSphere),o2.applyMatrix4(r),t.ray.intersectsSphere(o2)===!1)||(fV.copy(r).invert(),Zp.copy(t.ray).applyMatrix4(fV),n.boundingBox!==null&&Zp.intersectsBox(n.boundingBox)===!1))return;let s,o=n.index,a=n.attributes.position,l=n.attributes.uv,c=n.attributes.uv2,h=n.groups,u=n.drawRange;if(o!==null)if(Array.isArray(i))for(let d=0,f=h.length;d<f;d++){let p=h[d],v=i[p.materialIndex],g=Math.max(p.start,u.start),m=Math.min(o.count,Math.min(p.start+p.count,u.start+u.count));for(let y=g,w=m;y<w;y+=3){let b=o.getX(y),A=o.getX(y+1),S=o.getX(y+2);s=mb(this,v,t,Zp,l,c,b,A,S),s&&(s.faceIndex=Math.floor(y/3),s.face.materialIndex=p.materialIndex,e.push(s))}}else{let d=Math.max(0,u.start),f=Math.min(o.count,u.start+u.count);for(let p=d,v=f;p<v;p+=3){let g=o.getX(p),m=o.getX(p+1),y=o.getX(p+2);s=mb(this,i,t,Zp,l,c,g,m,y),s&&(s.faceIndex=Math.floor(p/3),e.push(s))}}else if(a!==void 0)if(Array.isArray(i))for(let d=0,f=h.length;d<f;d++){let p=h[d],v=i[p.materialIndex],g=Math.max(p.start,u.start),m=Math.min(a.count,Math.min(p.start+p.count,u.start+u.count));for(let y=g,w=m;y<w;y+=3){let b=y,A=y+1,S=y+2;s=mb(this,v,t,Zp,l,c,b,A,S),s&&(s.faceIndex=Math.floor(y/3),s.face.materialIndex=p.materialIndex,e.push(s))}}else{let d=Math.max(0,u.start),f=Math.min(a.count,u.start+u.count);for(let p=d,v=f;p<v;p+=3){let g=p,m=p+1,y=p+2;s=mb(this,i,t,Zp,l,c,g,m,y),s&&(s.faceIndex=Math.floor(p/3),e.push(s))}}}};function g1e(t,e,n,i,r,s,o,a){let l;if(e.side===xr?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===el,a),l===null)return null;pb.copy(a),pb.applyMatrix4(t.matrixWorld);let c=n.ray.origin.distanceTo(pb);return c<n.near||c>n.far?null:{distance:c,point:pb.clone(),object:t}}function mb(t,e,n,i,r,s,o,a,l){t.getVertexPosition(o,E0),t.getVertexPosition(a,C0),t.getVertexPosition(l,T0);let c=g1e(t,e,n,i,E0,C0,T0,l2);if(c){r&&(hb.fromBufferAttribute(r,o),db.fromBufferAttribute(r,a),fb.fromBufferAttribute(r,l),c.uv=Ds.getUV(l2,E0,C0,T0,hb,db,fb,new be)),s&&(hb.fromBufferAttribute(s,o),db.fromBufferAttribute(s,a),fb.fromBufferAttribute(s,l),c.uv2=Ds.getUV(l2,E0,C0,T0,hb,db,fb,new be));let h={a:o,b:a,c:l,normal:new N,materialIndex:0};Ds.getNormal(E0,C0,T0,h.normal),c.face=h}return c}var nc=class extends Lt{constructor(t=1,e=1,n=1,i=1,r=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:s};let o=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s);let a=[],l=[],c=[],h=[],u=0,d=0;f("z","y","x",-1,-1,n,e,t,s,r,0),f("z","y","x",1,-1,n,e,-t,s,r,1),f("x","z","y",1,1,t,n,e,i,s,2),f("x","z","y",1,-1,t,n,-e,i,s,3),f("x","y","z",1,-1,t,e,n,i,r,4),f("x","y","z",-1,-1,t,e,-n,i,r,5),this.setIndex(a),this.setAttribute("position",new ft(l,3)),this.setAttribute("normal",new ft(c,3)),this.setAttribute("uv",new ft(h,2));function f(p,v,g,m,y,w,b,A,S,T,M){let E=w/S,P=b/T,R=w/2,F=b/2,B=A/2,k=S+1,j=T+1,Z=0,ee=0,O=new N;for(let W=0;W<j;W++){let H=W*P-F;for(let Y=0;Y<k;Y++){let z=Y*E-R;O[p]=z*m,O[v]=H*y,O[g]=B,l.push(O.x,O.y,O.z),O[p]=0,O[v]=0,O[g]=A>0?1:-1,c.push(O.x,O.y,O.z),h.push(Y/S),h.push(1-W/T),Z+=1}}for(let W=0;W<T;W++)for(let H=0;H<S;H++){let Y=u+H+k*W,z=u+H+k*(W+1),X=u+(H+1)+k*(W+1),q=u+(H+1)+k*W;a.push(Y,z,q),a.push(z,X,q),ee+=6}o.addGroup(d,ee,M),d+=ee,u+=Z}}static fromJSON(t){return new nc(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}};function Yg(t){let e={};for(let n in t){e[n]={};for(let i in t[n]){let r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function us(t){let e={};for(let n=0;n<t.length;n++){let i=Yg(t[n]);for(let r in i)e[r]=i[r]}return e}function v1e(t){let e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function eK(t){return t.getRenderTarget()===null&&t.outputEncoding===Wt?Ll:LA}var xv={clone:Yg,merge:us},y1e=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,x1e=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,ir=class extends F1{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=y1e,this.fragmentShader=x1e,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Yg(t.uniforms),this.uniformsGroups=v1e(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){let e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(let i in this.uniforms){let r=this.uniforms[i].value;r&&r.isTexture?e.uniforms[i]={type:"t",value:r.toJSON(t).uuid}:r&&r.isColor?e.uniforms[i]={type:"c",value:r.getHex()}:r&&r.isVector2?e.uniforms[i]={type:"v2",value:r.toArray()}:r&&r.isVector3?e.uniforms[i]={type:"v3",value:r.toArray()}:r&&r.isVector4?e.uniforms[i]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?e.uniforms[i]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?e.uniforms[i]={type:"m4",value:r.toArray()}:e.uniforms[i]={value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;let n={};for(let i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}},wv=class extends Nn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new nt,this.projectionMatrix=new nt,this.projectionMatrixInverse=new nt}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},Qr=class extends wv{constructor(t=50,e=1,n=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){let e=.5*this.getFilmHeight()/t;this.fov=Ix*2*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){let t=Math.tan(Iy*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return Ix*2*Math.atan(Math.tan(Iy*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,i,r,s){this.aspect=t/e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let t=this.near,e=t*Math.tan(Iy*.5*this.fov)/this.zoom,n=2*e,i=this.aspect*n,r=-.5*i,s=this.view;if(this.view!==null&&this.view.enabled){let a=s.fullWidth,l=s.fullHeight;r+=s.offsetX*i/a,e-=s.offsetY*n/l,i*=s.width/a,n*=s.height/l}let o=this.filmOffset;o!==0&&(r+=t*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){let e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}},$p=-90,em=1,w1e=class extends Nn{constructor(t,e,n){super(),this.type="CubeCamera",this.renderTarget=n;let i=new Qr($p,em,t,e);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(1,0,0),this.add(i);let r=new Qr($p,em,t,e);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(-1,0,0),this.add(r);let s=new Qr($p,em,t,e);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);let o=new Qr($p,em,t,e);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(0,-1,0),this.add(o);let a=new Qr($p,em,t,e);a.layers=this.layers,a.up.set(0,1,0),a.lookAt(0,0,1),this.add(a);let l=new Qr($p,em,t,e);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(t,e){this.parent===null&&this.updateMatrixWorld();let n=this.renderTarget,[i,r,s,o,a,l]=this.children,c=t.getRenderTarget(),h=t.toneMapping,u=t.xr.enabled;t.toneMapping=Zc,t.xr.enabled=!1;let d=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,i),t.setRenderTarget(n,1),t.render(e,r),t.setRenderTarget(n,2),t.render(e,s),t.setRenderTarget(n,3),t.render(e,o),t.setRenderTarget(n,4),t.render(e,a),n.texture.generateMipmaps=d,t.setRenderTarget(n,5),t.render(e,l),t.setRenderTarget(c),t.toneMapping=h,t.xr.enabled=u,n.texture.needsPMREMUpdate=!0}},NO=class extends br{constructor(t,e,n,i,r,s,o,a,l,c){t=t!==void 0?t:[],e=e!==void 0?e:Ff,super(t,e,n,i,r,s,o,a,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}},_1e=class extends er{constructor(t=1,e={}){super(t,t,e),this.isWebGLCubeRenderTarget=!0;let n={width:t,height:t,depth:1},i=[n,n,n,n,n,n];this.texture=new NO(i,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=e.generateMipmaps!==void 0?e.generateMipmaps:!1,this.texture.minFilter=e.minFilter!==void 0?e.minFilter:En}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;let n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new nc(5,5,5),r=new ir({name:"CubemapFromEquirect",uniforms:Yg(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:xr,blending:Ir});r.uniforms.tEquirect.value=e;let s=new uo(i,r),o=e.minFilter;return e.minFilter===Xg&&(e.minFilter=En),new w1e(1,10,this).update(t,s),e.minFilter=o,s.geometry.dispose(),s.material.dispose(),this}clear(t,e,n,i){let r=t.getRenderTarget();for(let s=0;s<6;s++)t.setRenderTarget(this,s),t.clear(e,n,i);t.setRenderTarget(r)}},c2=new N,b1e=new N,S1e=new Rr,no=class{constructor(t=new N(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){let i=c2.subVectors(n,e).cross(b1e.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){let t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){let n=t.delta(c2),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(t.start)===0?e.copy(t.start):null;let r=-(t.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:e.copy(n).multiplyScalar(r).add(t.start)}intersectsLine(t){let e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){let n=e||S1e.getNormalMatrix(t),i=this.coplanarPoint(c2).applyMatrix4(t),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}},tm=new ha,gb=new N,UO=class{constructor(t=new no,e=new no,n=new no,i=new no,r=new no,s=new no){this.planes=[t,e,n,i,r,s]}set(t,e,n,i,r,s){let o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(n),o[3].copy(i),o[4].copy(r),o[5].copy(s),this}copy(t){let e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){let e=this.planes,n=t.elements,i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],l=n[5],c=n[6],h=n[7],u=n[8],d=n[9],f=n[10],p=n[11],v=n[12],g=n[13],m=n[14],y=n[15];return e[0].setComponents(o-i,h-a,p-u,y-v).normalize(),e[1].setComponents(o+i,h+a,p+u,y+v).normalize(),e[2].setComponents(o+r,h+l,p+d,y+g).normalize(),e[3].setComponents(o-r,h-l,p-d,y-g).normalize(),e[4].setComponents(o-s,h-c,p-f,y-m).normalize(),e[5].setComponents(o+s,h+c,p+f,y+m).normalize(),this}intersectsObject(t){let e=t.geometry;return e.boundingSphere===null&&e.computeBoundingSphere(),tm.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(tm)}intersectsSprite(t){return tm.center.set(0,0,0),tm.radius=.7071067811865476,tm.applyMatrix4(t.matrixWorld),this.intersectsSphere(tm)}intersectsSphere(t){let e=this.planes,n=t.center,i=-t.radius;for(let r=0;r<6;r++)if(e[r].distanceToPoint(n)<i)return!1;return!0}intersectsBox(t){let e=this.planes;for(let n=0;n<6;n++){let i=e[n];if(gb.x=i.normal.x>0?t.max.x:t.min.x,gb.y=i.normal.y>0?t.max.y:t.min.y,gb.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(gb)<0)return!1}return!0}containsPoint(t){let e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function tK(){let t=null,e=!1,n=null,i=null;function r(s,o){n(s,o),i=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&n!==null&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){n=s},setContext:function(s){t=s}}}function A1e(t,e){let n=e.isWebGL2,i=new WeakMap;function r(c,h){let u=c.array,d=c.usage,f=t.createBuffer();t.bindBuffer(h,f),t.bufferData(h,u,d),c.onUploadCallback();let p;if(u instanceof Float32Array)p=5126;else if(u instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(n)p=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else p=5123;else if(u instanceof Int16Array)p=5122;else if(u instanceof Uint32Array)p=5125;else if(u instanceof Int32Array)p=5124;else if(u instanceof Int8Array)p=5120;else if(u instanceof Uint8Array)p=5121;else if(u instanceof Uint8ClampedArray)p=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:f,type:p,bytesPerElement:u.BYTES_PER_ELEMENT,version:c.version}}function s(c,h,u){let d=h.array,f=h.updateRange;t.bindBuffer(u,c),f.count===-1?t.bufferSubData(u,0,d):(n?t.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):t.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1),h.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);let h=i.get(c);h&&(t.deleteBuffer(h.buffer),i.delete(c))}function l(c,h){if(c.isGLBufferAttribute){let d=i.get(c);(!d||d.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);let u=i.get(c);u===void 0?i.set(c,r(c,h)):u.version<c.version&&(s(u.buffer,c,h),u.version=c.version)}return{get:o,remove:a,update:l}}var wE=class extends Lt{constructor(t=1,e=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};let r=t/2,s=e/2,o=Math.floor(n),a=Math.floor(i),l=o+1,c=a+1,h=t/o,u=e/a,d=[],f=[],p=[],v=[];for(let g=0;g<c;g++){let m=g*u-s;for(let y=0;y<l;y++){let w=y*h-r;f.push(w,-m,0),p.push(0,0,1),v.push(y/o),v.push(1-g/a)}}for(let g=0;g<a;g++)for(let m=0;m<o;m++){let y=m+l*g,w=m+l*(g+1),b=m+1+l*(g+1),A=m+1+l*g;d.push(y,w,A),d.push(w,b,A)}this.setIndex(d),this.setAttribute("position",new ft(f,3)),this.setAttribute("normal",new ft(p,3)),this.setAttribute("uv",new ft(v,2))}static fromJSON(t){return new wE(t.width,t.height,t.widthSegments,t.heightSegments)}},M1e=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,E1e=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,C1e=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,T1e=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,P1e=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,D1e=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,R1e="vec3 transformed = vec3( position );",L1e=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,I1e=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,B1e=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,O1e=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,F1e=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,N1e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,U1e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,k1e=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,z1e=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,G1e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,H1e=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,V1e=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,j1e=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,W1e=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,X1e=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Y1e=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,q1e=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,Q1e=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,K1e=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,J1e="gl_FragColor = linearToOutputTexel( gl_FragColor );",Z1e=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,$1e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,ewe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,twe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,nwe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,iwe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,rwe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,swe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,owe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,awe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,lwe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,cwe=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,uwe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,hwe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,dwe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,fwe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,pwe=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,mwe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,gwe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,vwe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,ywe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,xwe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,wwe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,_we=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,bwe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Swe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,Awe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Mwe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Ewe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Cwe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Twe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Pwe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Dwe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Rwe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Lwe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Iwe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Bwe=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Owe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Fwe=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Nwe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Uwe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,kwe=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,zwe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Gwe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Hwe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Vwe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,jwe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,Wwe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,Xwe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,Ywe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,qwe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Qwe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,Kwe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Jwe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Zwe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,$we=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,e_e=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,t_e=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,n_e=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,i_e=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,r_e=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,s_e=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,o_e=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,a_e=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,l_e=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,c_e=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,u_e=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,h_e=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,d_e=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,f_e=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,p_e=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,m_e=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,g_e=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,v_e=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,y_e=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,x_e=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,w_e=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,__e=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,b_e=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,S_e=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,A_e=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,M_e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,E_e=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,C_e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,T_e=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,P_e=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,D_e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,R_e=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,L_e=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,I_e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,B_e=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,O_e=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,F_e=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,N_e=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,U_e=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,k_e=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,z_e=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,G_e=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,H_e=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,V_e=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,j_e=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,W_e=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,X_e=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Y_e=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,q_e=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Q_e=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,K_e=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,J_e=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Z_e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,$_e=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ebe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,tbe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,nbe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,jt={alphamap_fragment:M1e,alphamap_pars_fragment:E1e,alphatest_fragment:C1e,alphatest_pars_fragment:T1e,aomap_fragment:P1e,aomap_pars_fragment:D1e,begin_vertex:R1e,beginnormal_vertex:L1e,bsdfs:I1e,iridescence_fragment:B1e,bumpmap_pars_fragment:O1e,clipping_planes_fragment:F1e,clipping_planes_pars_fragment:N1e,clipping_planes_pars_vertex:U1e,clipping_planes_vertex:k1e,color_fragment:z1e,color_pars_fragment:G1e,color_pars_vertex:H1e,color_vertex:V1e,common:j1e,cube_uv_reflection_fragment:W1e,defaultnormal_vertex:X1e,displacementmap_pars_vertex:Y1e,displacementmap_vertex:q1e,emissivemap_fragment:Q1e,emissivemap_pars_fragment:K1e,encodings_fragment:J1e,encodings_pars_fragment:Z1e,envmap_fragment:$1e,envmap_common_pars_fragment:ewe,envmap_pars_fragment:twe,envmap_pars_vertex:nwe,envmap_physical_pars_fragment:pwe,envmap_vertex:iwe,fog_vertex:rwe,fog_pars_vertex:swe,fog_fragment:owe,fog_pars_fragment:awe,gradientmap_pars_fragment:lwe,lightmap_fragment:cwe,lightmap_pars_fragment:uwe,lights_lambert_fragment:hwe,lights_lambert_pars_fragment:dwe,lights_pars_begin:fwe,lights_toon_fragment:mwe,lights_toon_pars_fragment:gwe,lights_phong_fragment:vwe,lights_phong_pars_fragment:ywe,lights_physical_fragment:xwe,lights_physical_pars_fragment:wwe,lights_fragment_begin:_we,lights_fragment_maps:bwe,lights_fragment_end:Swe,logdepthbuf_fragment:Awe,logdepthbuf_pars_fragment:Mwe,logdepthbuf_pars_vertex:Ewe,logdepthbuf_vertex:Cwe,map_fragment:Twe,map_pars_fragment:Pwe,map_particle_fragment:Dwe,map_particle_pars_fragment:Rwe,metalnessmap_fragment:Lwe,metalnessmap_pars_fragment:Iwe,morphcolor_vertex:Bwe,morphnormal_vertex:Owe,morphtarget_pars_vertex:Fwe,morphtarget_vertex:Nwe,normal_fragment_begin:Uwe,normal_fragment_maps:kwe,normal_pars_fragment:zwe,normal_pars_vertex:Gwe,normal_vertex:Hwe,normalmap_pars_fragment:Vwe,clearcoat_normal_fragment_begin:jwe,clearcoat_normal_fragment_maps:Wwe,clearcoat_pars_fragment:Xwe,iridescence_pars_fragment:Ywe,output_fragment:qwe,packing:Qwe,premultiplied_alpha_fragment:Kwe,project_vertex:Jwe,dithering_fragment:Zwe,dithering_pars_fragment:$we,roughnessmap_fragment:e_e,roughnessmap_pars_fragment:t_e,shadowmap_pars_fragment:n_e,shadowmap_pars_vertex:i_e,shadowmap_vertex:r_e,shadowmask_pars_fragment:s_e,skinbase_vertex:o_e,skinning_pars_vertex:a_e,skinning_vertex:l_e,skinnormal_vertex:c_e,specularmap_fragment:u_e,specularmap_pars_fragment:h_e,tonemapping_fragment:d_e,tonemapping_pars_fragment:f_e,transmission_fragment:p_e,transmission_pars_fragment:m_e,uv_pars_fragment:g_e,uv_pars_vertex:v_e,uv_vertex:y_e,uv2_pars_fragment:x_e,uv2_pars_vertex:w_e,uv2_vertex:__e,worldpos_vertex:b_e,background_vert:S_e,background_frag:A_e,backgroundCube_vert:M_e,backgroundCube_frag:E_e,cube_vert:C_e,cube_frag:T_e,depth_vert:P_e,depth_frag:D_e,distanceRGBA_vert:R_e,distanceRGBA_frag:L_e,equirect_vert:I_e,equirect_frag:B_e,linedashed_vert:O_e,linedashed_frag:F_e,meshbasic_vert:N_e,meshbasic_frag:U_e,meshlambert_vert:k_e,meshlambert_frag:z_e,meshmatcap_vert:G_e,meshmatcap_frag:H_e,meshnormal_vert:V_e,meshnormal_frag:j_e,meshphong_vert:W_e,meshphong_frag:X_e,meshphysical_vert:Y_e,meshphysical_frag:q_e,meshtoon_vert:Q_e,meshtoon_frag:K_e,points_vert:J_e,points_frag:Z_e,shadow_vert:$_e,shadow_frag:ebe,sprite_vert:tbe,sprite_frag:nbe},tt={common:{diffuse:{value:new Rt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Rr},uv2Transform:{value:new Rr},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new be(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Rt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Rt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Rr}},sprite:{diffuse:{value:new Rt(16777215)},opacity:{value:1},center:{value:new be(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Rr}}},Il={basic:{uniforms:us([tt.common,tt.specularmap,tt.envmap,tt.aomap,tt.lightmap,tt.fog]),vertexShader:jt.meshbasic_vert,fragmentShader:jt.meshbasic_frag},lambert:{uniforms:us([tt.common,tt.specularmap,tt.envmap,tt.aomap,tt.lightmap,tt.emissivemap,tt.bumpmap,tt.normalmap,tt.displacementmap,tt.fog,tt.lights,{emissive:{value:new Rt(0)}}]),vertexShader:jt.meshlambert_vert,fragmentShader:jt.meshlambert_frag},phong:{uniforms:us([tt.common,tt.specularmap,tt.envmap,tt.aomap,tt.lightmap,tt.emissivemap,tt.bumpmap,tt.normalmap,tt.displacementmap,tt.fog,tt.lights,{emissive:{value:new Rt(0)},specular:{value:new Rt(1118481)},shininess:{value:30}}]),vertexShader:jt.meshphong_vert,fragmentShader:jt.meshphong_frag},standard:{uniforms:us([tt.common,tt.envmap,tt.aomap,tt.lightmap,tt.emissivemap,tt.bumpmap,tt.normalmap,tt.displacementmap,tt.roughnessmap,tt.metalnessmap,tt.fog,tt.lights,{emissive:{value:new Rt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:jt.meshphysical_vert,fragmentShader:jt.meshphysical_frag},toon:{uniforms:us([tt.common,tt.aomap,tt.lightmap,tt.emissivemap,tt.bumpmap,tt.normalmap,tt.displacementmap,tt.gradientmap,tt.fog,tt.lights,{emissive:{value:new Rt(0)}}]),vertexShader:jt.meshtoon_vert,fragmentShader:jt.meshtoon_frag},matcap:{uniforms:us([tt.common,tt.bumpmap,tt.normalmap,tt.displacementmap,tt.fog,{matcap:{value:null}}]),vertexShader:jt.meshmatcap_vert,fragmentShader:jt.meshmatcap_frag},points:{uniforms:us([tt.points,tt.fog]),vertexShader:jt.points_vert,fragmentShader:jt.points_frag},dashed:{uniforms:us([tt.common,tt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:jt.linedashed_vert,fragmentShader:jt.linedashed_frag},depth:{uniforms:us([tt.common,tt.displacementmap]),vertexShader:jt.depth_vert,fragmentShader:jt.depth_frag},normal:{uniforms:us([tt.common,tt.bumpmap,tt.normalmap,tt.displacementmap,{opacity:{value:1}}]),vertexShader:jt.meshnormal_vert,fragmentShader:jt.meshnormal_frag},sprite:{uniforms:us([tt.sprite,tt.fog]),vertexShader:jt.sprite_vert,fragmentShader:jt.sprite_frag},background:{uniforms:{uvTransform:{value:new Rr},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:jt.background_vert,fragmentShader:jt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:jt.backgroundCube_vert,fragmentShader:jt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:jt.cube_vert,fragmentShader:jt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:jt.equirect_vert,fragmentShader:jt.equirect_frag},distanceRGBA:{uniforms:us([tt.common,tt.displacementmap,{referencePosition:{value:new N},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:jt.distanceRGBA_vert,fragmentShader:jt.distanceRGBA_frag},shadow:{uniforms:us([tt.lights,tt.fog,{color:{value:new Rt(0)},opacity:{value:1}}]),vertexShader:jt.shadow_vert,fragmentShader:jt.shadow_frag}};Il.physical={uniforms:us([Il.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new be(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Rt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new be},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Rt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Rt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:jt.meshphysical_vert,fragmentShader:jt.meshphysical_frag};var vb={r:0,b:0,g:0};function ibe(t,e,n,i,r,s,o){let a=new Rt(0),l=s===!0?0:1,c,h,u=null,d=0,f=null;function p(g,m){let y=!1,w=m.isScene===!0?m.background:null;w&&w.isTexture&&(w=(m.backgroundBlurriness>0?n:e).get(w));let b=t.xr,A=b.getSession&&b.getSession();A&&A.environmentBlendMode==="additive"&&(w=null),w===null?v(a,l):w&&w.isColor&&(v(w,1),y=!0),(t.autoClear||y)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),w&&(w.isCubeTexture||w.mapping===O1)?(h===void 0&&(h=new uo(new nc(1,1,1),new ir({name:"BackgroundCubeMaterial",uniforms:Yg(Il.backgroundCube.uniforms),vertexShader:Il.backgroundCube.vertexShader,fragmentShader:Il.backgroundCube.fragmentShader,side:xr,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(S,T,M){this.matrixWorld.copyPosition(M.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(h)),h.material.uniforms.envMap.value=w,h.material.uniforms.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,h.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,h.material.toneMapped=w.encoding!==Wt,(u!==w||d!==w.version||f!==t.toneMapping)&&(h.material.needsUpdate=!0,u=w,d=w.version,f=t.toneMapping),h.layers.enableAll(),g.unshift(h,h.geometry,h.material,0,0,null)):w&&w.isTexture&&(c===void 0&&(c=new uo(new wE(2,2),new ir({name:"BackgroundMaterial",uniforms:Yg(Il.background.uniforms),vertexShader:Il.background.vertexShader,fragmentShader:Il.background.fragmentShader,side:el,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=w,c.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,c.material.toneMapped=w.encoding!==Wt,w.matrixAutoUpdate===!0&&w.updateMatrix(),c.material.uniforms.uvTransform.value.copy(w.matrix),(u!==w||d!==w.version||f!==t.toneMapping)&&(c.material.needsUpdate=!0,u=w,d=w.version,f=t.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}function v(g,m){g.getRGB(vb,eK(t)),i.buffers.color.setClear(vb.r,vb.g,vb.b,m,o)}return{getClearColor:function(){return a},setClearColor:function(g,m=1){a.set(g),l=m,v(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,v(a,l)},render:p}}function rbe(t,e,n,i){let r=t.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||s!==null,a={},l=g(null),c=l,h=!1;function u(k,j,Z,ee,O){let W=!1;if(o){let H=v(ee,Z,j);c!==H&&(c=H,f(c.object)),W=m(k,ee,Z,O),W&&y(k,ee,Z,O)}else{let H=j.wireframe===!0;(c.geometry!==ee.id||c.program!==Z.id||c.wireframe!==H)&&(c.geometry=ee.id,c.program=Z.id,c.wireframe=H,W=!0)}O!==null&&n.update(O,34963),(W||h)&&(h=!1,M(k,j,Z,ee),O!==null&&t.bindBuffer(34963,n.get(O).buffer))}function d(){return i.isWebGL2?t.createVertexArray():s.createVertexArrayOES()}function f(k){return i.isWebGL2?t.bindVertexArray(k):s.bindVertexArrayOES(k)}function p(k){return i.isWebGL2?t.deleteVertexArray(k):s.deleteVertexArrayOES(k)}function v(k,j,Z){let ee=Z.wireframe===!0,O=a[k.id];O===void 0&&(O={},a[k.id]=O);let W=O[j.id];W===void 0&&(W={},O[j.id]=W);let H=W[ee];return H===void 0&&(H=g(d()),W[ee]=H),H}function g(k){let j=[],Z=[],ee=[];for(let O=0;O<r;O++)j[O]=0,Z[O]=0,ee[O]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:j,enabledAttributes:Z,attributeDivisors:ee,object:k,attributes:{},index:null}}function m(k,j,Z,ee){let O=c.attributes,W=j.attributes,H=0,Y=Z.getAttributes();for(let z in Y)if(Y[z].location>=0){let X=O[z],q=W[z];if(q===void 0&&(z==="instanceMatrix"&&k.instanceMatrix&&(q=k.instanceMatrix),z==="instanceColor"&&k.instanceColor&&(q=k.instanceColor)),X===void 0||X.attribute!==q||q&&X.data!==q.data)return!0;H++}return c.attributesNum!==H||c.index!==ee}function y(k,j,Z,ee){let O={},W=j.attributes,H=0,Y=Z.getAttributes();for(let z in Y)if(Y[z].location>=0){let X=W[z];X===void 0&&(z==="instanceMatrix"&&k.instanceMatrix&&(X=k.instanceMatrix),z==="instanceColor"&&k.instanceColor&&(X=k.instanceColor));let q={};q.attribute=X,X&&X.data&&(q.data=X.data),O[z]=q,H++}c.attributes=O,c.attributesNum=H,c.index=ee}function w(){let k=c.newAttributes;for(let j=0,Z=k.length;j<Z;j++)k[j]=0}function b(k){A(k,0)}function A(k,j){let Z=c.newAttributes,ee=c.enabledAttributes,O=c.attributeDivisors;Z[k]=1,ee[k]===0&&(t.enableVertexAttribArray(k),ee[k]=1),O[k]!==j&&((i.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](k,j),O[k]=j)}function S(){let k=c.newAttributes,j=c.enabledAttributes;for(let Z=0,ee=j.length;Z<ee;Z++)j[Z]!==k[Z]&&(t.disableVertexAttribArray(Z),j[Z]=0)}function T(k,j,Z,ee,O,W){i.isWebGL2===!0&&(Z===5124||Z===5125)?t.vertexAttribIPointer(k,j,Z,O,W):t.vertexAttribPointer(k,j,Z,ee,O,W)}function M(k,j,Z,ee){if(i.isWebGL2===!1&&(k.isInstancedMesh||ee.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;w();let O=ee.attributes,W=Z.getAttributes(),H=j.defaultAttributeValues;for(let Y in W){let z=W[Y];if(z.location>=0){let X=O[Y];if(X===void 0&&(Y==="instanceMatrix"&&k.instanceMatrix&&(X=k.instanceMatrix),Y==="instanceColor"&&k.instanceColor&&(X=k.instanceColor)),X!==void 0){let q=X.normalized,re=X.itemSize,G=n.get(X);if(G===void 0)continue;let K=G.buffer,oe=G.type,ve=G.bytesPerElement;if(X.isInterleavedBufferAttribute){let $=X.data,se=$.stride,ne=X.offset;if($.isInstancedInterleavedBuffer){for(let ie=0;ie<z.locationSize;ie++)A(z.location+ie,$.meshPerAttribute);k.isInstancedMesh!==!0&&ee._maxInstanceCount===void 0&&(ee._maxInstanceCount=$.meshPerAttribute*$.count)}else for(let ie=0;ie<z.locationSize;ie++)b(z.location+ie);t.bindBuffer(34962,K);for(let ie=0;ie<z.locationSize;ie++)T(z.location+ie,re/z.locationSize,oe,q,se*ve,(ne+re/z.locationSize*ie)*ve)}else{if(X.isInstancedBufferAttribute){for(let $=0;$<z.locationSize;$++)A(z.location+$,X.meshPerAttribute);k.isInstancedMesh!==!0&&ee._maxInstanceCount===void 0&&(ee._maxInstanceCount=X.meshPerAttribute*X.count)}else for(let $=0;$<z.locationSize;$++)b(z.location+$);t.bindBuffer(34962,K);for(let $=0;$<z.locationSize;$++)T(z.location+$,re/z.locationSize,oe,q,re*ve,re/z.locationSize*$*ve)}}else if(H!==void 0){let q=H[Y];if(q!==void 0)switch(q.length){case 2:t.vertexAttrib2fv(z.location,q);break;case 3:t.vertexAttrib3fv(z.location,q);break;case 4:t.vertexAttrib4fv(z.location,q);break;default:t.vertexAttrib1fv(z.location,q)}}}}S()}function E(){F();for(let k in a){let j=a[k];for(let Z in j){let ee=j[Z];for(let O in ee)p(ee[O].object),delete ee[O];delete j[Z]}delete a[k]}}function P(k){if(a[k.id]===void 0)return;let j=a[k.id];for(let Z in j){let ee=j[Z];for(let O in ee)p(ee[O].object),delete ee[O];delete j[Z]}delete a[k.id]}function R(k){for(let j in a){let Z=a[j];if(Z[k.id]===void 0)continue;let ee=Z[k.id];for(let O in ee)p(ee[O].object),delete ee[O];delete Z[k.id]}}function F(){B(),h=!0,c!==l&&(c=l,f(c.object))}function B(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:u,reset:F,resetDefaultState:B,dispose:E,releaseStatesOfGeometry:P,releaseStatesOfProgram:R,initAttributes:w,enableAttribute:b,disableUnusedAttributes:S}}function sbe(t,e,n,i){let r=i.isWebGL2,s;function o(c){s=c}function a(c,h){t.drawArrays(s,c,h),n.update(h,s,1)}function l(c,h,u){if(u===0)return;let d,f;if(r)d=t,f="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[f](s,c,h,u),n.update(h,s,u)}this.setMode=o,this.render=a,this.renderInstances=l}function obe(t,e,n){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){let T=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(T){if(T==="highp"){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";T="mediump"}return T==="mediump"&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let o=typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext,a=n.precision!==void 0?n.precision:"highp",l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);let c=o||e.has("WEBGL_draw_buffers"),h=n.logarithmicDepthBuffer===!0,u=t.getParameter(34930),d=t.getParameter(35660),f=t.getParameter(3379),p=t.getParameter(34076),v=t.getParameter(34921),g=t.getParameter(36347),m=t.getParameter(36348),y=t.getParameter(36349),w=d>0,b=o||e.has("OES_texture_float"),A=w&&b,S=o?t.getParameter(36183):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:h,maxTextures:u,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:v,maxVertexUniforms:g,maxVaryings:m,maxFragmentUniforms:y,vertexTextures:w,floatFragmentTextures:b,floatVertexTextures:A,maxSamples:S}}function abe(t){let e=this,n=null,i=0,r=!1,s=!1,o=new no,a=new Rr,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,d){let f=u.length!==0||d||i!==0||r;return r=d,i=u.length,f},this.beginShadows=function(){s=!0,h(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(u,d){n=h(u,d,0)},this.setState=function(u,d,f){let p=u.clippingPlanes,v=u.clipIntersection,g=u.clipShadows,m=t.get(u);if(!r||p===null||p.length===0||s&&!g)s?h(null):c();else{let y=s?0:i,w=y*4,b=m.clippingState||null;l.value=b,b=h(p,d,w,f);for(let A=0;A!==w;++A)b[A]=n[A];m.clippingState=b,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==n&&(l.value=n,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function h(u,d,f,p){let v=u!==null?u.length:0,g=null;if(v!==0){if(g=l.value,p!==!0||g===null){let m=f+v*4,y=d.matrixWorldInverse;a.getNormalMatrix(y),(g===null||g.length<m)&&(g=new Float32Array(m));for(let w=0,b=f;w!==v;++w,b+=4)o.copy(u[w]).applyMatrix4(y,a),o.normal.toArray(g,b),g[b+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=v,e.numIntersection=0,g}}function lbe(t){let e=new WeakMap;function n(o,a){return a===UL?o.mapping=Ff:a===kL&&(o.mapping=Nf),o}function i(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){let a=o.mapping;if(a===UL||a===kL)if(e.has(o)){let l=e.get(o).texture;return n(l,o.mapping)}else{let l=o.image;if(l&&l.height>0){let c=new _1e(l.height/2);return c.fromEquirectangularTexture(t,o),e.set(o,c),o.addEventListener("dispose",r),n(c.texture,o.mapping)}else return null}}return o}function r(o){let a=o.target;a.removeEventListener("dispose",r);let l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}var OA=class extends wv{constructor(t=-1,e=1,n=1,i=-1,r=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,e,n,i,r,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,r=n-t,s=n+t,o=i+e,a=i-e;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=l*this.view.offsetX,s=r+l*this.view.width,o-=c*this.view.offsetY,a=o-c*this.view.height}this.projectionMatrix.makeOrthographic(r,s,o,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){let e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}},Wm=4,pV=[.125,.215,.35,.446,.526,.582],Yd=20,u2=new OA,mV=new Rt,h2=null,Gd=(1+Math.sqrt(5))/2,nm=1/Gd,gV=[new N(1,1,1),new N(-1,1,1),new N(1,1,-1),new N(-1,1,-1),new N(0,Gd,nm),new N(0,Gd,-nm),new N(nm,0,Gd),new N(-nm,0,Gd),new N(Gd,nm,0),new N(-Gd,nm,0)],vV=class{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,n=.1,i=100){h2=this._renderer.getRenderTarget(),this._setSize(256);let r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(t,n,i,r),e>0&&this._blur(r,0,0,e),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=wV(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=xV(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(h2),t.scissorTest=!1,yb(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===Ff||t.mapping===Nf?this._setSize(t.image.length===0?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),h2=this._renderer.getRenderTarget();let n=e||this._allocateTargets();return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){let t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,n={magFilter:En,minFilter:En,generateMipmaps:!1,type:Lx,format:ka,encoding:tc,depthBuffer:!1},i=yV(t,e,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=yV(t,e,n);let{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=cbe(r)),this._blurMaterial=ube(r,t,e)}return i}_compileMaterial(t){let e=new uo(this._lodPlanes[0],t);this._renderer.compile(e,u2)}_sceneToCubeUV(t,e,n,i){let r=new Qr(90,1,e,n),s=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],a=this._renderer,l=a.autoClear,c=a.toneMapping;a.getClearColor(mV),a.toneMapping=Zc,a.autoClear=!1;let h=new N1({name:"PMREM.Background",side:xr,depthWrite:!1,depthTest:!1}),u=new uo(new nc,h),d=!1,f=t.background;f?f.isColor&&(h.color.copy(f),t.background=null,d=!0):(h.color.copy(mV),d=!0);for(let p=0;p<6;p++){let v=p%3;v===0?(r.up.set(0,s[p],0),r.lookAt(o[p],0,0)):v===1?(r.up.set(0,0,s[p]),r.lookAt(0,o[p],0)):(r.up.set(0,s[p],0),r.lookAt(0,0,o[p]));let g=this._cubeSize;yb(i,v*g,p>2?g:0,g,g),a.setRenderTarget(i),d&&a.render(u,r),a.render(t,r)}u.geometry.dispose(),u.material.dispose(),a.toneMapping=c,a.autoClear=l,t.background=f}_textureToCubeUV(t,e){let n=this._renderer,i=t.mapping===Ff||t.mapping===Nf;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=wV()),this._cubemapMaterial.uniforms.flipEnvMap.value=t.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=xV());let r=i?this._cubemapMaterial:this._equirectMaterial,s=new uo(this._lodPlanes[0],r),o=r.uniforms;o.envMap.value=t;let a=this._cubeSize;yb(e,0,0,3*a,2*a),n.setRenderTarget(e),n.render(s,u2)}_applyPMREM(t){let e=this._renderer,n=e.autoClear;e.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){let r=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),s=gV[(i-1)%gV.length];this._blur(t,i-1,i,r,s)}e.autoClear=n}_blur(t,e,n,i,r){let s=this._pingPongRenderTarget;this._halfBlur(t,s,e,n,i,"latitudinal",r),this._halfBlur(s,t,n,n,i,"longitudinal",r)}_halfBlur(t,e,n,i,r,s,o){let a=this._renderer,l=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let c=3,h=new uo(this._lodPlanes[i],l),u=l.uniforms,d=this._sizeLods[n]-1,f=isFinite(r)?Math.PI/(2*d):2*Math.PI/(2*Yd-1),p=r/f,v=isFinite(r)?1+Math.floor(c*p):Yd;v>Yd&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${v} samples when the maximum is set to ${Yd}`);let g=[],m=0;for(let S=0;S<Yd;++S){let T=S/p,M=Math.exp(-T*T/2);g.push(M),S===0?m+=M:S<v&&(m+=2*M)}for(let S=0;S<g.length;S++)g[S]=g[S]/m;u.envMap.value=t.texture,u.samples.value=v,u.weights.value=g,u.latitudinal.value=s==="latitudinal",o&&(u.poleAxis.value=o);let{_lodMax:y}=this;u.dTheta.value=f,u.mipInt.value=y-n;let w=this._sizeLods[i],b=3*w*(i>y-Wm?i-y+Wm:0),A=4*(this._cubeSize-w);yb(e,b,A,3*w,2*w),a.setRenderTarget(e),a.render(h,u2)}};function cbe(t){let e=[],n=[],i=[],r=t,s=t-Wm+1+pV.length;for(let o=0;o<s;o++){let a=Math.pow(2,r);n.push(a);let l=1/a;o>t-Wm?l=pV[o-t+Wm-1]:o===0&&(l=0),i.push(l);let c=1/(a-2),h=-c,u=1+c,d=[h,h,u,h,u,u,h,h,u,u,h,u],f=6,p=6,v=3,g=2,m=1,y=new Float32Array(v*p*f),w=new Float32Array(g*p*f),b=new Float32Array(m*p*f);for(let S=0;S<f;S++){let T=S%3*2/3-1,M=S>2?0:-1,E=[T,M,0,T+2/3,M,0,T+2/3,M+1,0,T,M,0,T+2/3,M+1,0,T,M+1,0];y.set(E,v*p*S),w.set(d,g*p*S);let P=[S,S,S,S,S,S];b.set(P,m*p*S)}let A=new Lt;A.setAttribute("position",new Ut(y,v)),A.setAttribute("uv",new Ut(w,g)),A.setAttribute("faceIndex",new Ut(b,m)),e.push(A),r>Wm&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}function yV(t,e,n){let i=new er(t,e,n);return i.texture.mapping=O1,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function yb(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function ube(t,e,n){let i=new Float32Array(Yd),r=new N(0,1,0);return new ir({name:"SphericalGaussianBlur",defines:{n:Yd,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:kO(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ir,depthTest:!1,depthWrite:!1})}function xV(){return new ir({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:kO(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ir,depthTest:!1,depthWrite:!1})}function wV(){return new ir({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:kO(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ir,depthTest:!1,depthWrite:!1})}function kO(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function hbe(t){let e=new WeakMap,n=null;function i(a){if(a&&a.isTexture){let l=a.mapping,c=l===UL||l===kL,h=l===Ff||l===Nf;if(c||h)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let u=e.get(a);return n===null&&(n=new vV(t)),u=c?n.fromEquirectangular(a,u):n.fromCubemap(a,u),e.set(a,u),u.texture}else{if(e.has(a))return e.get(a).texture;{let u=a.image;if(c&&u&&u.height>0||h&&u&&r(u)){n===null&&(n=new vV(t));let d=c?n.fromEquirectangular(a):n.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}else return null}}}return a}function r(a){let l=0,c=6;for(let h=0;h<c;h++)a[h]!==void 0&&l++;return l===c}function s(a){let l=a.target;l.removeEventListener("dispose",s);let c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:o}}function dbe(t){let e={};function n(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(i)}return e[i]=r,r}return{has:function(i){return n(i)!==null},init:function(i){i.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(i){let r=n(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function fbe(t,e,n,i){let r={},s=new WeakMap;function o(u){let d=u.target;d.index!==null&&e.remove(d.index);for(let p in d.attributes)e.remove(d.attributes[p]);d.removeEventListener("dispose",o),delete r[d.id];let f=s.get(d);f&&(e.remove(f),s.delete(d)),i.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,n.memory.geometries--}function a(u,d){return r[d.id]===!0||(d.addEventListener("dispose",o),r[d.id]=!0,n.memory.geometries++),d}function l(u){let d=u.attributes;for(let p in d)e.update(d[p],34962);let f=u.morphAttributes;for(let p in f){let v=f[p];for(let g=0,m=v.length;g<m;g++)e.update(v[g],34962)}}function c(u){let d=[],f=u.index,p=u.attributes.position,v=0;if(f!==null){let y=f.array;v=f.version;for(let w=0,b=y.length;w<b;w+=3){let A=y[w+0],S=y[w+1],T=y[w+2];d.push(A,S,S,T,T,A)}}else{let y=p.array;v=p.version;for(let w=0,b=y.length/3-1;w<b;w+=3){let A=w+0,S=w+1,T=w+2;d.push(A,S,S,T,T,A)}}let g=new(qQ(d)?Oy:$Q)(d,1);g.version=v;let m=s.get(u);m&&e.remove(m),s.set(u,g)}function h(u){let d=s.get(u);if(d){let f=u.index;f!==null&&d.version<f.version&&c(u)}else c(u);return s.get(u)}return{get:a,update:l,getWireframeAttribute:h}}function pbe(t,e,n,i){let r=i.isWebGL2,s;function o(d){s=d}let a,l;function c(d){a=d.type,l=d.bytesPerElement}function h(d,f){t.drawElements(s,f,a,d*l),n.update(f,s,1)}function u(d,f,p){if(p===0)return;let v,g;if(r)v=t,g="drawElementsInstanced";else if(v=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",v===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}v[g](s,f,a,d*l,p),n.update(f,s,p)}this.setMode=o,this.setIndex=c,this.render=h,this.renderInstances=u}function mbe(t){let e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(n.calls++,o){case 4:n.triangles+=a*(s/3);break;case 1:n.lines+=a*(s/2);break;case 3:n.lines+=a*(s-1);break;case 2:n.lines+=a*s;break;case 0:n.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:r,update:i}}function gbe(t,e){return t[0]-e[0]}function vbe(t,e){return Math.abs(e[1])-Math.abs(t[1])}function ybe(t,e,n){let i={},r=new Float32Array(8),s=new WeakMap,o=new Zt,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,h,u,d){let f=c.morphTargetInfluences;if(e.isWebGL2===!0){let p=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,v=p!==void 0?p.length:0,g=s.get(h);if(g===void 0||g.count!==v){let w=function(){k.dispose(),s.delete(h),h.removeEventListener("dispose",w)};g!==void 0&&g.texture.dispose();let b=h.morphAttributes.position!==void 0,A=h.morphAttributes.normal!==void 0,S=h.morphAttributes.color!==void 0,T=h.morphAttributes.position||[],M=h.morphAttributes.normal||[],E=h.morphAttributes.color||[],P=0;b===!0&&(P=1),A===!0&&(P=2),S===!0&&(P=3);let R=h.attributes.position.count*P,F=1;R>e.maxTextureSize&&(F=Math.ceil(R/e.maxTextureSize),R=e.maxTextureSize);let B=new Float32Array(R*F*4*v),k=new ZQ(B,R,F,v);k.type=ph,k.needsUpdate=!0;let j=P*4;for(let Z=0;Z<v;Z++){let ee=T[Z],O=M[Z],W=E[Z],H=R*F*4*Z;for(let Y=0;Y<ee.count;Y++){let z=Y*j;b===!0&&(o.fromBufferAttribute(ee,Y),B[H+z+0]=o.x,B[H+z+1]=o.y,B[H+z+2]=o.z,B[H+z+3]=0),A===!0&&(o.fromBufferAttribute(O,Y),B[H+z+4]=o.x,B[H+z+5]=o.y,B[H+z+6]=o.z,B[H+z+7]=0),S===!0&&(o.fromBufferAttribute(W,Y),B[H+z+8]=o.x,B[H+z+9]=o.y,B[H+z+10]=o.z,B[H+z+11]=W.itemSize===4?o.w:1)}}g={count:v,texture:k,size:new be(R,F)},s.set(h,g),h.addEventListener("dispose",w)}let m=0;for(let w=0;w<f.length;w++)m+=f[w];let y=h.morphTargetsRelative?1:1-m;d.getUniforms().setValue(t,"morphTargetBaseInfluence",y),d.getUniforms().setValue(t,"morphTargetInfluences",f),d.getUniforms().setValue(t,"morphTargetsTexture",g.texture,n),d.getUniforms().setValue(t,"morphTargetsTextureSize",g.size)}else{let p=f===void 0?0:f.length,v=i[h.id];if(v===void 0||v.length!==p){v=[];for(let b=0;b<p;b++)v[b]=[b,0];i[h.id]=v}for(let b=0;b<p;b++){let A=v[b];A[0]=b,A[1]=f[b]}v.sort(vbe);for(let b=0;b<8;b++)b<p&&v[b][1]?(a[b][0]=v[b][0],a[b][1]=v[b][1]):(a[b][0]=Number.MAX_SAFE_INTEGER,a[b][1]=0);a.sort(gbe);let g=h.morphAttributes.position,m=h.morphAttributes.normal,y=0;for(let b=0;b<8;b++){let A=a[b],S=A[0],T=A[1];S!==Number.MAX_SAFE_INTEGER&&T?(g&&h.getAttribute("morphTarget"+b)!==g[S]&&h.setAttribute("morphTarget"+b,g[S]),m&&h.getAttribute("morphNormal"+b)!==m[S]&&h.setAttribute("morphNormal"+b,m[S]),r[b]=T,y+=T):(g&&h.hasAttribute("morphTarget"+b)===!0&&h.deleteAttribute("morphTarget"+b),m&&h.hasAttribute("morphNormal"+b)===!0&&h.deleteAttribute("morphNormal"+b),r[b]=0)}let w=h.morphTargetsRelative?1:1-y;d.getUniforms().setValue(t,"morphTargetBaseInfluence",w),d.getUniforms().setValue(t,"morphTargetInfluences",r)}}return{update:l}}function xbe(t,e,n,i){let r=new WeakMap;function s(l){let c=i.render.frame,h=l.geometry,u=e.get(l,h);return r.get(u)!==c&&(e.update(u),r.set(u,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),n.update(l.instanceMatrix,34962),l.instanceColor!==null&&n.update(l.instanceColor,34962)),u}function o(){r=new WeakMap}function a(l){let c=l.target;c.removeEventListener("dispose",a),n.remove(c.instanceMatrix),c.instanceColor!==null&&n.remove(c.instanceColor)}return{update:s,dispose:o}}var nK=new br,iK=new ZQ,rK=new s1e,sK=new NO,_V=[],bV=[],SV=new Float32Array(16),AV=new Float32Array(9),MV=new Float32Array(4);function _v(t,e,n){let i=t[0];if(i<=0||i>0)return t;let r=e*n,s=_V[r];if(s===void 0&&(s=new Float32Array(r),_V[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=n,t[o].toArray(s,a)}return s}function rr(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function sr(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function _E(t,e){let n=bV[e];n===void 0&&(n=new Int32Array(e),bV[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function wbe(t,e){let n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function _be(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(rr(n,e))return;t.uniform2fv(this.addr,e),sr(n,e)}}function bbe(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(rr(n,e))return;t.uniform3fv(this.addr,e),sr(n,e)}}function Sbe(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(rr(n,e))return;t.uniform4fv(this.addr,e),sr(n,e)}}function Abe(t,e){let n=this.cache,i=e.elements;if(i===void 0){if(rr(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),sr(n,e)}else{if(rr(n,i))return;MV.set(i),t.uniformMatrix2fv(this.addr,!1,MV),sr(n,i)}}function Mbe(t,e){let n=this.cache,i=e.elements;if(i===void 0){if(rr(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),sr(n,e)}else{if(rr(n,i))return;AV.set(i),t.uniformMatrix3fv(this.addr,!1,AV),sr(n,i)}}function Ebe(t,e){let n=this.cache,i=e.elements;if(i===void 0){if(rr(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),sr(n,e)}else{if(rr(n,i))return;SV.set(i),t.uniformMatrix4fv(this.addr,!1,SV),sr(n,i)}}function Cbe(t,e){let n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Tbe(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(rr(n,e))return;t.uniform2iv(this.addr,e),sr(n,e)}}function Pbe(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(rr(n,e))return;t.uniform3iv(this.addr,e),sr(n,e)}}function Dbe(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(rr(n,e))return;t.uniform4iv(this.addr,e),sr(n,e)}}function Rbe(t,e){let n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Lbe(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(rr(n,e))return;t.uniform2uiv(this.addr,e),sr(n,e)}}function Ibe(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(rr(n,e))return;t.uniform3uiv(this.addr,e),sr(n,e)}}function Bbe(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(rr(n,e))return;t.uniform4uiv(this.addr,e),sr(n,e)}}function Obe(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2D(e||nK,r)}function Fbe(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||rK,r)}function Nbe(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||sK,r)}function Ube(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||iK,r)}function kbe(t){switch(t){case 5126:return wbe;case 35664:return _be;case 35665:return bbe;case 35666:return Sbe;case 35674:return Abe;case 35675:return Mbe;case 35676:return Ebe;case 5124:case 35670:return Cbe;case 35667:case 35671:return Tbe;case 35668:case 35672:return Pbe;case 35669:case 35673:return Dbe;case 5125:return Rbe;case 36294:return Lbe;case 36295:return Ibe;case 36296:return Bbe;case 35678:case 36198:case 36298:case 36306:case 35682:return Obe;case 35679:case 36299:case 36307:return Fbe;case 35680:case 36300:case 36308:case 36293:return Nbe;case 36289:case 36303:case 36311:case 36292:return Ube}}function zbe(t,e){t.uniform1fv(this.addr,e)}function Gbe(t,e){let n=_v(e,this.size,2);t.uniform2fv(this.addr,n)}function Hbe(t,e){let n=_v(e,this.size,3);t.uniform3fv(this.addr,n)}function Vbe(t,e){let n=_v(e,this.size,4);t.uniform4fv(this.addr,n)}function jbe(t,e){let n=_v(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function Wbe(t,e){let n=_v(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function Xbe(t,e){let n=_v(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Ybe(t,e){t.uniform1iv(this.addr,e)}function qbe(t,e){t.uniform2iv(this.addr,e)}function Qbe(t,e){t.uniform3iv(this.addr,e)}function Kbe(t,e){t.uniform4iv(this.addr,e)}function Jbe(t,e){t.uniform1uiv(this.addr,e)}function Zbe(t,e){t.uniform2uiv(this.addr,e)}function $be(t,e){t.uniform3uiv(this.addr,e)}function eSe(t,e){t.uniform4uiv(this.addr,e)}function tSe(t,e,n){let i=this.cache,r=e.length,s=_E(n,r);rr(i,s)||(t.uniform1iv(this.addr,s),sr(i,s));for(let o=0;o!==r;++o)n.setTexture2D(e[o]||nK,s[o])}function nSe(t,e,n){let i=this.cache,r=e.length,s=_E(n,r);rr(i,s)||(t.uniform1iv(this.addr,s),sr(i,s));for(let o=0;o!==r;++o)n.setTexture3D(e[o]||rK,s[o])}function iSe(t,e,n){let i=this.cache,r=e.length,s=_E(n,r);rr(i,s)||(t.uniform1iv(this.addr,s),sr(i,s));for(let o=0;o!==r;++o)n.setTextureCube(e[o]||sK,s[o])}function rSe(t,e,n){let i=this.cache,r=e.length,s=_E(n,r);rr(i,s)||(t.uniform1iv(this.addr,s),sr(i,s));for(let o=0;o!==r;++o)n.setTexture2DArray(e[o]||iK,s[o])}function sSe(t){switch(t){case 5126:return zbe;case 35664:return Gbe;case 35665:return Hbe;case 35666:return Vbe;case 35674:return jbe;case 35675:return Wbe;case 35676:return Xbe;case 5124:case 35670:return Ybe;case 35667:case 35671:return qbe;case 35668:case 35672:return Qbe;case 35669:case 35673:return Kbe;case 5125:return Jbe;case 36294:return Zbe;case 36295:return $be;case 36296:return eSe;case 35678:case 36198:case 36298:case 36306:case 35682:return tSe;case 35679:case 36299:case 36307:return nSe;case 35680:case 36300:case 36308:case 36293:return iSe;case 36289:case 36303:case 36311:case 36292:return rSe}}var oSe=class{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=kbe(e.type)}},aSe=class{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=sSe(e.type)}},lSe=class{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,n){let i=this.seq;for(let r=0,s=i.length;r!==s;++r){let o=i[r];o.setValue(t,e[o.id],n)}}},d2=/(\w+)(\])?(\[|\.)?/g;function EV(t,e){t.seq.push(e),t.map[e.id]=e}function cSe(t,e,n){let i=t.name,r=i.length;for(d2.lastIndex=0;;){let s=d2.exec(i),o=d2.lastIndex,a=s[1],l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){EV(n,c===void 0?new oSe(a,t,e):new aSe(a,t,e));break}else{let h=n.map[a];h===void 0&&(h=new lSe(a),EV(n,h)),n=h}}}var LS=class{constructor(t,e){this.seq=[],this.map={};let n=t.getProgramParameter(e,35718);for(let i=0;i<n;++i){let r=t.getActiveUniform(e,i),s=t.getUniformLocation(e,r.name);cSe(r,s,this)}}setValue(t,e,n,i){let r=this.map[e];r!==void 0&&r.setValue(t,n,i)}setOptional(t,e,n){let i=e[n];i!==void 0&&this.setValue(t,n,i)}static upload(t,e,n,i){for(let r=0,s=e.length;r!==s;++r){let o=e[r],a=n[o.id];a.needsUpdate!==!1&&o.setValue(t,a.value,i)}}static seqWithValue(t,e){let n=[];for(let i=0,r=t.length;i!==r;++i){let s=t[i];s.id in e&&n.push(s)}return n}};function CV(t,e,n){let i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}var uSe=0;function hSe(t,e){let n=t.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let o=r;o<s;o++){let a=o+1;i.push(`${a===e?">":" "} ${a}: ${n[o]}`)}return i.join(`
`)}function dSe(t){switch(t){case tc:return["Linear","( value )"];case Wt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function TV(t,e,n){let i=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();if(i&&r==="")return"";let s=/ERROR: 0:(\d+)/.exec(r);if(s){let o=parseInt(s[1]);return n.toUpperCase()+`

`+r+`

`+hSe(t.getShaderSource(e),o)}else return r}function fSe(t,e){let n=dSe(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function pSe(t,e){let n;switch(e){case xxe:n="Linear";break;case wxe:n="Reinhard";break;case _xe:n="OptimizedCineon";break;case bxe:n="ACESFilmic";break;case Sxe:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function mSe(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||t.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(ay).join(`
`)}function gSe(t){let e=[];for(let n in t){let i=t[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function vSe(t,e){let n={},i=t.getProgramParameter(e,35721);for(let r=0;r<i;r++){let s=t.getActiveAttrib(e,r),o=s.name,a=1;s.type===35674&&(a=2),s.type===35675&&(a=3),s.type===35676&&(a=4),n[o]={type:s.type,location:t.getAttribLocation(e,o),locationSize:a}}return n}function ay(t){return t!==""}function PV(t,e){let n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function DV(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var ySe=/^[ \t]*#include +<([\w\d./]+)>/gm;function jL(t){return t.replace(ySe,xSe)}function xSe(t,e){let n=jt[e];if(n===void 0)throw new Error("Can not resolve #include <"+e+">");return jL(n)}var wSe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function RV(t){return t.replace(wSe,_Se)}function _Se(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function LV(t){let e="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function bSe(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===BO?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===GQ?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===oy&&(e="SHADOWMAP_TYPE_VSM"),e}function SSe(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case Ff:case Nf:e="ENVMAP_TYPE_CUBE";break;case O1:e="ENVMAP_TYPE_CUBE_UV";break}return e}function ASe(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case Nf:e="ENVMAP_MODE_REFRACTION";break}return e}function MSe(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case jQ:e="ENVMAP_BLENDING_MULTIPLY";break;case vxe:e="ENVMAP_BLENDING_MIX";break;case yxe:e="ENVMAP_BLENDING_ADD";break}return e}function ESe(t){let e=t.envMapCubeUVHeight;if(e===null)return null;let n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:i,maxMip:n}}function CSe(t,e,n,i){let r=t.getContext(),s=n.defines,o=n.vertexShader,a=n.fragmentShader,l=bSe(n),c=SSe(n),h=ASe(n),u=MSe(n),d=ESe(n),f=n.isWebGL2?"":mSe(n),p=gSe(s),v=r.createProgram(),g,m,y=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(g=[p].filter(ay).join(`
`),g.length>0&&(g+=`
`),m=[f,p].filter(ay).join(`
`),m.length>0&&(m+=`
`)):(g=[LV(n),"#define SHADER_NAME "+n.shaderName,p,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(ay).join(`
`),m=[f,LV(n),"#define SHADER_NAME "+n.shaderName,p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+h:"",n.envMap?"#define "+u:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Zc?"#define TONE_MAPPING":"",n.toneMapping!==Zc?jt.tonemapping_pars_fragment:"",n.toneMapping!==Zc?pSe("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",jt.encodings_pars_fragment,fSe("linearToOutputTexel",n.outputEncoding),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(ay).join(`
`)),o=jL(o),o=PV(o,n),o=DV(o,n),a=jL(a),a=PV(a,n),a=DV(a,n),o=RV(o),a=RV(a),n.isWebGL2&&n.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,m=["#define varying in",n.glslVersion===nV?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===nV?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+m);let w=y+g+o,b=y+m+a,A=CV(r,35633,w),S=CV(r,35632,b);if(r.attachShader(v,A),r.attachShader(v,S),n.index0AttributeName!==void 0?r.bindAttribLocation(v,0,n.index0AttributeName):n.morphTargets===!0&&r.bindAttribLocation(v,0,"position"),r.linkProgram(v),t.debug.checkShaderErrors){let E=r.getProgramInfoLog(v).trim(),P=r.getShaderInfoLog(A).trim(),R=r.getShaderInfoLog(S).trim(),F=!0,B=!0;if(r.getProgramParameter(v,35714)===!1){F=!1;let k=TV(r,A,"vertex"),j=TV(r,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(v,35715)+`

Program Info Log: `+E+`
`+k+`
`+j)}else E!==""?console.warn("THREE.WebGLProgram: Program Info Log:",E):(P===""||R==="")&&(B=!1);B&&(this.diagnostics={runnable:F,programLog:E,vertexShader:{log:P,prefix:g},fragmentShader:{log:R,prefix:m}})}r.deleteShader(A),r.deleteShader(S);let T;this.getUniforms=function(){return T===void 0&&(T=new LS(r,v)),T};let M;return this.getAttributes=function(){return M===void 0&&(M=vSe(r,v)),M},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(v),this.program=void 0},this.name=n.shaderName,this.id=uSe++,this.cacheKey=e,this.usedTimes=1,this.program=v,this.vertexShader=A,this.fragmentShader=S,this}var TSe=0,PSe=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){let e=t.vertexShader,n=t.fragmentShader,i=this._getShaderStage(e),r=this._getShaderStage(n),s=this._getShaderCacheForMaterial(t);return s.has(i)===!1&&(s.add(i),i.usedTimes++),s.has(r)===!1&&(s.add(r),r.usedTimes++),this}remove(t){let e=this.materialCache.get(t);for(let n of e)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){let e=this.materialCache,n=e.get(t);return n===void 0&&(n=new Set,e.set(t,n)),n}_getShaderStage(t){let e=this.shaderCache,n=e.get(t);return n===void 0&&(n=new DSe(t),e.set(t,n)),n}},DSe=class{constructor(t){this.id=TSe++,this.code=t,this.usedTimes=0}};function RSe(t,e,n,i,r,s,o){let a=new FO,l=new PSe,c=[],h=r.isWebGL2,u=r.logarithmicDepthBuffer,d=r.vertexTextures,f=r.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(M,E,P,R,F){let B=R.fog,k=F.geometry,j=M.isMeshStandardMaterial?R.environment:null,Z=(M.isMeshStandardMaterial?n:e).get(M.envMap||j),ee=Z&&Z.mapping===O1?Z.image.height:null,O=p[M.type];M.precision!==null&&(f=r.getMaxPrecision(M.precision),f!==M.precision&&console.warn("THREE.WebGLProgram.getParameters:",M.precision,"not supported, using",f,"instead."));let W=k.morphAttributes.position||k.morphAttributes.normal||k.morphAttributes.color,H=W!==void 0?W.length:0,Y=0;k.morphAttributes.position!==void 0&&(Y=1),k.morphAttributes.normal!==void 0&&(Y=2),k.morphAttributes.color!==void 0&&(Y=3);let z,X,q,re;if(O){let $=Il[O];z=$.vertexShader,X=$.fragmentShader}else z=M.vertexShader,X=M.fragmentShader,l.update(M),q=l.getVertexShaderID(M),re=l.getFragmentShaderID(M);let G=t.getRenderTarget(),K=M.alphaTest>0,oe=M.clearcoat>0,ve=M.iridescence>0;return{isWebGL2:h,shaderID:O,shaderName:M.type,vertexShader:z,fragmentShader:X,defines:M.defines,customVertexShaderID:q,customFragmentShaderID:re,isRawShaderMaterial:M.isRawShaderMaterial===!0,glslVersion:M.glslVersion,precision:f,instancing:F.isInstancedMesh===!0,instancingColor:F.isInstancedMesh===!0&&F.instanceColor!==null,supportsVertexTextures:d,outputEncoding:G===null?t.outputEncoding:G.isXRRenderTarget===!0?G.texture.encoding:tc,map:!!M.map,matcap:!!M.matcap,envMap:!!Z,envMapMode:Z&&Z.mapping,envMapCubeUVHeight:ee,lightMap:!!M.lightMap,aoMap:!!M.aoMap,emissiveMap:!!M.emissiveMap,bumpMap:!!M.bumpMap,normalMap:!!M.normalMap,objectSpaceNormalMap:M.normalMapType===Gxe,tangentSpaceNormalMap:M.normalMapType===zxe,decodeVideoTexture:!!M.map&&M.map.isVideoTexture===!0&&M.map.encoding===Wt,clearcoat:oe,clearcoatMap:oe&&!!M.clearcoatMap,clearcoatRoughnessMap:oe&&!!M.clearcoatRoughnessMap,clearcoatNormalMap:oe&&!!M.clearcoatNormalMap,iridescence:ve,iridescenceMap:ve&&!!M.iridescenceMap,iridescenceThicknessMap:ve&&!!M.iridescenceThicknessMap,displacementMap:!!M.displacementMap,roughnessMap:!!M.roughnessMap,metalnessMap:!!M.metalnessMap,specularMap:!!M.specularMap,specularIntensityMap:!!M.specularIntensityMap,specularColorMap:!!M.specularColorMap,opaque:M.transparent===!1&&M.blending===fg,alphaMap:!!M.alphaMap,alphaTest:K,gradientMap:!!M.gradientMap,sheen:M.sheen>0,sheenColorMap:!!M.sheenColorMap,sheenRoughnessMap:!!M.sheenRoughnessMap,transmission:M.transmission>0,transmissionMap:!!M.transmissionMap,thicknessMap:!!M.thicknessMap,combine:M.combine,vertexTangents:!!M.normalMap&&!!k.attributes.tangent,vertexColors:M.vertexColors,vertexAlphas:M.vertexColors===!0&&!!k.attributes.color&&k.attributes.color.itemSize===4,vertexUvs:!!M.map||!!M.bumpMap||!!M.normalMap||!!M.specularMap||!!M.alphaMap||!!M.emissiveMap||!!M.roughnessMap||!!M.metalnessMap||!!M.clearcoatMap||!!M.clearcoatRoughnessMap||!!M.clearcoatNormalMap||!!M.iridescenceMap||!!M.iridescenceThicknessMap||!!M.displacementMap||!!M.transmissionMap||!!M.thicknessMap||!!M.specularIntensityMap||!!M.specularColorMap||!!M.sheenColorMap||!!M.sheenRoughnessMap,uvsVertexOnly:!(M.map||M.bumpMap||M.normalMap||M.specularMap||M.alphaMap||M.emissiveMap||M.roughnessMap||M.metalnessMap||M.clearcoatNormalMap||M.iridescenceMap||M.iridescenceThicknessMap||M.transmission>0||M.transmissionMap||M.thicknessMap||M.specularIntensityMap||M.specularColorMap||M.sheen>0||M.sheenColorMap||M.sheenRoughnessMap)&&!!M.displacementMap,fog:!!B,useFog:M.fog===!0,fogExp2:B&&B.isFogExp2,flatShading:!!M.flatShading,sizeAttenuation:M.sizeAttenuation,logarithmicDepthBuffer:u,skinning:F.isSkinnedMesh===!0,morphTargets:k.morphAttributes.position!==void 0,morphNormals:k.morphAttributes.normal!==void 0,morphColors:k.morphAttributes.color!==void 0,morphTargetsCount:H,morphTextureStride:Y,numDirLights:E.directional.length,numPointLights:E.point.length,numSpotLights:E.spot.length,numSpotLightMaps:E.spotLightMap.length,numRectAreaLights:E.rectArea.length,numHemiLights:E.hemi.length,numDirLightShadows:E.directionalShadowMap.length,numPointLightShadows:E.pointShadowMap.length,numSpotLightShadows:E.spotShadowMap.length,numSpotLightShadowsWithMaps:E.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:M.dithering,shadowMapEnabled:t.shadowMap.enabled&&P.length>0,shadowMapType:t.shadowMap.type,toneMapping:M.toneMapped?t.toneMapping:Zc,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:M.premultipliedAlpha,doubleSided:M.side===co,flipSided:M.side===xr,useDepthPacking:!!M.depthPacking,depthPacking:M.depthPacking||0,index0AttributeName:M.index0AttributeName,extensionDerivatives:M.extensions&&M.extensions.derivatives,extensionFragDepth:M.extensions&&M.extensions.fragDepth,extensionDrawBuffers:M.extensions&&M.extensions.drawBuffers,extensionShaderTextureLOD:M.extensions&&M.extensions.shaderTextureLOD,rendererExtensionFragDepth:h||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||i.has("EXT_shader_texture_lod"),customProgramCacheKey:M.customProgramCacheKey()}}function g(M){let E=[];if(M.shaderID?E.push(M.shaderID):(E.push(M.customVertexShaderID),E.push(M.customFragmentShaderID)),M.defines!==void 0)for(let P in M.defines)E.push(P),E.push(M.defines[P]);return M.isRawShaderMaterial===!1&&(m(E,M),y(E,M),E.push(t.outputEncoding)),E.push(M.customProgramCacheKey),E.join()}function m(M,E){M.push(E.precision),M.push(E.outputEncoding),M.push(E.envMapMode),M.push(E.envMapCubeUVHeight),M.push(E.combine),M.push(E.vertexUvs),M.push(E.fogExp2),M.push(E.sizeAttenuation),M.push(E.morphTargetsCount),M.push(E.morphAttributeCount),M.push(E.numDirLights),M.push(E.numPointLights),M.push(E.numSpotLights),M.push(E.numSpotLightMaps),M.push(E.numHemiLights),M.push(E.numRectAreaLights),M.push(E.numDirLightShadows),M.push(E.numPointLightShadows),M.push(E.numSpotLightShadows),M.push(E.numSpotLightShadowsWithMaps),M.push(E.shadowMapType),M.push(E.toneMapping),M.push(E.numClippingPlanes),M.push(E.numClipIntersection),M.push(E.depthPacking)}function y(M,E){a.disableAll(),E.isWebGL2&&a.enable(0),E.supportsVertexTextures&&a.enable(1),E.instancing&&a.enable(2),E.instancingColor&&a.enable(3),E.map&&a.enable(4),E.matcap&&a.enable(5),E.envMap&&a.enable(6),E.lightMap&&a.enable(7),E.aoMap&&a.enable(8),E.emissiveMap&&a.enable(9),E.bumpMap&&a.enable(10),E.normalMap&&a.enable(11),E.objectSpaceNormalMap&&a.enable(12),E.tangentSpaceNormalMap&&a.enable(13),E.clearcoat&&a.enable(14),E.clearcoatMap&&a.enable(15),E.clearcoatRoughnessMap&&a.enable(16),E.clearcoatNormalMap&&a.enable(17),E.iridescence&&a.enable(18),E.iridescenceMap&&a.enable(19),E.iridescenceThicknessMap&&a.enable(20),E.displacementMap&&a.enable(21),E.specularMap&&a.enable(22),E.roughnessMap&&a.enable(23),E.metalnessMap&&a.enable(24),E.gradientMap&&a.enable(25),E.alphaMap&&a.enable(26),E.alphaTest&&a.enable(27),E.vertexColors&&a.enable(28),E.vertexAlphas&&a.enable(29),E.vertexUvs&&a.enable(30),E.vertexTangents&&a.enable(31),E.uvsVertexOnly&&a.enable(32),M.push(a.mask),a.disableAll(),E.fog&&a.enable(0),E.useFog&&a.enable(1),E.flatShading&&a.enable(2),E.logarithmicDepthBuffer&&a.enable(3),E.skinning&&a.enable(4),E.morphTargets&&a.enable(5),E.morphNormals&&a.enable(6),E.morphColors&&a.enable(7),E.premultipliedAlpha&&a.enable(8),E.shadowMapEnabled&&a.enable(9),E.physicallyCorrectLights&&a.enable(10),E.doubleSided&&a.enable(11),E.flipSided&&a.enable(12),E.useDepthPacking&&a.enable(13),E.dithering&&a.enable(14),E.specularIntensityMap&&a.enable(15),E.specularColorMap&&a.enable(16),E.transmission&&a.enable(17),E.transmissionMap&&a.enable(18),E.thicknessMap&&a.enable(19),E.sheen&&a.enable(20),E.sheenColorMap&&a.enable(21),E.sheenRoughnessMap&&a.enable(22),E.decodeVideoTexture&&a.enable(23),E.opaque&&a.enable(24),M.push(a.mask)}function w(M){let E=p[M.type],P;if(E){let R=Il[E];P=xv.clone(R.uniforms)}else P=M.uniforms;return P}function b(M,E){let P;for(let R=0,F=c.length;R<F;R++){let B=c[R];if(B.cacheKey===E){P=B,++P.usedTimes;break}}return P===void 0&&(P=new CSe(t,E,M,s),c.push(P)),P}function A(M){if(--M.usedTimes===0){let E=c.indexOf(M);c[E]=c[c.length-1],c.pop(),M.destroy()}}function S(M){l.remove(M)}function T(){l.dispose()}return{getParameters:v,getProgramCacheKey:g,getUniforms:w,acquireProgram:b,releaseProgram:A,releaseShaderCache:S,programs:c,dispose:T}}function LSe(){let t=new WeakMap;function e(s){let o=t.get(s);return o===void 0&&(o={},t.set(s,o)),o}function n(s){t.delete(s)}function i(s,o,a){t.get(s)[o]=a}function r(){t=new WeakMap}return{get:e,remove:n,update:i,dispose:r}}function ISe(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function IV(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function BV(){let t=[],e=0,n=[],i=[],r=[];function s(){e=0,n.length=0,i.length=0,r.length=0}function o(u,d,f,p,v,g){let m=t[e];return m===void 0?(m={id:u.id,object:u,geometry:d,material:f,groupOrder:p,renderOrder:u.renderOrder,z:v,group:g},t[e]=m):(m.id=u.id,m.object=u,m.geometry=d,m.material=f,m.groupOrder=p,m.renderOrder=u.renderOrder,m.z=v,m.group=g),e++,m}function a(u,d,f,p,v,g){let m=o(u,d,f,p,v,g);f.transmission>0?i.push(m):f.transparent===!0?r.push(m):n.push(m)}function l(u,d,f,p,v,g){let m=o(u,d,f,p,v,g);f.transmission>0?i.unshift(m):f.transparent===!0?r.unshift(m):n.unshift(m)}function c(u,d){n.length>1&&n.sort(u||ISe),i.length>1&&i.sort(d||IV),r.length>1&&r.sort(d||IV)}function h(){for(let u=e,d=t.length;u<d;u++){let f=t[u];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:n,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:h,sort:c}}function BSe(){let t=new WeakMap;function e(i,r){let s=t.get(i),o;return s===void 0?(o=new BV,t.set(i,[o])):r>=s.length?(o=new BV,s.push(o)):o=s[r],o}function n(){t=new WeakMap}return{get:e,dispose:n}}function OSe(){let t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new N,color:new Rt};break;case"SpotLight":n={position:new N,direction:new N,color:new Rt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new N,color:new Rt,distance:0,decay:0};break;case"HemisphereLight":n={direction:new N,skyColor:new Rt,groundColor:new Rt};break;case"RectAreaLight":n={color:new Rt,position:new N,halfWidth:new N,halfHeight:new N};break}return t[e.id]=n,n}}}function FSe(){let t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new be};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new be};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new be,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}var NSe=0;function USe(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function kSe(t,e){let n=new OSe,i=FSe(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let h=0;h<9;h++)r.probe.push(new N);let s=new N,o=new nt,a=new nt;function l(h,u){let d=0,f=0,p=0;for(let R=0;R<9;R++)r.probe[R].set(0,0,0);let v=0,g=0,m=0,y=0,w=0,b=0,A=0,S=0,T=0,M=0;h.sort(USe);let E=u!==!0?Math.PI:1;for(let R=0,F=h.length;R<F;R++){let B=h[R],k=B.color,j=B.intensity,Z=B.distance,ee=B.shadow&&B.shadow.map?B.shadow.map.texture:null;if(B.isAmbientLight)d+=k.r*j*E,f+=k.g*j*E,p+=k.b*j*E;else if(B.isLightProbe)for(let O=0;O<9;O++)r.probe[O].addScaledVector(B.sh.coefficients[O],j);else if(B.isDirectionalLight){let O=n.get(B);if(O.color.copy(B.color).multiplyScalar(B.intensity*E),B.castShadow){let W=B.shadow,H=i.get(B);H.shadowBias=W.bias,H.shadowNormalBias=W.normalBias,H.shadowRadius=W.radius,H.shadowMapSize=W.mapSize,r.directionalShadow[v]=H,r.directionalShadowMap[v]=ee,r.directionalShadowMatrix[v]=B.shadow.matrix,b++}r.directional[v]=O,v++}else if(B.isSpotLight){let O=n.get(B);O.position.setFromMatrixPosition(B.matrixWorld),O.color.copy(k).multiplyScalar(j*E),O.distance=Z,O.coneCos=Math.cos(B.angle),O.penumbraCos=Math.cos(B.angle*(1-B.penumbra)),O.decay=B.decay,r.spot[m]=O;let W=B.shadow;if(B.map&&(r.spotLightMap[T]=B.map,T++,W.updateMatrices(B),B.castShadow&&M++),r.spotLightMatrix[m]=W.matrix,B.castShadow){let H=i.get(B);H.shadowBias=W.bias,H.shadowNormalBias=W.normalBias,H.shadowRadius=W.radius,H.shadowMapSize=W.mapSize,r.spotShadow[m]=H,r.spotShadowMap[m]=ee,S++}m++}else if(B.isRectAreaLight){let O=n.get(B);O.color.copy(k).multiplyScalar(j),O.halfWidth.set(B.width*.5,0,0),O.halfHeight.set(0,B.height*.5,0),r.rectArea[y]=O,y++}else if(B.isPointLight){let O=n.get(B);if(O.color.copy(B.color).multiplyScalar(B.intensity*E),O.distance=B.distance,O.decay=B.decay,B.castShadow){let W=B.shadow,H=i.get(B);H.shadowBias=W.bias,H.shadowNormalBias=W.normalBias,H.shadowRadius=W.radius,H.shadowMapSize=W.mapSize,H.shadowCameraNear=W.camera.near,H.shadowCameraFar=W.camera.far,r.pointShadow[g]=H,r.pointShadowMap[g]=ee,r.pointShadowMatrix[g]=B.shadow.matrix,A++}r.point[g]=O,g++}else if(B.isHemisphereLight){let O=n.get(B);O.skyColor.copy(B.color).multiplyScalar(j*E),O.groundColor.copy(B.groundColor).multiplyScalar(j*E),r.hemi[w]=O,w++}}y>0&&(e.isWebGL2||t.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=tt.LTC_FLOAT_1,r.rectAreaLTC2=tt.LTC_FLOAT_2):t.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=tt.LTC_HALF_1,r.rectAreaLTC2=tt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;let P=r.hash;(P.directionalLength!==v||P.pointLength!==g||P.spotLength!==m||P.rectAreaLength!==y||P.hemiLength!==w||P.numDirectionalShadows!==b||P.numPointShadows!==A||P.numSpotShadows!==S||P.numSpotMaps!==T)&&(r.directional.length=v,r.spot.length=m,r.rectArea.length=y,r.point.length=g,r.hemi.length=w,r.directionalShadow.length=b,r.directionalShadowMap.length=b,r.pointShadow.length=A,r.pointShadowMap.length=A,r.spotShadow.length=S,r.spotShadowMap.length=S,r.directionalShadowMatrix.length=b,r.pointShadowMatrix.length=A,r.spotLightMatrix.length=S+T-M,r.spotLightMap.length=T,r.numSpotLightShadowsWithMaps=M,P.directionalLength=v,P.pointLength=g,P.spotLength=m,P.rectAreaLength=y,P.hemiLength=w,P.numDirectionalShadows=b,P.numPointShadows=A,P.numSpotShadows=S,P.numSpotMaps=T,r.version=NSe++)}function c(h,u){let d=0,f=0,p=0,v=0,g=0,m=u.matrixWorldInverse;for(let y=0,w=h.length;y<w;y++){let b=h[y];if(b.isDirectionalLight){let A=r.directional[d];A.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),A.direction.sub(s),A.direction.transformDirection(m),d++}else if(b.isSpotLight){let A=r.spot[p];A.position.setFromMatrixPosition(b.matrixWorld),A.position.applyMatrix4(m),A.direction.setFromMatrixPosition(b.matrixWorld),s.setFromMatrixPosition(b.target.matrixWorld),A.direction.sub(s),A.direction.transformDirection(m),p++}else if(b.isRectAreaLight){let A=r.rectArea[v];A.position.setFromMatrixPosition(b.matrixWorld),A.position.applyMatrix4(m),a.identity(),o.copy(b.matrixWorld),o.premultiply(m),a.extractRotation(o),A.halfWidth.set(b.width*.5,0,0),A.halfHeight.set(0,b.height*.5,0),A.halfWidth.applyMatrix4(a),A.halfHeight.applyMatrix4(a),v++}else if(b.isPointLight){let A=r.point[f];A.position.setFromMatrixPosition(b.matrixWorld),A.position.applyMatrix4(m),f++}else if(b.isHemisphereLight){let A=r.hemi[g];A.direction.setFromMatrixPosition(b.matrixWorld),A.direction.transformDirection(m),g++}}}return{setup:l,setupView:c,state:r}}function OV(t,e){let n=new kSe(t,e),i=[],r=[];function s(){i.length=0,r.length=0}function o(h){i.push(h)}function a(h){r.push(h)}function l(h){n.setup(i,h)}function c(h){n.setupView(i,h)}return{init:s,state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function zSe(t,e){let n=new WeakMap;function i(s,o=0){let a=n.get(s),l;return a===void 0?(l=new OV(t,e),n.set(s,[l])):o>=a.length?(l=new OV(t,e),a.push(l)):l=a[o],l}function r(){n=new WeakMap}return{get:i,dispose:r}}var oK=class extends F1{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=gu,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}},GSe=class extends F1{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new N,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}},HSe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,VSe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function jSe(t,e,n){let i=new UO,r=new be,s=new be,o=new Zt,a=new oK({depthPacking:YQ}),l=new GSe,c={},h=n.maxTextureSize,u={[el]:xr,[xr]:el,[co]:co},d=new ir({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new be},radius:{value:4}},vertexShader:HSe,fragmentShader:VSe}),f=d.clone();f.defines.HORIZONTAL_PASS=1;let p=new Lt;p.setAttribute("position",new Ut(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let v=new uo(p,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=BO,this.render=function(b,A,S){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||b.length===0)return;let T=t.getRenderTarget(),M=t.getActiveCubeFace(),E=t.getActiveMipmapLevel(),P=t.state;P.setBlending(Ir),P.buffers.color.setClear(1,1,1,1),P.buffers.depth.setTest(!0),P.setScissorTest(!1);for(let R=0,F=b.length;R<F;R++){let B=b[R],k=B.shadow;if(k===void 0){console.warn("THREE.WebGLShadowMap:",B,"has no shadow.");continue}if(k.autoUpdate===!1&&k.needsUpdate===!1)continue;r.copy(k.mapSize);let j=k.getFrameExtents();if(r.multiply(j),s.copy(k.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(s.x=Math.floor(h/j.x),r.x=s.x*j.x,k.mapSize.x=s.x),r.y>h&&(s.y=Math.floor(h/j.y),r.y=s.y*j.y,k.mapSize.y=s.y)),k.map===null){let ee=this.type!==oy?{minFilter:oi,magFilter:oi}:{};k.map=new er(r.x,r.y,ee),k.map.texture.name=B.name+".shadowMap",k.camera.updateProjectionMatrix()}t.setRenderTarget(k.map),t.clear();let Z=k.getViewportCount();for(let ee=0;ee<Z;ee++){let O=k.getViewport(ee);o.set(s.x*O.x,s.y*O.y,s.x*O.z,s.y*O.w),P.viewport(o),k.updateMatrices(B,ee),i=k.getFrustum(),w(A,S,k.camera,B,this.type)}k.isPointLightShadow!==!0&&this.type===oy&&m(k,S),k.needsUpdate=!1}g.needsUpdate=!1,t.setRenderTarget(T,M,E)};function m(b,A){let S=e.update(v);d.defines.VSM_SAMPLES!==b.blurSamples&&(d.defines.VSM_SAMPLES=b.blurSamples,f.defines.VSM_SAMPLES=b.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),b.mapPass===null&&(b.mapPass=new er(r.x,r.y)),d.uniforms.shadow_pass.value=b.map.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,t.setRenderTarget(b.mapPass),t.clear(),t.renderBufferDirect(A,null,S,d,v,null),f.uniforms.shadow_pass.value=b.mapPass.texture,f.uniforms.resolution.value=b.mapSize,f.uniforms.radius.value=b.radius,t.setRenderTarget(b.map),t.clear(),t.renderBufferDirect(A,null,S,f,v,null)}function y(b,A,S,T,M,E){let P=null,R=S.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(R!==void 0)P=R;else if(P=S.isPointLight===!0?l:a,t.localClippingEnabled&&A.clipShadows===!0&&Array.isArray(A.clippingPlanes)&&A.clippingPlanes.length!==0||A.displacementMap&&A.displacementScale!==0||A.alphaMap&&A.alphaTest>0||A.map&&A.alphaTest>0){let F=P.uuid,B=A.uuid,k=c[F];k===void 0&&(k={},c[F]=k);let j=k[B];j===void 0&&(j=P.clone(),k[B]=j),P=j}return P.visible=A.visible,P.wireframe=A.wireframe,E===oy?P.side=A.shadowSide!==null?A.shadowSide:A.side:P.side=A.shadowSide!==null?A.shadowSide:u[A.side],P.alphaMap=A.alphaMap,P.alphaTest=A.alphaTest,P.map=A.map,P.clipShadows=A.clipShadows,P.clippingPlanes=A.clippingPlanes,P.clipIntersection=A.clipIntersection,P.displacementMap=A.displacementMap,P.displacementScale=A.displacementScale,P.displacementBias=A.displacementBias,P.wireframeLinewidth=A.wireframeLinewidth,P.linewidth=A.linewidth,S.isPointLight===!0&&P.isMeshDistanceMaterial===!0&&(P.referencePosition.setFromMatrixPosition(S.matrixWorld),P.nearDistance=T,P.farDistance=M),P}function w(b,A,S,T,M){if(b.visible===!1)return;if(b.layers.test(A.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&M===oy)&&(!b.frustumCulled||i.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(S.matrixWorldInverse,b.matrixWorld);let P=e.update(b),R=b.material;if(Array.isArray(R)){let F=P.groups;for(let B=0,k=F.length;B<k;B++){let j=F[B],Z=R[j.materialIndex];if(Z&&Z.visible){let ee=y(b,Z,T,S.near,S.far,M);t.renderBufferDirect(S,null,P,ee,b,j)}}}else if(R.visible){let F=y(b,R,T,S.near,S.far,M);t.renderBufferDirect(S,null,P,F,b,null)}}let E=b.children;for(let P=0,R=E.length;P<R;P++)w(E[P],A,S,T,M)}}function WSe(t,e,n){let i=n.isWebGL2;function r(){let J=!1,fe=new Zt,Se=null,Oe=new Zt(0,0,0,0);return{setMask:function(qe){Se!==qe&&!J&&(t.colorMask(qe,qe,qe,qe),Se=qe)},setLocked:function(qe){J=qe},setClear:function(qe,vt,Et,un,Wi){Wi===!0&&(qe*=un,vt*=un,Et*=un),fe.set(qe,vt,Et,un),Oe.equals(fe)===!1&&(t.clearColor(qe,vt,Et,un),Oe.copy(fe))},reset:function(){J=!1,Se=null,Oe.set(-1,0,0,0)}}}function s(){let J=!1,fe=null,Se=null,Oe=null;return{setTest:function(qe){qe?K(2929):oe(2929)},setMask:function(qe){fe!==qe&&!J&&(t.depthMask(qe),fe=qe)},setFunc:function(qe){if(Se!==qe){switch(qe){case uxe:t.depthFunc(512);break;case hxe:t.depthFunc(519);break;case dxe:t.depthFunc(513);break;case NL:t.depthFunc(515);break;case fxe:t.depthFunc(514);break;case pxe:t.depthFunc(518);break;case mxe:t.depthFunc(516);break;case gxe:t.depthFunc(517);break;default:t.depthFunc(515)}Se=qe}},setLocked:function(qe){J=qe},setClear:function(qe){Oe!==qe&&(t.clearDepth(qe),Oe=qe)},reset:function(){J=!1,fe=null,Se=null,Oe=null}}}function o(){let J=!1,fe=null,Se=null,Oe=null,qe=null,vt=null,Et=null,un=null,Wi=null;return{setTest:function(Ot){J||(Ot?K(2960):oe(2960))},setMask:function(Ot){fe!==Ot&&!J&&(t.stencilMask(Ot),fe=Ot)},setFunc:function(Ot,Wn,Xn){(Se!==Ot||Oe!==Wn||qe!==Xn)&&(t.stencilFunc(Ot,Wn,Xn),Se=Ot,Oe=Wn,qe=Xn)},setOp:function(Ot,Wn,Xn){(vt!==Ot||Et!==Wn||un!==Xn)&&(t.stencilOp(Ot,Wn,Xn),vt=Ot,Et=Wn,un=Xn)},setLocked:function(Ot){J=Ot},setClear:function(Ot){Wi!==Ot&&(t.clearStencil(Ot),Wi=Ot)},reset:function(){J=!1,fe=null,Se=null,Oe=null,qe=null,vt=null,Et=null,un=null,Wi=null}}}let a=new r,l=new s,c=new o,h=new WeakMap,u=new WeakMap,d={},f={},p=new WeakMap,v=[],g=null,m=!1,y=null,w=null,b=null,A=null,S=null,T=null,M=null,E=!1,P=null,R=null,F=null,B=null,k=null,j=t.getParameter(35661),Z=!1,ee=0,O=t.getParameter(7938);O.indexOf("WebGL")!==-1?(ee=parseFloat(/^WebGL (\d)/.exec(O)[1]),Z=ee>=1):O.indexOf("OpenGL ES")!==-1&&(ee=parseFloat(/^OpenGL ES (\d)/.exec(O)[1]),Z=ee>=2);let W=null,H={},Y=t.getParameter(3088),z=t.getParameter(2978),X=new Zt().fromArray(Y),q=new Zt().fromArray(z);function re(J,fe,Se){let Oe=new Uint8Array(4),qe=t.createTexture();t.bindTexture(J,qe),t.texParameteri(J,10241,9728),t.texParameteri(J,10240,9728);for(let vt=0;vt<Se;vt++)t.texImage2D(fe+vt,0,6408,1,1,0,6408,5121,Oe);return qe}let G={};G[3553]=re(3553,3553,1),G[34067]=re(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),K(2929),l.setFunc(NL),Ae(!1),_e(EH),K(2884),me(Ir);function K(J){d[J]!==!0&&(t.enable(J),d[J]=!0)}function oe(J){d[J]!==!1&&(t.disable(J),d[J]=!1)}function ve(J,fe){return f[J]!==fe?(t.bindFramebuffer(J,fe),f[J]=fe,i&&(J===36009&&(f[36160]=fe),J===36160&&(f[36009]=fe)),!0):!1}function $(J,fe){let Se=v,Oe=!1;if(J)if(Se=p.get(fe),Se===void 0&&(Se=[],p.set(fe,Se)),J.isWebGLMultipleRenderTargets){let qe=J.texture;if(Se.length!==qe.length||Se[0]!==36064){for(let vt=0,Et=qe.length;vt<Et;vt++)Se[vt]=36064+vt;Se.length=qe.length,Oe=!0}}else Se[0]!==36064&&(Se[0]=36064,Oe=!0);else Se[0]!==1029&&(Se[0]=1029,Oe=!0);Oe&&(n.isWebGL2?t.drawBuffers(Se):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(Se))}function se(J){return g!==J?(t.useProgram(J),g=J,!0):!1}let ne={[xm]:32774,[$ye]:32778,[exe]:32779};if(i)ne[DH]=32775,ne[RH]=32776;else{let J=e.get("EXT_blend_minmax");J!==null&&(ne[DH]=J.MIN_EXT,ne[RH]=J.MAX_EXT)}let ie={[txe]:0,[nxe]:1,[ixe]:768,[HQ]:770,[cxe]:776,[axe]:774,[sxe]:772,[rxe]:769,[VQ]:771,[lxe]:775,[oxe]:773};function me(J,fe,Se,Oe,qe,vt,Et,un){if(J===Ir){m===!0&&(oe(3042),m=!1);return}if(m===!1&&(K(3042),m=!0),J!==Zye){if(J!==y||un!==E){if((w!==xm||S!==xm)&&(t.blendEquation(32774),w=xm,S=xm),un)switch(J){case fg:t.blendFuncSeparate(1,771,1,771);break;case CH:t.blendFunc(1,1);break;case TH:t.blendFuncSeparate(0,769,0,1);break;case PH:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",J);break}else switch(J){case fg:t.blendFuncSeparate(770,771,1,771);break;case CH:t.blendFunc(770,1);break;case TH:t.blendFuncSeparate(0,769,0,1);break;case PH:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",J);break}b=null,A=null,T=null,M=null,y=J,E=un}return}qe=qe||fe,vt=vt||Se,Et=Et||Oe,(fe!==w||qe!==S)&&(t.blendEquationSeparate(ne[fe],ne[qe]),w=fe,S=qe),(Se!==b||Oe!==A||vt!==T||Et!==M)&&(t.blendFuncSeparate(ie[Se],ie[Oe],ie[vt],ie[Et]),b=Se,A=Oe,T=vt,M=Et),y=J,E=!1}function xe(J,fe){J.side===co?oe(2884):K(2884);let Se=J.side===xr;fe&&(Se=!Se),Ae(Se),J.blending===fg&&J.transparent===!1?me(Ir):me(J.blending,J.blendEquation,J.blendSrc,J.blendDst,J.blendEquationAlpha,J.blendSrcAlpha,J.blendDstAlpha,J.premultipliedAlpha),l.setFunc(J.depthFunc),l.setTest(J.depthTest),l.setMask(J.depthWrite),a.setMask(J.colorWrite);let Oe=J.stencilWrite;c.setTest(Oe),Oe&&(c.setMask(J.stencilWriteMask),c.setFunc(J.stencilFunc,J.stencilRef,J.stencilFuncMask),c.setOp(J.stencilFail,J.stencilZFail,J.stencilZPass)),Re(J.polygonOffset,J.polygonOffsetFactor,J.polygonOffsetUnits),J.alphaToCoverage===!0?K(32926):oe(32926)}function Ae(J){P!==J&&(J?t.frontFace(2304):t.frontFace(2305),P=J)}function _e(J){J!==Kye?(K(2884),J!==R&&(J===EH?t.cullFace(1029):J===Jye?t.cullFace(1028):t.cullFace(1032))):oe(2884),R=J}function Ee(J){J!==F&&(Z&&t.lineWidth(J),F=J)}function Re(J,fe,Se){J?(K(32823),(B!==fe||k!==Se)&&(t.polygonOffset(fe,Se),B=fe,k=Se)):oe(32823)}function Ue(J){J?K(3089):oe(3089)}function Ne(J){J===void 0&&(J=33984+j-1),W!==J&&(t.activeTexture(J),W=J)}function U(J,fe,Se){Se===void 0&&(W===null?Se=33984+j-1:Se=W);let Oe=H[Se];Oe===void 0&&(Oe={type:void 0,texture:void 0},H[Se]=Oe),(Oe.type!==J||Oe.texture!==fe)&&(W!==Se&&(t.activeTexture(Se),W=Se),t.bindTexture(J,fe||G[J]),Oe.type=J,Oe.texture=fe)}function L(){let J=H[W];J!==void 0&&J.type!==void 0&&(t.bindTexture(J.type,null),J.type=void 0,J.texture=void 0)}function te(){try{t.compressedTexImage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function we(){try{t.compressedTexImage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Te(){try{t.texSubImage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Ie(){try{t.texSubImage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Qe(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Ge(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function ye(){try{t.texStorage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Ve(){try{t.texStorage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function ue(){try{t.texImage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Me(){try{t.texImage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Be(J){X.equals(J)===!1&&(t.scissor(J.x,J.y,J.z,J.w),X.copy(J))}function ze(J){q.equals(J)===!1&&(t.viewport(J.x,J.y,J.z,J.w),q.copy(J))}function $e(J,fe){let Se=u.get(fe);Se===void 0&&(Se=new WeakMap,u.set(fe,Se));let Oe=Se.get(J);Oe===void 0&&(Oe=t.getUniformBlockIndex(fe,J.name),Se.set(J,Oe))}function dt(J,fe){let Se=u.get(fe).get(J);h.get(fe)!==Se&&(t.uniformBlockBinding(fe,Se,J.__bindingPointIndex),h.set(fe,Se))}function Bt(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),i===!0&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),d={},W=null,H={},f={},p=new WeakMap,v=[],g=null,m=!1,y=null,w=null,b=null,A=null,S=null,T=null,M=null,E=!1,P=null,R=null,F=null,B=null,k=null,X.set(0,0,t.canvas.width,t.canvas.height),q.set(0,0,t.canvas.width,t.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:K,disable:oe,bindFramebuffer:ve,drawBuffers:$,useProgram:se,setBlending:me,setMaterial:xe,setFlipSided:Ae,setCullFace:_e,setLineWidth:Ee,setPolygonOffset:Re,setScissorTest:Ue,activeTexture:Ne,bindTexture:U,unbindTexture:L,compressedTexImage2D:te,compressedTexImage3D:we,texImage2D:ue,texImage3D:Me,updateUBOMapping:$e,uniformBlockBinding:dt,texStorage2D:ye,texStorage3D:Ve,texSubImage2D:Te,texSubImage3D:Ie,compressedTexSubImage2D:Qe,compressedTexSubImage3D:Ge,scissor:Be,viewport:ze,reset:Bt}}function XSe(t,e,n,i,r,s,o){let a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,h=r.maxTextureSize,u=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap,v,g=new WeakMap,m=!1;try{m=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(U,L){return m?new OffscreenCanvas(U,L):BA("canvas")}function w(U,L,te,we){let Te=1;if((U.width>we||U.height>we)&&(Te=we/Math.max(U.width,U.height)),Te<1||L===!0)if(typeof HTMLImageElement<"u"&&U instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&U instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&U instanceof ImageBitmap){let Ie=L?IA:Math.floor,Qe=Ie(Te*U.width),Ge=Ie(Te*U.height);v===void 0&&(v=y(Qe,Ge));let ye=te?y(Qe,Ge):v;return ye.width=Qe,ye.height=Ge,ye.getContext("2d").drawImage(U,0,0,Qe,Ge),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+U.width+"x"+U.height+") to ("+Qe+"x"+Ge+")."),ye}else return"data"in U&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+U.width+"x"+U.height+")."),U;return U}function b(U){return VL(U.width)&&VL(U.height)}function A(U){return a?!1:U.wrapS!==ro||U.wrapT!==ro||U.minFilter!==oi&&U.minFilter!==En}function S(U,L){return U.generateMipmaps&&L&&U.minFilter!==oi&&U.minFilter!==En}function T(U){t.generateMipmap(U)}function M(U,L,te,we,Te=!1){if(a===!1)return L;if(U!==null){if(t[U]!==void 0)return t[U];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+U+"'")}let Ie=L;return L===6403&&(te===5126&&(Ie=33326),te===5131&&(Ie=33325),te===5121&&(Ie=33321)),L===33319&&(te===5126&&(Ie=33328),te===5131&&(Ie=33327),te===5121&&(Ie=33323)),L===6408&&(te===5126&&(Ie=34836),te===5131&&(Ie=34842),te===5121&&(Ie=we===Wt&&Te===!1?35907:32856),te===32819&&(Ie=32854),te===32820&&(Ie=32855)),(Ie===33325||Ie===33326||Ie===33327||Ie===33328||Ie===34842||Ie===34836)&&e.get("EXT_color_buffer_float"),Ie}function E(U,L,te){return S(U,te)===!0||U.isFramebufferTexture&&U.minFilter!==oi&&U.minFilter!==En?Math.log2(Math.max(L.width,L.height))+1:U.mipmaps!==void 0&&U.mipmaps.length>0?U.mipmaps.length:U.isCompressedTexture&&Array.isArray(U.image)?L.mipmaps.length:1}function P(U){return U===oi||U===LH||U===NP?9728:9729}function R(U){let L=U.target;L.removeEventListener("dispose",R),B(L),L.isVideoTexture&&p.delete(L)}function F(U){let L=U.target;L.removeEventListener("dispose",F),j(L)}function B(U){let L=i.get(U);if(L.__webglInit===void 0)return;let te=U.source,we=g.get(te);if(we){let Te=we[L.__cacheKey];Te.usedTimes--,Te.usedTimes===0&&k(U),Object.keys(we).length===0&&g.delete(te)}i.remove(U)}function k(U){let L=i.get(U);t.deleteTexture(L.__webglTexture);let te=U.source,we=g.get(te);delete we[L.__cacheKey],o.memory.textures--}function j(U){let L=U.texture,te=i.get(U),we=i.get(L);if(we.__webglTexture!==void 0&&(t.deleteTexture(we.__webglTexture),o.memory.textures--),U.depthTexture&&U.depthTexture.dispose(),U.isWebGLCubeRenderTarget)for(let Te=0;Te<6;Te++)t.deleteFramebuffer(te.__webglFramebuffer[Te]),te.__webglDepthbuffer&&t.deleteRenderbuffer(te.__webglDepthbuffer[Te]);else{if(t.deleteFramebuffer(te.__webglFramebuffer),te.__webglDepthbuffer&&t.deleteRenderbuffer(te.__webglDepthbuffer),te.__webglMultisampledFramebuffer&&t.deleteFramebuffer(te.__webglMultisampledFramebuffer),te.__webglColorRenderbuffer)for(let Te=0;Te<te.__webglColorRenderbuffer.length;Te++)te.__webglColorRenderbuffer[Te]&&t.deleteRenderbuffer(te.__webglColorRenderbuffer[Te]);te.__webglDepthRenderbuffer&&t.deleteRenderbuffer(te.__webglDepthRenderbuffer)}if(U.isWebGLMultipleRenderTargets)for(let Te=0,Ie=L.length;Te<Ie;Te++){let Qe=i.get(L[Te]);Qe.__webglTexture&&(t.deleteTexture(Qe.__webglTexture),o.memory.textures--),i.remove(L[Te])}i.remove(L),i.remove(U)}let Z=0;function ee(){Z=0}function O(){let U=Z;return U>=l&&console.warn("THREE.WebGLTextures: Trying to use "+U+" texture units while this GPU supports only "+l),Z+=1,U}function W(U){let L=[];return L.push(U.wrapS),L.push(U.wrapT),L.push(U.wrapR||0),L.push(U.magFilter),L.push(U.minFilter),L.push(U.anisotropy),L.push(U.internalFormat),L.push(U.format),L.push(U.type),L.push(U.generateMipmaps),L.push(U.premultiplyAlpha),L.push(U.flipY),L.push(U.unpackAlignment),L.push(U.encoding),L.join()}function H(U,L){let te=i.get(U);if(U.isVideoTexture&&Ue(U),U.isRenderTargetTexture===!1&&U.version>0&&te.__version!==U.version){let we=U.image;if(we===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(we.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{oe(te,U,L);return}}n.bindTexture(3553,te.__webglTexture,33984+L)}function Y(U,L){let te=i.get(U);if(U.version>0&&te.__version!==U.version){oe(te,U,L);return}n.bindTexture(35866,te.__webglTexture,33984+L)}function z(U,L){let te=i.get(U);if(U.version>0&&te.__version!==U.version){oe(te,U,L);return}n.bindTexture(32879,te.__webglTexture,33984+L)}function X(U,L){let te=i.get(U);if(U.version>0&&te.__version!==U.version){ve(te,U,L);return}n.bindTexture(34067,te.__webglTexture,33984+L)}let q={[Rx]:10497,[ro]:33071,[zL]:33648},re={[oi]:9728,[LH]:9984,[NP]:9986,[En]:9729,[Axe]:9985,[Xg]:9987};function G(U,L,te){if(te?(t.texParameteri(U,10242,q[L.wrapS]),t.texParameteri(U,10243,q[L.wrapT]),(U===32879||U===35866)&&t.texParameteri(U,32882,q[L.wrapR]),t.texParameteri(U,10240,re[L.magFilter]),t.texParameteri(U,10241,re[L.minFilter])):(t.texParameteri(U,10242,33071),t.texParameteri(U,10243,33071),(U===32879||U===35866)&&t.texParameteri(U,32882,33071),(L.wrapS!==ro||L.wrapT!==ro)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(U,10240,P(L.magFilter)),t.texParameteri(U,10241,P(L.minFilter)),L.minFilter!==oi&&L.minFilter!==En&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){let we=e.get("EXT_texture_filter_anisotropic");if(L.magFilter===oi||L.minFilter!==NP&&L.minFilter!==Xg||L.type===ph&&e.has("OES_texture_float_linear")===!1||a===!1&&L.type===Lx&&e.has("OES_texture_half_float_linear")===!1)return;(L.anisotropy>1||i.get(L).__currentAnisotropy)&&(t.texParameterf(U,we.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(L.anisotropy,r.getMaxAnisotropy())),i.get(L).__currentAnisotropy=L.anisotropy)}}function K(U,L){let te=!1;U.__webglInit===void 0&&(U.__webglInit=!0,L.addEventListener("dispose",R));let we=L.source,Te=g.get(we);Te===void 0&&(Te={},g.set(we,Te));let Ie=W(L);if(Ie!==U.__cacheKey){Te[Ie]===void 0&&(Te[Ie]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,te=!0),Te[Ie].usedTimes++;let Qe=Te[U.__cacheKey];Qe!==void 0&&(Te[U.__cacheKey].usedTimes--,Qe.usedTimes===0&&k(L)),U.__cacheKey=Ie,U.__webglTexture=Te[Ie].texture}return te}function oe(U,L,te){let we=3553;(L.isDataArrayTexture||L.isCompressedArrayTexture)&&(we=35866),L.isData3DTexture&&(we=32879);let Te=K(U,L),Ie=L.source;n.bindTexture(we,U.__webglTexture,33984+te);let Qe=i.get(Ie);if(Ie.version!==Qe.__version||Te===!0){n.activeTexture(33984+te),t.pixelStorei(37440,L.flipY),t.pixelStorei(37441,L.premultiplyAlpha),t.pixelStorei(3317,L.unpackAlignment),t.pixelStorei(37443,0);let Ge=A(L)&&b(L.image)===!1,ye=w(L.image,Ge,!1,h);ye=Ne(L,ye);let Ve=b(ye)||a,ue=s.convert(L.format,L.encoding),Me=s.convert(L.type),Be=M(L.internalFormat,ue,Me,L.encoding,L.isVideoTexture);G(we,L,Ve);let ze,$e=L.mipmaps,dt=a&&L.isVideoTexture!==!0,Bt=Qe.__version===void 0||Te===!0,J=E(L,ye,Ve);if(L.isDepthTexture)Be=6402,a?L.type===ph?Be=36012:L.type===fh?Be=33190:L.type===yf?Be=35056:Be=33189:L.type===ph&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),L.format===xf&&Be===6402&&L.type!==XQ&&L.type!==fh&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),L.type=fh,Me=s.convert(L.type)),L.format===Uf&&Be===6402&&(Be=34041,L.type!==yf&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),L.type=yf,Me=s.convert(L.type))),Bt&&(dt?n.texStorage2D(3553,1,Be,ye.width,ye.height):n.texImage2D(3553,0,Be,ye.width,ye.height,0,ue,Me,null));else if(L.isDataTexture)if($e.length>0&&Ve){dt&&Bt&&n.texStorage2D(3553,J,Be,$e[0].width,$e[0].height);for(let fe=0,Se=$e.length;fe<Se;fe++)ze=$e[fe],dt?n.texSubImage2D(3553,fe,0,0,ze.width,ze.height,ue,Me,ze.data):n.texImage2D(3553,fe,Be,ze.width,ze.height,0,ue,Me,ze.data);L.generateMipmaps=!1}else dt?(Bt&&n.texStorage2D(3553,J,Be,ye.width,ye.height),n.texSubImage2D(3553,0,0,0,ye.width,ye.height,ue,Me,ye.data)):n.texImage2D(3553,0,Be,ye.width,ye.height,0,ue,Me,ye.data);else if(L.isCompressedTexture)if(L.isCompressedArrayTexture){dt&&Bt&&n.texStorage3D(35866,J,Be,$e[0].width,$e[0].height,ye.depth);for(let fe=0,Se=$e.length;fe<Se;fe++)ze=$e[fe],L.format!==ka?ue!==null?dt?n.compressedTexSubImage3D(35866,fe,0,0,0,ze.width,ze.height,ye.depth,ue,ze.data,0,0):n.compressedTexImage3D(35866,fe,Be,ze.width,ze.height,ye.depth,0,ze.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):dt?n.texSubImage3D(35866,fe,0,0,0,ze.width,ze.height,ye.depth,ue,Me,ze.data):n.texImage3D(35866,fe,Be,ze.width,ze.height,ye.depth,0,ue,Me,ze.data)}else{dt&&Bt&&n.texStorage2D(3553,J,Be,$e[0].width,$e[0].height);for(let fe=0,Se=$e.length;fe<Se;fe++)ze=$e[fe],L.format!==ka?ue!==null?dt?n.compressedTexSubImage2D(3553,fe,0,0,ze.width,ze.height,ue,ze.data):n.compressedTexImage2D(3553,fe,Be,ze.width,ze.height,0,ze.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):dt?n.texSubImage2D(3553,fe,0,0,ze.width,ze.height,ue,Me,ze.data):n.texImage2D(3553,fe,Be,ze.width,ze.height,0,ue,Me,ze.data)}else if(L.isDataArrayTexture)dt?(Bt&&n.texStorage3D(35866,J,Be,ye.width,ye.height,ye.depth),n.texSubImage3D(35866,0,0,0,0,ye.width,ye.height,ye.depth,ue,Me,ye.data)):n.texImage3D(35866,0,Be,ye.width,ye.height,ye.depth,0,ue,Me,ye.data);else if(L.isData3DTexture)dt?(Bt&&n.texStorage3D(32879,J,Be,ye.width,ye.height,ye.depth),n.texSubImage3D(32879,0,0,0,0,ye.width,ye.height,ye.depth,ue,Me,ye.data)):n.texImage3D(32879,0,Be,ye.width,ye.height,ye.depth,0,ue,Me,ye.data);else if(L.isFramebufferTexture){if(Bt)if(dt)n.texStorage2D(3553,J,Be,ye.width,ye.height);else{let fe=ye.width,Se=ye.height;for(let Oe=0;Oe<J;Oe++)n.texImage2D(3553,Oe,Be,fe,Se,0,ue,Me,null),fe>>=1,Se>>=1}}else if($e.length>0&&Ve){dt&&Bt&&n.texStorage2D(3553,J,Be,$e[0].width,$e[0].height);for(let fe=0,Se=$e.length;fe<Se;fe++)ze=$e[fe],dt?n.texSubImage2D(3553,fe,0,0,ue,Me,ze):n.texImage2D(3553,fe,Be,ue,Me,ze);L.generateMipmaps=!1}else dt?(Bt&&n.texStorage2D(3553,J,Be,ye.width,ye.height),n.texSubImage2D(3553,0,0,0,ue,Me,ye)):n.texImage2D(3553,0,Be,ue,Me,ye);S(L,Ve)&&T(we),Qe.__version=Ie.version,L.onUpdate&&L.onUpdate(L)}U.__version=L.version}function ve(U,L,te){if(L.image.length!==6)return;let we=K(U,L),Te=L.source;n.bindTexture(34067,U.__webglTexture,33984+te);let Ie=i.get(Te);if(Te.version!==Ie.__version||we===!0){n.activeTexture(33984+te),t.pixelStorei(37440,L.flipY),t.pixelStorei(37441,L.premultiplyAlpha),t.pixelStorei(3317,L.unpackAlignment),t.pixelStorei(37443,0);let Qe=L.isCompressedTexture||L.image[0].isCompressedTexture,Ge=L.image[0]&&L.image[0].isDataTexture,ye=[];for(let fe=0;fe<6;fe++)!Qe&&!Ge?ye[fe]=w(L.image[fe],!1,!0,c):ye[fe]=Ge?L.image[fe].image:L.image[fe],ye[fe]=Ne(L,ye[fe]);let Ve=ye[0],ue=b(Ve)||a,Me=s.convert(L.format,L.encoding),Be=s.convert(L.type),ze=M(L.internalFormat,Me,Be,L.encoding),$e=a&&L.isVideoTexture!==!0,dt=Ie.__version===void 0||we===!0,Bt=E(L,Ve,ue);G(34067,L,ue);let J;if(Qe){$e&&dt&&n.texStorage2D(34067,Bt,ze,Ve.width,Ve.height);for(let fe=0;fe<6;fe++){J=ye[fe].mipmaps;for(let Se=0;Se<J.length;Se++){let Oe=J[Se];L.format!==ka?Me!==null?$e?n.compressedTexSubImage2D(34069+fe,Se,0,0,Oe.width,Oe.height,Me,Oe.data):n.compressedTexImage2D(34069+fe,Se,ze,Oe.width,Oe.height,0,Oe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):$e?n.texSubImage2D(34069+fe,Se,0,0,Oe.width,Oe.height,Me,Be,Oe.data):n.texImage2D(34069+fe,Se,ze,Oe.width,Oe.height,0,Me,Be,Oe.data)}}}else{J=L.mipmaps,$e&&dt&&(J.length>0&&Bt++,n.texStorage2D(34067,Bt,ze,ye[0].width,ye[0].height));for(let fe=0;fe<6;fe++)if(Ge){$e?n.texSubImage2D(34069+fe,0,0,0,ye[fe].width,ye[fe].height,Me,Be,ye[fe].data):n.texImage2D(34069+fe,0,ze,ye[fe].width,ye[fe].height,0,Me,Be,ye[fe].data);for(let Se=0;Se<J.length;Se++){let Oe=J[Se].image[fe].image;$e?n.texSubImage2D(34069+fe,Se+1,0,0,Oe.width,Oe.height,Me,Be,Oe.data):n.texImage2D(34069+fe,Se+1,ze,Oe.width,Oe.height,0,Me,Be,Oe.data)}}else{$e?n.texSubImage2D(34069+fe,0,0,0,Me,Be,ye[fe]):n.texImage2D(34069+fe,0,ze,Me,Be,ye[fe]);for(let Se=0;Se<J.length;Se++){let Oe=J[Se];$e?n.texSubImage2D(34069+fe,Se+1,0,0,Me,Be,Oe.image[fe]):n.texImage2D(34069+fe,Se+1,ze,Me,Be,Oe.image[fe])}}}S(L,ue)&&T(34067),Ie.__version=Te.version,L.onUpdate&&L.onUpdate(L)}U.__version=L.version}function $(U,L,te,we,Te){let Ie=s.convert(te.format,te.encoding),Qe=s.convert(te.type),Ge=M(te.internalFormat,Ie,Qe,te.encoding);i.get(L).__hasExternalTextures||(Te===32879||Te===35866?n.texImage3D(Te,0,Ge,L.width,L.height,L.depth,0,Ie,Qe,null):n.texImage2D(Te,0,Ge,L.width,L.height,0,Ie,Qe,null)),n.bindFramebuffer(36160,U),Re(L)?d.framebufferTexture2DMultisampleEXT(36160,we,Te,i.get(te).__webglTexture,0,Ee(L)):(Te===3553||Te>=34069&&Te<=34074)&&t.framebufferTexture2D(36160,we,Te,i.get(te).__webglTexture,0),n.bindFramebuffer(36160,null)}function se(U,L,te){if(t.bindRenderbuffer(36161,U),L.depthBuffer&&!L.stencilBuffer){let we=33189;if(te||Re(L)){let Te=L.depthTexture;Te&&Te.isDepthTexture&&(Te.type===ph?we=36012:Te.type===fh&&(we=33190));let Ie=Ee(L);Re(L)?d.renderbufferStorageMultisampleEXT(36161,Ie,we,L.width,L.height):t.renderbufferStorageMultisample(36161,Ie,we,L.width,L.height)}else t.renderbufferStorage(36161,we,L.width,L.height);t.framebufferRenderbuffer(36160,36096,36161,U)}else if(L.depthBuffer&&L.stencilBuffer){let we=Ee(L);te&&Re(L)===!1?t.renderbufferStorageMultisample(36161,we,35056,L.width,L.height):Re(L)?d.renderbufferStorageMultisampleEXT(36161,we,35056,L.width,L.height):t.renderbufferStorage(36161,34041,L.width,L.height),t.framebufferRenderbuffer(36160,33306,36161,U)}else{let we=L.isWebGLMultipleRenderTargets===!0?L.texture:[L.texture];for(let Te=0;Te<we.length;Te++){let Ie=we[Te],Qe=s.convert(Ie.format,Ie.encoding),Ge=s.convert(Ie.type),ye=M(Ie.internalFormat,Qe,Ge,Ie.encoding),Ve=Ee(L);te&&Re(L)===!1?t.renderbufferStorageMultisample(36161,Ve,ye,L.width,L.height):Re(L)?d.renderbufferStorageMultisampleEXT(36161,Ve,ye,L.width,L.height):t.renderbufferStorage(36161,ye,L.width,L.height)}}t.bindRenderbuffer(36161,null)}function ne(U,L){if(L&&L.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,U),!(L.depthTexture&&L.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(L.depthTexture).__webglTexture||L.depthTexture.image.width!==L.width||L.depthTexture.image.height!==L.height)&&(L.depthTexture.image.width=L.width,L.depthTexture.image.height=L.height,L.depthTexture.needsUpdate=!0),H(L.depthTexture,0);let te=i.get(L.depthTexture).__webglTexture,we=Ee(L);if(L.depthTexture.format===xf)Re(L)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,te,0,we):t.framebufferTexture2D(36160,36096,3553,te,0);else if(L.depthTexture.format===Uf)Re(L)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,te,0,we):t.framebufferTexture2D(36160,33306,3553,te,0);else throw new Error("Unknown depthTexture format")}function ie(U){let L=i.get(U),te=U.isWebGLCubeRenderTarget===!0;if(U.depthTexture&&!L.__autoAllocateDepthBuffer){if(te)throw new Error("target.depthTexture not supported in Cube render targets");ne(L.__webglFramebuffer,U)}else if(te){L.__webglDepthbuffer=[];for(let we=0;we<6;we++)n.bindFramebuffer(36160,L.__webglFramebuffer[we]),L.__webglDepthbuffer[we]=t.createRenderbuffer(),se(L.__webglDepthbuffer[we],U,!1)}else n.bindFramebuffer(36160,L.__webglFramebuffer),L.__webglDepthbuffer=t.createRenderbuffer(),se(L.__webglDepthbuffer,U,!1);n.bindFramebuffer(36160,null)}function me(U,L,te){let we=i.get(U);L!==void 0&&$(we.__webglFramebuffer,U,U.texture,36064,3553),te!==void 0&&ie(U)}function xe(U){let L=U.texture,te=i.get(U),we=i.get(L);U.addEventListener("dispose",F),U.isWebGLMultipleRenderTargets!==!0&&(we.__webglTexture===void 0&&(we.__webglTexture=t.createTexture()),we.__version=L.version,o.memory.textures++);let Te=U.isWebGLCubeRenderTarget===!0,Ie=U.isWebGLMultipleRenderTargets===!0,Qe=b(U)||a;if(Te){te.__webglFramebuffer=[];for(let Ge=0;Ge<6;Ge++)te.__webglFramebuffer[Ge]=t.createFramebuffer()}else{if(te.__webglFramebuffer=t.createFramebuffer(),Ie)if(r.drawBuffers){let Ge=U.texture;for(let ye=0,Ve=Ge.length;ye<Ve;ye++){let ue=i.get(Ge[ye]);ue.__webglTexture===void 0&&(ue.__webglTexture=t.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&U.samples>0&&Re(U)===!1){let Ge=Ie?L:[L];te.__webglMultisampledFramebuffer=t.createFramebuffer(),te.__webglColorRenderbuffer=[],n.bindFramebuffer(36160,te.__webglMultisampledFramebuffer);for(let ye=0;ye<Ge.length;ye++){let Ve=Ge[ye];te.__webglColorRenderbuffer[ye]=t.createRenderbuffer(),t.bindRenderbuffer(36161,te.__webglColorRenderbuffer[ye]);let ue=s.convert(Ve.format,Ve.encoding),Me=s.convert(Ve.type),Be=M(Ve.internalFormat,ue,Me,Ve.encoding,U.isXRRenderTarget===!0),ze=Ee(U);t.renderbufferStorageMultisample(36161,ze,Be,U.width,U.height),t.framebufferRenderbuffer(36160,36064+ye,36161,te.__webglColorRenderbuffer[ye])}t.bindRenderbuffer(36161,null),U.depthBuffer&&(te.__webglDepthRenderbuffer=t.createRenderbuffer(),se(te.__webglDepthRenderbuffer,U,!0)),n.bindFramebuffer(36160,null)}}if(Te){n.bindTexture(34067,we.__webglTexture),G(34067,L,Qe);for(let Ge=0;Ge<6;Ge++)$(te.__webglFramebuffer[Ge],U,L,36064,34069+Ge);S(L,Qe)&&T(34067),n.unbindTexture()}else if(Ie){let Ge=U.texture;for(let ye=0,Ve=Ge.length;ye<Ve;ye++){let ue=Ge[ye],Me=i.get(ue);n.bindTexture(3553,Me.__webglTexture),G(3553,ue,Qe),$(te.__webglFramebuffer,U,ue,36064+ye,3553),S(ue,Qe)&&T(3553)}n.unbindTexture()}else{let Ge=3553;(U.isWebGL3DRenderTarget||U.isWebGLArrayRenderTarget)&&(a?Ge=U.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(Ge,we.__webglTexture),G(Ge,L,Qe),$(te.__webglFramebuffer,U,L,36064,Ge),S(L,Qe)&&T(Ge),n.unbindTexture()}U.depthBuffer&&ie(U)}function Ae(U){let L=b(U)||a,te=U.isWebGLMultipleRenderTargets===!0?U.texture:[U.texture];for(let we=0,Te=te.length;we<Te;we++){let Ie=te[we];if(S(Ie,L)){let Qe=U.isWebGLCubeRenderTarget?34067:3553,Ge=i.get(Ie).__webglTexture;n.bindTexture(Qe,Ge),T(Qe),n.unbindTexture()}}}function _e(U){if(a&&U.samples>0&&Re(U)===!1){let L=U.isWebGLMultipleRenderTargets?U.texture:[U.texture],te=U.width,we=U.height,Te=16384,Ie=[],Qe=U.stencilBuffer?33306:36096,Ge=i.get(U),ye=U.isWebGLMultipleRenderTargets===!0;if(ye)for(let Ve=0;Ve<L.length;Ve++)n.bindFramebuffer(36160,Ge.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+Ve,36161,null),n.bindFramebuffer(36160,Ge.__webglFramebuffer),t.framebufferTexture2D(36009,36064+Ve,3553,null,0);n.bindFramebuffer(36008,Ge.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,Ge.__webglFramebuffer);for(let Ve=0;Ve<L.length;Ve++){Ie.push(36064+Ve),U.depthBuffer&&Ie.push(Qe);let ue=Ge.__ignoreDepthValues!==void 0?Ge.__ignoreDepthValues:!1;if(ue===!1&&(U.depthBuffer&&(Te|=256),U.stencilBuffer&&(Te|=1024)),ye&&t.framebufferRenderbuffer(36008,36064,36161,Ge.__webglColorRenderbuffer[Ve]),ue===!0&&(t.invalidateFramebuffer(36008,[Qe]),t.invalidateFramebuffer(36009,[Qe])),ye){let Me=i.get(L[Ve]).__webglTexture;t.framebufferTexture2D(36009,36064,3553,Me,0)}t.blitFramebuffer(0,0,te,we,0,0,te,we,Te,9728),f&&t.invalidateFramebuffer(36008,Ie)}if(n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,null),ye)for(let Ve=0;Ve<L.length;Ve++){n.bindFramebuffer(36160,Ge.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+Ve,36161,Ge.__webglColorRenderbuffer[Ve]);let ue=i.get(L[Ve]).__webglTexture;n.bindFramebuffer(36160,Ge.__webglFramebuffer),t.framebufferTexture2D(36009,36064+Ve,3553,ue,0)}n.bindFramebuffer(36009,Ge.__webglMultisampledFramebuffer)}}function Ee(U){return Math.min(u,U.samples)}function Re(U){let L=i.get(U);return a&&U.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&L.__useRenderToTexture!==!1}function Ue(U){let L=o.render.frame;p.get(U)!==L&&(p.set(U,L),U.update())}function Ne(U,L){let te=U.encoding,we=U.format,Te=U.type;return U.isCompressedTexture===!0||U.isVideoTexture===!0||U.format===HL||te!==tc&&(te===Wt?a===!1?e.has("EXT_sRGB")===!0&&we===ka?(U.format=HL,U.minFilter=En,U.generateMipmaps=!1):L=KQ.sRGBToLinear(L):(we!==ka||Te!==Zr)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",te)),L}this.allocateTextureUnit=O,this.resetTextureUnits=ee,this.setTexture2D=H,this.setTexture2DArray=Y,this.setTexture3D=z,this.setTextureCube=X,this.rebindTextures=me,this.setupRenderTarget=xe,this.updateRenderTargetMipmap=Ae,this.updateMultisampleRenderTarget=_e,this.setupDepthRenderbuffer=ie,this.setupFrameBufferTexture=$,this.useMultisampledRTT=Re}function YSe(t,e,n){let i=n.isWebGL2;function r(s,o=null){let a;if(s===Zr)return 5121;if(s===Txe)return 32819;if(s===Pxe)return 32820;if(s===Mxe)return 5120;if(s===Exe)return 5122;if(s===XQ)return 5123;if(s===Cxe)return 5124;if(s===fh)return 5125;if(s===ph)return 5126;if(s===Lx)return i?5131:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===Dxe)return 6406;if(s===ka)return 6408;if(s===Rxe)return 6409;if(s===Lxe)return 6410;if(s===xf)return 6402;if(s===Uf)return 34041;if(s===HL)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===Ixe)return 6403;if(s===Bxe)return 36244;if(s===Oxe)return 33319;if(s===Fxe)return 33320;if(s===Nxe)return 36249;if(s===UP||s===kP||s===zP||s===GP)if(o===Wt)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===UP)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===kP)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===zP)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===GP)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===UP)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===kP)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===zP)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===GP)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===IH||s===BH||s===OH||s===FH)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===IH)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===BH)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===OH)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===FH)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===Uxe)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===NH||s===UH)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===NH)return o===Wt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===UH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===kH||s===zH||s===GH||s===HH||s===VH||s===jH||s===WH||s===XH||s===YH||s===qH||s===QH||s===KH||s===JH||s===ZH)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===kH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===zH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===GH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===HH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===VH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===jH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===WH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===XH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===YH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===qH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===QH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===KH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===JH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===ZH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===HP)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===HP)return o===Wt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===kxe||s===$H||s===eV||s===tV)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===HP)return a.COMPRESSED_RED_RGTC1_EXT;if(s===$H)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===eV)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===tV)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===yf?i?34042:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):t[s]!==void 0?t[s]:null}return{convert:r}}var qSe=class extends Qr{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t}},Xm=class extends Nn{constructor(){super(),this.isGroup=!0,this.type="Group"}},QSe={type:"move"},f2=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Xm,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Xm,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new N,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new N),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Xm,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new N,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new N),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){let e=this._hand;if(e)for(let n of t.hand.values())this._getHandJoint(e,n)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,e,n){let i=null,r=null,s=null,o=this._targetRay,a=this._grip,l=this._hand;if(t&&e.session.visibilityState!=="visible-blurred"){if(l&&t.hand){s=!0;for(let p of t.hand.values()){let v=e.getJointPose(p,n),g=this._getHandJoint(l,p);v!==null&&(g.matrix.fromArray(v.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.jointRadius=v.radius),g.visible=v!==null}let c=l.joints["index-finger-tip"],h=l.joints["thumb-tip"],u=c.position.distanceTo(h.position),d=.02,f=.005;l.inputState.pinching&&u>d+f?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&u<=d-f&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else a!==null&&t.gripSpace&&(r=e.getPose(t.gripSpace,n),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1));o!==null&&(i=e.getPose(t.targetRaySpace,n),i===null&&r!==null&&(i=r),i!==null&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(QSe)))}return o!==null&&(o.visible=i!==null),a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),this}_getHandJoint(t,e){if(t.joints[e.jointName]===void 0){let n=new Xm;n.matrixAutoUpdate=!1,n.visible=!1,t.joints[e.jointName]=n,t.add(n)}return t.joints[e.jointName]}},zO=class extends br{constructor(t,e,n,i,r,s,o,a,l,c){if(c=c!==void 0?c:xf,c!==xf&&c!==Uf)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&c===xf&&(n=fh),n===void 0&&c===Uf&&(n=yf),super(null,i,r,s,o,a,c,n,l),this.isDepthTexture=!0,this.image={width:t,height:e},this.magFilter=o!==void 0?o:oi,this.minFilter=a!==void 0?a:oi,this.flipY=!1,this.generateMipmaps=!1}},KSe=class extends _s{constructor(t,e){super();let n=this,i=null,r=1,s=null,o="local-floor",a=1,l=null,c=null,h=null,u=null,d=null,f=null,p=e.getContextAttributes(),v=null,g=null,m=[],y=[],w=new Set,b=new Map,A=new Qr;A.layers.enable(1),A.viewport=new Zt;let S=new Qr;S.layers.enable(2),S.viewport=new Zt;let T=[A,S],M=new qSe;M.layers.enable(1),M.layers.enable(2);let E=null,P=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Y){let z=m[Y];return z===void 0&&(z=new f2,m[Y]=z),z.getTargetRaySpace()},this.getControllerGrip=function(Y){let z=m[Y];return z===void 0&&(z=new f2,m[Y]=z),z.getGripSpace()},this.getHand=function(Y){let z=m[Y];return z===void 0&&(z=new f2,m[Y]=z),z.getHandSpace()};function R(Y){let z=y.indexOf(Y.inputSource);if(z===-1)return;let X=m[z];X!==void 0&&X.dispatchEvent({type:Y.type,data:Y.inputSource})}function F(){i.removeEventListener("select",R),i.removeEventListener("selectstart",R),i.removeEventListener("selectend",R),i.removeEventListener("squeeze",R),i.removeEventListener("squeezestart",R),i.removeEventListener("squeezeend",R),i.removeEventListener("end",F),i.removeEventListener("inputsourceschange",B);for(let Y=0;Y<m.length;Y++){let z=y[Y];z!==null&&(y[Y]=null,m[Y].disconnect(z))}E=null,P=null,t.setRenderTarget(v),d=null,u=null,h=null,i=null,g=null,H.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Y){r=Y,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Y){o=Y,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(Y){l=Y},this.getBaseLayer=function(){return u!==null?u:d},this.getBinding=function(){return h},this.getFrame=function(){return f},this.getSession=function(){return i},this.setSession=async function(Y){if(i=Y,i!==null){if(v=t.getRenderTarget(),i.addEventListener("select",R),i.addEventListener("selectstart",R),i.addEventListener("selectend",R),i.addEventListener("squeeze",R),i.addEventListener("squeezestart",R),i.addEventListener("squeezeend",R),i.addEventListener("end",F),i.addEventListener("inputsourceschange",B),p.xrCompatible!==!0&&await e.makeXRCompatible(),i.renderState.layers===void 0||t.capabilities.isWebGL2===!1){let z={antialias:i.renderState.layers===void 0?p.antialias:!0,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:r};d=new XRWebGLLayer(i,e,z),i.updateRenderState({baseLayer:d}),g=new er(d.framebufferWidth,d.framebufferHeight,{format:ka,type:Zr,encoding:t.outputEncoding,stencilBuffer:p.stencil})}else{let z=null,X=null,q=null;p.depth&&(q=p.stencil?35056:33190,z=p.stencil?Uf:xf,X=p.stencil?yf:fh);let re={colorFormat:32856,depthFormat:q,scaleFactor:r};h=new XRWebGLBinding(i,e),u=h.createProjectionLayer(re),i.updateRenderState({layers:[u]}),g=new er(u.textureWidth,u.textureHeight,{format:ka,type:Zr,depthTexture:new zO(u.textureWidth,u.textureHeight,X,void 0,void 0,void 0,void 0,void 0,void 0,z),stencilBuffer:p.stencil,encoding:t.outputEncoding,samples:p.antialias?4:0});let G=t.properties.get(g);G.__ignoreDepthValues=u.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(a),l=null,s=await i.requestReferenceSpace(o),H.setContext(i),H.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};function B(Y){for(let z=0;z<Y.removed.length;z++){let X=Y.removed[z],q=y.indexOf(X);q>=0&&(y[q]=null,m[q].disconnect(X))}for(let z=0;z<Y.added.length;z++){let X=Y.added[z],q=y.indexOf(X);if(q===-1){for(let G=0;G<m.length;G++)if(G>=y.length){y.push(X),q=G;break}else if(y[G]===null){y[G]=X,q=G;break}if(q===-1)break}let re=m[q];re&&re.connect(X)}}let k=new N,j=new N;function Z(Y,z,X){k.setFromMatrixPosition(z.matrixWorld),j.setFromMatrixPosition(X.matrixWorld);let q=k.distanceTo(j),re=z.projectionMatrix.elements,G=X.projectionMatrix.elements,K=re[14]/(re[10]-1),oe=re[14]/(re[10]+1),ve=(re[9]+1)/re[5],$=(re[9]-1)/re[5],se=(re[8]-1)/re[0],ne=(G[8]+1)/G[0],ie=K*se,me=K*ne,xe=q/(-se+ne),Ae=xe*-se;z.matrixWorld.decompose(Y.position,Y.quaternion,Y.scale),Y.translateX(Ae),Y.translateZ(xe),Y.matrixWorld.compose(Y.position,Y.quaternion,Y.scale),Y.matrixWorldInverse.copy(Y.matrixWorld).invert();let _e=K+xe,Ee=oe+xe,Re=ie-Ae,Ue=me+(q-Ae),Ne=ve*oe/Ee*_e,U=$*oe/Ee*_e;Y.projectionMatrix.makePerspective(Re,Ue,Ne,U,_e,Ee)}function ee(Y,z){z===null?Y.matrixWorld.copy(Y.matrix):Y.matrixWorld.multiplyMatrices(z.matrixWorld,Y.matrix),Y.matrixWorldInverse.copy(Y.matrixWorld).invert()}this.updateCamera=function(Y){if(i===null)return;M.near=S.near=A.near=Y.near,M.far=S.far=A.far=Y.far,(E!==M.near||P!==M.far)&&(i.updateRenderState({depthNear:M.near,depthFar:M.far}),E=M.near,P=M.far);let z=Y.parent,X=M.cameras;ee(M,z);for(let re=0;re<X.length;re++)ee(X[re],z);M.matrixWorld.decompose(M.position,M.quaternion,M.scale),Y.matrix.copy(M.matrix),Y.matrix.decompose(Y.position,Y.quaternion,Y.scale);let q=Y.children;for(let re=0,G=q.length;re<G;re++)q[re].updateMatrixWorld(!0);X.length===2?Z(M,A,S):M.projectionMatrix.copy(A.projectionMatrix)},this.getCamera=function(){return M},this.getFoveation=function(){if(!(u===null&&d===null))return a},this.setFoveation=function(Y){a=Y,u!==null&&(u.fixedFoveation=Y),d!==null&&d.fixedFoveation!==void 0&&(d.fixedFoveation=Y)},this.getPlanes=function(){return w};let O=null;function W(Y,z){if(c=z.getViewerPose(l||s),f=z,c!==null){let X=c.views;d!==null&&(t.setRenderTargetFramebuffer(g,d.framebuffer),t.setRenderTarget(g));let q=!1;X.length!==M.cameras.length&&(M.cameras.length=0,q=!0);for(let re=0;re<X.length;re++){let G=X[re],K=null;if(d!==null)K=d.getViewport(G);else{let ve=h.getViewSubImage(u,G);K=ve.viewport,re===0&&(t.setRenderTargetTextures(g,ve.colorTexture,u.ignoreDepthValues?void 0:ve.depthStencilTexture),t.setRenderTarget(g))}let oe=T[re];oe===void 0&&(oe=new Qr,oe.layers.enable(re),oe.viewport=new Zt,T[re]=oe),oe.matrix.fromArray(G.transform.matrix),oe.projectionMatrix.fromArray(G.projectionMatrix),oe.viewport.set(K.x,K.y,K.width,K.height),re===0&&M.matrix.copy(oe.matrix),q===!0&&M.cameras.push(oe)}}for(let X=0;X<m.length;X++){let q=y[X],re=m[X];q!==null&&re!==void 0&&re.update(q,z,l||s)}if(O&&O(Y,z),z.detectedPlanes){n.dispatchEvent({type:"planesdetected",data:z.detectedPlanes});let X=null;for(let q of w)z.detectedPlanes.has(q)||(X===null&&(X=[]),X.push(q));if(X!==null)for(let q of X)w.delete(q),b.delete(q),n.dispatchEvent({type:"planeremoved",data:q});for(let q of z.detectedPlanes)if(!w.has(q))w.add(q),b.set(q,z.lastChangedTime),n.dispatchEvent({type:"planeadded",data:q});else{let re=b.get(q);q.lastChangedTime>re&&(b.set(q,q.lastChangedTime),n.dispatchEvent({type:"planechanged",data:q}))}}f=null}let H=new tK;H.setAnimationLoop(W),this.setAnimationLoop=function(Y){O=Y},this.dispose=function(){}}};function JSe(t,e){function n(v,g){g.color.getRGB(v.fogColor.value,eK(t)),g.isFog?(v.fogNear.value=g.near,v.fogFar.value=g.far):g.isFogExp2&&(v.fogDensity.value=g.density)}function i(v,g,m,y,w){g.isMeshBasicMaterial||g.isMeshLambertMaterial?r(v,g):g.isMeshToonMaterial?(r(v,g),h(v,g)):g.isMeshPhongMaterial?(r(v,g),c(v,g)):g.isMeshStandardMaterial?(r(v,g),u(v,g),g.isMeshPhysicalMaterial&&d(v,g,w)):g.isMeshMatcapMaterial?(r(v,g),f(v,g)):g.isMeshDepthMaterial?r(v,g):g.isMeshDistanceMaterial?(r(v,g),p(v,g)):g.isMeshNormalMaterial?r(v,g):g.isLineBasicMaterial?(s(v,g),g.isLineDashedMaterial&&o(v,g)):g.isPointsMaterial?a(v,g,m,y):g.isSpriteMaterial?l(v,g):g.isShadowMaterial?(v.color.value.copy(g.color),v.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function r(v,g){v.opacity.value=g.opacity,g.color&&v.diffuse.value.copy(g.color),g.emissive&&v.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(v.map.value=g.map),g.alphaMap&&(v.alphaMap.value=g.alphaMap),g.bumpMap&&(v.bumpMap.value=g.bumpMap,v.bumpScale.value=g.bumpScale,g.side===xr&&(v.bumpScale.value*=-1)),g.displacementMap&&(v.displacementMap.value=g.displacementMap,v.displacementScale.value=g.displacementScale,v.displacementBias.value=g.displacementBias),g.emissiveMap&&(v.emissiveMap.value=g.emissiveMap),g.normalMap&&(v.normalMap.value=g.normalMap,v.normalScale.value.copy(g.normalScale),g.side===xr&&v.normalScale.value.negate()),g.specularMap&&(v.specularMap.value=g.specularMap),g.alphaTest>0&&(v.alphaTest.value=g.alphaTest);let m=e.get(g).envMap;if(m&&(v.envMap.value=m,v.flipEnvMap.value=m.isCubeTexture&&m.isRenderTargetTexture===!1?-1:1,v.reflectivity.value=g.reflectivity,v.ior.value=g.ior,v.refractionRatio.value=g.refractionRatio),g.lightMap){v.lightMap.value=g.lightMap;let b=t.physicallyCorrectLights!==!0?Math.PI:1;v.lightMapIntensity.value=g.lightMapIntensity*b}g.aoMap&&(v.aoMap.value=g.aoMap,v.aoMapIntensity.value=g.aoMapIntensity);let y;g.map?y=g.map:g.specularMap?y=g.specularMap:g.displacementMap?y=g.displacementMap:g.normalMap?y=g.normalMap:g.bumpMap?y=g.bumpMap:g.roughnessMap?y=g.roughnessMap:g.metalnessMap?y=g.metalnessMap:g.alphaMap?y=g.alphaMap:g.emissiveMap?y=g.emissiveMap:g.clearcoatMap?y=g.clearcoatMap:g.clearcoatNormalMap?y=g.clearcoatNormalMap:g.clearcoatRoughnessMap?y=g.clearcoatRoughnessMap:g.iridescenceMap?y=g.iridescenceMap:g.iridescenceThicknessMap?y=g.iridescenceThicknessMap:g.specularIntensityMap?y=g.specularIntensityMap:g.specularColorMap?y=g.specularColorMap:g.transmissionMap?y=g.transmissionMap:g.thicknessMap?y=g.thicknessMap:g.sheenColorMap?y=g.sheenColorMap:g.sheenRoughnessMap&&(y=g.sheenRoughnessMap),y!==void 0&&(y.isWebGLRenderTarget&&(y=y.texture),y.matrixAutoUpdate===!0&&y.updateMatrix(),v.uvTransform.value.copy(y.matrix));let w;g.aoMap?w=g.aoMap:g.lightMap&&(w=g.lightMap),w!==void 0&&(w.isWebGLRenderTarget&&(w=w.texture),w.matrixAutoUpdate===!0&&w.updateMatrix(),v.uv2Transform.value.copy(w.matrix))}function s(v,g){v.diffuse.value.copy(g.color),v.opacity.value=g.opacity}function o(v,g){v.dashSize.value=g.dashSize,v.totalSize.value=g.dashSize+g.gapSize,v.scale.value=g.scale}function a(v,g,m,y){v.diffuse.value.copy(g.color),v.opacity.value=g.opacity,v.size.value=g.size*m,v.scale.value=y*.5,g.map&&(v.map.value=g.map),g.alphaMap&&(v.alphaMap.value=g.alphaMap),g.alphaTest>0&&(v.alphaTest.value=g.alphaTest);let w;g.map?w=g.map:g.alphaMap&&(w=g.alphaMap),w!==void 0&&(w.matrixAutoUpdate===!0&&w.updateMatrix(),v.uvTransform.value.copy(w.matrix))}function l(v,g){v.diffuse.value.copy(g.color),v.opacity.value=g.opacity,v.rotation.value=g.rotation,g.map&&(v.map.value=g.map),g.alphaMap&&(v.alphaMap.value=g.alphaMap),g.alphaTest>0&&(v.alphaTest.value=g.alphaTest);let m;g.map?m=g.map:g.alphaMap&&(m=g.alphaMap),m!==void 0&&(m.matrixAutoUpdate===!0&&m.updateMatrix(),v.uvTransform.value.copy(m.matrix))}function c(v,g){v.specular.value.copy(g.specular),v.shininess.value=Math.max(g.shininess,1e-4)}function h(v,g){g.gradientMap&&(v.gradientMap.value=g.gradientMap)}function u(v,g){v.roughness.value=g.roughness,v.metalness.value=g.metalness,g.roughnessMap&&(v.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(v.metalnessMap.value=g.metalnessMap),e.get(g).envMap&&(v.envMapIntensity.value=g.envMapIntensity)}function d(v,g,m){v.ior.value=g.ior,g.sheen>0&&(v.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),v.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(v.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(v.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(v.clearcoat.value=g.clearcoat,v.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(v.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(v.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),v.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===xr&&v.clearcoatNormalScale.value.negate())),g.iridescence>0&&(v.iridescence.value=g.iridescence,v.iridescenceIOR.value=g.iridescenceIOR,v.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],v.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(v.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(v.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(v.transmission.value=g.transmission,v.transmissionSamplerMap.value=m.texture,v.transmissionSamplerSize.value.set(m.width,m.height),g.transmissionMap&&(v.transmissionMap.value=g.transmissionMap),v.thickness.value=g.thickness,g.thicknessMap&&(v.thicknessMap.value=g.thicknessMap),v.attenuationDistance.value=g.attenuationDistance,v.attenuationColor.value.copy(g.attenuationColor)),v.specularIntensity.value=g.specularIntensity,v.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(v.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(v.specularColorMap.value=g.specularColorMap)}function f(v,g){g.matcap&&(v.matcap.value=g.matcap)}function p(v,g){v.referencePosition.value.copy(g.referencePosition),v.nearDistance.value=g.nearDistance,v.farDistance.value=g.farDistance}return{refreshFogUniforms:n,refreshMaterialUniforms:i}}function ZSe(t,e,n,i){let r={},s={},o=[],a=n.isWebGL2?t.getParameter(35375):0;function l(y,w){let b=w.program;i.uniformBlockBinding(y,b)}function c(y,w){let b=r[y.id];b===void 0&&(p(y),b=h(y),r[y.id]=b,y.addEventListener("dispose",g));let A=w.program;i.updateUBOMapping(y,A);let S=e.render.frame;s[y.id]!==S&&(d(y),s[y.id]=S)}function h(y){let w=u();y.__bindingPointIndex=w;let b=t.createBuffer(),A=y.__size,S=y.usage;return t.bindBuffer(35345,b),t.bufferData(35345,A,S),t.bindBuffer(35345,null),t.bindBufferBase(35345,w,b),b}function u(){for(let y=0;y<a;y++)if(o.indexOf(y)===-1)return o.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(y){let w=r[y.id],b=y.uniforms,A=y.__cache;t.bindBuffer(35345,w);for(let S=0,T=b.length;S<T;S++){let M=b[S];if(f(M,S,A)===!0){let E=M.__offset,P=Array.isArray(M.value)?M.value:[M.value],R=0;for(let F=0;F<P.length;F++){let B=P[F],k=v(B);typeof B=="number"?(M.__data[0]=B,t.bufferSubData(35345,E+R,M.__data)):B.isMatrix3?(M.__data[0]=B.elements[0],M.__data[1]=B.elements[1],M.__data[2]=B.elements[2],M.__data[3]=B.elements[0],M.__data[4]=B.elements[3],M.__data[5]=B.elements[4],M.__data[6]=B.elements[5],M.__data[7]=B.elements[0],M.__data[8]=B.elements[6],M.__data[9]=B.elements[7],M.__data[10]=B.elements[8],M.__data[11]=B.elements[0]):(B.toArray(M.__data,R),R+=k.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(35345,E,M.__data)}}t.bindBuffer(35345,null)}function f(y,w,b){let A=y.value;if(b[w]===void 0){if(typeof A=="number")b[w]=A;else{let S=Array.isArray(A)?A:[A],T=[];for(let M=0;M<S.length;M++)T.push(S[M].clone());b[w]=T}return!0}else if(typeof A=="number"){if(b[w]!==A)return b[w]=A,!0}else{let S=Array.isArray(b[w])?b[w]:[b[w]],T=Array.isArray(A)?A:[A];for(let M=0;M<S.length;M++){let E=S[M];if(E.equals(T[M])===!1)return E.copy(T[M]),!0}}return!1}function p(y){let w=y.uniforms,b=0,A=16,S=0;for(let T=0,M=w.length;T<M;T++){let E=w[T],P={boundary:0,storage:0},R=Array.isArray(E.value)?E.value:[E.value];for(let F=0,B=R.length;F<B;F++){let k=R[F],j=v(k);P.boundary+=j.boundary,P.storage+=j.storage}if(E.__data=new Float32Array(P.storage/Float32Array.BYTES_PER_ELEMENT),E.__offset=b,T>0){S=b%A;let F=A-S;S!==0&&F-P.boundary<0&&(b+=A-S,E.__offset=b)}b+=P.storage}return S=b%A,S>0&&(b+=A-S),y.__size=b,y.__cache={},this}function v(y){let w={boundary:0,storage:0};return typeof y=="number"?(w.boundary=4,w.storage=4):y.isVector2?(w.boundary=8,w.storage=8):y.isVector3||y.isColor?(w.boundary=16,w.storage=12):y.isVector4?(w.boundary=16,w.storage=16):y.isMatrix3?(w.boundary=48,w.storage=48):y.isMatrix4?(w.boundary=64,w.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),w}function g(y){let w=y.target;w.removeEventListener("dispose",g);let b=o.indexOf(w.__bindingPointIndex);o.splice(b,1),t.deleteBuffer(r[w.id]),delete r[w.id],delete s[w.id]}function m(){for(let y in r)t.deleteBuffer(r[y]);o=[],r={},s={}}return{bind:l,update:c,dispose:m}}function $Se(){let t=BA("canvas");return t.style.display="block",t}function aK(t={}){this.isWebGLRenderer=!0;let e=t.canvas!==void 0?t.canvas:$Se(),n=t.context!==void 0?t.context:null,i=t.depth!==void 0?t.depth:!0,r=t.stencil!==void 0?t.stencil:!0,s=t.antialias!==void 0?t.antialias:!1,o=t.premultipliedAlpha!==void 0?t.premultipliedAlpha:!0,a=t.preserveDrawingBuffer!==void 0?t.preserveDrawingBuffer:!1,l=t.powerPreference!==void 0?t.powerPreference:"default",c=t.failIfMajorPerformanceCaveat!==void 0?t.failIfMajorPerformanceCaveat:!1,h;n!==null?h=n.getContextAttributes().alpha:h=t.alpha!==void 0?t.alpha:!1;let u=null,d=null,f=[],p=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=tc,this.physicallyCorrectLights=!1,this.toneMapping=Zc,this.toneMappingExposure=1;let v=this,g=!1,m=0,y=0,w=null,b=-1,A=null,S=new Zt,T=new Zt,M=null,E=e.width,P=e.height,R=1,F=null,B=null,k=new Zt(0,0,E,P),j=new Zt(0,0,E,P),Z=!1,ee=new UO,O=!1,W=!1,H=null,Y=new nt,z=new be,X=new N,q={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function re(){return w===null?R:1}let G=n;function K(he,Q){for(let de=0;de<he.length;de++){let le=he[de],ce=e.getContext(le,Q);if(ce!==null)return ce}return null}try{let he={alpha:!0,depth:i,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${vv}`),e.addEventListener("webglcontextlost",Be,!1),e.addEventListener("webglcontextrestored",ze,!1),e.addEventListener("webglcontextcreationerror",$e,!1),G===null){let Q=["webgl2","webgl","experimental-webgl"];if(v.isWebGL1Renderer===!0&&Q.shift(),G=K(Q,he),G===null)throw K(Q)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}G.getShaderPrecisionFormat===void 0&&(G.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(he){throw console.error("THREE.WebGLRenderer: "+he.message),he}let oe,ve,$,se,ne,ie,me,xe,Ae,_e,Ee,Re,Ue,Ne,U,L,te,we,Te,Ie,Qe,Ge,ye,Ve;function ue(){oe=new dbe(G),ve=new obe(G,oe,t),oe.init(ve),Ge=new YSe(G,oe,ve),$=new WSe(G,oe,ve),se=new mbe,ne=new LSe,ie=new XSe(G,oe,$,ne,ve,Ge,se),me=new lbe(v),xe=new hbe(v),Ae=new A1e(G,ve),ye=new rbe(G,oe,Ae,ve),_e=new fbe(G,Ae,se,ye),Ee=new xbe(G,_e,Ae,se),Te=new ybe(G,ve,ie),L=new abe(ne),Re=new RSe(v,me,xe,oe,ve,ye,L),Ue=new JSe(v,ne),Ne=new BSe,U=new zSe(oe,ve),we=new ibe(v,me,xe,$,Ee,h,o),te=new jSe(v,Ee,ve),Ve=new ZSe(G,se,ve,$),Ie=new sbe(G,oe,se,ve),Qe=new pbe(G,oe,se,ve),se.programs=Re.programs,v.capabilities=ve,v.extensions=oe,v.properties=ne,v.renderLists=Ne,v.shadowMap=te,v.state=$,v.info=se}ue();let Me=new KSe(v,G);this.xr=Me,this.getContext=function(){return G},this.getContextAttributes=function(){return G.getContextAttributes()},this.forceContextLoss=function(){let he=oe.get("WEBGL_lose_context");he&&he.loseContext()},this.forceContextRestore=function(){let he=oe.get("WEBGL_lose_context");he&&he.restoreContext()},this.getPixelRatio=function(){return R},this.setPixelRatio=function(he){he!==void 0&&(R=he,this.setSize(E,P,!1))},this.getSize=function(he){return he.set(E,P)},this.setSize=function(he,Q,de){if(Me.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}E=he,P=Q,e.width=Math.floor(he*R),e.height=Math.floor(Q*R),de!==!1&&(e.style.width=he+"px",e.style.height=Q+"px"),this.setViewport(0,0,he,Q)},this.getDrawingBufferSize=function(he){return he.set(E*R,P*R).floor()},this.setDrawingBufferSize=function(he,Q,de){E=he,P=Q,R=de,e.width=Math.floor(he*de),e.height=Math.floor(Q*de),this.setViewport(0,0,he,Q)},this.getCurrentViewport=function(he){return he.copy(S)},this.getViewport=function(he){return he.copy(k)},this.setViewport=function(he,Q,de,le){he.isVector4?k.set(he.x,he.y,he.z,he.w):k.set(he,Q,de,le),$.viewport(S.copy(k).multiplyScalar(R).floor())},this.getScissor=function(he){return he.copy(j)},this.setScissor=function(he,Q,de,le){he.isVector4?j.set(he.x,he.y,he.z,he.w):j.set(he,Q,de,le),$.scissor(T.copy(j).multiplyScalar(R).floor())},this.getScissorTest=function(){return Z},this.setScissorTest=function(he){$.setScissorTest(Z=he)},this.setOpaqueSort=function(he){F=he},this.setTransparentSort=function(he){B=he},this.getClearColor=function(he){return he.copy(we.getClearColor())},this.setClearColor=function(){we.setClearColor.apply(we,arguments)},this.getClearAlpha=function(){return we.getClearAlpha()},this.setClearAlpha=function(){we.setClearAlpha.apply(we,arguments)},this.clear=function(he=!0,Q=!0,de=!0){let le=0;he&&(le|=16384),Q&&(le|=256),de&&(le|=1024),G.clear(le)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Be,!1),e.removeEventListener("webglcontextrestored",ze,!1),e.removeEventListener("webglcontextcreationerror",$e,!1),Ne.dispose(),U.dispose(),ne.dispose(),me.dispose(),xe.dispose(),Ee.dispose(),ye.dispose(),Ve.dispose(),Re.dispose(),Me.dispose(),Me.removeEventListener("sessionstart",Oe),Me.removeEventListener("sessionend",qe),H&&(H.dispose(),H=null),vt.stop()};function Be(he){he.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function ze(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;let he=se.autoReset,Q=te.enabled,de=te.autoUpdate,le=te.needsUpdate,ce=te.type;ue(),se.autoReset=he,te.enabled=Q,te.autoUpdate=de,te.needsUpdate=le,te.type=ce}function $e(he){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",he.statusMessage)}function dt(he){let Q=he.target;Q.removeEventListener("dispose",dt),Bt(Q)}function Bt(he){J(he),ne.remove(he)}function J(he){let Q=ne.get(he).programs;Q!==void 0&&(Q.forEach(function(de){Re.releaseProgram(de)}),he.isShaderMaterial&&Re.releaseShaderCache(he))}this.renderBufferDirect=function(he,Q,de,le,ce,De){Q===null&&(Q=q);let Ke=ce.isMesh&&ce.matrixWorld.determinant()<0,Ze=ip(he,Q,de,le,ce);$.setMaterial(le,Ke);let it=de.index,ht=1;le.wireframe===!0&&(it=_e.getWireframeAttribute(de),ht=2);let lt=de.drawRange,ot=de.attributes.position,Mt=lt.start*ht,Vt=(lt.start+lt.count)*ht;De!==null&&(Mt=Math.max(Mt,De.start*ht),Vt=Math.min(Vt,(De.start+De.count)*ht)),it!==null?(Mt=Math.max(Mt,0),Vt=Math.min(Vt,it.count)):ot!=null&&(Mt=Math.max(Mt,0),Vt=Math.min(Vt,ot.count));let Un=Vt-Mt;if(Un<0||Un===1/0)return;ye.setup(ce,le,Ze,de,it);let Si,vn=Ie;if(it!==null&&(Si=Ae.get(it),vn=Qe,vn.setIndex(Si)),ce.isMesh)le.wireframe===!0?($.setLineWidth(le.wireframeLinewidth*re()),vn.setMode(1)):vn.setMode(4);else if(ce.isLine){let yt=le.linewidth;yt===void 0&&(yt=1),$.setLineWidth(yt*re()),ce.isLineSegments?vn.setMode(1):ce.isLineLoop?vn.setMode(2):vn.setMode(3)}else ce.isPoints?vn.setMode(0):ce.isSprite&&vn.setMode(4);if(ce.isInstancedMesh)vn.renderInstances(Mt,Un,ce.count);else if(de.isInstancedBufferGeometry){let yt=de._maxInstanceCount!==void 0?de._maxInstanceCount:1/0,Qt=Math.min(de.instanceCount,yt);vn.renderInstances(Mt,Un,Qt)}else vn.render(Mt,Un)},this.compile=function(he,Q){function de(le,ce,De){le.transparent===!0&&le.side===co&&le.forceSinglePass===!1?(le.side=xr,le.needsUpdate=!0,Xn(le,ce,De),le.side=el,le.needsUpdate=!0,Xn(le,ce,De),le.side=co):Xn(le,ce,De)}d=U.get(he),d.init(),p.push(d),he.traverseVisible(function(le){le.isLight&&le.layers.test(Q.layers)&&(d.pushLight(le),le.castShadow&&d.pushShadow(le))}),d.setupLights(v.physicallyCorrectLights),he.traverse(function(le){let ce=le.material;if(ce)if(Array.isArray(ce))for(let De=0;De<ce.length;De++){let Ke=ce[De];de(Ke,he,le)}else de(ce,he,le)}),p.pop(),d=null};let fe=null;function Se(he){fe&&fe(he)}function Oe(){vt.stop()}function qe(){vt.start()}let vt=new tK;vt.setAnimationLoop(Se),typeof self<"u"&&vt.setContext(self),this.setAnimationLoop=function(he){fe=he,Me.setAnimationLoop(he),he===null?vt.stop():vt.start()},Me.addEventListener("sessionstart",Oe),Me.addEventListener("sessionend",qe),this.render=function(he,Q){if(Q!==void 0&&Q.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(g===!0)return;he.matrixWorldAutoUpdate===!0&&he.updateMatrixWorld(),Q.parent===null&&Q.matrixWorldAutoUpdate===!0&&Q.updateMatrixWorld(),Me.enabled===!0&&Me.isPresenting===!0&&(Me.cameraAutoUpdate===!0&&Me.updateCamera(Q),Q=Me.getCamera()),he.isScene===!0&&he.onBeforeRender(v,he,Q,w),d=U.get(he,p.length),d.init(),p.push(d),Y.multiplyMatrices(Q.projectionMatrix,Q.matrixWorldInverse),ee.setFromProjectionMatrix(Y),W=this.localClippingEnabled,O=L.init(this.clippingPlanes,W),u=Ne.get(he,f.length),u.init(),f.push(u),Et(he,Q,0,v.sortObjects),u.finish(),v.sortObjects===!0&&u.sort(F,B),O===!0&&L.beginShadows();let de=d.state.shadowsArray;if(te.render(de,he,Q),O===!0&&L.endShadows(),this.info.autoReset===!0&&this.info.reset(),we.render(u,he),d.setupLights(v.physicallyCorrectLights),Q.isArrayCamera){let le=Q.cameras;for(let ce=0,De=le.length;ce<De;ce++){let Ke=le[ce];un(u,he,Ke,Ke.viewport)}}else un(u,he,Q);w!==null&&(ie.updateMultisampleRenderTarget(w),ie.updateRenderTargetMipmap(w)),he.isScene===!0&&he.onAfterRender(v,he,Q),ye.resetDefaultState(),b=-1,A=null,p.pop(),p.length>0?d=p[p.length-1]:d=null,f.pop(),f.length>0?u=f[f.length-1]:u=null};function Et(he,Q,de,le){if(he.visible===!1)return;if(he.layers.test(Q.layers)){if(he.isGroup)de=he.renderOrder;else if(he.isLOD)he.autoUpdate===!0&&he.update(Q);else if(he.isLight)d.pushLight(he),he.castShadow&&d.pushShadow(he);else if(he.isSprite){if(!he.frustumCulled||ee.intersectsSprite(he)){le&&X.setFromMatrixPosition(he.matrixWorld).applyMatrix4(Y);let De=Ee.update(he),Ke=he.material;Ke.visible&&u.push(he,De,Ke,de,X.z,null)}}else if((he.isMesh||he.isLine||he.isPoints)&&(he.isSkinnedMesh&&he.skeleton.frame!==se.render.frame&&(he.skeleton.update(),he.skeleton.frame=se.render.frame),!he.frustumCulled||ee.intersectsObject(he))){le&&X.setFromMatrixPosition(he.matrixWorld).applyMatrix4(Y);let De=Ee.update(he),Ke=he.material;if(Array.isArray(Ke)){let Ze=De.groups;for(let it=0,ht=Ze.length;it<ht;it++){let lt=Ze[it],ot=Ke[lt.materialIndex];ot&&ot.visible&&u.push(he,De,ot,de,X.z,lt)}}else Ke.visible&&u.push(he,De,Ke,de,X.z,null)}}let ce=he.children;for(let De=0,Ke=ce.length;De<Ke;De++)Et(ce[De],Q,de,le)}function un(he,Q,de,le){let ce=he.opaque,De=he.transmissive,Ke=he.transparent;d.setupLightsView(de),O===!0&&L.setGlobalState(v.clippingPlanes,de),De.length>0&&Wi(ce,Q,de),le&&$.viewport(S.copy(le)),ce.length>0&&Ot(ce,Q,de),De.length>0&&Ot(De,Q,de),Ke.length>0&&Ot(Ke,Q,de),$.buffers.depth.setTest(!0),$.buffers.depth.setMask(!0),$.buffers.color.setMask(!0),$.setPolygonOffset(!1)}function Wi(he,Q,de){let le=ve.isWebGL2;H===null&&(H=new er(1,1,{generateMipmaps:!0,type:oe.has("EXT_color_buffer_half_float")?Lx:Zr,minFilter:Xg,samples:le&&s===!0?4:0})),v.getDrawingBufferSize(z),le?H.setSize(z.x,z.y):H.setSize(IA(z.x),IA(z.y));let ce=v.getRenderTarget();v.setRenderTarget(H),v.clear();let De=v.toneMapping;v.toneMapping=Zc,Ot(he,Q,de),v.toneMapping=De,ie.updateMultisampleRenderTarget(H),ie.updateRenderTargetMipmap(H),v.setRenderTarget(ce)}function Ot(he,Q,de){let le=Q.isScene===!0?Q.overrideMaterial:null;for(let ce=0,De=he.length;ce<De;ce++){let Ke=he[ce],Ze=Ke.object,it=Ke.geometry,ht=le===null?Ke.material:le,lt=Ke.group;Ze.layers.test(de.layers)&&Wn(Ze,Q,de,it,ht,lt)}}function Wn(he,Q,de,le,ce,De){he.onBeforeRender(v,Q,de,le,ce,De),he.modelViewMatrix.multiplyMatrices(de.matrixWorldInverse,he.matrixWorld),he.normalMatrix.getNormalMatrix(he.modelViewMatrix),ce.onBeforeRender(v,Q,de,le,he,De),ce.transparent===!0&&ce.side===co&&ce.forceSinglePass===!1?(ce.side=xr,ce.needsUpdate=!0,v.renderBufferDirect(de,Q,le,ce,he,De),ce.side=el,ce.needsUpdate=!0,v.renderBufferDirect(de,Q,le,ce,he,De),ce.side=co):v.renderBufferDirect(de,Q,le,ce,he,De),he.onAfterRender(v,Q,de,le,ce,De)}function Xn(he,Q,de){Q.isScene!==!0&&(Q=q);let le=ne.get(he),ce=d.state.lights,De=d.state.shadowsArray,Ke=ce.state.version,Ze=Re.getParameters(he,ce.state,De,Q,de),it=Re.getProgramCacheKey(Ze),ht=le.programs;le.environment=he.isMeshStandardMaterial?Q.environment:null,le.fog=Q.fog,le.envMap=(he.isMeshStandardMaterial?xe:me).get(he.envMap||le.environment),ht===void 0&&(he.addEventListener("dispose",dt),ht=new Map,le.programs=ht);let lt=ht.get(it);if(lt!==void 0){if(le.currentProgram===lt&&le.lightsStateVersion===Ke)return cc(he,Ze),lt}else Ze.uniforms=Re.getUniforms(he),he.onBuild(de,Ze,v),he.onBeforeCompile(Ze,v),lt=Re.acquireProgram(Ze,it),ht.set(it,lt),le.uniforms=Ze.uniforms;let ot=le.uniforms;(!he.isShaderMaterial&&!he.isRawShaderMaterial||he.clipping===!0)&&(ot.clippingPlanes=L.uniform),cc(he,Ze),le.needsLights=ad(he),le.lightsStateVersion=Ke,le.needsLights&&(ot.ambientLightColor.value=ce.state.ambient,ot.lightProbe.value=ce.state.probe,ot.directionalLights.value=ce.state.directional,ot.directionalLightShadows.value=ce.state.directionalShadow,ot.spotLights.value=ce.state.spot,ot.spotLightShadows.value=ce.state.spotShadow,ot.rectAreaLights.value=ce.state.rectArea,ot.ltc_1.value=ce.state.rectAreaLTC1,ot.ltc_2.value=ce.state.rectAreaLTC2,ot.pointLights.value=ce.state.point,ot.pointLightShadows.value=ce.state.pointShadow,ot.hemisphereLights.value=ce.state.hemi,ot.directionalShadowMap.value=ce.state.directionalShadowMap,ot.directionalShadowMatrix.value=ce.state.directionalShadowMatrix,ot.spotShadowMap.value=ce.state.spotShadowMap,ot.spotLightMatrix.value=ce.state.spotLightMatrix,ot.spotLightMap.value=ce.state.spotLightMap,ot.pointShadowMap.value=ce.state.pointShadowMap,ot.pointShadowMatrix.value=ce.state.pointShadowMatrix);let Mt=lt.getUniforms(),Vt=LS.seqWithValue(Mt.seq,ot);return le.currentProgram=lt,le.uniformsList=Vt,lt}function cc(he,Q){let de=ne.get(he);de.outputEncoding=Q.outputEncoding,de.instancing=Q.instancing,de.skinning=Q.skinning,de.morphTargets=Q.morphTargets,de.morphNormals=Q.morphNormals,de.morphColors=Q.morphColors,de.morphTargetsCount=Q.morphTargetsCount,de.numClippingPlanes=Q.numClippingPlanes,de.numIntersection=Q.numClipIntersection,de.vertexAlphas=Q.vertexAlphas,de.vertexTangents=Q.vertexTangents,de.toneMapping=Q.toneMapping}function ip(he,Q,de,le,ce){Q.isScene!==!0&&(Q=q),ie.resetTextureUnits();let De=Q.fog,Ke=le.isMeshStandardMaterial?Q.environment:null,Ze=w===null?v.outputEncoding:w.isXRRenderTarget===!0?w.texture.encoding:tc,it=(le.isMeshStandardMaterial?xe:me).get(le.envMap||Ke),ht=le.vertexColors===!0&&!!de.attributes.color&&de.attributes.color.itemSize===4,lt=!!le.normalMap&&!!de.attributes.tangent,ot=!!de.morphAttributes.position,Mt=!!de.morphAttributes.normal,Vt=!!de.morphAttributes.color,Un=le.toneMapped?v.toneMapping:Zc,Si=de.morphAttributes.position||de.morphAttributes.normal||de.morphAttributes.color,vn=Si!==void 0?Si.length:0,yt=ne.get(le),Qt=d.state.lights;if(O===!0&&(W===!0||he!==A)){let dn=he===A&&le.id===b;L.setState(le,he,dn)}let ga=!1;le.version===yt.__version?(yt.needsLights&&yt.lightsStateVersion!==Qt.state.version||yt.outputEncoding!==Ze||ce.isInstancedMesh&&yt.instancing===!1||!ce.isInstancedMesh&&yt.instancing===!0||ce.isSkinnedMesh&&yt.skinning===!1||!ce.isSkinnedMesh&&yt.skinning===!0||yt.envMap!==it||le.fog===!0&&yt.fog!==De||yt.numClippingPlanes!==void 0&&(yt.numClippingPlanes!==L.numPlanes||yt.numIntersection!==L.numIntersection)||yt.vertexAlphas!==ht||yt.vertexTangents!==lt||yt.morphTargets!==ot||yt.morphNormals!==Mt||yt.morphColors!==Vt||yt.toneMapping!==Un||ve.isWebGL2===!0&&yt.morphTargetsCount!==vn)&&(ga=!0):(ga=!0,yt.__version=le.version);let Bn=yt.currentProgram;ga===!0&&(Bn=Xn(le,Q,ce));let bs=!1,es=!1,ar=!1,Gt=Bn.getUniforms(),It=yt.uniforms;if($.useProgram(Bn.program)&&(bs=!0,es=!0,ar=!0),le.id!==b&&(b=le.id,es=!0),bs||A!==he){if(Gt.setValue(G,"projectionMatrix",he.projectionMatrix),ve.logarithmicDepthBuffer&&Gt.setValue(G,"logDepthBufFC",2/(Math.log(he.far+1)/Math.LN2)),A!==he&&(A=he,es=!0,ar=!0),le.isShaderMaterial||le.isMeshPhongMaterial||le.isMeshToonMaterial||le.isMeshStandardMaterial||le.envMap){let dn=Gt.map.cameraPosition;dn!==void 0&&dn.setValue(G,X.setFromMatrixPosition(he.matrixWorld))}(le.isMeshPhongMaterial||le.isMeshToonMaterial||le.isMeshLambertMaterial||le.isMeshBasicMaterial||le.isMeshStandardMaterial||le.isShaderMaterial)&&Gt.setValue(G,"isOrthographic",he.isOrthographicCamera===!0),(le.isMeshPhongMaterial||le.isMeshToonMaterial||le.isMeshLambertMaterial||le.isMeshBasicMaterial||le.isMeshStandardMaterial||le.isShaderMaterial||le.isShadowMaterial||ce.isSkinnedMesh)&&Gt.setValue(G,"viewMatrix",he.matrixWorldInverse)}if(ce.isSkinnedMesh){Gt.setOptional(G,ce,"bindMatrix"),Gt.setOptional(G,ce,"bindMatrixInverse");let dn=ce.skeleton;dn&&(ve.floatVertexTextures?(dn.boneTexture===null&&dn.computeBoneTexture(),Gt.setValue(G,"boneTexture",dn.boneTexture,ie),Gt.setValue(G,"boneTextureSize",dn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let Li=de.morphAttributes;if((Li.position!==void 0||Li.normal!==void 0||Li.color!==void 0&&ve.isWebGL2===!0)&&Te.update(ce,de,le,Bn),(es||yt.receiveShadow!==ce.receiveShadow)&&(yt.receiveShadow=ce.receiveShadow,Gt.setValue(G,"receiveShadow",ce.receiveShadow)),le.isMeshGouraudMaterial&&le.envMap!==null&&(It.envMap.value=it,It.flipEnvMap.value=it.isCubeTexture&&it.isRenderTargetTexture===!1?-1:1),es&&(Gt.setValue(G,"toneMappingExposure",v.toneMappingExposure),yt.needsLights&&rp(It,ar),De&&le.fog===!0&&Ue.refreshFogUniforms(It,De),Ue.refreshMaterialUniforms(It,le,R,P,H),LS.upload(G,yt.uniformsList,It,ie)),le.isShaderMaterial&&le.uniformsNeedUpdate===!0&&(LS.upload(G,yt.uniformsList,It,ie),le.uniformsNeedUpdate=!1),le.isSpriteMaterial&&Gt.setValue(G,"center",ce.center),Gt.setValue(G,"modelViewMatrix",ce.modelViewMatrix),Gt.setValue(G,"normalMatrix",ce.normalMatrix),Gt.setValue(G,"modelMatrix",ce.matrixWorld),le.isShaderMaterial||le.isRawShaderMaterial){let dn=le.uniformsGroups;for(let yn=0,js=dn.length;yn<js;yn++)if(ve.isWebGL2){let va=dn[yn];Ve.update(va,Bn),Ve.bind(va,Bn)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Bn}function rp(he,Q){he.ambientLightColor.needsUpdate=Q,he.lightProbe.needsUpdate=Q,he.directionalLights.needsUpdate=Q,he.directionalLightShadows.needsUpdate=Q,he.pointLights.needsUpdate=Q,he.pointLightShadows.needsUpdate=Q,he.spotLights.needsUpdate=Q,he.spotLightShadows.needsUpdate=Q,he.rectAreaLights.needsUpdate=Q,he.hemisphereLights.needsUpdate=Q}function ad(he){return he.isMeshLambertMaterial||he.isMeshToonMaterial||he.isMeshPhongMaterial||he.isMeshStandardMaterial||he.isShadowMaterial||he.isShaderMaterial&&he.lights===!0}this.getActiveCubeFace=function(){return m},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return w},this.setRenderTargetTextures=function(he,Q,de){ne.get(he.texture).__webglTexture=Q,ne.get(he.depthTexture).__webglTexture=de;let le=ne.get(he);le.__hasExternalTextures=!0,le.__hasExternalTextures&&(le.__autoAllocateDepthBuffer=de===void 0,le.__autoAllocateDepthBuffer||oe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),le.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(he,Q){let de=ne.get(he);de.__webglFramebuffer=Q,de.__useDefaultFramebuffer=Q===void 0},this.setRenderTarget=function(he,Q=0,de=0){w=he,m=Q,y=de;let le=!0,ce=null,De=!1,Ke=!1;if(he){let Ze=ne.get(he);Ze.__useDefaultFramebuffer!==void 0?($.bindFramebuffer(36160,null),le=!1):Ze.__webglFramebuffer===void 0?ie.setupRenderTarget(he):Ze.__hasExternalTextures&&ie.rebindTextures(he,ne.get(he.texture).__webglTexture,ne.get(he.depthTexture).__webglTexture);let it=he.texture;(it.isData3DTexture||it.isDataArrayTexture||it.isCompressedArrayTexture)&&(Ke=!0);let ht=ne.get(he).__webglFramebuffer;he.isWebGLCubeRenderTarget?(ce=ht[Q],De=!0):ve.isWebGL2&&he.samples>0&&ie.useMultisampledRTT(he)===!1?ce=ne.get(he).__webglMultisampledFramebuffer:ce=ht,S.copy(he.viewport),T.copy(he.scissor),M=he.scissorTest}else S.copy(k).multiplyScalar(R).floor(),T.copy(j).multiplyScalar(R).floor(),M=Z;if($.bindFramebuffer(36160,ce)&&ve.drawBuffers&&le&&$.drawBuffers(he,ce),$.viewport(S),$.scissor(T),$.setScissorTest(M),De){let Ze=ne.get(he.texture);G.framebufferTexture2D(36160,36064,34069+Q,Ze.__webglTexture,de)}else if(Ke){let Ze=ne.get(he.texture),it=Q||0;G.framebufferTextureLayer(36160,36064,Ze.__webglTexture,de||0,it)}b=-1},this.readRenderTargetPixels=function(he,Q,de,le,ce,De,Ke){if(!(he&&he.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Ze=ne.get(he).__webglFramebuffer;if(he.isWebGLCubeRenderTarget&&Ke!==void 0&&(Ze=Ze[Ke]),Ze){$.bindFramebuffer(36160,Ze);try{let it=he.texture,ht=it.format,lt=it.type;if(ht!==ka&&Ge.convert(ht)!==G.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let ot=lt===Lx&&(oe.has("EXT_color_buffer_half_float")||ve.isWebGL2&&oe.has("EXT_color_buffer_float"));if(lt!==Zr&&Ge.convert(lt)!==G.getParameter(35738)&&!(lt===ph&&(ve.isWebGL2||oe.has("OES_texture_float")||oe.has("WEBGL_color_buffer_float")))&&!ot){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Q>=0&&Q<=he.width-le&&de>=0&&de<=he.height-ce&&G.readPixels(Q,de,le,ce,Ge.convert(ht),Ge.convert(lt),De)}finally{let it=w!==null?ne.get(w).__webglFramebuffer:null;$.bindFramebuffer(36160,it)}}},this.copyFramebufferToTexture=function(he,Q,de=0){let le=Math.pow(2,-de),ce=Math.floor(Q.image.width*le),De=Math.floor(Q.image.height*le);ie.setTexture2D(Q,0),G.copyTexSubImage2D(3553,de,0,0,he.x,he.y,ce,De),$.unbindTexture()},this.copyTextureToTexture=function(he,Q,de,le=0){let ce=Q.image.width,De=Q.image.height,Ke=Ge.convert(de.format),Ze=Ge.convert(de.type);ie.setTexture2D(de,0),G.pixelStorei(37440,de.flipY),G.pixelStorei(37441,de.premultiplyAlpha),G.pixelStorei(3317,de.unpackAlignment),Q.isDataTexture?G.texSubImage2D(3553,le,he.x,he.y,ce,De,Ke,Ze,Q.image.data):Q.isCompressedTexture?G.compressedTexSubImage2D(3553,le,he.x,he.y,Q.mipmaps[0].width,Q.mipmaps[0].height,Ke,Q.mipmaps[0].data):G.texSubImage2D(3553,le,he.x,he.y,Ke,Ze,Q.image),le===0&&de.generateMipmaps&&G.generateMipmap(3553),$.unbindTexture()},this.copyTextureToTexture3D=function(he,Q,de,le,ce=0){if(v.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let De=he.max.x-he.min.x+1,Ke=he.max.y-he.min.y+1,Ze=he.max.z-he.min.z+1,it=Ge.convert(le.format),ht=Ge.convert(le.type),lt;if(le.isData3DTexture)ie.setTexture3D(le,0),lt=32879;else if(le.isDataArrayTexture)ie.setTexture2DArray(le,0),lt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}G.pixelStorei(37440,le.flipY),G.pixelStorei(37441,le.premultiplyAlpha),G.pixelStorei(3317,le.unpackAlignment);let ot=G.getParameter(3314),Mt=G.getParameter(32878),Vt=G.getParameter(3316),Un=G.getParameter(3315),Si=G.getParameter(32877),vn=de.isCompressedTexture?de.mipmaps[0]:de.image;G.pixelStorei(3314,vn.width),G.pixelStorei(32878,vn.height),G.pixelStorei(3316,he.min.x),G.pixelStorei(3315,he.min.y),G.pixelStorei(32877,he.min.z),de.isDataTexture||de.isData3DTexture?G.texSubImage3D(lt,ce,Q.x,Q.y,Q.z,De,Ke,Ze,it,ht,vn.data):de.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),G.compressedTexSubImage3D(lt,ce,Q.x,Q.y,Q.z,De,Ke,Ze,it,vn.data)):G.texSubImage3D(lt,ce,Q.x,Q.y,Q.z,De,Ke,Ze,it,ht,vn),G.pixelStorei(3314,ot),G.pixelStorei(32878,Mt),G.pixelStorei(3316,Vt),G.pixelStorei(3315,Un),G.pixelStorei(32877,Si),ce===0&&le.generateMipmaps&&G.generateMipmap(lt),$.unbindTexture()},this.initTexture=function(he){he.isCubeTexture?ie.setTextureCube(he,0):he.isData3DTexture?ie.setTexture3D(he,0):he.isDataArrayTexture||he.isCompressedArrayTexture?ie.setTexture2DArray(he,0):ie.setTexture2D(he,0),$.unbindTexture()},this.resetState=function(){m=0,y=0,w=null,$.reset(),ye.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var eAe=class extends aK{};eAe.prototype.isWebGL1Renderer=!0;var lK=class{constructor(t,e=1,n=1e3){this.isFog=!0,this.name="",this.color=new Rt(t),this.near=e,this.far=n}clone(){return new lK(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},_f=class extends Nn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}},tAe=class{constructor(t,e){this.isInterleavedBuffer=!0,this.array=t,this.stride=e,this.count=t!==void 0?t.length/e:0,this.usage=GL,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ql()}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ql()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ql()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},ss=new N,WL=class{constructor(t,e,n,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)ss.fromBufferAttribute(this,e),ss.applyMatrix4(t),this.setXYZ(e,ss.x,ss.y,ss.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)ss.fromBufferAttribute(this,e),ss.applyNormalMatrix(t),this.setXYZ(e,ss.x,ss.y,ss.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)ss.fromBufferAttribute(this,e),ss.transformDirection(t),this.setXYZ(e,ss.x,ss.y,ss.z);return this}setX(t,e){return this.normalized&&(e=zn(e,this.array)),this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.normalized&&(e=zn(e,this.array)),this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.normalized&&(e=zn(e,this.array)),this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.normalized&&(e=zn(e,this.array)),this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){let e=this.data.array[t*this.data.stride+this.offset];return this.normalized&&(e=Wc(e,this.array)),e}getY(t){let e=this.data.array[t*this.data.stride+this.offset+1];return this.normalized&&(e=Wc(e,this.array)),e}getZ(t){let e=this.data.array[t*this.data.stride+this.offset+2];return this.normalized&&(e=Wc(e,this.array)),e}getW(t){let e=this.data.array[t*this.data.stride+this.offset+3];return this.normalized&&(e=Wc(e,this.array)),e}setXY(t,e,n){return t=t*this.data.stride+this.offset,this.normalized&&(e=zn(e,this.array),n=zn(n,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,i){return t=t*this.data.stride+this.offset,this.normalized&&(e=zn(e,this.array),n=zn(n,this.array),i=zn(i,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this}setXYZW(t,e,n,i,r){return t=t*this.data.stride+this.offset,this.normalized&&(e=zn(e,this.array),n=zn(n,this.array),i=zn(i,this.array),r=zn(r,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this}clone(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let n=0;n<this.count;n++){let i=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)e.push(this.data.array[i+r])}return new Ut(new this.array.constructor(e),this.itemSize,this.normalized)}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new WL(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let n=0;n<this.count;n++){let i=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)e.push(this.data.array[i+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},nAe=class extends Ut{constructor(t,e,n,i=1){super(t,e,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){let t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}},rd=class extends F1{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Rt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}},FV=new N,NV=new N,UV=new nt,p2=new yv,xb=new ha,FA=class extends Nn{constructor(t=new Lt,e=new rd){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){let t=this.geometry;if(t.index===null){let e=t.attributes.position,n=[0];for(let i=1,r=e.count;i<r;i++)FV.fromBufferAttribute(e,i-1),NV.fromBufferAttribute(e,i),n[i]=n[i-1],n[i]+=FV.distanceTo(NV);t.setAttribute("lineDistance",new ft(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,e){let n=this.geometry,i=this.matrixWorld,r=t.params.Line.threshold,s=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),xb.copy(n.boundingSphere),xb.applyMatrix4(i),xb.radius+=r,t.ray.intersectsSphere(xb)===!1)return;UV.copy(i).invert(),p2.copy(t.ray).applyMatrix4(UV);let o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=new N,c=new N,h=new N,u=new N,d=this.isLineSegments?2:1,f=n.index,p=n.attributes.position;if(f!==null){let v=Math.max(0,s.start),g=Math.min(f.count,s.start+s.count);for(let m=v,y=g-1;m<y;m+=d){let w=f.getX(m),b=f.getX(m+1);if(l.fromBufferAttribute(p,w),c.fromBufferAttribute(p,b),p2.distanceSqToSegment(l,c,u,h)>a)continue;u.applyMatrix4(this.matrixWorld);let A=t.ray.origin.distanceTo(u);A<t.near||A>t.far||e.push({distance:A,point:h.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else{let v=Math.max(0,s.start),g=Math.min(p.count,s.start+s.count);for(let m=v,y=g-1;m<y;m+=d){if(l.fromBufferAttribute(p,m),c.fromBufferAttribute(p,m+1),p2.distanceSqToSegment(l,c,u,h)>a)continue;u.applyMatrix4(this.matrixWorld);let w=t.ray.origin.distanceTo(u);w<t.near||w>t.far||e.push({distance:w,point:h.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){let n=t[e[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,r=n.length;i<r;i++){let s=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=i}}}}},kV=new N,zV=new N,U1=class extends FA{constructor(t,e){super(t,e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let t=this.geometry;if(t.index===null){let e=t.attributes.position,n=[];for(let i=0,r=e.count;i<r;i+=2)kV.fromBufferAttribute(e,i),zV.fromBufferAttribute(e,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+kV.distanceTo(zV);t.setAttribute("lineDistance",new ft(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},iAe=class extends br{constructor(t,e,n,i,r,s,o,a,l){super(t,e,n,i,r,s,o,a,l),this.isVideoTexture=!0,this.minFilter=s!==void 0?s:En,this.magFilter=r!==void 0?r:En,this.generateMipmaps=!1;let c=this;function h(){c.needsUpdate=!0,t.requestVideoFrameCallback(h)}"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(h)}clone(){return new this.constructor(this.image).copy(this)}update(){let t=this.image;!("requestVideoFrameCallback"in t)&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},oc=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){let n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){let e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){let e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){let t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let e=[],n,i=this.getPoint(0),r=0;e.push(0);for(let s=1;s<=t;s++)n=this.getPoint(s/t),r+=n.distanceTo(i),e.push(r),i=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){let n=this.getLengths(),i=0,r=n.length,s;e?s=e:s=t*n[r-1];let o=0,a=r-1,l;for(;o<=a;)if(i=Math.floor(o+(a-o)/2),l=n[i]-s,l<0)o=i+1;else if(l>0)a=i-1;else{a=i;break}if(i=a,n[i]===s)return i/(r-1);let c=n[i],h=n[i+1]-c,u=(s-c)/h;return(i+u)/(r-1)}getTangent(t,e){let n=t-1e-4,i=t+1e-4;n<0&&(n=0),i>1&&(i=1);let r=this.getPoint(n),s=this.getPoint(i),o=e||(r.isVector2?new be:new N);return o.copy(s).sub(r).normalize(),o}getTangentAt(t,e){let n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){let n=new N,i=[],r=[],s=[],o=new N,a=new nt;for(let d=0;d<=t;d++){let f=d/t;i[d]=this.getTangentAt(f,new N)}r[0]=new N,s[0]=new N;let l=Number.MAX_VALUE,c=Math.abs(i[0].x),h=Math.abs(i[0].y),u=Math.abs(i[0].z);c<=l&&(l=c,n.set(1,0,0)),h<=l&&(l=h,n.set(0,1,0)),u<=l&&n.set(0,0,1),o.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],o),s[0].crossVectors(i[0],r[0]);for(let d=1;d<=t;d++){if(r[d]=r[d-1].clone(),s[d]=s[d-1].clone(),o.crossVectors(i[d-1],i[d]),o.length()>Number.EPSILON){o.normalize();let f=Math.acos(Ji(i[d-1].dot(i[d]),-1,1));r[d].applyMatrix4(a.makeRotationAxis(o,f))}s[d].crossVectors(i[d],r[d])}if(e===!0){let d=Math.acos(Ji(r[0].dot(r[t]),-1,1));d/=t,i[0].dot(o.crossVectors(r[0],r[t]))>0&&(d=-d);for(let f=1;f<=t;f++)r[f].applyMatrix4(a.makeRotationAxis(i[f],d*f)),s[f].crossVectors(i[f],r[f])}return{tangents:i,normals:r,binormals:s}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){let t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}},bE=class extends oc{constructor(t=0,e=0,n=1,i=1,r=0,s=Math.PI*2,o=!1,a=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=o,this.aRotation=a}getPoint(t,e){let n=e||new be,i=Math.PI*2,r=this.aEndAngle-this.aStartAngle,s=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(s?r=0:r=i),this.aClockwise===!0&&!s&&(r===i?r=-i:r=r-i);let o=this.aStartAngle+t*r,a=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){let c=Math.cos(this.aRotation),h=Math.sin(this.aRotation),u=a-this.aX,d=l-this.aY;a=u*c-d*h+this.aX,l=u*h+d*c+this.aY}return n.set(a,l)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){let t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}},rAe=class extends bE{constructor(t,e,n,i,r,s){super(t,e,n,n,i,r,s),this.isArcCurve=!0,this.type="ArcCurve"}};function GO(){let t=0,e=0,n=0,i=0;function r(s,o,a,l){t=s,e=a,n=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,h,u){let d=(o-s)/c-(a-s)/(c+h)+(a-o)/h,f=(a-o)/h-(l-o)/(h+u)+(l-a)/u;d*=h,f*=h,r(o,a,d,f)},calc:function(s){let o=s*s,a=o*s;return t+e*s+n*o+i*a}}}var wb=new N,m2=new GO,g2=new GO,v2=new GO,sAe=class extends oc{constructor(t=[],e=!1,n="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=i}getPoint(t,e=new N){let n=e,i=this.points,r=i.length,s=(r-(this.closed?0:1))*t,o=Math.floor(s),a=s-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/r)+1)*r:a===0&&o===r-1&&(o=r-2,a=1);let l,c;this.closed||o>0?l=i[(o-1)%r]:(wb.subVectors(i[0],i[1]).add(i[0]),l=wb);let h=i[o%r],u=i[(o+1)%r];if(this.closed||o+2<r?c=i[(o+2)%r]:(wb.subVectors(i[r-1],i[r-2]).add(i[r-1]),c=wb),this.curveType==="centripetal"||this.curveType==="chordal"){let d=this.curveType==="chordal"?.5:.25,f=Math.pow(l.distanceToSquared(h),d),p=Math.pow(h.distanceToSquared(u),d),v=Math.pow(u.distanceToSquared(c),d);p<1e-4&&(p=1),f<1e-4&&(f=p),v<1e-4&&(v=p),m2.initNonuniformCatmullRom(l.x,h.x,u.x,c.x,f,p,v),g2.initNonuniformCatmullRom(l.y,h.y,u.y,c.y,f,p,v),v2.initNonuniformCatmullRom(l.z,h.z,u.z,c.z,f,p,v)}else this.curveType==="catmullrom"&&(m2.initCatmullRom(l.x,h.x,u.x,c.x,this.tension),g2.initCatmullRom(l.y,h.y,u.y,c.y,this.tension),v2.initCatmullRom(l.z,h.z,u.z,c.z,this.tension));return n.set(m2.calc(a),g2.calc(a),v2.calc(a)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){let i=t.points[e];this.points.push(i.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){let t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){let i=this.points[e];t.points.push(i.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){let i=t.points[e];this.points.push(new N().fromArray(i))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}};function GV(t,e,n,i,r){let s=(i-e)*.5,o=(r-n)*.5,a=t*t,l=t*a;return(2*n-2*i+s+o)*l+(-3*n+3*i-2*s-o)*a+s*t+n}function oAe(t,e){let n=1-t;return n*n*e}function aAe(t,e){return 2*(1-t)*t*e}function lAe(t,e){return t*t*e}function Fy(t,e,n,i){return oAe(t,e)+aAe(t,n)+lAe(t,i)}function cAe(t,e){let n=1-t;return n*n*n*e}function uAe(t,e){let n=1-t;return 3*n*n*t*e}function hAe(t,e){return 3*(1-t)*t*t*e}function dAe(t,e){return t*t*t*e}function Ny(t,e,n,i,r){return cAe(t,e)+uAe(t,n)+hAe(t,i)+dAe(t,r)}var Ga=class extends oc{constructor(t=new be,e=new be,n=new be,i=new be){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new be){let n=e,i=this.v0,r=this.v1,s=this.v2,o=this.v3;return n.set(Ny(t,i.x,r.x,s.x,o.x),Ny(t,i.y,r.y,s.y,o.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}},IS=class extends oc{constructor(t=new N,e=new N,n=new N,i=new N){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new N){let n=e,i=this.v0,r=this.v1,s=this.v2,o=this.v3;return n.set(Ny(t,i.x,r.x,s.x,o.x),Ny(t,i.y,r.y,s.y,o.y),Ny(t,i.z,r.z,s.z,o.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}},Qa=class extends oc{constructor(t=new be,e=new be){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new be){let n=e;return t===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e){let n=e||new be;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},cK=class extends oc{constructor(t=new N,e=new N){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=t,this.v2=e}getPoint(t,e=new N){let n=e;return t===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},qh=class extends oc{constructor(e=new be,n=new be,i=new be){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new be){let i=n,r=this.v0,s=this.v1,o=this.v2;return i.set(Fy(e,r.x,s.x,o.x),Fy(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},fAe=class extends oc{constructor(t=new N,e=new N,n=new N){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new N){let n=e,i=this.v0,r=this.v1,s=this.v2;return n.set(Fy(t,i.x,r.x,s.x),Fy(t,i.y,r.y,s.y),Fy(t,i.z,r.z,s.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},HO=class extends oc{constructor(t=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=t}getPoint(t,e=new be){let n=e,i=this.points,r=(i.length-1)*t,s=Math.floor(r),o=r-s,a=i[s===0?s:s-1],l=i[s],c=i[s>i.length-2?i.length-1:s+1],h=i[s>i.length-3?i.length-1:s+2];return n.set(GV(o,a.x,l.x,c.x,h.x),GV(o,a.y,l.y,c.y,h.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){let i=t.points[e];this.points.push(i.clone())}return this}toJSON(){let t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){let i=this.points[e];t.points.push(i.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){let i=t.points[e];this.points.push(new be().fromArray(i))}return this}},pAe=Object.freeze({__proto__:null,ArcCurve:rAe,CatmullRomCurve3:sAe,CubicBezierCurve:Ga,CubicBezierCurve3:IS,EllipseCurve:bE,LineCurve:Qa,LineCurve3:cK,QuadraticBezierCurve:qh,QuadraticBezierCurve3:fAe,SplineCurve:HO}),uK=class extends oc{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){let t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Qa(e,t))}getPoint(t,e){let n=t*this.getLength(),i=this.getCurveLengths(),r=0;for(;r<i.length;){if(i[r]>=n){let s=i[r]-n,o=this.curves[r],a=o.getLength(),l=a===0?0:1-s/a;return o.getPointAt(l,e)}r++}return null}getLength(){let t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let t=[],e=0;for(let n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){let e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){let e=[],n;for(let i=0,r=this.curves;i<r.length;i++){let s=r[i],o=s.isEllipseCurve?t*2:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?t*s.points.length:t,a=s.getPoints(o);for(let l=0;l<a.length;l++){let c=a[l];n&&n.equals(c)||(e.push(c),n=c)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){let i=t.curves[e];this.curves.push(i.clone())}return this.autoClose=t.autoClose,this}toJSON(){let t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){let i=this.curves[e];t.curves.push(i.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){let i=t.curves[e];this.curves.push(new pAe[i.type]().fromJSON(i))}return this}},NA=class extends uK{constructor(t){super(),this.type="Path",this.currentPoint=new be,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){let n=new Qa(this.currentPoint.clone(),new be(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,i){let r=new qh(this.currentPoint.clone(),new be(t,e),new be(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(t,e,n,i,r,s){let o=new Ga(this.currentPoint.clone(),new be(t,e),new be(n,i),new be(r,s));return this.curves.push(o),this.currentPoint.set(r,s),this}splineThru(t){let e=[this.currentPoint.clone()].concat(t),n=new HO(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,i,r,s){let o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(t+o,e+a,n,i,r,s),this}absarc(t,e,n,i,r,s){return this.absellipse(t,e,n,n,i,r,s),this}ellipse(t,e,n,i,r,s,o,a){let l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+l,e+c,n,i,r,s,o,a),this}absellipse(t,e,n,i,r,s,o,a){let l=new bE(t,e,n,i,r,s,o,a);if(this.curves.length>0){let h=l.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(l);let c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){let t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}},hK=class extends Lt{constructor(t=[new be(0,-.5),new be(.5,0),new be(0,.5)],e=12,n=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:i},e=Math.floor(e),i=Ji(i,0,Math.PI*2);let r=[],s=[],o=[],a=[],l=[],c=1/e,h=new N,u=new be,d=new N,f=new N,p=new N,v=0,g=0;for(let m=0;m<=t.length-1;m++)switch(m){case 0:v=t[m+1].x-t[m].x,g=t[m+1].y-t[m].y,d.x=g*1,d.y=-v,d.z=g*0,p.copy(d),d.normalize(),a.push(d.x,d.y,d.z);break;case t.length-1:a.push(p.x,p.y,p.z);break;default:v=t[m+1].x-t[m].x,g=t[m+1].y-t[m].y,d.x=g*1,d.y=-v,d.z=g*0,f.copy(d),d.x+=p.x,d.y+=p.y,d.z+=p.z,d.normalize(),a.push(d.x,d.y,d.z),p.copy(f)}for(let m=0;m<=e;m++){let y=n+m*c*i,w=Math.sin(y),b=Math.cos(y);for(let A=0;A<=t.length-1;A++){h.x=t[A].x*w,h.y=t[A].y,h.z=t[A].x*b,s.push(h.x,h.y,h.z),u.x=m/e,u.y=A/(t.length-1),o.push(u.x,u.y);let S=a[3*A+0]*w,T=a[3*A+1],M=a[3*A+0]*b;l.push(S,T,M)}}for(let m=0;m<e;m++)for(let y=0;y<t.length-1;y++){let w=y+m*t.length,b=w,A=w+t.length,S=w+t.length+1,T=w+1;r.push(b,A,T),r.push(S,T,A)}this.setIndex(r),this.setAttribute("position",new ft(s,3)),this.setAttribute("uv",new ft(o,2)),this.setAttribute("normal",new ft(l,3))}static fromJSON(t){return new hK(t.points,t.segments,t.phiStart,t.phiLength)}},VO=class extends Lt{constructor(t=1,e=1,n=1,i=32,r=1,s=!1,o=0,a=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a};let l=this;i=Math.floor(i),r=Math.floor(r);let c=[],h=[],u=[],d=[],f=0,p=[],v=n/2,g=0;m(),s===!1&&(t>0&&y(!0),e>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new ft(h,3)),this.setAttribute("normal",new ft(u,3)),this.setAttribute("uv",new ft(d,2));function m(){let w=new N,b=new N,A=0,S=(e-t)/n;for(let T=0;T<=r;T++){let M=[],E=T/r,P=E*(e-t)+t;for(let R=0;R<=i;R++){let F=R/i,B=F*a+o,k=Math.sin(B),j=Math.cos(B);b.x=P*k,b.y=-E*n+v,b.z=P*j,h.push(b.x,b.y,b.z),w.set(k,S,j).normalize(),u.push(w.x,w.y,w.z),d.push(F,1-E),M.push(f++)}p.push(M)}for(let T=0;T<i;T++)for(let M=0;M<r;M++){let E=p[M][T],P=p[M+1][T],R=p[M+1][T+1],F=p[M][T+1];c.push(E,P,F),c.push(P,R,F),A+=6}l.addGroup(g,A,0),g+=A}function y(w){let b=f,A=new be,S=new N,T=0,M=w===!0?t:e,E=w===!0?1:-1;for(let R=1;R<=i;R++)h.push(0,v*E,0),u.push(0,E,0),d.push(.5,.5),f++;let P=f;for(let R=0;R<=i;R++){let F=R/i*a+o,B=Math.cos(F),k=Math.sin(F);S.x=M*k,S.y=v*E,S.z=M*B,h.push(S.x,S.y,S.z),u.push(0,E,0),A.x=B*.5+.5,A.y=k*.5*E+.5,d.push(A.x,A.y),f++}for(let R=0;R<i;R++){let F=b+R,B=P+R;w===!0?c.push(B,B+1,F):c.push(B+1,B,F),T+=3}l.addGroup(g,T,w===!0?1:2),g+=T}}static fromJSON(t){return new VO(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}},dK=class extends VO{constructor(t=1,e=1,n=32,i=1,r=!1,s=0,o=Math.PI*2){super(0,t,e,n,i,r,s,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:s,thetaLength:o}}static fromJSON(t){return new dK(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}},jO=class extends Lt{constructor(t=[],e=[],n=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:i};let r=[],s=[];o(i),l(n),c(),this.setAttribute("position",new ft(r,3)),this.setAttribute("normal",new ft(r.slice(),3)),this.setAttribute("uv",new ft(s,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function o(m){let y=new N,w=new N,b=new N;for(let A=0;A<e.length;A+=3)d(e[A+0],y),d(e[A+1],w),d(e[A+2],b),a(y,w,b,m)}function a(m,y,w,b){let A=b+1,S=[];for(let T=0;T<=A;T++){S[T]=[];let M=m.clone().lerp(w,T/A),E=y.clone().lerp(w,T/A),P=A-T;for(let R=0;R<=P;R++)R===0&&T===A?S[T][R]=M:S[T][R]=M.clone().lerp(E,R/P)}for(let T=0;T<A;T++)for(let M=0;M<2*(A-T)-1;M++){let E=Math.floor(M/2);M%2===0?(u(S[T][E+1]),u(S[T+1][E]),u(S[T][E])):(u(S[T][E+1]),u(S[T+1][E+1]),u(S[T+1][E]))}}function l(m){let y=new N;for(let w=0;w<r.length;w+=3)y.x=r[w+0],y.y=r[w+1],y.z=r[w+2],y.normalize().multiplyScalar(m),r[w+0]=y.x,r[w+1]=y.y,r[w+2]=y.z}function c(){let m=new N;for(let y=0;y<r.length;y+=3){m.x=r[y+0],m.y=r[y+1],m.z=r[y+2];let w=v(m)/2/Math.PI+.5,b=g(m)/Math.PI+.5;s.push(w,1-b)}f(),h()}function h(){for(let m=0;m<s.length;m+=6){let y=s[m+0],w=s[m+2],b=s[m+4],A=Math.max(y,w,b),S=Math.min(y,w,b);A>.9&&S<.1&&(y<.2&&(s[m+0]+=1),w<.2&&(s[m+2]+=1),b<.2&&(s[m+4]+=1))}}function u(m){r.push(m.x,m.y,m.z)}function d(m,y){let w=m*3;y.x=t[w+0],y.y=t[w+1],y.z=t[w+2]}function f(){let m=new N,y=new N,w=new N,b=new N,A=new be,S=new be,T=new be;for(let M=0,E=0;M<r.length;M+=9,E+=6){m.set(r[M+0],r[M+1],r[M+2]),y.set(r[M+3],r[M+4],r[M+5]),w.set(r[M+6],r[M+7],r[M+8]),A.set(s[E+0],s[E+1]),S.set(s[E+2],s[E+3]),T.set(s[E+4],s[E+5]),b.copy(m).add(y).add(w).divideScalar(3);let P=v(b);p(A,E+0,m,P),p(S,E+2,y,P),p(T,E+4,w,P)}}function p(m,y,w,b){b<0&&m.x===1&&(s[y]=m.x-1),w.x===0&&w.z===0&&(s[y]=b/2/Math.PI+.5)}function v(m){return Math.atan2(m.z,-m.x)}function g(m){return Math.atan2(-m.y,Math.sqrt(m.x*m.x+m.z*m.z))}}static fromJSON(t){return new jO(t.vertices,t.indices,t.radius,t.details)}},fK=class extends jO{constructor(t=1,e=0){let n=(1+Math.sqrt(5))/2,i=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(r,s,t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new fK(t.radius,t.detail)}},UA=class extends NA{constructor(t){super(t),this.uuid=ql(),this.type="Shape",this.holes=[]}getPointsHoles(t){let e=[];for(let n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){let i=t.holes[e];this.holes.push(i.clone())}return this}toJSON(){let t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){let i=this.holes[e];t.holes.push(i.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){let i=t.holes[e];this.holes.push(new NA().fromJSON(i))}return this}},mAe={triangulate:function(t,e,n=2){let i=e&&e.length,r=i?e[0]*n:t.length,s=pK(t,0,r,n,!0),o=[];if(!s||s.next===s.prev)return o;let a,l,c,h,u,d,f;if(i&&(s=wAe(t,e,s,n)),t.length>80*n){a=c=t[0],l=h=t[1];for(let p=n;p<r;p+=n)u=t[p],d=t[p+1],u<a&&(a=u),d<l&&(l=d),u>c&&(c=u),d>h&&(h=d);f=Math.max(c-a,h-l),f=f!==0?32767/f:0}return Bx(s,o,n,a,l,f,0),o}};function pK(t,e,n,i,r){let s,o;if(r===RAe(t,e,n,i)>0)for(s=e;s<n;s+=i)o=HV(s,t[s],t[s+1],o);else for(s=n-i;s>=e;s-=i)o=HV(s,t[s],t[s+1],o);return o&&SE(o,o.next)&&(Fx(o),o=o.next),o}function kf(t,e){if(!t)return t;e||(e=t);let n=t,i;do if(i=!1,!n.steiner&&(SE(n,n.next)||ui(n.prev,n,n.next)===0)){if(Fx(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function Bx(t,e,n,i,r,s,o){if(!t)return;!o&&s&&MAe(t,i,r,s);let a=t,l,c;for(;t.prev!==t.next;){if(l=t.prev,c=t.next,s?vAe(t,i,r,s):gAe(t)){e.push(l.i/n|0),e.push(t.i/n|0),e.push(c.i/n|0),Fx(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=yAe(kf(t),e,n),Bx(t,e,n,i,r,s,2)):o===2&&xAe(t,e,n,i,r,s):Bx(kf(t),e,n,i,r,s,1);break}}}function gAe(t){let e=t.prev,n=t,i=t.next;if(ui(e,n,i)>=0)return!1;let r=e.x,s=n.x,o=i.x,a=e.y,l=n.y,c=i.y,h=r<s?r<o?r:o:s<o?s:o,u=a<l?a<c?a:c:l<c?l:c,d=r>s?r>o?r:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c,p=i.next;for(;p!==e;){if(p.x>=h&&p.x<=d&&p.y>=u&&p.y<=f&&Ym(r,a,s,l,o,c,p.x,p.y)&&ui(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function vAe(t,e,n,i){let r=t.prev,s=t,o=t.next;if(ui(r,s,o)>=0)return!1;let a=r.x,l=s.x,c=o.x,h=r.y,u=s.y,d=o.y,f=a<l?a<c?a:c:l<c?l:c,p=h<u?h<d?h:d:u<d?u:d,v=a>l?a>c?a:c:l>c?l:c,g=h>u?h>d?h:d:u>d?u:d,m=XL(f,p,e,n,i),y=XL(v,g,e,n,i),w=t.prevZ,b=t.nextZ;for(;w&&w.z>=m&&b&&b.z<=y;){if(w.x>=f&&w.x<=v&&w.y>=p&&w.y<=g&&w!==r&&w!==o&&Ym(a,h,l,u,c,d,w.x,w.y)&&ui(w.prev,w,w.next)>=0||(w=w.prevZ,b.x>=f&&b.x<=v&&b.y>=p&&b.y<=g&&b!==r&&b!==o&&Ym(a,h,l,u,c,d,b.x,b.y)&&ui(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;w&&w.z>=m;){if(w.x>=f&&w.x<=v&&w.y>=p&&w.y<=g&&w!==r&&w!==o&&Ym(a,h,l,u,c,d,w.x,w.y)&&ui(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;b&&b.z<=y;){if(b.x>=f&&b.x<=v&&b.y>=p&&b.y<=g&&b!==r&&b!==o&&Ym(a,h,l,u,c,d,b.x,b.y)&&ui(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function yAe(t,e,n){let i=t;do{let r=i.prev,s=i.next.next;!SE(r,s)&&mK(r,i,i.next,s)&&Ox(r,s)&&Ox(s,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(s.i/n|0),Fx(i),Fx(i.next),i=t=s),i=i.next}while(i!==t);return kf(i)}function xAe(t,e,n,i,r,s){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&TAe(o,a)){let l=gK(o,a);o=kf(o,o.next),l=kf(l,l.next),Bx(o,e,n,i,r,s,0),Bx(l,e,n,i,r,s,0);return}a=a.next}o=o.next}while(o!==t)}function wAe(t,e,n,i){let r=[],s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:t.length,c=pK(t,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(CAe(c));for(r.sort(_Ae),s=0;s<r.length;s++)n=bAe(r[s],n);return n}function _Ae(t,e){return t.x-e.x}function bAe(t,e){let n=SAe(t,e);if(!n)return e;let i=gK(n,t);return kf(i,i.next),kf(n,n.next)}function SAe(t,e){let n=e,i=-1/0,r,s=t.x,o=t.y;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){let d=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(d<=s&&d>i&&(i=d,r=n.x<n.next.x?n:n.next,d===s))return r}n=n.next}while(n!==e);if(!r)return null;let a=r,l=r.x,c=r.y,h=1/0,u;n=r;do s>=n.x&&n.x>=l&&s!==n.x&&Ym(o<c?s:i,o,l,c,o<c?i:s,o,n.x,n.y)&&(u=Math.abs(o-n.y)/(s-n.x),Ox(n,t)&&(u<h||u===h&&(n.x>r.x||n.x===r.x&&AAe(r,n)))&&(r=n,h=u)),n=n.next;while(n!==a);return r}function AAe(t,e){return ui(t.prev,t,e.prev)<0&&ui(e.next,t,t.next)<0}function MAe(t,e,n,i){let r=t;do r.z===0&&(r.z=XL(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,EAe(r)}function EAe(t){let e,n,i,r,s,o,a,l,c=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,i=n,a=0,e=0;e<c&&(a++,i=i.nextZ,!!i);e++);for(l=c;a>0||l>0&&i;)a!==0&&(l===0||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,c*=2}while(o>1);return t}function XL(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function CAe(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Ym(t,e,n,i,r,s,o,a){return(r-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(i-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(r-o)*(i-a)}function TAe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!PAe(t,e)&&(Ox(t,e)&&Ox(e,t)&&DAe(t,e)&&(ui(t.prev,t,e.prev)||ui(t,e.prev,e))||SE(t,e)&&ui(t.prev,t,t.next)>0&&ui(e.prev,e,e.next)>0)}function ui(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function SE(t,e){return t.x===e.x&&t.y===e.y}function mK(t,e,n,i){let r=bb(ui(t,e,n)),s=bb(ui(t,e,i)),o=bb(ui(n,i,t)),a=bb(ui(n,i,e));return!!(r!==s&&o!==a||r===0&&_b(t,n,e)||s===0&&_b(t,i,e)||o===0&&_b(n,t,i)||a===0&&_b(n,e,i))}function _b(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function bb(t){return t>0?1:t<0?-1:0}function PAe(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&mK(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Ox(t,e){return ui(t.prev,t,t.next)<0?ui(t,e,t.next)>=0&&ui(t,t.prev,e)>=0:ui(t,e,t.prev)<0||ui(t,t.next,e)<0}function DAe(t,e){let n=t,i=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function gK(t,e){let n=new YL(t.i,t.x,t.y),i=new YL(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function HV(t,e,n,i){let r=new YL(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Fx(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function YL(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function RAe(t,e,n,i){let r=0;for(let s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}var vK=class{static area(t){let e=t.length,n=0;for(let i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return n*.5}static isClockWise(t){return vK.area(t)<0}static triangulateShape(t,e){let n=[],i=[],r=[];VV(t),jV(n,t);let s=t.length;e.forEach(VV);for(let a=0;a<e.length;a++)i.push(s),s+=e[a].length,jV(n,e[a]);let o=mAe.triangulate(n,i);for(let a=0;a<o.length;a+=3)r.push(o.slice(a,a+3));return r}};function VV(t){let e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function jV(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}var yK=class extends jO{constructor(t=1,e=0){let n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,r,t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new yK(t.radius,t.detail)}},WO=class extends Lt{constructor(t=1,e=32,n=16,i=0,r=Math.PI*2,s=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:s,thetaLength:o},e=Math.max(3,Math.floor(e)),n=Math.max(2,Math.floor(n));let a=Math.min(s+o,Math.PI),l=0,c=[],h=new N,u=new N,d=[],f=[],p=[],v=[];for(let g=0;g<=n;g++){let m=[],y=g/n,w=0;g==0&&s==0?w=.5/e:g==n&&a==Math.PI&&(w=-.5/e);for(let b=0;b<=e;b++){let A=b/e;h.x=-t*Math.cos(i+A*r)*Math.sin(s+y*o),h.y=t*Math.cos(s+y*o),h.z=t*Math.sin(i+A*r)*Math.sin(s+y*o),f.push(h.x,h.y,h.z),u.copy(h).normalize(),p.push(u.x,u.y,u.z),v.push(A+w,1-y),m.push(l++)}c.push(m)}for(let g=0;g<n;g++)for(let m=0;m<e;m++){let y=c[g][m+1],w=c[g][m],b=c[g+1][m],A=c[g+1][m+1];(g!==0||s>0)&&d.push(y,w,A),(g!==n-1||a<Math.PI)&&d.push(w,b,A)}this.setIndex(d),this.setAttribute("position",new ft(f,3)),this.setAttribute("normal",new ft(p,3)),this.setAttribute("uv",new ft(v,2))}static fromJSON(t){return new WO(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}},xK=class extends Lt{constructor(t=1,e=.4,n=64,i=8,r=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:i,p:r,q:s},n=Math.floor(n),i=Math.floor(i);let o=[],a=[],l=[],c=[],h=new N,u=new N,d=new N,f=new N,p=new N,v=new N,g=new N;for(let y=0;y<=n;++y){let w=y/n*r*Math.PI*2;m(w,r,s,t,d),m(w+.01,r,s,t,f),v.subVectors(f,d),g.addVectors(f,d),p.crossVectors(v,g),g.crossVectors(p,v),p.normalize(),g.normalize();for(let b=0;b<=i;++b){let A=b/i*Math.PI*2,S=-e*Math.cos(A),T=e*Math.sin(A);h.x=d.x+(S*g.x+T*p.x),h.y=d.y+(S*g.y+T*p.y),h.z=d.z+(S*g.z+T*p.z),a.push(h.x,h.y,h.z),u.subVectors(h,d).normalize(),l.push(u.x,u.y,u.z),c.push(y/n),c.push(b/i)}}for(let y=1;y<=n;y++)for(let w=1;w<=i;w++){let b=(i+1)*(y-1)+(w-1),A=(i+1)*y+(w-1),S=(i+1)*y+w,T=(i+1)*(y-1)+w;o.push(b,A,T),o.push(A,S,T)}this.setIndex(o),this.setAttribute("position",new ft(a,3)),this.setAttribute("normal",new ft(l,3)),this.setAttribute("uv",new ft(c,2));function m(y,w,b,A,S){let T=Math.cos(y),M=Math.sin(y),E=b/w*y,P=Math.cos(E);S.x=A*(2+P)*.5*T,S.y=A*(2+P)*M*.5,S.z=A*Math.sin(E)*.5}}static fromJSON(t){return new xK(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}},WV={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},wK=class{constructor(t,e,n){let i=this,r=!1,s=0,o=0,a,l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(c){o++,r===!1&&i.onStart!==void 0&&i.onStart(c,s,o),r=!0},this.itemEnd=function(c){s++,i.onProgress!==void 0&&i.onProgress(c,s,o),s===o&&(r=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(c){i.onError!==void 0&&i.onError(c)},this.resolveURL=function(c){return a?a(c):c},this.setURLModifier=function(c){return a=c,this},this.addHandler=function(c,h){return l.push(c,h),this},this.removeHandler=function(c){let h=l.indexOf(c);return h!==-1&&l.splice(h,2),this},this.getHandler=function(c){for(let h=0,u=l.length;h<u;h+=2){let d=l[h],f=l[h+1];if(d.global&&(d.lastIndex=0),d.test(c))return f}return null}}},LAe=new wK,XO=class{constructor(t){this.manager=t!==void 0?t:LAe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){let n=this;return new Promise(function(i,r){n.load(t,i,e,r)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}},Tc={},IAe=class extends Error{constructor(t,e){super(t),this.response=e}},qL=class extends XO{constructor(t){super(t)}load(t,e,n,i){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);let r=WV.get(t);if(r!==void 0)return this.manager.itemStart(t),setTimeout(()=>{e&&e(r),this.manager.itemEnd(t)},0),r;if(Tc[t]!==void 0){Tc[t].push({onLoad:e,onProgress:n,onError:i});return}Tc[t]=[],Tc[t].push({onLoad:e,onProgress:n,onError:i});let s=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,a=this.responseType;fetch(s).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let c=Tc[t],h=l.body.getReader(),u=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),d=u?parseInt(u):0,f=d!==0,p=0,v=new ReadableStream({start(g){m();function m(){h.read().then(({done:y,value:w})=>{if(y)g.close();else{p+=w.byteLength;let b=new ProgressEvent("progress",{lengthComputable:f,loaded:p,total:d});for(let A=0,S=c.length;A<S;A++){let T=c[A];T.onProgress&&T.onProgress(b)}g.enqueue(w),m()}})}}});return new Response(v)}else throw new IAe(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(a){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(c=>new DOMParser().parseFromString(c,o));case"json":return l.json();default:if(o===void 0)return l.text();{let c=/charset="?([^;"\s]*)"?/i.exec(o),h=c&&c[1]?c[1].toLowerCase():void 0,u=new TextDecoder(h);return l.arrayBuffer().then(d=>u.decode(d))}}}).then(l=>{WV.add(t,l);let c=Tc[t];delete Tc[t];for(let h=0,u=c.length;h<u;h++){let d=c[h];d.onLoad&&d.onLoad(l)}}).catch(l=>{let c=Tc[t];if(c===void 0)throw this.manager.itemError(t),l;delete Tc[t];for(let h=0,u=c.length;h<u;h++){let d=c[h];d.onError&&d.onError(l)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}},k1=class extends Nn{constructor(t,e=1){super(),this.isLight=!0,this.type="Light",this.color=new Rt(t),this.intensity=e}dispose(){}copy(t,e){return super.copy(t,e),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){let e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,this.groundColor!==void 0&&(e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(e.object.distance=this.distance),this.angle!==void 0&&(e.object.angle=this.angle),this.decay!==void 0&&(e.object.decay=this.decay),this.penumbra!==void 0&&(e.object.penumbra=this.penumbra),this.shadow!==void 0&&(e.object.shadow=this.shadow.toJSON()),e}},BAe=class extends k1{constructor(t,e,n){super(t,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Nn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Rt(e)}copy(t,e){return super.copy(t,e),this.groundColor.copy(t.groundColor),this}},y2=new nt,XV=new N,YV=new N,YO=class{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new be(512,512),this.map=null,this.mapPass=null,this.matrix=new nt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new UO,this._frameExtents=new be(1,1),this._viewportCount=1,this._viewports=[new Zt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){let e=this.camera,n=this.matrix;XV.setFromMatrixPosition(t.matrixWorld),e.position.copy(XV),YV.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(YV),e.updateMatrixWorld(),y2.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(y2),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(y2)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}},OAe=class extends YO{constructor(){super(new Qr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(t){let e=this.camera,n=Ix*2*t.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;(n!==e.fov||i!==e.aspect||r!==e.far)&&(e.fov=n,e.aspect=i,e.far=r,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}},FAe=class extends k1{constructor(t,e,n=0,i=Math.PI/3,r=0,s=2){super(t,e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Nn.DEFAULT_UP),this.updateMatrix(),this.target=new Nn,this.distance=n,this.angle=i,this.penumbra=r,this.decay=s,this.map=null,this.shadow=new OAe}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}},qV=new nt,P0=new N,x2=new N,NAe=class extends YO{constructor(){super(new Qr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new be(4,2),this._viewportCount=6,this._viewports=[new Zt(2,1,1,1),new Zt(0,1,1,1),new Zt(3,1,1,1),new Zt(1,1,1,1),new Zt(3,0,1,1),new Zt(1,0,1,1)],this._cubeDirections=[new N(1,0,0),new N(-1,0,0),new N(0,0,1),new N(0,0,-1),new N(0,1,0),new N(0,-1,0)],this._cubeUps=[new N(0,1,0),new N(0,1,0),new N(0,1,0),new N(0,1,0),new N(0,0,1),new N(0,0,-1)]}updateMatrices(t,e=0){let n=this.camera,i=this.matrix,r=t.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),P0.setFromMatrixPosition(t.matrixWorld),n.position.copy(P0),x2.copy(n.position),x2.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(x2),n.updateMatrixWorld(),i.makeTranslation(-P0.x,-P0.y,-P0.z),qV.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(qV)}},UAe=class extends k1{constructor(t,e,n=0,i=2){super(t,e),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new NAe}get power(){return this.intensity*4*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}},kAe=class extends YO{constructor(){super(new OA(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},zAe=class extends k1{constructor(t,e){super(t,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Nn.DEFAULT_UP),this.updateMatrix(),this.target=new Nn,this.shadow=new kAe}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}},GAe=class extends Lt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}toJSON(){let t=super.toJSON();return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}},_K=class extends XO{constructor(t){super(t)}load(t,e,n,i){let r=this,s=new qL(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(t,function(o){try{e(r.parse(JSON.parse(o)))}catch(a){i?i(a):console.error(a),r.manager.itemError(t)}},n,i)}parse(t){let e={},n={};function i(u,d){if(e[d]!==void 0)return e[d];let f=u.interleavedBuffers[d],p=r(u,f.buffer),v=eb(f.type,p),g=new tAe(v,f.stride);return g.uuid=f.uuid,e[d]=g,g}function r(u,d){if(n[d]!==void 0)return n[d];let f=u.arrayBuffers[d],p=new Uint32Array(f).buffer;return n[d]=p,p}let s=t.isInstancedBufferGeometry?new GAe:new Lt,o=t.data.index;if(o!==void 0){let u=eb(o.type,o.array);s.setIndex(new Ut(u,1))}let a=t.data.attributes;for(let u in a){let d=a[u],f;if(d.isInterleavedBufferAttribute){let p=i(t.data,d.data);f=new WL(p,d.itemSize,d.offset,d.normalized)}else{let p=eb(d.type,d.array),v=d.isInstancedBufferAttribute?nAe:Ut;f=new v(p,d.itemSize,d.normalized)}d.name!==void 0&&(f.name=d.name),d.usage!==void 0&&f.setUsage(d.usage),d.updateRange!==void 0&&(f.updateRange.offset=d.updateRange.offset,f.updateRange.count=d.updateRange.count),s.setAttribute(u,f)}let l=t.data.morphAttributes;if(l)for(let u in l){let d=l[u],f=[];for(let p=0,v=d.length;p<v;p++){let g=d[p],m;if(g.isInterleavedBufferAttribute){let y=i(t.data,g.data);m=new WL(y,g.itemSize,g.offset,g.normalized)}else{let y=eb(g.type,g.array);m=new Ut(y,g.itemSize,g.normalized)}g.name!==void 0&&(m.name=g.name),f.push(m)}s.morphAttributes[u]=f}t.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);let c=t.data.groups||t.data.drawcalls||t.data.offsets;if(c!==void 0)for(let u=0,d=c.length;u!==d;++u){let f=c[u];s.addGroup(f.start,f.count,f.materialIndex)}let h=t.data.boundingSphere;if(h!==void 0){let u=new N;h.center!==void 0&&u.fromArray(h.center),s.boundingSphere=new ha(u,h.radius)}return t.name&&(s.name=t.name),t.userData&&(s.userData=t.userData),s}},HAe=class{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=QV(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let e=QV();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}};function QV(){return(typeof performance>"u"?Date:performance).now()}var bK="\\[\\]\\.:\\/",qO="[^"+bK+"]",VAe="[^"+bK.replace("\\.","")+"]";/((?:WC+[\/:])*)/.source.replace("WC",qO);/(WCOD+)?/.source.replace("WCOD",VAe);/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",qO);/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",qO);var wt=class{constructor(e){this.value=e}clone(){return new wt(this.value.clone===void 0?this.value:this.value.clone())}},SK=class{constructor(t,e,n=0,i=1/0){this.ray=new yv(t,e),this.near=n,this.far=i,this.camera=null,this.layers=new FO,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}intersectObject(t,e=!0,n=[]){return QL(t,this,n,e),n.sort(KV),n}intersectObjects(t,e=!0,n=[]){for(let i=0,r=t.length;i<r;i++)QL(t[i],this,n,e);return n.sort(KV),n}};function KV(t,e){return t.distance-e.distance}function QL(t,e,n,i){if(t.layers.test(e.layers)&&t.raycast(e,n),i===!0){let r=t.children;for(let s=0,o=r.length;s<o;s++)QL(r[s],e,n,!0)}}var JV=class{constructor(t=1,e=0,n=0){return this.radius=t,this.phi=e,this.theta=n,this}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(Ji(e/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},ZV=new be,jAe=class{constructor(t=new be(1/0,1/0),e=new be(-1/0,-1/0)){this.isBox2=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){let n=ZV.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return ZV.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},$V=new N,Sb=new N,oa=class{constructor(t=new N,e=new N){this.start=t,this.end=e}set(t,e){return this.start.copy(t),this.end.copy(e),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){$V.subVectors(t,this.start),Sb.subVectors(this.end,this.start);let n=Sb.dot(Sb),i=Sb.dot($V)/n;return e&&(i=Ji(i,0,1)),i}closestPointToPoint(t,e,n){let i=this.closestPointToPointParameter(t,e);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},e5=new N,WAe=class extends Nn{constructor(t,e){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e,this.type="SpotLightHelper";let n=new Lt,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,o=1,a=32;s<a;s++,o++){let l=s/a*Math.PI*2,c=o/a*Math.PI*2;i.push(Math.cos(l),Math.sin(l),1,Math.cos(c),Math.sin(c),1)}n.setAttribute("position",new ft(i,3));let r=new rd({fog:!1,toneMapped:!1});this.cone=new U1(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),e5.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e5),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},XAe=class extends uo{constructor(t,e,n){let i=new WO(e,4,2),r=new N1({wireframe:!0,fog:!1,toneMapped:!1});super(i,r),this.light=t,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},t5=new N,Ab=new N,n5=new N,YAe=class extends Nn{constructor(t,e,n){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",e===void 0&&(e=1);let i=new Lt;i.setAttribute("position",new ft([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));let r=new rd({fog:!1,toneMapped:!1});this.lightPlane=new FA(i,r),this.add(this.lightPlane),i=new Lt,i.setAttribute("position",new ft([0,0,0,0,0,1],3)),this.targetLine=new FA(i,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),t5.setFromMatrixPosition(this.light.matrixWorld),Ab.setFromMatrixPosition(this.light.target.matrixWorld),n5.subVectors(Ab,t5),this.lightPlane.lookAt(Ab),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Ab),this.targetLine.scale.z=n5.length()}},Mb=new N,gi=new wv,kA=class extends U1{constructor(t){let e=new Lt,n=new rd({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],s={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(f,p){a(f),a(p)}function a(f){i.push(0,0,0),r.push(0,0,0),s[f]===void 0&&(s[f]=[]),s[f].push(i.length/3-1)}e.setAttribute("position",new ft(i,3)),e.setAttribute("color",new ft(r,3)),super(e,n),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();let l=new Rt(16755200),c=new Rt(16711680),h=new Rt(43775),u=new Rt(16777215),d=new Rt(3355443);this.setColors(l,c,h,u,d)}setColors(t,e,n,i,r){let s=this.geometry.getAttribute("color");s.setXYZ(0,t.r,t.g,t.b),s.setXYZ(1,t.r,t.g,t.b),s.setXYZ(2,t.r,t.g,t.b),s.setXYZ(3,t.r,t.g,t.b),s.setXYZ(4,t.r,t.g,t.b),s.setXYZ(5,t.r,t.g,t.b),s.setXYZ(6,t.r,t.g,t.b),s.setXYZ(7,t.r,t.g,t.b),s.setXYZ(8,t.r,t.g,t.b),s.setXYZ(9,t.r,t.g,t.b),s.setXYZ(10,t.r,t.g,t.b),s.setXYZ(11,t.r,t.g,t.b),s.setXYZ(12,t.r,t.g,t.b),s.setXYZ(13,t.r,t.g,t.b),s.setXYZ(14,t.r,t.g,t.b),s.setXYZ(15,t.r,t.g,t.b),s.setXYZ(16,t.r,t.g,t.b),s.setXYZ(17,t.r,t.g,t.b),s.setXYZ(18,t.r,t.g,t.b),s.setXYZ(19,t.r,t.g,t.b),s.setXYZ(20,t.r,t.g,t.b),s.setXYZ(21,t.r,t.g,t.b),s.setXYZ(22,t.r,t.g,t.b),s.setXYZ(23,t.r,t.g,t.b),s.setXYZ(24,e.r,e.g,e.b),s.setXYZ(25,e.r,e.g,e.b),s.setXYZ(26,e.r,e.g,e.b),s.setXYZ(27,e.r,e.g,e.b),s.setXYZ(28,e.r,e.g,e.b),s.setXYZ(29,e.r,e.g,e.b),s.setXYZ(30,e.r,e.g,e.b),s.setXYZ(31,e.r,e.g,e.b),s.setXYZ(32,n.r,n.g,n.b),s.setXYZ(33,n.r,n.g,n.b),s.setXYZ(34,n.r,n.g,n.b),s.setXYZ(35,n.r,n.g,n.b),s.setXYZ(36,n.r,n.g,n.b),s.setXYZ(37,n.r,n.g,n.b),s.setXYZ(38,i.r,i.g,i.b),s.setXYZ(39,i.r,i.g,i.b),s.setXYZ(40,r.r,r.g,r.b),s.setXYZ(41,r.r,r.g,r.b),s.setXYZ(42,r.r,r.g,r.b),s.setXYZ(43,r.r,r.g,r.b),s.setXYZ(44,r.r,r.g,r.b),s.setXYZ(45,r.r,r.g,r.b),s.setXYZ(46,r.r,r.g,r.b),s.setXYZ(47,r.r,r.g,r.b),s.setXYZ(48,r.r,r.g,r.b),s.setXYZ(49,r.r,r.g,r.b),s.needsUpdate=!0}update(){let t=this.geometry,e=this.pointMap,n=1,i=1;gi.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ei("c",e,t,gi,0,0,-1),Ei("t",e,t,gi,0,0,1),Ei("n1",e,t,gi,-n,-i,-1),Ei("n2",e,t,gi,n,-i,-1),Ei("n3",e,t,gi,-n,i,-1),Ei("n4",e,t,gi,n,i,-1),Ei("f1",e,t,gi,-n,-i,1),Ei("f2",e,t,gi,n,-i,1),Ei("f3",e,t,gi,-n,i,1),Ei("f4",e,t,gi,n,i,1),Ei("u1",e,t,gi,n*.7,i*1.1,-1),Ei("u2",e,t,gi,-n*.7,i*1.1,-1),Ei("u3",e,t,gi,0,i*2,-1),Ei("cf1",e,t,gi,-n,0,1),Ei("cf2",e,t,gi,n,0,1),Ei("cf3",e,t,gi,0,-i,1),Ei("cf4",e,t,gi,0,i,1),Ei("cn1",e,t,gi,-n,0,-1),Ei("cn2",e,t,gi,n,0,-1),Ei("cn3",e,t,gi,0,-i,-1),Ei("cn4",e,t,gi,0,i,-1),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function Ei(t,e,n,i,r,s,o){Mb.set(r,s,o).unproject(i);let a=e[t];if(a!==void 0){let l=n.getAttribute("position");for(let c=0,h=a.length;c<h;c++)l.setXYZ(a[c],Mb.x,Mb.y,Mb.z)}}var zA=class extends U1{constructor(t,e=16776960){let n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],r=new Lt;r.setIndex(new Ut(n,1)),r.setAttribute("position",new ft(i,3)),super(r,new rd({color:e,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){let e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}dispose(){this.geometry.dispose(),this.material.dispose()}},qAe=class extends U1{constructor(t=1){let e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new Lt;i.setAttribute("position",new ft(e,3)),i.setAttribute("color",new ft(n,3));let r=new rd({vertexColors:!0,toneMapped:!1});super(i,r),this.type="AxesHelper"}setColors(t,e,n){let i=new Rt,r=this.geometry.attributes.color.array;return i.set(t),i.toArray(r,0),i.toArray(r,3),i.set(e),i.toArray(r,6),i.toArray(r,9),i.set(n),i.toArray(r,12),i.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:vv}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=vv);var D0=".",QO=Symbol("target"),AK=Symbol("unsubscribe");function KL(t){return t instanceof Date||t instanceof Set||t instanceof Map||t instanceof WeakSet||t instanceof WeakMap||ArrayBuffer.isView(t)}function QAe(t){return(typeof t=="object"?t===null:typeof t!="function")||t instanceof RegExp}var Fl=Array.isArray;function KO(t){return typeof t=="symbol"}var KAe={after:(t,e)=>Fl(t)?t.slice(e.length):e===""?t:t.slice(e.length+1),concat:(t,e)=>Fl(t)?(t=[...t],e&&t.push(e),t):e&&e.toString!==void 0?(t!==""&&(t+=D0),KO(e)?t+e.toString():t+e):t,initial:t=>{if(Fl(t))return t.slice(0,-1);if(t==="")return t;let e=t.lastIndexOf(D0);return e===-1?"":t.slice(0,e)},last:t=>{if(Fl(t))return t[t.length-1]||"";if(t==="")return t;let e=t.lastIndexOf(D0);return e===-1?t:t.slice(e+1)},walk:(t,e)=>{if(Fl(t))for(let n of t)e(n);else if(t!==""){let n=0,i=t.indexOf(D0);if(i===-1)e(t);else for(;n<t.length;)i===-1&&(i=t.length),e(t.slice(n,i)),n=i+1,i=t.indexOf(D0,n)}},get(t,e){return this.walk(e,n=>{t&&(t=t[n])}),t}},Qo=KAe;function JAe(t){return typeof t=="object"&&typeof t.next=="function"}function ZAe(t,e,n,i,r){let s=t.next;if(e.name==="entries")t.next=function(){let o=s.call(this);return o.done===!1&&(o.value[0]=r(o.value[0],e,o.value[0],i),o.value[1]=r(o.value[1],e,o.value[0],i)),o};else if(e.name==="values"){let o=n[QO].keys();t.next=function(){let a=s.call(this);return a.done===!1&&(a.value=r(a.value,e,o.next().value,i)),a}}else t.next=function(){let o=s.call(this);return o.done===!1&&(o.value=r(o.value,e,o.value,i)),o};return t}function i5(t,e,n){return t.isUnsubscribed||e.ignoreSymbols&&KO(n)||e.ignoreUnderscores&&n.charAt(0)==="_"||"ignoreKeys"in e&&e.ignoreKeys.includes(n)}var $Ae=class{constructor(t){this._equals=t,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return this._descriptorCache===void 0&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(t){let e=this._getDescriptorCache(),n=e.get(t);return n===void 0&&(n={},e.set(t,n)),n}_getOwnPropertyDescriptor(t,e){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(t,e);let n=this._getProperties(t),i=n[e];return i===void 0&&(i=Reflect.getOwnPropertyDescriptor(t,e),n[e]=i),i}getProxy(t,e,n,i){if(this.isUnsubscribed)return t;let r=t[i],s=r||t;this._pathCache.set(s,e);let o=this._proxyCache.get(s);return o===void 0&&(o=r===void 0?new Proxy(t,n):t,this._proxyCache.set(s,o)),o}getPath(t){return this.isUnsubscribed?void 0:this._pathCache.get(t)}isDetached(t,e){return!Object.is(t,Qo.get(e,this.getPath(t)))}defineProperty(t,e,n){return Reflect.defineProperty(t,e,n)?(this.isUnsubscribed||(this._getProperties(t)[e]=n),!0):!1}setProperty(t,e,n,i,r){if(!this._equals(r,n)||!(e in t)){let s=this._getOwnPropertyDescriptor(t,e);return s!==void 0&&"set"in s?Reflect.set(t,e,n,i):Reflect.set(t,e,n)}return!0}deleteProperty(t,e,n){if(Reflect.deleteProperty(t,e)){if(!this.isUnsubscribed){let i=this._getDescriptorCache().get(t);i&&(delete i[e],this._pathCache.delete(n))}return!0}return!1}isSameDescriptor(t,e,n){let i=this._getOwnPropertyDescriptor(e,n);return t!==void 0&&i!==void 0&&Object.is(t.value,i.value)&&(t.writable||!1)===(i.writable||!1)&&(t.enumerable||!1)===(i.enumerable||!1)&&(t.configurable||!1)===(i.configurable||!1)&&t.get===i.get&&t.set===i.set}isGetInvariant(t,e){let n=this._getOwnPropertyDescriptor(t,e);return n!==void 0&&n.configurable!==!0&&n.writable!==!0}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function JL(t){return toString.call(t)==="[object Object]"}function Eb(){return!0}function im(t,e){return t.length!==e.length||t.some((n,i)=>e[i]!==n)}var MK=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),eMe=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),EK={push:Eb,pop:Eb,shift:Eb,unshift:Eb,copyWithin:im,reverse:im,sort:im,splice:im,flat:im,fill:im},tMe=new Set([...MK,...eMe,...Object.keys(EK)]);function Cb(t,e){if(t.size!==e.size)return!0;for(let n of t)if(!e.has(n))return!0;return!1}var CK=["keys","values","entries"],TK=new Set(["has","toString"]),PK={add:Cb,clear:Cb,delete:Cb,forEach:Cb},nMe=new Set([...TK,...Object.keys(PK),...CK]);function Tb(t,e){if(t.size!==e.size)return!0;let n;for(let[i,r]of t)if(n=e.get(i),n!==r||n===void 0&&!e.has(i))return!0;return!1}var iMe=new Set([...TK,"get"]),DK={set:Tb,clear:Tb,delete:Tb,forEach:Tb},rMe=new Set([...iMe,...Object.keys(DK),...CK]),Qh=class{constructor(t,e,n,i){this._path=e,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=i,this._changes=i?[]:null,this.clone=e===void 0?t:this._shallowClone(t)}static isHandledMethod(t){return MK.has(t)}_shallowClone(t){let e=t;if(JL(t))e={...t};else if(Fl(t))e=[...t];else if(t instanceof Date)e=new Date(t);else if(t instanceof Set)e=new Set([...t].map(n=>this._shallowClone(n)));else if(t instanceof Map){e=new Map;for(let[n,i]of t.entries())e.set(n,this._shallowClone(i))}return this._clonedCache.add(e),e}preferredThisArg(t,e,n,i){return t?(Fl(i)?this._onIsChanged=EK[e]:i instanceof Set?this._onIsChanged=PK[e]:i instanceof Map&&(this._onIsChanged=DK[e]),i):n}update(t,e,n){let i=Qo.after(t,this._path);if(e!=="length"){let r=this.clone;Qo.walk(i,s=>{r&&r[s]&&(this._clonedCache.has(r[s])||(r[s]=this._shallowClone(r[s])),r=r[s])}),this._hasOnValidate&&this._changes.push({path:i,property:e,previous:n}),r&&r[e]&&(r[e]=n)}this._isChanged=!0}undo(t){let e;for(let n=this._changes.length-1;n!==-1;n--)e=this._changes[n],Qo.get(t,e.path)[e.property]=e.previous}isChanged(t){return this._onIsChanged===void 0?this._isChanged:this._onIsChanged(this.clone,t)}},r5=class extends Qh{static isHandledMethod(t){return tMe.has(t)}},sMe=class extends Qh{undo(t){t.setTime(this.clone.getTime())}isChanged(t,e){return!e(this.clone.valueOf(),t.valueOf())}},s5=class extends Qh{static isHandledMethod(t){return nMe.has(t)}undo(t){for(let e of this.clone)t.add(e);for(let e of t)this.clone.has(e)||t.delete(e)}},o5=class extends Qh{static isHandledMethod(t){return rMe.has(t)}undo(t){for(let[e,n]of this.clone.entries())t.set(e,n);for(let e of t.keys())this.clone.has(e)||t.delete(e)}},oMe=class extends Qh{constructor(t,e,n,i){super(void 0,e,n,i),this._arg1=n[0],this._weakValue=t.has(this._arg1)}isChanged(t){return this._weakValue!==t.has(this._arg1)}undo(t){this._weakValue&&!t.has(this._arg1)?t.add(this._arg1):t.delete(this._arg1)}},aMe=class extends Qh{constructor(t,e,n,i){super(void 0,e,n,i),this._weakKey=n[0],this._weakHas=t.has(this._weakKey),this._weakValue=t.get(this._weakKey)}isChanged(t){return this._weakValue!==t.get(this._weakKey)}undo(t){let e=t.has(this._weakKey);this._weakHas&&!e?t.set(this._weakKey,this._weakValue):!this._weakHas&&e?t.delete(this._weakKey):this._weakValue!==t.get(this._weakKey)&&t.set(this._weakKey,this._weakValue)}},wm=class{constructor(t){this._stack=[],this._hasOnValidate=t}static isHandledType(t){return JL(t)||Fl(t)||KL(t)}static isHandledMethod(t,e){return JL(t)?Qh.isHandledMethod(e):Fl(t)?r5.isHandledMethod(e):t instanceof Set?s5.isHandledMethod(e):t instanceof Map?o5.isHandledMethod(e):KL(t)}get isCloning(){return this._stack.length>0}start(t,e,n){let i=Qh;Fl(t)?i=r5:t instanceof Date?i=sMe:t instanceof Set?i=s5:t instanceof Map?i=o5:t instanceof WeakSet?i=oMe:t instanceof WeakMap&&(i=aMe),this._stack.push(new i(t,e,n,this._hasOnValidate))}update(t,e,n){this._stack[this._stack.length-1].update(t,e,n)}preferredThisArg(t,e,n){let{name:i}=t,r=wm.isHandledMethod(n,i);return this._stack[this._stack.length-1].preferredThisArg(r,i,e,n)}isChanged(t,e,n){return this._stack[this._stack.length-1].isChanged(t,e,n)}undo(t){this._previousClone!==void 0&&this._previousClone.undo(t)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},lMe={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},JO=(t,e,n={})=>{n={...lMe,...n};let i=Symbol("ProxyTarget"),{equals:r,isShallow:s,ignoreDetached:o,details:a}=n,l=new $Ae(r),c=typeof n.onValidate=="function",h=new wm(c),u=(y,w,b,A,S)=>!c||h.isCloning||n.onValidate(Qo.concat(l.getPath(y),w),b,A,S)===!0,d=(y,w,b,A)=>{!i5(l,n,w)&&!(o&&l.isDetached(y,t))&&f(l.getPath(y),w,b,A)},f=(y,w,b,A,S)=>{h.isCloning?h.update(y,w,A):e(Qo.concat(y,w),b,A,S)},p=y=>y&&(y[i]||y),v=(y,w,b,A)=>QAe(y)||b==="constructor"||s&&!wm.isHandledMethod(w,b)||i5(l,n,b)||l.isGetInvariant(w,b)||o&&l.isDetached(w,t)?y:(A===void 0&&(A=l.getPath(w)),l.getProxy(y,Qo.concat(A,b),g,i)),g={get(y,w,b){if(KO(w)){if(w===i||w===QO)return y;if(w===AK&&!l.isUnsubscribed&&l.getPath(y).length===0)return l.unsubscribe(),y}let A=KL(y)?Reflect.get(y,w):Reflect.get(y,w,b);return v(A,y,w)},set(y,w,b,A){b=p(b);let S=y[i]||y,T=S[w];if(r(T,b)&&w in y)return!0;let M=u(y,w,b,T);return M&&l.setProperty(S,w,b,A,T)?(d(y,w,y[w],T),!0):!M},defineProperty(y,w,b){if(!l.isSameDescriptor(b,y,w)){let A=y[w];u(y,w,b.value,A)&&l.defineProperty(y,w,b,A)&&d(y,w,b.value,A)}return!0},deleteProperty(y,w){if(!Reflect.has(y,w))return!0;let b=Reflect.get(y,w),A=u(y,w,void 0,b);return A&&l.deleteProperty(y,w,b)?(d(y,w,void 0,b),!0):!A},apply(y,w,b){let A=w[i]||w;if(l.isUnsubscribed)return Reflect.apply(y,A,b);if((a===!1||a!==!0&&!a.includes(y.name))&&wm.isHandledType(A)){let S=Qo.initial(l.getPath(y)),T=wm.isHandledMethod(A,y.name);h.start(A,S,b);let M=Reflect.apply(y,h.preferredThisArg(y,w,A),T?b.map(R=>p(R)):b),E=h.isChanged(A,r),P=h.stop();if(wm.isHandledType(M)&&T&&(w instanceof Map&&y.name==="get"&&(S=Qo.concat(S,b[0])),M=l.getProxy(M,S,g)),E){let R={name:y.name,args:b,result:M},F=h.isCloning?Qo.initial(S):S,B=h.isCloning?Qo.last(S):"";u(Qo.get(t,F),B,A,P,R)?f(F,B,A,P,R):h.undo(A)}return(w instanceof Map||w instanceof Set)&&JAe(M)?ZAe(M,y,w,S,v):M}return Reflect.apply(y,w,b)}},m=l.getProxy(t,n.pathAsArray?[]:"",g);return e=e.bind(m),c&&(n.onValidate=n.onValidate.bind(m)),m};JO.target=t=>t&&t[QO]||t;JO.unsubscribe=t=>t[AK]||t;var a5=JO,cMe=typeof global=="object"&&global&&global.Object===Object&&global,RK=cMe,uMe=typeof self=="object"&&self&&self.Object===Object&&self,hMe=RK||uMe||Function("return this")(),ll=hMe,dMe=ll.Symbol,da=dMe,LK=Object.prototype,fMe=LK.hasOwnProperty,pMe=LK.toString,R0=da?da.toStringTag:void 0;function mMe(t){var e=fMe.call(t,R0),n=t[R0];try{t[R0]=void 0;var i=!0}catch{}var r=pMe.call(t);return i&&(e?t[R0]=n:delete t[R0]),r}var gMe=mMe,vMe=Object.prototype,yMe=vMe.toString;function xMe(t){return yMe.call(t)}var wMe=xMe,_Me="[object Null]",bMe="[object Undefined]",l5=da?da.toStringTag:void 0;function SMe(t){return t==null?t===void 0?bMe:_Me:l5&&l5 in Object(t)?gMe(t):wMe(t)}var Zf=SMe;function AMe(t){return t!=null&&typeof t=="object"}var cu=AMe,MMe="[object Symbol]";function EMe(t){return typeof t=="symbol"||cu(t)&&Zf(t)==MMe}var AE=EMe;function CMe(t,e){for(var n=-1,i=t==null?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}var IK=CMe,TMe=Array.isArray,ic=TMe,PMe=1/0,c5=da?da.prototype:void 0,u5=c5?c5.toString:void 0;function BK(t){if(typeof t=="string")return t;if(ic(t))return IK(t,BK)+"";if(AE(t))return u5?u5.call(t):"";var e=t+"";return e=="0"&&1/t==-PMe?"-0":e}var DMe=BK,RMe=/\s/;function LMe(t){for(var e=t.length;e--&&RMe.test(t.charAt(e)););return e}var IMe=LMe,BMe=/^\s+/;function OMe(t){return t&&t.slice(0,IMe(t)+1).replace(BMe,"")}var FMe=OMe;function NMe(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var tl=NMe,h5=0/0,UMe=/^[-+]0x[0-9a-f]+$/i,kMe=/^0b[01]+$/i,zMe=/^0o[0-7]+$/i,GMe=parseInt;function HMe(t){if(typeof t=="number")return t;if(AE(t))return h5;if(tl(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=tl(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=FMe(t);var n=kMe.test(t);return n||zMe.test(t)?GMe(t.slice(2),n?2:8):UMe.test(t)?h5:+t}var d5=HMe;function VMe(t){return t}var jMe=VMe,WMe="[object AsyncFunction]",XMe="[object Function]",YMe="[object GeneratorFunction]",qMe="[object Proxy]";function QMe(t){if(!tl(t))return!1;var e=Zf(t);return e==XMe||e==YMe||e==WMe||e==qMe}var OK=QMe,KMe=ll["__core-js_shared__"],w2=KMe,f5=function(){var t=/[^.]+$/.exec(w2&&w2.keys&&w2.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function JMe(t){return!!f5&&f5 in t}var ZMe=JMe,$Me=Function.prototype,eEe=$Me.toString;function tEe(t){if(t!=null){try{return eEe.call(t)}catch{}try{return t+""}catch{}}return""}var $f=tEe,nEe=/[\\^$.*+?()[\]{}|]/g,iEe=/^\[object .+?Constructor\]$/,rEe=Function.prototype,sEe=Object.prototype,oEe=rEe.toString,aEe=sEe.hasOwnProperty,lEe=RegExp("^"+oEe.call(aEe).replace(nEe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function cEe(t){if(!tl(t)||ZMe(t))return!1;var e=OK(t)?lEe:iEe;return e.test($f(t))}var uEe=cEe;function hEe(t,e){return t==null?void 0:t[e]}var dEe=hEe;function fEe(t,e){var n=dEe(t,e);return uEe(n)?n:void 0}var ep=fEe,pEe=ep(ll,"WeakMap"),ZL=pEe,p5=Object.create,mEe=function(){function t(){}return function(e){if(!tl(e))return{};if(p5)return p5(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),gEe=mEe;function vEe(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var yEe=vEe;function xEe(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}var wEe=xEe,_Ee=800,bEe=16,SEe=Date.now;function AEe(t){var e=0,n=0;return function(){var i=SEe(),r=bEe-(i-n);if(n=i,r>0){if(++e>=_Ee)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var MEe=AEe;function EEe(t){return function(){return t}}var CEe=EEe,TEe=function(){try{var t=ep(Object,"defineProperty");return t({},"",{}),t}catch{}}(),GA=TEe,PEe=GA?function(t,e){return GA(t,"toString",{configurable:!0,enumerable:!1,value:CEe(e),writable:!0})}:jMe,DEe=PEe,REe=MEe(DEe),LEe=REe;function IEe(t,e){for(var n=-1,i=t==null?0:t.length;++n<i&&e(t[n],n,t)!==!1;);return t}var BEe=IEe,OEe=9007199254740991,FEe=/^(?:0|[1-9]\d*)$/;function NEe(t,e){var n=typeof t;return e=e??OEe,!!e&&(n=="number"||n!="symbol"&&FEe.test(t))&&t>-1&&t%1==0&&t<e}var ZO=NEe;function UEe(t,e,n){e=="__proto__"&&GA?GA(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var FK=UEe;function kEe(t,e){return t===e||t!==t&&e!==e}var $O=kEe,zEe=Object.prototype,GEe=zEe.hasOwnProperty;function HEe(t,e,n){var i=t[e];(!(GEe.call(t,e)&&$O(i,n))||n===void 0&&!(e in t))&&FK(t,e,n)}var eF=HEe;function VEe(t,e,n,i){var r=!n;n||(n={});for(var s=-1,o=e.length;++s<o;){var a=e[s],l=i?i(n[a],t[a],a,n,t):void 0;l===void 0&&(l=t[a]),r?FK(n,a,l):eF(n,a,l)}return n}var z1=VEe,m5=Math.max;function jEe(t,e,n){return e=m5(e===void 0?t.length-1:e,0),function(){for(var i=arguments,r=-1,s=m5(i.length-e,0),o=Array(s);++r<s;)o[r]=i[e+r];r=-1;for(var a=Array(e+1);++r<e;)a[r]=i[r];return a[e]=n(o),yEe(t,this,a)}}var WEe=jEe,XEe=9007199254740991;function YEe(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=XEe}var tF=YEe;function qEe(t){return t!=null&&tF(t.length)&&!OK(t)}var NK=qEe,QEe=Object.prototype;function KEe(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||QEe;return t===n}var nF=KEe;function JEe(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}var ZEe=JEe,$Ee="[object Arguments]";function eCe(t){return cu(t)&&Zf(t)==$Ee}var g5=eCe,UK=Object.prototype,tCe=UK.hasOwnProperty,nCe=UK.propertyIsEnumerable,iCe=g5(function(){return arguments}())?g5:function(t){return cu(t)&&tCe.call(t,"callee")&&!nCe.call(t,"callee")},iF=iCe;function rCe(){return!1}var sCe=rCe,kK=typeof mo=="object"&&mo&&!mo.nodeType&&mo,v5=kK&&typeof go=="object"&&go&&!go.nodeType&&go,oCe=v5&&v5.exports===kK,y5=oCe?ll.Buffer:void 0,aCe=y5?y5.isBuffer:void 0,lCe=aCe||sCe,HA=lCe,cCe="[object Arguments]",uCe="[object Array]",hCe="[object Boolean]",dCe="[object Date]",fCe="[object Error]",pCe="[object Function]",mCe="[object Map]",gCe="[object Number]",vCe="[object Object]",yCe="[object RegExp]",xCe="[object Set]",wCe="[object String]",_Ce="[object WeakMap]",bCe="[object ArrayBuffer]",SCe="[object DataView]",ACe="[object Float32Array]",MCe="[object Float64Array]",ECe="[object Int8Array]",CCe="[object Int16Array]",TCe="[object Int32Array]",PCe="[object Uint8Array]",DCe="[object Uint8ClampedArray]",RCe="[object Uint16Array]",LCe="[object Uint32Array]",qn={};qn[ACe]=qn[MCe]=qn[ECe]=qn[CCe]=qn[TCe]=qn[PCe]=qn[DCe]=qn[RCe]=qn[LCe]=!0;qn[cCe]=qn[uCe]=qn[bCe]=qn[hCe]=qn[SCe]=qn[dCe]=qn[fCe]=qn[pCe]=qn[mCe]=qn[gCe]=qn[vCe]=qn[yCe]=qn[xCe]=qn[wCe]=qn[_Ce]=!1;function ICe(t){return cu(t)&&tF(t.length)&&!!qn[Zf(t)]}var BCe=ICe;function OCe(t){return function(e){return t(e)}}var rF=OCe,zK=typeof mo=="object"&&mo&&!mo.nodeType&&mo,Uy=zK&&typeof go=="object"&&go&&!go.nodeType&&go,FCe=Uy&&Uy.exports===zK,_2=FCe&&RK.process,NCe=function(){try{var t=Uy&&Uy.require&&Uy.require("util").types;return t||_2&&_2.binding&&_2.binding("util")}catch{}}(),qg=NCe,x5=qg&&qg.isTypedArray,UCe=x5?rF(x5):BCe,GK=UCe,kCe=Object.prototype,zCe=kCe.hasOwnProperty;function GCe(t,e){var n=ic(t),i=!n&&iF(t),r=!n&&!i&&HA(t),s=!n&&!i&&!r&&GK(t),o=n||i||r||s,a=o?ZEe(t.length,String):[],l=a.length;for(var c in t)(e||zCe.call(t,c))&&!(o&&(c=="length"||r&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||ZO(c,l)))&&a.push(c);return a}var HK=GCe;function HCe(t,e){return function(n){return t(e(n))}}var VK=HCe,VCe=VK(Object.keys,Object),jCe=VCe,WCe=Object.prototype,XCe=WCe.hasOwnProperty;function YCe(t){if(!nF(t))return jCe(t);var e=[];for(var n in Object(t))XCe.call(t,n)&&n!="constructor"&&e.push(n);return e}var qCe=YCe;function QCe(t){return NK(t)?HK(t):qCe(t)}var sF=QCe;function KCe(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var JCe=KCe,ZCe=Object.prototype,$Ce=ZCe.hasOwnProperty;function eTe(t){if(!tl(t))return JCe(t);var e=nF(t),n=[];for(var i in t)i=="constructor"&&(e||!$Ce.call(t,i))||n.push(i);return n}var tTe=eTe;function nTe(t){return NK(t)?HK(t,!0):tTe(t)}var oF=nTe,iTe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,rTe=/^\w*$/;function sTe(t,e){if(ic(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||AE(t)?!0:rTe.test(t)||!iTe.test(t)||e!=null&&t in Object(e)}var oTe=sTe,aTe=ep(Object,"create"),Nx=aTe;function lTe(){this.__data__=Nx?Nx(null):{},this.size=0}var cTe=lTe;function uTe(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var hTe=uTe,dTe="__lodash_hash_undefined__",fTe=Object.prototype,pTe=fTe.hasOwnProperty;function mTe(t){var e=this.__data__;if(Nx){var n=e[t];return n===dTe?void 0:n}return pTe.call(e,t)?e[t]:void 0}var gTe=mTe,vTe=Object.prototype,yTe=vTe.hasOwnProperty;function xTe(t){var e=this.__data__;return Nx?e[t]!==void 0:yTe.call(e,t)}var wTe=xTe,_Te="__lodash_hash_undefined__";function bTe(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Nx&&e===void 0?_Te:e,this}var STe=bTe;function bv(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}bv.prototype.clear=cTe;bv.prototype.delete=hTe;bv.prototype.get=gTe;bv.prototype.has=wTe;bv.prototype.set=STe;var w5=bv;function ATe(){this.__data__=[],this.size=0}var MTe=ATe;function ETe(t,e){for(var n=t.length;n--;)if($O(t[n][0],e))return n;return-1}var ME=ETe,CTe=Array.prototype,TTe=CTe.splice;function PTe(t){var e=this.__data__,n=ME(e,t);if(n<0)return!1;var i=e.length-1;return n==i?e.pop():TTe.call(e,n,1),--this.size,!0}var DTe=PTe;function RTe(t){var e=this.__data__,n=ME(e,t);return n<0?void 0:e[n][1]}var LTe=RTe;function ITe(t){return ME(this.__data__,t)>-1}var BTe=ITe;function OTe(t,e){var n=this.__data__,i=ME(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}var FTe=OTe;function Sv(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}Sv.prototype.clear=MTe;Sv.prototype.delete=DTe;Sv.prototype.get=LTe;Sv.prototype.has=BTe;Sv.prototype.set=FTe;var EE=Sv,NTe=ep(ll,"Map"),Ux=NTe;function UTe(){this.size=0,this.__data__={hash:new w5,map:new(Ux||EE),string:new w5}}var kTe=UTe;function zTe(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var GTe=zTe;function HTe(t,e){var n=t.__data__;return GTe(e)?n[typeof e=="string"?"string":"hash"]:n.map}var CE=HTe;function VTe(t){var e=CE(this,t).delete(t);return this.size-=e?1:0,e}var jTe=VTe;function WTe(t){return CE(this,t).get(t)}var XTe=WTe;function YTe(t){return CE(this,t).has(t)}var qTe=YTe;function QTe(t,e){var n=CE(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}var KTe=QTe;function Av(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}Av.prototype.clear=kTe;Av.prototype.delete=jTe;Av.prototype.get=XTe;Av.prototype.has=qTe;Av.prototype.set=KTe;var TE=Av,JTe="Expected a function";function aF(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(JTe);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],s=n.cache;if(s.has(r))return s.get(r);var o=t.apply(this,i);return n.cache=s.set(r,o)||s,o};return n.cache=new(aF.Cache||TE),n}aF.Cache=TE;var ZTe=aF,$Te=500;function ePe(t){var e=ZTe(t,function(i){return n.size===$Te&&n.clear(),i}),n=e.cache;return e}var tPe=ePe,nPe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,iPe=/\\(\\)?/g,rPe=tPe(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(nPe,function(n,i,r,s){e.push(r?s.replace(iPe,"$1"):i||n)}),e}),sPe=rPe;function oPe(t){return t==null?"":DMe(t)}var aPe=oPe;function lPe(t,e){return ic(t)?t:oTe(t,e)?[t]:sPe(aPe(t))}var Mv=lPe,cPe=1/0;function uPe(t){if(typeof t=="string"||AE(t))return t;var e=t+"";return e=="0"&&1/t==-cPe?"-0":e}var PE=uPe;function hPe(t,e){e=Mv(e,t);for(var n=0,i=e.length;t!=null&&n<i;)t=t[PE(e[n++])];return n&&n==i?t:void 0}var jK=hPe;function dPe(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}var lF=dPe,_5=da?da.isConcatSpreadable:void 0;function fPe(t){return ic(t)||iF(t)||!!(_5&&t&&t[_5])}var pPe=fPe;function WK(t,e,n,i,r){var s=-1,o=t.length;for(n||(n=pPe),r||(r=[]);++s<o;){var a=t[s];e>0&&n(a)?e>1?WK(a,e-1,n,i,r):lF(r,a):i||(r[r.length]=a)}return r}var mPe=WK;function gPe(t){var e=t==null?0:t.length;return e?mPe(t,1):[]}var vPe=gPe;function yPe(t){return LEe(WEe(t,void 0,vPe),t+"")}var XK=yPe,xPe=VK(Object.getPrototypeOf,Object),cF=xPe,wPe="[object Object]",_Pe=Function.prototype,bPe=Object.prototype,YK=_Pe.toString,SPe=bPe.hasOwnProperty,APe=YK.call(Object);function MPe(t){if(!cu(t)||Zf(t)!=wPe)return!1;var e=cF(t);if(e===null)return!0;var n=SPe.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&YK.call(n)==APe}var EPe=MPe;function CPe(t,e,n){var i=-1,r=t.length;e<0&&(e=-e>r?0:r+e),n=n>r?r:n,n<0&&(n+=r),r=e>n?0:n-e>>>0,e>>>=0;for(var s=Array(r);++i<r;)s[i]=t[i+e];return s}var TPe=CPe;function PPe(){this.__data__=new EE,this.size=0}var DPe=PPe;function RPe(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var LPe=RPe;function IPe(t){return this.__data__.get(t)}var BPe=IPe;function OPe(t){return this.__data__.has(t)}var FPe=OPe,NPe=200;function UPe(t,e){var n=this.__data__;if(n instanceof EE){var i=n.__data__;if(!Ux||i.length<NPe-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new TE(i)}return n.set(t,e),this.size=n.size,this}var kPe=UPe;function Ev(t){var e=this.__data__=new EE(t);this.size=e.size}Ev.prototype.clear=DPe;Ev.prototype.delete=LPe;Ev.prototype.get=BPe;Ev.prototype.has=FPe;Ev.prototype.set=kPe;var BS=Ev;function zPe(t,e){return t&&z1(e,sF(e),t)}var GPe=zPe;function HPe(t,e){return t&&z1(e,oF(e),t)}var VPe=HPe,qK=typeof mo=="object"&&mo&&!mo.nodeType&&mo,b5=qK&&typeof go=="object"&&go&&!go.nodeType&&go,jPe=b5&&b5.exports===qK,S5=jPe?ll.Buffer:void 0,A5=S5?S5.allocUnsafe:void 0;function WPe(t,e){if(e)return t.slice();var n=t.length,i=A5?A5(n):new t.constructor(n);return t.copy(i),i}var XPe=WPe;function YPe(t,e){for(var n=-1,i=t==null?0:t.length,r=0,s=[];++n<i;){var o=t[n];e(o,n,t)&&(s[r++]=o)}return s}var qPe=YPe;function QPe(){return[]}var QK=QPe,KPe=Object.prototype,JPe=KPe.propertyIsEnumerable,M5=Object.getOwnPropertySymbols,ZPe=M5?function(t){return t==null?[]:(t=Object(t),qPe(M5(t),function(e){return JPe.call(t,e)}))}:QK,uF=ZPe;function $Pe(t,e){return z1(t,uF(t),e)}var e2e=$Pe,t2e=Object.getOwnPropertySymbols,n2e=t2e?function(t){for(var e=[];t;)lF(e,uF(t)),t=cF(t);return e}:QK,KK=n2e;function i2e(t,e){return z1(t,KK(t),e)}var r2e=i2e;function s2e(t,e,n){var i=e(t);return ic(t)?i:lF(i,n(t))}var JK=s2e;function o2e(t){return JK(t,sF,uF)}var $L=o2e;function a2e(t){return JK(t,oF,KK)}var ZK=a2e,l2e=ep(ll,"DataView"),eI=l2e,c2e=ep(ll,"Promise"),tI=c2e,u2e=ep(ll,"Set"),nI=u2e,E5="[object Map]",h2e="[object Object]",C5="[object Promise]",T5="[object Set]",P5="[object WeakMap]",D5="[object DataView]",d2e=$f(eI),f2e=$f(Ux),p2e=$f(tI),m2e=$f(nI),g2e=$f(ZL),Hd=Zf;(eI&&Hd(new eI(new ArrayBuffer(1)))!=D5||Ux&&Hd(new Ux)!=E5||tI&&Hd(tI.resolve())!=C5||nI&&Hd(new nI)!=T5||ZL&&Hd(new ZL)!=P5)&&(Hd=function(t){var e=Zf(t),n=e==h2e?t.constructor:void 0,i=n?$f(n):"";if(i)switch(i){case d2e:return D5;case f2e:return E5;case p2e:return C5;case m2e:return T5;case g2e:return P5}return e});var kx=Hd,v2e=Object.prototype,y2e=v2e.hasOwnProperty;function x2e(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&y2e.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var w2e=x2e,_2e=ll.Uint8Array,VA=_2e;function b2e(t){var e=new t.constructor(t.byteLength);return new VA(e).set(new VA(t)),e}var hF=b2e;function S2e(t,e){var n=e?hF(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var A2e=S2e,M2e=/\w*$/;function E2e(t){var e=new t.constructor(t.source,M2e.exec(t));return e.lastIndex=t.lastIndex,e}var C2e=E2e,R5=da?da.prototype:void 0,L5=R5?R5.valueOf:void 0;function T2e(t){return L5?Object(L5.call(t)):{}}var P2e=T2e;function D2e(t,e){var n=e?hF(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var R2e=D2e,L2e="[object Boolean]",I2e="[object Date]",B2e="[object Map]",O2e="[object Number]",F2e="[object RegExp]",N2e="[object Set]",U2e="[object String]",k2e="[object Symbol]",z2e="[object ArrayBuffer]",G2e="[object DataView]",H2e="[object Float32Array]",V2e="[object Float64Array]",j2e="[object Int8Array]",W2e="[object Int16Array]",X2e="[object Int32Array]",Y2e="[object Uint8Array]",q2e="[object Uint8ClampedArray]",Q2e="[object Uint16Array]",K2e="[object Uint32Array]";function J2e(t,e,n){var i=t.constructor;switch(e){case z2e:return hF(t);case L2e:case I2e:return new i(+t);case G2e:return A2e(t,n);case H2e:case V2e:case j2e:case W2e:case X2e:case Y2e:case q2e:case Q2e:case K2e:return R2e(t,n);case B2e:return new i;case O2e:case U2e:return new i(t);case F2e:return C2e(t);case N2e:return new i;case k2e:return P2e(t)}}var Z2e=J2e;function $2e(t){return typeof t.constructor=="function"&&!nF(t)?gEe(cF(t)):{}}var eDe=$2e,tDe="[object Map]";function nDe(t){return cu(t)&&kx(t)==tDe}var iDe=nDe,I5=qg&&qg.isMap,rDe=I5?rF(I5):iDe,sDe=rDe,oDe="[object Set]";function aDe(t){return cu(t)&&kx(t)==oDe}var lDe=aDe,B5=qg&&qg.isSet,cDe=B5?rF(B5):lDe,uDe=cDe,hDe=1,dDe=2,fDe=4,$K="[object Arguments]",pDe="[object Array]",mDe="[object Boolean]",gDe="[object Date]",vDe="[object Error]",eJ="[object Function]",yDe="[object GeneratorFunction]",xDe="[object Map]",wDe="[object Number]",tJ="[object Object]",_De="[object RegExp]",bDe="[object Set]",SDe="[object String]",ADe="[object Symbol]",MDe="[object WeakMap]",EDe="[object ArrayBuffer]",CDe="[object DataView]",TDe="[object Float32Array]",PDe="[object Float64Array]",DDe="[object Int8Array]",RDe="[object Int16Array]",LDe="[object Int32Array]",IDe="[object Uint8Array]",BDe="[object Uint8ClampedArray]",ODe="[object Uint16Array]",FDe="[object Uint32Array]",Vn={};Vn[$K]=Vn[pDe]=Vn[EDe]=Vn[CDe]=Vn[mDe]=Vn[gDe]=Vn[TDe]=Vn[PDe]=Vn[DDe]=Vn[RDe]=Vn[LDe]=Vn[xDe]=Vn[wDe]=Vn[tJ]=Vn[_De]=Vn[bDe]=Vn[SDe]=Vn[ADe]=Vn[IDe]=Vn[BDe]=Vn[ODe]=Vn[FDe]=!0;Vn[vDe]=Vn[eJ]=Vn[MDe]=!1;function OS(t,e,n,i,r,s){var o,a=e&hDe,l=e&dDe,c=e&fDe;if(n&&(o=r?n(t,i,r,s):n(t)),o!==void 0)return o;if(!tl(t))return t;var h=ic(t);if(h){if(o=w2e(t),!a)return wEe(t,o)}else{var u=kx(t),d=u==eJ||u==yDe;if(HA(t))return XPe(t,a);if(u==tJ||u==$K||d&&!r){if(o=l||d?{}:eDe(t),!a)return l?r2e(t,VPe(o,t)):e2e(t,GPe(o,t))}else{if(!Vn[u])return r?t:{};o=Z2e(t,u,a)}}s||(s=new BS);var f=s.get(t);if(f)return f;s.set(t,o),uDe(t)?t.forEach(function(g){o.add(OS(g,e,n,g,t,s))}):sDe(t)&&t.forEach(function(g,m){o.set(m,OS(g,e,n,m,t,s))});var p=c?l?ZK:$L:l?oF:sF,v=h?void 0:p(t);return BEe(v||t,function(g,m){v&&(m=g,g=t[m]),eF(o,m,OS(g,e,n,m,t,s))}),o}var nJ=OS,NDe=1,UDe=4;function kDe(t){return nJ(t,NDe|UDe)}var DE=kDe,zDe="__lodash_hash_undefined__";function GDe(t){return this.__data__.set(t,zDe),this}var HDe=GDe;function VDe(t){return this.__data__.has(t)}var jDe=VDe;function jA(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new TE;++e<n;)this.add(t[e])}jA.prototype.add=jA.prototype.push=HDe;jA.prototype.has=jDe;var WDe=jA;function XDe(t,e){for(var n=-1,i=t==null?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}var YDe=XDe;function qDe(t,e){return t.has(e)}var QDe=qDe,KDe=1,JDe=2;function ZDe(t,e,n,i,r,s){var o=n&KDe,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(t),h=s.get(e);if(c&&h)return c==e&&h==t;var u=-1,d=!0,f=n&JDe?new WDe:void 0;for(s.set(t,e),s.set(e,t);++u<a;){var p=t[u],v=e[u];if(i)var g=o?i(v,p,u,e,t,s):i(p,v,u,t,e,s);if(g!==void 0){if(g)continue;d=!1;break}if(f){if(!YDe(e,function(m,y){if(!QDe(f,y)&&(p===m||r(p,m,n,i,s)))return f.push(y)})){d=!1;break}}else if(!(p===v||r(p,v,n,i,s))){d=!1;break}}return s.delete(t),s.delete(e),d}var iJ=ZDe;function $De(t){var e=-1,n=Array(t.size);return t.forEach(function(i,r){n[++e]=[r,i]}),n}var eRe=$De;function tRe(t){var e=-1,n=Array(t.size);return t.forEach(function(i){n[++e]=i}),n}var nRe=tRe,iRe=1,rRe=2,sRe="[object Boolean]",oRe="[object Date]",aRe="[object Error]",lRe="[object Map]",cRe="[object Number]",uRe="[object RegExp]",hRe="[object Set]",dRe="[object String]",fRe="[object Symbol]",pRe="[object ArrayBuffer]",mRe="[object DataView]",O5=da?da.prototype:void 0,b2=O5?O5.valueOf:void 0;function gRe(t,e,n,i,r,s,o){switch(n){case mRe:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case pRe:return!(t.byteLength!=e.byteLength||!s(new VA(t),new VA(e)));case sRe:case oRe:case cRe:return $O(+t,+e);case aRe:return t.name==e.name&&t.message==e.message;case uRe:case dRe:return t==e+"";case lRe:var a=eRe;case hRe:var l=i&iRe;if(a||(a=nRe),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;i|=rRe,o.set(t,e);var h=iJ(a(t),a(e),i,r,s,o);return o.delete(t),h;case fRe:if(b2)return b2.call(t)==b2.call(e)}return!1}var vRe=gRe,yRe=1,xRe=Object.prototype,wRe=xRe.hasOwnProperty;function _Re(t,e,n,i,r,s){var o=n&yRe,a=$L(t),l=a.length,c=$L(e),h=c.length;if(l!=h&&!o)return!1;for(var u=l;u--;){var d=a[u];if(!(o?d in e:wRe.call(e,d)))return!1}var f=s.get(t),p=s.get(e);if(f&&p)return f==e&&p==t;var v=!0;s.set(t,e),s.set(e,t);for(var g=o;++u<l;){d=a[u];var m=t[d],y=e[d];if(i)var w=o?i(y,m,d,e,t,s):i(m,y,d,t,e,s);if(!(w===void 0?m===y||r(m,y,n,i,s):w)){v=!1;break}g||(g=d=="constructor")}if(v&&!g){var b=t.constructor,A=e.constructor;b!=A&&"constructor"in t&&"constructor"in e&&!(typeof b=="function"&&b instanceof b&&typeof A=="function"&&A instanceof A)&&(v=!1)}return s.delete(t),s.delete(e),v}var bRe=_Re,SRe=1,F5="[object Arguments]",N5="[object Array]",Pb="[object Object]",ARe=Object.prototype,U5=ARe.hasOwnProperty;function MRe(t,e,n,i,r,s){var o=ic(t),a=ic(e),l=o?N5:kx(t),c=a?N5:kx(e);l=l==F5?Pb:l,c=c==F5?Pb:c;var h=l==Pb,u=c==Pb,d=l==c;if(d&&HA(t)){if(!HA(e))return!1;o=!0,h=!1}if(d&&!h)return s||(s=new BS),o||GK(t)?iJ(t,e,n,i,r,s):vRe(t,e,l,n,i,r,s);if(!(n&SRe)){var f=h&&U5.call(t,"__wrapped__"),p=u&&U5.call(e,"__wrapped__");if(f||p){var v=f?t.value():t,g=p?e.value():e;return s||(s=new BS),r(v,g,n,i,s)}}return d?(s||(s=new BS),bRe(t,e,n,i,r,s)):!1}var ERe=MRe;function rJ(t,e,n,i,r){return t===e?!0:t==null||e==null||!cu(t)&&!cu(e)?t!==t&&e!==e:ERe(t,e,n,i,rJ,r)}var CRe=rJ;function TRe(t,e){return t!=null&&e in Object(t)}var PRe=TRe;function DRe(t,e,n){e=Mv(e,t);for(var i=-1,r=e.length,s=!1;++i<r;){var o=PE(e[i]);if(!(s=t!=null&&n(t,o)))break;t=t[o]}return s||++i!=r?s:(r=t==null?0:t.length,!!r&&tF(r)&&ZO(o,r)&&(ic(t)||iF(t)))}var RRe=DRe;function LRe(t,e){return t!=null&&RRe(t,e,PRe)}var IRe=LRe,BRe=function(){return ll.Date.now()},S2=BRe,ORe="Expected a function",FRe=Math.max,NRe=Math.min;function URe(t,e,n){var i,r,s,o,a,l,c=0,h=!1,u=!1,d=!0;if(typeof t!="function")throw new TypeError(ORe);e=d5(e)||0,tl(n)&&(h=!!n.leading,u="maxWait"in n,s=u?FRe(d5(n.maxWait)||0,e):s,d="trailing"in n?!!n.trailing:d);function f(S){var T=i,M=r;return i=r=void 0,c=S,o=t.apply(M,T),o}function p(S){return c=S,a=setTimeout(m,e),h?f(S):o}function v(S){var T=S-l,M=S-c,E=e-T;return u?NRe(E,s-M):E}function g(S){var T=S-l,M=S-c;return l===void 0||T>=e||T<0||u&&M>=s}function m(){var S=S2();if(g(S))return y(S);a=setTimeout(m,v(S))}function y(S){return a=void 0,d&&i?f(S):(i=r=void 0,o)}function w(){a!==void 0&&clearTimeout(a),c=0,i=l=r=a=void 0}function b(){return a===void 0?o:y(S2())}function A(){var S=S2(),T=g(S);if(i=arguments,r=this,l=S,T){if(a===void 0)return p(l);if(u)return clearTimeout(a),a=setTimeout(m,e),f(l)}return a===void 0&&(a=setTimeout(m,e)),o}return A.cancel=w,A.flush=b,A}var dF=URe;function kRe(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var zRe=kRe;function GRe(t,e){return e.length<2?t:jK(t,TPe(e,0,-1))}var HRe=GRe;function VRe(t,e){return CRe(t,e)}var fF=VRe;function jRe(t,e){return e=Mv(e,t),t=HRe(t,e),t==null||delete t[PE(zRe(e))]}var WRe=jRe;function XRe(t){return EPe(t)?void 0:t}var YRe=XRe,qRe=1,QRe=2,KRe=4,JRe=XK(function(t,e){var n={};if(t==null)return n;var i=!1;e=IK(e,function(s){return s=Mv(s,t),i||(i=s.length>1),s}),z1(t,ZK(t),n),i&&(n=nJ(n,qRe|QRe|KRe,YRe));for(var r=e.length;r--;)WRe(n,e[r]);return n}),iI=JRe;function ZRe(t,e,n,i){if(!tl(t))return t;e=Mv(e,t);for(var r=-1,s=e.length,o=s-1,a=t;a!=null&&++r<s;){var l=PE(e[r]),c=n;if(l==="__proto__"||l==="constructor"||l==="prototype")return t;if(r!=o){var h=a[l];c=i?i(h,l,a):void 0,c===void 0&&(c=tl(h)?h:ZO(e[r+1])?[]:{})}eF(a,l,c),a=a[l]}return t}var $Re=ZRe;function eLe(t,e,n){for(var i=-1,r=e.length,s={};++i<r;){var o=e[i],a=jK(t,o);n(a,o)&&$Re(s,Mv(o,t),a)}return s}var tLe=eLe;function nLe(t,e){return tLe(t,e,function(n,i){return IRe(t,i)})}var iLe=nLe,rLe=XK(function(t,e){return t==null?{}:iLe(t,e)}),zx=rLe,sLe="Expected a function";function oLe(t,e,n){var i=!0,r=!0;if(typeof t!="function")throw new TypeError(sLe);return tl(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),dF(t,e,{leading:i,maxWait:e,trailing:r})}var aLe=oLe,sJ,lLe=new Promise(t=>{sJ=t}),k5=!1;async function cLe(){if(k5)return;let t=await yE(()=>import("./physics-dee4de67.js"),[]);await t.init(),sJ(t),k5=!0}var ki=class{modifyById(t,e){let n=this;if(n[t]===void 0)throw new Error("not expected");{let i={...n,[t]:e};return Object.setPrototypeOf(i,ki.prototype),i}}add(t,e){var n;return((n=this.runOp({type:1,id:t,data:e}))==null?void 0:n.data)??this}runOp(t){let e=this;if(t.type===1){let n=e[t.id],i;n===void 0?i={type:2,id:t.id}:i={type:1,id:t.id,data:n};let{id:r,data:s}=t,o={...e,[r]:s};return Object.setPrototypeOf(o,ki.prototype),{data:o,actual:t,reverse:i}}else if(t.type===2){let{id:n}=t,i=e[n];if(i===void 0)return null;{let r={...e};return Object.setPrototypeOf(r,ki.prototype),delete r[n],{data:r,actual:t,reverse:{type:1,id:n,data:i}}}}return null}};function pF(t){if(t.deepFreeze!==void 0){t.deepFreeze(t);return}let e=Object.getOwnPropertyNames(t);for(let n of e){let i=t[n];i&&typeof i=="object"&&pF(i)}return Object.freeze(t)}function uLe(t,e){let n=0;for(;n<t.length&&n<e.length;){if(t[n]<e[n])return-1;if(t[n]>e[n])return 1;n+=1}return n!==e.length?-1:n!==t.length?1:0}var oJ=class extends Error{};function A2(t){let e={...t};return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}function mh(t,e,n){if(t===void 0?e===void 0?(t=0,e=10):t=e-10:e===void 0&&(e=t+10),t>e){let s=t;t=e,e=s}let i=[],r=1/(n+1);for(let s=0;s<n;s++){let o=t+(e-t)*(s+.75+Math.random()*.5)*r;i.push(o)}return i}function mF(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array}function hLe(){return typeof process<"u"}function aJ(t,e){for(let n of t)e(n.id,n.data)!==!0&&aJ(n.children,e)}function lJ(t,e){if(e(t.id,t.data)!==!0)for(let n of t.children)lJ(n,e)}var ks=class extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,ks.prototype)}deepFreeze(){let t=0;for(;t<this.length;)pF(this[t]),t++}fillCaches0(t,e){this.objCaches.set(t.id,t),this.parentCaches.set(t.id,e);for(let n of t.children)this.fillCaches0(n,t.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let t of this)this.fillCaches0(t,null)}}randomId(){this.fillCaches();let t=Array.from(this.objCaches.keys());if(t.length!==0)return t[Math.max(0,Math.floor(Math.random()*t.length)-1)]}nonExistOrDescendantOf(t,e){if(!this.has(t))return!0;for(;t;){let n=this.parent(t);if(n===e)return!0;t=n}return!1}isDescendantOf(t,e){for(;t;){let n=this.parent(t);if(n===e)return!0;t=n}return!1}data(t){var e;return(e=this.get(t))==null?void 0:e.data}has(t){return this.childrenOf(t)!==void 0}get(t){return this.fillCaches(),this.objCaches.get(t)}childrenOf(t){var e;return t===null?this:(e=this.get(t))==null?void 0:e.children}traverseFrom(t,e){if(t===null)this.traverse(e);else{let n=this.get(t);n&&lJ(n,e)}}traverse(t){aJ(this,t)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(t){return this.fillCaches(),this.parentCaches.get(t)}childrenArray(t){return t===null?this:this.get(t).children}modifyById(t,e){if(this.get(t)===void 0)throw new Error("not expected");{let n=this.parent(t),i=this.childrenArray(n),r=i.findIndex(o=>o.id===t);if(r<0)throw new Error("not expected");let s=i[r];return i=[...i],i[r]={...s,data:e},this.modifyArrayBy(n,i)}}modifyArrayBy(t,e){let n=t,i=e;for(;n!==null;){let s=i,o=n;if(n=this.parent(n),n===void 0)throw new Error;i=this.childrenArray(n);let a=i.findIndex(l=>l.id===o);if(a<0)throw new Error;i=[...i],i[a]={...i[a],children:s}}Object.setPrototypeOf(i,ks.prototype);let r=i;return r.fillCaches(),r}runOp(t){switch(t.type){case 7:return this.addOp(t);case 8:return this.deleteOp(t);case 9:return this.moveOp(t)}return null}checkDuplicatedIdRec({id:t,children:e}){if(this.get(t)!==void 0)return!0;for(let n of e)if(this.checkDuplicatedIdRec(n))return!0;return!1}addOp(t){let{parent:e,fi:n,id:i,data:r,children:s}=t;if(e!==null&&this.get(e)===void 0||this.checkDuplicatedIdRec(t))return null;{let o=e,a=this.childrenArray(o),l={fi:n,id:i,data:r,children:s};return a=[...a,l],a.sort((c,h)=>c.fi-h.fi),t.localIndex=a.indexOf(l),{data:this.modifyArrayBy(o,a),actual:t,reverse:{type:8,id:i}}}}deleteOp(t){let{id:e}=t;if(this.get(e)===null)return null;{let n=this.parent(e);if(n===void 0)return null;let i=this.childrenArray(n),r=i.findIndex(o=>o.id===e);t.localIndex=r,i=[...i];let s=i.splice(r,1)[0];return{data:this.modifyArrayBy(n,i),actual:t,reverse:{type:7,...s,parent:n}}}}moveOp(t){let{parent:e,fi:n,id:i}=t;if(e!==null&&this.get(e)===void 0)return this.deleteOp({type:8,id:i});if(e!==null){let u=e;for(;u!==null;){if(u===void 0)throw new Error;if(u===i)throw new oJ("cyclic tree");u=this.parent(u)}}let r=this.parent(i);if(r===void 0)return null;let s=r,o=this.childrenArray(r),a=o.findIndex(u=>u.id===i);o=[...o];let l=o.splice(a,1)[0],c=this.modifyArrayBy(r,o);r=e,o=c.childrenArray(r);let h=l.fi;return l={...l,fi:n},o=[...o,l],o.sort((u,d)=>u.fi-d.fi),t.localIndex=o.indexOf(l),c=c.modifyArrayBy(r,o),{data:c,actual:t,reverse:{type:9,parent:s,fi:h,id:i}}}previous(t,e){if(e===null){let i=this.childrenArray(t);return i.length===0?null:i[i.length-1].id}let n=null;for(let i of this.childrenArray(t)){if(i.id===e)return n;n=i.id}return null}traverseSortNext(t){let e=this.parent(t);if(e!==void 0){let n=this.childrenArray(e),i=n.findIndex(r=>r.id===t)+1;if(i<n.length)return n[i].id;if(e)return this.traverseSortNext(e)}}sortNext(t){let e=this.childrenArray(t);return e.length>0?e[0].id:this.traverseSortNext(t)}traverseSortPrevious(t){let e=this.childrenArray(t);return e.length>0?this.traverseSortPrevious(e[e.length-1].id):t}sortPrevious(t){let e=this.parent(t);if(e!==void 0){let n=this.childrenArray(e),i=n.findIndex(r=>r.id===t)-1;return i>=0?this.traverseSortPrevious(n[i].id):e}}getAllSorted(t){let e=[];for(let n of t){let i=this.getWithSortKey(n.id);i!==void 0&&e.push({...n,...i})}e.sort((n,i)=>uLe(n.sortKey,i.sortKey));for(let n of e)delete n.sortKey;return e}getWithSortKey(t){var e=t;let n=[],i=this.get(e),r=i;if(i!==void 0){for(;e;)n.splice(0,0,i.fi),e=this.parent(e),e!==null&&(i=this.get(e));return{...r,sortKey:n}}}insertBeforeHelper(t,e,n){return this.insertAfterHelper(t,this.previous(t,e),n)}insertAfterHelper(t,e,n){let i=this.childrenArray(t);if(e===null){if(i.length===0)return mh(0,n,n);{let r=i[0].fi;return mh(r-n,r,n)}}else{let r=this.get(e);if(r===void 0||this.parent(e)!==t)throw new Error("illegal args");let s=i.find(o=>o.fi>r.fi);if(s===void 0){let o=i[i.length-1].fi;return mh(o,o+n,n)}else return mh(r.fi,s.fi,n)}}},WA;(t=>{function e(n,i){if(i.type!==0)return null;if(Array.isArray(n)){let r=i.props,s={},o=[...n],a=!1;if(r)for(let l of Object.keys(r)){let c=parseInt(l);if(isNaN(c))throw new Error("wrong index");s[l]=o[c],o[c]=r[l],a=!0}return a?{data:o,actual:i,reverse:{type:0,props:s}}:null}else{let r=i.props,s={},o={...n},a=!1;if(r)for(let l of Object.keys(r)){s[l]=o[l];let c=r[l];c===void 0?delete o[l]:o[l]=c,a=!0}return a?{data:o,actual:i,reverse:{type:0,props:s}}:null}}t.runOp=e})(WA||(WA={}));var $t=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,$t.prototype)}deepFreeze(){let e=0;for(;e<this.length;)pF(this[e]),e++}fillCaches0(e){this.objCaches.set(e.id,e)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let e of this)this.fillCaches0(e)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}data(e){var n;return(n=this.get(e))==null?void 0:n.data}get(e){return this.fillCaches(),this.objCaches.get(e)}modifyById(e,n){if(this.get(e)===void 0)throw new Error("not expected");{let i=this,r=i.findIndex(o=>o.id===e);if(r<0)throw new Error("not expected");let s=i[r];return i=[...i],i[r]={...s,data:n},this.modifyArrayBy(i)}}modifyArrayBy(e){Object.setPrototypeOf(e,$t.prototype);let n=e;return hLe()||n.fillCaches(),n}runOp(e){switch(e.type){case 4:return this.addOp(e);case 5:return this.deleteOp(e);case 6:return this.moveOp(e)}return null}addOp(e){let{fi:n,id:i,data:r}=e,s=this,o={fi:n,id:i,data:r};return s=[...s,o],s.sort((a,l)=>a.fi-l.fi),e.localIndex=s.indexOf(o),{data:this.modifyArrayBy(s),actual:e,reverse:{type:5,id:i}}}deleteOp(e){let{id:n}=e,i=this,r=i.findIndex(o=>o.id===n);if(r===-1)return null;e.localIndex=r,i=[...i];let s=i.splice(r,1)[0];return{data:this.modifyArrayBy(i),actual:e,reverse:{type:4,...s}}}moveOp(e){let{fi:n,id:i}=e,r=this;r=[...r];let s=r.findIndex(l=>l.id===i);if(s===-1)return null;let o=r[s].fi,a={...r[s],fi:n};return r[s]=a,r.sort((l,c)=>l.fi-c.fi),e.localIndex=r.indexOf(a),{data:this.modifyArrayBy(r),actual:e,reverse:{type:6,fi:o,id:i}}}previous(e){if(e===null)return this.length===0?null:this[this.length-1].id;let n=null;for(let i of this){if(i.id===e)return n;n=i.id}return null}insertBeforeHelper(e,n){return this.insertAfterHelper(this.previous(e),n)}insertAfterHelper(e,n){let i=this;if(e===null){if(i.length===0)return mh(0,n,n);{let r=i[0].fi;return mh(r-n,r,n)}}else{let r=this.get(e);if(r===void 0)throw new Error("illegal args");let s=i.find(o=>o.fi>r.fi);if(s===void 0){let o=i[i.length-1].fi;return mh(o,o+n,n)}else return mh(r.fi,s.fi,n)}}};function Qg(t){return t&&typeof t=="object"&&t instanceof Br}var Br=class{unusedFunOverridesTable(t){}runOp(t){let e=[],n=this,i=0,r={};for(;i<t.path.length;){if(e.push(n),n=n===void 0?void 0:n[t.path[i]],n!==void 0&&!Qg(n))return null;i+=1}n=n?A2(n):new Br;for(let[a,l]of Object.entries(t.props)){let c=n[a];r[a]=c,l===void 0?delete n[a]:n[a]=l}for(;i>0;){if(Object.keys(n).length===0){let a=e[i-1];a&&(n=A2(a),delete n[t.path[i-1]])}else{let a=e[i-1];if(a){let l=A2(a);l[t.path[i-1]]=n,n=l}else{let l=new Br;l[t.path[i-1]]=n,n=l}}i-=1}let s=Object.setPrototypeOf(n,Br.prototype),o={...t,props:r};return{data:s,actual:t,reverse:o}}},bf;(t=>{function e(r,s){return Gx(r,s)??r}t.apply=e;function n(r,s){return vF(r,s)}t.merge=n;function i(r,s){let o=0,a=s.path,l=r;for(;o<a.length&&l!==void 0;){if(l=Ql.zoomOnce(l,a[o]),l===void 0)return s;if(!Qg(l))return;o+=1}if(l===void 0)return s;if(Qg(l))if(s.type===0){let c={...s.props};for(let h of Object.keys(l))delete c[h];return{...s,props:c}}else if(s.type===1||s.type===4||s.type===7){let c=gF([s],l);return c?(console.log(c),c):s}else return s}t.filterOp=i})(bf||(bf={}));function gF(t,e){if(e===void 0)return;let n=!1,i=t.map(r=>{let s=r.id,o=Gx(r.data,e[s]);if(n=n||o!==void 0,o===void 0&&(o=r.data),r.children){let a=gF(r.children,e);return a!==void 0?n=!0:a=r.children,{...r,id:s,data:o,children:a}}else return{...r,id:s,data:o}});if(n)return i}function dLe(t,e){if(e===void 0)return;let n=!1,i=t.map(r=>{let s=r.id,o=Gx(r.data,e[s]);return n=n||o!==void 0,o===void 0&&(o=r.data),{...r,id:s,data:o}});if(n)return Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i}function Gx(t,e){if(!Qg(e))return e;if(t instanceof ks){let n=gF(t,e);return n!==void 0&&Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n}else{if(t instanceof $t)return dLe(t,e);if(Array.isArray(t)){let n=!1,i=t.map((r,s)=>{let o=Gx(r,e[s]);return n=n||o!==void 0,o===void 0&&(o=r),o});return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i):void 0}else{if(t instanceof Br)return vF(t,e);if(t&&typeof t=="object"){let n={},i=!1;for(let[r,s]of Object.entries(t)){let o=Gx(s,e[r]);i=i||o!==void 0,o===void 0&&(o=s),n[r]=o}return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n):void 0}}}}function vF(t,e){if(t===void 0)return e;if(e===void 0)return t;if(!Qg(e))return e;if(!Qg(t))return bf.apply(t,e);let n=new Set;for(let r of Object.keys(t))n.add(r);for(let r of Object.keys(e))n.add(r);let i=new Br;for(let r of n){let s=vF(t===void 0?void 0:t[r],e===void 0?void 0:e[r]);i[r]=s}return i}function fLe(t,e){let n={cur:[],result:[],len:0};return t=Hx(t,e,n)??t,[t,n.result]}function XA(t,e){return t===null?null:(t.cur[t.len]=e,t.len+=1,t)}function YA(t){t&&(t.len-=1)}function pLe(t){if(t===null)return null;t.result.push(t.cur.slice(0,t.len))}function cJ(t,e,n){let i=!1,r=t.map(s=>{let o=s.id,a=e[o];if(a!==void 0&&typeof a=="string"&&(i=!0,o=a,n!==null))throw new Error("not supported");let l=Hx(s.data,e,XA(n,o));YA(n),i=i||l!==void 0,l===void 0&&(l=s.data);let c=cJ(s.children,e,n);return c!==void 0?i=!0:c=s.children,{...s,id:o,data:l,children:c}});if(i)return r}function mLe(t,e,n){let i=!1,r=t.map(s=>{let o=s.id,a=e[o];if(a!==void 0&&typeof a=="string"&&(i=!0,o=a,n!==null))throw new Error("not supported");let l=Hx(s.data,e,XA(n,o));return YA(n),i=i||l!==void 0,l===void 0&&(l=s.data),{...s,id:o,data:l}});if(i)return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r}function Hx(t,e,n){if(t instanceof ks){let i=cJ(t,e,n);return i!==void 0&&Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i}else{if(t instanceof $t)return mLe(t,e,n);if(Array.isArray(t)){let i=!1,r=t.map((s,o)=>{let a=Hx(s,e,XA(n,o));return YA(n),i=i||a!==void 0,a===void 0&&(a=s),a});return i?(Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r):void 0}else if(t&&typeof t=="object"&&!mF(t)){let i={},r=!1;for(let[s,o]of Object.entries(t))if(s!=="name"&&s!=="text"){let a=e[s];if(typeof a=="string"){if(n!==null)throw new Error("not supported");r=!0,s=a}let l=Hx(o,e,XA(n,s));YA(n),r=r||l!==void 0,l===void 0&&(l=o),i[s]=l}else i[s]=o;return r?(Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i):void 0}else if(typeof t=="string"){let i=e[t];if(i!==void 0){if(t.length!==36)throw new Error("for now you should only call this method when the key is a uuid");pLe(n)}return i}else return}}var rI;(t=>{function e(n,i){let r=Ql.zoom(i,n.path);if(typeof r=="object"){let s={};for(let o of Object.keys(n.props))s[o]=r[o];return{...n,props:s}}else return{...n,props:{}}}t.replaceProps=e})(rI||(rI={}));var ho;(t=>{function e(l,c){return{...l,path:l.path.slice(c)}}t.drop=e;function n(l,c){var h;return((h=i(l,c))==null?void 0:h.data)??l}t.applySimple=n;function i(l,c){var d,f;let h=c.path;for(var u=[];;){let p;if(l instanceof Br&&c.type===0&&(p=l.runOp({...c,path:h.slice(u.length)}),p===null&&(p=void 0)),p===void 0&&u.length===h.length&&(l instanceof ks||l instanceof $t||l instanceof ki?p=l.runOp(c):p=WA.runOp(l,c)),p!==void 0)if(p!==null){let m=p.data;for(let y=u.length-1;y>=0;y--){let w=h[y],b=u[y];if(b instanceof ks){if(typeof w=="number")throw new Error("illegal arg");m=b.modifyById(w,m)}else if(b instanceof $t){if(typeof w=="number")throw new Error("illegal arg");m=b.modifyById(w,m)}else if(b instanceof ki){if(typeof w=="number")throw new Error("illegal arg");m=b.modifyById(w,m)}else if(b instanceof Br){let A={...b,[w]:m};m=Object.setPrototypeOf(A,Br.prototype)}else if(typeof b=="object")if(Array.isArray(b)){if(typeof w=="string"&&(w=parseInt(w),isNaN(w)))throw new Error("Invalid path");let A=m;m=[...b],m[w]=A}else m={...b,[w]:m};else return null}return{data:m,actual:{...p.actual,path:h},reverse:{...p.reverse,path:h}}}else return null;let v=h[u.length],g;if(l instanceof ks){if(typeof v=="number")throw new Error("");g=(d=l.get(v))==null?void 0:d.data}else if(l instanceof $t){if(typeof v=="number")throw new Error("");g=(f=l.get(v))==null?void 0:f.data}else l!==null&&(g=l[v]);if(g!==void 0)u.push(l),l=g;else return null}}t.apply=i;function r(l,c){for(let h=0;h<l.length&&h<c.length;h++)if(l[h]!==c[h])return!0;return!1}t.pathDisjoint=r;function s(l,c){if(l.length!==c.length)return!1;for(let h=0;h<l.length;h++)if(l[h]!==c[h])return!1;return!0}t.pathEq=s;function o(l,c){return r(l.path,c.path)}t.commutative=o;function a(l,c){return l.type===0&&c.type===0&&s(l.path,c.path)?Object.keys(l.props).every(h=>c.props[h]!==void 0):!1}t.subsumed=a})(ho||(ho={}));var z5;(t=>{function e(){return[]}t.empty=e;function n(c,h){let u=[];for(let d of c){let[f,...p]=d.path;f===h&&u.push({...d,path:p})}return u}t.removePrefix=n;function i(c,h){return c.map(u=>({...u,path:[h,...u.path]}))}t.addPrefix=i;function r(c,h){return[...c,...h]}t.concat=r;function s(c,h){return[...c.filter(u=>!h.some(d=>ho.subsumed(u,d))),...h]}t.compress=s;function o(c,h){return c.every(u=>h.every(d=>ho.commutative(u,d)))}t.commutative=o;function a(c,h){for(let u of h){let d=l(c,u);d!==null&&(c=d.data)}return c}t.applyAll=a;function l(c,h){var u=c;let d=[],f=[];for(let p of h)try{if(p.type===3){let v=Ql.zoom(u,[...p.path,p.id]),g=ho.apply(u,{...p,type:2});if(g!==null){u=g.data;let[m,y]=fLe(u,{[p.id]:v});u=m;for(let w of y){let b=w[w.length-1];w.splice(w.length-1,1),d.push({type:0,path:w,props:{[b]:v}}),f.push({type:0,path:w,props:{[b]:p.id}})}f.push(g.reverse),d.push(g.actual)}}else{let v=ho.apply(u,p);v!==null&&(d.push(v.actual),u=v.data,f.push(v.reverse))}}catch(v){if(v instanceof oJ)return null;throw v}return{data:u,actual:d,reverse:f.reverse()}}t.apply=l})(z5||(z5={}));var uJ=Symbol(),gLe=Symbol(),RE=Symbol(),G1=class{reportOp(t,e,n=[]){let i=this;if(e===null)return;i._current=e.data;let r=n;for(;!(i instanceof dJ);){let s=i._path,o=i._current;if(s!==""&&r.splice(0,0,s),i=i._parent,i===null)return;i.update(s,o)}i.push(r,t,e.actual,e.reverse)}deleteChildren(t){if(this._children){let e=this._children[t];if(e){let n=e[RE];n&&n(),delete this._children[t]}}}},vLe=class extends G1{constructor(t,e,n){super(),this._parent=t,this._path=e,this._current=n}update(t,e){if(Array.isArray(this._current)){if(typeof t=="string"&&(t=parseInt(t),isNaN(t)))throw new Error("Invalid path");this._current=[...this._current],this._current[t]=e}else this._current={...this._current,[t]:e}}runOp(t){this.reportOp(t,WA.runOp(this._current,t),t.path)}},yLe=class extends G1{constructor(t,e,n){super(),this._parent=t,this._path=e,this._current=n}update(t,e){this._current={...this._current,[t]:e},Object.setPrototypeOf(this._current,ki.prototype)}runOp(t){this.reportOp(t,this._current.runOp(t))}},hJ={get(t,e){if(e===RE)return()=>{t._parent=null};if(e===uJ)return t._current;if(e===gLe)return t;let{_current:n,_children:i}=t;if(e==="push"&&Array.isArray(n))throw new Error("not supported to expand array");let r=i===void 0?void 0:i[e];if(r!==void 0)return r;let s=n[e],o=LE(t,e,s);return o!==s?(i===void 0&&(i={},t._children=i),i[e]=o,o):s},has(t,e){return e in t._current},ownKeys(t){return Reflect.ownKeys(t._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(t){return Object.getPrototypeOf(t._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(t,e){let n=t._current,i=Reflect.getOwnPropertyDescriptor(n,e);return i&&{writable:!0,configurable:!0,enumerable:i.enumerable,value:n[e]}}},xLe={...hJ,set(t,e,n){let i={type:0,props:{[e]:Kr(n)??n}};return t.deleteChildren(e),t.runOp(i),!0},deleteProperty(t,e){let n={type:0,props:{[e]:void 0}};return t.deleteChildren(e),t.runOp(n),!0}},wLe={...hJ,set(t,e,n){return n===void 0?this.deleteProperty(t,e):(t.deleteChildren(e),t.runOp({type:1,id:e,data:n})),!0},deleteProperty(t,e){return t.runOp({type:2,id:e}),!0}},yF=class extends G1{constructor(t,e,n){super(),this._children={},this._parent=t,this._path=e,this._current=n,this[RE]=()=>{this._parent=null}}unproxy(){return this._current}update(t,e){this._current=this._current.modifyById(t,e)}runOp(t){this.reportOp(t,this._current.runOp(t))}randomId(){return this._current.randomId()}isDescendantOf(t,e){return this._current.isDescendantOf(t,e)}childrenOf(t){return this._current.childrenOf(t)}traverse(t){return this._current.traverse(t)}get(t){return this._current.get(t)}parent(t){return this._current.parent(t)}traverse(t){this._current.traverse((e,n)=>{t(e,this.data(e))})}data(t){var o;let{_current:e,_children:n}=this,i=n===void 0?void 0:n[t];if(i!==void 0)return i;let r=(o=e.get(t))==null?void 0:o.data,s=LE(this,t,r);return s!==r?(n===void 0&&(n={},this._children=n),n[t]=s,s):r}add(t,e,n,i,r){this.runOp({type:7,parent:t,fi:e,id:n,data:i,children:r})}move(t,e,n){this.runOp({type:9,parent:t,fi:e,id:n})}insertAfter(t,e,n){let i=this._current.insertAfterHelper(t,e,n.length);for(let r=0;r<n.length;r++){let s=n[r];this.add(t,i[r],s.id,s.data,s.children)}}insertBefore(t,e,n){let i=this._current.insertBeforeHelper(t,e,n.length);for(let r=0;r<n.length;r++){let s=n[r];this.add(t,i[r],s.id,s.data,s.children)}}moveAfter(t,e,n){let i=this._current.insertAfterHelper(t,e,n.length);for(let r=0;r<n.length;r++){let s=n[r];this.move(t,i[r],s)}}moveBefore(t,e,n){let i=this._current.insertBeforeHelper(t,e,n.length);for(let r=0;r<n.length;r++){let s=n[r];this.move(t,i[r],s)}}delete(t){this.deleteChildren(t),this.runOp({type:8,id:t})}sortNext(t){return this._current.sortNext(t)}sortPrevious(t){return this._current.sortPrevious(t)}getAllSorted(t){return this._current.getAllSorted(t)}},xF=class extends G1{constructor(t,e,n){super(),this._children={},this._parent=t,this._path=e,this._current=n,this[RE]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(t){let e=this.length;for(let n=0;n<e;n++){let i=this._current[n].id,r=this._current[n].fi;t(this.data(this._current[n].id),i,r)}}find(t){let e=this.length;for(let n=0;n<e;n++){let i=this._current[n].id;if(t(this.data(i),i))return this.get(i)}}update(t,e){this._current=this._current.modifyById(t,e)}randomId(){return this._current.randomId()}get(t){return{...this._current.get(t),data:this.data(t)}}data(t){var o;let{_current:e,_children:n}=this,i=n===void 0?void 0:n[t];if(i!==void 0)return i;let r=(o=e.get(t))==null?void 0:o.data,s=LE(this,t,r);return s!==r?(n===void 0&&(n={},this._children=n),n[t]=s,s):r}runOp(t){this.reportOp(t,this._current.runOp(t))}add(t,e,n){this.runOp({type:4,fi:t,id:e,data:n})}move(t,e){this.runOp({type:6,fi:t,id:e})}insertAfter(t,e){let n=this._current.insertAfterHelper(t,e.length);for(let i=0;i<e.length;i++){let r=e[i];this.add(n[i],r.id,r.data)}}insertBefore(t,e){let n=this._current.insertBeforeHelper(t,e.length);for(let i=0;i<e.length;i++){let r=e[i];this.add(n[i],r.id,r.data)}}moveAfter(t,e){let n=this._current.insertAfterHelper(t,e.length);for(let i=0;i<e.length;i++){let r=e[i];this.move(n[i],r)}}moveBefore(t,e){let n=this._current.insertBeforeHelper(t,e.length);for(let i=0;i<e.length;i++){let r=e[i];this.move(n[i],r)}}delete(t){this.deleteChildren(t),this.runOp({type:5,id:t})}};function M2(t,e,n){if(t.length>0){let i=t[t.length-1];if(i.type===0&&e.type===0&&Ql.equal(i.path,n)){Object.assign(i.props,e.props);return}}t.push({...e,path:n})}var dJ=class extends G1{constructor(t){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=t}update(t,e){if(t!=="")throw new Error("");this._current=e}push(t,e,n,i){M2(this.ts,e,t),M2(this.actual,n,t),M2(this.reverse,i,t)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function LE(t,e,n){return n instanceof ks?new yF(t,e,n):n instanceof $t?new xF(t,e,n):n instanceof ki?new Proxy(new yLe(t,e,n),wLe):n!==null&&typeof n=="object"?mF(n)?n:new Proxy(new vLe(t,e,n),xLe):n}function fJ(t){let e=new dJ(t);return[LE(e,"",t),e]}function qA(t,e){let[n,i]=fJ(t);return e(n),i.result()}function Kr(t){return t instanceof yF||t instanceof xF?t._current:t!==null&&typeof t=="object"?t[uJ]:t}var Ql;(t=>{function e(s,o){if(o.length===s.length)for(var a=0;a<s.length;){if(s[a]!==o[a])return!1;a+=1}else return!1;return!0}t.equal=e;function n(s,o,a){let l=r(a,s);if(l!==void 0&&typeof l=="object"&&l!==null){let c={...o};return Object.keys(l).forEach(h=>{delete c[h]}),c}else return o}t.removeOverridden=n;function i(s,o){if((s instanceof ks||s instanceof yF)&&typeof o=="string"||(s instanceof $t||s instanceof xF)&&typeof o=="string")return s.data(o);if(typeof o=="number"&&Array.isArray(s)||typeof o=="string"&&typeof s=="object"&&s!==null)return s[o]}t.zoomOnce=i;function r(s,o,a=0){for(;a<o.length&&s!==void 0;)s=i(s,o[a]),a+=1;return s}t.zoom=r})(Ql||(Ql={}));function _Le(t,e){let n=[];if(e.length===t.length)for(var i=0;i<t.length;){if(e[i]==="*")n.push(t[i]);else if(t[i]!==e[i])return null;i+=1}else return null;return n}function oh(t,e){let n=[];if(e.length<=t.length)for(var i=0;i<e.length;){if(e[i]==="*")n.push(t[i]);else if(t[i]!==e[i])return null;i+=1}else return null;return n}var pJ=class{},G5=class extends pJ{constructor(t){super(),this.id=t}},H5=class extends pJ{constructor(t){super(),this.data=t}},sI;try{sI=new TextDecoder}catch{}var ut,Oh,Le=0,Rs={},bn,gh,Ko=0,Nl=0,to,$c,vs=[],Mn,V5={useRecords:!1,mapsAsObjects:!0},mJ=class{},gJ=new mJ;gJ.name="MessagePack 0xC1";var Kg=!1,QA=class{constructor(t){t&&(t.useRecords===!1&&t.mapsAsObjects===void 0&&(t.mapsAsObjects=!0),t.structures?t.structures.sharedLength=t.structures.length:t.getStructures&&((t.structures=[]).uninitialized=!0,t.structures.sharedLength=0)),Object.assign(this,t)}unpack(t,e){if(ut)return bJ(()=>(aI(),this?this.unpack(t,e):QA.prototype.unpack.call(V5,t,e)));Oh=e>-1?e:t.length,Le=0,Nl=0,gh=null,to=null,ut=t;try{Mn=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(n){throw ut=null,t instanceof Uint8Array?n:new Error("Source must be a Uint8Array or Buffer but was a "+(t&&typeof t=="object"?t.constructor.name:typeof t))}if(this instanceof QA){if(Rs=this,this.structures)return bn=this.structures,Db();(!bn||bn.length>0)&&(bn=[])}else Rs=V5,(!bn||bn.length>0)&&(bn=[]);return Db()}unpackMultiple(t,e){let n,i=0;try{Kg=!0;let r=t.length,s=this?this.unpack(t,r):BE.unpack(t,r);if(e){for(e(s);Le<r;)if(i=Le,e(Db())===!1)return}else{for(n=[s];Le<r;)i=Le,n.push(Db());return n}}catch(r){throw r.lastPosition=i,r.values=n,r}finally{Kg=!1,aI()}}_mergeStructures(t,e){t=t||[];for(let n=0,i=t.length;n<i;n++){let r=t[n];r&&(r.isShared=!0,n>=32&&(r.highByte=n-32>>5))}t.sharedLength=t.length;for(let n in e||[])if(n>=0){let i=t[n],r=e[n];r&&(i&&((t.restoreStructures||(t.restoreStructures=[]))[n]=i),t[n]=r)}return this.structures=t}decode(t,e){return this.unpack(t,e)}};function Db(){try{if(!Rs.trusted&&!Kg){let e=bn.sharedLength||0;e<bn.length&&(bn.length=e)}let t=wi();if(Le==Oh)bn.restoreStructures&&j5(),bn=null,ut=null,$c&&($c=null);else if(Le>Oh){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}else if(!Kg)throw new Error("Data read, but end of buffer not reached");return t}catch(t){throw bn.restoreStructures&&j5(),aI(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function j5(){for(let t in bn.restoreStructures)bn[t]=bn.restoreStructures[t];bn.restoreStructures=null}function wi(){let t=ut[Le++];if(t<160)if(t<128){if(t<64)return t;{let e=bn[t&63]||Rs.getStructures&&vJ()[t&63];return e?(e.read||(e.read=wF(e,t&63)),e.read()):t}}else if(t<144)if(t-=128,Rs.mapsAsObjects){let e={};for(let n=0;n<t;n++)e[xJ()]=wi();return e}else{let e=new Map;for(let n=0;n<t;n++)e.set(wi(),wi());return e}else{t-=144;let e=new Array(t);for(let n=0;n<t;n++)e[n]=wi();return e}else if(t<192){let e=t-160;if(Nl>=Le)return gh.slice(Le-Ko,(Le+=e)-Ko);if(Nl==0&&Oh<140){let n=e<16?_F(e):yJ(e);if(n!=null)return n}return oI(e)}else{let e;switch(t){case 192:return null;case 193:return to?(e=wi(),e>0?to[1].slice(to.position1,to.position1+=e):to[0].slice(to.position0,to.position0-=e)):gJ;case 194:return!1;case 195:return!0;case 196:return E2(ut[Le++]);case 197:return e=Mn.getUint16(Le),Le+=2,E2(e);case 198:return e=Mn.getUint32(Le),Le+=4,E2(e);case 199:return Dd(ut[Le++]);case 200:return e=Mn.getUint16(Le),Le+=2,Dd(e);case 201:return e=Mn.getUint32(Le),Le+=4,Dd(e);case 202:if(e=Mn.getFloat32(Le),Rs.useFloat32>2){let n=bF[(ut[Le]&127)<<1|ut[Le+1]>>7];return Le+=4,(n*e+(e>0?.5:-.5)>>0)/n}return Le+=4,e;case 203:return e=Mn.getFloat64(Le),Le+=8,e;case 204:return ut[Le++];case 205:return e=Mn.getUint16(Le),Le+=2,e;case 206:return e=Mn.getUint32(Le),Le+=4,e;case 207:return Rs.int64AsNumber?(e=Mn.getUint32(Le)*4294967296,e+=Mn.getUint32(Le+4)):e=Mn.getBigUint64(Le),Le+=8,e;case 208:return Mn.getInt8(Le++);case 209:return e=Mn.getInt16(Le),Le+=2,e;case 210:return e=Mn.getInt32(Le),Le+=4,e;case 211:return Rs.int64AsNumber?(e=Mn.getInt32(Le)*4294967296,e+=Mn.getUint32(Le+4)):e=Mn.getBigInt64(Le),Le+=8,e;case 212:if(e=ut[Le++],e==114)return Q5(ut[Le++]&63);{let n=vs[e];if(n)return n.read?(Le++,n.read(wi())):n.noBuffer?(Le++,n()):n(ut.subarray(Le,++Le));throw new Error("Unknown extension "+e)}case 213:return e=ut[Le],e==114?(Le++,Q5(ut[Le++]&63,ut[Le++])):Dd(2);case 214:return Dd(4);case 215:return Dd(8);case 216:return Dd(16);case 217:return e=ut[Le++],Nl>=Le?gh.slice(Le-Ko,(Le+=e)-Ko):SLe(e);case 218:return e=Mn.getUint16(Le),Le+=2,Nl>=Le?gh.slice(Le-Ko,(Le+=e)-Ko):ALe(e);case 219:return e=Mn.getUint32(Le),Le+=4,Nl>=Le?gh.slice(Le-Ko,(Le+=e)-Ko):MLe(e);case 220:return e=Mn.getUint16(Le),Le+=2,X5(e);case 221:return e=Mn.getUint32(Le),Le+=4,X5(e);case 222:return e=Mn.getUint16(Le),Le+=2,Y5(e);case 223:return e=Mn.getUint32(Le),Le+=4,Y5(e);default:if(t>=224)return t-256;if(t===void 0){let n=new Error("Unexpected end of MessagePack data");throw n.incomplete=!0,n}throw new Error("Unknown MessagePack token "+t)}}}var bLe=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function wF(t,e){function n(){if(n.count++>2){let r=t.read=new Function("r","return function(){return {"+t.map(s=>bLe.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"}}")(wi);return t.highByte===0&&(t.read=W5(e,t.read)),r()}let i={};for(let r=0,s=t.length;r<s;r++){let o=t[r];i[o]=wi()}return i}return n.count=0,t.highByte===0?W5(e,n):n}var W5=(t,e)=>function(){let n=ut[Le++];if(n===0)return e();let i=t<32?-(t+(n<<5)):t+(n<<5),r=bn[i]||vJ()[i];if(!r)throw new Error("Record id is not defined for "+i);return r.read||(r.read=wF(r,t)),r.read()};function vJ(){let t=bJ(()=>(ut=null,Rs.getStructures()));return bn=Rs._mergeStructures(t,bn)}var oI=IE,SLe=IE,ALe=IE,MLe=IE;function IE(t){let e;if(t<16&&(e=_F(t)))return e;if(t>64&&sI)return sI.decode(ut.subarray(Le,Le+=t));let n=Le+t,i=[];for(e="";Le<n;){let r=ut[Le++];if(!(r&128))i.push(r);else if((r&224)===192){let s=ut[Le++]&63;i.push((r&31)<<6|s)}else if((r&240)===224){let s=ut[Le++]&63,o=ut[Le++]&63;i.push((r&31)<<12|s<<6|o)}else if((r&248)===240){let s=ut[Le++]&63,o=ut[Le++]&63,a=ut[Le++]&63,l=(r&7)<<18|s<<12|o<<6|a;l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|l&1023),i.push(l)}else i.push(r);i.length>=4096&&(e+=pr.apply(String,i),i.length=0)}return i.length>0&&(e+=pr.apply(String,i)),e}function X5(t){let e=new Array(t);for(let n=0;n<t;n++)e[n]=wi();return e}function Y5(t){if(Rs.mapsAsObjects){let e={};for(let n=0;n<t;n++)e[xJ()]=wi();return e}else{let e=new Map;for(let n=0;n<t;n++)e.set(wi(),wi());return e}}var pr=String.fromCharCode;function yJ(t){let e=Le,n=new Array(t);for(let i=0;i<t;i++){let r=ut[Le++];if((r&128)>0){Le=e;return}n[i]=r}return pr.apply(String,n)}function _F(t){if(t<4)if(t<2){if(t===0)return"";{let e=ut[Le++];if((e&128)>1){Le-=1;return}return pr(e)}}else{let e=ut[Le++],n=ut[Le++];if((e&128)>0||(n&128)>0){Le-=2;return}if(t<3)return pr(e,n);let i=ut[Le++];if((i&128)>0){Le-=3;return}return pr(e,n,i)}else{let e=ut[Le++],n=ut[Le++],i=ut[Le++],r=ut[Le++];if((e&128)>0||(n&128)>0||(i&128)>0||(r&128)>0){Le-=4;return}if(t<6){if(t===4)return pr(e,n,i,r);{let s=ut[Le++];if((s&128)>0){Le-=5;return}return pr(e,n,i,r,s)}}else if(t<8){let s=ut[Le++],o=ut[Le++];if((s&128)>0||(o&128)>0){Le-=6;return}if(t<7)return pr(e,n,i,r,s,o);let a=ut[Le++];if((a&128)>0){Le-=7;return}return pr(e,n,i,r,s,o,a)}else{let s=ut[Le++],o=ut[Le++],a=ut[Le++],l=ut[Le++];if((s&128)>0||(o&128)>0||(a&128)>0||(l&128)>0){Le-=8;return}if(t<10){if(t===8)return pr(e,n,i,r,s,o,a,l);{let c=ut[Le++];if((c&128)>0){Le-=9;return}return pr(e,n,i,r,s,o,a,l,c)}}else if(t<12){let c=ut[Le++],h=ut[Le++];if((c&128)>0||(h&128)>0){Le-=10;return}if(t<11)return pr(e,n,i,r,s,o,a,l,c,h);let u=ut[Le++];if((u&128)>0){Le-=11;return}return pr(e,n,i,r,s,o,a,l,c,h,u)}else{let c=ut[Le++],h=ut[Le++],u=ut[Le++],d=ut[Le++];if((c&128)>0||(h&128)>0||(u&128)>0||(d&128)>0){Le-=12;return}if(t<14){if(t===12)return pr(e,n,i,r,s,o,a,l,c,h,u,d);{let f=ut[Le++];if((f&128)>0){Le-=13;return}return pr(e,n,i,r,s,o,a,l,c,h,u,d,f)}}else{let f=ut[Le++],p=ut[Le++];if((f&128)>0||(p&128)>0){Le-=14;return}if(t<15)return pr(e,n,i,r,s,o,a,l,c,h,u,d,f,p);let v=ut[Le++];if((v&128)>0){Le-=15;return}return pr(e,n,i,r,s,o,a,l,c,h,u,d,f,p,v)}}}}}function E2(t){return Rs.copyBuffers?Uint8Array.prototype.slice.call(ut,Le,Le+=t):ut.subarray(Le,Le+=t)}function Dd(t){let e=ut[Le++];if(vs[e])return vs[e](ut.subarray(Le,Le+=t));throw new Error("Unknown extension type "+e)}var q5=new Array(4096);function xJ(){let t=ut[Le++];if(t>=160&&t<192){if(t=t-160,Nl>=Le)return gh.slice(Le-Ko,(Le+=t)-Ko);if(!(Nl==0&&Oh<180))return oI(t)}else return Le--,wi();let e=(t<<5^(t>1?Mn.getUint16(Le):t>0?ut[Le]:0))&4095,n=q5[e],i=Le,r=Le+t-3,s,o=0;if(n&&n.bytes==t){for(;i<r;){if(s=Mn.getUint32(i),s!=n[o++]){i=1879048192;break}i+=4}for(r+=3;i<r;)if(s=ut[i++],s!=n[o++]){i=1879048192;break}if(i===r)return Le=i,n.string;r-=3,i=Le}for(n=[],q5[e]=n,n.bytes=t;i<r;)s=Mn.getUint32(i),n.push(s),i+=4;for(r+=3;i<r;)s=ut[i++],n.push(s);let a=t<16?_F(t):yJ(t);return a!=null?n.string=a:n.string=oI(t)}var Q5=(t,e)=>{var n=wi();let i=t;e!==void 0&&(t=t<32?-((e<<5)+t):(e<<5)+t,n.highByte=e);let r=bn[t];return r&&r.isShared&&((bn.restoreStructures||(bn.restoreStructures=[]))[t]=r),bn[t]=n,n.read=wF(n,i),n.read()},wJ=typeof self=="object"?self:global;vs[0]=()=>{};vs[0].noBuffer=!0;vs[101]=()=>{let t=wi();return(wJ[t[0]]||Error)(t[1])};vs[105]=t=>{let e=Mn.getUint32(Le-4);$c||($c=new Map);let n=ut[Le],i;n>=144&&n<160||n==220||n==221?i=[]:i={};let r={target:i};$c.set(e,r);let s=wi();return r.used?Object.assign(i,s):(r.target=s,s)};vs[112]=t=>{let e=Mn.getUint32(Le-4),n=$c.get(e);return n.used=!0,n.target};vs[115]=()=>new Set(wi());var _J=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(t=>t+"Array");vs[116]=t=>{let e=t[0],n=_J[e];if(!n)throw new Error("Could not find typed array for code "+e);return new wJ[n](Uint8Array.prototype.slice.call(t,1).buffer)};vs[120]=()=>{let t=wi();return new RegExp(t[0],t[1])};vs[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],n=Le;Le+=e-4,to=[wi(),wi()],to.position0=0,to.position1=0;let i=Le;Le=n;try{return wi()}finally{Le=i}};vs[255]=t=>t.length==4?new Date((t[0]*16777216+(t[1]<<16)+(t[2]<<8)+t[3])*1e3):t.length==8?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+((t[3]&3)*4294967296+t[4]*16777216+(t[5]<<16)+(t[6]<<8)+t[7])*1e3):t.length==12?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+((t[4]&128?-281474976710656:0)+t[6]*1099511627776+t[7]*4294967296+t[8]*16777216+(t[9]<<16)+(t[10]<<8)+t[11])*1e3):new Date("invalid");function bJ(t){let e=Oh,n=Le,i=Ko,r=Nl,s=gh,o=$c,a=to,l=new Uint8Array(ut.slice(0,Oh)),c=bn,h=bn.slice(0,bn.length),u=Rs,d=Kg,f=t();return Oh=e,Le=n,Ko=i,Nl=r,gh=s,$c=o,to=a,ut=l,Kg=d,bn=c,bn.splice(0,bn.length,...h),Rs=u,Mn=new DataView(ut.buffer,ut.byteOffset,ut.byteLength),f}function aI(){ut=null,$c=null,bn=null}function ELe(t){t.unpack?vs[t.type]=t.unpack:vs[t.type]=t}var bF=new Array(147);for(let t=0;t<256;t++)bF[t]=+("1e"+Math.floor(45.15-t*.30103));var BE=new QA({useRecords:!1});BE.unpack;BE.unpackMultiple;BE.unpack;var CLe=new Float32Array(1);new Uint8Array(CLe.buffer,0,4);var FS;try{FS=new TextEncoder}catch{}var KA,SF,OE=typeof Buffer<"u",C2=OE?Buffer.allocUnsafeSlow:Uint8Array,SJ=OE?Buffer:Uint8Array,K5=OE?4294967296:2144337920,Xe,Ci,ke=0,yl,xl=null,TLe=/[\u0080-\uFFFF]/,L0=Symbol("record-id"),AJ=class extends QA{constructor(t){super(t),this.offset=0;let e,n,i,r,s,o=0,a=SJ.prototype.utf8Write?function(S,T,M){return Xe.utf8Write(S,T,M)}:FS&&FS.encodeInto?function(S,T){return FS.encodeInto(S,Xe.subarray(T)).written}:!1,l=this;t||(t={});let c=t&&t.sequential,h=t.structures||t.saveStructures,u=t.maxSharedStructures;if(u==null&&(u=h?32:0),u>8160)throw new Error("Maximum maxSharedStructure is 8160");let d=t.maxOwnStructures;d==null&&(d=h?32:64),c&&!t.saveStructures&&(this.structures=[]);let f=u>32||d+u>64,p=u+64,v=u+d+64;if(v>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let g=[],m=0,y=0;this.pack=this.encode=function(S,T){if(Xe||(Xe=new C2(8192),Ci=new DataView(Xe.buffer,0,8192),ke=0),yl=Xe.length-10,yl-ke<2048?(Xe=new C2(Xe.length),Ci=new DataView(Xe.buffer,0,Xe.length),yl=Xe.length-10,ke=0):ke=ke+7&2147483640,e=ke,s=l.structuredClone?new Map:null,l.bundleStrings?(xl=["",""],Xe[ke++]=214,Xe[ke++]=98,xl.position=ke-e,ke+=4):xl=null,n=l.structures,n){n.uninitialized&&(n=l._mergeStructures(l.getStructures()));let M=n.sharedLength||0;if(M>u)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+n.sharedLength);if(!n.transitions){n.transitions=Object.create(null);for(let E=0;E<M;E++){let P=n[E];if(!P)continue;let R,F=n.transitions;for(let B=0,k=P.length;B<k;B++){let j=P[B];R=F[j],R||(R=F[j]=Object.create(null)),F=R}F[L0]=E+64}o=M}c||(n.nextId=M+64)}i&&(i=!1),r=n||[];try{if(w(S),xl){Ci.setUint32(xl.position+e,ke-xl.position-e);let M=xl;xl=null,w(M[0]),w(M[1])}if(l.offset=ke,s&&s.idsToInsert){ke+=s.idsToInsert.length*6,ke>yl&&A(ke),l.offset=ke;let M=DLe(Xe.subarray(e,ke),s.idsToInsert);return s=null,M}return T&RLe?(Xe.start=e,Xe.end=ke,Xe):Xe.subarray(e,ke)}finally{if(n){if(y<10&&y++,m>1e4)n.transitions=null,y=0,m=0,g.length>0&&(g=[]);else if(g.length>0&&!c){for(let M=0,E=g.length;M<E;M++)g[M][L0]=0;g=[]}if(i&&l.saveStructures){let M=n.sharedLength||u;n.length>M&&(n=n.slice(0,M));let E=Xe.subarray(e,ke);return l.saveStructures(n,o)===!1?(l._mergeStructures(l.getStructures()),l.pack(S)):(o=M,E)}}T&LLe&&(ke=e)}};let w=S=>{ke>yl&&(Xe=A(ke));var T=typeof S,M;if(T==="string"){let E=S.length;if(xl&&E>=8&&E<4096){let F=TLe.test(S);xl[F?0:1]+=S,Xe[ke++]=193,w(F?-E:E);return}let P;E<32?P=1:E<256?P=2:E<65536?P=3:P=5;let R=E*3;if(ke+R>yl&&(Xe=A(ke+R)),E<64||!a){let F,B,k,j=ke+P;for(F=0;F<E;F++)B=S.charCodeAt(F),B<128?Xe[j++]=B:B<2048?(Xe[j++]=B>>6|192,Xe[j++]=B&63|128):(B&64512)===55296&&((k=S.charCodeAt(F+1))&64512)===56320?(B=65536+((B&1023)<<10)+(k&1023),F++,Xe[j++]=B>>18|240,Xe[j++]=B>>12&63|128,Xe[j++]=B>>6&63|128,Xe[j++]=B&63|128):(Xe[j++]=B>>12|224,Xe[j++]=B>>6&63|128,Xe[j++]=B&63|128);M=j-ke-P}else M=a(S,ke+P,R);M<32?Xe[ke++]=160|M:M<256?(P<2&&Xe.copyWithin(ke+2,ke+1,ke+1+M),Xe[ke++]=217,Xe[ke++]=M):M<65536?(P<3&&Xe.copyWithin(ke+3,ke+2,ke+2+M),Xe[ke++]=218,Xe[ke++]=M>>8,Xe[ke++]=M&255):(P<5&&Xe.copyWithin(ke+5,ke+3,ke+3+M),Xe[ke++]=219,Ci.setUint32(ke,M),ke+=4),ke+=M}else if(T==="number")if(S>>>0===S)S<64?Xe[ke++]=S:S<256?(Xe[ke++]=204,Xe[ke++]=S):S<65536?(Xe[ke++]=205,Xe[ke++]=S>>8,Xe[ke++]=S&255):(Xe[ke++]=206,Ci.setUint32(ke,S),ke+=4);else if(S>>0===S)S>=-32?Xe[ke++]=256+S:S>=-128?(Xe[ke++]=208,Xe[ke++]=S+256):S>=-32768?(Xe[ke++]=209,Ci.setInt16(ke,S),ke+=2):(Xe[ke++]=210,Ci.setInt32(ke,S),ke+=4);else{let E;if((E=this.useFloat32)>0&&S<4294967296&&S>=-2147483648){Xe[ke++]=202,Ci.setFloat32(ke,S);let P;if(E<4||(P=S*bF[(Xe[ke]&127)<<1|Xe[ke+1]>>7])>>0===P){ke+=4;return}else ke--}Xe[ke++]=203,Ci.setFloat64(ke,S),ke+=8}else if(T==="object")if(!S)Xe[ke++]=192;else{if(s){let P=s.get(S);if(P){if(!P.id){let R=s.idsToInsert||(s.idsToInsert=[]);P.id=R.push(P)}Xe[ke++]=214,Xe[ke++]=112,Ci.setUint32(ke,P.id),ke+=4;return}else s.set(S,{offset:ke-e})}let E=S.constructor;if(E===Object)b(S,!0);else if(E===Array){M=S.length,M<16?Xe[ke++]=144|M:M<65536?(Xe[ke++]=220,Xe[ke++]=M>>8,Xe[ke++]=M&255):(Xe[ke++]=221,Ci.setUint32(ke,M),ke+=4);for(let P=0;P<M;P++)w(S[P])}else if(E===Map){M=S.size,M<16?Xe[ke++]=128|M:M<65536?(Xe[ke++]=222,Xe[ke++]=M>>8,Xe[ke++]=M&255):(Xe[ke++]=223,Ci.setUint32(ke,M),ke+=4);for(let[P,R]of S)w(P),w(R)}else{for(let P=0,R=KA.length;P<R;P++){let F=SF[P];if(S instanceof F){let B=KA[P];if(B.write){B.type&&(Xe[ke++]=212,Xe[ke++]=B.type,Xe[ke++]=0),w(B.write.call(this,S));return}let k=Xe,j=Ci,Z=ke;Xe=null;let ee;try{ee=B.pack.call(this,S,O=>(Xe=k,k=null,ke+=O,ke>yl&&A(ke),{target:Xe,targetView:Ci,position:ke-O}),w)}finally{k&&(Xe=k,Ci=j,ke=Z,yl=Xe.length-10)}ee&&(ee.length+ke>yl&&A(ee.length+ke),ke=PLe(ee,Xe,ke,B.type));return}}b(S,!S.hasOwnProperty)}}else if(T==="boolean")Xe[ke++]=S?195:194;else if(T==="bigint"){if(S<BigInt(1)<<BigInt(63)&&S>=-(BigInt(1)<<BigInt(63)))Xe[ke++]=211,Ci.setBigInt64(ke,S);else if(S<BigInt(1)<<BigInt(64)&&S>0)Xe[ke++]=207,Ci.setBigUint64(ke,S);else if(this.largeBigIntToFloat)Xe[ke++]=203,Ci.setFloat64(ke,Number(S));else throw new RangeError(S+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");ke+=8}else if(T==="undefined")this.encodeUndefinedAsNil?Xe[ke++]=192:(Xe[ke++]=212,Xe[ke++]=0,Xe[ke++]=0);else if(T==="function")w(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+T)},b=this.useRecords===!1?this.variableMapSize?S=>{let T=Object.keys(S),M=T.length;M<16?Xe[ke++]=128|M:M<65536?(Xe[ke++]=222,Xe[ke++]=M>>8,Xe[ke++]=M&255):(Xe[ke++]=223,Ci.setUint32(ke,M),ke+=4);let E;for(let P=0;P<M;P++)w(E=T[P]),w(S[E])}:(S,T)=>{Xe[ke++]=222;let M=ke-e;ke+=2;let E=0;for(let P in S)(T||S.hasOwnProperty(P))&&(w(P),w(S[P]),E++);Xe[M+++e]=E>>8,Xe[M+e]=E&255}:S=>{let T=Object.keys(S),M,E=r.transitions||(r.transitions=Object.create(null)),P=0;for(let F=0,B=T.length;F<B;F++){let k=T[F];M=E[k],M||(M=E[k]=Object.create(null),P++),E=M}let R=E[L0];if(R)R>=96&&f?(Xe[ke++]=((R-=96)&31)+96,Xe[ke++]=R>>5):Xe[ke++]=R;else{R=r.nextId,R||(R=64),R<p&&this.shouldShareStructure&&!this.shouldShareStructure(T)?(R=r.nextOwnId,R<v||(R=p),r.nextOwnId=R+1):(R>=v&&(R=p),r.nextId=R+1);let F=T.highByte=R>=96&&f?R-96>>5:-1;E[L0]=R,r[R-64]=T,R<p?(T.isShared=!0,r.sharedLength=R-63,i=!0,F>=0?(Xe[ke++]=(R&31)+96,Xe[ke++]=F):Xe[ke++]=R):(F>=0?(Xe[ke++]=213,Xe[ke++]=114,Xe[ke++]=(R&31)+96,Xe[ke++]=F):(Xe[ke++]=212,Xe[ke++]=114,Xe[ke++]=R),P&&(m+=y*P),g.length>=d&&(g.shift()[L0]=0),g.push(E),w(T))}for(let F=0,B=T.length;F<B;F++)w(S[T[F]])},A=S=>{let T;if(S>16777216){if(S-e>K5)throw new Error("Packed buffer would be larger than maximum buffer size");T=Math.min(K5,Math.round(Math.max((S-e)*(S>67108864?1.25:2),4194304)/4096)*4096)}else T=(Math.max(S-e<<2,Xe.length-1)>>12)+1<<12;let M=new C2(T);return Ci=new DataView(M.buffer,0,T),Xe.copy?Xe.copy(M,0,e,S):M.set(Xe.slice(e,S)),ke-=e,e=0,yl=M.length-10,Xe=M}}useBuffer(t){Xe=t,Ci=new DataView(Xe.buffer,Xe.byteOffset,Xe.byteLength),ke=0}};SF=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,mJ];KA=[{pack(t,e,n){let i=t.getTime()/1e3;if((this.useTimestamp32||t.getMilliseconds()===0)&&i>=0&&i<4294967296){let{target:r,targetView:s,position:o}=e(6);r[o++]=214,r[o++]=255,s.setUint32(o,i)}else if(i>0&&i<17179869184){let{target:r,targetView:s,position:o}=e(10);r[o++]=215,r[o++]=255,s.setUint32(o,t.getMilliseconds()*4e6+(i/1e3/4294967296>>0)),s.setUint32(o+4,i)}else if(isNaN(i)){if(this.onInvalidDate)return e(0),n(this.onInvalidDate());let{target:r,targetView:s,position:o}=e(3);r[o++]=212,r[o++]=255,r[o++]=255}else{let{target:r,targetView:s,position:o}=e(15);r[o++]=199,r[o++]=12,r[o++]=255,s.setUint32(o,t.getMilliseconds()*1e6),s.setBigInt64(o+4,BigInt(Math.floor(i)))}}},{pack(t,e,n){let i=Array.from(t),{target:r,position:s}=e(this.structuredClone?3:0);this.structuredClone&&(r[s++]=212,r[s++]=115,r[s++]=0),n(i)}},{pack(t,e,n){let{target:i,position:r}=e(this.structuredClone?3:0);this.structuredClone&&(i[r++]=212,i[r++]=101,i[r++]=0),n([t.name,t.message])}},{pack(t,e,n){let{target:i,position:r}=e(this.structuredClone?3:0);this.structuredClone&&(i[r++]=212,i[r++]=120,i[r++]=0),n([t.source,t.flags])}},{pack(t,e){this.structuredClone?J5(t,16,e):Z5(OE?Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let n=t.constructor;n!==SJ&&this.structuredClone?J5(t,_J.indexOf(n.name),e):Z5(t,e)}},{pack(t,e){let{target:n,position:i}=e(1);n[i]=193}}];function J5(t,e,n,i){let r=t.byteLength;if(r+1<256){var{target:s,position:o}=n(4+r);s[o++]=199,s[o++]=r+1}else if(r+1<65536){var{target:s,position:o}=n(5+r);s[o++]=200,s[o++]=r+1>>8,s[o++]=r+1&255}else{var{target:s,position:o,targetView:a}=n(7+r);s[o++]=201,a.setUint32(o,r+1),o+=4}s[o++]=116,s[o++]=e,s.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),o)}function Z5(t,e){let n=t.byteLength;var i,r;if(n<256){var{target:i,position:r}=e(n+2);i[r++]=196,i[r++]=n}else if(n<65536){var{target:i,position:r}=e(n+3);i[r++]=197,i[r++]=n>>8,i[r++]=n&255}else{var{target:i,position:r,targetView:s}=e(n+5);i[r++]=198,s.setUint32(r,n),r+=4}i.set(t,r)}function PLe(t,e,n,i){let r=t.length;switch(r){case 1:e[n++]=212;break;case 2:e[n++]=213;break;case 4:e[n++]=214;break;case 8:e[n++]=215;break;case 16:e[n++]=216;break;default:r<256?(e[n++]=199,e[n++]=r):r<65536?(e[n++]=200,e[n++]=r>>8,e[n++]=r&255):(e[n++]=201,e[n++]=r>>24,e[n++]=r>>16&255,e[n++]=r>>8&255,e[n++]=r&255)}return e[n++]=i,e.set(t,n),n+=r,n}function DLe(t,e){let n,i=e.length*6,r=t.length-i;for(e.sort((s,o)=>s.offset>o.offset?1:-1);n=e.pop();){let s=n.offset,o=n.id;t.copyWithin(s+i,s,r),i-=6;let a=s+i;t[a++]=214,t[a++]=105,t[a++]=o>>24,t[a++]=o>>16&255,t[a++]=o>>8&255,t[a++]=o&255,r=s}return t}function Cv(t){if(t.Class){if(!t.pack&&!t.write)throw new Error("Extension has no pack or write function");if(t.pack&&!t.type)throw new Error("Extension has no type (numeric code to identify the extension)");SF.unshift(t.Class),KA.unshift(t)}ELe(t)}var MJ=new AJ({useRecords:!1});MJ.pack;MJ.pack;var RLe=512,LLe=1024,$5=new AJ({structuredClone:!0});Cv({Class:ki.prototype.constructor,type:1,write(t){return{...t}},read(t){return Object.setPrototypeOf(t,ki.prototype),t}});Cv({Class:$t.prototype.constructor,type:2,write(t){return[...t]},read(t){return Object.setPrototypeOf(t,$t.prototype),t}});Cv({Class:ks.prototype.constructor,type:3,write(t){return[...t]},read(t){return Object.setPrototypeOf(t,ks.prototype),t}});Cv({Class:G5.prototype.constructor,type:4,write(t){return t.id},read(t){return new G5(t)}});Cv({Class:H5.prototype.constructor,type:5,write(t){return t.data},read(t){return new H5(t)}});Cv({Class:Br.prototype.constructor,type:6,write(t){return{...t}},read(t){return Object.setPrototypeOf(t,Br.prototype),t}});function ILe(t){var e=0;if(t.length===0)return e;for(let n=0;n<t.length;n++){let i=t[n];e=(e<<5)-e+i,e=e&e}return e}function lI(t){if(mF(t))return t;if(Array.isArray(t))return t.map(lI);if(typeof t=="object"&&t!==null){let e={};for(let n of Object.keys(t).sort())e[n]=lI(t[n]);return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}else return t}var cI;(t=>{function e(r){return $5.pack(r)}t.serialize=e;function n(r){return $5.unpack(r)}t.deserialize=n;function i(r){return ILe(e(lI(r))).toString()}t.checksum=i})(cI||(cI={}));var zu={LookAt:[],Follow:["Create"],DragDrop:["Transition","Audio","Create"],MouseHover:["Transition","Create","Destroy","SwitchCamera"],Scroll:["Transition","Create"],Start:["Transition","Audio","Video","Create","Destroy","SwitchCamera"],Conditional:["Transition","Audio","Video","Create","Destroy","SwitchCamera","Reset"],MouseDown:["Transition","SwitchCamera","Audio","Video","Link","Create","Destroy","Reset"],MouseUp:["Transition","SwitchCamera","Audio","Video","Link","Create","Destroy","Reset"],MousePress:["Transition","SwitchCamera","Audio","Video","Link","Create","Reset"],KeyDown:["Transition","SwitchCamera","Audio","Video","Link","Create","Destroy","Reset"],KeyUp:["Transition","SwitchCamera","Audio","Video","Link","Create","Destroy","Reset"],KeyPress:["Transition","SwitchCamera","Audio","Video","Link","Create","Reset"],GameControl:["Transition","Audio","Video","Create"],Collision:["Transition","Audio","Video","Create","Destroy","Reset"]},ej;(t=>{function e(i){return i.type==="MouseDown"||i.type==="MouseUp"||i.type==="MousePress"||i.type==="KeyDown"||i.type==="KeyUp"||i.type==="KeyPress"}t.is=e;function n(i){return i==="MouseDown"||i==="MouseUp"||i==="MousePress"?{type:i,mode:"Object",disabled:!1,toggle:!1,actions:new $t}:{type:i,disabled:!1,key:void 0,toggle:!1,actions:new $t}}t.defaultData=n})(ej||(ej={}));var JA;(t=>{function e(n){return{type:"Property",value:[n??null,"position","x"]}}t.propertyDefaultData=e,t.valueDefaultData={type:"Literal",value:0}})(JA||(JA={}));var uI;(t=>{function e(r){return{type:"Comparison",operator:"==",lOperand:JA.propertyDefaultData(r),rOperand:{...JA.valueDefaultData}}}t.comparisonDefaultData=e;function n(r){return{type:"Distance",toObject:r??null,fromObject:r??null,distance:200}}t.distanceDefaultData=n;function i(r,s){return{type:"State",object:r??null,state:s??null}}t.stateDefaultData=i})(uI||(uI={}));var tj;(t=>{function e(i){return i.type==="Conditional"}t.is=e;function n(i){return{type:"Conditional",disabled:!1,inActions:new $t,outActions:new $t,condition:uI.distanceDefaultData(i)}}t.defaultData=n})(tj||(tj={}));var nj;(t=>t.defaultData={type:"DragDrop",cursor:"hand",render:"normal",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new $t,drop:new $t}})(nj||(nj={}));var hI;(t=>t.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new $t})(hI||(hI={}));var dI;(t=>t.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5})(dI||(dI={}));var ij;(t=>{function e(i){return i.type==="MouseHover"}t.is=e;function n(){return{type:"MouseHover",disabled:!1,actions:new $t}}t.defaultData=n})(ij||(ij={}));var rj;(t=>{function e(i){return i.type==="Scroll"}t.is=e;function n(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new $t}}t.defaultData=n})(rj||(rj={}));var sj;(t=>{function e(i){return i.type==="Start"}t.is=e;function n(){return{type:"Start",disabled:!1,actions:new $t}}t.defaultData=n})(sj||(sj={}));var oj;(t=>{function e(i){return i.type==="Collision"}t.is=e;function n(){return{type:"Collision",disabled:!1,toggle:!1,target:"character",actions:new $t}}t.defaultData=n})(oj||(oj={}));var qm;(t=>{function e(i,r){return i[0]===r[0]&&i[1]===r[1]}t.isEqual=e;function n(i,r,s){return[i[0]+(r[0]-i[0])*s,i[1]+(r[1]-i[1])*s]}t.lerp=n})(qm||(qm={}));var Sf;(t=>{function e(l,c){return l[0]===c[0]&&l[1]===c[1]&&l[2]===c[2]}t.isEqual=e;function n(l,c){return[l[0]+c[0],l[1]+c[1],l[2]+c[2]]}t.add=n;function i(l,c){return[l[0]-c[0],l[1]-c[1],l[2]-c[2]]}t.sub=i;function r(l,c){return[l[0]/c[0],l[1]/c[1],l[2]/c[2]]}t.div=r;function s(l,c){return[l[0]*c[0],l[1]*c[1],l[2]*c[2]]}t.mul=s;function o(l,c){return Math.hypot(l[0]-c[0],l[1]-c[1],l[2]-c[2])}t.dist=o;function a(l,c,h){return[l[0]+(c[0]-l[0])*h,l[1]+(c[1]-l[1])*h,l[2]+(c[2]-l[2])*h]}t.lerp=a})(Sf||(Sf={}));var ZA;(t=>{function e(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]}t.isEqual=e;function n(i,r,s){return[i[0]+(r[0]-i[0])*s,i[1]+(r[1]-i[1])*s,i[2]+(r[2]-i[2])*s,i[3]+(r[3]-i[3])*s]}t.lerp=n})(ZA||(ZA={}));var Jg;(t=>{t.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function e(r,s){for(let o=0;o<16;o++)if(r[o]!==s[o])return!1;return!0}t.isEqual=e;function n(r){return r??t.identity}t.simplify=n;function i(r,s){let o=s.slice(0);for(var a=0,l=s.length;a<l;a+=3){let c=r[3]*s[a]+r[7]*s[a+1]+r[11]*s[a+2]+r[15];o[a]=(r[0]*s[a]+r[4]*s[a+1]+r[8]*s[a+2]+r[12])/c,o[a+1]=(r[1]*s[a]+r[5]*s[a+1]+r[9]*s[a+2]+r[13])/c,o[a+2]=(r[2]*s[a]+r[6]*s[a+1]+r[10]*s[a+2]+r[14])/c}return o}t.applyMatrix4=i})(Jg||(Jg={}));var so;(t=>{function e(a){return typeof a=="object"&&typeof a.r=="number"&&typeof a.g=="number"&&typeof a.b=="number"}t.isRGB=e,t.white={r:1,g:1,b:1},t.red={r:1,g:0,b:0},t.black={r:0,g:0,b:0};function n(a){return{r:Math.round(a.r*255),g:Math.round(a.g*255),b:Math.round(a.b*255),a:1}}t.toRgb255a1=n;function i(a){return{r:a.r,g:a.g,b:a.b}}t.clone=i;function r(a){return a=Math.floor(a),{r:(a>>16&255)/255,g:(a>>8&255)/255,b:(a&255)/255}}t.fromHex=r;function s(a,l){return a.r===l.r&&a.g===l.g&&a.b===l.b}t.equals=s;function o(a,l,c){return{r:a.r+(l.r-a.r)*c,g:a.g+(l.g-a.g)*c,b:a.b+(l.b-a.b)*c}}t.lerp=o})(so||(so={}));var Ha;(t=>{t.white={...so.white,a:1},t.transparent={...so.white,a:0};function e(o){return{r:o[0],g:o[1],b:o[2],a:o[3]}}t.from0to1=e;function n(o,a){return{...so.fromHex(o),a}}t.fromHexAndA=n;function i(o){return{r:Math.round(o.r*255),g:Math.round(o.g*255),b:Math.round(o.b*255),a:o.a}}t.toRgb255a1=i;function r(o,a){return so.equals(o,a)&&o.a===a.a}t.equals=r;function s(o,a,l){return{r:o.r+(a.r-o.r)*l,g:o.g+(a.g-o.g)*l,b:o.b+(a.b-o.b)*l,a:o.a+(a.a-o.a)*l}}t.lerp=s})(Ha||(Ha={}));var fI;(t=>t.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(fI||(fI={}));var aj;(t=>t.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(aj||(aj={}));var lj;(t=>t.defaultData={control1:[.5,.05],control2:[.1,.3]})(lj||(lj={}));var zf;(t=>{t.all=["PerspectiveCamera","OrthographicCamera"];function e(n){return t.all.includes(n)}t.is=e})(zf||(zf={}));var Vx;(t=>{t.DefaultUp=[0,1,0],t.DefaultTargetOffset=1e3,t.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1,autoZoom:!1,autoZoomFrustumSize:790},up:t.DefaultUp,isUpVectorFlipped:!1,targetOffset:t.DefaultTargetOffset};function e(n){return n.type==="PerspectiveCamera"?n.perspective.zoom:n.orthographic.zoom}t.getZoom=e})(Vx||(Vx={}));var vh;(t=>{function e(i,r=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(i[0],i[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[i[0]+i[0]*r,0,0]},grid:{count:[2,2,2],size:i.map(s=>s*(1+r)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}t.defaultData=e;function n(i,r){let s={...i};if(EJ.forEach(o=>{Object.assign(s,{[o]:r[o]??i[o]})}),s.radial={...i.radial},r.radial){let o=i.radial,a=r.radial;CJ.forEach(l=>{Object.assign(s.radial,{[l]:a[l]??o[l]})})}if(s.linear={...i.linear},r.linear){let o=i.linear,a=r.linear;TJ.forEach(l=>{Object.assign(s.linear,{[l]:a[l]??o[l]})})}if(s.grid={...i.grid},r.grid){let o=i.grid,a=r.grid;PJ.forEach(l=>{Object.assign(s.grid,{[l]:a[l]??o[l]})})}if(s.toObject={...i.toObject},r.toObject){let o=i.toObject,a=r.toObject;DJ.forEach(l=>{Object.assign(s.toObject,{[l]:a[l]??o[l]})})}if(s.randomnessObject={...i.randomnessObject},r.randomnessObject){let o=i.randomnessObject,a=r.randomnessObject;RJ.forEach(l=>{Object.assign(s.randomnessObject,{[l]:a[l]??o[l]})})}return s}t.merge=n})(vh||(vh={}));var pI;(t=>{t.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let e=["radial","linear","grid","toObject","randomnessObject"];function n(i,r){let s=[];i.count!==void 0&&s.push({type:0,path:r,props:{count:i.count}});for(let o of e){let a=i[o];a&&Object.keys(a).length>0&&s.push({type:0,path:[...r,o],props:a})}return s}t.toOps=n})(pI||(pI={}));var EJ=["count"],CJ=["radius","start","end","position","scale","rotation"],TJ=["position","scale","rotation"],PJ=["count","size"],DJ=["count","position","scale","rotation"],RJ=["strength","scale","rotation","position","movement","seed","freqScale"],jx;(t=>{let e={opacity:1,blendFunction:13,enabled:!1};t.defaultData={enabled:!1,pixelation:{...e,blendFunction:16,granularity:15},bloom:{...e,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...e,offset:[2,2]},vignette:{...e,darkness:1,offset:0},hueSaturation:{...e,hue:3,saturation:0},brightnessContrast:{...e,brightness:.25,contrast:0},depthOfField:{...e,focalLength:2,focusDistance:2,bokehScale:2},noise:{...e,blendFunction:16}}})(jx||(jx={}));var mI;(t=>{t.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function e(n){return t.all.includes(n)}t.is=e})(mI||(mI={}));var gI;(t=>{function e(i){return n(i)}t.defaultData=e;function n(i){if(i==="PointLight")return{type:i,color:Ha.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,depth:1e5};if(i==="SpotLight")return{type:i,color:Ha.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,shadowResolution:1024,shadowRadius:1};if(i==="DirectionalLight")return{type:i,color:Ha.white,intensity:1,shadows:!0,size:2e3,depth:1e5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(gI||(gI={}));var vI;(t=>{t.defaultData={castShadow:!0,receiveShadow:!0};function e(n,i){return n.castShadow===i.castShadow&&n.receiveShadow===i.receiveShadow}t.equals=e})(vI||(vI={}));var yI;(t=>{t.defaultData={flatShading:!1,wireframe:!1,side:0};function e(n,i){return n.flatShading===i.flatShading&&n.side===i.side&&n.wireframe===i.wireframe}t.equals=e})(yI||(yI={}));var xI;(t=>t.defaultData={...yI.defaultData,...vI.defaultData})(xI||(xI={}));var $A;(t=>(t.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},t.maxSize=3e7))($A||($A={}));var cj;(t=>{function e(n){return n==="texture"||n==="video"||n==="color"||n==="depth"||n==="normal"||n==="gradient"||n==="noise"||n==="fresnel"||n==="rainbow"||n==="toon"||n==="outline"||n==="transmission"||n==="matcap"||n==="displace"||n==="light"}t.is=e})(cj||(cj={}));var uj;(t=>{function e(n){return n==="phong"||n==="toon"||n==="lambert"||n==="physical"}t.is=e})(uj||(uj={}));var LJ=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],BLe=["wrapping","image","video"],ea;(t=>{function e(s,o){let{texture:a,...l}=o;if(Object.assign(s,l),a){let c=s.texture;c&&Object.assign(c,a)}}t.patch=e;function n(s,o){return s==="light"&&o?i(o):r(s)}t.defaultData=n;function i(s){switch(s){case"phong":return{category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",alpha:.6,visible:!0,mode:0};case"toon":return{category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1,visible:!0,mode:0};case"lambert":return{category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0};case"physical":return{category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0}}}function r(s){switch(s){case"texture":return{alpha:1,visible:!0,size:[128,128],mode:0,axis:"x",side:2,type:"texture",projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0]},crop:!1};case"video":return{alpha:1,visible:!0,size:[128,128],mode:0,axis:"x",side:2,type:"video",projection:0,texture:{video:$A.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0]},crop:!0};case"color":return{type:"color",alpha:1,visible:!0,mode:0,color:so.fromHex(5526619)};case"depth":return{type:"depth",alpha:1,visible:!0,mode:0,gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{type:"normal",alpha:1,visible:!0,mode:0,cnormal:[1,1,1]};case"gradient":return{type:"gradient",alpha:1,visible:!0,mode:0,gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{type:"noise",alpha:1,visible:!0,mode:0,size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...so.fromHex(6710886),a:1},colorB:{...so.fromHex(6710886),a:1},colorC:{...so.fromHex(16777215),a:1},colorD:{...so.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8]};case"fresnel":return{type:"fresnel",alpha:1,visible:!0,mode:0,color:Ha.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{type:"rainbow",alpha:1,visible:!0,mode:0,filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{type:"toon",alpha:1,visible:!0,mode:0,positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:Ha.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{type:"outline",alpha:1,visible:!0,mode:0,outlineColor:Ha.fromHexAndA(0,1),contourColor:Ha.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{type:"matcap",alpha:1,visible:!0,mode:0,texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0]}};case"transmission":return{type:"transmission",alpha:1,visible:!0,mode:0,thickness:10,ior:1.5,roughness:1};case"displace":return{type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,visible:!0}}}})(ea||(ea={}));var wo;(t=>{function e(c){return!c.layers.some(h=>h.data.type==="texture"&&h.data.projection!==0||h.data.type==="depth"&&!h.data.isWorldSpace||h.data.type==="noise"||h.data.type==="displace")}t.isMergable=e;function n(c){let h="";return c.layers.forEach(u=>{Object.entries(u.data).forEach(([d,f])=>{h+=`${d}${f}`,Array.isArray(f)?f.forEach(p=>h+=`${p}`):typeof f=="object"?Object.values(f).forEach(p=>{typeof p=="number"?h+=`${p.toFixed(4)}`:h+=`${p}`}):h+=`${f}`})}),h}t.getHash=n;function i(){return{layers:new $t}}t.defaultEmptyData=i;function r(c="layer1",h="layer2"){return o("phong",c,h)}t.defaultData=r;function s(c,h){return{...c,name:h}}t.withName=s;function o(c,h="layer1",u="layer2"){let d=new $t;return d.push({fi:0,data:ea.defaultData("light",c),id:h}),d.push({fi:1,data:ea.defaultData("color"),id:u}),{layers:d}}t.defaultTwoLayerData=o;function a(c,h="phong",u="layer1",d="layer2"){let f=ea.defaultData("texture");Object.assign(f.texture,{image:c});let p=new $t;return p.push({fi:0,data:f,id:u}),p.push({fi:1,data:ea.defaultData("light",h),id:d}),{layers:p}}t.defaultTwoLayerTextureData=a;function l(c,h="phong",u="layer1",d="layer2"){let f=ea.defaultData("video");Object.assign(f.texture,{video:c});let p=new $t;return p.push({fi:0,data:f,id:u}),p.push({fi:1,data:ea.defaultData("light",h),id:d}),{layers:p}}t.defaultTwoLayerVideoTextureData=l})(wo||(wo={}));var eM;(t=>{function e(){return{points:new $t,roundness:0,shapeHoles:[],isClosed:!1}}t.defaultData=e})(eM||(eM={}));var tM;(t=>{function e(){return{points:new $t,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}t.defaultData=e})(tM||(tM={}));var IJ={type:"Ellipse",width:100,height:100,spikes:64,angle:360,innerRadius:0},wI;(t=>{function e(n,i){let r={...n};return OJ.forEach(s=>{Object.assign(r,{[s]:i[s]??n[s]})}),r}t.merge=e})(wI||(wI={}));var BJ={shape:IJ,depth:1,offset:0,bevel:0,bevelSides:1,angle:0,twist:0,startScale:1,endScale:1},OJ=["depth","offset","angle","twist","startScale","endScale"],nM;(t=>{function e(i){return i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"}t.is2DParametricMesh=e;function n(i){return i==="PolygonGeometry"||i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"||i==="PathGeometry"||i==="VectorGeometry"||i==="ConeGeometry"||i==="CubeGeometry"||i==="CylinderGeometry"||i==="DodecahedronGeometry"||i==="HelixGeometry"||i==="IcosahedronGeometry"||i==="LatheGeometry"||i==="PyramidGeometry"||i==="SphereGeometry"||i==="PlaneGeometry"||i==="BackdropGeometry"||i==="TorusGeometry"||i==="TorusKnotGeometry"||i==="BooleanGeometry"||i==="TextGeometry"}t.isParametricMesh=n})(nM||(nM={}));var _I;(t=>{function e(n,i){let r={...n};return Object.assign(r,i),r.type==="PathGeometry"&&"extrusion"in i&&i.extrusion&&(r.extrusion={...n.extrusion},Object.assign(r.extrusion,wI.merge(r.extrusion,i.extrusion))),r}t.merge=e})(_I||(_I={}));var pg;(t=>{function e(n){if(n==="RectangleGeometry")return{width:320,height:320,type:n,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(n==="PathGeometry")return{type:n,width:1,height:1,depth:1,path:tM.defaultData(),extrusion:BJ};if(n==="VectorGeometry")return{width:1,height:1,type:n,subdivisions:12,shape:eM.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(n==="BooleanGeometry")return{type:n,operation:2,width:0,height:0,depth:0,phongAngle:35};if(n==="TextGeometry")return{type:n,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:"",textTransform:1,font:"Roboto_regular",extrudeBevelSize:0,extrudeBevelSegments:1};throw new Error("not implemented")}t.defaultData=e})(pg||(pg={}));var hj=["width","height","depth"],dj;(t=>{function e(i){return i==="Component"||i==="Instance"}t.isComponentRelated=e;function n(i){return i==="Empty"||i==="Instance"}t.isEmptyOrComponent=n})(dj||(dj={}));var Zg;(t=>{t.identity={...fI.identity,hiddenMatrix:Jg.identity};function e(r){return{position:r.position,rotation:r.rotation,scale:r.scale,hiddenMatrix:r.hiddenMatrix}}t.fromObject=e;function n(r,s){return{position:(s==null?void 0:s.position)||r.position,rotation:(s==null?void 0:s.rotation)||r.rotation,scale:(s==null?void 0:s.scale)||r.scale,hiddenMatrix:(s==null?void 0:s.hiddenMatrix)||r.hiddenMatrix}}t.merge=n;function i(r,s){return{position:Sf.isEqual(r.position,s.position)?null:s.position,rotation:Sf.isEqual(r.rotation,s.rotation)?null:s.rotation,scale:Sf.isEqual(r.scale,s.scale)?null:s.scale,hiddenMatrix:Jg.isEqual(r.hiddenMatrix,s.hiddenMatrix)?null:s.hiddenMatrix}}t.diff=i})(Zg||(Zg={}));var fj;(t=>t.defaultData={fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(fj||(fj={}));var aa;(t=>t.defaultData={states:new $t,events:new $t,visible:!0,raycastLock:!1,collision:"visibility",physics:null,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...Zg.identity,cloner:null})(aa||(aa={}));var pj;(t=>t.defaultData={type:"Empty",...aa.defaultData})(pj||(pj={}));var mj;(t=>t.defaultData={type:"Component",...aa.defaultData})(mj||(mj={}));var mg;(t=>t.defaultData={type:"Mesh",...aa.defaultData,...xI.defaultData})(mg||(mg={}));var iM;(t=>t.defaultData={...aa.defaultData,...Zg.identity,...Vx.defaultData})(iM||(iM={}));var bI;(t=>{function e(n){return{...aa.defaultData,...gI.defaultData(n)}}t.defaultData=e})(bI||(bI={}));var rM;(t=>{function e(i,r,s=0){for(;s<r.length;){let o=i?i[r[s]]:void 0;if(r.length===s+1)return o;if(o)i=o.descendants,s+=1;else return}}t.resolveWithDes=e;function n(i,r,s=0){let o=e(i,r,s);if(o){let a=Object.keys(o);if(a.length===1&&a[0]==="descendants")return}return o}t.resolve=n})(rM||(rM={}));var $g;(t=>{t.rootOverrideProps=["physics"],t.compositeNonOptionalOverrideProps=["geometry"],t.compositeEntireOverrideOverrideProps=["material"];function e(i,r){return{...aa.defaultData,...r,component:i,overrides:new Br,physics:void 0,type:"Instance"}}t.ofComponent=e;function n(i){let r=Zg.fromObject(i.data);return e(i.id,r)}t.fromComponentData=n})($g||($g={}));var SI;(t=>(t.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:Jg.identity,name:"Play Camera",visible:!0,raycastLock:!1,collision:"visibility",physics:null,states:new $t,events:new $t,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...Vx.defaultData},t.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},t.defaultMeshObject={name:"Rectangle",...aa.defaultData,...mg.defaultData,geometry:pg.defaultData("RectangleGeometry"),material:wo.defaultTwoLayerData("phong","layer1","layer2")},t.defaultBooleanObject={name:"Boolean",...aa.defaultData,...mg.defaultData,geometry:pg.defaultData("BooleanGeometry"),material:wo.defaultTwoLayerData("phong","layer1","layer2")},t.defaultTextObject={name:"Text",...aa.defaultData,...mg.defaultData,geometry:pg.defaultData("TextGeometry"),material:wo.defaultTwoLayerData("phong","layer1","layer2")}))(SI||(SI={}));var af;(t=>{function e(s,o){let a={name:o};return s.type==="Mesh"?(a.geometry={},"material"in s&&(a.material={layers:new Br}),"materials"in s&&(a.materials=s.materials.map(l=>({layers:new Br})))):zf.is(s.type)&&(a.perspective={},a.orthographic={}),a}t.newEmpty=e;function n(s,o){if(o===void 0)return s;let a={...s};return"material"in a&&"material"in o&&o.material&&(a.material=qA(a.material,l=>{if(typeof l!="string")for(let[c,h]of Object.entries(o.material.layers)){let u=l.layers.data(c);u&&ea.patch(u,h)}}).data),a.materials&&o.materials&&(a.materials=qA(a.materials,l=>{var c,h;for(let u=0;u<a.materials.length;u++){let d=o.materials[u];if(typeof d!="string")for(let[f,p]of Object.entries(d.layers)){let v=(h=(c=l[u])==null?void 0:c.layers)==null?void 0:h.data(f);v&&ea.patch(v,p)}}}).data),a}function i(s,o){let a,l=[],c={orthographic:0,perspective:0,geometry:0};function h(u,d){for(let[f,p]of Object.entries(d.layers)){let{texture:v,...g}=p;if(v!==void 0&&Object.keys(v).length>0){let m={path:[...u,"layers",f,"texture"],props:v,type:0};l.push(m)}if(Object.keys(g).length>0){let m={path:[...u,"layers",f],props:g,type:0};l.push(m)}}}for(let[u,d]of Object.entries(o))if(u!=="name")if(u==="cloner")l.push(...pI.toOps(d,["cloner"]));else if(u==="pathSnapping")l.push({path:[u],props:{slide:d.slide,offset:d.offset},type:0});else if(u==="material")h(["material"],d);else if(u==="materials")for(let[f,p]of Object.entries(d))h(["materials",f],p);else if(c[u]===0){if(u==="geometry"&&d.extrusion!==void 0){let f={path:[u,"extrusion"],props:d.extrusion,type:0};l.push(f),d={...d},delete d.extrusion}if(Object.keys(d).length>0){let f={path:[u],props:d,type:0};l.push(f)}}else a===void 0&&(a={path:[],props:{},type:0},l.push(a)),a.props[u]=d;return l}t.toOps=i;function r(s,o){var l,c,h,u,d,f;if(o===void 0)return s;let a={...s};if(Object.assign(a,Zg.merge(a,o)),Object.assign(a,{pathSnapping:Object.assign({},a.pathSnapping,{slide:((l=o.pathSnapping)==null?void 0:l.slide)??((c=a.pathSnapping)==null?void 0:c.slide)??0,offset:((h=o.pathSnapping)==null?void 0:h.offset)??((u=a.pathSnapping)==null?void 0:u.offset)??0})}),zf.is(s.type)){a.orthographic={...a.orthographic},a.perspective={...a.perspective};let p=o;((d=p.orthographic)==null?void 0:d.zoom)!==void 0&&(a.orthographic.zoom=p.orthographic.zoom),((f=p.perspective)==null?void 0:f.zoom)!==void 0&&(a.perspective.zoom=p.perspective.zoom),p.isUpVectorFlipped!==void 0&&(a.isUpVectorFlipped=p.isUpVectorFlipped),p.targetOffset!==void 0&&(a.targetOffset=p.targetOffset)}else if(s.type==="Mesh")"geometry"in o&&Object.assign(a,{geometry:_I.merge(a.geometry,o.geometry)}),(o.material||o.materials)&&(a=n(a,o)),a.cloner&&"cloner"in o&&Object.assign(a,{cloner:vh.merge(a.cloner,o.cloner)});else if(s.type==="Empty")a.cloner&&"cloner"in o&&Object.assign(a,{cloner:vh.merge(a.cloner,o.cloner)});else if(mI.is(s.type)){let p=o;p.intensity!==void 0&&(a.intensity=p.intensity),p.color!==void 0&&(typeof p.color=="string"?a.color=p.color:a.color=so.clone(p.color))}return a}t.patch=r})(af||(af={}));var sM;(t=>t.defaultData={enabled:!1,useBackgroundColor:!1,color:so.white,near:.1,far:2e3})(sM||(sM={}));var oM;(t=>t.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0,autoZoom:!1})(oM||(oM={}));var ev;(t=>t.defaultData={orbitControls:oM.defaultData,playCamera:null,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1}},stopRaycast:!0,joystickSizeAndXYOffset:Array(12).fill(0).map((e,n)=>{let i=0,r=0;return n<5?r=-30:n<10&&(r=30),n===0||n===10||n===5?i=30:(n===4||n===11||n===9)&&(i=-30),[120,[i,r],"show"]}),gameControlObject:null})(ev||(ev={}));function Gf(t,e){return Object.setPrototypeOf(t,e),t}var OLe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes(" electron/"),FLe=()=>typeof window>"u"?!1:window.navigator.platform.toUpperCase().includes("MAC"),NLe=()=>typeof window>"u"?!1:/iPad|iPhone|iPod/.test(window.navigator.userAgent)||FE&&"ontouchend"in document,ULe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,kLe=()=>typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0,zLe=()=>{if(typeof window>"u")return!1;let t=navigator.userAgent,e=navigator.vendor;return/Safari/i.test(t)&&/Apple Computer/.test(e)},GLe=()=>{if(typeof window>"u")return null;let t=navigator.userAgent.match(/Version\/(\d+\.\d)/);return t&&t[1]};OLe();var FE=FLe(),AI=NLe(),HLe=ULe(),fo=kLe(),gj=zLe(),vj=Number(GLe());function FJ(t){return Array.isArray(t)?t:[t]}function VLe(t,e){let n=0;for(;n<t.length&&n<e.length;){if(t[n]<e[n])return-1;if(t[n]>e[n])return 1;n+=1}return n!==e.length?-1:n!==t.length?1:0}function Rb(t){return FE?t.metaKey:t.ctrlKey}var Nt=[],aM={},ly={},NS={};function NJ(t){Nt.includes(t)||Nt.push(t)}function gg(t){delete aM[t.pointerId];for(let e=0;e<Nt.length;e++)if(Nt[e].pointerId===t.pointerId){Nt.splice(e,1);break}}function jLe(){Nt.splice(0,Nt.length)}function lM(t){if(t.pointerType!=="touch")return;let e=aM[t.pointerId];e===void 0&&(e={x:0,y:0},aM[t.pointerId]=e),e.x=t.pageX,e.y=t.pageY}function T2(t){let e=t.pointerId===Nt[0].pointerId?Nt[1]:Nt[0];return aM[e.pointerId]}function UJ(t){ly[t.key]=!0,NS[t.key]=NS[t.key]===void 0?1:NS[t.key]+1}function kJ(t){if(FE&&ly.Meta)for(let e in ly)ly[e]=!1;else ly[t.key]=!1;NS={}}function WLe(t){t.addEventListener("pointerdown",NJ,!0),t.addEventListener("pointerdown",lM,!0),t.addEventListener("pointermove",lM,!0),t.addEventListener("pointerup",gg,!0),t.addEventListener("pointercancel",gg,!0),t.addEventListener("pointerleave",gg,!0),window.addEventListener("keydown",UJ,!0),window.addEventListener("keyup",kJ,!0)}function XLe(t){t.removeEventListener("pointerdown",NJ,!0),t.removeEventListener("pointerdown",lM,!0),t.removeEventListener("pointermove",lM,!0),t.removeEventListener("pointerup",gg,!0),t.removeEventListener("pointercancel",gg,!0),t.removeEventListener("pointerleave",gg,!0),window.removeEventListener("keydown",UJ,!0),window.removeEventListener("keyup",kJ,!0)}var io;(t=>t.defaultData={ambientLight:{enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75,depth:100,groundColor:{r:.5098039215686274,g:.5098039215686274,b:.5098039215686274},softShadows:!0,softShadowQuality:"low"},usePhysics:!1,gravity:-10,pixelsPerMeter:200,skinWidthRelative:.02,stepThreshRelative:.3,slopeThresh:65})(io||(io={}));var MI;(t=>{t.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222";function e(r={withLight:!0,withSquare:!0}){let s=new ks,o=SI.defaultMeshObject;return r.withLight===!0&&s.push({fi:-1,data:{...bI.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7},id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]}),r.withSquare===!0&&s.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:o,children:[]}),s}t.defaultData={backgroundColor:Ha.fromHexAndA(2960946,1),postprocessing:jx.defaultData,fog:sM.defaultData,objects:e(),environment:io.defaultData,publish:ev.defaultData},t.emptyData=function(r){return{backgroundColor:Ha.fromHexAndA(2960946,1),postprocessing:jx.defaultData,fog:sM.defaultData,objects:r?e(r):new ks,environment:io.defaultData,publish:ev.defaultData}};function n(r){return{...t.defaultData,objects:Gf(r,ks.prototype)}}t.withObjs=n;function i(r,s){return n([{id:r,data:s,children:[],fi:0}])}t.withObj=i})(MI||(MI={}));var cM;(t=>t.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII="})(cM||(cM={}));var uM;(t=>{function e(){let r={};return r["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},Gf(r,ki.prototype)}t.defaultColors=e;function n(r){let s={};return r!=null&&r.withAITexture&&(s["a1b10010-844c-a8a3-11ec-0242ac2011ec"]={...cM.emptyImage,name:"AI generated image"}),Gf(s,ki.prototype)}t.defaultImages=n;function i(){return{materials:new ki,images:new ki,videos:new ki,colors:new ki,audios:new ki,fonts:new ki,penumbraSize:[2,2,2]}}t.emptyData=i})(uM||(uM={}));function yj(t){t.layers.forEach(e=>{if(e.type==="depth"&&e.colorA!==void 0){let n=e.colorA,i=e.colorB,r=[[n.r,n.g,n.b,n.a],[i.r,i.g,i.b,i.a]],s=[0,1];for(let a=2;a<10;a++)r.push(r[1]),s.push(1);let o={...zx(Kr(e),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,e.near),far:Math.max(0,e.far),colors:r,steps:s,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(e,o)}else if(e.type==="depth"&&e.gradientType===1&&(e.near<0||e.far<0)){let n={...Kr(e),near:Math.max(e.near,0),far:Math.max(e.far,0)};Object.assign(e,n)}})}function US(t,e){Object.values(t.shared.materials).forEach(n=>e(n))}function kS(t,e){t.scene.objects.traverse((n,i)=>{"materials"in i?i.materials.forEach(r=>{typeof r!="string"&&e(r)}):"material"in i&&typeof i.material!="string"&&e(i.material)})}function YLe(t){Object.assign(t.scene.publish,{orbitControls:{...oM.defaultData,...Kr(t.scene.publish.orbitControls)}})}function qLe(t){Object.assign(t.scene.publish.settings,{video:{...ev.defaultData.settings.video,...Kr(t.scene.publish.settings.video)}})}function QLe(t){function e(n){if(n.layers){for(let i of Object.values(n.layers))if(i){for(let[r,s]of Object.entries(i))if((LJ.includes(r)||typeof s=="boolean")&&delete i[r],r==="texture")for(let[o,a]of Object.entries(s))(BLe.includes(o)||typeof a=="boolean")&&delete s[o]}}}t.scene.objects.traverse((n,i)=>{i.states.forEach(r=>{let s=r;s.material?e(s.material):s.materials&&s.materials.forEach(o=>{e(o)})})})}function KLe(t){t.scene.publish.withBackground=!0}function JLe(t){t.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function ZLe(t){t.scene.objects.traverse((e,n)=>{let i=n.cloner;i&&(i.radial.scale=i.radial.scale.map(r=>r+1),i.linear.scale=i.linear.scale.map(r=>r+1))})}function $Le(t){t.scene.objects.traverse((e,n)=>{let i=n.geometry;i&&(i.type==="DodecahedronGeometry"||i.type==="IcosahedronGeometry")&&(i.detail=Math.round(i.detail))})}function eIe(t){t.scene.objects.traverse((e,n)=>{let i=t.scene.objects.unproxy().parent(e);if(i){let r=Kr(t.scene.objects.data(i));r&&r.type==="Mesh"&&r.geometry.type==="BooleanGeometry"&&n.type==="Mesh"&&(n.visible=Kr(n).booleanExclude!==!0)}})}function tIe(t){t.scene.objects.traverse((e,n)=>{if(n.type==="Mesh"){let i=n;n.geometry.type==="NonParametricGeometry"?i.material!==void 0&&delete i.material:i.materials!==void 0&&delete i.materials}})}function nIe(t){function e(i){Object.setPrototypeOf(i,Br.prototype),i.texture&&Object.setPrototypeOf(i.texture,Br.prototype)}function n(i){Object.setPrototypeOf(i,Br.prototype);for(let r in i)e(i[r])}t.scene.objects.traverse((i,r)=>{r.states.forEach(s=>{let o=s;if(o.material){let a=Kr(o.material).layers;n(a),o.material.layers=a}if(o.materials)for(let a=0;a<o.materials.length;a++){let l=o.materials[a],c=Kr(l).layers;n(c),l.layers=c}})})}function xj(t){t.layers===void 0&&Object.assign(t,wo.defaultTwoLayerData("lambert"))}function P2(t){!t.layers||t.layers.forEach(e=>{if(e.type==="depth"&&e.colors.length===10){let n=[...e.colors];n.push(e.colors[9]);let i=[...e.steps];i.push(e.steps[9]);let r={...Kr(e),colors:n,steps:i};Object.assign(e,r)}})}function iIe(t){t.scene.objects.traverse((e,n)=>{n.type==="Mesh"&&(n.geometry.type==="BooleanGeometry"||n.geometry.type==="SubdivGeometry")&&(n.geometry.phongAngle=35)})}function wj(t){t.scene.objects.traverse((e,n)=>{"materials"in n?n.materials.forEach(i=>{typeof i!="string"&&P2(i)}):"material"in n&&typeof n.material!="string"&&P2(n.material)}),Object.values(t.shared.materials).forEach(e=>P2(e))}function rIe(t){t.scene.environment.ambientLight.softShadows=!1,t.scene.environment.ambientLight.softShadowQuality="low",t.scene.objects.traverse((e,n)=>{(n.type==="DirectionalLight"||n.type==="SpotLight")&&(n.shadowResolution=1024,n.shadowRadius=1,n.depth=1e5)}),t.shared.penumbraSize=new Array(5).fill(.5)}function sIe(t){t.shared.audios=Gf({},ki.prototype)}function oIe(t){t.shared.videos=Gf({},ki.prototype)}function aIe(t){let e=t.shared.materials;Object.entries(e).forEach(([n,i])=>{if(!i.layers){let r={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(e,{[n]:r})}})}function lIe(t){Object.entries(Kr(t.shared.images)).filter(e=>e[1].asset===!1).map(e=>e[0]).forEach(e=>{delete t.shared.images[e]}),Object.entries(Kr(t.shared.audios)).filter(e=>e[1].asset===!1).map(e=>e[0]).forEach(e=>{delete t.shared.audios[e]})}function cIe(t){t.scene.publish.settings.web.preload=!1}function _j(t){t.layers&&t.layers.forEach(e=>{e.type==="depth"&&e.num!==void 0&&(e.colors=e.colors.slice(0,e.num),e.steps=e.steps.slice(0,e.num),delete e.num)})}function uIe(t){t.shared.fonts=Gf({},ki.prototype)}function hIe(t){return t.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function dIe(t){let e=[];t.scene.objects.traverse((n,i)=>{let r=i;if(r.type==="TextFrame"){let s=wo.defaultTwoLayerData("phong"),o=typeof r.color=="string"?t.shared.colors[r.color]:r.color;s.layers[1].data.color={r:o.r,g:o.g,b:o.b},s.layers[1].data.alpha=r.alpha;let a=hIe(r.font);t.shared.fonts[a]===void 0&&(t.shared.fonts[a]={name:a});let l={name:r.name,...aa.defaultData,...mg.defaultData,flatShading:!1,wireframe:!1,geometry:{...pg.defaultData("TextGeometry"),width:r.width,height:r.height,font:a,depth:0,horizontalAlign:r.horizontalAlign,verticalAlign:r.verticalAlign,fontSize:r.fontSize*1.40625,lineHeight:r.lineHeight/1.40625,letterSpacing:r.letterSpacing-1,text:r.text,textTransform:r.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:s,states:Kr(r.states),events:Kr(r.events),visible:r.visible,raycastLock:r.raycastLock,position:r.position,rotation:r.rotation,scale:r.scale,hiddenMatrix:r.hiddenMatrix},c=Kr(t.scene.objects).parent(n);t.scene.objects.insertAfter(c??null,n,[{id:n+"new",data:l,children:[]}]),e.push(n)}}),e.forEach(n=>{t.scene.objects.delete(n)})}function fIe(t){let e={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};t.scene.objects.traverse((n,i)=>{i.events.forEach(r=>{if(e[Number(r.type)])if(Object.assign(r,{type:e[Number(r.type)]}),r.type==="Audio"&&"audioEvent"in r&&(Object.assign(r,{playAudio:r.audioEvent}),delete r.audioEvent),r.type==="GameControl")Object.assign(r,{gameActions:{idle:new $t,move:new $t,jump:new $t}});else{let s=new $t;Object.assign(r,{actions:s}),(r.type==="MouseDown"||r.type==="MouseUp"||r.type==="KeyDown"||r.type==="KeyUp")&&"url"in r&&s.push({fi:0,id:sn.generateUUID(),data:{type:"Link",url:r.url,delay:0}}),"targets"in r&&(r.targets.forEach((o,a,l)=>{let c={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},h={easing:o.easing,duration:o.duration};o.easing===6?Object.assign(h,zx(o,"mass","stiffness","damping","velocity")):o.easing===5&&Object.assign(h,{control1:{...o.control1},control2:{...o.control2}});let u={repeat:o.repeat?-1:0,delay:o.delay,delayDirection:o.delayDirection,direction:o.cycle&&o.rewind?"pingpong-rewind":o.cycle?"pingpong":"normal"},d={state:o.state,...u,...h},f={allowSlerp:!0,type:"Transition",object:o.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new $t({fi:0,id:sn.generateUUID(),data:c},{fi:1,id:sn.generateUUID(),data:d})};s.push({fi:l,id:a,data:f})}),delete r.targets)}})})}function pIe(t){t.scene.objects.traverse((e,n)=>{function i(r,s){var l;let o=new $t,a=[];if(n.events.forEach((c,h,u)=>{if(c.type==="Audio"&&c.trigger===s){let d;a.push(h),c.interaction==="play"?d={...zx(c,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in c?c.after:void 0,toggle:"after"in c?c.toggle:void 0,type:"Audio"}:(c.interaction==="pause"||c.interaction==="stop")&&(d={...zx(c,"interaction","delay","object","playAudio"),type:"Audio"}),d&&o.push({fi:u,id:h,data:d})}}),a.forEach(c=>n.events.delete(c)),o.length){let c=(l=n.events.find(h=>h.type===r))==null?void 0:l.data;c?"actions"in c&&c.actions.insertBefore(null,o):n.events.insertBefore(null,[{id:sn.generateUUID(),data:{type:r,actions:o}}])}}i("Start","start"),i("MouseDown","mouseDown"),i("MouseUp","mouseUp"),i("KeyDown","keyDown"),i("KeyUp","keyUp")})}function bj(t){var n;let e=(n=t.layers.find(i=>i.type==="light"))==null?void 0:n.data;if((e==null?void 0:e.category)==="basic"){let i=ea.defaultData("light","phong"),r=e;Object.assign(r,i),r.visible=!1}}function Sj(t){US(t,bj),kS(t,bj)}function mIe(t){t.scene.objects.traverse((e,n)=>{n.type==="Mesh"&&n.geometry.type==="SubdivGeometry"&&(n.geometry.scaleBaked||(n.geometry.scaleBaked=[1,1,1]))})}function gIe(t){t.scene.objects.traverse((e,n)=>{(n.type==="Empty"||n.type==="Mesh")&&n.cloner&&!n.cloner.randomnessObject&&!n.cloner.toObject&&!n.cloner.randomness&&(n.cloner={...n.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function vIe(t){t.scene.objects.traverse((e,n)=>{n.type==="Mesh"&&n.geometry.type==="NonParametricGeometry"&&!("material"in n)&&!("materials"in n)&&(n.material=wo.defaultTwoLayerData("phong"))})}function yIe(t){t.scene.publish.orbitControls.autoZoom===void 0&&(t.scene.publish.orbitControls.autoZoom=!1),t.scene.objects.traverse((e,n)=>{(n.type==="OrthographicCamera"||n.type==="PerspectiveCamera")&&(n.orthographic.autoZoom===void 0&&(n.orthographic.autoZoom=!1),n.orthographic.autoZoomFrustumSize===void 0&&(n.orthographic.autoZoomFrustumSize=790))})}function xIe(t){t.scene.objects.traverse((e,n)=>{n.pathSnapping===void 0&&(n.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),n.pathSnapping.offset===void 0&&(n.pathSnapping.offset=0)})}function wIe(t){t.scene.publish.mouseEventTarget===void 0&&(t.scene.publish.mouseEventTarget="canvas"),t.scene.publish.settings.web.hint===void 0&&(t.scene.publish.settings.web.hint=!1)}function _Ie(t){let{video:e}=t.scene.publish.settings;e.format==="gif"&&e.fps>48&&(e.fps=15)}function bIe(t){t.scene.objects.traverse((e,n)=>{n.events.forEach(i=>{i.type==="GameControl"&&(i.resetYPosition=Math.abs(i.resetYPosition-n.position[1]))})})}function SIe(t){let e=t.scene.environment.usePhysics;t.scene.objects.traverse((n,i)=>{e&&i.physics===null?i.collision=!1:i.collision="visibility"})}var Aj=37;function AIe(t){let e=t.schema??0;e!==Aj&&(console.warn("updating from ",e,"to ",Aj),e<1&&(kS(t,yj),US(t,yj),t.schema=1),e<2&&(YLe(t),t.schema=2),e<3&&(QLe(t),t.schema=3),e<4&&(KLe(t),t.schema=4),e<5&&(JLe(t),t.schema=5),e<6&&(ZLe(t),t.schema=6),e<7&&($Le(t),t.schema=7),e<8&&(t.schema=8),e<9&&(wj(t),t.schema=9),e<10&&(iIe(t),t.schema=10),e<11&&(rIe(t),t.schema=11),e<12&&(wj(t),t.schema=12),e<13&&(sIe(t),t.schema=13),e<14&&(aIe(t),t.schema=14),e<15&&(lIe(t),t.schema=15),e<16&&(cIe(t),t.schema=16),e<17&&(kS(t,_j),US(t,_j),t.schema=17),e<18&&(kS(t,xj),US(t,xj),t.schema=18),e<19&&(qLe(t),t.schema=19),e<20&&(uIe(t),dIe(t),t.schema=20),e<21&&(fIe(t),pIe(t),t.schema=21),e<22&&(Sj(t),t.schema=22),e<23&&(mIe(t),t.schema=23),e<24&&(gIe(t),t.schema=24),(e<25||t.shared.videos===void 0)&&(oIe(t),e<25&&(t.schema=25)),e<26&&(eIe(t),t.schema=26),e<27&&(tIe(t),t.schema=27),e<28&&(Sj(t),t.schema=28),e<29&&(nIe(t),t.schema=29),e<30&&(vIe(t),t.schema=30),e<31&&(yIe(t),t.schema=31),e<33&&(xIe(t),t.schema=33),e<34&&(wIe(t),t.schema=34),e<35&&(_Ie(t),t.schema=35),e<36&&(bIe(t),t.schema=36),e<37&&(SIe(t),t.schema=37))}function Qm(t,e=!1){let n=t[0].index!==null,i=new Set(Object.keys(t[0].attributes)),r=new Set(Object.keys(t[0].morphAttributes)),s={},o={},a=t[0].morphTargetsRelative,l=new Lt,c=0;for(let h=0;h<t.length;++h){let u=t[h],d=0;if(n!==(u.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let f in u.attributes){if(!i.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+'. All geometries must have compatible attributes; make sure "'+f+'" attribute exists among all geometries, or in none of them.'),null;s[f]===void 0&&(s[f]=[]),s[f].push(u.attributes[f]),d++}if(d!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". Make sure all geometries have the same number of attributes."),null;if(a!==u.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let f in u.morphAttributes){if(!r.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+".  .morphAttributes must be consistent throughout all geometries."),null;o[f]===void 0&&(o[f]=[]),o[f].push(u.morphAttributes[f])}if(e){let f;if(n)f=u.index.count;else if(u.attributes.position!==void 0)f=u.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". The geometry must have either an index or a position attribute"),null;l.addGroup(c,f,h),c+=f}}if(n){let h=0,u=[];for(let d=0;d<t.length;++d){let f=t[d].index;for(let p=0;p<f.count;++p)u.push(f.getX(p)+h);h+=t[d].attributes.position.count}l.setIndex(u)}for(let h in s){let u=Mj(s[h]);if(!u)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" attribute."),null;l.setAttribute(h,u)}for(let h in o){let u=o[h][0].length;if(u===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[h]=[];for(let d=0;d<u;++d){let f=[];for(let v=0;v<o[h].length;++v)f.push(o[h][v][d]);let p=Mj(f);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" morphAttribute."),null;l.morphAttributes[h].push(p)}}return l}function Mj(t){let e,n,i,r=0;for(let a=0;a<t.length;++a){let l=t[a];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(e===void 0&&(e=l.array.constructor),e!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(n===void 0&&(n=l.itemSize),n!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=l.normalized),i!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;r+=l.array.length}let s=new e(r),o=0;for(let a=0;a<t.length;++a)s.set(t[a].array,o),o+=t[a].array.length;return new Ut(s,n,i)}var EI;(t=>(t.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},t.defaultDataThirdPerson={moveMode:"walk",speedTranslate:1e3,speedRotate:100,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX",""],["rotPosY",""],["rotNegX",""],["rotNegY",""],["jump","Space"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:t.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new $t,move:new $t,jump:new $t}}))(EI||(EI={}));var MIe=Math.pow(2,-24),Lb=class{constructor(){}};function Ul(t,e,n){return n.min.x=e[t],n.min.y=e[t+1],n.min.z=e[t+2],n.max.x=e[t+3],n.max.y=e[t+4],n.max.z=e[t+5],n}function Ej(t){let e=-1,n=-1/0;for(let i=0;i<3;i++){let r=t[i+3]-t[i];r>n&&(n=r,e=i)}return e}function Cj(t,e){e.set(t)}function Tj(t,e,n){let i,r;for(let s=0;s<3;s++){let o=s+3;i=t[s],r=e[s],n[s]=i<r?i:r,i=t[o],r=e[o],n[o]=i>r?i:r}}function Ib(t,e,n){for(let i=0;i<3;i++){let r=e[t+2*i],s=e[t+2*i+1],o=r-s,a=r+s;o<n[i]&&(n[i]=o),a>n[i+3]&&(n[i+3]=a)}}function I0(t){let e=t[3]-t[0],n=t[4]-t[1],i=t[5]-t[2];return 2*(e*n+n*i+i*e)}function EIe(t,e){if(!t.index){let n=t.attributes.position.count,i=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,r;n>65535?r=new Uint32Array(new i(4*n)):r=new Uint16Array(new i(2*n)),t.setIndex(new Ut(r,1));for(let s=0;s<n;s++)r[s]=s}}function CIe(t){if(!t.groups||!t.groups.length)return[{offset:0,count:t.index.count/3}];let e=[],n=new Set;for(let r of t.groups)n.add(r.start),n.add(r.start+r.count);let i=Array.from(n.values()).sort((r,s)=>r-s);for(let r=0;r<i.length-1;r++){let s=i[r],o=i[r+1];e.push({offset:s/3,count:(o-s)/3})}return e}function D2(t,e,n,i,r=null){let s=1/0,o=1/0,a=1/0,l=-1/0,c=-1/0,h=-1/0,u=1/0,d=1/0,f=1/0,p=-1/0,v=-1/0,g=-1/0,m=r!==null;for(let y=e*6,w=(e+n)*6;y<w;y+=6){let b=t[y+0],A=t[y+1],S=b-A,T=b+A;S<s&&(s=S),T>l&&(l=T),m&&b<u&&(u=b),m&&b>p&&(p=b);let M=t[y+2],E=t[y+3],P=M-E,R=M+E;P<o&&(o=P),R>c&&(c=R),m&&M<d&&(d=M),m&&M>v&&(v=M);let F=t[y+4],B=t[y+5],k=F-B,j=F+B;k<a&&(a=k),j>h&&(h=j),m&&F<f&&(f=F),m&&F>g&&(g=F)}i[0]=s,i[1]=o,i[2]=a,i[3]=l,i[4]=c,i[5]=h,m&&(r[0]=u,r[1]=d,r[2]=f,r[3]=p,r[4]=v,r[5]=g)}function TIe(t,e,n,i){let r=1/0,s=1/0,o=1/0,a=-1/0,l=-1/0,c=-1/0;for(let h=e*6,u=(e+n)*6;h<u;h+=6){let d=t[h+0];d<r&&(r=d),d>a&&(a=d);let f=t[h+2];f<s&&(s=f),f>l&&(l=f);let p=t[h+4];p<o&&(o=p),p>c&&(c=p)}i[0]=r,i[1]=s,i[2]=o,i[3]=a,i[4]=l,i[5]=c}function PIe(t,e,n,i,r){let s=n,o=n+i-1,a=r.pos,l=r.axis*2;for(;;){for(;s<=o&&e[s*6+l]<a;)s++;for(;s<=o&&e[o*6+l]>=a;)o--;if(s<o){for(let c=0;c<3;c++){let h=t[s*3+c];t[s*3+c]=t[o*3+c],t[o*3+c]=h;let u=e[s*6+c*2+0];e[s*6+c*2+0]=e[o*6+c*2+0],e[o*6+c*2+0]=u;let d=e[s*6+c*2+1];e[s*6+c*2+1]=e[o*6+c*2+1],e[o*6+c*2+1]=d}s++,o--}else return s}}var Bc=32,DIe=(t,e)=>t.candidate-e.candidate,Gu=new Array(Bc).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),Bb=new Float32Array(6);function RIe(t,e,n,i,r,s){let o=-1,a=0;if(s===0)o=Ej(e),o!==-1&&(a=(e[o]+e[o+3])/2);else if(s===1)o=Ej(t),o!==-1&&(a=LIe(n,i,r,o));else if(s===2){let l=I0(t),c=1.25*r,h=i*6,u=(i+r)*6;for(let d=0;d<3;d++){let f=e[d],p=(e[d+3]-f)/Bc;if(r<Bc/4){let v=[...Gu];v.length=r;let g=0;for(let y=h;y<u;y+=6,g++){let w=v[g];w.candidate=n[y+2*d],w.count=0;let{bounds:b,leftCacheBounds:A,rightCacheBounds:S}=w;for(let T=0;T<3;T++)S[T]=1/0,S[T+3]=-1/0,A[T]=1/0,A[T+3]=-1/0,b[T]=1/0,b[T+3]=-1/0;Ib(y,n,b)}v.sort(DIe);let m=r;for(let y=0;y<m;y++){let w=v[y];for(;y+1<m&&v[y+1].candidate===w.candidate;)v.splice(y+1,1),m--}for(let y=h;y<u;y+=6){let w=n[y+2*d];for(let b=0;b<m;b++){let A=v[b];w>=A.candidate?Ib(y,n,A.rightCacheBounds):(Ib(y,n,A.leftCacheBounds),A.count++)}}for(let y=0;y<m;y++){let w=v[y],b=w.count,A=r-w.count,S=w.leftCacheBounds,T=w.rightCacheBounds,M=0;b!==0&&(M=I0(S)/l);let E=0;A!==0&&(E=I0(T)/l);let P=1+1.25*(M*b+E*A);P<c&&(o=d,c=P,a=w.candidate)}}else{for(let m=0;m<Bc;m++){let y=Gu[m];y.count=0,y.candidate=f+p+m*p;let w=y.bounds;for(let b=0;b<3;b++)w[b]=1/0,w[b+3]=-1/0}for(let m=h;m<u;m+=6){let y=~~((n[m+2*d]-f)/p);y>=Bc&&(y=Bc-1);let w=Gu[y];w.count++,Ib(m,n,w.bounds)}let v=Gu[Bc-1];Cj(v.bounds,v.rightCacheBounds);for(let m=Bc-2;m>=0;m--){let y=Gu[m],w=Gu[m+1];Tj(y.bounds,w.rightCacheBounds,y.rightCacheBounds)}let g=0;for(let m=0;m<Bc-1;m++){let y=Gu[m],w=y.count,b=y.bounds,A=Gu[m+1].rightCacheBounds;w!==0&&(g===0?Cj(b,Bb):Tj(b,Bb,Bb)),g+=w;let S=0,T=0;g!==0&&(S=I0(Bb)/l);let M=r-g;M!==0&&(T=I0(A)/l);let E=1+1.25*(S*g+T*M);E<c&&(o=d,c=E,a=y.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${s} used.`);return{axis:o,pos:a}}function LIe(t,e,n,i){let r=0;for(let s=e,o=e+n;s<o;s++)r+=t[s*6+i*2];return r/n}function IIe(t,e){let n=t.attributes.position,i=n.array,r=t.index.array,s=r.length/3,o=new Float32Array(s*6),a=n.offset||0,l=3;n.isInterleavedBufferAttribute&&(l=n.data.stride);for(let c=0;c<s;c++){let h=c*3,u=c*6,d=r[h+0]*l+a,f=r[h+1]*l+a,p=r[h+2]*l+a;for(let v=0;v<3;v++){let g=i[d+v],m=i[f+v],y=i[p+v],w=g;m<w&&(w=m),y<w&&(w=y);let b=g;m>b&&(b=m),y>b&&(b=y);let A=(b-w)/2,S=v*2;o[u+S+0]=w+A,o[u+S+1]=A+(Math.abs(w)+A)*MIe,w<e[v]&&(e[v]=w),b>e[v+3]&&(e[v+3]=b)}}return o}function BIe(t,e){function n(m){d&&d(m/f)}function i(m,y,w,b=null,A=0){if(!p&&A>=l&&(p=!0,c&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(t))),w<=h||A>=l)return n(y+w),m.offset=y,m.count=w,m;let S=RIe(m.boundingData,b,o,y,w,u);if(S.axis===-1)return n(y+w),m.offset=y,m.count=w,m;let T=PIe(a,o,y,w,S);if(T===y||T===y+w)n(y+w),m.offset=y,m.count=w;else{m.splitAxis=S.axis;let M=new Lb,E=y,P=T-y;m.left=M,M.boundingData=new Float32Array(6),D2(o,E,P,M.boundingData,s),i(M,E,P,s,A+1);let R=new Lb,F=T,B=w-P;m.right=R,R.boundingData=new Float32Array(6),D2(o,F,B,R.boundingData,s),i(R,F,B,s,A+1)}return m}EIe(t,e);let r=new Float32Array(6),s=new Float32Array(6),o=IIe(t,r),a=t.index.array,l=e.maxDepth,c=e.verbose,h=e.maxLeafTris,u=e.strategy,d=e.onProgress,f=t.index.count/3,p=!1,v=[],g=CIe(t);if(g.length===1){let m=g[0],y=new Lb;y.boundingData=r,TIe(o,m.offset,m.count,s),i(y,m.offset,m.count,s),v.push(y)}else for(let m of g){let y=new Lb;y.boundingData=new Float32Array(6),D2(o,m.offset,m.count,y.boundingData,s),i(y,m.offset,m.count,s),v.push(y)}return v}function OIe(t,e){let n=BIe(t,e),i,r,s,o=[],a=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let h=0;h<n.length;h++){let u=n[h],d=l(u),f=new a(32*d);i=new Float32Array(f),r=new Uint32Array(f),s=new Uint16Array(f),c(0,u),o.push(f)}return o;function l(h){return h.count?1:1+l(h.left)+l(h.right)}function c(h,u){let d=h/4,f=h/2,p=!!u.count,v=u.boundingData;for(let g=0;g<6;g++)i[d+g]=v[g];if(p){let g=u.offset,m=u.count;return r[d+6]=g,s[f+14]=m,s[f+15]=65535,h+32}else{let g=u.left,m=u.right,y=u.splitAxis,w;if(w=c(h+32,g),w/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return r[d+6]=w/4,w=c(w,m),r[d+7]=y,w}}}var uu=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(t,e){let n=1/0,i=-1/0;for(let r=0,s=t.length;r<s;r++){let o=t[r][e];n=o<n?o:n,i=o>i?o:i}this.min=n,this.max=i}setFromPoints(t,e){let n=1/0,i=-1/0;for(let r=0,s=e.length;r<s;r++){let o=e[r],a=t.dot(o);n=a<n?a:n,i=a>i?a:i}this.min=n,this.max=i}isSeparated(t){return this.min>t.max||t.min>this.max}};uu.prototype.setFromBox=function(){let t=new N;return function(e,n){let i=n.min,r=n.max,s=1/0,o=-1/0;for(let a=0;a<=1;a++)for(let l=0;l<=1;l++)for(let c=0;c<=1;c++){t.x=i.x*a+r.x*(1-a),t.y=i.y*l+r.y*(1-l),t.z=i.z*c+r.z*(1-c);let h=e.dot(t);s=Math.min(h,s),o=Math.max(h,o)}this.min=s,this.max=o}}();var FIe=function(){let t=new N,e=new N,n=new N;return function(i,r,s){let o=i.start,a=t,l=r.start,c=e;n.subVectors(o,l),t.subVectors(i.end,r.start),e.subVectors(r.end,r.start);let h=n.dot(c),u=c.dot(a),d=c.dot(c),f=n.dot(a),p=a.dot(a)*d-u*u,v,g;p!==0?v=(h*u-f*d)/p:v=0,g=(h+v*u)/d,s.x=v,s.y=g}}(),AF=function(){let t=new be,e=new N,n=new N;return function(i,r,s,o){FIe(i,r,t);let a=t.x,l=t.y;if(a>=0&&a<=1&&l>=0&&l<=1){i.at(a,s),r.at(l,o);return}else if(a>=0&&a<=1){l<0?r.at(0,o):r.at(1,o),i.closestPointToPoint(o,!0,s);return}else if(l>=0&&l<=1){a<0?i.at(0,s):i.at(1,s),r.closestPointToPoint(s,!0,o);return}else{let c;a<0?c=i.start:c=i.end;let h;l<0?h=r.start:h=r.end;let u=e,d=n;if(i.closestPointToPoint(h,!0,e),r.closestPointToPoint(c,!0,n),u.distanceToSquared(h)<=d.distanceToSquared(c)){s.copy(u),o.copy(h);return}else{s.copy(c),o.copy(d);return}}}}(),NIe=function(){let t=new N,e=new N,n=new no,i=new oa;return function(r,s){let{radius:o,center:a}=r,{a:l,b:c,c:h}=s;if(i.start=l,i.end=c,i.closestPointToPoint(a,!0,t).distanceTo(a)<=o||(i.start=l,i.end=h,i.closestPointToPoint(a,!0,t).distanceTo(a)<=o)||(i.start=c,i.end=h,i.closestPointToPoint(a,!0,t).distanceTo(a)<=o))return!0;let u=s.getPlane(n);if(Math.abs(u.distanceToPoint(a))<=o){let d=u.projectPoint(a,e);if(s.containsPoint(d))return!0}return!1}}(),UIe=1e-15;function rm(t){return Math.abs(t)<UIe}var hu=class extends Ds{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new N),this.satBounds=new Array(4).fill().map(()=>new uu),this.points=[this.a,this.b,this.c],this.sphere=new ha,this.plane=new no,this.needsUpdate=!0}intersectsSphere(e){return NIe(e,this)}update(){let e=this.a,n=this.b,i=this.c,r=this.points,s=this.satAxes,o=this.satBounds,a=s[0],l=o[0];this.getNormal(a),l.setFromPoints(a,r);let c=s[1],h=o[1];c.subVectors(e,n),h.setFromPoints(c,r);let u=s[2],d=o[2];u.subVectors(n,i),d.setFromPoints(u,r);let f=s[3],p=o[3];f.subVectors(i,e),p.setFromPoints(f,r),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,e),this.needsUpdate=!1}};hu.prototype.closestPointToSegment=function(){let t=new N,e=new N,n=new oa;return function(i,r=null,s=null){let{start:o,end:a}=i,l=this.points,c,h=1/0;for(let u=0;u<3;u++){let d=(u+1)%3;n.start.copy(l[u]),n.end.copy(l[d]),AF(n,i,t,e),c=t.distanceToSquared(e),c<h&&(h=c,r&&r.copy(t),s&&s.copy(e))}return this.closestPointToPoint(o,t),c=o.distanceToSquared(t),c<h&&(h=c,r&&r.copy(t),s&&s.copy(o)),this.closestPointToPoint(a,t),c=a.distanceToSquared(t),c<h&&(h=c,r&&r.copy(t),s&&s.copy(a)),Math.sqrt(h)}}();hu.prototype.intersectsTriangle=function(){let t=new hu,e=new Array(3),n=new Array(3),i=new uu,r=new uu,s=new N,o=new N,a=new N,l=new N,c=new oa,h=new oa,u=new oa;return function(d,f=null){this.needsUpdate&&this.update(),d.isExtendedTriangle?d.needsUpdate&&d.update():(t.copy(d),t.update(),d=t);let p=this.plane,v=d.plane;if(Math.abs(p.normal.dot(v.normal))>1-1e-10){let g=this.satBounds,m=this.satAxes;n[0]=d.a,n[1]=d.b,n[2]=d.c;for(let b=0;b<4;b++){let A=g[b],S=m[b];if(i.setFromPoints(S,n),A.isSeparated(i))return!1}let y=d.satBounds,w=d.satAxes;e[0]=this.a,e[1]=this.b,e[2]=this.c;for(let b=0;b<4;b++){let A=y[b],S=w[b];if(i.setFromPoints(S,e),A.isSeparated(i))return!1}for(let b=0;b<4;b++){let A=m[b];for(let S=0;S<4;S++){let T=w[S];if(s.crossVectors(A,T),i.setFromPoints(s,e),r.setFromPoints(s,n),i.isSeparated(r))return!1}}return f&&(console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),f.start.set(0,0,0),f.end.set(0,0,0)),!0}else{let g=this.points,m=!1,y=0;for(let F=0;F<3;F++){let B=g[F],k=g[(F+1)%3];c.start.copy(B),c.end.copy(k),c.delta(o);let j=m?h.start:h.end,Z=rm(v.distanceToPoint(B));if(rm(v.normal.dot(o))&&Z){h.copy(c),y=2;break}if((v.intersectLine(c,j)||Z)&&!rm(j.distanceTo(k))){if(y++,m)break;m=!0}}if(y===1&&this.containsPoint(h.start))return f&&(f.start.copy(h.start),f.end.copy(h.start)),!0;if(y!==2)return!1;let w=d.points,b=!1,A=0;for(let F=0;F<3;F++){let B=w[F],k=w[(F+1)%3];c.start.copy(B),c.end.copy(k),c.delta(a);let j=b?u.start:u.end,Z=rm(p.distanceToPoint(B));if(rm(p.normal.dot(a))&&Z){u.copy(c),A=2;break}if((p.intersectLine(c,j)||Z)&&!rm(j.distanceTo(k))){if(A++,b)break;b=!0}}if(A===1&&this.containsPoint(u.start))return f&&(f.start.copy(u.start),f.end.copy(u.start)),!0;if(A!==2)return!1;if(h.delta(o),u.delta(a),o.dot(a)<0){let F=u.start;u.start=u.end,u.end=F}let S=h.start.dot(o),T=h.end.dot(o),M=u.start.dot(o),E=u.end.dot(o),P=T<M,R=S<E;return S!==E&&M!==T&&P===R?!1:(f&&(l.subVectors(h.start,u.start),l.dot(o)>0?f.start.copy(h.start):f.start.copy(u.start),l.subVectors(h.end,u.end),l.dot(o)<0?f.end.copy(h.end):f.end.copy(u.end)),!0)}}}();hu.prototype.distanceToPoint=function(){let t=new N;return function(e){return this.closestPointToPoint(e,t),e.distanceTo(t)}}();hu.prototype.distanceToTriangle=function(){let t=new N,e=new N,n=["a","b","c"],i=new oa,r=new oa;return function(s,o=null,a=null){let l=o||a?i:null;if(this.intersectsTriangle(s,l))return(o||a)&&(o&&l.getCenter(o),a&&l.getCenter(a)),0;let c=1/0;for(let h=0;h<3;h++){let u,d=n[h],f=s[d];this.closestPointToPoint(f,t),u=f.distanceToSquared(t),u<c&&(c=u,o&&o.copy(t),a&&a.copy(f));let p=this[d];s.closestPointToPoint(p,t),u=p.distanceToSquared(t),u<c&&(c=u,o&&o.copy(p),a&&a.copy(t))}for(let h=0;h<3;h++){let u=n[h],d=n[(h+1)%3];i.set(this[u],this[d]);for(let f=0;f<3;f++){let p=n[f],v=n[(f+1)%3];r.set(s[p],s[v]),AF(i,r,t,e);let g=t.distanceToSquared(e);g<c&&(c=g,o&&o.copy(t),a&&a.copy(e))}}return Math.sqrt(c)}}();var rc=class extends ji{constructor(...e){super(...e),this.isOrientedBox=!0,this.matrix=new nt,this.invMatrix=new nt,this.points=new Array(8).fill().map(()=>new N),this.satAxes=new Array(3).fill().map(()=>new N),this.satBounds=new Array(3).fill().map(()=>new uu),this.alignedSatBounds=new Array(3).fill().map(()=>new uu),this.needsUpdate=!1}set(e,n,i){super.set(e,n),this.matrix.copy(i),this.needsUpdate=!0}copy(e){super.copy(e),this.matrix.copy(e.matrix),this.needsUpdate=!0}};rc.prototype.update=function(){return function(){let t=this.matrix,e=this.min,n=this.max,i=this.points;for(let l=0;l<=1;l++)for(let c=0;c<=1;c++)for(let h=0;h<=1;h++){let u=1*l|2*c|4*h,d=i[u];d.x=l?n.x:e.x,d.y=c?n.y:e.y,d.z=h?n.z:e.z,d.applyMatrix4(t)}let r=this.satBounds,s=this.satAxes,o=i[0];for(let l=0;l<3;l++){let c=s[l],h=r[l],u=1<<l,d=i[u];c.subVectors(o,d),h.setFromPoints(c,i)}let a=this.alignedSatBounds;a[0].setFromPointsField(i,"x"),a[1].setFromPointsField(i,"y"),a[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();rc.prototype.intersectsBox=function(){let t=new uu;return function(e){this.needsUpdate&&this.update();let n=e.min,i=e.max,r=this.satBounds,s=this.satAxes,o=this.alignedSatBounds;if(t.min=n.x,t.max=i.x,o[0].isSeparated(t)||(t.min=n.y,t.max=i.y,o[1].isSeparated(t))||(t.min=n.z,t.max=i.z,o[2].isSeparated(t)))return!1;for(let a=0;a<3;a++){let l=s[a],c=r[a];if(t.setFromBox(l,e),c.isSeparated(t))return!1}return!0}}();rc.prototype.intersectsTriangle=function(){let t=new hu,e=new Array(3),n=new uu,i=new uu,r=new N;return function(s){this.needsUpdate&&this.update(),s.isExtendedTriangle?s.needsUpdate&&s.update():(t.copy(s),t.update(),s=t);let o=this.satBounds,a=this.satAxes;e[0]=s.a,e[1]=s.b,e[2]=s.c;for(let u=0;u<3;u++){let d=o[u],f=a[u];if(n.setFromPoints(f,e),d.isSeparated(n))return!1}let l=s.satBounds,c=s.satAxes,h=this.points;for(let u=0;u<3;u++){let d=l[u],f=c[u];if(n.setFromPoints(f,h),d.isSeparated(n))return!1}for(let u=0;u<3;u++){let d=a[u];for(let f=0;f<4;f++){let p=c[f];if(r.crossVectors(d,p),n.setFromPoints(r,e),i.setFromPoints(r,h),n.isSeparated(i))return!1}}return!0}}();rc.prototype.closestPointToPoint=function(){return function(t,e){return this.needsUpdate&&this.update(),e.copy(t).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),e}}();rc.prototype.distanceToPoint=function(){let t=new N;return function(e){return this.closestPointToPoint(e,t),e.distanceTo(t)}}();rc.prototype.distanceToBox=function(){let t=["x","y","z"],e=new Array(12).fill().map(()=>new oa),n=new Array(12).fill().map(()=>new oa),i=new N,r=new N;return function(s,o=0,a=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(s))return(a||l)&&(s.getCenter(r),this.closestPointToPoint(r,i),s.closestPointToPoint(i,r),a&&a.copy(i),l&&l.copy(r)),0;let c=o*o,h=s.min,u=s.max,d=this.points,f=1/0;for(let v=0;v<8;v++){let g=d[v];r.copy(g).clamp(h,u);let m=g.distanceToSquared(r);if(m<f&&(f=m,a&&a.copy(g),l&&l.copy(r),m<c))return Math.sqrt(m)}let p=0;for(let v=0;v<3;v++)for(let g=0;g<=1;g++)for(let m=0;m<=1;m++){let y=(v+1)%3,w=(v+2)%3,b=g<<y|m<<w,A=1<<v|g<<y|m<<w,S=d[b],T=d[A];e[p].set(S,T);let M=t[v],E=t[y],P=t[w],R=n[p],F=R.start,B=R.end;F[M]=h[M],F[E]=g?h[E]:u[E],F[P]=m?h[P]:u[E],B[M]=u[M],B[E]=g?h[E]:u[E],B[P]=m?h[P]:u[E],p++}for(let v=0;v<=1;v++)for(let g=0;g<=1;g++)for(let m=0;m<=1;m++){r.x=v?u.x:h.x,r.y=g?u.y:h.y,r.z=m?u.z:h.z,this.closestPointToPoint(r,i);let y=r.distanceToSquared(i);if(y<f&&(f=y,a&&a.copy(i),l&&l.copy(r),y<c))return Math.sqrt(y)}for(let v=0;v<12;v++){let g=e[v];for(let m=0;m<12;m++){let y=n[m];AF(g,y,i,r);let w=i.distanceToSquared(r);if(w<f&&(f=w,a&&a.copy(i),l&&l.copy(r),w<c))return Math.sqrt(w)}}return Math.sqrt(f)}}();var Ob=new N,Fb=new N,Nb=new N,Pj=new be,Dj=new be,Rj=new be,Lj=new N;function kIe(t,e,n,i,r,s){let o;return s===xr?o=t.intersectTriangle(i,n,e,!0,r):o=t.intersectTriangle(e,n,i,s!==co,r),o===null?null:{distance:t.origin.distanceTo(r),point:r.clone()}}function zIe(t,e,n,i,r,s,o){Ob.fromBufferAttribute(e,i),Fb.fromBufferAttribute(e,r),Nb.fromBufferAttribute(e,s);let a=kIe(t,Ob,Fb,Nb,Lj,o);if(a){n&&(Pj.fromBufferAttribute(n,i),Dj.fromBufferAttribute(n,r),Rj.fromBufferAttribute(n,s),a.uv=Ds.getUV(Lj,Ob,Fb,Nb,Pj,Dj,Rj,new be));let l={a:i,b:r,c:s,normal:new N,materialIndex:0};Ds.getNormal(Ob,Fb,Nb,l.normal),a.face=l,a.faceIndex=i}return a}function zJ(t,e,n,i,r){let s=i*3,o=t.index.getX(s),a=t.index.getX(s+1),l=t.index.getX(s+2),c=zIe(n,t.attributes.position,t.attributes.uv,o,a,l,e);return c?(c.faceIndex=i,r&&r.push(c),c):null}function GIe(t,e,n,i,r,s){for(let o=i,a=i+r;o<a;o++)zJ(t,e,n,o,s)}function HIe(t,e,n,i,r){let s=1/0,o=null;for(let a=i,l=i+r;a<l;a++){let c=zJ(t,e,n,a);c&&c.distance<s&&(o=c,s=c.distance)}return o}function GJ(t,e,n){return t===null||(t.point.applyMatrix4(e.matrixWorld),t.distance=t.point.distanceTo(n.ray.origin),t.object=e,t.distance<n.near||t.distance>n.far)?null:t}function Bl(t,e,n,i){let r=t.a,s=t.b,o=t.c,a=e,l=e+1,c=e+2;n&&(a=n.getX(e),l=n.getX(e+1),c=n.getX(e+2)),r.x=i.getX(a),r.y=i.getY(a),r.z=i.getZ(a),s.x=i.getX(l),s.y=i.getY(l),s.z=i.getZ(l),o.x=i.getX(c),o.y=i.getY(c),o.z=i.getZ(c)}function Ij(t,e,n,i,r,s,o){let a=n.index,l=n.attributes.position;for(let c=t,h=e+t;c<h;c++)if(Bl(o,c*3,a,l),o.needsUpdate=!0,i(o,c,r,s))return!0;return!1}var HJ=class{constructor(t){this._getNewPrimitive=t,this._primitives=[]}getPrimitive(){let t=this._primitives;return t.length===0?this._getNewPrimitive():t.pop()}releasePrimitive(t){this._primitives.push(t)}};function ah(t,e){return e[t+15]===65535}function vg(t,e){return e[t+6]}function Wx(t,e){return e[t+14]}function Xx(t){return t+8}function Yx(t,e){return e[t+6]}function VIe(t,e){return e[t+7]}var Km=new ji,hM=new N,jIe=["x","y","z"];function CI(t,e,n,i,r){let s=t*2,o=Tv,a=Fh,l=Nh;if(ah(s,a)){let c=vg(t,l),h=Wx(s,a);GIe(e,n,i,c,h,r)}else{let c=Xx(t);dM(c,o,i,hM)&&CI(c,e,n,i,r);let h=Yx(t,l);dM(h,o,i,hM)&&CI(h,e,n,i,r)}}function TI(t,e,n,i){let r=t*2,s=Tv,o=Fh,a=Nh;if(ah(r,o)){let l=vg(t,a),c=Wx(r,o);return HIe(e,n,i,l,c)}else{let l=VIe(t,a),c=jIe[l],h=i.direction[c]>=0,u,d;h?(u=Xx(t),d=Yx(t,a)):(u=Yx(t,a),d=Xx(t));let f=dM(u,s,i,hM)?TI(u,e,n,i):null;if(f){let v=f.point[c];if(h?v<=s[d+l]:v>=s[d+l+3])return f}let p=dM(d,s,i,hM)?TI(d,e,n,i):null;return f&&p?f.distance<=p.distance?f:p:f||p||null}}var WIe=function(){let t,e,n=[],i=new HJ(()=>new ji);return function(...s){t=i.getPrimitive(),e=i.getPrimitive(),n.push(t,e);let o=r(...s);i.releasePrimitive(t),i.releasePrimitive(e),n.pop(),n.pop();let a=n.length;return a>0&&(e=n[a-1],t=n[a-2]),o};function r(s,o,a,l,c=null,h=0,u=0){function d(y){let w=y*2,b=Fh,A=Nh;for(;!ah(w,b);)y=Xx(y),w=y*2;return vg(y,A)}function f(y){let w=y*2,b=Fh,A=Nh;for(;!ah(w,b);)y=Yx(y,A),w=y*2;return vg(y,A)+Wx(w,b)}let p=s*2,v=Tv,g=Fh,m=Nh;if(ah(p,g)){let y=vg(s,m),w=Wx(p,g);return Ul(s,v,t),l(y,w,!1,u,h+s,t)}else{let y=Xx(s),w=Yx(s,m),b=y,A=w,S,T,M,E;if(c&&(M=t,E=e,Ul(b,v,M),Ul(A,v,E),S=c(M),T=c(E),T<S)){b=w,A=y;let Z=S;S=T,T=Z,M=E}M||(M=t,Ul(b,v,M));let P=ah(b*2,g),R=a(M,P,S,u+1,h+b),F;if(R===2){let Z=d(b),ee=f(b)-Z;F=l(Z,ee,!0,u+1,h+b,M)}else F=R&&r(b,o,a,l,c,h,u+1);if(F)return!0;E=e,Ul(A,v,E);let B=ah(A*2,g),k=a(E,B,T,u+1,h+A),j;if(k===2){let Z=d(A),ee=f(A)-Z;j=l(Z,ee,!0,u+1,h+A,E)}else j=k&&r(A,o,a,l,c,h,u+1);return!!j}}}(),XIe=function(){let t=new hu,e=new hu,n=new nt,i=new rc,r=new rc;return function s(o,a,l,c,h=null){let u=o*2,d=Tv,f=Fh,p=Nh;if(h===null&&(l.boundingBox||l.computeBoundingBox(),i.set(l.boundingBox.min,l.boundingBox.max,c),h=i),ah(u,f)){let v=a,g=v.index,m=v.attributes.position,y=l.index,w=l.attributes.position,b=vg(o,p),A=Wx(u,f);if(n.copy(c).invert(),l.boundsTree)return Ul(o,d,r),r.matrix.copy(n),r.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:S=>r.intersectsBox(S),intersectsTriangle:S=>{S.a.applyMatrix4(c),S.b.applyMatrix4(c),S.c.applyMatrix4(c),S.needsUpdate=!0;for(let T=b*3,M=(A+b)*3;T<M;T+=3)if(Bl(e,T,g,m),e.needsUpdate=!0,S.intersectsTriangle(e))return!0;return!1}});for(let S=b*3,T=A+b*3;S<T;S+=3){Bl(t,S,g,m),t.a.applyMatrix4(n),t.b.applyMatrix4(n),t.c.applyMatrix4(n),t.needsUpdate=!0;for(let M=0,E=y.count;M<E;M+=3)if(Bl(e,M,y,w),e.needsUpdate=!0,t.intersectsTriangle(e))return!0}}else{let v=o+8,g=p[o+6];return Ul(v,d,Km),!!(h.intersectsBox(Km)&&s(v,a,l,c,h)||(Ul(g,d,Km),h.intersectsBox(Km)&&s(g,a,l,c,h)))}}}();function dM(t,e,n,i){return Ul(t,e,Km),n.intersectBox(Km,i)}var PI=[],zS,Tv,Fh,Nh;function cy(t){zS&&PI.push(zS),zS=t,Tv=new Float32Array(t),Fh=new Uint16Array(t),Nh=new Uint32Array(t)}function Ub(){zS=null,Tv=null,Fh=null,Nh=null,PI.length&&cy(PI.pop())}var R2=Symbol("skip tree generation"),L2=new ji,I2=new ji,sm=new nt,Rd=new rc,B0=new rc,O0=new N,kb=new N,YIe=new N,qIe=new N,QIe=new N,Bj=new ji,wl=new HJ(()=>new hu),Or=class{static serialize(t,e={}){if(e.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),Or.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});e={cloneBuffers:!0,...e};let n=t.geometry,i=t._roots,r=n.getIndex(),s;return e.cloneBuffers?s={roots:i.map(o=>o.slice()),index:r.array.slice()}:s={roots:i,index:r.array},s}static deserialize(t,e,n={}){if(typeof n=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),Or.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});n={setIndex:!0,...n};let{index:i,roots:r}=t,s=new Or(e,{...n,[R2]:!0});if(s._roots=r,n.setIndex){let o=e.getIndex();if(o===null){let a=new Ut(t.index,1,!1);e.setIndex(a)}else o.array!==i&&(o.array.set(i),o.needsUpdate=!0)}return s}constructor(t,e={}){if(t.isBufferGeometry){if(t.index&&t.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[R2]:!1},e),e.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,e[R2]||(this._roots=OIe(t,e),!t.boundingBox&&e.setBoundingBox&&(t.boundingBox=this.getBoundingBox(new ji))),this.geometry=t}refit(t=null){t&&Array.isArray(t)&&(t=new Set(t));let e=this.geometry,n=e.index.array,i=e.attributes.position,r=i.array,s=i.offset||0,o=3;i.isInterleavedBufferAttribute&&(o=i.data.stride);let a,l,c,h,u=0,d=this._roots;for(let p=0,v=d.length;p<v;p++)a=d[p],l=new Uint32Array(a),c=new Uint16Array(a),h=new Float32Array(a),f(0,u),u+=a.byteLength;function f(p,v,g=!1){let m=p*2;if(c[m+15]===65535){let y=l[p+6],w=c[m+14],b=1/0,A=1/0,S=1/0,T=-1/0,M=-1/0,E=-1/0;for(let P=3*y,R=3*(y+w);P<R;P++){let F=n[P]*o+s,B=r[F+0],k=r[F+1],j=r[F+2];B<b&&(b=B),B>T&&(T=B),k<A&&(A=k),k>M&&(M=k),j<S&&(S=j),j>E&&(E=j)}return h[p+0]!==b||h[p+1]!==A||h[p+2]!==S||h[p+3]!==T||h[p+4]!==M||h[p+5]!==E?(h[p+0]=b,h[p+1]=A,h[p+2]=S,h[p+3]=T,h[p+4]=M,h[p+5]=E,!0):!1}else{let y=p+8,w=l[p+6],b=y+v,A=w+v,S=g,T=!1,M=!1;t?S||(T=t.has(b),M=t.has(A),S=!T&&!M):(T=!0,M=!0);let E=S||T,P=S||M,R=!1;E&&(R=f(y,v,S));let F=!1;P&&(F=f(w,v,S));let B=R||F;if(B)for(let k=0;k<3;k++){let j=y+k,Z=w+k,ee=h[j],O=h[j+3],W=h[Z],H=h[Z+3];h[p+k]=ee<W?ee:W,h[p+k+3]=O>H?O:H}return B}}}traverse(t,e=0){let n=this._roots[e],i=new Uint32Array(n),r=new Uint16Array(n);s(0);function s(o,a=0){let l=o*2,c=r[l+15]===65535;if(c){let h=i[o+6],u=r[l+14];t(a,c,new Float32Array(n,o*4,6),h,u)}else{let h=o+8,u=i[o+6],d=i[o+7];t(a,c,new Float32Array(n,o*4,6),d)||(s(h,a+1),s(u,a+1))}}}raycast(t,e=el){let n=this._roots,i=this.geometry,r=[],s=e.isMaterial,o=Array.isArray(e),a=i.groups,l=s?e.side:e;for(let c=0,h=n.length;c<h;c++){let u=o?e[a[c].materialIndex].side:l,d=r.length;if(cy(n[c]),CI(0,i,u,t,r),Ub(),o){let f=a[c].materialIndex;for(let p=d,v=r.length;p<v;p++)r[p].face.materialIndex=f}}return r}raycastFirst(t,e=el){let n=this._roots,i=this.geometry,r=e.isMaterial,s=Array.isArray(e),o=null,a=i.groups,l=r?e.side:e;for(let c=0,h=n.length;c<h;c++){let u=s?e[a[c].materialIndex].side:l;cy(n[c]);let d=TI(0,i,u,t);Ub(),d!=null&&(o==null||d.distance<o.distance)&&(o=d,s&&(d.face.materialIndex=a[c].materialIndex))}return o}intersectsGeometry(t,e){let n=this.geometry,i=!1;for(let r of this._roots)if(cy(r),i=XIe(0,n,t,e),Ub(),i)break;return i}shapecast(t,e,n){let i=this.geometry;if(t instanceof Function){if(e){let u=e;e=(d,f,p,v)=>{let g=f*3;return u(d,g,g+1,g+2,p,v)}}t={boundsTraverseOrder:n,intersectsBounds:t,intersectsTriangle:e,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let r=wl.getPrimitive(),{boundsTraverseOrder:s,intersectsBounds:o,intersectsRange:a,intersectsTriangle:l}=t;if(a&&l){let u=a;a=(d,f,p,v,g)=>u(d,f,p,v,g)?!0:Ij(d,f,i,l,p,v,r)}else a||(l?a=(u,d,f,p)=>Ij(u,d,i,l,f,p,r):a=(u,d,f)=>f);let c=!1,h=0;for(let u of this._roots){if(cy(u),c=WIe(0,i,o,a,s,h),Ub(),c)break;h+=u.byteLength}return wl.releasePrimitive(r),c}bvhcast(t,e,n){let{intersectsRanges:i,intersectsTriangles:r}=n,s=this.geometry.index,o=this.geometry.attributes.position,a=t.geometry.index,l=t.geometry.attributes.position;sm.copy(e).invert();let c=wl.getPrimitive(),h=wl.getPrimitive();if(r){let d=function(f,p,v,g,m,y,w,b){for(let A=v,S=v+g;A<S;A++){Bl(h,A*3,a,l),h.a.applyMatrix4(e),h.b.applyMatrix4(e),h.c.applyMatrix4(e),h.needsUpdate=!0;for(let T=f,M=f+p;T<M;T++)if(Bl(c,T*3,s,o),c.needsUpdate=!0,r(c,h,T,A,m,y,w,b))return!0}return!1};if(i){let f=i;i=function(p,v,g,m,y,w,b,A){return f(p,v,g,m,y,w,b,A)?!0:d(p,v,g,m,y,w,b,A)}}else i=d}t.getBoundingBox(I2),I2.applyMatrix4(e);let u=this.shapecast({intersectsBounds:d=>I2.intersectsBox(d),intersectsRange:(d,f,p,v,g,m)=>(L2.copy(m),L2.applyMatrix4(sm),t.shapecast({intersectsBounds:y=>L2.intersectsBox(y),intersectsRange:(y,w,b,A,S)=>i(d,f,y,w,v,g,A,S)}))});return wl.releasePrimitive(c),wl.releasePrimitive(h),u}intersectsBox(t,e){return Rd.set(t.min,t.max,e),Rd.needsUpdate=!0,this.shapecast({intersectsBounds:n=>Rd.intersectsBox(n),intersectsTriangle:n=>Rd.intersectsTriangle(n)})}intersectsSphere(t){return this.shapecast({intersectsBounds:e=>t.intersectsBox(e),intersectsTriangle:e=>e.intersectsSphere(t)})}closestPointToGeometry(t,e,n={},i={},r=0,s=1/0){t.boundingBox||t.computeBoundingBox(),Rd.set(t.boundingBox.min,t.boundingBox.max,e),Rd.needsUpdate=!0;let o=this.geometry,a=o.attributes.position,l=o.index,c=t.attributes.position,h=t.index,u=wl.getPrimitive(),d=wl.getPrimitive(),f=kb,p=YIe,v=null,g=null;i&&(v=qIe,g=QIe);let m=1/0,y=null,w=null;return sm.copy(e).invert(),B0.matrix.copy(sm),this.shapecast({boundsTraverseOrder:b=>Rd.distanceToBox(b),intersectsBounds:(b,A,S)=>S<m&&S<s?(A&&(B0.min.copy(b.min),B0.max.copy(b.max),B0.needsUpdate=!0),!0):!1,intersectsRange:(b,A)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:S=>B0.distanceToBox(S),intersectsBounds:(S,T,M)=>M<m&&M<s,intersectsRange:(S,T)=>{for(let M=S*3,E=(S+T)*3;M<E;M+=3){Bl(d,M,h,c),d.a.applyMatrix4(e),d.b.applyMatrix4(e),d.c.applyMatrix4(e),d.needsUpdate=!0;for(let P=b*3,R=(b+A)*3;P<R;P+=3){Bl(u,P,l,a),u.needsUpdate=!0;let F=u.distanceToTriangle(d,f,v);if(F<m&&(p.copy(f),g&&g.copy(v),m=F,y=P/3,w=M/3),F<r)return!0}}}});{let S=h?h.count:c.count;for(let T=0,M=S;T<M;T+=3){Bl(d,T,h,c),d.a.applyMatrix4(e),d.b.applyMatrix4(e),d.c.applyMatrix4(e),d.needsUpdate=!0;for(let E=b*3,P=(b+A)*3;E<P;E+=3){Bl(u,E,l,a),u.needsUpdate=!0;let R=u.distanceToTriangle(d,f,v);if(R<m&&(p.copy(f),g&&g.copy(v),m=R,y=E/3,w=T/3),R<r)return!0}}}}}),wl.releasePrimitive(u),wl.releasePrimitive(d),m===1/0?null:(n.point?n.point.copy(p):n.point=p.clone(),n.distance=m,n.faceIndex=y,i&&(i.point?i.point.copy(g):i.point=g.clone(),i.point.applyMatrix4(sm),p.applyMatrix4(sm),i.distance=p.sub(i.point).length(),i.faceIndex=w),n)}closestPointToPoint(t,e={},n=0,i=1/0){let r=n*n,s=i*i,o=1/0,a=null;if(this.shapecast({boundsTraverseOrder:c=>(O0.copy(t).clamp(c.min,c.max),O0.distanceToSquared(t)),intersectsBounds:(c,h,u)=>u<o&&u<s,intersectsTriangle:(c,h)=>{c.closestPointToPoint(t,O0);let u=t.distanceToSquared(O0);return u<o&&(kb.copy(O0),o=u,a=h),u<r}}),o===1/0)return null;let l=Math.sqrt(o);return e.point?e.point.copy(kb):e.point=kb.clone(),e.distance=l,e.faceIndex=a,e}getBoundingBox(t){return t.makeEmpty(),this._roots.forEach(e=>{Ul(0,new Float32Array(e),Bj),t.union(Bj)}),t}},Oj=Or.prototype.raycast;Or.prototype.raycast=function(...t){if(t[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "raycast" has changed. See docs for new signature.');let[e,n,i,r]=t;return Oj.call(this,i,e.material).forEach(s=>{s=GJ(s,e,n),s&&r.push(s)}),r}else return Oj.apply(this,t)};var Fj=Or.prototype.raycastFirst;Or.prototype.raycastFirst=function(...t){if(t[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "raycastFirst" has changed. See docs for new signature.');let[e,n,i]=t;return GJ(Fj.call(this,i,e.material),e,n)}else return Fj.apply(this,t)};var Nj=Or.prototype.closestPointToPoint;Or.prototype.closestPointToPoint=function(...t){if(t[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "closestPointToPoint" has changed. See docs for new signature.'),t.unshift();let e=t[1],n={};return t[1]=n,Nj.apply(this,t),e&&e.copy(n.point),n.distance}else return Nj.apply(this,t)};var Uj=Or.prototype.closestPointToGeometry;Or.prototype.closestPointToGeometry=function(...t){let e=t[2],n=t[3];if(e&&e.isVector3||n&&n.isVector3){console.warn('MeshBVH: The function signature and results frame for "closestPointToGeometry" has changed. See docs for new signature.');let i={},r={},s=t[1];return t[2]=i,t[3]=r,Uj.apply(this,t),e&&e.copy(i.point),n&&n.copy(r.point).applyMatrix4(s),i.distance}else return Uj.apply(this,t)};var kj=Or.prototype.refit;Or.prototype.refit=function(...t){let e=t[0],n=t[1];if(n&&(n instanceof Set||Array.isArray(n))){console.warn('MeshBVH: The function signature for "refit" has changed. See docs for new signature.');let i=new Set;n.forEach(r=>i.add(r)),e&&e.forEach(r=>i.add(r)),kj.call(this,i)}else kj.apply(this,t)};["intersectsGeometry","shapecast","intersectsBox","intersectsSphere"].forEach(t=>{let e=Or.prototype[t];Or.prototype[t]=function(...n){return(n[0]===null||n[0].isMesh)&&(n.shift(),console.warn(`MeshBVH: The function signature for "${t}" has changed and no longer takes Mesh. See docs for new signature.`)),e.apply(this,n)}});var F0=B1(Yye()),KIe=.5*(Math.sqrt(3)-1),N0=(3-Math.sqrt(3))/6,JIe=1/3,_l=1/6,ky=t=>Math.floor(t)|0,zj=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),B2=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function O2(t=Math.random){let e=VJ(t),n=new Float64Array(e).map(r=>zj[r%12*2]),i=new Float64Array(e).map(r=>zj[r%12*2+1]);return function(r,s){let o=0,a=0,l=0,c=(r+s)*KIe,h=ky(r+c),u=ky(s+c),d=(h+u)*N0,f=h-d,p=u-d,v=r-f,g=s-p,m,y;v>g?(m=1,y=0):(m=0,y=1);let w=v-m+N0,b=g-y+N0,A=v-1+2*N0,S=g-1+2*N0,T=h&255,M=u&255,E=.5-v*v-g*g;if(E>=0){let F=T+e[M],B=n[F],k=i[F];E*=E,o=E*E*(B*v+k*g)}let P=.5-w*w-b*b;if(P>=0){let F=T+m+e[M+y],B=n[F],k=i[F];P*=P,a=P*P*(B*w+k*b)}let R=.5-A*A-S*S;if(R>=0){let F=T+1+e[M+1],B=n[F],k=i[F];R*=R,l=R*R*(B*A+k*S)}return 70*(o+a+l)}}function ZIe(t=Math.random){let e=VJ(t),n=new Float64Array(e).map(s=>B2[s%12*3]),i=new Float64Array(e).map(s=>B2[s%12*3+1]),r=new Float64Array(e).map(s=>B2[s%12*3+2]);return function(s,o,a){let l,c,h,u,d=(s+o+a)*JIe,f=ky(s+d),p=ky(o+d),v=ky(a+d),g=(f+p+v)*_l,m=f-g,y=p-g,w=v-g,b=s-m,A=o-y,S=a-w,T,M,E,P,R,F;b>=A?A>=S?(T=1,M=0,E=0,P=1,R=1,F=0):b>=S?(T=1,M=0,E=0,P=1,R=0,F=1):(T=0,M=0,E=1,P=1,R=0,F=1):A<S?(T=0,M=0,E=1,P=0,R=1,F=1):b<S?(T=0,M=1,E=0,P=0,R=1,F=1):(T=0,M=1,E=0,P=1,R=1,F=0);let B=b-T+_l,k=A-M+_l,j=S-E+_l,Z=b-P+2*_l,ee=A-R+2*_l,O=S-F+2*_l,W=b-1+3*_l,H=A-1+3*_l,Y=S-1+3*_l,z=f&255,X=p&255,q=v&255,re=.6-b*b-A*A-S*S;if(re<0)l=0;else{let ve=z+e[X+e[q]];re*=re,l=re*re*(n[ve]*b+i[ve]*A+r[ve]*S)}let G=.6-B*B-k*k-j*j;if(G<0)c=0;else{let ve=z+T+e[X+M+e[q+E]];G*=G,c=G*G*(n[ve]*B+i[ve]*k+r[ve]*j)}let K=.6-Z*Z-ee*ee-O*O;if(K<0)h=0;else{let ve=z+P+e[X+R+e[q+F]];K*=K,h=K*K*(n[ve]*Z+i[ve]*ee+r[ve]*O)}let oe=.6-W*W-H*H-Y*Y;if(oe<0)u=0;else{let ve=z+1+e[X+1+e[q+1]];oe*=oe,u=oe*oe*(n[ve]*W+i[ve]*H+r[ve]*Y)}return 32*(l+c+h+u)}}function VJ(t){let e=new Uint8Array(512);for(let n=0;n<512/2;n++)e[n]=n;for(let n=0;n<512/2-1;n++){let i=n+~~(t()*(256-n)),r=e[n];e[n]=e[i],e[i]=r}for(let n=256;n<512;n++)e[n]=e[n-256];return e}var Ta=new Ds,$Ie=class{constructor(t){this.weightAttribute=null;let e=t.geometry;if(!e.isBufferGeometry||e.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");e.index&&(e=e.toNonIndexed()),this.geometry=e,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let t=this.positionAttribute,e=new Float32Array(t.count/3);for(let i=0;i<t.count;i+=3){let r=1;Ta.a.fromBufferAttribute(t,i),Ta.b.fromBufferAttribute(t,i+1),Ta.c.fromBufferAttribute(t,i+2),r*=Ta.getArea(),e[i/3]=r}this.distribution=new Float32Array(t.count/3);let n=0;for(let i=0;i<e.length;i++)n+=e[i],this.distribution[i]=n;return this}setRandomGenerator(t){return this.randomFunction=t,this}sample(t,e){if(this.distribution){let n=this.distribution[this.distribution.length-1],i=this.binarySearch(this.randomFunction()*n);return this.sampleFace(i,t,e)}}binarySearch(t){if(!this.distribution)return 0;let e=this.distribution,n=0,i=e.length-1,r=-1;for(;n<=i;){let s=Math.ceil((n+i)/2);if(s===0||e[s-1]<=t&&e[s]>t){r=s;break}else t<e[s]?i=s-1:n=s+1}return r}sampleFace(t,e,n){let i=this.randomFunction(),r=this.randomFunction();return i+r>1&&(i=1-i,r=1-r),Ta.a.fromBufferAttribute(this.positionAttribute,t*3),Ta.b.fromBufferAttribute(this.positionAttribute,t*3+1),Ta.c.fromBufferAttribute(this.positionAttribute,t*3+2),e.set(0,0,0).addScaledVector(Ta.a,i).addScaledVector(Ta.b,r).addScaledVector(Ta.c,1-(i+r)),Ta.getNormal(n),this}},e3e=B1(zQ()),t3e=new nt,n3e=new nt,i3e=new nt,fM;(t=>{function e(n){return n&&n.__isSPEObject}t.is=e})(fM||(fM={}));var MF=t=>class extends t{constructor(){super(...arguments),this.hiddenMatrix=new nt,this.matrixWorldRigid=new nt,this.shearScale=new nt,this.shearScaleInv=new nt}get __isSPEObject(){return!0}isDescendantOf(e){e instanceof Nn&&(e=e.uuid);let n=this;for(;n.parent;){if(n.parent.uuid===e)return!0;n=n.parent}return!1}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);for(let n of this.children)n.updateMatrixWorld(e)}updateWorldMatrix(e,n){let i=this.parent;if(e&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),n)for(let r of this.children)r.updateWorldMatrix(!1,!0)}traverseObject(e,n=0){if(e(this,n)!==!0)for(let i of this.children)fM.is(i)&&i.traverseObject(e,n+1)}updateMatrixWorldSVD(){let e=this.matrixWorld.elements,n=[[e[0],e[4],e[8]],[e[1],e[5],e[9]],[e[2],e[6],e[10]]],{u:i,v:r,q:s}=(0,e3e.SVD)(n),o=t3e.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),a=n3e.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),l=i3e.copy(a).transpose();this.shearScale.makeScale(s[0],s[1],s[2]).multiply(l).premultiply(a),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(o,l).copyPosition(this.matrixWorld),s.every(c=>Math.abs(s[0]-c)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(e,n){this.updateWorldMatrix(!0,!1);let i=new nt().copy(this.matrixWorld).invert();return e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),i.multiply(e.parent.matrixWorld)),"hiddenMatrix"in e&&e.hiddenMatrix instanceof nt?e.hiddenMatrix.premultiply(i):e.applyMatrix4(i),e.updateWorldMatrix(!1,!1),this.add(e),n!==void 0&&(this.children.pop(),this.children.splice(n,0,e)),this}copy(e,n=!1){return super.copy(e,n),this.hasNonUniformScale=e.hasNonUniformScale,this}},r3e=class extends MF(Nn){},s3e=t=>t.type==="Mesh",zl=class extends r3e{constructor(t){super(),this.object=t,this.matrixAutoUpdate=!1}expand(){let t=0,e=this.object.entityChildren(t);for(;e;){let n=this.children[t];(n==null?void 0:n.object)!==e&&(n&&this.remove(n),n=new zl(e),this.add(n),this.children.splice(t,0,this.children.pop()),n.matrixWorldNeedsUpdate=!0,n.matrixAutoUpdate=!1,n.matrix=e.matrix,n.hiddenMatrix=e.hiddenMatrix),n.expand(),t+=1,e=this.object.entityChildren(t)}for(;this.children.length>t;)this.remove(this.children[t])}get visible(){var t;return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&((t=this.object.dataPatched.cloner)==null?void 0:t.hideBase)===!0}set visible(t){}get castShadow(){return this.object.castShadow}set castShadow(t){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(t){}get isMesh(){return s3e(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(t){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},qd=new N,Qd=new N,yg=new nt,jJ=[new N(-1,1,1),new N(-1,-1,1),new N(1,-1,1),new N(1,1,1),new N(-1,1,-1),new N(-1,-1,-1),new N(1,-1,-1),new N(1,1,-1)],o3e=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],a3e=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],Gj=(t,e,n)=>{t.updateEntityBoxSize(qd,Qd),yg.copy(e).multiply(t.matrixWorld),Qd.x===0&&Qd.y===0&&Qd.z===0?n.push(new N(qd.x,qd.y,qd.z).applyMatrix4(yg)):jJ.forEach(i=>{n.push(i.clone().multiply(Qd).add(qd).applyMatrix4(yg))})},Hj=class extends ji{constructor(){super(...arguments),this.matrix=new nt,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(t){return super.copy(t),this.matrix.copy(t.matrix),this.vertices=t.vertices.map(e=>e.clone()),this.faces=t.faces.map(e=>e.clone()),this.edges=t.edges.map(e=>e.clone()),this.centerEdges=t.centerEdges.map(e=>e.clone()),this}setFromObjectSize(t,e=!1){t.updateWorldMatrix(!1,e),this.makeEmpty(),this.matrix.copy(t.matrixWorld);let n=new nt().copy(t.matrixWorld).invert();return this.expandByObjectSize(t,n,e)}expandByObjectSize(t,e,n=!1){let i=[];return n===!0?t.traverseEntity(r=>{(r.visible||r.cloner&&r.data.visible)&&Gj(r,e,i)}):Gj(t,e,i),this.setFromPoints(i)}getCenter(t){return t=super.getCenter(t),t.applyMatrix4(this.matrix),t}getPositionToCenter(t){return t=super.getCenter(t),t.applyMatrix4(yg.copy(this.matrix).setPosition(0,0,0)),t}computeVertices(){this.getSize(Qd).multiplyScalar(.5),this.getCenter(qd),yg.copy(this.matrix).setPosition(qd),this.vertices=jJ.map(t=>t.clone().multiply(Qd).applyMatrix4(yg))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=o3e.map(([t,e])=>new oa(this.vertices[t],this.vertices[e])),this.centerEdges=this.edges.map(t=>t.getCenter(new N))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=a3e.map(([t,e])=>this.vertices[t].clone().add(this.vertices[e]).multiplyScalar(.5))}},yh={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},l3e=class extends uK{constructor(){super()}getPoints(t=12){let e=[],n,i=this.getCurveLengths(),r=i[i.length-1]/i.length;for(let s=0,o=this.curves;s<o.length;s++){let a=o[s],l=s===0?i[s]:i[s]-i[s-1],c=Math.ceil(t*l/r),h=a.getPoints(c);for(let u=0;u<h.length;u++){let d=h[u];n&&n.equals(d)||(e.push(d),n=d)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}},DI=.001;function RI(t,e,n){return e.clone().sub(t).cross(e.clone().sub(n)).length()<=DI}function F2(t,e){let n=new N(...t.position),i=new N(...t.controlNext.position),r=new N(...e.controlPrevious.position),s=new N(...e.position);return RI(n,i,s)&&RI(n,r,s)}function WJ(t){let e=t.points.map(h=>new N(...h.data.position)),n=[t.points[0]],i=new N(...n[0].data.position);for(let h=0;h<t.points.length-1;h++)RI(i,e[h],e[h+1])||(n.push(t.points[h]),i=e[h]);n.push(t.points[t.points.length-1]);let r=t.isClosed,s=n.length-(r?0:1),o=n.length,a=[];for(let h=0;h<o;h++){let u=n[h].data,d=new N(...u.position),f=new N(...u.controlPrevious.position),p=new N(...u.controlNext.position),v={position:d,baseRoundness:u.roundness,controlPrevious:f,controlNext:p};if(u.roundness===0||!t.isClosed&&(h===0||h===o-1)){a[h]={...v,removedLength:0};continue}let g=r&&h==0?o-1:h-1,m=r&&h==o-1?0:h+1,y=n[g].data,w=n[m].data,b=new N(...y.position),A=new N(...w.position),S=b.clone().sub(d).normalize(),T=A.clone().sub(d).normalize();Object.assign(v,{prevDir:S,nextDir:T});let M=F2(y,u),E=F2(u,w);if(!M||!E)a[h]={...v,removedLength:0};else{let P=S.clone().add(T).normalize(),R=P.clone().cross(S).length()/S.dot(P);a[h]={...v,tan:R,removedLength:u.roundness/R}}}for(let h=0;h<s;h++){let u=h,d=r&&h===o-1?0:h+1,f=a[u],p=a[d];if(f.removedLength!==0||p.removedLength!==0){let v=f.position.distanceTo(p.position);f.removedLength=Math.min(f.removedLength,v/2),p.removedLength=Math.min(p.removedLength,v/2)}}let l=[];for(let h=0;h<s;h++){let u=h,d=r&&h===o-1?0:h+1,f=a[u],p=a[d],v=null;if(!F2(n[u].data,n[d].data))f.position.distanceTo(p.position)>DI&&(v=new IS(f.position,f.controlNext,p.controlPrevious,p.position));else{let g=f.position.clone(),m=p.position.clone();(f.removedLength!==0||p.removedLength!==0)&&(f.nextDir&&g.add(f.nextDir.clone().setLength(f.removedLength)),p.prevDir&&m.add(p.prevDir.clone().setLength(p.removedLength))),g.distanceTo(m)>DI&&(v=new IS(g,g.clone().lerp(m,.3),m.clone().lerp(g,.3),m))}l[2*h+1]=v}for(let h=0;h<o;h++){let u=a[h];if(u.removedLength===0){l[2*h]=null;continue}let d=u.position,f=u.prevDir.clone().multiplyScalar(u.removedLength).add(d),p=u.nextDir.clone().multiplyScalar(u.removedLength).add(d),v=u.tan*u.removedLength,g=u.prevDir.clone().add(u.nextDir).normalize(),m=f.clone().lerp(p,.5),y=f.distanceTo(p)/2,w=g.clone().multiplyScalar(Math.sqrt(Math.pow(v,2)-Math.pow(y,2))).add(m),b=g.clone().multiplyScalar(-v).add(w),A=d.distanceTo(b)/d.distanceTo(m),S=u.prevDir.clone().multiplyScalar(A*d.distanceTo(f)).add(d),T=S.clone().lerp(b,2),M=f.clone().lerp(S,4/3),E=p.clone().lerp(T,4/3);l[2*h]=new IS(f,M,E,p)}let c=new l3e;return l.forEach(h=>{h&&c.add(h)}),c}var Pn;(t=>{function e(n){return n&&n.__isEntity}t.is=e})(Pn||(Pn={}));var lh=t=>Pn.is(t),c3e={type:"completeState",isfromEntity:!0},XJ=t=>class extends MF(t){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new Hj,this._recursiveBBox=new Hj,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(e){let n=this.children[e];if(Pn.is(n))return n}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let e=this;for(;e.data.type!=="Instance";){let n=e.parent;if(Pn.is(n))e=n;else return}return e}forInstancesRec(e){this.instances.forEach(n=>{n.disposed||e(n),n.forInstancesRec(e)})}super_Entity(e,n){typeof e=="string"&&(this.uuid=e),this.identity=e,this.data=n,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(e,n,i=!1){if(!(this.data.states.length===0&&!i)){for(let r of this.data.states)af.toOps(this.data,r.data).forEach(s=>{let o=rI.replaceProps(s,this.data);this.dataPatched=this.data,this.updateByPatchedOp(o,this.data,n)});if(e!==null){let r=this.data.states.data(e);r&&(this.dataPatched=af.patch(this.data,r),af.toOps(this.data,r).forEach(s=>{this.updateByPatchedOp(s,this.dataPatched,n)}))}i&&this.updateTransformState(this.dataPatched),this.stateSelection=e,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(e,n){e.setScalar(0),n.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(e=>{lh(e)&&e.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(e=>{e.resetBBoxNeedsUpdateSelf()})}find(e){let n;return this.traverseEntity(i=>{i.uuid===e&&(n=i)}),n}traverseSortNextHelper(){let e=this.parent;if(e){let n=e.children,i=n.indexOf(this)+1;if(Pn.is(n[i]))return n[i];if(Pn.is(e))return e.traverseSortNextHelper()}}sortNext(){let e=this.children;return this.children.length>0&&Pn.is(this.children[0])?e[0]:this.traverseSortNextHelper()}goUp(e){let n=this;for(;e>0&&n!==null;)n=n.parent,e-=1;return n}hasAnccestorOrSelf(e){return this===e||this.hasAnccestor(e)}hasAnccestor(e){let n=this.parent;for(;n;){if(e===n)return!0;n=n.parent}return!1}countToAccestor(e){let n=0,i=this;for(;i!==e;){if(i===null)return-1;i=i.parent,n+=1}return n}forEachEntity(e){for(let n of this.children)lh(n)&&e(n)}traverseEntityAncestors(e){this.traverseAncestors(n=>{Pn.is(n)&&e(n)})}traverseEntity(e,n=0){if(e(this,n)!==!0)for(let i of this.children)lh(i)&&i.traverseEntity(e,n+1)}traverseVisibleEntity(e){e(this);for(let n of this.children)lh(n)&&n.visible&&n.traverseVisibleEntity(e)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}copy(e,n=!1){return super.copy(e,n),this.dataPatched=e.dataPatched,this.raycastLock=e.raycastLock,this.scaleLock=e.scaleLock,this.hiddenMatrix.copy(e.hiddenMatrix),this}hasEntityChild(){return this.children.some(e=>lh(e))}isAncestorOf(e){if(this.uuid===e)return!1;let n=!1;return this.traverseEntity(i=>{i.uuid===e&&(n=!0)}),n}toObjectTransformState(e=[]){this.updateWorldMatrix(!0,!1);let n={position:this.position.toArray(),rotation:[this.rotation.x,this.rotation.y,this.rotation.z],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return iI(n,e)}updateTransformState(e){let n=!1;return e.position&&(this.position.fromArray(e.position),n=!0),e.rotation&&(this.rotation.fromArray(e.rotation),n=!0),e.scale&&(n=!0,this.scale.fromArray(e.scale)),e.hiddenMatrix!==void 0&&(n=!0,this.hiddenMatrix.fromArray(e.hiddenMatrix??Jg.identity)),n&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(i=>{i.invalidateClonerTransform(this)})),e.position&&e.rotation&&e.scale&&e.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),n}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let e of this.children)Pn.is(e)&&e.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(e=>{Pn.is(e)&&e.disposeRecursively()})}toState(e=[]){let n={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(e)};return iI(n,e)}updateByOp(e,n,i,r){let s=this.data;this.data=n;let o=e,a=oh(e.path,["states","*"]);if(a!==null){if(e.type===0){let[l]=a;if((this==null?void 0:this.stateSelection)===l){let c={...e.props};if(Object.values(e.props).some(h=>h===void 0)){let h=this.data;if(h!==void 0){let u=Ql.zoom(h,e.path.slice(2));if(u)for(let d in e.props)e.props[d]===void 0&&d in u&&(c[d]=u[d])}}o={...e,props:c,path:e.path.slice(2)}}}}else if(e.type===0){let l=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(l!==void 0){if(e.props.name!==void 0&&l.name){let{name:h,...u}=l;l=u}if(e.props.material!==void 0&&"material"in l){let{material:h,...u}=l;l=u}let c=Ql.removeOverridden(e.path,e.props,l);o={...e,props:c}}}if(this.updateByPatchedOpBase(o,af.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),i),oh(e.path,["overrides"])){let l=[],c=[...e.path];for(l.push(c[1]),c.splice(0,2);c.length>0&&c[0]==="descendants";)l.push(c[1]),c.splice(0,2);if(l[l.length-1]===void 0){if(e.type===0)for(let h of Object.keys(e.props)){l[l.length-1]=h;let u=i.scene.findInstance([this.uuid,...l]);u&&(u.overrideData=e.props[h],u.updateState(bf.apply(u.component.data,u.overrideData),i))}}else{let h=i.scene.findInstance([this.uuid,...l]);if(h){let u=Ql.zoom(h.component.data,c);if(e={...e,path:c},e.type===0){let d=e.props;if(u)for(let[f,p]of Object.entries(e.props))p===void 0&&(d===e.props&&(d={...e.props}),d[f]=u[f]);e={...e,props:d}}h.overrideData=rM.resolve(n.overrides,l),h.updateByOp(e,ho.applySimple(h.data,e),i,!1)}}}else if(this.instances.length>0){let l;if(e.path.length===0&&e.type===0){let c;for(let h of $g.rootOverrideProps)h in e.props&&(c===void 0&&(c={}),c[h]=e.props[h]);c&&(l={...e,props:c})}else for(let c of $g.rootOverrideProps)if(oh(e.path,[c])){l=e;break}l!==void 0&&this.instances.forEach(c=>{if(c.isInstanceRoot){let h=bf.filterOp(c.overrideData,l);h&&c.updateByOp(h,ho.applySimple(c.data,h),i,!0)}}),this.instances.forEach(c=>{if(!c.isInstanceRoot){let h=bf.filterOp(c.overrideData,e);if(h){let u;s===c.data&&e===h?u=n:u=ho.applySimple(c.data,h),c.updateByOp(h,u,i,!0)}}})}}updateByPatchedOpBase(e,n,i){if(this.dataPatched=n,e.path.length===0&&e.type===0)e.props.type!==void 0&&!zf.is(e.props.type)&&yh.changeEntityProptotype(this,n,i);else if(e.path.length===1&&e.path[0]==="geometry"&&e.type===0&&"type"in e.props){yh.changeEntityProptotype(this,n,i);for(let r of this.children)Pn.is(r)&&r.updateVisible()}this.updateByPatchedOp(e,n,i)}updateByPatchedOp(e,n,i){if(e.path.length===0&&e.type===0&&this.updateState(e.props,i),oh(e.path,["pathSnapping"])!==null&&this.updatePathSnapping(n.pathSnapping),oh(e.path,["cloner"])!==null){let r=ho.drop(e,1);r.path.length===0&&r.type===0&&r.props.disabled===!0?this.setFromClonerState(null,i):this.cloner?this.cloner.updateState(n.cloner,i.scene):(this.setFromClonerState(n.cloner,i),this.expandCloner(i.scene)),this.updateVisible()}}updatePathSnapping(e){this._updatedPathSnapping=e,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(e){var p,v,g,m,y;let n=((p=this._updatedPathSnapping)==null?void 0:p.pathId)??this.dataPatched.pathSnapping.pathId,i=((v=this._updatedPathSnapping)==null?void 0:v.slide)??this.dataPatched.pathSnapping.slide??0,r=((g=this._updatedPathSnapping)==null?void 0:g.offset)??this.dataPatched.pathSnapping.offset,s=((m=this._updatedPathSnapping)==null?void 0:m.orientation)??this.dataPatched.pathSnapping.orientation;if(n===null)return;let o=e.find(n);if(!o||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let a=o.data,l=WJ(a.geometry.path),c=(i+r)%1,h=l.getPointAt(c),u=this.parent?(y=this.parent)==null?void 0:y.matrixWorld:new nt;o.updateMatrixWorld();let d=new nt().multiplyMatrices(u.clone().invert(),o.matrixWorld);h.applyMatrix4(d);let f={position:h.toArray(),rotation:a.rotation};if(s==="tangential"){let w=new nt().extractRotation(o.matrixWorld),b=l.getTangentAt(c).applyMatrix4(w).add(h),A=new nt().lookAt(h,b,new N(0,1,0)),S=new Dr().setFromRotationMatrix(A);f={...f,rotation:[S.x,S.y,S.z]}}this.updateTransformState(f),this.traverseEntity(w=>{w._cameraType&&w.dispatchEvent(c3e)})}updateVisible(){var e;this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((e=this.dataPatched.cloner)==null?void 0:e.hideBase)!==!0)}updateState_Entity(e,n){e.name!==void 0&&(this.name=e.name),e.raycastLock!==void 0&&(this.raycastLock=e.raycastLock),e.visible!==void 0&&(this.updateVisible(),this.resetBBoxNeedsUpdate()),"cloner"in e&&e.cloner!==void 0&&(this.setFromClonerState(e.cloner,n),this.updateVisible()),this.updateTransformState(e)}get attachedSurfaceCloners(){return this.children.filter(e=>e instanceof yh.Cloner&&e.parameters.type==="toObject")}setFromClonerState(e,n){this.disposed||(e===null||e.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new yh.Cloner(this,e),n.scene.addPendingExpandCloner(this)):this.cloner.updateState(e,n.scene))}expandCloner(e){!this.disposed&&this.cloner&&this.cloner.expandClones(e)}invalidateClonerTransform(e){this.cloner&&this.cloner.invalidateTransform(e)}},u3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},t.parameters),i=n.width/2,r=n.radiusTop??i,s=n.radiusBottom??i;return r===s?(r=i,s=i):r>s?(r=i,s=s*i/r):(r=r*i/s,s=i),{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width),radiusTop:r,radiusBottom:s})}}static build(t){let{width:e,depth:n,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l,radiusTop:c,radiusBottom:h,cornerRadius:u,cornerSegments:d,hollow:f}=t.parameters,p;return u||f?p=new YJ(c,h,i,r,s,o,a,l*Math.PI/180,u,u,d,f):p=new VO(c,h,i,r,s,o,a,l*Math.PI/180),p.scale(1,1,n/e),Object.assign(p,{userData:{...t,type:"CylinderGeometry"}})}};function Hu(t,e,n){n.x=t.x*e.x,n.y=t.y,n.z=t.x*e.y}function Vj(t){return new be(t.y,-t.x)}var YJ=class extends Lt{constructor(t,e,n,i,r,s,o,a,l,c,h,u,d=!1){super(),this.type="RoundedCylinderBufferGeometry",t=t!==void 0?t:1,e=e!==void 0?e:1,n=n||1,i=Math.floor(i)||8,r=Math.floor(r)||1,s=s!==void 0?s:!1,o=o!==void 0?o:0,a=a!==void 0?a:Math.PI*2,s&&(l=0,c=0);let f=[],p=[],v=[],g=[],m=0,y=n/2,w=new N,b=new N;d&&t==0&&(t=l),d&&e==0&&(e=c);let A=new be(t,y),S=new be(e,-y),T=null,M=null,E=null,P=null,R=A.clone().sub(S),F=0,B=0,k=0;u>0&&(F=Math.min(t,e)*(1-u),B=t-F,k=e-F);let j=A.clone();j.x-=F;let Z=Math.PI-R.angle(),ee=R.angle(),O=Math.tan(ee/2),W=Math.tan(Z/2),H=O+W,Y=u?H:W,z=u?H:O;if(l=Math.min(l,(t-B)/Y,R.length()/H),c=Math.min(c,(e-k)/z,R.length()/H),l>0){let oe=l/O;T=A.clone().sub(new be(oe,l)),u&&(E=T.clone(),E.x-=F-H*l),A.sub(R.clone().setLength(oe))}if(c>0){let oe=c/W;M=S.clone().sub(new be(oe,-c)),S.add(R.clone().setLength(oe)),u&&(P=M.clone(),P.x-=F-H*c,j.sub(R.clone().setLength(oe)))}R=A.clone().sub(S);let X=R.length()<.5,q=[];for(let oe=0;oe<=i;oe++){let ve=[],$=oe/i,se=$*a+o,ne=new be(Math.sin(se),Math.cos(se));P&&M?(re(ve,$,ne,Z,c,P,-1,!0),re(ve,$,ne,ee,c,M,-1,!1)):M?(G(ve,ne,M.x,0,-1),re(ve,$,ne,ee,c,M,-1,!1)):s||G(ve,ne,e,k,-1);let ie=Vj(R).normalize();if(Hu(ie,ne,w),!X)for(let me=0;me<=r;me++){let xe=me/r,Ae=R.clone().multiplyScalar(xe).add(S);Hu(Ae,ne,b),p.push(b.x,b.y,b.z),v.push(w.x,w.y,w.z),g.push($,.5+b.y/n),ve.push(m++)}if(E&&T?(re(ve,$,ne,Z,l,T,1,!1),re(ve,$,ne,ee,l,E,1,!0)):T?(re(ve,$,ne,Z,l,T,1,!1),G(ve,ne,T.x,0,1)):s||G(ve,ne,t,B,1),u&&!X){let me=Vj(R).multiplyScalar(-1).normalize();Hu(me,ne,w);for(let xe=0;xe<=r;xe++){let Ae=xe/r,_e=R.clone().multiplyScalar(-Ae).add(j);Hu(_e,ne,b),p.push(b.x,b.y,b.z),v.push(w.x,w.y,w.z),g.push($,.5+b.y/n),ve.push(m++)}}u&&!s&&ve.push(ve[0]),q.push(ve)}for(let oe=0;oe<q.length-1;oe++)for(let ve=0;ve<q[0].length-1;ve++){if(s&&u&&ve==r)continue;let $=q[oe][ve],se=q[oe+1][ve],ne=q[oe+1][ve+1],ie=q[oe][ve+1],me=p[ne*3+0],xe=p[ne*3+2];f.push($,se,ie),(me!=0||xe!=0)&&f.push(se,ne,ie)}a<Math.PI*2&&(K(-1,q[0],o),K(1,q[q.length-1],o+a)),this.setIndex(f),this.setAttribute("position",new ft(p,3)),this.setAttribute("normal",new ft(v,3)),this.setAttribute("uv",new ft(g,2));function re(oe,ve,$,se,ne,ie,me,xe){for(let Ae=0;Ae<h+1;Ae++){let _e=Ae/h,Ee=me<0?_e:1-_e;xe&&(Ee-=1),Ee*=se;let Re=new be(Math.sin(Ee),Math.cos(Ee)*me),Ue=Re.clone().multiplyScalar(ne).add(ie);Hu(Ue,$,b),p.push(b.x,b.y,b.z),Hu(Re,$,w),v.push(w.x,w.y,w.z),g.push(ve,.5+b.y/n),oe.push(m++)}}function G(oe,ve,$,se,ne){let ie=new N,me=new be,xe=[$,se];ne<0&&xe.reverse();for(let Ae of xe)me.set(Ae,y*ne),Hu(me,ve,ie),p.push(ie.x,ie.y,ie.z),v.push(0,ne,0),g.push(.5,.5),oe.push(m++)}function K(oe,ve,$){let se=new be(Math.sin($),Math.cos($)),ne=new be(-Math.cos($),Math.sin($)),ie=new N,me=oe<0?(_e,Ee,Re)=>f.push(_e,Ee,Re):(_e,Ee,Re)=>f.push(_e,Re,Ee),xe=new be((t+e+B+k)/4,0);Hu(xe,se,ie),p.push(ie.x,ie.y,ie.z),v.push(ne.x,0,ne.y),g.push(.5,.5);let Ae=m++;for(let _e of ve){let Ee=p.slice(_e*3,_e*3+3);p.push(...Ee),v.push(ne.x,0,ne.y);let Re=g.slice(_e*2,_e*2+2);g.push(...Re),m++}for(let _e=Ae+1;_e<m-1;_e++)me(Ae,_e,_e+1);me(Ae,m-1,Ae+1)}}},h3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,depth:n,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l,cornerRadiusTop:c,cornerRadiusBottom:h,cornerSegments:u}=t.parameters,d;return c>0||h>0||l<360?d=new YJ(0,e/2,i,r,s,o,a,l*Math.PI/180,c,h,u,0,!0):d=new dK(e/2,i,r,s,o),d.scale(1,1,n/e),Object.assign(d,{userData:{...t,type:"ConeGeometry"}})}},d3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,widthSegments:r,heightSegments:s,depthSegments:o,cornerRadius:a,cornerSegments:l}=t.parameters,c;return a==0?c=new nc(e,n,i,r,s,o):c=new f3e(e,n,i,r,s,o,a,l),Object.assign(c,{userData:{...t,type:"CubeGeometry"}})}},N2=Math.PI/2,f3e=class extends Lt{constructor(t=1,e=1,n=1,i=1,r=1,s=1,o=0,a=4){super(),this.type="BoxGeometry";let l=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s),a=Math.floor(a),o=Math.min(o,t/2,e/2,n/2);let c=[],h=[],u=[],d=[],f=0,p=0;v("z","y","x",-1,-1,n,e,t,s,r,0),v("z","y","x",1,-1,n,e,-t,s,r,1),v("x","z","y",1,1,t,n,e,i,s,2),v("x","z","y",1,-1,t,n,-e,i,s,3),v("x","y","z",1,-1,t,e,n,i,r,4),v("x","y","z",-1,-1,t,e,-n,i,r,5),o>0&&(g("z","y","x",-1,-1,1,n,e,t,s,0),g("z","y","x",1,-1,-1,n,e,t,s,1),g("z","y","x",-1,1,-1,n,e,t,s,1),g("z","y","x",1,1,1,n,e,t,s,0),g("x","y","z",-1,-1,-1,t,e,n,i,0),g("x","y","z",1,-1,1,t,e,n,i,1),g("x","y","z",-1,1,1,t,e,n,i,0),g("x","y","z",1,1,-1,t,e,n,i,1),g("y","x","z",-1,-1,1,e,t,n,r,0),g("y","x","z",1,-1,-1,e,t,n,r,1),g("y","x","z",1,1,1,e,t,n,r,1),g("y","x","z",-1,1,-1,e,t,n,r,0),m(1,1,1),m(-1,1,1),m(1,-1,1),m(-1,-1,1),m(1,1,-1),m(-1,1,-1),m(1,-1,-1),m(-1,-1,-1)),this.setIndex(c),this.setAttribute("position",new ft(h,3)),this.setAttribute("normal",new ft(u,3)),this.setAttribute("uv",new ft(d,2));function v(y,w,b,A,S,T,M,E,P,R,F){let B=(T-2*o)/P,k=(M-2*o)/R,j=T/2-o,Z=M/2-o,ee=E/2,O=P+1,W=R+1,H=0,Y=0,z=new N;for(let X=0;X<W;X++){let q=X*k-Z;for(let re=0;re<O;re++){let G=re*B-j;z[y]=G*A,z[w]=q*S,z[b]=ee,h.push(z.x,z.y,z.z),z[y]=0,z[w]=0,z[b]=E>0?1:-1,u.push(z.x,z.y,z.z),d.push(re/P),d.push(1-X/R),H+=1}}for(let X=0;X<R;X++)for(let q=0;q<P;q++){let re=f+q+O*X,G=f+q+O*(X+1),K=f+(q+1)+O*(X+1),oe=f+(q+1)+O*X;c.push(re,G,oe),c.push(G,K,oe),Y+=6}l.addGroup(p,Y,F),p+=Y,f+=H}function g(y,w,b,A,S,T,M,E,P,R,F){let B=(M-2*o)/R,k=M/2-o,j=E/2-o,Z=P/2,ee=R+1,O=0,W=0,H=new N,Y=new N;for(let z=0;z<a+1;z++){let X=z/a*N2,q=Math.sin(X)*o,re=(1-Math.cos(X))*o,G=Math.sin(X),K=Math.cos(X);H[w]=(j+q)*S,H[b]=(Z-re)*T,Y[y]=0,Y[w]=G*Math.sign(H[w]),Y[b]=K*Math.sign(H[b]);for(let oe=0;oe<ee;oe++){let ve=oe*B-k;H[y]=ve*A,h.push(H.x,H.y,H.z),u.push(Y.x,Y.y,Y.z),d.push(oe/R),d.push(0),O+=1}}for(let z=0;z<a;z++)for(let X=0;X<R;X++){let q=f+X+ee*z,re=f+X+ee*(z+1),G=f+(X+1)+ee*(z+1),K=f+(X+1)+ee*z;c.push(q,re,K),c.push(re,G,K),W+=6}l.addGroup(p,W,F),p+=W,f+=O}function m(y,w,b){let A=new N,S=new N(t/2,e/2,n/2);S.subScalar(o);let T=[],M=y*w*b>0?(P,R,F)=>c.push(P,R,F):(P,R,F)=>c.push(P,F,R);for(let P=0;P<=a;P++){let R=[],F=N2*(1-P/a),B=Math.cos(F),k=Math.sin(F),j=0;for(let Z=0;Z<=P;Z++){let ee=Math.cos(j),O=Math.sin(j);A.x=B*ee,A.y=k,A.z=B*O;let W=S.clone().addScaledVector(A,o);h.push(y*W.x,w*W.y,b*W.z),u.push(y*A.x,w*A.y,b*A.z),d.push(0,0),R.push(f++),j+=N2/P}T.push(R)}let E=T.length-1;for(let P=0;P<E;P++){let R=T[P],F=T[P+1],B=R.length-1;M(R[0],F[1],F[0]);for(let k=1;k<=B;k++)M(R[k-1],R[k],F[k]),M(R[k],F[k+1],F[k])}}}},EF=class extends Lt{constructor(t=[],e=[],n="",i=1,r=.2,s=4){super(),this.type="PolyhedronGeometryRound";let o=[],a=[],l=[];c(),h(),this.setAttribute("position",new ft(o,3)),this.setAttribute("normal",new ft(l,3)),this.setAttribute("uv",new ft(a,2));return;function c(){var ee;r=Math.min(1-1e-5,r),r==0&&(s=0);let u={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[n],d=new N,f=d.clone(),p=new Ds,v=r*i,g=i-v,m=s+1,y=new N,w=(O,W)=>y.subVectors(O,W).normalize(),b=(O,W)=>Array(O).fill(void 0).map(W),A=b(t.length/3,(O,W)=>new N().fromArray(t,W*3).setLength(i)),S=[],T=1e6;for(let O=0;O<A.length;O++){let W=A[O],H=[],Y,z,X,q=1e10,re=-1;for(;(re=e.indexOf(O,re+1))!=-1;){let ve=re-re%3;Y=e[ve+(re+1)%3],z=e[ve+(re+2)%3],X=W.distanceToSquared(A[Y]),q=Math.min(q,X),H.push([Y,z,X])}q+=1e-6;let G=[],K=0,oe=H.length;for(let ve=0;ve<oe;ve++){[Y,z,X]=H[K];let $=((ee=S[Y])==null?void 0:ee.includes(O))==!0;X<=q&&G.push(Y+ +$*T),K=H.findIndex(se=>se[0]==z)}S.push(G)}let M=[];{let O=0,W=0,H,Y,z=u==3;for(let X=0;X<=s;X++){H=X*(X+1)/2,Y=(X+1)*(X+2)/2;for(let q=0;q<s-X;q++)[O,W]=[H+q+X+2,Y+q+X+3],M.push(H,Y,...z?[W,H]:[O,Y],W,O),[H,Y]=[O,W];M.push(H,Y,H+s+2)}}let E=d.clone(),P=d.clone(),R=d.clone(),F=d.clone(),B=d.clone(),k=[],j=b(A.length,()=>b(u,()=>d.clone()));for(let O=0;O<A.length;O++){d.copy(A[O]).normalize(),E.copy(d).multiplyScalar(g);let W=S[O];for(let G=0;G<W.length;G++){let K=W[G],oe=W[(G+1)%u];p.setFromPointsAndIndices(A,O,K%T,oe%T),p.b.sub(p.a).setLength(1e10).add(p.a),p.c.sub(p.a).setLength(1e10).add(p.a),p.closestPointToPoint(E,j[O][G])}let H=[],Y=[],z=[],X=new N;s==0&&[...j[O]].reduce((G,K)=>G.add(K),X).multiplyScalar(1/u);for(let G=0;G<u;G++){let K=[],oe=(G-1+u)%u,ve=j[O][oe],$=j[O][G];d.copy(ve).sub(E),f.copy($).sub(E);let se=E.angleTo(d),ne=d.angleTo(f),ie=Math.cos(se)*v;s==0?P.copy(X):P.copy(E).setLength(g+ie),Y.push(ie);let me=[P,ve,$];for(let xe=0;xe<2;xe++){let Ae=me[xe],_e=me[xe+1];F.subVectors(Ae,E),B.subVectors(_e,E),R.crossVectors(F,B).normalize();for(let Ee=0;Ee<m;Ee++){let Re=[se,ne][xe]*Ee/m;d.copy(F).applyAxisAngle(R,Re).add(E),H.push(d.clone()),xe&&(w(d,E),K.push([Ee==0?Ae:d.clone(),y.clone()]))}xe&&(w(_e,E),K.push([_e,y.clone()]))}z.push(K)}k.push(z);let q=2*m,re=2;for(let G=0;G<u;G++){let K=q*G,oe=q*((G+1)%u),ve=[H[K]];for(let se=1;se<m;se++){F=H[K+se],B=H[oe+se],ve.push(F);for(let ne=1,ie=se-re+1;ne<=ie;ne++)d.lerpVectors(F,B,ne/(ie+1)),d.sub(E).setLength(Y[G]).add(E),ve.push(d.clone());ve.push(B)}for(let se=0;se<m;se++)ve.push(H[se+m+K]);ve.push(H[oe+m]);let $=M.map(se=>ve[se]);o.push(...$.map(se=>[se.x,se.y,se.z]).flat()),l.push(...$.map(se=>(w(se,E),[y.x,y.y,y.z])).flat())}}let Z=[];for(let O=0;O<S.length;O++)for(let W=0;W<u;W++){let H=S[O][W];if(H<T){let Y=S[H].findIndex(q=>q%T==O),z=k[O][W],X=k[H][Y];for(let q=0;q<m;q++){let re=z[q],G=X[m-q],K=z[q+1],oe=X[m-(q+1)];[re,G,K,K,G,oe].forEach(ve=>{o.push(ve[0].x,ve[0].y,ve[0].z),l.push(ve[1].x,ve[1].y,ve[1].z)})}Z.push(z[0][0],X[m][0],z[m][0],X[0][0])}}for(;Z.length;){let O,W,H,Y;[O,W]=Z.splice(0,2);let z=[O];for(;O!=W;)z.push(W),H=Z.indexOf(W),Y=H%2,W=Z.splice(H-Y,2)[1-Y];y.subVectors(z[0],z[1]).cross(d.subVectors(z[0],z[2])).normalize();let X=y.dot(z[0])<0;X&&y.negate();for(let q=1;q<=z.length-2;q++)[z[q+ +X],z[q+1-+X],z[0]].forEach(re=>{o.push(re.x,re.y,re.z),l.push(y.x,y.y,y.z)})}}function h(){let u=new N;for(let S=0;S<o.length;S+=3){u.x=o[S+0],u.y=o[S+1],u.z=o[S+2];let T=b(u)/2/Math.PI+.5,M=A(u)/Math.PI+.5;a.push(T,1-M)}let d=new N,f=new N,p=new N,v=new N,g=new be,m=new be,y=new be,w=(S,T,M,E)=>{E<0&&S.x===1&&(a[T]=S.x-1),M.x===0&&M.z===0&&(a[T]=E/2/Math.PI+.5)};for(let S=0,T=0;S<o.length;S+=9,T+=6){d.set(o[S+0],o[S+1],o[S+2]),f.set(o[S+3],o[S+4],o[S+5]),p.set(o[S+6],o[S+7],o[S+8]),g.set(a[T+0],a[T+1]),m.set(a[T+2],a[T+3]),y.set(a[T+4],a[T+5]),v.copy(d).add(f).add(p).divideScalar(3);let M=b(v);w(g,T+0,d,M),w(m,T+2,f,M),w(y,T+4,p,M)}for(let S=0;S<a.length;S+=6){let T=a[S+0],M=a[S+2],E=a[S+4],P=Math.max(T,M,E),R=Math.min(T,M,E);P>.9&&R<.1&&(T<.2&&(a[S+0]+=1),M<.2&&(a[S+2]+=1),E<.2&&(a[S+4]+=1))}function b(S){return Math.atan2(S.z,-S.x)}function A(S){return Math.atan2(-S.y,Math.sqrt(S.x*S.x+S.z*S.z))}}}static fromJSON(t){return new EF(t.vertices,t.indices,t.radius,t.corner,t.cornerSides)}},p3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,detail:0,corner:0,cornerSides:4},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,detail:r,corner:s,cornerSides:o}=t.parameters,a=r===0&&s!==0?new qJ(e*.5,s,o):new fK(e*.5,r);return a.scale(1,n/e,i/e),Object.assign(a,{userData:{...t,type:"DodecahedronGeometry"}})}},qJ=class extends EF{constructor(t=1,e=.2,n=4){let i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a="DodecahedronGeometry";super(s,o,a,t,e,n),this.type=a}static fromJSON(t){return new qJ(t.radius,t.corner,t.cornerSides)}},U0=1e-12,CF=class{constructor(t){this.position=new be,this.startPosition=new be,this.uuid=sn.generateUUID(),this.position=t.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(t){this.position.copy(this.startPosition).add(t)}copy(t){return this.position.copy(t.position),this.startPosition.copy(t.startPosition),this}clone(){return new CF(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},LI=class extends CF{constructor(t){super(t.position),this.parent=t}copy(t){return super.copy(t),this}clone(){return new LI(this.parent).copy(this)}},xg=class extends CF{constructor(t,e){super(e),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=t,this.controls.push(new LI(this),new LI(this))}static create(t,e){let n=new xg(t,new be(...e.position));return n.controls[0].position.set(...e.controlPrevious.position),n.controls[1].position.set(...e.controlNext.position),n.roundness=e.roundness,n.areControlsDirectionsMirrored=e.areControlsDirectionsMirrored,n}getOppositeControl(t){let e=this.controls.indexOf(t);return e===0?this.controls[1]:e===1?this.controls[0]:null}applyOffsetToControls(t,e=1){for(let n=0,i=this.controls.length;n<i;n++){let r=this.controls[n];this.position.distanceTo(r.position)<=e?r.position.copy(this.position):r.applyOffset(t)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(t){return super.copy(t),this.controls[0].copy(t.controls[0]),this.controls[1].copy(t.controls[1]),this.roundness=t.roundness,this.uuid=t.uuid,this}clone(){return new xg(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var n,i;let t=(n=this.curveBefore)==null?void 0:n.getTangentAt(1),e=(i=this.curveAfter)==null?void 0:i.getTangentAt(0);return[t,e]}computeNormals(t=new be,e=new be){let[n,i]=this.computeTangents();return n&&i&&(jj(n,t),jj(i,e)),[t,e]}computeTangent(t=new be){let[e,n]=this.computeTangents();return e&&n&&t.copy(e).add(n).normalize(),t}computeNormal(t=new be){let[e,n]=this.computeNormals();return t.copy(e).add(n).normalize(),t}};function jj(t,e=new be){let n=t.length();return e.set(-t.y/n,t.x/n)}var TF=t=>t,Pv=new be,NE=new be,m3e=new be,g3e=new be,v3e=new be,y3e=new be,QJ=new N,KJ=new N;function x3e(t){let e=new be;e.addVectors(t.v0,Pv.subVectors(t.v1,t.v0).multiplyScalar(2/3));let n=new be;return n.addVectors(t.v2,NE.subVectors(t.v1,t.v2).multiplyScalar(2/3)),new Ga(t.v0,e,n,t.v2)}function uy(t,e,n=Number.EPSILON){return Math.abs(t-e)<n}function w3e(t,e,n=Number.EPSILON){return t.distanceTo(e)<n}function _3e(t,e,n=Number.EPSILON){return t.distanceTo(e)<n}function JJ(t,e,n){let i=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),r=Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2)),s=Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2));return Math.acos((r*r+i*i-s*s)/(2*r*i))}function b3e(t,e,n){return Xj(t,e)&&Xj(e,n)&&II(t.position,e.position,n.position)}function II(t,e,n){return Pv.copy(e).sub(t).cross(NE.copy(n).sub(t))===0}function S3e(t,e,n,i,r){let s=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),o=(t.y+e.y)/2,a=(t.x+e.x)/2,l=Math.sqrt(Math.pow(n,2)-Math.pow(s/2,2))*(t.y-e.y)/s,c=Math.sqrt(Math.pow(n,2)-Math.pow(s/2,2))*(e.x-t.x)/s;return i.set(a+l,o+c),r.set(a-l,o-c),[i,r]}function A3e(t,e,n){let i=t.distanceTo(n),r=e.distanceTo(n);return i<r?e:t}function M3e(t,e,n,i,r,s){let o=e.x-t.x,a=e.y-t.y,l=n.x-t.x,c=n.y-t.y,h=Math.sqrt((o+l)*(o+l)+(a+c)*(a+c)),u;return JJ(e,t,n)>Math.PI&&(h*=-1),uy(c,a)?u=(a+c)*(i/h-.5)*8/3/(o-l):u=(o+l)*(i/h-.5)*8/3/(c-a),r.set(e.x-u*a,e.y+u*o),s.set(n.x+u*c,n.y-u*l),[r,s]}function Wj(t,e){return t.position.equals(t.controls[1].position)&&e.position.equals(e.controls[0].position)}function Xj(t,e){return II(t.position,t.controls[1].position,e.position)&&II(t.position,e.controls[0].position,e.position)}function E3e(t,e,n,i,r=.5){let s=Pv.subVectors(e,t).multiplyScalar(r).add(t),o=NE.subVectors(n,e).multiplyScalar(r).add(e),a=m3e.subVectors(i,n).multiplyScalar(r).add(n),l=s,c=g3e.subVectors(o,s).multiplyScalar(r).add(s),h=v3e.subVectors(a,o).multiplyScalar(r).add(o),u=a,d=y3e.subVectors(h,c).multiplyScalar(r).add(c);return[t.x,t.y,l.x,l.y,c.x,c.y,d.x,d.y,h.x,h.y,u.x,u.y,i.x,i.y]}function C3e(t,e,n=12,i=!0){let r=KJ.set(0,0,0),s,o=0;for(let a=0;a<e.length;a++){let l=TF(e[a]),c=Pv,h=Af(l,n);for(let u=0;u<=h;u++)if(l instanceof Ga||l instanceof qh||l instanceof Qa){if(l.getPoint(u/h,c),r.set(c.x,c.y,0),s!==void 0&&_3e(s,r))continue;s===void 0&&(s=QJ),s.copy(r),t.setXYZ(o,r.x,r.y,r.z),o++}}return i&&o>1&&!(t.getX(o-1)===t.getX(0)&&t.getY(o-1)===t.getY(0)&&t.getZ(o-1)===t.getZ(0))&&(t.setXYZ(o,t.getX(0),t.getY(0),t.getZ(0)),o++),t}function T3e(t,e,n,i=12,r=!0){let s=KJ.set(0,0,0),o=0,a=[];for(let l=0;l<e.length;l++){if(n[l]===!1)continue;let c,h=TF(e[l]),u=Pv,d=Af(h,i);a.push(d);for(let f=0;f<=d;f++)if(h instanceof Ga||h instanceof qh||h instanceof Qa){if(h.getPoint(f/d,u),s.set(u.x,u.y,0),c==null?void 0:c.equals(s))continue;c===void 0?c=QJ:(t.setXYZ(o,c.x,c.y,c.z),o++,t.setXYZ(o,s.x,s.y,s.z),o++),c.copy(s)}}return r&&o>1&&!(t.getX(o-1)===t.getX(0)&&t.getY(o-1)===t.getY(0)&&t.getZ(o-1)===t.getZ(0))&&(t.setXYZ(o,t.getX(0),t.getY(0),t.getZ(0)),o++),a}function Yj(t,e=12,n=!1){let i=[];for(let r=0,s=t.length;r<s;r++){let o=t[r],a=0;if(n&&o.roundedCurveCorner!==void 0){let l=Af(o.roundedCurveCorner,e)*.5;r>0&&(i[r-1]+=l),a+=l}o.curveAfter!==void 0&&(a+=Af(o.curveAfter,e)),i.push(a)}return t.length>0&&n&&t[0].roundedCurveCorner!==void 0&&(i[t.length-1]+=Af(t[0].roundedCurveCorner,e)*.5),i}function Af(t,e=12){return t&&t instanceof bE?e*2:t&&(t instanceof Qa||t instanceof cK)?1:t&&t instanceof HO?e*t.points.length:e}function P3e(t,e,n=12,i=!0){let r,s=0;for(let o=0;o<e.length;o++){let a=TF(e[o]),l=Af(a,n),c=Pv;for(let h=0;h<=l;h++)if(a instanceof Ga||a instanceof qh||a instanceof Qa){if(a.getPoint(h/l,c),r!==void 0&&w3e(r,c,U0))continue;r===void 0&&(r=NE),r.copy(c),t.push(c.x,c.y),s++}}return uy(t[0],t[t.length-2],U0)&&uy(t[1],t[t.length-1],U0)&&(t.pop(),t.pop()),i&&s>1&&!(uy(t[s-1],t[1],U0)&&uy(t[s-2],t[0],U0))&&(t.push(t[0],t[1]),s++),t}var U2=new be,D3e=new be,R3e=new be,L3e=new be,I3e=new be,B3e=new be,_i=class extends UA{constructor(t=100,e=100){super(),this.points=[],this.shapeHoles=[],this.plane=new no(new N(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=sn.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=t,this._height=e}static createFromState(t,e,n){let i=new _i;return i.isClosed=t.isClosed,i.points=t.points.map(r=>xg.create(r.id,r.data)),typeof t.roundness=="number"&&(i.roundness=t.roundness),i.shapeHoles=t.shapeHoles.map(r=>_i.createFromState(r)),e!==void 0&&n!==void 0&&i.applySize(e,n),i.update(),i}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(t){if(this._roundness!==t){this._roundness=t;for(let e=0,n=this.points.length;e<n;e++)this.points[e].roundness=t;this.needsUpdate=!0}}getPointsIndexesByIds(t){return t.map(e=>this.getPointIndexById(e)).filter(e=>e>=0)}getPointIndexById(t){let e=this.points.length,n=this.points.findIndex(i=>i.uuid===t);if(n<0){let i=e;for(let r=0,s=this.shapeHoles.length;r<s;r++){let o=this.shapeHoles[r],a=o.points.length,l=o.getPointIndexById(t);if(l<0)i+=a;else return l+i}}return n}getLineIndexById(t){return this.getPointIndexById(t)}getBezierPoint(t){if(t<=this.points.length-1)return this.points[t];if(this.shapeHoles.length>0){let e=this.points.length;for(let n=0,i=this.shapeHoles.length;n<i;n++){let r=this.shapeHoles[n],s=t-e;if(s<=r.points.length-1)return r.points[s];e+=r.points.length}}throw new Error("This shape does not have a point for this index: "+t)}getBezierPointIndex(t){let e=this.points.indexOf(t);if(e>=0)return e;if(e=this.points.length,this.shapeHoles.length>0)for(let n=0,i=this.shapeHoles.length;n<i;n++){let r=this.shapeHoles[n],s=r.points.indexOf(t);if(s>=0)return e+s;e+=r.points.length}return-1}getAllPoints(){let t=[].concat(...this.shapeHoles.map(e=>e.points));return[...this.points,...t]}applySize(t,e){t===0&&(t=.001),e===0&&(e=.001),this._width=t,this._height=e}applyScale(t,e){let n=U2.set(t,e);for(let i=0,r=this.points.length;i<r;i++){let s=this.points[i];s.position.multiply(n),s.controls[0].position.multiply(n),s.controls[1].position.multiply(n)}for(let i=0,r=this.shapeHoles.length;i<r;i++)this.shapeHoles[i].applyScale(t,e);this._update()}createPoint(t,e=0,n=sn.generateUUID()){let i;t instanceof be?i=t:i=new be(t,e);let r=new xg(n,i);return r.roundness=this.roundness,r}addPoint(t){this.points.push(t),this.needsUpdate=!0}addPointAt(t,e){this.points.splice(e,0,t),this.needsUpdate=!0}getPointByUuid(t){for(let e=0,n=this.points.length;e<n;e++){let i=this.points[e];if(i.uuid===t)return i}for(let e=0,n=this.shapeHoles.length;e<n;e++){let i=this.shapeHoles[e].getPointByUuid(t);if(i)return i}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(t){let e=this.points.indexOf(t);e>=0&&this.points.splice(e,1),this.needsUpdate=!0}removePointById(t){let e=this.points.find(n=>n.uuid===t);e&&this.removePoint(e)}update(){for(let t=0,e=this.shapeHoles.length;t<e;t++)this.shapeHoles[t].update();this._update()}extractShapePointsToBuffer(t,e=12,n=!1){this.subdivision=e,this.curveDivisions===void 0&&this.computeCurveDivisions(e);let i=n?this.roundedCurveDivisions:this.curveDivisions;return C3e(t,n?this.roundedCurves:this.curves,e,this.autoClose),i.reduce((r,s)=>r+s,0)+1}computeCurveDivisions(t=12){return this.curveDivisions=Yj(this.points,t,!1),this.roundedCurveDivisions=Yj(this.points,t,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(t,e,n=12){return T3e(t,this.curves,e,n,this.autoClose).reduce((i,r)=>i+r,0)*2}extractShapePointsToFlatArray(t,e=12){return this.subdivision=e,this.curveDivisions===void 0&&this.computeCurveDivisions(e),P3e(t,this.roundedCurves,e,this.autoClose)}getCurveIndexFromVertexId(t,e=!1){let n=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let i=e?this.roundedCurveDivisions:this.curveDivisions,r=0;e&&this.points[0].roundedCurveCorner!==void 0&&(r=Af(this.points[0].roundedCurveCorner,this.subdivision)*.5);let s=t-r;s<0&&(s+=i.reduce((o,a)=>o+a,0));for(let o=0,a=i.length;o<a;o++){let l=i[o];if(s<n+l)return[o,(s-n+1)/l];n+=l}return[0,1]}getCurveT(t,e,n){let i=this.points[t],r=this.points[t>=this.points.length-1?0:t+1],s=this.curveDivisions,o=s[t];if(Wj(i,r)){let l=i.position.distanceTo(r.position);return i.position.distanceTo(U2.set(n.x,n.y))/l}let a=0;for(let l=0;l<t;l++)a+=s[l];return(e-a)/o}dispose(){}_applyCurveForPoint(t,e){Wj(e,t)?this.lineTo(t.position.x,t.position.y):this.bezierCurveTo(e.controls[1].position.x,e.controls[1].position.y,t.controls[0].position.x,t.controls[0].position.y,t.position.x,t.position.y);let n=this.curves[this.curves.length-1];t.curveBefore=n,e.curveAfter=n;let i=n.clone();t.roundedCurveBefore=i,e.roundedCurveAfter=i,t.roundedCurveCorner=void 0,this.roundedCurves.push(i)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let e=0,n=this.points.length;e<n;e++){let i=this.points[e];if(e===0)this.moveTo(i.position.x,i.position.y);else{let r=this.points[e-1];this._applyCurveForPoint(i,r)}}let t=this.getLastPoint();if(t!=null&&t.curveAfter&&(t.curveAfter=void 0),this.isClosed){let e=this.points[0],n=this.points[this.points.length-1];this._applyCurveForPoint(e,n)}if(this.points.length>2){let e=0;for(let n=0,i=this.points.length;n<i;n++){let r=this.points[n],s=this.points[n-1]??this.points[this.points.length-1],o=this.points[n+1]??this.points[0],a=r.roundness,l=s&&o&&b3e(s,r,o);if(!r.controlsMoved()&&a>0&&!l){let c=r.curveBefore,h=r.curveAfter;if(c===void 0||h===void 0)continue;let u=r.roundedCurveBefore,d=r.roundedCurveAfter,f=c.getLength(),p=h.getLength(),v=Math.min(a,f*.499),g=Math.min(a,p*.499),m=Math.min(v,g),y=1-m/f,w=m/p,b=c.getPointAt(y,U2),A=h.getPointAt(w,D3e);this._subSplitCurve(c,u,y,b,void 0),this._subSplitCurve(h,d,w,void 0,A);let S;if(this.useCubicForRoundedCorners){let T=JJ(b,r.position,A)/2,M=Math.tan(T)*b.distanceTo(r.position),[E,P]=S3e(b,A,M,R3e,L3e),R=A3e(E,P,r.position),[F,B]=M3e(R,b,A,M,I3e,B3e);S=new Ga(b.clone(),F.clone(),B.clone(),A.clone())}else S=new qh(b.clone(),r.position.clone(),A.clone());r.roundedCurveCorner=S,this.roundedCurves.splice(n+e,0,S),e++}}}}_subSplitCurve(t,e,n,i,r){if(t instanceof Qa)i!==void 0&&e.v2.copy(i),r!==void 0&&e.v1.copy(r);else{let s=t,o=e,a=s.getUtoTmapping(n,0),l=E3e(s.v0,s.v1,s.v2,s.v3,a);return i!==void 0&&(o.v0.set(l[0],l[1]),o.v1.set(l[2],l[3]),o.v2.set(l[4],l[5]),o.v3.set(l[6],l[7])),r!==void 0&&(o.v0.set(l[6],l[7]),o.v1.set(l[8],l[9]),o.v2.set(l[10],l[11]),o.v3.set(l[12],l[13])),o}return e}clone(){let t=new _i(this._width,this._height);return t.points=this.points.map(e=>e.clone()),t.isClosed=this.isClosed,t.roundness=this.roundness,t.isMesh2D=this.isMesh2D,t.shapeHoles=this.shapeHoles.map(e=>e.clone()),t}toJSON(){return{points:this.points.reduce((t,e)=>t.concat(e.toJSON()),[]),shapeHoles:this.shapeHoles.map(t=>t.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(t){var n;this.points=[],this.pointIDs=0;let e=t.points.length/7;for(let i=0;i<e;i++){let r=i*7,s=t.points[r+0],o=t.points[r+1],a=t.points[r+2],l=t.points[r+3],c=t.points[r+4],h=t.points[r+5],u=t.points[r+6],d=new xg(sn.generateUUID(),new be(s,o));d.controls[0].position.set(a,l),d.controls[1].position.set(c,h),d.roundness=u,this.points.push(d)}return this.shapeHoles=(n=t.shapeHoles)!=null&&n.length?t.shapeHoles.map(i=>{let r=new _i;return r.fromJSON(i),r}):[],this.isClosed=t.isClosed,this._roundness=t.roundness,this._update(),this}fromShape(t){let e=(i,r)=>{r instanceof Ga&&r.v3.equals(i.position)&&i.controls[0].position.copy(r.v2)},n=i=>{let r=[],s,o;for(s=0,o=i.length;s<o;s++)i[s]instanceof qh&&(i[s]=x3e(i[s]));for(s=0,o=i.length;s<o;s++){let c=i[s],h=s>0?i[s-1]:null,u;c instanceof Ga?(u=this.createPoint(c.v0),u.controls[1].position.copy(c.v1)):c instanceof Qa&&(u=this.createPoint(c.v1)),u!==void 0&&(h!==null&&e(u,h),r.push(u))}let a=i[i.length-1],l=!1;return a instanceof Ga?a.v3.equals(r[0].position)&&(r[0].controls[0].position.copy(a.v2),l=!0):a instanceof Qa&&a.v2.equals(r[0].position)&&(l=!0),this.isClosed=l,r};return this.points=n(t.curves),t instanceof UA&&(this.shapeHoles=t.holes.map(i=>{let r=new _i;return r.fromShape(i),r})),this.update(),this}updatePoint(t,e){let n=this.getPointByUuid(t);n&&(e.position!==void 0&&n.position.fromArray(e.position),e.roundness!==void 0&&(n.roundness=e.roundness),e.areControlsDirectionsMirrored!==void 0&&(n.areControlsDirectionsMirrored=e.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(t,e){var i;let n=(i=this.getPointByUuid(t))==null?void 0:i.controls[0];n&&(e.position&&n.position.fromArray(e.position),this.needsUpdate=!0)}updateNextControl(t,e){var i;let n=(i=this.getPointByUuid(t))==null?void 0:i.controls[1];n&&(e.position&&n.position.fromArray(e.position),this.needsUpdate=!0)}},BI=Math.PI*2;function k2({x:t,y:e},n,i,r,s){return{x:t*n+r,y:e*i+s}}function O3e(t,e){let n=e===1.5707963267948966?.551915024494:e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),i=Math.cos(t),r=Math.sin(t),s=Math.cos(t+e),o=Math.sin(t+e);return[{x:i-r*n,y:r+i*n},{x:s+o*n,y:o-s*n},{x:s,y:o}]}function qj(t,e,n,i){let r=t*i-e*n<0?-1:1,s=Math.min(1,Math.max(-1,t*n+e*i));return r*Math.acos(s)}function F3e(t,e,n,i,r,s,o,a,l,c){let h=Math.pow(r,2),u=Math.pow(s,2),d=Math.pow(o,2),f=Math.pow(a,2),p=h*u-h*f-u*d;p<0&&(p=0),p/=h*f+u*d,p=Math.sqrt(p)*(l===c?-1:1);let v=p*r/s*a,g=p*-s/r*o,m=v+(t+n)/2,y=g+(e+i)/2,w=(o-v)/r,b=(a-g)/s,A=(-o-v)/r,S=(-a-g)/s,T=qj(1,0,w,b),M=qj(w,b,A,S);return!c&&M>0&&(M-=BI),c&&M<0&&(M+=BI),{centerx:m,centery:y,ang1:T,ang2:M}}function N3e({px:t,py:e,cx:n,cy:i,rx:r,ry:s,largeArcFlag:o,sweepFlag:a}){let l=[];if(r===0||s===0)return[];let c=(t-n)/2,h=(e-i)/2;if(c===0&&h===0)return[];r=Math.abs(r),s=Math.abs(s);let u=Math.pow(c,2)/Math.pow(r,2)+Math.pow(h,2)/Math.pow(s,2);u>1&&(r*=Math.sqrt(u),s*=Math.sqrt(u));let d=F3e(t,e,n,i,r,s,c,h,o,a),{ang1:f,ang2:p}=d,{centerx:v,centery:g}=d,m=Math.abs(p)/(BI/4);Math.abs(1-m)<1e-7&&(m=1);let y=Math.max(Math.ceil(m),1);p/=y;for(let w=0;w<y;w++)l.push(O3e(f,p)),f+=p;return l.map(w=>{let{x:b,y:A}=k2(w[0],r,s,v,g),{x:S,y:T}=k2(w[1],r,s,v,g),{x:M,y:E}=k2(w[2],r,s,v,g);return{x1:b,y1:A,x2:S,y2:T,x:M,y:E}})}var Rn;(function(t){t[t.ODD=0]="ODD",t[t.NONZERO=1]="NONZERO",t[t.POSITIVE=2]="POSITIVE",t[t.NEGATIVE=3]="NEGATIVE",t[t.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(Rn||(Rn={}));var Gi;(function(t){t[t.POLYGONS=0]="POLYGONS",t[t.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",t[t.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(Gi||(Gi={}));function Pt(t,e){if(!t)throw e||"Assertion Failed!"}var At=function(){function t(){}return t.vertEq=function(e,n){return e.s===n.s&&e.t===n.t},t.vertLeq=function(e,n){return e.s<n.s||e.s===n.s&&e.t<=n.t},t.transLeq=function(e,n){return e.t<n.t||e.t===n.t&&e.s<=n.s},t.edgeGoesLeft=function(e){return t.vertLeq(e.Dst,e.Org)},t.edgeGoesRight=function(e){return t.vertLeq(e.Org,e.Dst)},t.vertL1dist=function(e,n){return Math.abs(e.s-n.s)+Math.abs(e.t-n.t)},t.edgeEval=function(e,n,i){Pt(t.vertLeq(e,n)&&t.vertLeq(n,i));var r=n.s-e.s,s=i.s-n.s;return r+s>0?r<s?n.t-e.t+(e.t-i.t)*(r/(r+s)):n.t-i.t+(i.t-e.t)*(s/(r+s)):0},t.edgeSign=function(e,n,i){Pt(t.vertLeq(e,n)&&t.vertLeq(n,i));var r=n.s-e.s,s=i.s-n.s;return r+s>0?(n.t-i.t)*r+(n.t-e.t)*s:0},t.transEval=function(e,n,i){Pt(t.transLeq(e,n)&&t.transLeq(n,i));var r=n.t-e.t,s=i.t-n.t;return r+s>0?r<s?n.s-e.s+(e.s-i.s)*(r/(r+s)):n.s-i.s+(i.s-e.s)*(s/(r+s)):0},t.transSign=function(e,n,i){Pt(t.transLeq(e,n)&&t.transLeq(n,i));var r=n.t-e.t,s=i.t-n.t;return r+s>0?(n.s-i.s)*r+(n.s-e.s)*s:0},t.vertCCW=function(e,n,i){return e.s*(n.t-i.t)+n.s*(i.t-e.t)+i.s*(e.t-n.t)>=0},t.interpolate=function(e,n,i,r){return e=e<0?0:e,i=i<0?0:i,e<=i?i===0?(n+r)/2:n+(r-n)*(e/(e+i)):r+(n-r)*(i/(e+i))},t.intersect=function(e,n,i,r,s){var o,a,l;t.vertLeq(e,n)||(l=e,e=n,n=l),t.vertLeq(i,r)||(l=i,i=r,r=l),t.vertLeq(e,i)||(l=e,e=i,i=l,l=n,n=r,r=l),t.vertLeq(i,n)?t.vertLeq(n,r)?(o=t.edgeEval(e,i,n),a=t.edgeEval(i,n,r),o+a<0&&(o=-o,a=-a),s.s=t.interpolate(o,i.s,a,n.s)):(o=t.edgeSign(e,i,n),a=-t.edgeSign(e,r,n),o+a<0&&(o=-o,a=-a),s.s=t.interpolate(o,i.s,a,r.s)):s.s=(i.s+n.s)/2,t.transLeq(e,n)||(l=e,e=n,n=l),t.transLeq(i,r)||(l=i,i=r,r=l),t.transLeq(e,i)||(l=e,e=i,i=l,l=n,n=r,r=l),t.transLeq(i,n)?t.transLeq(n,r)?(o=t.transEval(e,i,n),a=t.transEval(i,n,r),o+a<0&&(o=-o,a=-a),s.t=t.interpolate(o,i.t,a,n.t)):(o=t.transSign(e,i,n),a=-t.transSign(e,r,n),o+a<0&&(o=-o,a=-a),s.t=t.interpolate(o,i.t,a,r.t)):s.t=(i.t+n.t)/2},t}(),k0=function(){function t(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return t}(),zb=function(){function t(e){this.side=e,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(t.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(e){this.Sym.Lface=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(e){this.Sym.Org=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(e){this.Sym.Lnext=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(e){this.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(e){this.Lnext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(e){this.Sym.Onext=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(e){this.Sym.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(e){this.Sym.Lnext.Sym=e},enumerable:!0,configurable:!0}),t}(),_m=function(){function t(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return t}(),Qj=function(){function t(){var e=new _m,n=new k0,i=new zb(0),r=new zb(1);e.next=e.prev=e,e.anEdge=null,n.next=n.prev=n,i.next=i,i.Sym=r,r.next=r,r.Sym=i,this.vHead=e,this.fHead=n,this.eHead=i,this.eHeadSym=r}return t.prototype.makeEdge_=function(e){var n=new zb(0),i=new zb(1);e.Sym.side<e.side&&(e=e.Sym);var r=e.Sym.next;return i.next=r,r.Sym.next=n,n.next=e,e.Sym.next=i,n.Sym=i,n.Onext=n,n.Lnext=i,n.Org=null,n.Lface=null,n.winding=0,n.activeRegion=null,i.Sym=n,i.Onext=i,i.Lnext=n,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,n},t.prototype.splice_=function(e,n){var i=e.Onext,r=n.Onext;i.Sym.Lnext=n,r.Sym.Lnext=e,e.Onext=r,n.Onext=i},t.prototype.makeVertex_=function(e,n,i){var r=e;Pt(r,"Vertex can't be null!");var s=i.prev;r.prev=s,s.next=r,r.next=i,i.prev=r,r.anEdge=n;var o=n;do o.Org=r,o=o.Onext;while(o!==n)},t.prototype.makeFace_=function(e,n,i){var r=e;Pt(r,"Face can't be null");var s=i.prev;r.prev=s,s.next=r,r.next=i,i.prev=r,r.anEdge=n,r.trail=null,r.marked=!1,r.inside=i.inside;var o=n;do o.Lface=r,o=o.Lnext;while(o!==n)},t.prototype.killEdge_=function(e){e.Sym.side<e.side&&(e=e.Sym);var n=e.next,i=e.Sym.next;n.Sym.next=i,i.Sym.next=n},t.prototype.killVertex_=function(e,n){var i=e.anEdge,r=i;do r.Org=n,r=r.Onext;while(r!==i);var s=e.prev,o=e.next;o.prev=s,s.next=o},t.prototype.killFace_=function(e,n){var i=e.anEdge,r=i;do r.Lface=n,r=r.Lnext;while(r!==i);var s=e.prev,o=e.next;o.prev=s,s.next=o},t.prototype.makeEdge=function(){var e=new _m,n=new _m,i=new k0,r=this.makeEdge_(this.eHead);return this.makeVertex_(e,r,this.vHead),this.makeVertex_(n,r.Sym,this.vHead),this.makeFace_(i,r,this.fHead),r},t.prototype.splice=function(e,n){var i=!1,r=!1;if(e!==n){if(n.Org!==e.Org&&(r=!0,this.killVertex_(n.Org,e.Org)),n.Lface!==e.Lface&&(i=!0,this.killFace_(n.Lface,e.Lface)),this.splice_(n,e),!r){var s=new _m;this.makeVertex_(s,n,e.Org),e.Org.anEdge=e}if(!i){var o=new k0;this.makeFace_(o,n,e.Lface),e.Lface.anEdge=e}}},t.prototype.delete=function(e){var n=e.Sym,i=!1;if(e.Lface!==e.Rface&&(i=!0,this.killFace_(e.Lface,e.Rface)),e.Onext===e)this.killVertex_(e.Org,null);else if(e.Rface.anEdge=e.Oprev,e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev),!i){var r=new k0;this.makeFace_(r,e,e.Lface)}n.Onext===n?(this.killVertex_(n.Org,null),this.killFace_(n.Lface,null)):(e.Lface.anEdge=n.Oprev,n.Org.anEdge=n.Onext,this.splice_(n,n.Oprev)),this.killEdge_(e)},t.prototype.addEdgeVertex=function(e){var n=this.makeEdge_(e),i=n.Sym;this.splice_(n,e.Lnext),n.Org=e.Dst;var r=new _m;return this.makeVertex_(r,i,n.Org),n.Lface=i.Lface=e.Lface,n},t.prototype.splitEdge=function(e){var n=this.addEdgeVertex(e),i=n.Sym;return this.splice_(e.Sym,e.Sym.Oprev),this.splice_(e.Sym,i),e.Dst=i.Org,i.Dst.anEdge=i.Sym,i.Rface=e.Rface,i.winding=e.winding,i.Sym.winding=e.Sym.winding,i.idx=e.idx,i.Sym.idx=e.Sym.idx,i},t.prototype.connect=function(e,n){var i=!1,r=this.makeEdge_(e),s=r.Sym;if(n.Lface!==e.Lface&&(i=!0,this.killFace_(n.Lface,e.Lface)),this.splice_(r,e.Lnext),this.splice_(s,n),r.Org=e.Dst,s.Org=n.Org,r.Lface=s.Lface=e.Lface,e.Lface.anEdge=s,!i){var o=new k0;this.makeFace_(o,r,e.Lface)}return r},t.prototype.zapFace=function(e){var n=e.anEdge,i,r,s,o,a;r=n.Lnext;do i=r,r=i.Lnext,i.Lface=null,i.Rface===null&&(i.Onext===i?this.killVertex_(i.Org,null):(i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),s=i.Sym,s.Onext===s?this.killVertex_(s.Org,null):(s.Org.anEdge=s.Onext,this.splice_(s,s.Oprev)),this.killEdge_(i));while(i!=n);o=e.prev,a=e.next,a.prev=o,o.next=a},t.prototype.countFaceVerts_=function(e){var n=e.anEdge,i=0;do i++,n=n.Lnext;while(n!==e.anEdge);return i},t.prototype.mergeConvexFaces=function(e){var n,i,r,s,o,a,l;for(n=this.fHead.next;n!==this.fHead;n=n.next)if(n.inside)for(i=n.anEdge,o=i.Org;r=i.Lnext,s=i.Sym,s&&s.Lface&&s.Lface.inside&&(a=this.countFaceVerts_(n),l=this.countFaceVerts_(s.Lface),a+l-2<=e&&At.vertCCW(i.Lprev.Org,i.Org,s.Lnext.Lnext.Org)&&At.vertCCW(s.Lprev.Org,s.Org,i.Lnext.Lnext.Org)&&(r=s.Lnext,this.delete(s),i=null,s=null)),!(i&&i.Lnext.Org===o);)i=r;return!0},t.prototype.check=function(){var e=this.fHead,n=this.vHead,i=this.eHead,r,s,o,a,l,c;for(s=e,s=e;(r=s.next)!==e;s=r){Pt(r.prev===s),l=r.anEdge;do Pt(l.Sym!==l),Pt(l.Sym.Sym===l),Pt(l.Lnext.Onext.Sym===l),Pt(l.Onext.Sym.Lnext===l),Pt(l.Lface===r),l=l.Lnext;while(l!==r.anEdge)}for(Pt(r.prev===s&&r.anEdge===null),a=n,a=n;(o=a.next)!==n;a=o){Pt(o.prev===a),l=o.anEdge;do Pt(l.Sym!==l),Pt(l.Sym.Sym===l),Pt(l.Lnext.Onext.Sym===l),Pt(l.Onext.Sym.Lnext===l),Pt(l.Org===o),l=l.Onext;while(l!==o.anEdge)}for(Pt(o.prev===a&&o.anEdge===null),c=i,c=i;(l=c.next)!==i;c=l)Pt(l.Sym.next===c.Sym),Pt(l.Sym!==l),Pt(l.Sym.Sym===l),Pt(l.Org!==null),Pt(l.Dst!==null),Pt(l.Lnext.Onext.Sym===l),Pt(l.Onext.Sym.Lnext===l);Pt(l.Sym.next===c.Sym&&l.Sym===this.eHeadSym&&l.Sym.Sym===l&&l.Org===null&&l.Dst===null&&l.Lface===null&&l.Rface===null)},t}(),Kj=function(){function t(){this.handle=null}return t}(),Jj=function(){function t(){this.key=null,this.node=0}return t}(),U3e=function(){function t(e,n){this.leq=n,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=e,this.nodes=[],this.handles=[];for(var i=0;i<e+1;i++)this.nodes[i]=new Kj,this.handles[i]=new Jj;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return t.prototype.floatDown_=function(e){var n=this.nodes,i=this.handles,r,s,o;for(r=n[e].handle;;){if(o=e<<1,o<this.size&&this.leq(i[n[o+1].handle].key,i[n[o].handle].key)&&++o,Pt(o<=this.max),s=n[o].handle,o>this.size||this.leq(i[r].key,i[s].key)){n[e].handle=r,i[r].node=e;break}n[e].handle=s,i[s].node=e,e=o}},t.prototype.floatUp_=function(e){var n=this.nodes,i=this.handles,r,s,o;for(r=n[e].handle;;){if(o=e>>1,s=n[o].handle,o===0||this.leq(i[s].key,i[r].key)){n[e].handle=r,i[r].node=e;break}n[e].handle=s,i[s].node=e,e=o}},t.prototype.init=function(){for(var e=this.size;e>=1;--e)this.floatDown_(e);this.initialized=!0},t.prototype.min=function(){return this.handles[this.nodes[1].handle].key},t.prototype.insert=function(e){var n,i;if(n=++this.size,n*2>this.max){this.max*=2;var r,s;for(s=this.nodes.length,this.nodes.length=this.max+1,r=s;r<this.nodes.length;r++)this.nodes[r]=new Kj;for(s=this.handles.length,this.handles.length=this.max+1,r=s;r<this.handles.length;r++)this.handles[r]=new Jj}return this.freeList===0?i=n:(i=this.freeList,this.freeList=this.handles[i].node),this.nodes[n].handle=i,this.handles[i].node=n,this.handles[i].key=e,this.initialized&&this.floatUp_(n),i},t.prototype.extractMin=function(){var e=this.nodes,n=this.handles,i=e[1].handle,r=n[i].key;return this.size>0&&(e[1].handle=e[this.size].handle,n[e[1].handle].node=1,n[i].key=null,n[i].node=this.freeList,this.freeList=i,--this.size,this.size>0&&this.floatDown_(1)),r},t.prototype.delete=function(e){var n=this.nodes,i=this.handles,r;Pt(e>=1&&e<=this.max&&i[e].key!==null),r=i[e].node,n[r].handle=n[this.size].handle,i[n[r].handle].node=r,--this.size,r<=this.size&&(r<=1||this.leq(i[n[r>>1].handle].key,i[n[r].handle].key)?this.floatDown_(r):this.floatUp_(r)),i[e].key=null,i[e].node=this.freeList,this.freeList=e},t}(),z2=function(){function t(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return t}(),Zj=function(){function t(){this.key=null,this.next=null,this.prev=null}return t}(),k3e=function(){function t(e,n){this.frame=e,this.leq=n,this.head=new Zj,this.head.next=this.head,this.head.prev=this.head}return t.prototype.min=function(){return this.head.next},t.prototype.max=function(){return this.head.prev},t.prototype.insert=function(e){return this.insertBefore(this.head,e)},t.prototype.search=function(e){var n=this.head;do n=n.next;while(n.key!==null&&!this.leq(this.frame,e,n.key));return n},t.prototype.insertBefore=function(e,n){do e=e.prev;while(e.key!==null&&!this.leq(this.frame,e.key,n));var i=new Zj;return i.key=n,i.next=e.next,e.next.prev=i,i.prev=e,e.next=i,i},t.prototype.delete=function(e){e.next.prev=e.prev,e.prev.next=e.next},t}(),z3e=function(){function t(){}return t.regionBelow=function(e){return e.nodeUp.prev.key},t.regionAbove=function(e){return e.nodeUp.next.key},t.debugEvent=function(e){},t.addWinding=function(e,n){e.winding+=n.winding,e.Sym.winding+=n.Sym.winding},t.edgeLeq=function(e,n,i){var r=e.event,s=n.eUp,o=i.eUp;if(s.Dst===r)return o.Dst===r?At.vertLeq(s.Org,o.Org)?At.edgeSign(o.Dst,s.Org,o.Org)<=0:At.edgeSign(s.Dst,o.Org,s.Org)>=0:At.edgeSign(o.Dst,r,o.Org)<=0;if(o.Dst===r)return At.edgeSign(s.Dst,r,s.Org)>=0;var a=At.edgeEval(s.Dst,r,s.Org),l=At.edgeEval(o.Dst,r,o.Org);return a>=l},t.deleteRegion=function(e,n){n.fixUpperEdge&&Pt(n.eUp.winding===0),n.eUp.activeRegion=null,e.dict.delete(n.nodeUp)},t.fixUpperEdge=function(e,n,i){Pt(n.fixUpperEdge),e.mesh.delete(n.eUp),n.fixUpperEdge=!1,n.eUp=i,i.activeRegion=n},t.topLeftRegion=function(e,n){var i=n.eUp.Org,r;do n=t.regionAbove(n);while(n.eUp.Org===i);if(n.fixUpperEdge){if(r=e.mesh.connect(t.regionBelow(n).eUp.Sym,n.eUp.Lnext),r===null)return null;t.fixUpperEdge(e,n,r),n=t.regionAbove(n)}return n},t.topRightRegion=function(e){var n=e.eUp.Dst;do e=t.regionAbove(e);while(e.eUp.Dst===n);return e},t.addRegionBelow=function(e,n,i){var r=new z2;return r.eUp=i,r.nodeUp=e.dict.insertBefore(n.nodeUp,r),r.fixUpperEdge=!1,r.sentinel=!1,r.dirty=!1,i.activeRegion=r,r},t.isWindingInside=function(e,n){switch(e.windingRule){case Rn.ODD:return(n&1)!==0;case Rn.NONZERO:return n!==0;case Rn.POSITIVE:return n>0;case Rn.NEGATIVE:return n<0;case Rn.ABS_GEQ_TWO:return n>=2||n<=-2}throw new Error("Invalid winding rulle")},t.computeWinding=function(e,n){n.windingNumber=t.regionAbove(n).windingNumber+n.eUp.winding,n.inside=t.isWindingInside(e,n.windingNumber)},t.finishRegion=function(e,n){var i=n.eUp,r=i.Lface;r.inside=n.inside,r.anEdge=i,t.deleteRegion(e,n)},t.finishLeftRegions=function(e,n,i){for(var r,s=null,o=n,a=n.eUp;o!==i;){if(o.fixUpperEdge=!1,s=t.regionBelow(o),r=s.eUp,r.Org!=a.Org){if(!s.fixUpperEdge){t.finishRegion(e,o);break}r=e.mesh.connect(a.Lprev,r.Sym),t.fixUpperEdge(e,s,r)}a.Onext!==r&&(e.mesh.splice(r.Oprev,r),e.mesh.splice(a,r)),t.finishRegion(e,o),a=s.eUp,o=s}return a},t.addRightEdges=function(e,n,i,r,s,o){var a,l,c,h,u=!0;c=i;do Pt(At.vertLeq(c.Org,c.Dst)),t.addRegionBelow(e,n,c.Sym),c=c.Onext;while(c!==r);for(s===null&&(s=t.regionBelow(n).eUp.Rprev),l=n,h=s;a=t.regionBelow(l),c=a.eUp.Sym,c.Org===h.Org;)c.Onext!==h&&(e.mesh.splice(c.Oprev,c),e.mesh.splice(h.Oprev,c)),a.windingNumber=l.windingNumber-c.winding,a.inside=t.isWindingInside(e,a.windingNumber),l.dirty=!0,!u&&t.checkForRightSplice(e,l)&&(t.addWinding(c,h),t.deleteRegion(e,l),e.mesh.delete(h)),u=!1,l=a,h=c;l.dirty=!0,Pt(l.windingNumber-c.winding===a.windingNumber),o&&t.walkDirtyRegions(e,l)},t.spliceMergeVertices=function(e,n,i){e.mesh.splice(n,i)},t.vertexWeights=function(e,n,i){var r=At.vertL1dist(n,e),s=At.vertL1dist(i,e),o=.5*s/(r+s),a=.5*r/(r+s);e.coords[0]+=o*n.coords[0]+a*i.coords[0],e.coords[1]+=o*n.coords[1]+a*i.coords[1],e.coords[2]+=o*n.coords[2]+a*i.coords[2]},t.getIntersectData=function(e,n,i,r,s,o){n.coords[0]=n.coords[1]=n.coords[2]=0,n.idx=-1,t.vertexWeights(n,i,r),t.vertexWeights(n,s,o)},t.checkForRightSplice=function(e,n){var i=t.regionBelow(n),r=n.eUp,s=i.eUp;if(At.vertLeq(r.Org,s.Org)){if(At.edgeSign(s.Dst,r.Org,s.Org)>0)return!1;At.vertEq(r.Org,s.Org)?r.Org!==s.Org&&(e.pq.delete(r.Org.pqHandle),t.spliceMergeVertices(e,s.Oprev,r)):(e.mesh.splitEdge(s.Sym),e.mesh.splice(r,s.Oprev),n.dirty=i.dirty=!0)}else{if(At.edgeSign(r.Dst,s.Org,r.Org)<0)return!1;t.regionAbove(n).dirty=n.dirty=!0,e.mesh.splitEdge(r.Sym),e.mesh.splice(s.Oprev,r)}return!0},t.checkForLeftSplice=function(e,n){var i=t.regionBelow(n),r=n.eUp,s=i.eUp,o;if(Pt(!At.vertEq(r.Dst,s.Dst)),At.vertLeq(r.Dst,s.Dst)){if(At.edgeSign(r.Dst,s.Dst,r.Org)<0)return!1;t.regionAbove(n).dirty=n.dirty=!0,o=e.mesh.splitEdge(r),e.mesh.splice(s.Sym,o),o.Lface.inside=n.inside}else{if(At.edgeSign(s.Dst,r.Dst,s.Org)>0)return!1;n.dirty=i.dirty=!0,o=e.mesh.splitEdge(s),e.mesh.splice(r.Lnext,s.Sym),o.Rface.inside=n.inside}return!0},t.checkForIntersect=function(e,n){var i=t.regionBelow(n),r=n.eUp,s=i.eUp,o=r.Org,a=s.Org,l=r.Dst,c=s.Dst,h,u,d=new _m,f,p;if(Pt(!At.vertEq(c,l)),Pt(At.edgeSign(l,e.event,o)<=0),Pt(At.edgeSign(c,e.event,a)>=0),Pt(o!==e.event&&a!==e.event),Pt(!n.fixUpperEdge&&!i.fixUpperEdge),o===a||(h=Math.min(o.t,l.t),u=Math.max(a.t,c.t),h>u))return!1;if(At.vertLeq(o,a)){if(At.edgeSign(c,o,a)>0)return!1}else if(At.edgeSign(l,a,o)<0)return!1;return t.debugEvent(e),At.intersect(l,o,c,a,d),Pt(Math.min(o.t,l.t)<=d.t),Pt(d.t<=Math.max(a.t,c.t)),Pt(Math.min(c.s,l.s)<=d.s),Pt(d.s<=Math.max(a.s,o.s)),At.vertLeq(d,e.event)&&(d.s=e.event.s,d.t=e.event.t),f=At.vertLeq(o,a)?o:a,At.vertLeq(f,d)&&(d.s=f.s,d.t=f.t),At.vertEq(d,o)||At.vertEq(d,a)?(t.checkForRightSplice(e,n),!1):!At.vertEq(l,e.event)&&At.edgeSign(l,e.event,d)>=0||!At.vertEq(c,e.event)&&At.edgeSign(c,e.event,d)<=0?c===e.event?(e.mesh.splitEdge(r.Sym),e.mesh.splice(s.Sym,r),n=t.topLeftRegion(e,n),r=t.regionBelow(n).eUp,t.finishLeftRegions(e,t.regionBelow(n),i),t.addRightEdges(e,n,r.Oprev,r,r,!0),!0):l===e.event?(e.mesh.splitEdge(s.Sym),e.mesh.splice(r.Lnext,s.Oprev),i=n,n=t.topRightRegion(n),p=t.regionBelow(n).eUp.Rprev,i.eUp=s.Oprev,s=t.finishLeftRegions(e,i,null),t.addRightEdges(e,n,s.Onext,r.Rprev,p,!0),!0):(At.edgeSign(l,e.event,d)>=0&&(t.regionAbove(n).dirty=n.dirty=!0,e.mesh.splitEdge(r.Sym),r.Org.s=e.event.s,r.Org.t=e.event.t),At.edgeSign(c,e.event,d)<=0&&(n.dirty=i.dirty=!0,e.mesh.splitEdge(s.Sym),s.Org.s=e.event.s,s.Org.t=e.event.t),!1):(e.mesh.splitEdge(r.Sym),e.mesh.splitEdge(s.Sym),e.mesh.splice(s.Oprev,r),r.Org.s=d.s,r.Org.t=d.t,r.Org.pqHandle=e.pq.insert(r.Org),t.getIntersectData(e,r.Org,o,l,a,c),t.regionAbove(n).dirty=n.dirty=i.dirty=!0,!1)},t.walkDirtyRegions=function(e,n){for(var i=t.regionBelow(n),r,s;;){for(;i.dirty;)n=i,i=t.regionBelow(i);if(!n.dirty&&(i=n,n=t.regionAbove(n),n===null||!n.dirty))return;if(n.dirty=!1,r=n.eUp,s=i.eUp,r.Dst!==s.Dst&&t.checkForLeftSplice(e,n)&&(i.fixUpperEdge?(t.deleteRegion(e,i),e.mesh.delete(s),i=t.regionBelow(n),s=i.eUp):n.fixUpperEdge&&(t.deleteRegion(e,n),e.mesh.delete(r),n=t.regionAbove(i),r=n.eUp)),r.Org!==s.Org)if(r.Dst!==s.Dst&&!n.fixUpperEdge&&!i.fixUpperEdge&&(r.Dst===e.event||s.Dst===e.event)){if(t.checkForIntersect(e,n))return}else t.checkForRightSplice(e,n);r.Org===s.Org&&r.Dst===s.Dst&&(t.addWinding(s,r),t.deleteRegion(e,n),e.mesh.delete(r),n=t.regionAbove(i))}},t.connectRightVertex=function(e,n,i){var r,s=i.Onext,o=t.regionBelow(n),a=n.eUp,l=o.eUp,c=!1;if(a.Dst!==l.Dst&&t.checkForIntersect(e,n),At.vertEq(a.Org,e.event)&&(e.mesh.splice(s.Oprev,a),n=t.topLeftRegion(e,n),s=t.regionBelow(n).eUp,t.finishLeftRegions(e,t.regionBelow(n),o),c=!0),At.vertEq(l.Org,e.event)&&(e.mesh.splice(i,l.Oprev),i=t.finishLeftRegions(e,o,null),c=!0),c){t.addRightEdges(e,n,i.Onext,s,s,!0);return}At.vertLeq(l.Org,a.Org)?r=l.Oprev:r=a,r=e.mesh.connect(i.Lprev,r),t.addRightEdges(e,n,r,r.Onext,r.Onext,!1),r.Sym.activeRegion.fixUpperEdge=!0,t.walkDirtyRegions(e,n)},t.connectLeftDegenerate=function(e,n,i){var r,s,o,a,l;if(r=n.eUp,At.vertEq(r.Org,i)){Pt(!1),t.spliceMergeVertices(e,r,i.anEdge);return}if(!At.vertEq(r.Dst,i)){e.mesh.splitEdge(r.Sym),n.fixUpperEdge&&(e.mesh.delete(r.Onext),n.fixUpperEdge=!1),e.mesh.splice(i.anEdge,r),t.sweepEvent(e,i);return}Pt(!1),n=t.topRightRegion(n),l=t.regionBelow(n),o=l.eUp.Sym,s=a=o.Onext,l.fixUpperEdge&&(Pt(s!==o),t.deleteRegion(e,l),e.mesh.delete(o),o=s.Oprev),e.mesh.splice(i.anEdge,o),At.edgeGoesLeft(s)||(s=null),t.addRightEdges(e,n,o.Onext,a,s,!0)},t.connectLeftVertex=function(e,n){var i,r,s,o,a,l,c=new z2;if(c.eUp=n.anEdge.Sym,i=e.dict.search(c).key,r=t.regionBelow(i),!!r){if(o=i.eUp,a=r.eUp,At.edgeSign(o.Dst,n,o.Org)===0){t.connectLeftDegenerate(e,i,n);return}if(s=At.vertLeq(a.Dst,o.Dst)?i:r,i.inside||s.fixUpperEdge){if(s===i)l=e.mesh.connect(n.anEdge.Sym,o.Lnext);else{var h=e.mesh.connect(a.Dnext,n.anEdge);l=h.Sym}s.fixUpperEdge?t.fixUpperEdge(e,s,l):t.computeWinding(e,t.addRegionBelow(e,i,l)),t.sweepEvent(e,n)}else t.addRightEdges(e,i,n.anEdge,n.anEdge,null,!0)}},t.sweepEvent=function(e,n){e.event=n,t.debugEvent(e);for(var i=n.anEdge;i.activeRegion===null;)if(i=i.Onext,i===n.anEdge){t.connectLeftVertex(e,n);return}var r=t.topLeftRegion(e,i.activeRegion);Pt(r!==null);var s=t.regionBelow(r),o=s.eUp,a=t.finishLeftRegions(e,s,null);a.Onext===o?t.connectRightVertex(e,r,a):t.addRightEdges(e,r,a.Onext,o,o,!0)},t.addSentinel=function(e,n,i,r){var s=new z2,o=e.mesh.makeEdge();o.Org.s=i,o.Org.t=r,o.Dst.s=n,o.Dst.t=r,e.event=o.Dst,s.eUp=o,s.windingNumber=0,s.inside=!1,s.fixUpperEdge=!1,s.sentinel=!0,s.dirty=!1,s.nodeUp=e.dict.insert(s)},t.initEdgeDict=function(e){e.dict=new k3e(e,t.edgeLeq);var n=e.bmax[0]-e.bmin[0],i=e.bmax[1]-e.bmin[1],r=e.bmin[0]-n,s=e.bmax[0]+n,o=e.bmin[1]-i,a=e.bmax[1]+i;t.addSentinel(e,r,s,o),t.addSentinel(e,r,s,a)},t.doneEdgeDict=function(e){for(var n,i=0;(n=e.dict.min().key)!==null;)n.sentinel||(Pt(n.fixUpperEdge),Pt(++i===1)),Pt(n.windingNumber===0),t.deleteRegion(e,n)},t.removeDegenerateEdges=function(e){var n,i,r,s=e.mesh.eHead;for(n=s.next;n!==s;n=i)i=n.next,r=n.Lnext,At.vertEq(n.Org,n.Dst)&&n.Lnext.Lnext!==n&&(t.spliceMergeVertices(e,r,n),e.mesh.delete(n),n=r,r=n.Lnext),r.Lnext===n&&(r!==n&&((r===i||r===i.Sym)&&(i=i.next),e.mesh.delete(r)),(n===i||n===i.Sym)&&(i=i.next),e.mesh.delete(n))},t.initPriorityQ=function(e){var n,i,r,s=0;for(r=e.mesh.vHead,i=r.next;i!==r;i=i.next)s++;for(s+=8,n=e.pq=new U3e(s,At.vertLeq),r=e.mesh.vHead,i=r.next;i!==r;i=i.next)i.pqHandle=n.insert(i);return i!==r?!1:(n.init(),!0)},t.donePriorityQ=function(e){e.pq=null},t.removeDegenerateFaces=function(e,n){var i,r,s;for(i=n.fHead.next;i!==n.fHead;i=r)r=i.next,s=i.anEdge,Pt(s.Lnext!==s),s.Lnext.Lnext===s&&(t.addWinding(s.Onext,s),e.mesh.delete(s));return!0},t.computeInterior=function(e,n){n===void 0&&(n=!0);var i,r;if(t.removeDegenerateEdges(e),!t.initPriorityQ(e))return!1;for(t.initEdgeDict(e);(i=e.pq.extractMin())!==null;){for(;r=e.pq.min(),!(r===null||!At.vertEq(r,i));)r=e.pq.extractMin(),t.spliceMergeVertices(e,i.anEdge,r.anEdge);t.sweepEvent(e,i)}return e.event=e.dict.min().key.eUp.Org,t.debugEvent(e),t.doneEdgeDict(e),t.donePriorityQ(e),t.removeDegenerateFaces(e,e.mesh)?(n&&e.mesh.check(),!0):!1},t}(),G3e=function(){function t(){this.mesh=new Qj,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=Rn.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return t.prototype.dot_=function(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]},t.prototype.normalize_=function(e){var n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(!n)throw"Zero-size vector!";n=Math.sqrt(n),e[0]/=n,e[1]/=n,e[2]/=n},t.prototype.longAxis_=function(e){var n=0;return Math.abs(e[1])>Math.abs(e[0])&&(n=1),Math.abs(e[2])>Math.abs(e[n])&&(n=2),n},t.prototype.computeNormal_=function(e){var n,i,r,s,o,a,l=[0,0,0],c=[0,0,0],h=[0,0,0],u=[0,0,0],d=[0,0,0],f=[null,null,null],p=[null,null,null],v=this.mesh.vHead;n=v.next;for(var g=0;g<3;++g)s=n.coords[g],c[g]=s,p[g]=n,l[g]=s,f[g]=n;for(n=v.next;n!==v;n=n.next)for(var m=0;m<3;++m)s=n.coords[m],s<c[m]&&(c[m]=s,p[m]=n),s>l[m]&&(l[m]=s,f[m]=n);var y=0;if(l[1]-c[1]>l[0]-c[0]&&(y=1),l[2]-c[2]>l[y]-c[y]&&(y=2),c[y]>=l[y]){e[0]=0,e[1]=0,e[2]=1;return}for(a=0,i=p[y],r=f[y],h[0]=i.coords[0]-r.coords[0],h[1]=i.coords[1]-r.coords[1],h[2]=i.coords[2]-r.coords[2],n=v.next;n!==v;n=n.next)u[0]=n.coords[0]-r.coords[0],u[1]=n.coords[1]-r.coords[1],u[2]=n.coords[2]-r.coords[2],d[0]=h[1]*u[2]-h[2]*u[1],d[1]=h[2]*u[0]-h[0]*u[2],d[2]=h[0]*u[1]-h[1]*u[0],o=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],o>a&&(a=o,e[0]=d[0],e[1]=d[1],e[2]=d[2]);a<=0&&(e[0]=e[1]=e[2]=0,e[this.longAxis_(h)]=1)},t.prototype.checkOrientation_=function(){for(var e=this.mesh.fHead,n,i=this.mesh.vHead,r,s=0,o=e.next;o!==e;o=o.next)if(r=o.anEdge,!(r.winding<=0))do s+=(r.Org.s-r.Dst.s)*(r.Org.t+r.Dst.t),r=r.Lnext;while(r!==o.anEdge);if(s<0){for(n=i.next;n!==i;n=n.next)n.t=-n.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},t.prototype.projectPolygon_=function(){var e=this.mesh.vHead,n=[0,0,0],i,r,s=!1;n[0]=this.normal[0],n[1]=this.normal[1],n[2]=this.normal[2],!n[0]&&!n[1]&&!n[2]&&(this.computeNormal_(n),s=!0),i=this.sUnit,r=this.tUnit;var o=this.longAxis_(n);i[o]=0,i[(o+1)%3]=1,i[(o+2)%3]=0,r[o]=0,r[(o+1)%3]=0,r[(o+2)%3]=n[o]>0?1:-1;for(var a=e.next;a!==e;a=a.next)a.s=this.dot_(a.coords,i),a.t=this.dot_(a.coords,r);s&&this.checkOrientation_();for(var l=!0,c=e.next;c!==e;c=c.next)l?(this.bmin[0]=this.bmax[0]=c.s,this.bmin[1]=this.bmax[1]=c.t,l=!1):(c.s<this.bmin[0]&&(this.bmin[0]=c.s),c.s>this.bmax[0]&&(this.bmax[0]=c.s),c.t<this.bmin[1]&&(this.bmin[1]=c.t),c.t>this.bmax[1]&&(this.bmax[1]=c.t))},t.prototype.addWinding_=function(e,n){e.winding+=n.winding,e.Sym.winding+=n.Sym.winding},t.prototype.tessellateMonoRegion_=function(e,n){var i,r;if(i=n.anEdge,!(i.Lnext!==i&&i.Lnext.Lnext!==i))throw"Mono region invalid";for(;At.vertLeq(i.Dst,i.Org);i=i.Lprev);for(;At.vertLeq(i.Org,i.Dst);i=i.Lnext);r=i.Lprev;for(var s=void 0;i.Lnext!==r;)if(At.vertLeq(i.Dst,r.Org)){for(;r.Lnext!==i&&(At.edgeGoesLeft(r.Lnext)||At.edgeSign(r.Org,r.Dst,r.Lnext.Dst)<=0);)s=e.connect(r.Lnext,r),r=s.Sym;r=r.Lprev}else{for(;r.Lnext!==i&&(At.edgeGoesRight(i.Lprev)||At.edgeSign(i.Dst,i.Org,i.Lprev.Org)>=0);)s=e.connect(i,i.Lprev),i=s.Sym;i=i.Lnext}if(r.Lnext===i)throw"Mono region invalid";for(;r.Lnext.Lnext!==i;)s=e.connect(r.Lnext,r),r=s.Sym;return!0},t.prototype.tessellateInterior_=function(e){for(var n,i=e.fHead.next;i!==e.fHead;i=n)if(n=i.next,i.inside&&!this.tessellateMonoRegion_(e,i))return!1;return!0},t.prototype.discardExterior_=function(e){for(var n,i=e.fHead.next;i!==e.fHead;i=n)n=i.next,i.inside||e.zapFace(i)},t.prototype.setWindingNumber_=function(e,n,i){for(var r,s=e.eHead.next;s!==e.eHead;s=r)r=s.next,s.Rface.inside!==s.Lface.inside?s.winding=s.Lface.inside?n:-n:i?e.delete(s):s.winding=0},t.prototype.getNeighbourFace_=function(e){return!e.Rface||!e.Rface.inside?-1:e.Rface.n},t.prototype.outputPolymesh_=function(e,n,i,r){var s,o=0,a=0,l;i>3&&e.mergeConvexFaces(i);for(var c=e.vHead.next;c!==e.vHead;c=c.next)c.n=-1;for(var h=e.fHead.next;h!==e.fHead;h=h.next)if(h.n=-1,!!h.inside){s=h.anEdge,l=0;do{var c=s.Org;c.n===-1&&(c.n=a,a++),l++,s=s.Lnext}while(s!==h.anEdge);if(l>i)throw"Face vertex greater that support polygon";h.n=o,++o}this.elementCount=o,n===Gi.CONNECTED_POLYGONS&&(o*=2),this.elements=[],this.elements.length=o*i,this.vertexCount=a,this.vertices=[],this.vertices.length=a*r,this.vertexIndices=[],this.vertexIndices.length=a;for(var c=e.vHead.next;c!==e.vHead;c=c.next)if(c.n!==-1){var u=c.n*r;this.vertices[u+0]=c.coords[0],this.vertices[u+1]=c.coords[1],r>2&&(this.vertices[u+2]=c.coords[2]),this.vertexIndices[c.n]=c.idx}for(var d=0,h=e.fHead.next;h!==e.fHead;h=h.next)if(h.inside){s=h.anEdge,l=0;do{var c=s.Org;this.elements[d++]=c.n,l++,s=s.Lnext}while(s!==h.anEdge);for(var f=l;f<i;++f)this.elements[d++]=-1;if(n===Gi.CONNECTED_POLYGONS){s=h.anEdge;do this.elements[d++]=this.getNeighbourFace_(s),s=s.Lnext;while(s!==h.anEdge);for(var p=l;p<i;++p)this.elements[d++]=-1}}},t.prototype.outputContours_=function(e,n){var i,r,s=0,o=0;this.vertexCount=0,this.elementCount=0;for(var a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){r=i=a.anEdge;do this.vertexCount++,i=i.Lnext;while(i!==r);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*n,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var l=0,c=0,h=0;s=0;for(var a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){o=0,r=i=a.anEdge;do this.vertices[l++]=i.Org.coords[0],this.vertices[l++]=i.Org.coords[1],n>2&&(this.vertices[l++]=i.Org.coords[2]),this.vertexIndices[c++]=this.vertexIdCallback?this.vertexIdCallback(i):i.Org.idx,o++,i=i.Lnext;while(i!==r);this.elements[h++]=s,this.elements[h++]=o,s+=o}},t.prototype.addContour=function(e,n){this.mesh===null&&(this.mesh=new Qj),e<2&&(e=2),e>3&&(e=3);for(var i=null,r=0;r<n.length;r+=e)i===null?(i=this.mesh.makeEdge(),this.mesh.splice(i,i.Sym)):(this.mesh.splitEdge(i),i=i.Lnext),i.Org.coords[0]=n[r+0],i.Org.coords[1]=n[r+1],e>2?i.Org.coords[2]=n[r+2]:i.Org.coords[2]=0,i.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(i),i.winding=1,i.Sym.winding=-1},t.prototype.tesselate=function(e,n,i,r,s,o){if(e===void 0&&(e=Rn.ODD),n===void 0&&(n=Gi.POLYGONS),o===void 0&&(o=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,s&&(this.normal[0]=s[0],this.normal[1]=s[1],this.normal[2]=s[2]),this.windingRule=e,r<2&&(r=2),r>3&&(r=3),!this.mesh)return!1;this.projectPolygon_(),z3e.computeInterior(this,o);var a=this.mesh;return n===Gi.BOUNDARY_CONTOURS?this.setWindingNumber_(a,1,!0):this.tessellateInterior_(a),o&&a.check(),n===Gi.BOUNDARY_CONTOURS?this.outputContours_(a,r):this.outputPolymesh_(a,n,i,r),!0},t}();function xh(t){var e=t.windingRule,n=e===void 0?Rn.ODD:e,i=t.elementType,r=i===void 0?Gi.POLYGONS:i,s=t.polySize,o=s===void 0?3:s,a=t.vertexSize,l=a===void 0?2:a,c=t.normal,h=c===void 0?[0,0,1]:c,u=t.contours,d=u===void 0?[]:u,f=t.strict,p=f===void 0?!0:f,v=t.debug,g=v===void 0?!1:v;if(!d&&p)throw new Error("Contours can't be empty");if(d){var m=new G3e;t.edgeCreateCallback&&(m.edgeCreateCallback=t.edgeCreateCallback),t.vertexIdCallback&&(m.vertexIdCallback=t.vertexIdCallback);for(var y=0;y<d.length;y++)m.addContour(l||2,d[y]);return m.tesselate(n,r,o,l,h,p),{vertices:m.vertices,vertexIndices:m.vertexIndices,vertexCount:m.vertexCount,elements:m.elements,elementCount:m.elementCount,mesh:g?m.mesh:void 0}}}Rn.ODD;Rn.NONZERO;Rn.POSITIVE;Rn.NEGATIVE;Rn.ABS_GEQ_TWO;Gi.POLYGONS;Gi.CONNECTED_POLYGONS;Gi.BOUNDARY_CONTOURS;var OI=class{constructor(t=256,e=!1){this.capacity=t,this.size=0,this.debug=e,this.debug&&console.log(`allocating with cap ${t}`);let n=t*OI.eSize;this.buffer=new ArrayBuffer(n);let i=Float32Array.BYTES_PER_ELEMENT,r=0;this.positions=new Float32Array(this.buffer,r*i,3*t),r+=3*t,this.normals=new Float32Array(this.buffer,r*i,3*t),r+=3*t,this.uvs=new Float32Array(this.buffer,r*i,2*t)}realloc(t,e=!1){if(t<this.size)throw Error("cannot shrink buffer");if(t<=this.capacity&&!e)return;this.debug&&console.log(`resizing from ${this.capacity}  ${t}`);let n=t*OI.eSize,i=new ArrayBuffer(n),r=Float32Array.BYTES_PER_ELEMENT,s=0,o=new Float32Array(i,s*r,3*t);s+=3*t;let a=new Float32Array(i,s*r,3*t);s+=3*t;let l=new Float32Array(i,s*r,2*t);o.set(this.positions.slice(0,this.size*3)),a.set(this.normals.slice(0,this.size*3)),l.set(this.uvs.slice(0,this.size*2)),this.buffer=i,this.positions=o,this.normals=a,this.uvs=l,this.capacity=t}get(t=1){let e=this.size+t;if(e>this.capacity){let i=this.capacity;for(;e>i;)i*=2;this.realloc(i)}let n=this.size;return this.size=e,n}reserve(t){let e=this.size+t;e>this.capacity&&this.realloc(e)}shrink(){this.debug&&console.log(`shrinking ${this.capacity}  ${this.size}`),this.realloc(this.size,!0)}},ZJ=OI;ZJ.eSize=(3+3+2)*Float32Array.BYTES_PER_ELEMENT;var PF={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},$J={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},eZ={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},G2=(t,e)=>([n,i])=>(i<n&&(i+=e),(t>=n?t:t+e)<=i),tZ=class extends Lt{constructor(t,e,n=0,i=12,r=3,s=Rn.ODD){super(),this.type="ShapeGeometry",this.vertexCache={},this._shape=t,this._depth=e,this._bevel=n,this._curveSegments=i,this._bevelSegmentsInput=r,n<=0?(this._bevelSize=0,this._bevelSegments=0):(this._bevelSize=Math.min(n,e/2-1e-12),this._bevelSegments=Math.floor(r));let o=this._shape.extractShapePointsToFlatArray([],i),a=this._shape.shapeHoles.map(A=>{let S=A.extractShapePointsToFlatArray([],i),T=[];for(let M=S.length-1;M>=1;M-=2){let E=S[M-1],P=S[M-0];T.push(E,P)}return T}),l;try{l=xh({windingRule:s,elementType:Gi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[o]})}catch{l=PF}let c;try{c=xh({windingRule:Rn.ODD,elementType:Gi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...a]})}catch{c=$J}if(!l)throw new Error("error generating geometry");let h=l.elementCount;if(c){l.elementCount+=c.elementCount;for(let A=0;A<c.elements.length;A++){let S=c.elements[A],T=A%2===0?l.vertexCount:0;l.elements.push(S+T)}for(let A=0;A<c.vertexIndices.length;A++){let S=c.vertexIndices[A],T=l.vertexCount;l.vertexIndices.push(S+T)}for(let A=0;A<c.vertices.length;A++){let S=c.vertices[A];l.vertices.push(S)}}let u=1/0,d=-1/0,f=1/0,p=-1/0;for(let A=0,S=l.vertexCount;A<S;A++){let T=A*2,M=l.vertices[T+0],E=l.vertices[T+1];M<u&&(u=M),M>d&&(d=M),E<f&&(f=E),E>p&&(p=E)}this._minX=u,this._minY=f,this._width=d-u,this._height=p-f,this._buffer=new ZJ(this._computeBufferEstimatedSize(l));let v=[],g=[];for(let A=l.elementCount-1;A>=0;A--){let S=A>=h,T=A*2,M=l.elements[T+0],E=l.elements[T+1],P=M+E,R={start:M,count:E,normals:[],continuous:[],concave:[]},F=M,B=P-1,k=M+1,j=this._shape.roundedCurves.length;do{let W=F-M,H=l.vertices[B*2+0],Y=l.vertices[B*2+1],z=l.vertices[F*2+0],X=l.vertices[F*2+1],q=l.vertices[k*2+0],re=l.vertices[k*2+1],G=z-H,K=X-Y,oe=Math.sqrt(G*G+K*K);G/=oe,K/=oe;let ve=z-q,$=X-re,se=Math.sqrt(ve*ve+$*$);ve/=se,$/=se,R.normals[W*2+0]=-$,R.normals[W*2+1]=ve,R.concave[W]=G*$-K*ve>0;let ne=l.vertexIndices[F];if(Array.isArray(ne))R.continuous[W]=!1;else{let[ie,me]=this._shape.getCurveIndexFromVertexId(ne-1,!0);if(me>0&&me<1)R.continuous[W]=!0;else{let xe=me===1?ie+1:ie-1;xe=(xe+j)%j;let Ae=me===1?0:1,_e=this._shape.roundedCurves[ie].getTangent(me),Ee=this._shape.roundedCurves[xe].getTangent(Ae);R.continuous[W]=_e.dot(Ee)>.95}}S&&(R.normals[W*2+0]*=-1,R.normals[W*2+1]*=-1),[B,F,k]=[F,k,k+1],k>=P&&(k-=E)}while(k!==M+1);let Z=[];Z.push({bevelI:0,angle:0,size:0,boundary:{vertices:l.vertices.slice(M*2,P*2),vertexCount:E,vertexIndices:new Array(E).fill(!0).map((W,H)=>[H,H]),elements:[0,E],elementCount:1,mesh:null},reverseMap:[],insetPoints:l.vertices.slice(M*2,P*2)});for(let W=1;W<=this._bevelSegments;W++){let H=W/this._bevelSegments*Math.PI/2,Y=(1-Math.cos(H))*this._bevelSize,z=[],X=[],q=0;for(let G=0;G<E;G++){let K=G*2,oe=(G-1+E)%E*2,ve=l.vertices[R.start*2+K+0],$=l.vertices[R.start*2+K+1],se=-R.normals[oe+0]*Y,ne=-R.normals[oe+1]*Y,ie=-R.normals[K+0]*Y,me=-R.normals[K+1]*Y;if(R.concave[G]||!R.concave[G]&&S){let xe=Math.atan2(ne,se),Ae=Math.atan2(me,ie);Ae>xe&&(Ae-=Math.PI*2);let _e=Ae-xe;if(R.continuous[G]||S){let Ee=xe+_e/2,Re=Math.cos(Ee)*Y,Ue=Math.sin(Ee)*Y;z[2*q+0]=ve+Re*(S?-1:1),z[2*q+1]=$+Ue*(S?-1:1),X[q]=G,q++}else{let Ee=Math.max(1,Math.floor(i/4*Math.abs(_e)/Math.PI));for(let Re=0;Re<=Ee;Re++){let Ue=xe+_e*(Re/Ee),Ne=Math.cos(Ue)*Y,U=Math.sin(Ue)*Y;z[2*q+0]=ve+Ne,z[2*q+1]=$+U,X[q]=G,q++}}}else z[2*q+0]=ve+se,z[2*q+1]=$+ne,X[q]=G,q++,z[2*q+0]=ve,z[2*q+1]=$,X[q]=G,q++,z[2*q+0]=ve+ie,z[2*q+1]=$+me,X[q]=G,q++}let re=xh({windingRule:Rn.POSITIVE,elementType:Gi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[z],edgeCreateCallback:G=>{let K=G.Org.idx,oe=X[K],ve=X[(K+1)%X.length];G.idx=[oe,ve],G.Sym.idx=[ve,oe]},vertexIdCallback:G=>{let K=G.Lprev.idx;return[K?K[1]:0,G.idx?G.idx[0]:0]}});if(!re)throw console.log("Error"),new Error(`error generating bevel geometry for ${W}'th loop`);if(!re.vertexCount)break;for(let G=0;G<re.vertexIndices.length;G++){let[K,oe]=re.vertexIndices[G];if(K===oe)continue;let ve=oe;oe<K&&(ve+=E);for(let $=K;$<ve;$++){let se=$%E,ne=($+1)%E;if(!R.continuous[se]||!R.continuous[ne]){re.vertexIndices[G]=[K,se],re.vertexIndices.splice(G+1,0,[ne,oe]),re.vertices.splice((G+1)*2,0,re.vertices[G*2],re.vertices[G*2+1]);break}}}Z.push({bevelI:W,angle:H,size:Y,boundary:re,reverseMap:X,insetPoints:z})}let ee=(W,H,Y)=>{let z=0,X=W.boundary.vertexIndices.length;for(;z<X&&Y(W.boundary.vertexIndices[H]);)H=(H+1)%X,z++;return z},O=v.length;for(let W=1;W<Z.length;W++){let H=Z[W-1],Y=Z[W],z=H.boundary.vertexIndices.length,X=Y.boundary.vertexIndices.length;if(!z||!X)break;let q=R.concave.length,re=0,G=G2(re,E);for(;!H.boundary.vertexIndices.filter(G).length||!Y.boundary.vertexIndices.filter(G).length;)re++,G=G2(re,E);let K=H.boundary.vertexIndices.findIndex(G),oe=Y.boundary.vertexIndices.findIndex(G);do K=(K+1)%z;while(G(H.boundary.vertexIndices[K]));do oe=(oe+1)%X;while(G(Y.boundary.vertexIndices[oe]));re=(re+1)%E;let ve=re,$=this._buildBevelVert(R,H,(K-1+z)%z),se=this._buildBevelVert(R,Y,(oe-1+X)%X),ne=$,ie=se,me,xe,Ae=!1;do{G=G2(re,E);let _e=ee(H,K,G),Ee=ee(Y,oe,G),Re=Ae;if(Ae=!1,_e&&!Ee){for(let Ue=0;Ue<_e;Ue++)me=this._buildBevelVert(R,H,(K+Ue)%z,Ue/(_e-1)),v.push(ne.topN,me.topP,ie.topN),v.push(me.bottomP,ne.bottomN,ie.bottomN),ne=me;Ae=!0}else if(!_e&&Ee)for(let Ue=0;Ue<Ee;Ue++)xe=this._buildBevelVert(R,Y,(oe+Ue)%X,Ue/(Ee-1)),v.push(ie.topN,ne.topP,xe.topP),v.push(ne.bottomP,ie.bottomN,xe.bottomP),ie=xe;else if(_e&&Ee)if(me=this._buildBevelVert(R,H,K,0),xe=this._buildBevelVert(R,Y,oe,0),Re?(v.push(ne.topN,xe.topP,ie.topN),v.push(ne.topN,me.topP,xe.topP),v.push(xe.bottomP,ne.bottomN,ie.bottomN),v.push(xe.bottomP,me.bottomP,ne.bottomN)):(v.push(ie.topN,ne.topN,me.topP),v.push(ie.topN,me.topP,xe.topP),v.push(me.bottomP,ne.bottomN,ie.bottomN),v.push(me.bottomP,ie.bottomN,xe.bottomP)),ne=me,ie=xe,_e===Ee)for(let Ue=1;Ue<_e;Ue++)me=this._buildBevelVert(R,H,(K+Ue)%z,Ue/(_e-1)),xe=this._buildBevelVert(R,Y,(oe+Ue)%X,Ue/(Ee-1)),v.push(ne.topN,me.topP,ie.topN),v.push(ie.topN,me.topP,xe.topP),v.push(me.bottomP,ne.bottomN,ie.bottomN),v.push(me.bottomP,ie.bottomN,xe.bottomP),ne=me,ie=xe;else if(_e>Ee){let Ue=_e/Ee,Ne=0;for(let U=1;U<_e;U++)me=this._buildBevelVert(R,H,(K+U)%z,U/(_e-1)),v.push(ne.topN,me.topP,ie.topN),v.push(me.bottomP,ne.bottomN,ie.bottomN),ne=me,U>(Ne+1)*Ue&&(Ne++,xe=this._buildBevelVert(R,Y,(oe+Ne)%X,Ne/(Ee-1)),v.push(ie.topN,me.topP,xe.topP),v.push(me.bottomP,ie.bottomN,xe.bottomP),ie=xe)}else{let Ue=Ee/_e,Ne=0;for(let U=1;U<Ee;U++)xe=this._buildBevelVert(R,Y,(oe+U)%X,U/(Ee-1)),v.push(ie.topN,me.topP,xe.topP),v.push(me.bottomP,ie.bottomN,xe.bottomP),ie=xe,U>(Ne+1)*Ue&&(Ne++,me=this._buildBevelVert(R,H,(K+Ne)%z,Ne/(_e-1)),v.push(ne.topN,me.topP,ie.topN),v.push(me.bottomP,ne.bottomN,ie.bottomN),ne=me)}K=(K+_e)%z,oe=(oe+Ee)%X,re=(re+1)%q}while(re!==ve)}if(this._buildWall(Z,R,v),S){let W=[];for(let H=v.length-1;H>=O+2;H-=3){let Y=v[H-2],z=v[H-1],X=v[H-0];W.push(X,z,Y)}v.splice(O,v.length-O,...W)}if(S){let W=[];for(let H=Z[Z.length-1].boundary.vertices.length-1;H>=1;H-=2){let Y=Z[Z.length-1].boundary.vertices[H-1],z=Z[Z.length-1].boundary.vertices[H-0];W.push(Y,z)}g.push(W)}if(!S){let W=Z[Z.length-1],H;try{H=xh({windingRule:Z.length>1?Rn.POSITIVE:Rn.ODD,elementType:Gi.POLYGONS,vertexSize:2,strict:!0,contours:[W.insetPoints,...g]})}catch{H=eZ}if(!H)throw new Error("Error generating geometry for surface");a.length===0&&Object.assign(this,{capStartIndex:v.length});for(let Y=0;Y<H.elementCount*3;Y+=3){let z=this._buildSurfaceVert(H,H.elements[Y+0]),X=this._buildSurfaceVert(H,H.elements[Y+1]),q=this._buildSurfaceVert(H,H.elements[Y+2]);v.push(z.top,X.top,q.top),v.push(q.bottom,X.bottom,z.bottom)}}this.vertexCache={}}this._buffer.shrink();let m=new Ut(Uint32Array.from(v),1),y=new Ut(this._buffer.positions,3),w=new Ut(this._buffer.normals,3),b=new Ut(this._buffer.uvs,2);y.needsUpdate=!0,w.needsUpdate=!0,b.needsUpdate=!0,m.needsUpdate=!0,this.setAttribute("position",y),this.setAttribute("normal",w),this.setAttribute("uv",b),this.setIndex(m)}_computeBufferEstimatedSize(t){return t.vertexCount*2*(2+this._bevelSegments)}_buildWall(t,e,n){let i=t[0];for(let r=0,s=i.boundary.vertexCount;r<s;r++){let o=this._buildBevelVert(e,i,r),a=this._buildBevelVert(e,i,(r+1)%s);n.push(a.topP,o.topN,o.bottomN),n.push(a.topP,o.bottomN,a.bottomP)}}_buildSurfaceVert(t,e){let n=e.toString();if(n in this.vertexCache)return this.vertexCache[n];let i=t.vertices[e*2+0],r=t.vertices[e*2+1],s=(i-this._minX)/this._width,o=(r-this._minY)/this._height,a=this._buffer.get(2),l=a*3,c=a*2,h={top:a+0,bottom:a+1};return this._buffer.positions[l+0]=i,this._buffer.positions[l+1]=r,this._buffer.positions[l+2]=this._depth,this._buffer.normals[l+0]=0,this._buffer.normals[l+1]=0,this._buffer.normals[l+2]=1,this._buffer.uvs[c+0]=s,this._buffer.uvs[c+1]=o,this._buffer.positions[l+3]=i,this._buffer.positions[l+4]=r,this._buffer.positions[l+5]=0,this._buffer.normals[l+3]=0,this._buffer.normals[l+4]=0,this._buffer.normals[l+5]=-1,this._buffer.uvs[c+2]=s,this._buffer.uvs[c+3]=o,this.vertexCache[n]=h,h}_buildBevelVert(t,e,n,i=1){let r=`${e.bevelI}:${n}`;if(r in this.vertexCache)return this.vertexCache[r];let[s,o]=e.boundary.vertexIndices[n],a,l,c,h;s!==o?(l=s,a=o,h=!1,c=t.continuous[l]&&t.continuous[a]):(a=s,l=(a-1+t.count)%t.count,h=t.concave[a]&&e.bevelI>0,c=t.continuous[a]||h);let u=Math.cos(e.angle),d=Math.sin(e.angle),f=n*2,p=a*2,v=l*2,g=e.boundary.vertices[f+0],m=e.boundary.vertices[f+1],y=(1-d)*this._bevelSize,w=(g-this._minX)/this._width,b=(m-this._minY)/this._height,A=t.normals[p+0],S=t.normals[p+1],T=t.normals[v+0],M=t.normals[v+1];if(h){let B=T-A,k=M-S;A=A+B*(1-i),S=S+k*(1-i);let j=Math.sqrt(A*A+S*S);A/=j,S/=j}let E=this._buffer.get(c?2:4),P=E*3,R=E*2,F={i:n,fi:a,topP:E+0,topN:E+0,bottomP:E+1,bottomN:E+1};return this._buffer.positions[P+0]=g,this._buffer.positions[P+1]=m,this._buffer.positions[P+2]=this._depth-y,this._buffer.normals[P+0]=A*u,this._buffer.normals[P+1]=S*u,this._buffer.normals[P+2]=d,this._buffer.uvs[R+0]=w,this._buffer.uvs[R+1]=b,this._buffer.positions[P+3]=g,this._buffer.positions[P+4]=m,this._buffer.positions[P+5]=y,this._buffer.normals[P+3]=A*u,this._buffer.normals[P+4]=S*u,this._buffer.normals[P+5]=-d,this._buffer.uvs[R+2]=b,this._buffer.uvs[R+3]=w,c||(E+=2,P+=6,R+=4,F.topP=E+0,F.bottomP=E+1,this._buffer.positions[P+0]=g,this._buffer.positions[P+1]=m,this._buffer.positions[P+2]=this._depth-y,this._buffer.normals[P+0]=T*u,this._buffer.normals[P+1]=M*u,this._buffer.normals[P+2]=d,this._buffer.uvs[R+0]=w,this._buffer.uvs[R+1]=b,this._buffer.positions[P+3]=g,this._buffer.positions[P+4]=m,this._buffer.positions[P+5]=y,this._buffer.normals[P+3]=T*u,this._buffer.normals[P+4]=M*u,this._buffer.normals[P+5]=-d,this._buffer.uvs[R+2]=b,this._buffer.uvs[R+3]=w),this.vertexCache[r]=F,F}clone(){let t=new tZ(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return t.userData=DE(this.userData),t}},nZ=class extends Lt{constructor(t,e=12,n={}){super(),this.type="ShapeGeometry",this.windingRule=Rn.ODD,this.elementType=Gi.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=t,this._curveSegments=e,this._triangulationOptions=Object.assign({windingRule:Rn.ODD,elementType:Gi.POLYGONS,polySize:3,vertexSize:2,strict:!0},n);let i=this._shape.extractShapePointsToFlatArray([],this._curveSegments),r=this._shape.shapeHoles.map(d=>d.extractShapePointsToFlatArray([],this._curveSegments)),s,o=!0,a=!0,l,c;for(let d=0,f=i.length/2;d<f;d++){let p=d*2,v=i[p+0],g=i[p+1];if(l!==void 0&&v!==l&&(o=!1),c!==void 0&&g!==c&&(a=!1),l=v,c=g,!o&&!a)break}if(!o&&!a)try{s=xh({contours:[i,...r],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{s=PF}let h=(s==null?void 0:s.vertexCount)??1,u=(s==null?void 0:s.elementCount)??1;if(this._positionAttribute=new Ut(new Float32Array(h*3),3),this._normalAttribute=new Ut(new Float32Array(h*3),3),this._uvAttribute=new Ut(new Float32Array(h*2),2),this._indexAttribute=new Ut(new Uint32Array(u*3),1),s){let d=1/0,f=-1/0,p=1/0,v=-1/0;for(let y=0,w=h;y<w;y++){let b=y*2,A=s.vertices[b+0],S=s.vertices[b+1];A<d&&(d=A),A>f&&(f=A),S<p&&(p=S),S>v&&(v=S)}let g=f-d,m=v-p;for(let y=0,w=h;y<w;y++){let b=y*2,A=s.vertices[b+0],S=s.vertices[b+1],T=(A-d)/g,M=(S-p)/m;this._positionAttribute.setXYZ(y,A,S,0),this._normalAttribute.setXYZ(y,0,0,1),this._uvAttribute.setXY(y,T,M)}for(let y=0,w=u;y<w;y++){let b=y*3,A=s.elements[b+0],S=s.elements[b+1],T=s.elements[b+2];this._indexAttribute.setX(b+0,A),this._indexAttribute.setX(b+1,S),this._indexAttribute.setX(b+2,T)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((s==null?void 0:s.elementCount)??1)*3)}clone(){let t=new nZ(this._shape,this._curveSegments);return t.userData=DE(this.userData),t}},iZ=class extends tZ{constructor(t,e,n=0,i=12,r=3,s=Rn.ODD){super(t,e,n,i,r,s),this.type="ShapeGeometry"}_computeBufferEstimatedSize(t){return t.vertexCount*2*(2+this._bevelSegments)}_buildWall(t,e,n){let i=t[0];for(let r=0,s=i.boundary.vertexCount;r<s;r++){let o=this._buildBevelVert(e,i,r),a=this._buildBevelVert(e,i,(r+1)%s);n.push(a.topP,o.topN,o.bottomN),n.push(a.topP,o.bottomN,a.bottomP)}}clone(){let t=new iZ(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return t.userData=DE(this.userData),t}},tp=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){var c,h;let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:Rn.ODD},t.parameters),i=Math.abs(n.width),r=Math.abs(n.height??n.width),s=Math.abs(n.depth??0),o=t.shape??(e==null?void 0:e.shape),a=(o==null?void 0:o.roundness)??n.roundness;o!==void 0&&(o instanceof _i?(o.width!==i||o.height!==r)&&o.applySize(i,r):o=new _i(i,r).fromJSON(o),((c=t.parameters)==null?void 0:c.roundness)!==void 0&&((h=t.parameters)==null?void 0:h.roundness)>0&&o.update());let l=o??new _i(i,r);return{parameters:Object.assign(n,{width:i,height:r,depth:s,roundness:a}),shape:l}}static build(t){let{depth:e,extrudeBevelSize:n,extrudeBevelSegments:i,subdivisions:r,roundness:s,windingRule:o}=t.parameters;t.shape.roundness=s;let a;return e<=0?a=new nZ(t.shape,r,{windingRule:o}):a=new iZ(t.shape,e,n,r,i,o),Object.assign(a,{userData:{...t,type:"VectorGeometry"}})}},rZ=Math.PI*2,DF=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters);return{shape:t.shape&&t.shape instanceof _i?t.shape:new _i,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e,height:n,spikes:i,angle:r,innerRadius:s,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}=t.parameters,c=t.shape,h=e*.5,u=n*.5,d=H3e(c,h,u,r*Math.PI/180,i,s);c.isClosed=!0,c.update();let f=tp.create({shape:c,parameters:{subdivisions:d,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}});return Object.assign(f,{userData:{...t,type:"EllipseGeometry"}})}};function H3e(t,e,n,i,r,s){if(i>=rZ)return r>30||r%4===0?(j3e(t,e,n,s),Math.round(r/4)):$j(t,i,r,e,n,s);i=Math.max(i,.001);let o={x:0,y:n},a=i+Math.PI*.5,l={x:Math.cos(a)*e,y:Math.sin(a)*n},c=N3e({px:o.x,py:o.y,cx:l.x,cy:l.y,rx:e,ry:n,largeArcFlag:i>Math.PI,sweepFlag:!0});return r>30||r%c.length===0?V3e(t,o.x,o.y,c,r,e,n,s):$j(t,i,r,e,n,s)}function V3e(t,e,n,i,r,s,o,a){let l=Math.round(r/i.length);t.addPoint(wg(e,n));for(let c=0,h=i.length;c<h;c++){let u=i[c],d=t.points[c],f=wg(u.x,u.y);d.controls[1].position.set(u.x1,u.y1),f.controls[0].position.set(u.x2,u.y2),t.addPoint(f)}return a>0?sZ(t,s,o,a):t.addPoint(wg(0,0)),l}function $j(t,e,n,i,r,s){let o=-e/n;for(let a=0;a<=n;a++){let l=o*a,c=Math.sin(l)*i,h=Math.cos(l)*r;t.addPoint(wg(c,h))}return e<rZ?s>0?sZ(t,i,r,s):t.addPoint(wg(0,0)):(t.removePoint(t.points[t.points.length-1]),s>0&&oZ(t,i,r,s)),1}function j3e(t,e,n,i=0,r=0,s=0){let o=.5522847498,a=e*o,l=n*o;t.addPoint(Gb(r-e,s,r-e,s-l,r-e,s+l)),t.addPoint(Gb(r,s+n,r-a,s+n,r+a,s+n)),t.addPoint(Gb(r+e,s,r+e,s+l,r+e,s-l)),t.addPoint(Gb(r,s-n,r+a,s-n,r-a,s-n)),i>0&&oZ(t,e,n,i)}function wg(t,e){return new xg(sn.generateUUID(),new be(t,e))}function Gb(t,e,n,i,r,s){let o=wg(t,e);return o.controls[0].position.set(n,i),o.controls[1].position.set(r,s),o}function sZ(t,e,n,i){aZ(t,e,n,i).forEach(r=>t.addPoint(r))}function oZ(t,e,n,i){let r=aZ(t,e,n,i),s=new _i;r.forEach(o=>s.addPoint(o)),s.isClosed=!0,t.shapeHoles.push(s)}function aZ(t,e,n,i){let r=i*e/100,s=r*(Math.abs(n)/Math.abs(e)),o=new be(r/e,s/n),a=t.points.map(l=>{let c=l.clone();return c.uuid=sn.generateUUID(),c}).reverse();return a.forEach(l=>{l.position.multiply(o);let c=l.controls[0].position.clone().multiply(o),h=l.controls[1].position.clone().multiply(o);l.controls[0].position.copy(h),l.controls[1].position.copy(c)}),a}var W3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},t.parameters),i=Math.abs(n.width),r=Math.abs(n.height??i),s=Math.abs(n.depth??i),o=Math.abs(Math.min(i,s))/2;return{parameters:Object.assign(n,{width:i,height:r,depth:s,radius:o,segments:Math.round(n.segments),pathSegments:Math.round(n.pathSegments),cornerSegments:Math.round(n.cornerSegments)})}}static build(t){let{width:e,height:n,depth:i,radius:r,revolutions:s,segments:o,pathRadius:a,pathType:l,pathSegments:c,cornerRadius:h,cornerSegments:u}=t.parameters,d=new RF(!1,e,n,i,r,s,o,a,l,c,h,u);return Object.assign(d,{userData:{...t,type:"HelixGeometry"}})}},RF=class extends Lt{constructor(t=!0,e=1,n=1,i=1,r=1,s=1,o=1,a=1,l=1,c=1,h=1,u=1,d=!1){super();let f=t&&s===1;f&&(u=0),h>100&&(h=100);let p=()=>new N,v=new N,g=p(),m=p(),y=p(),w,b,A,S,T,M,E,P,R=p(),F=p(),B=p(),k=p(),j=p(),Z=p(),ee=p(),O=p(),W=n-2*a+.001,H=W/s,Y=Math.ceil(o*s),z=Y+1,X=W/Y,q=-W/2,re=c+1,G=2*Math.PI/c,K=Math.PI/2/u,oe=.01,ve=Math.min((1-h/100)*a,a-oe),$=a-ve,se=0,ne=2,ie=u*ne+ne,me=re*ie/ne,xe=me+re*z,Ae=re*(z+ie),[_e,Ee,Re]=[3,3,2].map(Ve=>Array(Ae*Ve).fill(0)),Ue=[],Ne=r-a;function U(Ve,ue){let Me=Math.PI/2;M=ue*X,P=2*Math.PI*(M%H)/H+Me,M+=q,E=Math.sin(P)*Ne,T=Math.cos(P)*Ne,t?Ve.set(T,E,M):Ve.set(T,M,E)}U(v,-1e-10),U(g,0),R.copy(v),U(v,1);let L=v.distanceTo(g),te=f?0:$+ve,we=L*Y+2*te,Te=ve,Ie=we-te;for(let Ve=0;Ve<=Y;Ve++){U(m,Ve),O.subVectors(m,R).normalize(),R.copy(m),Z.copy(m).setComponent(+t+1,0).normalize(),ee.crossVectors(O,Z).normalize();let ue=Ve===0,Me=Ve===Y,Be=ue?3*Math.PI/2:K,ze=ue?Te:Ie,$e=ue?re:xe,dt=ue?0:Ae-re,Bt=O.clone().multiplyScalar(ue?-$:$).add(m),J=O.clone().multiplyScalar(ue?-1:1).normalize();for(let fe=0;fe<re;fe++){let Se=fe*G;if(F.addVectors(v.copy(Z).multiplyScalar(a*Math.cos(Se)),g.copy(ee).multiplyScalar(a*Math.sin(Se))),B.copy(F).normalize(),ue||Me){f||(se=dt+fe,[0,1,2].forEach(Oe=>{_e[se*3+Oe]=Bt.getComponent(Oe),Ee[se*3+Oe]=J.getComponent(Oe)}),Re[se*2]=+Me,Re[se*2+1]=fe/c),g.copy(B).multiplyScalar(ve),y.addVectors(m,g);for(let Oe=0;Oe<u;Oe++){let qe=Oe*K+Be;k.addVectors(v.copy(O).multiplyScalar($*Math.sin(qe)),g.copy(B).multiplyScalar($*Math.cos(qe))),j.copy(k).normalize(),g.addVectors(y,k),k.normalize(),se=$e+Oe*re+fe,[0,1,2].forEach(Et=>{_e[se*3+Et]=g.getComponent(Et),Ee[se*3+Et]=j.getComponent(Et)});let vt=+ue+Math.sin(qe);Re[se*2]=(ze+$*vt)/we,Re[se*2+1]=fe/c}}g.addVectors(m,F),se=me+Ve*re+fe,[0,1,2].forEach(Oe=>{_e[se*3+Oe]=g.getComponent(Oe),Ee[se*3+Oe]=B.getComponent(Oe)}),Re[se*2]=(te+Ve*L)/we,Re[se*2+1]=fe/c}}let Qe=z+2*u+ne,[Ge,ye]=[+f,Qe-1];d&&(ye-=1);for(let Ve=Ge;Ve<=ye-1;Ve++){let ue=f&&Ve===ye-1;for(let Me=0;Me<re-1;Me++)w=Ve*re+Me,b=w+1,A=(ue?Me:w)+re,S=(ue?Me+1:b)+re,Ve===0?Ue.push(b,S,A):Ve===Qe-2?Ue.push(w,b,A):Ue.push(w,b,A,b,S,A)}this.setIndex(Ue),this.setAttribute("position",new ft(_e,3)),this.setAttribute("normal",new ft(Ee,3)),this.setAttribute("uv",new ft(Re,2))}},X3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,detail:0,corner:0,cornerSides:4},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,detail:r,corner:s,cornerSides:o}=t.parameters,a=r===0&&s!==0?new lZ(e*.5,s,o):new yK(e*.5,r);return a.scale(1,n/e,i/e),Object.assign(a,{userData:{...t,type:"IcosahedronGeometry"}})}},lZ=class extends EF{constructor(t=1,e=.2,n=4){let i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],o="IcosahedronGeometry";super(r,s,o,t,e,n),this.type=o}static fromJSON(t){return new lZ(t.radius,t.corner,t.cornerSides)}},Y3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){var i;(((i=t.parameters)==null?void 0:i.points)??[]).forEach(r=>{Array.isArray(r)&&(r.x=r[0],r.y=r[1])});let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{points:e,segments:n,verticalSegments:i}=t.parameters,r=new UA;r.moveTo(e[0].x,e[0].y),r.bezierCurveTo(e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y);let s=new hK(r.extractPoints(i).shape,n);return s.rotateZ(Math.PI),Object.assign(s,{userData:{...t,type:"LatheGeometry"}})}},bl=new nt,H2=new Nn,Hb=new N,pM=class extends _s{constructor(){super(),this.uuid=sn.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(t){let e=new Rr().getNormalMatrix(t);for(let n=0,i=this.vertices.length;n<i;n++)this.vertices[n].applyMatrix4(t);for(let n=0,i=this.faces.length;n<i;n++){let r=this.faces[n];r.normal.applyMatrix3(e).normalize();for(let s=0,o=r.vertexNormals.length;s<o;s++)r.vertexNormals[s].applyMatrix3(e).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(t){return bl.makeRotationX(t),this.applyMatrix4(bl),this}rotateY(t){return bl.makeRotationY(t),this.applyMatrix4(bl),this}rotateZ(t){return bl.makeRotationZ(t),this.applyMatrix4(bl),this}translate(t,e,n){return bl.makeTranslation(t,e,n),this.applyMatrix4(bl),this}scale(t,e,n){return bl.makeScale(t,e,n),this.applyMatrix4(bl),this}lookAt(t){return H2.lookAt(t),H2.updateMatrix(),this.applyMatrix4(H2.matrix),this}fromBufferGeometry(t){let e=this,n=t.index!==null?t.index:void 0,i=t.attributes;if(i.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let r=i.position,s=i.normal,o=i.color,a=i.uv,l=i.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(let u=0;u<r.count;u++)e.vertices.push(new N().fromBufferAttribute(r,u)),o!==void 0&&e.colors.push(new Rt().fromBufferAttribute(o,u));function c(u,d,f,p){let v=o===void 0?[]:[e.colors[u].clone(),e.colors[d].clone(),e.colors[f].clone()],g=s===void 0?[]:[new N().fromBufferAttribute(s,u),new N().fromBufferAttribute(s,d),new N().fromBufferAttribute(s,f)],m=new FI(u,d,f,g,v,p);e.faces.push(m),a!==void 0&&e.faceVertexUvs[0].push([new be().fromBufferAttribute(a,u),new be().fromBufferAttribute(a,d),new be().fromBufferAttribute(a,f)]),l!==void 0&&e.faceVertexUvs[1].push([new be().fromBufferAttribute(l,u),new be().fromBufferAttribute(l,d),new be().fromBufferAttribute(l,f)])}let h=t.groups;if(h.length>0)for(let u=0;u<h.length;u++){let d=h[u],f=d.start,p=d.count;for(let v=f,g=f+p;v<g;v+=3)n!==void 0?c(n.getX(v),n.getX(v+1),n.getX(v+2),d.materialIndex):c(v,v+1,v+2,d.materialIndex)}else if(n!==void 0)for(let u=0;u<n.count;u+=3)c(n.getX(u),n.getX(u+1),n.getX(u+2));else for(let u=0;u<r.count;u+=3)c(u,u+1,u+2);return this.computeFaceNormals(),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Hb).negate(),this.translate(Hb.x,Hb.y,Hb.z),this}normalize(){this.computeBoundingSphere();let t=this.boundingSphere.center,e=this.boundingSphere.radius,n=e===0?1:1/e,i=new nt;return i.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix4(i),this}computeFaceNormals(){let t=new N,e=new N;for(let n=0,i=this.faces.length;n<i;n++){let r=this.faces[n],s=this.vertices[r.a],o=this.vertices[r.b],a=this.vertices[r.c];t.subVectors(a,o),e.subVectors(s,o),t.cross(e),t.normalize(),r.normal.copy(t)}}computeVertexNormals(t=!0){let e=new Array(this.vertices.length);for(let n=0,i=this.vertices.length;n<i;n++)e[n]=new N;if(t){let n=new N,i=new N;for(let r=0,s=this.faces.length;r<s;r++){let o=this.faces[r],a=this.vertices[o.a],l=this.vertices[o.b],c=this.vertices[o.c];n.subVectors(c,l),i.subVectors(a,l),n.cross(i),e[o.a].add(n),e[o.b].add(n),e[o.c].add(n)}}else{this.computeFaceNormals();for(let n=0,i=this.faces.length;n<i;n++){let r=this.faces[n];e[r.a].add(r.normal),e[r.b].add(r.normal),e[r.c].add(r.normal)}}for(let n=0,i=this.vertices.length;n<i;n++)e[n].normalize();for(let n=0,i=this.faces.length;n<i;n++){let r=this.faces[n],s=r.vertexNormals;s.length===3?(s[0].copy(e[r.a]),s[1].copy(e[r.b]),s[2].copy(e[r.c])):(s[0]=e[r.a].clone(),s[1]=e[r.b].clone(),s[2]=e[r.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let t=0,e=this.faces.length;t<e;t++){let n=this.faces[t],i=n.vertexNormals;i.length===3?(i[0].copy(n.normal),i[1].copy(n.normal),i[2].copy(n.normal)):(i[0]=n.normal.clone(),i[1]=n.normal.clone(),i[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let e=0,n=this.faces.length;e<n;e++){let i=this.faces[e];i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]);for(let r=0,s=i.vertexNormals.length;r<s;r++)i.__originalVertexNormals[r]?i.__originalVertexNormals[r].copy(i.vertexNormals[r]):i.__originalVertexNormals[r]=i.vertexNormals[r].clone()}let t=new pM;t.faces=this.faces;for(let e=0,n=this.morphTargets.length;e<n;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];let r=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(let o=0,a=this.faces.length;o<a;o++){let l=new N,c={a:new N,b:new N,c:new N};r.push(l),s.push(c)}}let i=this.morphNormals[e];t.vertices=this.morphTargets[e].vertices,t.computeFaceNormals(),t.computeVertexNormals();for(let r=0,s=this.faces.length;r<s;r++){let o=this.faces[r],a=i.faceNormals[r],l=i.vertexNormals[r];a.copy(o.normal),l.a.copy(o.vertexNormals[0]),l.b.copy(o.vertexNormals[1]),l.c.copy(o.vertexNormals[2])}}for(let e=0,n=this.faces.length;e<n;e++){let i=this.faces[e];i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ji),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ha),this.boundingSphere.setFromPoints(this.vertices)}merge(t,e,n=0){if(!(t&&t.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);return}let i,r=this.vertices.length,s=this.vertices,o=t.vertices,a=this.faces,l=t.faces,c=this.colors,h=t.colors;e!==void 0&&(i=new Rr().getNormalMatrix(e));for(let u=0,d=o.length;u<d;u++){let f=o[u].clone();e!==void 0&&f.applyMatrix4(e),s.push(f)}for(let u=0,d=h.length;u<d;u++)c.push(h[u].clone());for(let u=0,d=l.length;u<d;u++){let f=l[u],p,v,g=f.vertexNormals,m=f.vertexColors,y=new FI(f.a+r,f.b+r,f.c+r);y.normal.copy(f.normal),i!==void 0&&y.normal.applyMatrix3(i).normalize();for(let w=0,b=g.length;w<b;w++)p=g[w].clone(),i!==void 0&&p.applyMatrix3(i).normalize(),y.vertexNormals.push(p);y.color.copy(f.color);for(let w=0,b=m.length;w<b;w++)v=m[w],y.vertexColors.push(v.clone());y.materialIndex=f.materialIndex+n,a.push(y)}for(let u=0,d=t.faceVertexUvs.length;u<d;u++){let f=t.faceVertexUvs[u];this.faceVertexUvs[u]===void 0&&(this.faceVertexUvs[u]=[]);for(let p=0,v=f.length;p<v;p++){let g=f[p],m=[];for(let y=0,w=g.length;y<w;y++)m.push(g[y].clone());this.faceVertexUvs[u].push(m)}}}mergeMesh(t){if(!(t&&t.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t);return}t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)}mergeVertices(t=4){let e={},n=[],i=[],r=Math.pow(10,t);for(let a=0,l=this.vertices.length;a<l;a++){let c=this.vertices[a],h=Math.round(c.x*r)+"_"+Math.round(c.y*r)+"_"+Math.round(c.z*r);e[h]===void 0?(e[h]=a,n.push(this.vertices[a]),i[a]=n.length-1):i[a]=i[e[h]]}let s=[];for(let a=0,l=this.faces.length;a<l;a++){let c=this.faces[a];c.a=i[c.a],c.b=i[c.b],c.c=i[c.c];let h=[c.a,c.b,c.c];for(let u=0;u<3;u++)if(h[u]===h[(u+1)%3]){s.push(a);break}}for(let a=s.length-1;a>=0;a--){let l=s[a];this.faces.splice(l,1);for(let c=0,h=this.faceVertexUvs.length;c<h;c++)this.faceVertexUvs[c].splice(l,1)}let o=this.vertices.length-n.length;return this.vertices=n,o}setFromPoints(t){this.vertices=[];for(let e=0,n=t.length;e<n;e++){let i=t[e];this.vertices.push(new N(i.x,i.y,i.z||0))}return this}sortFacesByMaterialIndex(){let t=this.faces,e=t.length;for(let a=0;a<e;a++)t[a]._id=a;function n(a,l){return a.materialIndex-l.materialIndex}t.sort(n);let i=this.faceVertexUvs[0],r=this.faceVertexUvs[1],s,o;i&&i.length===e&&(s=[]),r&&r.length===e&&(o=[]);for(let a=0;a<e;a++){let l=t[a]._id;s&&s.push(i[l]),o&&o.push(r[l])}s&&(this.faceVertexUvs[0]=s),o&&(this.faceVertexUvs[1]=o)}toJSON(){let t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),this.parameters!==void 0){let f=this.parameters;for(let p in f)f[p]!==void 0&&(t[p]=f[p]);return t}let e=[];for(let f=0;f<this.vertices.length;f++){let p=this.vertices[f];e.push(p.x,p.y,p.z)}let n=[],i=[],r={},s=[],o={},a=[],l={};for(let f=0;f<this.faces.length;f++){let p=this.faces[f],v=!0,g=!1,m=this.faceVertexUvs[0][f]!==void 0,y=p.normal.length()>0,w=p.vertexNormals.length>0,b=p.color.r!==1||p.color.g!==1||p.color.b!==1,A=p.vertexColors.length>0,S=0;if(S=c(S,0,0),S=c(S,1,v),S=c(S,2,g),S=c(S,3,m),S=c(S,4,y),S=c(S,5,w),S=c(S,6,b),S=c(S,7,A),n.push(S),n.push(p.a,p.b,p.c),n.push(p.materialIndex),m){let T=this.faceVertexUvs[0][f];n.push(d(T[0]),d(T[1]),d(T[2]))}if(y&&n.push(h(p.normal)),w){let T=p.vertexNormals;n.push(h(T[0]),h(T[1]),h(T[2]))}if(b&&n.push(u(p.color)),A){let T=p.vertexColors;n.push(u(T[0]),u(T[1]),u(T[2]))}}function c(f,p,v){return v?f|1<<p:f&~(1<<p)}function h(f){let p=f.x.toString()+f.y.toString()+f.z.toString();return r[p]!==void 0||(r[p]=i.length/3,i.push(f.x,f.y,f.z)),r[p]}function u(f){let p=f.r.toString()+f.g.toString()+f.b.toString();return o[p]!==void 0||(o[p]=s.length,s.push(f.getHex())),o[p]}function d(f){let p=f.x.toString()+f.y.toString();return l[p]!==void 0||(l[p]=a.length/2,a.push(f.x,f.y)),l[p]}return t.data={},t.data.vertices=e,t.data.normals=i,s.length>0&&(t.data.colors=s),a.length>0&&(t.data.uvs=[a]),t.data.faces=n,t}clone(){return new pM().copy(this)}copy(t){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;let e=t.vertices;for(let u=0,d=e.length;u<d;u++)this.vertices.push(e[u].clone());let n=t.colors;for(let u=0,d=n.length;u<d;u++)this.colors.push(n[u].clone());let i=t.faces;for(let u=0,d=i.length;u<d;u++)this.faces.push(i[u].clone());for(let u=0,d=t.faceVertexUvs.length;u<d;u++){let f=t.faceVertexUvs[u];this.faceVertexUvs[u]===void 0&&(this.faceVertexUvs[u]=[]);for(let p=0,v=f.length;p<v;p++){let g=f[p],m=[];for(let y=0,w=g.length;y<w;y++){let b=g[y];m.push(b.clone())}this.faceVertexUvs[u].push(m)}}let r=t.morphTargets;for(let u=0,d=r.length;u<d;u++){let f={};if(f.name=r[u].name,r[u].vertices!==void 0){f.vertices=[];for(let p=0,v=r[u].vertices.length;p<v;p++)f.vertices.push(r[u].vertices[p].clone())}if(r[u].normals!==void 0){f.normals=[];for(let p=0,v=r[u].normals.length;p<v;p++)f.normals.push(r[u].normals[p].clone())}this.morphTargets.push(f)}let s=t.morphNormals;for(let u=0,d=s.length;u<d;u++){let f={};if(s[u].vertexNormals!==void 0){f.vertexNormals=[];for(let p=0,v=s[u].vertexNormals.length;p<v;p++){let g=s[u].vertexNormals[p],m={};m.a=g.a.clone(),m.b=g.b.clone(),m.c=g.c.clone(),f.vertexNormals.push(m)}}if(s[u].faceNormals!==void 0){f.faceNormals=[];for(let p=0,v=s[u].faceNormals.length;p<v;p++)f.faceNormals.push(s[u].faceNormals[p].clone())}this.morphNormals.push(f)}let o=t.skinWeights;for(let u=0,d=o.length;u<d;u++)this.skinWeights.push(o[u].clone());let a=t.skinIndices;for(let u=0,d=a.length;u<d;u++)this.skinIndices.push(a[u].clone());let l=t.lineDistances;for(let u=0,d=l.length;u<d;u++)this.lineDistances.push(l[u]);let c=t.boundingBox;c!==null&&(this.boundingBox=c.clone());let h=t.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}toBufferGeometry(){let t=new q3e().fromGeometry(this),e=new Lt,n=new Float32Array(t.vertices.length*3);if(e.setAttribute("position",Vb.call(new Ut(n,3),t.vertices)),t.normals.length>0){let i=new Float32Array(t.normals.length*3);e.setAttribute("normal",Vb.call(new Ut(i,3),t.normals))}if(t.colors.length>0){let i=new Float32Array(t.colors.length*3);e.setAttribute("color",e6.call(new Ut(i,3),t.colors))}if(t.uvs.length>0){let i=new Float32Array(t.uvs.length*2);e.setAttribute("uv",t6.call(new Ut(i,2),t.uvs))}if(t.uvs2.length>0){let i=new Float32Array(t.uvs2.length*2);e.setAttribute("uv2",t6.call(new Ut(i,2),t.uvs2))}e.groups=t.groups;for(let i in t.morphTargets){let r=[],s=t.morphTargets[i];for(let o=0,a=s.length;o<a;o++){let l=s[o],c=new ft(l.data.length*3,3);c.name=l.name,r.push(Vb.call(c,l.data))}e.morphAttributes[i]=r}if(t.skinIndices.length>0){let i=new ft(t.skinIndices.length*4,4);e.setAttribute("skinIndex",n6.call(i,t.skinIndices))}if(t.skinWeights.length>0){let i=new ft(t.skinWeights.length*4,4);e.setAttribute("skinWeight",n6.call(i,t.skinWeights))}return t.boundingSphere!==null&&(e.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(e.boundingBox=t.boundingBox.clone()),e}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(t){let e=new Lt,n=t.geometry;if(t.isPoints||t.isLine){let i=new ft(n.vertices.length*3,3),r=new ft(n.colors.length*3,3);if(e.setAttribute("position",Vb.call(i,n.vertices)),e.setAttribute("color",e6.call(r,n.colors)),n.lineDistances&&n.lineDistances.length===n.vertices.length){let s=new ft(n.lineDistances.length,1);e.setAttribute("lineDistance",Q3e.call(s,n.lineDistances))}n.boundingSphere!==null&&(e.boundingSphere=n.boundingSphere.clone()),n.boundingBox!==null&&(e.boundingBox=n.boundingBox.clone())}else t.isMesh&&(e=n.toBufferGeometry());return e}};pM.prototype.isGeometry=!0;var q3e=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(t){let e=[],n,i,r,s=t.faces;for(i=0;i<s.length;i++){let o=s[i];o.materialIndex!==r&&(r=o.materialIndex,n!==void 0&&(n.count=i*3-n.start,e.push(n)),n={start:i*3,materialIndex:r})}n!==void 0&&(n.count=i*3-n.start,e.push(n)),this.groups=e}fromGeometry(t){let e=t.faces,n=t.vertices,i=t.faceVertexUvs,r=i[0]&&i[0].length>0,s=i[1]&&i[1].length>0,o=t.morphTargets,a=o.length,l;if(a>0){l=[];for(let g=0;g<a;g++)l[g]={name:o[g].name,data:[]};this.morphTargets.position=l}let c=t.morphNormals,h=c.length,u;if(h>0){u=[];for(let g=0;g<h;g++)u[g]={name:c[g].name,data:[]};this.morphTargets.normal=u}let d=t.skinIndices,f=t.skinWeights,p=d.length===n.length,v=f.length===n.length;n.length>0&&e.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let g=0;g<e.length;g++){let m=e[g];this.vertices.push(n[m.a],n[m.b],n[m.c]);let y=m.vertexNormals;if(y.length===3)this.normals.push(y[0],y[1],y[2]);else{let b=m.normal;this.normals.push(b,b,b)}let w=m.vertexColors;if(w.length===3)this.colors.push(w[0],w[1],w[2]);else{let b=m.color;this.colors.push(b,b,b)}if(r===!0){let b=i[0][g];b!==void 0?this.uvs.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",g),this.uvs.push(new be,new be,new be))}if(s===!0){let b=i[1][g];b!==void 0?this.uvs2.push(b[0],b[1],b[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",g),this.uvs2.push(new be,new be,new be))}for(let b=0;b<a;b++){let A=o[b].vertices;l[b].data.push(A[m.a],A[m.b],A[m.c])}for(let b=0;b<h;b++){let A=c[b].vertexNormals[g];u[b].data.push(A.a,A.b,A.c)}p&&this.skinIndices.push(d[m.a],d[m.b],d[m.c]),v&&this.skinWeights.push(f[m.a],f[m.b],f[m.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this}},FI=class{constructor(t,e,n,i,r,s=0){this.a=t,this.b=e,this.c=n,this.normal=i&&i.isVector3?i:new N,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new Rt,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=s}clone(){return new this.constructor().copy(this)}copy(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(let e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(let e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}};function Q3e(t){return this.array.set(t),this}function e6(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),s=new Rt),e[n++]=s.r,e[n++]=s.g,e[n++]=s.b}return this}function t6(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),s=new be),e[n++]=s.x,e[n++]=s.y}return this}function Vb(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),s=new N),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z}return this}function n6(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),s=new Zt),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z,e[n++]=s.w}return this}var K3e=["a","b","c"];function J3e(t,e){switch(e){case"c":return t.c;case"b":return t.b;case"a":default:return t.a}}function V2(t,e,n){let i=Math.min(t,e),r=Math.max(t,e),s=i+"_"+r;return n.get(s)}function j2(t,e,n,i,r,s){let o=Math.min(t,e),a=Math.max(t,e),l=o+"_"+a,c;if(i.has(l))c=i.get(l);else{let h=n[o],u=n[a];c={a:h,b:u,newEdge:null,faces:[]},i.set(l,c)}c.faces.push(r),s[t].edges.push(c),s[e].edges.push(c)}function Z3e(t,e,n,i){let r,s,o;for(r=0,s=t.length;r<s;r++)n[r]={edges:[]};for(r=0,s=e.length;r<s;r++)o=e[r],j2(o.a,o.b,t,i,o,n),j2(o.b,o.c,t,i,o,n),j2(o.c,o.a,t,i,o,n)}function jb(t,e,n,i,r){t.push(new FI(e,n,i,void 0,void 0,r))}function om(t,e){return Math.abs(e-t)/2+Math.min(t,e)}function Wb(t,e,n,i){t.push([e.clone(),n.clone(),i.clone()])}var $3e=class{constructor(t=1){this.subdivisions=t}modify(t){t instanceof Lt?t=new pM().fromBufferGeometry(t):t=t.clone(),t.mergeVertices();let e=this.subdivisions;for(;e-- >0;)this._smooth(t);return t.computeFaceNormals(),t.computeVertexNormals(),t}_smooth(t){let e=new N,n,i,r,s,o,a=t.vertices,l=t.faces,c=t.faceVertexUvs[0],h=c!==void 0&&c.length>0,u=[],d=new Map;Z3e(a,l,u,d);let f=[],p,v,g,m,y,w,b;for(let K of Array.from(d.keys())){for(v=d.get(K),g=new N,y=3/8,w=1/8,b=v.faces.length,b!=2&&(y=.5,w=0,b!=1),g.addVectors(v.a,v.b).multiplyScalar(y),e.set(0,0,0),s=0;s<b;s++){for(m=v.faces[s],o=0;o<3&&(p=a[J3e(m,K3e[o])],!(p!==v.a&&p!==v.b));o++);p&&e.add(p)}e.multiplyScalar(w),g.add(e),v.newEdge=f.length,f.push(g)}let A,S,T,M,E,P,R,F=[];for(i=0,r=a.length;i<r;i++){for(P=a[i],E=u[i].edges,n=E.length,n==3?A=3/16:n>3&&(A=3/(8*n)),S=1-n*Number(A),T=A,n<=2&&(n==2?(S=3/4,T=1/8):n==1||n==0),R=P.clone().multiplyScalar(S),e.set(0,0,0),s=0;s<n;s++)M=E[s],p=M.a!==P?M.a:M.b,e.add(p);e.multiplyScalar(Number(T)),R.add(e),F.push(R)}let B=F.concat(f),k=F.length,j,Z,ee,O=[],W=[],H,Y,z,X,q=new be,re=new be,G=new be;for(i=0,r=l.length;i<r;i++)m=l[i],j=Number(V2(m.a,m.b,d).newEdge)+k,Z=Number(V2(m.b,m.c,d).newEdge)+k,ee=Number(V2(m.c,m.a,d).newEdge)+k,jb(O,j,Z,ee,m.materialIndex),jb(O,m.a,j,ee,m.materialIndex),jb(O,m.b,Z,j,m.materialIndex),jb(O,m.c,ee,Z,m.materialIndex),h&&(H=c[i],Y=H[0],z=H[1],X=H[2],q.set(om(Y.x,z.x),om(Y.y,z.y)),re.set(om(z.x,X.x),om(z.y,X.y)),G.set(om(Y.x,X.x),om(Y.y,X.y)),Wb(W,q,re,G),Wb(W,Y,q,G),Wb(W,z,re,q),Wb(W,X,G,re));t.vertices=B,t.faces=O,h&&(t.faceVertexUvs[0]=W)}},qi=new N,eBe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=t.geometry??(e==null?void 0:e.geometry)??new Lt().copy(new nc(100,100,100)),i;e===void 0?(n.computeBoundingBox(),n.boundingBox.getSize(qi),i={width:qi.x,height:qi.y,depth:qi.z,subdivisions:0}):i=e.parameters;let r={...i,...t.parameters};return{parameters:{width:Math.abs(r.width),height:Math.abs(r.height),depth:Math.abs(r.depth),subdivisions:Math.abs(r.subdivisions)},geometry:n}}static build(t){let{width:e,height:n,depth:i,subdivisions:r}=t.parameters,s=t.geometry??new Lt().copy(new nc(100,100,100)),o=s.userData.parameters;o===void 0?(s.computeBoundingBox(),s.boundingBox.getSize(qi)):qi.set(o.width,o.height,o.depth),(e!==qi.x||n!==qi.y||i!==qi.z)&&s.scale(qi.x===0?1:e/qi.x,qi.y===0?1:n/qi.y,qi.z===0?1:i/qi.z);let a=s.originalGeometry;return r>0?(a===void 0||(o==null?void 0:o.subdivisions)!==r)&&(a===void 0&&(a=s),s=new $3e(r).modify(a).toBufferGeometry()):(a!==void 0&&(s=a),a=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals()),a!==void 0&&Object.assign(s,{originalGeometry:a}),delete t.geometry,Object.assign(s,{userData:{...t,type:"NonParametricGeometry"}})}static loadFromUrl(t,e,n){new _K(n).load(t,i=>{let r=this.normalizeInputs({geometry:i});i.boundingBox.getSize(qi);let s=100/qi.x;Object.assign(r.parameters,{width:100,height:qi.y*s,depth:qi.z*s}),e(this.build(r))})}},cZ=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},t.parameters);return{shape:t.shape&&t.shape instanceof _i?t.shape:new _i,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e,height:n,spikes:i,cornerRadius:r,depth:s,extrudeBevelSize:o,extrudeBevelSegments:a}=t.parameters,l=t.shape,c=e*.5,h=n*.5,u=0,d=0,f=2*Math.PI/i;for(let v=0;v<i;v++){let g=f*v,m=u+Math.sin(g)*c,y=d+Math.cos(g)*h;l.addPoint(l.createPoint(m,y))}l.isClosed=!0;for(let v=0,g=l.points.length;v<g;v++)l.points[v].roundness=r;l.roundness=r,l.update();let p=tp.create({shape:l,parameters:{roundness:r,depth:s,extrudeBevelSize:o,extrudeBevelSegments:a}});return Object.assign(p,{userData:{...t,type:"PolygonGeometry"}})}},tBe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,radialSegments:r,heightSegments:s,openEnded:o,cornerRadius:a,cornerSegments:l}=t.parameters,c=new iBe(e*.5,n,r,s,o,a,l);return c.scale(1,1,i/e),Object.assign(c,{userData:{...t,type:"PyramidGeometry"}})}};function z0(t,e,n){n.x=t.x*e.x,n.y=t.y,n.z=t.x*e.y}function W2(t,e,n,i,r,s){let o=e.clone().sub(t),a=n.clone().sub(t),l=o.angleTo(a);if(o.normalize(),a.normalize(),i===r){let c=o.add(a).normalize();s.copy(t).addScaledVector(c,i/Math.sin(l/2))}else{let c=o.angleTo(a);s.copy(t),s.addScaledVector(o,r/Math.sin(c)),s.addScaledVector(a,i/Math.sin(c))}}function nBe(t,e,n){let i=t.clone().sub(e),r=n.clone().sub(e);return i.projectOnVector(r),i.add(e)}var iBe=class extends Lt{constructor(t=.5,e=1,n=4,i=1,r=!1,s=0,o=4){super(),n=Math.floor(Math.max(3,n)),i=Math.floor(i),o=Math.floor(o);let a=[],l=[],c=[],h=[],u=0,d=e/2,f=Math.PI/n,p=t*Math.cos(Math.PI/n),v=2*Math.PI/n,g=(n-2)*Math.PI/n,m=Math.PI-g,y=new N(0,-d,0),w=new N(0,d,0),b=new be(t,-d),A=new be(p,-d),S=new be(0,w.y).sub(A),T=new be(0,w.y).sub(b),M=new be(S.y,-S.x).normalize(),E=new be(T.y,-T.x).normalize(),P=t*Math.cos(Math.PI/n)*Math.tan((Math.PI-S.angle())/2)-1e-8;s=Math.min(s,P);let R;{let ee=new N(M.x,M.y,0),O=new N(Math.cos(v)*ee.x,ee.y,Math.sin(v)*ee.x);R=ee.angleTo(O)}let F=s/Math.tan((Math.PI-S.angle())/2),B=s/Math.tan((Math.PI-R)/2),k=new N;if(!r){l.push(y.x,y.y,y.z),c.push(0,-1,0),h.push(0,0);let ee=u++,O=[],W=b.clone(),H=F/Math.cos(Math.PI/n);W.x-=H;for(let Y=0;Y<n;Y++){let z=Y/n*Math.PI*2+f,X=new be(Math.sin(z),Math.cos(z));z0(W,X,k),l.push(k.x,k.y,k.z),c.push(0,-1,0),h.push(0,0),O.push(u++)}for(let Y=0;Y<O.length;Y++)a.push(O[Y],ee,O[(Y+1)%O.length])}{let ee=new N,O=new N,W=new N,H=new N,Y=new N,z=new N;for(let X=0;X<n;X++){let q=X/n*Math.PI*2+f,re=(X+.5)/n*Math.PI*2+f,G=(X+1)/n*Math.PI*2+f,K=new be(Math.sin(q),Math.cos(q)),oe=new be(Math.sin(re),Math.cos(re)),ve=new be(Math.sin(G),Math.cos(G));z0(b,K,O),z0(b,ve,W),z0(M,oe,ee),W2(w,O,W,B,B,H),l.push(H.x,H.y,H.z),W2(O,w,W,B,F,Y),l.push(Y.x,Y.y,Y.z),W2(W,O,w,F,B,z),l.push(z.x,z.y,z.z),c.push(ee.x,ee.y,ee.z),c.push(ee.x,ee.y,ee.z),c.push(ee.x,ee.y,ee.z),h.push(0,0),h.push(0,0),h.push(0,0);let $=u++,se=u++,ne=u++;if(a.push($,se,ne),s>0){{let xe=O.clone().add(W).multiplyScalar(.5),Ae=w.clone().sub(xe).normalize(),_e=y.clone().sub(xe).normalize().add(Ae).normalize().multiplyScalar(-1),Ee=z.clone().sub(Y);j(xe,Ee,_e,S.angle())}let ie,me;{let xe=new N;z0(E,ve,xe);let Ae=z.clone().add(H).multiplyScalar(.5);Ae=nBe(Ae,W,w);let _e=z.clone().sub(H);[ie,me]=j(Ae,_e,xe,R,H.y)}{let xe=ie,Ae=xe.clone().setY(0).normalize(),_e=new N(0,-1,0),Ee=Ae.clone().cross(_e);Z(xe,Ae,_e,Ee)}{let xe=S.angle(),Ae=Math.PI-xe,_e=w.clone();_e.y-=s/Math.sin(xe-Math.PI/2);let Ee=new N,Re=[];for(let Ne=0;Ne<o;Ne++){let U=[],L=Math.PI/2-Ae*Ne/o,te=Math.cos(L),we=Math.sin(L),Te=re;for(let Ie=0;Ie<=Ne;Ie++){let Qe=Math.cos(Te),Ge=Math.sin(Te);ee.x=te*Ge,ee.y=we,ee.z=te*Qe,Ee.copy(_e).addScaledVector(ee,s),l.push(Ee.x,Ee.y,Ee.z),c.push(ee.x,ee.y,ee.z),h.push(0,0),U.push(u++),Te+=Math.PI*2/Ne/n}Re.push(U)}me.reverse(),Re.push(me);let Ue=Re.length-1;for(let Ne=0;Ne<Ue;Ne++){let U=Re[Ne],L=Re[Ne+1],te=U.length-1;a.push(L[1],U[0],L[0]);for(let we=1;we<=te;we++)a.push(U[we],U[we-1],L[we]),a.push(L[we+1],U[we],L[we])}}}}}this.setIndex(a),this.setAttribute("position",new ft(l,3)),this.setAttribute("normal",new ft(c,3)),this.setAttribute("uv",new ft(h,2));function j(ee,O,W,H,Y){let z=-H/2,X=(Math.PI-H)/2,q=O.clone().normalize().cross(W);ee.addScaledVector(W,-s/Math.sin(X));let re=new N,G=new N,K=1,oe=u,ve=[];for(let $=0;$<=o;$++){let se=z+$/o*H;G.set(0,0,0),G.addScaledVector(q,Math.sin(se)),G.addScaledVector(W,Math.cos(se));for(let ne=0;ne<=K;ne++){let ie=ne/K-.5;if(re.copy(ee),re.addScaledVector(O,ie),re.addScaledVector(G,s),Y!=null){let me=Math.max(0,re.y-Y);re.addScaledVector(O,-me/O.y)}l.push(re.x,re.y,re.z),c.push(G.x,G.y,G.z),h.push(0,0),ne===0&&ve.push(u),u++}}for(let $=0;$<o;$++)for(let se=0;se<K;se++){let ne=oe+se+(K+1)*$,ie=ne+(K+1),me=ie+1,xe=ne+1;a.push(ne,ie,xe),a.push(ie,me,xe)}return[ee.clone().addScaledVector(O,.5),ve]}function Z(ee,O,W,H){let Y=Math.PI/2,z=T.angle()-Y,X=[],q=new N,re=new N;for(let K=0;K<=o;K++){let oe=[],ve=K/o;for(let $=0;$<=K;$++){let se=((K?$/K:0)-.5)*m,ne=Math.cos(se),ie=Math.sin(se),me=Math.atan(Math.tan(z)*ne),xe=(Y+me)*ve,Ae=Math.cos(xe),_e=Math.sin(xe);q.set(0,0,0),q.addScaledVector(O,_e*ne),q.addScaledVector(W,Ae),q.addScaledVector(H,_e*ie),re.copy(ee).addScaledVector(q,s),l.push(re.x,re.y,re.z),c.push(q.x,q.y,q.z),h.push(0,0),oe.push(u++)}X.push(oe)}let G=X.length-1;for(let K=0;K<G;K++){let oe=X[K],ve=X[K+1],$=oe.length-1;a.push(oe[0],ve[1],ve[0]);for(let se=1;se<=$;se++)a.push(oe[se-1],oe[se],ve[se]),a.push(oe[se],ve[se+1],ve[se])}}}},uZ=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters),i=Object.assign((e==null?void 0:e.ui)??{enabledIndieCorners:!1},t.ui);return{shape:t.shape&&t.shape instanceof _i?t.shape:new _i,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)}),ui:i}}static build(t){let e=t.shape,{width:n,height:i,cornerRadius:r,cornerType:s,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}=t.parameters,c={x:n*.5,y:i*.5},h={x:-c.x,y:-c.y},u={x:c.x,y:c.y};function d(b,A,S){return A>n&&S>i?Math.min(b*n/A,b*i/S):A>n?b*n/A:S>i?b*i/S:b}let f=[];f[0]=r[0]===0?0:d(r[0],r[0]+r[3],r[0]+r[1]),f[1]=r[1]===0?0:d(r[1],r[1]+r[2],r[1]+r[0]),f[2]=r[2]===0?0:d(r[2],r[2]+r[1],r[2]+r[3]),f[3]=r[3]===0?0:d(r[3],r[3]+r[0],r[3]+r[2]);let p=h.x,v=u.x,g=u.y,m=h.y;e.addPoint(e.createPoint(p,g)),e.addPoint(e.createPoint(v,g)),e.addPoint(e.createPoint(v,m)),e.addPoint(e.createPoint(p,m)),e.isClosed=!0;let y=!0;for(let b=0,A=e.points.length;b<A;b++)e.points[b].roundness=f[b],b>0&&f[b]!==f[b-1]&&(y=!1);y&&(e.roundness=f[0]),e.useCubicForRoundedCorners=s!==1,e.update();let w=tp.create({shape:e,parameters:{depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}});return Object.assign(w,{userData:{...t,type:"RectangleGeometry"}})}},rBe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e=100,height:n=e,depth:i=e,widthSegments:r=64,heightSegments:s=64,phiStart:o,phiLength:a,thetaStart:l,thetaLength:c}=t.parameters,h=new WO(.5*e,r,s,o,a,l,c);return h.scale(1,n/e,i/e),Object.assign(h,{userData:{...t,type:"SphereGeometry"}})}},sBe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:0})}}static build(t){let{width:e=100,height:n=e,widthSegments:i=8,heightSegments:r=8}=t.parameters,s=new wE(e,n,i,r);return s.scale(1,1,1),Object.assign(s,{userData:{...t,type:"PlaneGeometry"}})}},oBe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,angle:r,cornerRadius:s,cornerSegments:o}=t.parameters,a=new aBe(e,n,i,r,s,o);return Object.assign(a,{userData:{...t,type:"BackdropGeometry"}})}},aBe=class extends Lt{constructor(t=1,e=1,n=1,i=90,r=10,s=24){super(),this.type="BackdropGeometry";let o=[],a=[],l=[],c=.001;r==0&&(s=1),s=Math.max(1,Math.floor(s)),r=Math.min(r,100),i=Math.min(180-c,i),i*=Math.PI/180;let h=[],u=Math.PI/2,d=(K=0,oe=0,ve=0)=>new N(K,oe,ve),f=d(),p=d(),[v,g,m]=[e/2,t/2,n/2],y=-g,w=+g,[b,A,S]=[d(y,-v,+m),d(y,-v,-m),d(y,+v,-m)],T=(K,oe=!1)=>Math.sin(K-Math.PI/(1+ +oe)),M=(K,oe=!1)=>Math.cos(K-Math.PI/(1+ +oe));S.y=Math.sin(i)*e-v;let E=Math.cos(i)*e-m,P=b.z-c;i<=u?(S.z=Math.min(E,P),S.z==P&&(S.y-=(E-P)/Math.tan(u-i))):A.z=Math.min(A.z-E-m,b.z-c),f.subVectors(b,A),p.subVectors(S,A);let R=Math.min(f.length(),p.length())*r/100,F=R*Math.tan(i/2),B=R/Math.cos(i/2),k=f.clone().normalize().add(p.normalize()).setLength(B).add(A);f.set(0,T(i,!0),M(i,!0)),h.push([S,f.clone()]);let j=(Math.PI-i)/s;for(let K=0;K<=s;K++){let oe=u+i+K*j;f.set(0,Math.sin(oe)*F,Math.cos(oe)*F),f.add(k),p.set(0,T(oe),M(oe)),h.push([f.clone(),p.clone()])}h.push([b,d(0,1,0)]);let Z=Math.sin(j/2)*F*2,ee=h.length-1,O=h[0][0].distanceTo(h[1][0]),W=h[ee-1][0].distanceTo(h[ee][0]),H=O+Z*s+W;h[0].push(1);for(let K=0;K<=s;K++)h[K+1].push(1-(O+K*Z)/H);h[ee].push(0);let[Y,z,X]=h[0],q,re,G;for(let K=1;K<h.length;K++)[q,re,G]=h[K],o.push(y,Y.y,Y.z,y,q.y,q.z,w,Y.y,Y.z,w,Y.y,Y.z,y,q.y,q.z,w,q.y,q.z),a.push(0,z.y,z.z,0,re.y,re.z,0,z.y,z.z,0,z.y,z.z,0,re.y,re.z,0,re.y,re.z),l.push(0,X,0,G,1,X,1,X,0,G,1,G),[Y,z,X]=[q,re,G];this.setAttribute("position",new ft(o,3)),this.setAttribute("normal",new ft(a,3)),this.setAttribute("uv",new ft(l,2))}},hZ=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters);return{shape:t.shape&&t.shape instanceof _i?t.shape:new _i,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e,height:n,innerRadiusPercent:i,spikes:r,cornerRadius:s,angle:o,depth:a,extrudeBevelSize:l,extrudeBevelSegments:c}=t.parameters,h=t.shape,u=e*.5,d=n*.5,f=0,p=0,v=o*Math.PI/360/r,g=Math.PI/2*3*-1,m=u*i/100,y=d*i/100;if(r===3&&i===50){v=2*Math.PI/r;for(let b=0;b<r;b++){let A=v*b,S=f+Math.sin(A)*u,T=p+Math.cos(A)*d;h.addPoint(h.createPoint(S,T))}}else for(let b=0;b<r;b++){let A=f+Math.cos(g)*u,S=p+Math.sin(g)*d;h.addPoint(h.createPoint(A,S)),g+=v,A=f+Math.cos(g)*m,S=p+Math.sin(g)*y,h.addPoint(h.createPoint(A,S)),g+=v}h.isClosed=!0;for(let b=0,A=h.points.length;b<A;b++)h.points[b].roundness=s;h.roundness=s,h.update();let w=tp.create({shape:h,parameters:{roundness:s,depth:a,extrudeBevelSize:l,extrudeBevelSegments:c}});return Object.assign(w,{userData:{...t,type:"StarGeometry"}})}},lBe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e,height:n}=t.parameters,i=new wE(e,n);return Object.assign(i,{userData:{...t,type:"TextFrameGeometry"}})}},cBe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:Math.PI*2,cornerRadius:30,cornerSegments:8},t.parameters),i=Math.abs(n.width),r=Math.abs(n.height??n.width),s=Math.round(Math.abs(n.depth??n.width*.25));return{parameters:Object.assign(n,{width:i,height:r,depth:s})}}static build(t){let{width:e,height:n,depth:i,radialSegments:r,tubularSegments:s,arc:o,cornerRadius:a,cornerSegments:l}=t.parameters,c=uBe(e,n,i,e*.5,o,s,0,0,r,a,l);return c.scale(1,n/e,1),Object.assign(c,{userData:{...t,type:"TorusGeometry"}})}};function uBe(t,e,n,i,r,s,o,a,l,c,h){return[e,n]=[n,e],o=e/2,r/=2*Math.PI,r==1&&(c=0),new RF(!0,t,e,n,i,r,s,o,a,l,c,h)}var hBe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width),tube:n.tube??n.width*.125})}}static build(t){let{width:e,tube:n,tubularSegments:i,radialSegments:r,p:s,q:o}=t.parameters,a=e*.5;a!==n&&(a-=n);let l=new xK(a,n,i,r,s,o);return Object.assign(l,{userData:{...t,type:"TorusKnotGeometry"}})}},dBe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},t.parameters);return{shape:t.shape&&t.shape instanceof _i?t.shape:new _i,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width*(n.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e=100,height:n,cornerRadius:i,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o,isRect:a}=t.parameters,l=t.shape,c=e*.5,h=n*.5;a?(l.addPoint(l.createPoint(-c,h)),l.addPoint(l.createPoint(c,-h)),l.addPoint(l.createPoint(-c,-h))):(l.addPoint(l.createPoint(0,h)),l.addPoint(l.createPoint(c,-h)),l.addPoint(l.createPoint(-c,-h))),l.isClosed=!0;for(let d=0,f=l.points.length;d<f;d++)l.points[d].roundness=i;l.roundness=i,l.update();let u=tp.create({shape:l,parameters:{roundness:i,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o}});return Object.assign(u,{userData:{...t,type:"TriangleGeometry"}})}};function fBe(t,e){let n=2*Math.PI;return(t%n+n)%n===(e%n+n)%n}function pBe(t,e,n){let i=[new N,new N,new N],r=[new N,new N,new N];return t.extractBasis(i[0],i[1],i[2]),e.extractBasis(r[0],r[1],r[2]),i.forEach((s,o)=>{let a=r[o],l=sn.lerp(s.length(),a.length(),n);s.lerp(a,n).setLength(l)}),new nt().makeBasis(i[0],i[1],i[2])}var mBe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},t.parameters),i=Math.abs(n.width),r=Math.abs(n.height??n.width),s=Math.abs(n.depth??0),o=(e==null?void 0:e.shapeData)??DF.create({parameters:IJ}).userData.shape;return{path:t.path??tM.defaultData(),parameters:Object.assign(n,{width:i,height:r,depth:s,extrusion:{...BJ,...n.extrusion}}),shapeData:o}}static build(t){if(t.path.points.length>=2){let e=new gBe(t);return Object.assign(e,{userData:{...t,type:"PathGeometry"}})}else return Object.assign(new Lt,{userData:{...t,type:"PathGeometry"}})}},gBe=class extends Lt{constructor(t){super(),this.type="PathExtrusionGeometry",this.inputs=t,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let t=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&t.depth===1)||!fBe(t.twist,0)||t.startScale!==t.endScale}build(){let t=this._extractPathPoints();if(t.length<2)return;let e=this._computeBasisMatrices(t),{depth:n,offset:i}=this.inputs.parameters.extrusion,r=this.inputs.path.isClosed?t.length:t.length-1,s=Math.floor(i*r),o=this.inputs.path.isClosed?Math.ceil((n+i)*r):Math.ceil(Math.min(1,n+i)*r),a=Math.min(Math.max(2,o-s+1),r+2),l=[],c=[];for(let P=0;P<a;P++){let R=this.inputs.path.isClosed?(P+s)%t.length:Math.min(P+s,t.length-1);l.push(t[R].clone()),c.push(e[R].clone())}let h=(P,R,F)=>{l[P]=l[P].clone().lerp(l[R],F),c[P]=pBe(c[P],c[R],F)},u=0,d=i*r%1;(!this.inputs.path.isClosed||n<=1)&&(d||i===0)&&(u=d,h(0,1,u));let f=0,p=(i+n)*r%1;if((this.inputs.path.isClosed&&n<=1||!this.inputs.path.isClosed&&i+n<1)&&p&&(f=p,h(l.length-1,l.length-2,1-f)),n===0){let P=l.length-1;l[P].copy(l[0]),c[P].copy(c[0])}this._applyPathModifiers(c,u,f);let{regions:v,infos:g,vertices:m}=this._computeShapePoints(5),y=0,w=0;g.sort((P,R)=>P.start-R.start),g.forEach(P=>{P.verticesStart=y,P.verticesCount=P.continuous.reduce((R,F,B)=>R+(B===0||!F?2:1),0),w+=P.verticesCount,y=w});let b=w*a,A,S=0;if(this._isOpenEnded()){try{A=xh({windingRule:Rn.ODD,elementType:Gi.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:v})}catch{A=eZ}S=A.vertexCount}let T=b+2*S,M={positions:new Float32Array(T*3),normals:new Float32Array(T*3),uvs:new Float32Array(T*2)},E=[];g.forEach(P=>{this._extrudeRegion(P,m,c,l,M,E,this._isGeometryClosed()&&!this._isOpenEnded())}),A&&(this._closeEnd(A,b,E,M,c[0],l[0],!1),this._closeEnd(A,b+S,E,M,c[c.length-1],l[l.length-1],!0)),this.setAttribute("position",new Ut(M.positions,3)),this.setAttribute("normal",new Ut(M.normals,3)),this.setAttribute("uv",new Ut(M.uvs,2)),this.setIndex(E)}_extractPathPoints(){let t=WJ(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(t.length<2)return[];let e=[t[0]];return t.forEach(n=>{e[e.length-1].distanceToSquared(n)>.001&&e.push(n)}),this.inputs.path.isClosed&&e[e.length-1].distanceTo(e[0])<.001&&e.pop(),e}_computeBasisMatrices(t){let e=[],n=t.length,i=this.inputs.path.isClosed,r=new N,s=new N,o=new N,a=new N,l=new N(0,1,0);for(let p=0;p<n;p++){let v=t[p],g;p===0?g=i?t[t.length-2]:v.clone().multiplyScalar(2).sub(t[1]):g=t[p-1];let m;p===n-1?m=i?t[1]:v.clone().multiplyScalar(2).sub(t[p-1]):m=t[p+1];let y=v.clone().sub(g).normalize(),w=m.clone().sub(v).normalize(),b=y.clone().add(w).normalize();o.copy(b),p===0&&(b.equals(l)||b.clone().negate().equals(l))&&l.set(0,0,1);let A=l.clone().cross(b).normalize(),S=b.clone().cross(A).normalize();l.copy(S),a.copy(A),p===0&&(r.copy(S),s.copy(b));let T=new nt().makeBasis(A,S,b);e.push(T)}let c=i?s:o,h=i?r:new N(0,1,0),u=c.clone().cross(a).normalize(),d=Math.acos(h.dot(u));if(isNaN(d))return e;let f=h.clone().cross(u);c.dot(f)>0&&(d*=-1);for(let p=1;p<e.length;p++){let v=new nt().makeRotationZ(d*p/e.length);e[p].multiply(v)}return e}_applyPathModifiers(t,e,n){let i=t.length,{angle:r,twist:s,startScale:o,endScale:a}=this.inputs.parameters.extrusion,l=new nt,c=new nt;return t.forEach((h,u)=>{let d=u===0?0:u===i-1?1:(u-e)/(i-(n===0?0:1)-(e+(1-n)));l.makeRotationZ(sn.lerp(r,r+s,d));let f=sn.lerp(o,a,d);c.makeScale(f,f,f),h.multiply(l).multiply(c)}),t}_computeShapePoints(t=12,e=Rn.ODD){let n=this.inputs.shapeData,i=n.extractShapePointsToFlatArray([],t),r=n.shapeHoles.map(c=>{let h=c.extractShapePointsToFlatArray([],t),u=[];for(let d=h.length-1;d>=1;d-=2){let f=h[d-1],p=h[d-0];u.push(f,p)}return u}),s;try{s=xh({windingRule:e,elementType:Gi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[i]})}catch{s=PF}let o;try{o=xh({windingRule:Rn.ODD,elementType:Gi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...r]})}catch{o=$J}if(!s)throw new Error("error generating geometry");let a=s.elementCount;if(o){s.elementCount+=o.elementCount;for(let c=0;c<o.elements.length;c++){let h=o.elements[c],u=c%2===0?s.vertexCount:0;s.elements.push(h+u)}for(let c=0;c<o.vertexIndices.length;c++){let h=o.vertexIndices[c],u=s.vertexCount;s.vertexIndices.push(h+u)}for(let c=0;c<o.vertices.length;c++){let h=o.vertices[c];s.vertices.push(h)}}for(let c=0,h=s.vertexCount;c<h;c++){let u=c*2;s.vertices[u+0],s.vertices[u+1]}let l=[];for(let c=s.elementCount-1;c>=0;c--){let h=c>=a,u=c*2,d=s.elements[u+0],f=s.elements[u+1],p=d+f,v={start:d,count:f,normals:[],isHole:h,continuous:[],verticesStart:0,verticesCount:0};l.push(v);let g=d,m=p-1,y=d+1,w=n.roundedCurves.length;do{let b=g-d;s.vertices[m*2+0],s.vertices[m*2+1];let A=s.vertices[g*2+0],S=s.vertices[g*2+1],T=s.vertices[y*2+0],M=s.vertices[y*2+1],E=A-T,P=S-M,R=Math.sqrt(E*E+P*P);E/=R,P/=R,v.normals[b*2+0]=-P,v.normals[b*2+1]=E;let F=s.vertexIndices[g];if(Array.isArray(F))v.continuous[b]=!1;else{let[B,k]=n.getCurveIndexFromVertexId(F-1,!0);if(k>0&&k<1)v.continuous[b]=!0;else{let j=k===1?B+1:B-1;j=(j+w)%w;let Z=k===1?0:1,ee=n.roundedCurves[B].getTangent(k),O=n.roundedCurves[j].getTangent(Z);v.continuous[b]=ee.dot(O)>.95}}h&&(v.normals[b*2+0]*=-1,v.normals[b*2+1]*=-1),[m,g,y]=[g,y,y+1],y>=p&&(y-=f)}while(y!==d+1)}return{regions:[i,...r],infos:l,vertices:s.vertices}}_insertVertex(t,e,n,i,r){let s=e*2,o=e*3;t.positions[o+0]=n.x,t.positions[o+1]=n.y,t.positions[o+2]=n.z,t.normals[o+0]=i.x,t.normals[o+1]=i.y,t.normals[o+2]=i.z,t.uvs[s+0]=r.x,t.uvs[s+1]=r.y}_extrudeRegion(t,e,n,i,r,s,o){let a=new N,l=new N,c=new N,h=new N,u=new be;n.forEach((f,p)=>{let v=i[p],g=t.verticesStart*n.length+t.verticesCount*p;for(let m=0;m<t.count;m++){let y=(t.start+m)*2;if(a.set(e[y+0],e[y+1],0),c.copy(a).applyMatrix4(f).add(v),t.continuous[m])h.set(t.normals[m*2+0],t.normals[m*2+1],0);else{let w=m==0?(t.start+t.count-1)*2:y-2;l.set(e[w+0],e[w+1],0),h.copy(a).sub(l),h.set(-h.y,h.x,0),t.isHole||h.negate()}if(h.applyMatrix4(f).normalize(),u.set(m===0?1:m/t.count,p/(n.length-1)),this._insertVertex(r,g,c,h,u),g++,!t.continuous[m]||m===0){if(m===0)h.set(t.normals[m*2+0],t.normals[m*2+1],0),u.set(0,p/(n.length-1));else{let w=m===t.count-1?t.start*2:y+2;l.set(e[w+0],e[w+1],0),h.copy(l).sub(a),h.set(-h.y,h.x,0),t.isHole||h.negate()}h.applyMatrix4(f).normalize(),this._insertVertex(r,g,c,h,u),g++}}});let d=n.length-1;for(let f=0;f<d;f++){let p=t.verticesStart*n.length+t.verticesCount*f,v=t.verticesStart*n.length+t.verticesCount*(f+1),g=0;for(let m=0;m<t.count;m++){(!t.continuous[m]||m===0)&&g++;let y=m===t.count-1?0:g+1,w=p+g,b=p+y,A=v+y,S=v+g;t.isHole?s.push(w,A,b,w,S,A):s.push(w,b,A,w,A,S),g++}}}_closeEnd(t,e,n,i,r,s,o){let a=t.vertexCount,l=new N(0,0,o?-1:1).applyMatrix4(r),c=new N,h=new be;for(let d=0;d<a;d++){let f=2*d;c.set(t.vertices[f+0],t.vertices[f+1],0).applyMatrix4(r).add(s),this._insertVertex(i,e+d,c,l,h)}let u=t.elements;for(let d=0;d<t.elementCount;d++){let f=3*d,p=u[f+0]+e,v=u[f+(o?1:2)]+e,g=u[f+(o?2:1)]+e;n.push(p,v,g)}}};function dZ(){let t=new Lt;return t.setAttribute("position",new Ut(new Float32Array([]),3)),t.setIndex(new Ut(new Uint16Array([]),1)),t}var vBe=dZ().attributes,yBe=12,xBe=1,fZ=class extends Lt{constructor(t,e){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,vBe),this.userData={parameters:t,type:"TextGeometry"};let n=e.getFont(t.font);n!=null&&n.isLoaded?(this.font=n,this.update(t)):this.updateFont(t.font,e).then(()=>{this.update(t),e==null||e.requestRender()})}async updateFont(t,e){let n=e.getFont(t);n&&(this.font=n,await n.loadingPromise)}update(t){let e=this.font;if(this.userData={parameters:t,type:"TextGeometry"},!(e!=null&&e.isLoaded)){console.warn("Cannot update text because its font is not loaded");return}let{width:n,height:i,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o,text:a,textTransform:l}=t,c=l===2?a.toUpperCase():l===3?a.toLowerCase():a,h=wBe(t,e,c),{shapes:u,charWidths:d,charCoords:f}=e.generateShapes(h,t),p=n*.5,v=i*.5,g=u.map(w=>new _i().fromShape(w));this.vectorShapes=g;let m=g.map(w=>tp.create({shape:w,parameters:{depth:r,extrudeBevelSegments:o,extrudeBevelSize:s,windingRule:r<=0?Rn.NONZERO:Rn.ODD,subdivisions:this.isLowResolution&&r>0?xBe:yBe}})),y=m.length?Qm(m):dZ();y.translate(-p,v,0),this.dispose(),this.wrappedText=h,this.charCoords=f,this.charWidths=d,this.deleteAttribute("extrudeNormal"),Object.entries(y.attributes).forEach(([w,b])=>{this.setAttribute(w,b)}),this.setIndex(y.index),this.computeBoundingSphere()}clone(){let t=Gf(new Lt,fZ.prototype);return t.copy(this),console.log("CloneGeometry",this,t),t}copy(t){return Object.entries(t.attributes).forEach(([e,n])=>{this.setAttribute(e,n)}),this.setIndex(t.index),this.userData={parameters:{...t.userData.parameters},type:"TextGeometry"},this}async setText(t){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:t})}get text(){return this.userData.parameters.text??""}};function wBe(t,e,n){n=n??t.text;let i=[""],r="";for(let s of n)r+=s,s===" "||s===`
`?(i[i.length-1]+=r,r="",s===`
`&&i.push("")):e.getTextWidth(i[i.length-1]+r,t)>t.width&&(i[i.length-1].length&&i.push(""),e.getTextWidth(i[i.length-1]+r,t)>t.width&&(r.length===1?(i[i.length-1]+=r,r=""):(i[i.length-1]+=r.slice(0,-1),r=r[r.length-1],i.push(""))));return i[i.length-1]+=r,i}var pZ,LF=new Promise(t=>{pZ=t}),i6=!1;async function _Be(){if(i6)return;let t="https://unpkg.com/@splinetool/modelling-wasm@0.9.314/build",[e,n]=await Promise.all([yE(()=>import("./process-10f79362.js"),[]),fetch(`${t}/process.wasm`).then(s=>s.arrayBuffer())]),i=e.default,r=await i({wasmBinary:n});pZ(r),i6=!0}function mM(t,e,n){let i={parameters:t,type:t.type};if(t.type==="PathGeometry")i.path=t.path;else if(t.type==="VectorGeometry"){let s=_i.createFromState(t.shape,t.width,t.height);i.shape=s}else if(t.type==="NonParametricGeometry")t.data.groups&&t.data.groups.forEach(s=>s.materialIndex=Math.max(s.materialIndex??0,0)),i.geometry=new _K().parse(t);else{if(t.type==="SubdivGeometry")return new fs(t,n);if(t.type==="TextGeometry")return new fZ(t,e)}let r;try{r=c6(i)}catch(s){console.error(s)}if(!r){let s=_i.createFromState(eM.defaultData(),100,100);i.shape=s,r=c6(i)}return r}var bBe=new nt;function NI(t,e,n,i){let r=t.position.array,s=t.normal.array,o=bBe.makeScale(e,n,i).invert().elements,a,l,c;for(var h=0,u=r.length;h<u;h+=3)r[h]*=e,r[h+1]*=n,r[h+2]*=i,a=s[h],l=s[h+1],c=s[h+2],s[h]=o[0]*a+o[4]*l+o[8]*c,s[h+1]=o[1]*a+o[5]*l+o[9]*c,s[h+2]=o[2]*a+o[6]*l+o[10]*c;t.position.needsUpdate=!0,t.normal.needsUpdate=!0}var Xb=new ji,am=new N,Ct;LF.then(t=>{Ct=t});var r6=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),s6=new Uint32Array([0,1,2,3]),o6=new Uint8Array([4]),fs=class extends Lt{constructor(t,e){super(),this.data=t,this.flatShading=e,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(t,e){this.freeSubdivPointer();let n=this.data.scaleBaked,i=Sf.div(e,n);this.subdividedGeometry&&NI(this.subdividedGeometry.attributes,...i),this.originalGeometry&&NI(this.originalGeometry.attributes,...i),this.data=t;let r=this.userData.parameters;this.userData.parameters={width:r.width*i[0],height:r.height*i[1],depth:r.depth*i[2]},this.originalGeometry.boundingSphere.center.multiply(am.fromArray(i));let s=am.set(r.width,r.height,r.depth).length();this.originalGeometry.boundingSphere.radius=s/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let t,e,n;try{({originalGeometry:t,subdividedGeometry:e,subdivPointer:n}=fs.build(this.data,void 0,!this.flatShading,void 0))}catch{t=new nc(100,100,100),n=0}this.subdivPointer=n,this.originalGeometry=t,this.subdividedGeometry=e??void 0;let i=this.subdividedGeometry??this.originalGeometry;Object.assign(this,i),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(fs.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let t=this.originalGeometry;t.boundingSphere===null&&(t.boundingSphere=new ha,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=t.boundingSphere));let e=t.attributes.position,n=t.boundingSphere.center;Xb.setFromBufferAttribute(e),Xb.getCenter(n),t.boundingSphere.radius=n.distanceTo(Xb.max),isNaN(t.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Xb.getSize(am);let i={width:am.x,height:am.y,depth:am.z};return this.userData.parameters=i,i}static build(t,e,n,i){let r,s,o,a=(t==null?void 0:t.phongAngle)??35;n===!1&&(a=-1),e&&(Ct.free_bvh(e),Ct.free_subdivision_surface(e));try{r=fs.allocate(t,i)}catch(l){console.error(l,t),r=fs.allocate({positionWASM:r6,indexWASM:s6,verticesPerFaceWASM:o6},i)}if(Ct.set_destination_refinement_level(r,0),s=fs.buildLevel(r,!0,a),t.subdivisions>0)try{Ct.set_destination_refinement_level(r,t.subdivisions),o=fs.buildLevel(r,!1,a)}catch{try{Ct.set_destination_refinement_level(r,t.subdivisions-1),o=fs.buildLevel(r,!1,a)}catch{o=null}}else o=null;return{subdivPointer:r,originalGeometry:s,subdividedGeometry:o}}static primitiveToQuads(t,e,n){t.widthSegments>16&&(t.widthSegments=16),t.heightSegments>16&&(t.heightSegments=16),t.depthSegments>16&&(t.depthSegments=16),t.radialSegments>16&&(t.radialSegments=16),t.type==="DodecahedronGeometry"&&(t.detail=0);let i;if(t.type==="TorusGeometry"&&t.arc===Math.PI*2){let{width:c,height:h,depth:u,arc:d,tubularSegments:f,radialSegments:p}=t;i=new RF(!0,c,u,h,c*.5,d/(2*Math.PI),f,u/2,0,p,0,0,!0)}else i=t.shape!==void 0?e.geometry:mM(t,n,!1);let r,s,o,a;({positions:r,triIndices:a}=IF(i.getAttribute("position"),i.getIndex()));let l;if(t.type==="CylinderGeometry"&&t.cornerRadius===0&&t.hollow===0&&t.openEnded===!1){let c=t.radialSegments*t.heightSegments*3*2,h=c+t.radialSegments*3;l=[c,h]}return{indices:s,verticesPerFace:o}=mZ(r,a,i,l),{positions:r,indices:s,verticesPerFace:o}}static allocate(t,e){var w;let n,i,r,s=[],o=[];t.positionWASM&&t.positionWASM.length>0?(n=t.positionWASM,i=t.indexWASM,r=t.verticesPerFaceWASM):(n=r6,i=s6,r=o6);let a=n.length,l=i.length,c=r.length,h=n.length+s.length+o.length,u=i.length+r.length,d=h*Float32Array.BYTES_PER_ELEMENT+u*Uint32Array.BYTES_PER_ELEMENT,f=h*Float32Array.BYTES_PER_ELEMENT,p=Ct._malloc(d),v=new Float32Array(Ct.HEAPF32.buffer,p,h),g=new Uint32Array(Ct.HEAPU32.buffer,p+f,u);v.set(n,0),v.set(s,n.length),v.set(o,n.length+s.length),g.set(i,0),g.set(r,i.length);let m;(w=t==null?void 0:t.scaleBaked)!=null&&w.some(b=>b!==1)&&(m=new nt().makeScale(...t.scaleBaked)),e&&(m?m.premultiply(e):m=e);let y=m?Ct.alloc_subdivision_surface2(p,a,p+f,l,p+f+i.length*Uint32Array.BYTES_PER_ELEMENT,c,m.elements):Ct.alloc_subdivision_surface(p,a,p+f,l,p+f+i.length*Uint32Array.BYTES_PER_ELEMENT,c);return Ct._free(p),y}static buildLevel(t,e,n,i,r){let s=r?Ct.get_mesh_data2(t,e?Ct.Level.CONTROL:Ct.Level.REFINED,n,r.elements):Ct.get_mesh_data(t,e?Ct.Level.CONTROL:Ct.Level.REFINED,n),o=8,a=Ct.HEAPU32.subarray(s>>2,(s>>2)+o),l=a.subarray(4,4+4),c=0,h=Ct.HEAPU32[a[c]>>2],u=Ct.HEAPF32.subarray(h>>2,(h>>2)+l[c]);c++;let d=Ct.HEAPU32[a[c]>>2],f=Ct.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let p=Ct.HEAPU32[a[c]>>2],v=Ct.HEAPU32.subarray(p>>2,(p>>2)+l[c]);c++;let g=Ct.HEAPU32[a[c]>>2],m=Ct.HEAPU32.subarray(g>>2,(g>>2)+l[c]);if(c++,i===void 0){let y=new Lt;if(y.setIndex(new Oy(m,1)),y.setAttribute("position",new ft(u,3)),y.setAttribute("normal",new ft(f,3)),e){y.setAttribute("faceMap",new Oy(v,1));let w=new Float32Array(f.length/3*4).fill(0);y.setAttribute("color",new Ut(w,4))}return Ct.free_mesh_data(s),y.userData.type="SubdivGeometry",y}i.getAttribute("position").copyArray(u),i.getAttribute("normal").copyArray(f),i.attributes.position.needsUpdate=!0,i.attributes.normal.needsUpdate=!0,Ct.free_mesh_data(s)}static freeSubdivPointer(t){Ct.free_bvh(t),Ct.free_subdivision_surface(t)}static buildControlCageWireframe(t,e,n){let i=Ct.get_wireframe_data_for_base_level(t),r=4,s=Ct.HEAPU32.subarray(i>>2,(i>>2)+r),o=s.subarray(2,2+2),a=0,l=Ct.HEAPU32[s[a]>>2],c=Ct.HEAPF32.subarray(l>>2,(l>>2)+o[a]);a++;let h=Ct.HEAPU32[s[a]>>2],u=Ct.HEAPU32.subarray(h>>2,(h>>2)+o[a]);if(e===void 0){let d=new Lt;d.setAttribute("position",new ft(c,3));let f=new Float32Array(c.length);for(let p=0,v=c.length;p<v;)f[p++]=n.r,f[p++]=n.g,f[p++]=n.b;return d.setAttribute("color",new Ut(f,3)),d.setIndex(new Oy(u,1)),Ct.free_wireframe_data_for_base_level(i),d}e.getAttribute("position").copyArray(c),e.attributes.position.needsUpdate=!0,Ct.free_wireframe_data_for_base_level(i)}static updateCollabMesh(t,e,n){let i=e===0;i||Ct.set_destination_refinement_level(t,e);let r=n?Ct.get_topological_data2(t,i?Ct.Level.CONTROL:Ct.Level.REFINED,n.elements):Ct.get_topological_data(t,i?Ct.Level.CONTROL:Ct.Level.REFINED),s=6,o=Ct.HEAPU32.subarray(r>>2,(r>>2)+s),a=o.subarray(3,3+3),l=0,c=Ct.HEAPU32[o[l]>>2],h=new Float32Array(Ct.HEAPF32.subarray(c>>2,(c>>2)+a[l]));l++;let u=Ct.HEAPU32[o[l]>>2],d=new Uint32Array(Ct.HEAPU32.subarray(u>>2,(u>>2)+a[l]));l++;let f=Ct.HEAPU32[o[l]>>2],p=new Uint8Array(Ct.HEAPU32.subarray(f>>2,(f>>2)+a[l]));return Ct.free_topological_data(r),{positions:h,indices:d,verticesPerFace:p}}},a6=["getX","getY","getZ"];function IF(t,e){let n={},i=e?e.count:t.count,r=0,s=[],o=[],a=1e4;for(let c=0;c<i;c++){let h=e?e.getX(c):c,u="";for(let d=0;d<3;d++)u+=`${~~(t[a6[d]](h)*a)},`;if(u in n)s.push(n[u]);else{for(let d=0;d<3;d++)o.push(t[a6[d]](h));n[u]=r,s.push(r),r++}}let l=[];for(let c=0;c<s.length;c+=3)s[c]===s[c+1]||s[c]===s[c+2]||s[c+1]===s[c+2]||l.push(s[c],s[c+1],s[c+2]);return{positions:o,triIndices:l}}var Yb=new N,X2=new N,Y2=new N,q2=new N;function mZ(t,e,n,i){let r=[],s=[];if(n.userData.shape!==void 0&&n.userData.parameters.depth===0&&n.userData.shape.shapeHoles.length===0){let o=n.userData.shape.extractShapePointsToFlatArray([]),a=n.userData.parameters.spikes;if(n.userData.type==="EllipseGeometry"&&a<=24&&a%4===0&&n.userData.parameters.angle>=360){let h=o.length/2/a;o=o.filter((u,d)=>Math.floor(d/2)%h===0)}let l=0;for(let h=0;h<o.length;h+=2)l+=(o[h]-o[(h===0?o.length:h)-2])*(o[h+1]+o[(h===0?o.length:h)-1]);t.length=0;let c=0;if(l<0)for(let h=0;h<o.length;h+=2)t.push(o[h],o[h+1],0),r.push(c++);else for(let h=o.length-2;h>=0;h-=2)t.push(o[h],o[h+1],0),r.push(c++);return s.push(c),{indices:r,verticesPerFace:s}}for(let o=0,a=n.capStartIndex??e.length;o<a;)if(e[o+1]===e[o+3]&&e[o+2]===e[o+5]||e[o+0]===e[o+3]&&e[o+2]===e[o+4]){Yb.set(t[e[o]*3],t[e[o]*3+1],t[e[o]*3+2]),X2.set(t[e[o+1]*3],t[e[o+1]*3+1],t[e[o+1]*3+2]),Y2.set(t[e[o+4]*3],t[e[o+4]*3+1],t[e[o+4]*3+2]),q2.set(t[e[o+5]*3],t[e[o+5]*3+1],t[e[o+5]*3+2]),X2.sub(Yb).normalize(),Y2.sub(Yb).normalize(),q2.sub(Yb).normalize();let l=X2.cross(Y2).dot(q2);Math.abs(l)>.005||i&&i.some((c,h)=>h%2===1?!1:o>=i[h]&&o<i[h+1])?(r.push(e[o],e[o+1],e[o+2]),s.push(3),o+=3):(r.push(e[o],e[o+1],e[o+4],e[o+5]),s.push(4),o+=6)}else r.push(e[o],e[o+1],e[o+2]),s.push(3),o+=3;if(n.capStartIndex!==void 0){let o=[],a=[],l=0,c=new Float32Array([n.userData.parameters.depth])[0];for(let h=0,u=0;h<t.length;h+=3,u++)t[h+2]===0&&(o.push(u),l++),t[h+2]===c&&a.push(u);if(n.userData.parameters.extrudeBevelSize===0){let h=a[0];a[0]=a[1],a[1]=h}o.reverse(),r.push(...o,...a),s.push(l,l)}return{indices:r,verticesPerFace:s}}var nh={};Wye(nh,{calcBoolean:()=>CBe,calcBooleanTopological:()=>EBe,freeMeshSet:()=>DBe,getMeshSet:()=>TBe,transformMeshSet:()=>PBe});var gZ,SBe=new Promise(t=>{gZ=t}),l6=!1;async function ABe(){if(l6)return;let t="https://unpkg.com/@splinetool/boolean-wasm@0.9.314/build",[e,n]=await Promise.all([yE(()=>import("./boolean-63aef768.js"),[]),fetch(`${t}/boolean.wasm`).then(s=>s.arrayBuffer())]),i=e.default,r=await i({wasmBinary:n});gZ(r),l6=!0}var an,_g;SBe.then(t=>an=t);function MBe(t,e,n){let i,{positions:r,triIndices:s}=IF(t.getAttribute("position"),t.getIndex()),o;if(e&&n){let{indices:a,verticesPerFace:l}=mZ(r,s,t);o=l.length,i=[];for(let c=0,h=0;c<o;c++){i.push(l[c]);for(let u=0;u<l[c];u++)i.push(a[h++])}}else{let a=s.length;i=Array(a+a/3),o=0;for(let l=0,c=0;c<i.length;)i[c++]=3,o++,i[c++]=s[l++],i[c++]=s[l++],i[c++]=s[l++]}return{positions:r,faceIndices:i,nFaces:o}}function vZ(t){let e=t.length,n=e*Uint32Array.BYTES_PER_ELEMENT,i=e*Float32Array.BYTES_PER_ELEMENT,r=Number.isInteger(t[0])?n:i,s=an._malloc(r);return(Number.isInteger(t[0])?new Uint32Array(an.HEAPU32.buffer,s,e):new Float32Array(an.HEAPF32.buffer,s,e)).set(t,0),s}function yZ(t){switch(t){case 0:return an.OP.UNION;case 1:return an.OP.INTERSECTION;case 2:return an.OP.A_MINUS_B;case 3:return an.OP.B_MINUS_A;case 4:return an.OP.SYMMETRIC_DIFFERENCE;case 5:return an.OP.ALL;default:throw new Error("Unknown boolean operation "+t)}}function EBe(t,e){_g===void 0&&(_g=an.init_csg());let n=vZ(t),i=an.csg_calc_topological(_g,n,t.length,yZ(e));an._free(n);let r=6,s=an.HEAPU32.subarray(i>>2,(i>>2)+r),o=s.subarray(3,3+3),a=0,l=an.HEAPU32[s[a]>>2],c=new Float32Array(an.HEAPF32.subarray(l>>2,(l>>2)+o[a]));a++;let h=an.HEAPU32[s[a]>>2],u=new Uint32Array(an.HEAPU32.subarray(h>>2,(h>>2)+o[a]));a++;let d=an.HEAPU32[s[a]>>2],f=new Uint8Array(an.HEAPU32.subarray(d>>2,(d>>2)+o[a]));return an.free_mesh_data(i),{positions:c,indices:u,verticesPerFace:f}}function CBe(t,e,n,i){_g===void 0&&(_g=an.init_csg());let r=vZ(t),s=an.csg_calc(_g,r,t.length,i,yZ(e));an._free(r);let o=5,a=an.HEAPU32.subarray(s>>2,(s>>2)+o),l=a.subarray(2,2+3),c=0,h=an.HEAPU32[a[c]>>2],u=an.HEAPF32.subarray(h>>2,(h>>2)+l[c]);c++;let d=an.HEAPU32[a[c]>>2],f=an.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let p=l[c];n.setAttribute("position",new ft(u,3)),n.setAttribute("normal",new ft(f,3));let v=an.HEAPF32.subarray((s>>2)+5,(s>>2)+5+6);return n.boundingSphere===null&&(n.boundingSphere=new ha),n.boundingSphere.center.set(v[0],v[1],v[2]),n.boundingSphere.radius=(v[3]**2+v[4]**2+v[5]**2)**.5,n.userData.parameters={width:v[3]*2,height:v[4]*2,depth:v[5]*2},an.free_mesh_data(s),p}function TBe(t,e,n){if(an===void 0)return-1;let i,r,s;if(e&&t.userData.positions!==void 0){let v=t.userData;s=v.verticesPerFace.length,i=v.positions,r=Array(v.verticesPerFace.reduce((g,m)=>g+m,0)+s);for(let g=0,m=0,y=0;g<v.verticesPerFace.length;g++){r[y++]=v.verticesPerFace[g];for(let w=0;w<v.verticesPerFace[g];w++)r[y++]=v.indices[m++]}}else({positions:i,faceIndices:r,nFaces:s}=MBe(t,e,n));let o=i.length,a=r.length,l=i.length,c=r.length,h=l*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,u=l*Float32Array.BYTES_PER_ELEMENT,d=an._malloc(h),f=new Float32Array(an.HEAPF32.buffer,d,l),p=new Uint32Array(an.HEAPU32.buffer,d+u,c);return f.set(i,0),p.set(r,0),an.get_csg_mesh(d,o,d+u,a,s)}function PBe(t,e){an.transform_csg_mesh(t,e.elements)}function DBe(t){an.free_csg_mesh(t)}var RBe={ConeGeometry:h3e,CubeGeometry:d3e,CylinderGeometry:u3e,DodecahedronGeometry:p3e,EllipseGeometry:DF,HelixGeometry:W3e,IcosahedronGeometry:X3e,LatheGeometry:Y3e,NonParametricGeometry:eBe,PolygonGeometry:cZ,PyramidGeometry:tBe,RectangleGeometry:uZ,SphereGeometry:rBe,PlaneGeometry:sBe,BackdropGeometry:oBe,StarGeometry:hZ,TextFrameGeometry:lBe,TorusGeometry:cBe,TorusKnotGeometry:hBe,TriangleGeometry:dBe,PathGeometry:mBe,VectorGeometry:tp},c6=t=>RBe[t.type].create(t);function G0(t){return t!==null&&"booleanOp"in t}var xZ=class extends XJ(uo){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new nt}updateVisible(){super.updateVisible(),this.visible=!G0(this.parent)&&this.visible,G0(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(nh.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(t=!1){return t?this.booleanWasTransformed=!0:this.freeBooleanPointer(),G0(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let t of this.children)t instanceof xZ&&(t.freeBooleanPointer(),G0(t)&&t.invalidateUpstreamBooleanData())}updateTransformState(t){let e=super.updateTransformState(t);return e&&G0(this.parent)&&this.invalidateDownstreamBooleanData(!0),e}},qb=new ji;function BF(t,e=0,n=t.count,i,r){let s=1/0,o=1/0,a=1/0,l=-1/0,c=-1/0,h=-1/0;for(let u=e;u<n;u++){let d=t.getX(u),f=t.getY(u),p=t.getZ(u);d<s&&(s=d),f<o&&(o=f),p<a&&(a=p),d>l&&(l=d),f>c&&(c=f),p>h&&(h=p)}qb.min.set(s,o,a),qb.max.set(l,c,h),qb.getCenter(i),qb.getSize(r).multiplyScalar(.5)}var LBe=new Lt,IBe=new N1,Vs=class extends xZ{constructor(t,e){super(LBe,IBe),this.super_Entity(t,e)}updateState(t,e){this.updateState_Entity(t,e)}updateEntityBoxSize(t,e){let n=this.geometry.getAttribute("position");n!==void 0?BF(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,t,e):super.updateEntityBoxSize(t,e)}},u6=class{constructor(t){t=t??{},this.name=t.name,this.type=t.type,this.node=t.node,this.size=t.size,this.needsUpdate=t.needsUpdate}get value(){return this.node.value}set value(t){this.node.value=t}},sd=class{constructor(t){this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},this.uuid=sn.generateUUID(),this.type=t,this.name=""}analyze(t,e){e=e??{},t.analyzing=!0,this.build(t.addFlow(e.slot,e.cache,e.context),"v4"),t.clearVertexNodeCode(),t.clearFragmentNodeCode(),t.removeFlow(),t.analyzing=!1}analyzeAndFlow(t,e,n){return n=n??{},this.analyze(t,n),this.flow(t,e,n)}flow(t,e,n){n=n??{},t.addFlow(n.slot,n.cache,n.context);let i={result:this.build(t,e),code:t.clearNodeCode(),extra:t.context.extra};return t.removeFlow(),i}build(t,e,n){e=e??this.getType(t,e);let i=t.getNodeData(n??this);return t.analyzing&&this.appendDepsNode(t,i,e),t.nodes.indexOf(this)===-1&&t.nodes.push(this),this.updateFrame!==void 0&&t.updaters.indexOf(this)===-1&&t.updaters.push(this),this.generate(t,e,n)}updateFrame(t){}generateReadonly(t,e,n,i,r,s){return""}generate(t,e,n,i,r){return""}parse(t,e,n,i){}appendDepsNode(t,e,n){e.deps=(e.deps||0)+1;let i=t.getTypeLength(n);(i>(e.outputMax||0)||this.getType(t,n))&&(e.outputMax=i,e.output=n)}setName(t){this.name=t}getName(){return this.name}getType(t,e){return e==="sampler2D"||e==="samplerCube"?e:this.type}getHash(){let t="{",e,n;for(e in this)n=this[e],n instanceof sd&&(t+='"'+e+'":'+n.getHash()+",");if(this.hashProperties)for(let i=0;i<this.hashProperties.length;i++)e=this.hashProperties[i],n=this[e],t+='"'+e+'":"'+String(n)+'",';return t+='"id":"'+this.uuid+'"}',t}},BBe=class{constructor(){this.nodes={},this.keywords={}}add(t){this.nodes[t.name]=t}addKeyword(t,e,n){n=n!==void 0?n:!0,this.keywords[t]={callback:e,cache:n}}remove(t){delete this.nodes[t.name]}removeKeyword(t){delete this.keywords[t]}get(t){return this.nodes[t]}getKeyword(t,e){return this.keywords[t].callback(e)}getKeywordData(t){return this.keywords[t]}contains(t){return this.nodes[t]!==void 0}containsKeyword(t){return this.keywords[t]!==void 0}},Ls=new BBe,Hn=class extends sd{constructor(e,n){super(e),this.scope="",n=n??{},this.shared=n.shared!==void 0?n.shared:!0,this.unique=n.unique!==void 0?n.unique:!1}build(e,n,i,r){if(n=n??this.getType(e),this.getShared(e,n)){let s=this.getUnique(e,n);s&&this.uuid===void 0&&(this.uuid=sn.generateUUID()),i=e.getUUID(i??this.getUUID(),!s);let o=e.getNodeData(i),a=o.output||this.getType(e);if(e.analyzing)return(o.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,o,n),this.generate(e,n,i)):super.build(e,n,i);if(s)return o.name=o.name||super.build(e,n,i),o.name;if(!this.getLabel()&&(!this.getShared(e,a)||e.context.ignoreCache||o.deps===1))return super.build(e,n,i);i=this.getUUID(!1);let l=this.getTemp(e,i);if(l)return e.format(l,a,n);{l=super.generate(e,n,i,o.output,r);let c=this.generate(e,a,i);return e.addNodeCode(l+" = "+c+";"),e.format(l,a,n)}}return super.build(e,n,i)}getShared(e,n){return n!=="sampler2D"&&n!=="samplerCube"&&this.shared}getUnique(e,n){return this.unique}setLabel(e){return this.label=e,this}getLabel(){return this.label}getUUID(e){let n=this.uuid;return typeof this.scope=="string"&&(n=this.scope+"-"+n),n}getTemp(e,n){n=n||this.uuid;let i=e.getVars()[n];return i?i.name:void 0}generate(e,n,i,r,s){return this.getShared(e,n)||console.error("TempNode is not shared"),i=i??this.uuid,e.getTempVar(i,r??this.getType(e),s,this.getLabel()).name}},Eo=class extends Hn{constructor(t,e){e=e??{},e.shared=e.shared!==void 0?e.shared:!1,super(t,e),this.readonly=!1}setReadonly(t){return this.readonly=t,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(t,e,n,i,r,s){n=t.getUUID(n??this.getUUID()),i=i??this.getType(t);let o=t.getNodeData(n);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(t,e,n,i,r,s):t.isShader("vertex")?(o.vertex||(o.vertex=t.createVertexUniform(i,this,r,s,this.getLabel())),t.format(o.vertex.name,i,e)):(o.fragment||(o.fragment=t.createFragmentUniform(i,this,r,s,this.getLabel())),t.format(o.fragment.name,i,e))}},Jo=class extends Eo{constructor(t=0,e){super("v2"),this.nodeType="Vector2",this.value=t instanceof be?t:new be(t,e)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}generateReadonly(t,e,n,i,r,s){return t.format("vec2("+this.value.x+", "+this.value.y+")",i,e)}},Xo=class extends Eo{constructor(t=0,e,n){super("v3"),this.nodeType="Vector3",this.value=t instanceof N?t:new N(t,e,n)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}get z(){return this.value.z}set z(t){this.value.z=t}generateReadonly(t,e,n,i,r,s){return t.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",i,e)}},zs=class extends Rt{constructor(t,e,n,i){super(t,e,n),this.isColorA=!0,this.a=i}setRGBA(t,e,n,i){super.setRGB(t,e,n),this.a=i}copy(t){return super.copy(t),this.a="a"in t?t.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}setStyle(t,e="srgb"){let n;if(t==="transparent")return this.setRGBA(0,0,0,0),this;if(n=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(t)){let i,r=n[1],s=n[2];switch(r){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=r==="rgba"?parseFloat(i[4]):1,super.setStyle(t,e);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=r==="hsla"?parseFloat(i[4]):1,super.setStyle(t,e);break}}return super.setStyle(t,e)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(t){this.r=t}set y(t){this.g=t}set z(t){this.b=t}set w(t){this.a=t}},Kd=class extends Eo{constructor(t){super("v4"),this.nodeType="Vector4",this.value=t instanceof zs?t:new zs(t.r,t.g,t.b,t.a)}generateReadonly(t,e,n,i,r,s){return t.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",i,e)}},OBe=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,h6=/[a-z_0-9]+/gi,_t=class extends Hn{constructor(e,n,i,r,s){super(s),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=s===void 0,this.isInterface=!1,this.parse(e,n,i,r)}getShared(e,n){return!this.isMethod}getType(e){return e.getTypeByFormat(this.type)}getInputByName(e){if(this.inputs){let n=this.inputs.length;for(;n--;)if(this.inputs[n].name===e)return this.inputs[n]}}getIncludeByName(e){if(this.includes){let n=this.includes.length;for(;n--;)if(this.includes[n].name===e)return this.includes[n]}}generate(e,n,i,r,s){let o,a=0,l=this.src;if(this.includes)for(let h=0;h<this.includes.length;h++)e.include(this.includes[h],this);for(let h in this.extensions)e.extensions[h]=!0;let c=[];for(;o=h6.exec(this.src);)c.push(o);for(let h=0;h<c.length;h++){let u=c[h],d=u[0],f=this.isMethod?!this.getInputByName(d):!0,p=d;if(this.keywords[d]||this.useKeywords&&f&&Ls.containsKeyword(d)){let v=this.keywords[d];if(!v){let g=Ls.getKeywordData(d);g.cache&&(v=e.keywords[d]),v=v||Ls.getKeyword(d,e),g.cache&&(e.keywords[d]=v)}p=v.build(e)}d!==p&&l[u.index+a-1]!=="."&&(l=l.substring(0,u.index+a)+p+l.substring(u.index+d.length+a),a+=p.length-d.length),this.getIncludeByName(p)===void 0&&Ls.contains(p)&&e.include(Ls.get(p))}return n==="source"?l:this.isMethod?(this.isInterface||e.include(this,void 0,l),this.name):e.format("( "+l+" )",this.getType(e),n)}parse(e,n,i,r){if(this.src=e||"",this.includes=n??[],this.extensions=i??{},this.keywords=r??{},this.isMethod){let s=OBe.exec(this.src);if(this.inputs=[],s&&s.length==4){this.type=s[1],this.name=s[2];let o=s[3].match(h6);if(o){let a=0;for(;a<o.length;){let l=o[a++],c;l==="in"||l==="out"||l==="inout"?c=o[a++]:(c=l,l="");let h=o[a++];this.inputs.push({name:h,type:c,qualifier:l})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},FBe=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,wZ=class extends Hn{constructor(t="",e){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(t||wZ.PI,void 0,void 0,void 0,e)}getType(t){return t.getTypeByFormat(this.type)}parse(t,e,n,i,r){this.src=t||"";let s,o,a="",l=FBe.exec(t);this.useDefine=r??this.src.charAt(0)==="#",l&&l.length>1?(o=l[1],s=l[2],a=l[3]):(s=this.src,o="f"),this.name=s,this.type=o,this.value=a}build(t,e){if(e==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return t.include(this),t.format(this.name,this.getType(t),e)}generate(t,e,n,i,r){return t.format(this.name,this.getType(t),e)}},Tn=wZ;Tn.PI="PI",Tn.PI2="PI2",Tn.RECIPROCAL_PI="RECIPROCAL_PI",Tn.RECIPROCAL_PI2="RECIPROCAL_PI2",Tn.LOG2="LOG2",Tn.EPSILON="EPSILON";var NBe=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),UBe=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),_Z=class extends Hn{constructor(t=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(t)}getType(t){return t.getTypeByFormat(this.name)}getInputByName(t){let e=this.inputs.length;for(;e--;)if(this.inputs[e].name===t)return this.inputs[e]}generate(t,e,n,i,r){return e==="source"?this.src+";":t.format("( "+this.src+" )",this.getType(t),e)}parse(t=""){this.src=t,this.inputs=[];let e=NBe.exec(t);if(e){let n=e[2],i;for(;i=UBe.exec(n);)this.inputs.push({type:i[1],name:i[2]});this.name=e[1]}else this.name="";this.type=this.name}},OF=class extends Hn{constructor(t){super("v2",{shared:!1}),this.nodeType="UV",this.index=t??0}generate(t,e){t.requires.uv[this.index]=!0;let n=this.index>0?this.index+1:"",i=t.isShader("vertex")?"uv"+n:"vUv"+n;return t.format(i,this.getType(t),e)}};Ls.addKeyword("uv",function(){return new OF});Ls.addKeyword("uv2",function(){return new OF(1)});var bm=class extends Hn{constructor(t,e){super("v4"),this.nodeType="ColorSpace",this.input=t,this.method=e??bm.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(t){switch(t){case tc:return["Linear"];case Wt:return["sRGB"];default:return[]}}generate(t,e){var o;let n=this.input.build(t,"v4"),i=this.getType(t),r=bm.Nodes[this.method],s=t.include(r);if(s===bm.LINEAR_TO_LINEAR)return t.format(n,i,e);if(((o=r.inputs)==null?void 0:o.length)===2){let a=this.factor.build(t,"f");return t.format(s+"( "+n+", "+a+" )",i,e)}else return t.format(s+"( "+n+" )",i,e)}fromEncoding(t){let e=bm.getEncodingComponents(t);this.method="LinearTo"+e[0],this.factor=e[1]}fromDecoding(t){let e=bm.getEncodingComponents(t);this.method=e[0]+"ToLinear",this.factor=e[1]}},Gl=bm;Gl.Nodes={LinearToLinear:new _t(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new _t(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new _t(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},Gl.LINEAR_TO_LINEAR="LinearToLinear",Gl.SRGB_TO_LINEAR="sRGBToLinear",Gl.LINEAR_TO_SRGB="LinearTosRGB";var Qn=class extends _t{constructor(t="",e,n,i,r){super(t,r,i,n,e),this.nodeType="Expression"}},wh=class extends Eo{constructor(e=new br,n,i,r){super("v4",{shared:!0}),this.nodeType="Texture",this.value=e,this.uv=n??new OF,this.bias=i,this.project=r!==void 0?r:!1}getTexture(e,n){return super.generate(e,n,this.value.uuid,"t")}generate(e,n){if(n==="sampler2D")return this.getTexture(e,n);let i=this.getTexture(e,n),r=this.uv.build(e,this.project?"v4":"v2"),s=this.bias?this.bias.build(e,"f"):void 0;s===void 0&&e.context.bias&&(s=e.context.bias.setTexture(this).build(e,"f"));let o,a;this.project?o="texture2DProj":o=s?"tex2DBias":"tex2D",s?a=o+"( "+i+", "+r+", "+s+" )":a=o+"( "+i+", "+r+" )";let l={include:e.isShader("vertex"),ignoreCache:!0},c=this.getType(e);return e.addContext(l),this.colorSpace=this.colorSpace??new Gl(new Qn("",c)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(a),a=this.colorSpace.build(e,c),e.removeContext(),e.format(a,c,n)}},gt=class extends Eo{constructor(e){super("f"),this.nodeType="Float",this.value=e??0}generateReadonly(e,n,i,r,s,o){return e.format(this.value+(this.value%1?"":".0"),r,n)}},d6=class extends Hn{constructor(t,e){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=t,this.inputs=e??[]}getFunction(){return this.value}getType(t){return this.value.getType(t)}generate(t,e,n,i,r){i=this.getType(t);let s=this.value,o=s.build(t,e)+"( ",a=[];if(s.inputs){for(let l=0;l<s.inputs.length;l++){let c=s.inputs[l],h=this.inputs[l]||this.inputs[c.name];a.push(h.build(t,t.getTypeByFormat(c.type)))}o+=a.join(", ")+" )"}return t.format(o,i,e)}},bZ=class extends Hn{constructor(t,e,n=bZ.ADD){super(),this.nodeType="Operator",this.type=t.type,this.a=t,this.b=e,this.op=n}getType(t){let e=this.a.getType(t),n=this.b.getType(t);return t.isTypeMatrix(e)?"v4":t.getTypeLength(n)>t.getTypeLength(e)?n:e}generate(t,e){let n=this.getType(t);this.type=n;let i=this.a.build(t,n),r=this.b.build(t,n);return t.format("( "+i+" "+this.op+" "+r+" )",n,e)}},Hl=bZ;Hl.ADD="+",Hl.SUB="-",Hl.MUL="*",Hl.DIV="/";var Cn=class extends Hn{constructor(t,e=Cn.ABS,n,i){super(),this.nodeType="Math",this.a=t,typeof e!="string"?this.b=e:i=e,typeof n!="string"?this.c=n:i=n,this.method=i,this.hashProperties=["method"]}getNumInputs(t){switch(this.method){case Cn.MIX:case Cn.CLAMP:case Cn.REFRACT:case Cn.SMOOTHSTEP:case Cn.FACEFORWARD:return 3;case Cn.MIN:case Cn.MAX:case Cn.MOD:case Cn.STEP:case Cn.REFLECT:case Cn.DISTANCE:case Cn.DOT:case Cn.CROSS:case Cn.POW:return 2;default:return 1}}getInputType(t){let e=t.getTypeLength(this.a.getType(t)),n=this.b?t.getTypeLength(this.b.getType(t)):0,i=this.c?t.getTypeLength(this.c.getType(t)):0;return e>n&&e>i?this.a.getType(t):n>i?this.b.getType(t):this.c.getType(t)}getType(t){switch(this.method){case Cn.LENGTH:case Cn.DISTANCE:case Cn.DOT:return"f";case Cn.CROSS:return"v3"}return this.getInputType(t)}generate(t,e){let n,i,r,s=this.a?t.getTypeLength(this.a.getType(t)):0,o=this.b?t.getTypeLength(this.b.getType(t)):0,a=this.c?t.getTypeLength(this.c.getType(t)):0,l=this.getInputType(t),c=this.getType(t);switch(this.type=c,this.method){case Cn.NEGATE:return t.format("( -"+this.a.build(t,l)+" )",l,e);case Cn.INVERT:return t.format("( 1.0 - "+this.a.build(t,l)+" )",l,e);case Cn.CROSS:n=this.a.build(t,"v3"),i=this.b.build(t,"v3");break;case Cn.STEP:n=this.a.build(t,s===1?"f":l),i=this.b.build(t,l);break;case Cn.MIN:case Cn.MAX:case Cn.MOD:n=this.a.build(t,l),i=this.b.build(t,o===1?"f":l);break;case Cn.REFRACT:n=this.a.build(t,l),i=this.b.build(t,l),r=this.c.build(t,"f");break;case Cn.MIX:n=this.a.build(t,l),i=this.b.build(t,l),r=this.c.build(t,a===1?"f":l);break;default:n=this.a.build(t,l),this.b&&(i=this.b.build(t,l)),this.c&&(r=this.c.build(t,l));break}let h=[];h.push(n),i&&h.push(i),r&&h.push(r);let u=this.getNumInputs(t);if(h.length!==u)throw Error(`Arguments not match used in "${this.method}". Require ${u}, currently ${h.length}.`);return t.format(this.method+"( "+h.join(", ")+" )",c,e)}},zt=Cn;zt.RAD="radians",zt.DEG="degrees",zt.EXP="exp",zt.EXP2="exp2",zt.LOG="log",zt.LOG2="log2",zt.SQRT="sqrt",zt.INV_SQRT="inversesqrt",zt.FLOOR="floor",zt.CEIL="ceil",zt.NORMALIZE="normalize",zt.FRACT="fract",zt.SATURATE="saturate",zt.SIN="sin",zt.COS="cos",zt.TAN="tan",zt.ASIN="asin",zt.ACOS="acos",zt.ARCTAN="atan",zt.ABS="abs",zt.SIGN="sign",zt.LENGTH="length",zt.NEGATE="negate",zt.INVERT="invert",zt.MIN="min",zt.MAX="max",zt.MOD="mod",zt.STEP="step",zt.REFLECT="reflect",zt.DISTANCE="distance",zt.DOT="dot",zt.CROSS="cross",zt.POW="pow",zt.MIX="mix",zt.CLAMP="clamp",zt.REFRACT="refract",zt.SMOOTHSTEP="smoothstep",zt.FACEFORWARD="faceforward";var hy=class extends Hn{constructor(t,e,n){super("v4"),this.nodeType="TextureCubeUV",this.value=t,this.uv=e,this.bias=n}bilinearCubeUV(t,e,n,i){let r=new d6(hy.Nodes.bilinearCubeUV,[e,n,i]);this.colorSpaceTL=this.colorSpaceTL??new Gl(new Qn("","v4")),this.colorSpaceTL.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(r.build(t)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new Gl(new Qn("","v4")),this.colorSpaceTR.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(r.build(t)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new Gl(new Qn("","v4")),this.colorSpaceBL.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(r.build(t)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new Gl(new Qn("","v4")),this.colorSpaceBR.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(r.build(t)+".br");let s={include:t.isShader("vertex"),ignoreCache:!0};t.addContext(s),this.colorSpaceTLExp=new Qn(this.colorSpaceTL.build(t,"v4"),"v4"),this.colorSpaceTRExp=new Qn(this.colorSpaceTR.build(t,"v4"),"v4"),this.colorSpaceBLExp=new Qn(this.colorSpaceBL.build(t,"v4"),"v4"),this.colorSpaceBRExp=new Qn(this.colorSpaceBR.build(t,"v4"),"v4"),t.removeContext();let o=new Qn("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return o.keywords.cubeUV_TL=this.colorSpaceTLExp,o.keywords.cubeUV_TR=this.colorSpaceTRExp,o.keywords.cubeUV_BL=this.colorSpaceBLExp,o.keywords.cubeUV_BR=this.colorSpaceBRExp,o.keywords.cubeUV=r,o}generate(t,e){if(t.isShader("fragment")){let n=this.uv,i=this.bias||t.context.roughness,r=new d6(hy.Nodes.roughnessToMip,[i]),s=new zt(r,hy.Nodes.m0,hy.Nodes.cubeUV_maxMipLevel,zt.CLAMP),o=new zt(s,zt.FLOOR),a=new zt(s,zt.FRACT),l=this.bilinearCubeUV(t,this.value,n,o),c=this.bilinearCubeUV(t,this.value,n,new Hl(o,new gt(1).setReadonly(!0),Hl.ADD)),h=new zt(l,c,a,zt.MIX);return t.format(h.build(t),"v4",e)}else return console.warn("TextureCubeUVNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e)}},UI=hy;UI.Nodes=function(){let t=new _Z(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),e=new Tn("float cubeUV_maxMipLevel 8.0",!0),n=new Tn("float cubeUV_minMipLevel 4.0",!0),i=new Tn("float cubeUV_maxTileSize 256.0",!0),r=new Tn("float cubeUV_minTileSize 16.0",!0),s=new _t(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);s.useKeywords=!1;let o=new _t(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);o.useKeywords=!1;let a=new _t(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[t,s,o,e,n,i,r]);a.useKeywords=!1;let l=new Tn("float r0 1.0",!0),c=new Tn("float v0 0.339",!0),h=new Tn("float m0 -2.0",!0),u=new Tn("float r1 0.8",!0),d=new Tn("float v1 0.276",!0),f=new Tn("float m1 -1.0",!0),p=new Tn("float r4 0.4",!0),v=new Tn("float v4 0.046",!0),g=new Tn("float m4 2.0",!0),m=new Tn("float r5 0.305",!0),y=new Tn("float v5 0.016",!0),w=new Tn("float m5 3.0",!0),b=new Tn("float r6 0.21",!0),A=new Tn("float v6 0.0038",!0),S=new Tn("float m6 4.0",!0),T=[l,c,h,u,d,f,p,v,g,m,y,w,b,A,S],M=new _t(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,T);return{bilinearCubeUV:a,roughnessToMip:M,m0:h,cubeUV_maxMipLevel:e}}();var Sm=class extends Hn{constructor(t){super("v3"),this.nodeType="Normal",this.scope=t??Sm.VIEW}getShared(){return this.scope===Sm.WORLD}build(t,e,n,i){let r=t.context[this.scope+"Normal"];return r?r.build(t,e,n,i):super.build(t,e,n)}generate(t,e,n,i,r){let s;switch(this.scope){case Sm.VIEW:t.isShader("vertex")?s="transformedNormal":s="geometryNormal";break;case Sm.LOCAL:t.isShader("vertex")?s="objectNormal":(t.requires.normal=!0,s="vObjectNormal");break;case Sm.WORLD:t.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(t.requires.worldNormal=!0,s="vWNormal");break}return t.format(s,this.getType(t),e)}},Bs=Sm;Bs.LOCAL="local",Bs.WORLD="world",Bs.VIEW="view",Bs.NORMAL="normal";Ls.addKeyword("viewNormal",function(){return new Bs(Bs.VIEW)});Ls.addKeyword("localNormal",function(){return new Bs(Bs.NORMAL)});Ls.addKeyword("worldNormal",function(){return new Bs(Bs.WORLD)});var Oc=class extends Hn{constructor(t){super("v3"),this.nodeType="Position",this.scope=t??Oc.LOCAL}getType(){switch(this.scope){case Oc.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case Oc.LOCAL:case Oc.WORLD:return!1}return!0}generate(t,e,n,i,r){let s;switch(this.scope){case Oc.LOCAL:t.isShader("vertex")?s="transformed":(t.requires.position=!0,s="vPosition");break;case Oc.WORLD:if(t.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";t.requires.worldPosition=!0,s="vWPosition";break;case Oc.VIEW:s=t.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case Oc.PROJECTION:s=t.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return t.format(s,this.getType(),e)}},Va=Oc;Va.LOCAL="local",Va.WORLD="world",Va.VIEW="view",Va.PROJECTION="projection";Ls.addKeyword("position",function(){return new Va});Ls.addKeyword("worldPosition",function(){return new Va(Va.WORLD)});Ls.addKeyword("viewPosition",function(){return new Va(Va.VIEW)});var Pl=class extends Hn{constructor(t){super("v3"),this.nodeType="Reflect",this.scope=t??Pl.CUBE}getUnique(t){return!t.context.viewNormal}getType(){switch(this.scope){case Pl.SPHERE:return"v2"}return this.type}generate(t,e){let n=this.getUnique(t);if(t.isShader("fragment")){let i;switch(this.scope){case Pl.VECTOR:{let r=new Bs(Bs.VIEW),s=t.context.roughness,o=r.build(t,"v3"),a=new Va(Va.VIEW).build(t,"v3"),l=s?s.build(t,"f"):void 0,c=`reflect( -normalize( ${a} ), ${o} )`;l&&(c=`normalize( mix( ${c}, ${o}, ${l} * ${l} ) )`);let h=`inverseTransformDirection( ${c}, viewMatrix )`;n?(t.addNodeCode(`vec3 reflectVec = ${h};`),i="reflectVec"):i=h;break}case Pl.CUBE:{let r=new Pl(Pl.VECTOR).build(t,"v3"),s="vec3( -"+r+".x, "+r+".yz )";n?(t.addNodeCode(`vec3 reflectCubeVec = ${s};`),i="reflectCubeVec"):i=s;break}case Pl.SPHERE:{let r="normalize( ( viewMatrix * vec4( "+new Pl(Pl.VECTOR).build(t,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";n?(t.addNodeCode(`vec2 reflectSphereVec = ${r};`),i="reflectSphereVec"):i=r;break}}return t.format(i,this.getType(),e)}else return console.warn("ReflectNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.type,e)}},bg=Pl;bg.CUBE="cube",bg.SPHERE="sphere",bg.VECTOR="vector";var kBe=class extends Hn{constructor(t=new wh,e,n){super("v4"),this.nodeType="TextureCube",this.value=t,this.radianceNode=new UI(this.value,e??new bg(bg.VECTOR),n),this.irradianceNode=new UI(this.value,new Bs(Bs.WORLD),new gt(1).setReadonly(!0))}generate(t,e){return t.isShader("fragment")?(t.require("irradiance"),t.context.bias&&t.context.bias.setTexture(this.value),(t.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(t,e)):(console.warn("TextureCubeNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e))}},zBe=class extends Eo{constructor(t=new NO,e,n){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=t,this.uv=e??new bg,this.bias=n}getTexture(t,e){return super.generate(t,e,this.value.uuid,"tc")}generate(t,e){var l;if(e==="samplerCube")return this.getTexture(t,e);let n=this.getTexture(t,e),i=(l=this.uv)==null?void 0:l.build(t,"v3"),r=this.bias?this.bias.build(t,"f"):void 0;r===void 0&&t.context.bias&&(r=t.context.bias.setTexture(this).build(t,"f"));let s;r?s="texCubeBias( "+n+", "+i+", "+r+" )":s="texCube( "+n+", "+i+" )";let o={include:t.isShader("vertex"),ignoreCache:!0},a=this.getType(t);return t.addContext(o),this.colorSpace=this.colorSpace??new Gl(new Qn("",a)),this.colorSpace.fromDecoding(t.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(s),s=this.colorSpace.build(t,a),t.removeContext(),t.format(s,a,e)}},f6=["x","y","z","w"],GBe=["float","vec2","vec3","vec4"],HBe={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},VBe={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},jBe=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.getIncludesCode=function(){function t(e,n){return e.deps.length-n.deps.length}return function(e,n){let i=this.getIncludes(e,n);if(!i)return"";let r="";i=i.sort(t);for(let s=0;s<i.length;s++)i[s].src&&(r+=i[s].src+`
`);return r}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(t,e){this.buildShader("vertex",t),this.buildShader("fragment",e);for(let n=0;n<this.requires.uv.length;n++)if(this.requires.uv[n]){let i=n>0?n+1:"";this.addVaryCode("varying vec2 vUv"+i+";"),n>0&&this.addVertexParsCode("attribute vec2 uv"+i+";"),this.addVertexFinalCode("vUv"+i+" = uv"+i+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this}buildShader(t,e){this.resultCode[t]=e.build(this.setShader(t),"v4")}setMaterial(t,e){return this.defines={},this}addFlow(t,e,n){return this.addSlot(t).addCache(e).addContext(n)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(t){return this.cache=t??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(t){return this.context=Object.assign({},this.context,t),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(t){return this.slot=t||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(t,e){this.fragmentVariables[t]===void 0&&(this.addFragmentCode(`${e} ${t};`),this.fragmentVariables[t]="")}addFragmentParsVariable(t,e){this.fragmentParsVariables[t]===void 0&&(this.addFragmentParsCode(`${e} ${t};`),this.fragmentParsVariables[t]="")}addVertexParsVariable(t,e){this.vertexParsVariables[t]===void 0&&(this.addVertexParsCode(`${e} ${t};`),this.vertexParsVariables[t]="")}addVertexCode(t){this.addCode(t,"vertex")}addFragmentCode(t){this.addCode(t,"fragment")}addCode(t,e){this.code[e??this.shader]+=t+`
`}addVertexNodeCode(t){this.addNodeCode(t,"vertex")}addFragmentNodeCode(t){this.addNodeCode(t,"fragment")}addNodeCode(t,e){this.nodeCode[e??this.shader]+=t+`
`}clearNodeCode(t){t=t??this.shader;let e=this.nodeCode[t];return this.nodeCode[t]="",e}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(t){this.addFinalCode(t,"vertex")}addFragmentFinalCode(t){this.addFinalCode(t,"fragment")}addFinalCode(t,e){this.finalCode[e??this.shader]+=t+`
`}addVertexParsCode(t){this.addParsCode(t,"vertex")}addFragmentParsCode(t){this.addParsCode(t,"fragment")}addParsCode(t,e){this.parsCode[e??this.shader]+=t+`
`}addVaryCode(t){this.addVertexParsCode(t),this.addFragmentParsCode(t)}isCache(t){return this.caches.indexOf(t)!==-1}isSlot(t){return this.slots.indexOf(t)!==-1}define(t,e){this.defines[t]=e===void 0?1:e}require(t){this.requires[t]=!0}isDefined(t){return this.defines[t]!==void 0}getVar(t,e,n,i="varying",r="V",s=""){let o=this.getVars(i),a=o[t];if(!a){let l=o.length;a={name:n||"node"+r+l+(s?"_"+s:""),type:e},o.push(a),o[t]=a}return a}getTempVar(t,e,n,i){return this.getVar(t,e,n,this.shader,"T",i)}getAttribute(t,e){if(!this.attributes[t]){let n=this.getVar(t,e);this.addVertexParsCode("attribute "+e+" "+t+";"),this.addVertexFinalCode(n.name+" = "+t+";"),this.attributes[t]={varying:n,name:t,type:e}}return this.attributes[t]}getCode(t){return[this.prefixCode,this.parsCode[t],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[t],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[t],"uniform"),this.getIncludesCode("consts",t),this.getIncludesCode("structs",t),this.getIncludesCode("functions",t),"void main() {",this.getVarListCode(this.getVars(t)),this.code[t],this.resultCode[t],this.finalCode[t],"}"].join(`
`)}getVarListCode(t,e){e=e??"";let n="";for(let i=0,r=t.length;i<r;++i){let s=t[i],o=s.type,a=s.name,l=s.size,c=this.getFormatByType(o);if(c===void 0)throw new Error("Node pars "+c+" not found.");c.includes("[]")?n+=e+" "+c.substring(0,c.length-2)+" "+a+`[${l}];
`:n+=e+" "+c+" "+a+`;
`}return n}getVars(t){return this.inputs.vars[t??this.shader]}getNodeData(t){let e=t instanceof sd?t.uuid:t;return this.nodeData[e]=this.nodeData[e]||{}}createUniform(t,e,n,i,r,s){if(e.includes("[]")){let o=this.inputs.arrayUniforms,a=o.list.length,l=new u6({type:e,size:n.size,name:i||"nodeUA"+a+(s?"_"+s:""),node:n,needsUpdate:r});return o.list.push(l),o[t].push(l),o[t][l.name]=l,this.uniforms[l.name]=l,l}else{let o=this.inputs.uniforms,a=o.list.length,l=new u6({type:e,name:i||"nodeU"+a+(s?"_"+s:""),node:n,needsUpdate:r});return o.list.push(l),o[t].push(l),o[t][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(t,e,n,i,r){return this.createUniform("vertex",t,e,n,i,r)}createFragmentUniform(t,e,n,i,r){return this.createUniform("fragment",t,e,n,i,r)}include(t,e,n){var s;let i;if(t=typeof t=="string"?Ls.get(t):t,this.context.include===!1)return t.name;t instanceof _t?i=this.includes.functions:t instanceof Tn?i=this.includes.consts:t instanceof _Z&&(i=this.includes.structs);let r=i[this.shader]=i[this.shader]||[];if(t){let o=r[t.name];if(o||(o=r[t.name]={node:t,deps:[]},r.push(o),o.src=t.build(this,"source")),t instanceof _t&&e&&r[e.name]&&r[e.name].deps.indexOf(t)===-1&&(r[e.name].deps.push(t),(s=t.includes)==null?void 0:s.length)){let a=0;do this.include(t.includes[a++],e);while(a<t.includes.length)}return n&&(o.src=n),t.name}else throw new Error("Include not found.")}colorToVectorProperties(t){return t.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(t){return t.replace(/c/g,"v3")}getIncludes(t,e){return this.includes[t][e||this.shader]}getConstructorFromLength(t){return GBe[t-1]}isTypeMatrix(t){return/^m/.test(t)}getTypeLength(t){return t==="f"?1:parseInt(this.colorToVector(t).substr(1))}getTypeFromLength(t){return t===1?"f":"v"+t}findNode(...t){for(let e=0;e<arguments.length;e++){let n=t[e];if(n!=null&&n.isNode)return n}}resolve(...t){for(let e=0;e<arguments.length;e++){let n=t[e];if(n!==void 0){if(n.isNode)return n;if(n.isTexture)switch(n.mapping){case Ff:case Nf:return new zBe(n);case O1:return new kBe(new wh(n));default:return new wh(n)}else{if(n.isVector2)return new Jo(n);if(n.isVector3)return new Xo(n);if(n.isVector4)return new Kd(n)}}}}format(t,e,n){switch(this.colorToVector(n+" <- "+e)){case"f <- v2":return t+".x";case"f <- v3":return t+".x";case"f <- v4":return t+".x";case"f <- i":case"f <- b":return"float( "+t+" )";case"v2 <- f":return"vec2( "+t+" )";case"v2 <- v3":return t+".xy";case"v2 <- v4":return t+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+t+" ) )";case"v3 <- f":return"vec3( "+t+" )";case"v3 <- v2":return"vec3( "+t+", 0.0 )";case"v3 <- v4":return t+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+t+" ) )";case"v4 <- f":return"vec4( "+t+" )";case"v4 <- v2":return"vec4( "+t+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+t+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+t+" ) )";case"i <- f":case"i <- b":return"int( "+t+" )";case"i <- v2":return"int( "+t+".x )";case"i <- v3":return"int( "+t+".x )";case"i <- v4":return"int( "+t+".x )";case"b <- f":return"( "+t+" != 0.0 )";case"b <- v2":return"( "+t+" != vec2( 0.0 ) )";case"b <- v3":return"( "+t+" != vec3( 0.0 ) )";case"b <- v4":return"( "+t+" != vec4( 0.0 ) )";case"b <- i":return"( "+t+" != 0 )"}return t}getTypeByFormat(t){return HBe[t]||t}getFormatByType(t){return VBe[t]||t}getUUID(t,e){return e=e!==void 0?e:!0,e&&this.cache&&(t=this.cache+"-"+t),t}getElementByIndex(t){return f6[t]}getIndexByElement(t){return f6.indexOf(t)}isShader(t){return this.shader===t}setShader(t){return this.shader=t,this}mergeDefines(t){for(let e in t)this.defines[e]=t[e];return this.defines}mergeUniform(t){for(let e in t)this.uniforms[e]=t[e];return this.uniforms}getTextureEncodingFromMap(t){let e;return t?t.isTexture&&(e=t.encoding):e=tc,e===tc&&this.context.gamma&&(e=Wt),e}},bi=class extends Eo{constructor(t=0,e,n,i){super("c"),this.nodeType="Color",this.value=t instanceof zs?t:new zs(t||0,e,n,i)}setRGBA(t){this.value.setRGBA(t.r,t.g,t.b,t.a)}generate(t,e,n,i,r,s){n=t.getUUID(n??this.getUUID()),i=i??this.getType(t);let o=t.getNodeData(n),a=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let l=this.alpha.build(t,"f");t.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${l};`)}return a?this.generateReadonly(t,e,n,i,r,s):t.isShader("vertex")?(o.vertex||(o.vertex=t.createVertexUniform(i,this,r,s,this.getLabel())),t.format(o.vertex.name,i,e)):(o.fragment||(o.fragment=t.createFragmentUniform(i,this,r,s,this.getLabel())),t.format(o.fragment.name,i,e))}generateReadonly(t,e,n,i,r,s){return t.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",i,e)}},On=class extends Eo{constructor(t){super("i"),this.nodeType="Int",this.value=Math.floor(t??0)}generateReadonly(t,e,n,i,r,s){return t.format(this.value.toString(),i,e)}},SZ=class extends sd{constructor(){super("basic"),this.nodeType="Basic",this.color=new bi(5526619),this.shadingAlpha=new gt(1),this.shadingBlend=new On(0)}get category(){return"phong"}generate(t){let e;if(t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform(xv.merge([tt.fog])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{this.color===void 0&&(this.color=new bi(5526619)),this.color.analyze(t,{slot:"color"}),this.alpha&&this.alpha.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"});let n=this.color.flow(t,"c",{slot:"color"}),i=this.alpha?this.alpha.flow(t,"f"):void 0,r=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0;t.requires.transparent=i!==void 0,t.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let s=["#include <normal_fragment_begin>",n.code];i&&s.push(i.code,"#ifdef ALPHATEST"," if ( "+i.result+" <= ALPHATEST ) discard;","#endif"),r?s.push(r.code,`vec3 outgoingLight = ${n.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${r.result}, 1.0, SPE_BLENDING_NORMAL);`):s.push(`vec3 finalColor = ${n.result};`),i?s.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${i.result} );`):s.push("gl_FragColor = vec4("+n.result+", 1.0 );"),s.push("#include <fog_fragment>","#include <dithering_fragment>"),e=s.join(`
`)}return e}},Vd=class extends Eo{constructor(t=1,e){super("f[]"),this.nodeType="FloatArray",this.size=t,this.value=Array.isArray(e)?e:typeof e=="number"?new Array(t).fill(e):new Array(t).fill(0)}},ti={normalRenderTarget:new wh,normalRenderTargetDepth:new wh,transmissionRenderTarget:new wh,transmissionSize:new Jo(2048,2048),transmissionRenderTargetDepth:new wh,pixelRatioNode:new gt(1),resolution:new Jo,penumbraSize:new Vd(5,.5)};for(let t of Object.values(ti))t.isRenderGlobal=!0;var WBe=class extends sd{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new bi(5526619),this.emissive=new bi(0),this.emissiveIntensity=new gt(1),this.shadingAlpha=new gt(1),this.shadingBlend=new On(0)}get category(){return"lambert"}build(t){let e;if(t.define("LAMBERT"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform(xv.merge([tt.fog,tt.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{t.mergeUniform({penumbraSize:ti.penumbraSize}),this.color===void 0&&(this.color=new bi(5526619)),this.color.analyze(t,{slot:"color"}),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let n=this.color.flow(t,"c",{slot:"color"}),i=this.emissive.flow(t,"c",{slot:"emissive"}),r=this.emissiveIntensity.flow(t,"f",{slot:"emissive"}),s=this.shadingAlpha.flow(t,"f"),o=this.shadingBlend.flow(t,"i"),a=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(t,"f"):void 0;t.requires.transparent=l!==void 0,t.addParsCode(["uniform float penumbraSize[5];","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let c=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];c.push(n.code,"vec3 diffuseColor = "+n.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),l&&c.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),c.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),i&&c.push(i.code,"reflectedLight.directDiffuse += "+i.result+" * "+r.result+";"),c.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;"),c.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result}, ${o.result} );
				}
				`),a&&c.push(a.code,`outgoingLight = spe_blend(outgoingLight, ${a.result}, 1.0, SPE_BLENDING_NORMAL);`),l?c.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):c.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=c.join(`
`)}return e}},XBe=class extends sd{constructor(){super("phong"),this.nodeType="Phong",this.color=new bi(5526619),this.specular=new bi(1118481),this.shininess=new gt(30),this.shadingAlpha=new gt(1),this.shadingBlend=new On(0)}get category(){return"phong"}build(t){let e;if(t.define("PHONG"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform(xv.merge([tt.fog,tt.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif


				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{t.mergeUniform({penumbraSize:ti.penumbraSize}),this.color===void 0&&(this.color=new bi(5526619)),this.color.analyze(t,{slot:"color"}),this.specular.analyze(t),this.shininess.analyze(t),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let n=this.color.flow(t,"c",{slot:"color"}),i=this.specular.flow(t,"c"),r=this.shininess.flow(t,"f"),s=this.shadingAlpha.flow(t,"f"),o=this.shadingBlend.flow(t,"i"),a=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(t,"f"):void 0;t.requires.transparent=l!==void 0,t.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let c=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];c.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",i.code,"	vec3 specular = "+i.result+";",r.code,"	float shininess = max( 0.0001, "+r.result+" );","	float specularStrength = 1.0;"),l&&c.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),c.push("material.diffuseColor = diffuseColor;"),c.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),c.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;"),c.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result}, ${o.result} );
				}
				`),a&&c.push(a.code,`outgoingLight = spe_blend(outgoingLight, ${a.result}, 1.0, SPE_BLENDING_NORMAL);`),l?c.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):c.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=c.join(`
`)}return e}},YBe=class extends sd{constructor(){super("standard"),this.nodeType="Standard",this.color=new bi(5526619),this.roughness=new gt(.3),this.metalness=new gt(0),this.reflectivity=new gt(.5),this.shadingAlpha=new gt(1),this.shadingBlend=new On(0)}get category(){return"physical"}build(t){let e;if(t.define("STANDARD"),t.requires.lights=!0,t.extensions.derivatives=!0,t.extensions.shaderTextureLOD=!0,t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform(xv.merge([tt.fog,tt.lights])),tt.LTC_1&&(t.uniforms.ltc_1={value:void 0},t.uniforms.ltc_2={value:void 0}),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{t.mergeUniform({penumbraSize:ti.penumbraSize});let n={gamma:!0};this.color===void 0&&(this.color=new bi(5526619)),this.color.analyze(t,{slot:"color",context:n}),this.roughness.analyze(t),this.metalness.analyze(t),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t),this.reflectivity&&this.reflectivity.analyze(t);let i=this.color.flow(t,"c",{slot:"color",context:n}),r=this.roughness.flow(t,"f"),s=this.metalness.flow(t,"f"),o=this.shadingAlpha.flow(t,"f"),a=this.shadingBlend.flow(t,"i"),l=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(t,"f"):void 0,h=this.reflectivity?this.reflectivity.flow(t,"f"):void 0;t.requires.transparent=c!==void 0,t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let u=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];u.push(i.code,"	vec3 diffuseColor = "+i.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",r.code,"	float roughnessFactor = "+r.result+";",s.code,"	float metalnessFactor = "+s.result+";"),c&&u.push(c.code,"#ifdef ALPHATEST","	if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),u.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),u.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),h?u.push(h.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+h.result+" ) ), diffuseColor, metalnessFactor );"):u.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),u.push("#include <lights_fragment_begin>"),u.push("#include <lights_fragment_end>"),u.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;"),u.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result}, ${a.result} );
				}
				`),l&&u.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result} );`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=u.join(`
`)}return e}},qBe=class extends sd{constructor(){super("toon"),this.nodeType="Toon",this.color=new bi(5526619),this.specular=new bi(1118481),this.shininess=new gt(30),this.shadingAlpha=new gt(1),this.shadingBlend=new On(0)}get category(){return"toon"}build(t){let e;if(t.define("TOON"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform(xv.merge([tt.fog,tt.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{t.mergeUniform({penumbraSize:ti.penumbraSize}),this.color===void 0&&(this.color=new bi(5526619)),this.color.analyze(t,{slot:"color"}),this.specular.analyze(t),this.shininess.analyze(t),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let n=this.color.flow(t,"c",{slot:"color"}),i=this.specular.flow(t,"c"),r=this.shininess.flow(t,"f"),s=this.shadingAlpha.flow(t,"f"),o=this.shadingBlend.flow(t,"i"),a=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(t,"f"):void 0;t.requires.transparent=l!==void 0,t.addParsCode(["uniform float penumbraSize[5];","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let c=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];c.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",i.code,"	vec3 specular = "+i.result+";",r.code,"	float shininess = max( 0.0001, "+r.result+" );","	float specularStrength = 1.0;"),l&&c.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),c.push("material.diffuseColor = diffuseColor;"),c.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),c.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular;"),c.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result}, ${o.result} );
				}
				`),a&&c.push(a.code,`outgoingLight = spe_blend(outgoingLight, ${a.result}, 1.0, SPE_BLENDING_NORMAL);`),l?c.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):c.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=c.join(`
`)}return e}},H0=class extends Eo{constructor(t){super("b"),this.nodeType="Bool",this.value=t??!1}generateReadonly(t,e,n,i){return t.format(this.value?"true":"false",i,e)}},AZ=class extends Eo{constructor(t){super("m3"),this.nodeType="Matrix3",this.value=t??new Rr}generateReadonly(t,e,n,i,r,s){return t.format("mat3("+this.value.elements.join(", ")+")",i,e)}get elements(){return this.value.elements}set elements(t){this.value.fromArray(t)}},jd=class extends Eo{constructor(t=1,e){super("v4[]"),this.nodeType="Vector4Array",this.size=t,this.value=Array.isArray(e)?e:e instanceof Zt?new Array(t).fill(e):new Array(t).fill(new Zt(0))}},FF=(t=>(t.SIMPLEX="simplex3d",t.SIMPLEX_FRACTAL="simplex3dFractal",t.ASHIMA="simplexAshima",t.FBM="fbm",t.PERLIN="perlin",t))(FF||{}),ia=function(){let t=new _t(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),e=new _t(`float simplex3d(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[t]);e.keywords.F3=new Tn("float F3 0.3333333"),e.keywords.G3=new Tn("float G3 0.1666667");let n=new _t(`float simplex3dFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplex3d(m * rot1)
				 + 0.2666667 * simplex3d(2.0 * m * rot2)
				 + 0.1333333 * simplex3d(4.0 * m * rot3)
				 + 0.0666667 * simplex3d(8.0 * m);
		}`,[e]),i=new _t("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),r=new _t("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),s=new _t(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[i,r]),o=new _t("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),a=new _t("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[o]),l=new _t(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[a]),c=new _t(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[l]);c.keywords.NUM_OCTAVES=new Tn("int NUM_OCTAVES 5");let h=new _t("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),u=new _t(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[i,r,h]);return{simplex:e,simplexFractal:n,simplexAshima:s,fbm:c,perlin:u}}(),MZ=class extends Hn{constructor(t,e,n,i,r,s,o,a,l,c,h,u){super("v3"),this.nodeType="Noise",this.scale=t,this.size=e,this.move=n,this.fA=i,this.fB=r,this.distortion=s,this.colorA=o,this.colorB=a,this.colorC=l,this.colorD=c,this.alpha=h,this.noiseType=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e,n,i,r){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let s=Object.values(FF)[this.noiseType.value],o=new _t(`vec3 ${s}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, float alpha, out float calpha) {
                vec3 st = position / size;
				st /= scale;
				vec3 q = vec3(${s}(st),
							  ${s}(st + vec3(1.0)),
							  ${s}(st + vec3(1.0)));
				vec3 r = vec3(${s}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
							  ${s}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
							  ${s}(st * q));
				float f = ${s}(st + r);
				vec4 color;
				color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
				color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
				color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));

                float lalpha = alpha * color.a;
                calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );

			    accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return clamp(color, 0.0, 1.0).rgb;
			}`,[ia.simplex,ia.simplexFractal,ia.simplexAshima,ia.fbm,ia.perlin]),a=t.include(o),l=[];return l.push(this.scale.build(t,"f")),l.push(this.size.build(t,"v3")),l.push(this.move.build(t,"f")),l.push(this.fA.build(t,"v2")),l.push(this.fB.build(t,"v2")),l.push(this.distortion.build(t,"v2")),l.push(this.colorA.build(t,"v4")),l.push(this.colorB.build(t,"v4")),l.push(this.colorC.build(t,"v4")),l.push(this.colorD.build(t,"v4")),l.push(this.alpha.build(t,"f")),l.push(this.calpha),t.format(a+"("+l.join(",")+")",this.getType(t),e)}};MZ.numOctaves=5;var EZ=class extends Hn{constructor(t,e,n,i,r,s,o){super("v3"),this.nodeType="Fresnel",this.color=t,this.bias=e,this.scale=n,this.intensity=i,this.factor=r,this.alpha=s,this.mode=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("vWorldViewDir"),t.require("worldNormal"),t.isShader("fragment")){t.addFragmentVariable(this.calpha,"float");let n=t.include(EZ.Nodes.fresnel),i=[];return i.push(this.color.build(t,"c")),i.push(this.bias.build(t,"f")),i.push(this.scale.build(t,"f")),i.push(this.intensity.build(t,"f")),i.push(this.factor.build(t,"f")),i.push(this.alpha.build(t,"f")),i.push(this.mode.build(t,"i")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("FresnelNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},CZ=EZ;CZ.Nodes=function(){return{fresnel:new _t(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, float alpha, int mode, out float calpha) {
				float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

				float lalpha = clamp( fresnel, 0.0, 1.0 ) * alpha;
				calpha = lalpha / clamp(lalpha + accumAlpha, 0.001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;
				return color;
			}`)}}();var TZ=class extends Hn{constructor(t,e,n,i,r,s,o){super("v3"),this.nodeType="Rainbow",this.filmThickness=t,this.movement=e,this.wavelengths=n,this.noiseStrength=i,this.noiseScale=r,this.offset=s,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("vWorldViewDir"),t.require("worldNormal"),t.isShader("fragment")){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let n=t.include(TZ.Nodes.rainbow),i=[];return i.push(this.filmThickness.build(t,"f")),i.push(this.movement.build(t,"f")),i.push(this.wavelengths.build(t,"v3")),i.push(this.noiseStrength.build(t,"f")),i.push(this.noiseScale.build(t,"f")),i.push(this.offset.build(t,"v3")),i.push(this.alpha.build(t,"f")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("RainbowNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},PZ=TZ;PZ.Nodes=function(){let t=new _t(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
                 vec3 st = position / noiseScale;
				 vec3 q = vec3(simplex3d(st),
							  simplex3d(st + vec3(1.0)),
							  simplex3d(st + vec3(1.0)));

				 vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),
							  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),
							  simplex3d(st * q));

                 float noise = simplex3d(st + r);

                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);
             }`,[ia.simplex]);return{rainbow:new _t(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, float alpha, out float calpha) {
                 vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

                 float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);
                 float lalpha = alpha * rainbowContribution;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

                 return res;
             }`,[t])}}();var DZ=class extends Hn{constructor(t,e,n,i,r,s,o,a,l,c,h,u,d,f,p,v){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=t,this.contourColor=e,this.outlineWidth=n,this.contourWidth=i,this.contourThreshold=r,this.outlineThreshold=s,this.contourFrequency=o,this.outlineSmoothing=a,this.contourDirection=l,this.positionalLines=c,this.compensation=h,this.resolution=u,this.normalMap=d,this.depthMap=f,this.pixelRatio=p,this.alpha=v,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("vWorldViewDir"),t.require("worldNormal"),t.extensions.derivatives=!0,this.firstTime){let n=this.outlineWidth.build(t,"f"),i=this.resolution.build(t,"v2"),r=this.compensation.build(t,"b"),s=this.pixelRatio.build(t,"f");t.addVertexParsVariable("randomColor","attribute vec3"),t.addVertexParsVariable("extrudeNormal","attribute vec3"),t.addVertexParsVariable(n,"uniform float"),t.addVertexParsVariable(i,"uniform vec2"),t.addVertexParsVariable(r,"uniform bool"),t.addVertexParsVariable(s,"uniform float"),t.addVertexParsVariable("vID","flat out float"),t.addFragmentParsVariable("vID","flat in float");let o=`g${this.uuid.toString().replace(/-/g,"")}`;t.addVertexFinalCode(`
                vID = randomColor.r;
                if (${r}) {
                    vec4 ${o}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${o}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    vec2 ${o}_offset = normalize(${o}_clipNormal.xy) / ${i} * (${n} / 2.0) * ${o}_clipPosition.w * 2.0 * ${s};
                    ${o}_clipPosition.xy += ${o}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${o}_clipPosition;
                }
            `)}if(t.isShader("fragment")){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let n=t.include(DZ.Nodes.outline),i=[];return i.push(this.outlineColor.build(t,"c")),i.push(this.contourColor.build(t,"c")),i.push(this.outlineWidth.build(t,"f")),i.push(this.contourWidth.build(t,"f")),i.push(this.contourThreshold.build(t,"f")),i.push(this.outlineThreshold.build(t,"f")),i.push(this.contourFrequency.build(t,"f")),i.push(this.outlineSmoothing.build(t,"f")),i.push(this.contourDirection.build(t,"v3")),i.push(this.positionalLines.build(t,"b")),i.push(this.resolution.build(t,"v2")),i.push(this.normalMap.getTexture(t,"t")),i.push(this.depthMap.getTexture(t,"t")),i.push(this.pixelRatio.build(t,"f")),i.push(this.compensation.build(t,"b")),i.push(this.alpha.build(t,"f")),i.push(this.calpha),this.firstTime=!this.firstTime,t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("OutlineNode is not compatible with "+t.shader+" shader."),""}},RZ=DZ;RZ.Nodes=function(){let t=new _t(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 texelSize = (vec2(1.0) / resolution) * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -texelSize.x, -texelSize.y);
	uvSamples[1] = uv + vec2(0.0, -texelSize.y);
	uvSamples[2] = uv + vec2(  texelSize.x, -texelSize.y);
	uvSamples[3] = uv + vec2( -texelSize.x, 0.0);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  texelSize.x, 0.0);
	uvSamples[6] = uv + vec2( -texelSize.x, texelSize.y);
	uvSamples[7] = uv + vec2(0.0, texelSize.y);
	uvSamples[8] = uv + vec2(  texelSize.x, texelSize.y);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec4 sobel_edge_h = normalSamples[2] + (2.0*normalSamples[5]) + normalSamples[8] - (normalSamples[0] + (2.0*normalSamples[3]) + normalSamples[6]);
  	vec4 sobel_edge_v = normalSamples[0] + (2.0*normalSamples[1]) + normalSamples[2] - (normalSamples[6] + (2.0*normalSamples[7]) + normalSamples[8]);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new _t(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
                 return result;
             }`,[t])}}();var LZ=class extends Hn{constructor(t,e,n,i,r,s,o,a){super("v3"),this.nodeType="Transmission",this.thickness=t,this.ior=e,this.roughness=n,this.transmissionSamplerSize=i,this.transmissionSamplerMap=r,this.transmissionDepthMap=s,this.aspectRatio=o,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.extensions.shaderTextureLOD=!0,t.extensions.derivatives=!0,t.isShader("fragment")){t.define("NUM_SAMPLES",30),t.require("worldPosition"),t.requires.worldNormal=!0,t.requires.modelMatrix=!0,t.requires.projectionMatrix=!0,t.addFragmentVariable(this.calpha,"float");let n=t.include(LZ.Nodes.transmission),i=[];return i.push(this.thickness.build(t,"f")),i.push(this.ior.build(t,"f")),i.push(this.roughness.build(t,"f")),i.push(this.transmissionSamplerSize.build(t,"v2")),i.push(this.transmissionSamplerMap.getTexture(t,"t")),i.push(this.transmissionDepthMap.getTexture(t,"t")),i.push(this.aspectRatio.build(t,"v2")),i.push("normal"),i.push(this.alpha.build(t,"f")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("TransmissionNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},IZ=LZ;IZ.Nodes=function(){let t=new _t(`
            float gaussian(vec2 i) {
                const float sigma = float(NUM_SAMPLES) * .25;
                return exp( -.5* dot(i/=sigma,i) ) / ( 6.28 * sigma*sigma );
            }`),e=new _t(`
            vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

                const int LOD = 2;
                const int sLOD = 4; // tile size = 2^LOD

                vec3 O = vec3(0);
                float a = 0.0;
                const int s = NUM_SAMPLES/sLOD;
                for ( int i = 0; i < s*s; i++ ) {
                    int modulo = (i)-((i)/(s))*(s);
                    vec2 d = vec2(float(modulo), float(i/s))*float(sLOD) - float(NUM_SAMPLES)/2.;
                    vec2 uv = U + (scale * aspectRatio) * d;
                    // What is the depth of the opaque object we're trying to sample
                    float opaqueDepth = unpackRGBAToDepth(texture2D(dm, uv));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU + ((scale * min(lod / 2., 1.)) * aspectRatio) * d;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    float gaussian = gaussian(d);
		            #ifdef TEXTURE_LOD_EXT
                    O += gaussian * texture2DLodEXT( sp, uv, lod).rgb;
                    #else
                    O += gaussian * textureLod( sp, uv, lod).rgb;
                    #endif
                    a += gaussian;
                }
                return O / a;
            }`,[t]),n=new _t(`
            vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        // Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		        // The thickness is specified in local space.
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),i=new _t(`
float applyIorToRoughness( float roughness, float ior ) {
		// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
		// an IOR of 1.5 results in the default amount of microfacet refraction.
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	} `),r=new _t(`
vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
        float lod = applyIorToRoughness(roughness, ior);

        return blur(transmissionSamplerMap, fragCoord, vec2(lod / (transmissionSamplerSize.x / 2.)), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
	}`,[i,e]),s=new _t(`
vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
        vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
        vec3 refractedRayExit = position + transmissionRay;

        // Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
        vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
        vec2 refractionCoords = ndcPos.xy / ndcPos.w;
        refractionCoords += 1.0;
        refractionCoords /= 2.0;

        vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
        vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
        unrefractedCoords += 1.0;
        unrefractedCoords /= 2.0;

        // Sample framebuffer to get pixel the refracted ray hits.
        return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    }`,[r,n]);return{transmission:new _t(`
            vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                float lalpha = alpha;

                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
                 return transmission;
            }`,[s])}}();var dy=class extends Hn{constructor(t,e,n,i,r,s,o,a,l,c,h){super("v3"),this.nodeType="Depth",this.gradientType=t,this.smooth=e,this.near=n,this.far=i,this.isVector=r,this.isWorldSpace=s,this.origin=o,this.direction=a,this.colors=l,this.steps=c,this.alpha=h,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){let n=`g${this.uuid.toString().replace(/-/g,"")}`,i=new _t(`vec3 ${n}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${n}_MAX_COLORS], float steps[${n}_MAX_COLORS], float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${n}_IS_VECTOR
                   #ifdef ${n}_LINEAR
                       #ifdef ${n}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${n}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${n}_SMOOTH
				for ( int i = 1; i < ${n}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${n}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a;
               calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );

			   accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
               return color.rgb;
			}`,[dy.Nodes.vectorLinearWorldSpaceDepth,dy.Nodes.vectorLinearObjectSpaceDepth,dy.Nodes.vectorSphericalObjectSpaceDepth,dy.Nodes.vectorSphericalWorldSpaceDepth]);if(t.isShader("fragment")){t.define(`${n}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&t.define(`${n}_SMOOTH`),this.isVector.value>.5&&t.define(`${n}_IS_VECTOR`),this.gradientType.value===0&&t.define(`${n}_LINEAR`),this.isWorldSpace.value>.5&&t.define(`${n}_WORLDSPACE`),t.require("worldPosition"),t.addFragmentVariable(this.calpha,"float");let r=t.include(i),s=[];return s.push(this.near.build(t,"f")),s.push(this.far.build(t,"f")),s.push(this.origin.build(t,"v3")),s.push(this.direction.build(t,"v3")),s.push(this.colors.build(t,"v4[]")),s.push(this.steps.build(t,"f[]")),s.push(this.alpha.build(t,"f")),s.push(this.calpha),t.format(r+"("+s.join(",")+")",this.getType(t),e)}else return console.warn("DepthNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},BZ=dy;BZ.Nodes=function(){let t=new _t(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),e=new _t(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),n=new _t(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),i=new _t(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:t,vectorLinearObjectSpaceDepth:e,vectorSphericalWorldSpaceDepth:n,vectorSphericalObjectSpaceDepth:i}}();var p6=class extends Hn{constructor(t,e,n,i){super("v3"),this.nodeType="Blend",this.a=t,this.b=e,this.alpha=n,this.mode=i}generate(t,e){if(t.isShader("fragment")){let n=[];return n.push(this.a.build(t,"c")),n.push(this.b.build(t,"c")),n.push(this.alpha.build(t,"f")),n.push(this.mode.build(t,"i")),t.format("spe_blend("+n.join(",")+")",this.getType(t),e)}else return console.warn("BlendNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},kI=(t=>(t.NOISE="noise",t.MAP="map",t))(kI||{}),OZ=class extends Hn{constructor(t,e,n,i,r){super("v3"),this.displacementTypeIndex=new On(0),this.nodeType="VertexDisplacement",this.intensity=t,this.movementOrTexture=e,Object.values(kI)[this.displacementTypeIndex.value]==="map"&&(this.mat=new AZ(this.movementOrTexture.value.matrix)),this.cropOrOffset=n,this.scale=i,this.noiseFunctionIndex=r}generate(t,e){if(t.isShader("vertex")){t.define("USE_LAYER_DISPLACE");let n,i=[];switch(i.push("displaced_position"),i.push("displaced_normal"),Object.values(kI)[this.displacementTypeIndex.value]){case"map":{n=t.include(OZ.Nodes.map),i.push(this.movementOrTexture.getTexture(t,"t")),i.push("uv"),i.push(this.cropOrOffset.build(t,"f")),this.mat&&i.push(this.mat.build(t,"mat3"));break}case"noise":{let r=Object.values(FF)[this.noiseFunctionIndex.value],s=new _t(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),o=new _t(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement) {
							return p + n * ${r}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
						}`,[ia.simplex,ia.simplexFractal,ia.simplexAshima,ia.fbm,ia.perlin]),a=new _t(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[o,s]);n=t.include(a),i.push(this.scale.build(t,"f")),i.push(this.cropOrOffset.build(t,"v3")),i.push(this.movementOrTexture.build(t,"f"));break}}return i.push(this.intensity.build(t,"f")),i.push("displaced_normal"),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("VertexDisplacementNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},FZ=OZ;FZ.Nodes=function(){let t=new _t(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),e=new _t(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new _t(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[t,e])}}();var NZ=class extends Hn{constructor(t,e,n,i,r,s,o,a){super("v3"),this.nodeType="Gradient",this.gradientType=t,this.smooth=e,this.colors=n,this.steps=i,this.offset=r,this.morph=s,this.angle=o,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.define("GRAD_MAX",10),t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let n=t.include(NZ.Nodes.gradient),i=[];return i.push(this.gradientType.build(t,"i")),i.push(this.smooth.build(t,"b")),i.push(this.colors.build(t,"v4[]")),i.push(this.steps.build(t,"f[]")),i.push(this.offset.build(t,"v2")),i.push(this.morph.build(t,"v2")),i.push(this.angle.build(t,"f")),i.push(this.alpha.build(t,"f")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("GradientNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},UZ=NZ;UZ.Nodes=function(){return{gradient:new _t(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return color.xyz;
			}`)}}();var GS=class extends Hn{constructor(t,e,n,i,r,s,o,a,l,c){super("v3"),this.nodeType="CustomTexture",this.firstTime=!0,this.texture=t,this.textureSize=e,this.crop=n,this.projection=i,this.axis=r,this.side=s,this.size=o,this.mat=a,this.alpha=l,this.mode=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){t.require("position"),t.require("normal"),t.require("uv"),t.requires.uv=[!0],t.extensions.shaderTextureLOD=!0,t.extensions.derivatives=!0;let n=`g${this.uuid.toString().replace(/-/g,"")}`,i;switch(this.projection.value){case 3:i=t.include(GS.Nodes.cylindrical);break;case 2:i=t.include(GS.Nodes.spherical);break;case 1:let s=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],o=new _t(`
		vec3 ${n}_planarTexture(sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float alpha, int mode, out float calpha) {

				vec2 uvs = ( mat * vec3( (${n}_vCustomUv * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, mat * ${s}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return col;
			}`);i=t.include(o);break;default:i=t.include(GS.Nodes.uv);break}if(this.projection.value===1&&this.firstTime){t.addVertexParsCode(`varying vec2 ${n}_vCustomUv;`),t.addFragmentParsCode(`varying vec2 ${n}_vCustomUv;`);let s=["zy","xz","xy"][this.axis.value];t.addVertexFinalCode(`${n}_vCustomUv = (1. + (transformed.${s})) / 2.;`)}t.addFragmentVariable(this.calpha,"float");let r=[];return r.push(this.texture.generate(t,"t")),r.push(this.textureSize.build(t,"v2")),r.push(this.crop.build(t,"f")),r.push(this.mat.build(t,"mat3")),r.push(this.size.build(t,"v2")),r.push(this.alpha.build(t,"f")),r.push(this.mode.build(t,"i")),r.push(this.calpha),this.firstTime=!this.firstTime,t.format(i+"("+r.join(",")+")",this.getType(t),e)}},kZ=GS;kZ.Nodes=function(){let t=new _t(`
vec3 cylindricalTexture(sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float alpha, int mode, out float calpha) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return col;
			}
`),e=new _t(`
vec3 sphericalTexture(sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float alpha, int mode, out float calpha) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return col;
			}
`),n=new _t(`vec3 uvTexture(sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float alpha, int mode, out float calpha) {

				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return col;
			}`);return{cylindrical:t,spherical:e,uv:n}}();var zZ=class extends Hn{constructor(t,e){super("v3"),this.nodeType="CustomNormal",this.cnormal=t,this.alpha=e}generate(t,e){if(t.isShader("fragment")){let n=t.include(zZ.Nodes.customNormal),i=[];return i.push(this.cnormal.build(t,"v3")),i.push("normal"),i.push(this.alpha.build(t,"f")),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("CustomNormalNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},GZ=zZ;GZ.Nodes=function(){return{customNormal:new _t(`vec3 customNormal(vec3 cnormal, vec3 norm, float alpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return normal;
			}`)}}();function po(t,e){return e.color(t)}function QBe(t,e){switch(t.type){case"fresnel":return ZBe(t,e);case"gradient":return $Be(t);case"depth":return eOe(t);case"normal":return tOe(t);case"noise":return nOe(t,e);case"rainbow":return iOe(t);case"toon":return rOe(t,e);case"outline":return sOe(t,e);case"transmission":return oOe(t);case"color":return JBe(t,e)}}function KBe(t){return{type:t.type}}function ac(t){let{alpha:e,mode:n}=t;return{...KBe(t),alpha:e,mode:n}}function JBe(t,e){return{...ac(t),color:po(t.color,e)}}function ZBe(t,e){let{bias:n,scale:i,intensity:r,factor:s,color:o}=t;return{...ac(t),color:po(o,e),bias:n,scale:i,intensity:r,factor:s}}function $Be(t){let{gradientType:e,smooth:n,colors:i,steps:r,angle:s,offset:o,morph:a}=t;return{...ac(t),gradientType:e,smooth:n,colors:i.map(l=>new Zt(l[0],l[1],l[2],l[3])),num:i.length,steps:r,offset:new be(...o),morph:new be(...a),angle:s}}function eOe(t){let{gradientType:e,near:n,far:i,isVector:r,isWorldSpace:s,origin:o,direction:a,colors:l,steps:c,smooth:h}=t;return{...ac(t),gradientType:e,near:n,far:i,isVector:r,isWorldSpace:s,origin:new N(...o),direction:a?new N(...a):new N(1,0,0),colors:l.map(u=>u!==void 0?new Zt(u[0],u[1],u[2],u[3]):new Zt(0,0,0,0)),steps:c.slice(0,l.length),smooth:h}}function tOe(t){let{cnormal:e}=t;return{...ac(t),cnormal:new N(e[0],e[1],e[2])}}function nOe(t,e){return{...ac(t),scale:t.scale,move:t.move,fA:new be(...t.fA),fB:new be(...t.fB),size:new N(...t.size),distortion:new be(...t.distortion),colorA:po(t.colorA,e),colorB:po(t.colorB,e),colorC:po(t.colorC,e),colorD:po(t.colorD,e),noiseType:t.noiseType}}function iOe(t){return{...ac(t),filmThickness:t.filmThickness,movement:t.movement,wavelengths:new N(...t.wavelengths),noiseStrength:t.noiseStrength,noiseScale:t.noiseScale,offset:new N(...t.offset)}}function rOe(t,e){return{...ac(t),positioning:t.positioning,colors:t.colors.map(n=>new Zt(n[0],n[1],n[2],n[3])),num:t.colors.length,steps:t.steps,source:new N(...t.source),isWorldSpace:t.isWorldSpace,noiseStrength:t.noiseStrength,noiseScale:t.noiseScale,shadowColor:po(t.shadowColor,e),offset:new N(...t.offset)}}function sOe(t,e){return{...ac(t),outlineColor:po(t.outlineColor,e),contourColor:po(t.contourColor,e),outlineWidth:t.outlineWidth,contourWidth:t.contourWidth,outlineThreshold:t.outlineThreshold,contourThreshold:t.contourThreshold,outlineSmoothing:t.outlineSmoothing,contourFrequency:t.contourFrequency,contourDirection:new N(...t.contourDirection),positionalLines:t.positionalLines,compensation:t.compensation}}function oOe(t,e){return{...ac(t),thickness:t.thickness,ior:t.ior,roughness:t.roughness}}var gM=class extends zs{},aOe=class{constructor(t=1e3*10){this.timeout=t,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...t){}remove(t){let e=this.cache.get(t);e&&(this.dispose(t,e.data),this.cache.delete(t),e.prev.next=e.next,e.next.prev=e.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let t=Date.now(),e=this.head.next;for(;e.time<t-this.timeout;)this.dispose(e.src,e.data),this.cache.delete(e.src),e=e.next,e.prev=this.head,this.head.next=e;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(t){var e;return(e=this.cache.get(t))==null?void 0:e.data}load(t){let e=Date.now(),n=this.cache.get(t);return n===void 0?(n={data:this.create(t),src:t,time:e,next:null,prev:null},this.cache.set(t,n)):(n.time=e,n.prev.next=n.next,n.next.prev=n.prev),n.prev=this.tail.prev,n.next=this.tail,this.tail.prev.next=n,this.tail.prev=n,this.scheduleCleanup(),n.data}},lOe=class extends aOe{create(t){return URL.createObjectURL(new Blob([t]))}dispose(t,e){URL.revokeObjectURL(e)}},Q2;function cOe(t){return typeof t=="string"?t:(Q2||(Q2=new lOe),Q2.load(t))}var uOe=class{constructor(t,e){this.data=t,this.cache=e,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},hOe=class{constructor(){this.cache=new Map}remove(t){this.cache.delete(t.data)}load(t){let e=this.cache.get(t);return e===void 0&&(e=this.create(t),this.cache.set(t,e)),e.refCount+=1,e}},HZ=class extends uOe{constructor(t,e){super(t,e.imageHolderCache),this.data=t,this.shared=e,this.loaded=!1,this.isVideo=!1,this.isVideo=t.type=="video",this.updateSrc(t.data)}async updateSrc(t){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let e=()=>{this.loaded=!0;let i=[1e3,1001,1002];for(let r of i){let s=this[r];s&&(s.image=this.img,s.needsUpdate=!0)}this.shared.requestRender()};if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof t!="string"){var n=new FileReader;n.readAsDataURL(new Blob([t],{type:"video/mp4"}));let i;await new Promise(r=>{n.onloadend=s=>{var o;i=(o=s.target)==null?void 0:o.result,r(null)}}),this.img.src=i}else this.img.src=t;this.img.onloadeddata=()=>{e()}}else this.img=new Image,this.img.src=cOe(t),this.img.onload=e}getTexture(t){let e=this[t];if(e)return e;{let n;return this.isVideo?n=new iAe(this.img,void 0,t,t):n=new br(this.img,void 0,t,t),this.loaded&&(n.needsUpdate=!0),this[t]=n,n}}disposeTextures(){var t,e,n;(t=this[1e3])==null||t.dispose(),this[1e3]=void 0,(e=this[1001])==null||e.dispose(),this[1001]=void 0,(n=this[1002])==null||n.dispose(),this[1002]=void 0}dispose(){super.dispose(),this.disposeTextures()}},lf=class extends HZ{},NF=class extends Eo{},VZ={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],depth:["smooth","isWorldSpace","gradientType","isVector"]},jZ={depth:["colors"]};function dOe(t,e,n){var s,o;let i=VZ[t.type],r=jZ[t.type];if(r!==void 0){let a=t.color;if(r.includes(e)){let l=(o=(s=a[e])==null?void 0:s.value)==null?void 0:o.length;if(l!==void 0&&l!==n.length)return!0}}return i!==void 0?i.includes(e):!1}function WZ(t,e,n){let i=n.uniforms[`f${n.id}_texture`];if(!i)return!1;let r=!1,s=t;if("image"in s){let o=s.image,a=e.image(o),l=i;l.image instanceof lf||l.image.deref(),l.image=a}if("video"in s){let o=s.video,a=e.video(o),l=i;l.image instanceof lf||l.image.deref(),l.image=a}if("wrapping"in s){let o=i;o.wrap=s.wrapping}if("repeat"in s||"offset"in s){let o="mat",a=n.uniforms[`f${n.id}_${o}`];"repeat"in s&&(a.repeat=s.repeat),"offset"in s&&(a.offset=s.offset),a.updateMatrix()}return r}function fOe(t,e,n,i){let r=!1;for(let[s,o]of Object.entries(t)){if(!s||o===void 0)continue;if(JZ(s,n,i)){s==="visible"&&n.type==="light"&&(r=!0);continue}n.visible=i.visible;let a=n.uniforms[`f${n.id}_${s}`];if(a&&!(a instanceof NF))switch(r=r||dOe(n,s,o),a.constructor){case bi:if(typeof o=="string"){let l=e.getColor(o);l&&(a.value=l);break}else{let l=o;a.value instanceof gM?a.value=new zs(l.r,l.g,l.b,l.a):a.setRGBA(l);break}case Kd:if(typeof o=="string"){let l=e.getColor(o);l&&(a.value=l);break}else{let l=o;a.value instanceof gM?a.value=new zs(l.r,l.g,l.b,l.a):a.value.setRGBA(l.r,l.g,l.b,l.a);break}case Jo:{let l=o;a.value.setX(l[0]),a.value.setY(l[1]);break}case Xo:{let l=o;a.value.setX(l[0]),a.value.setY(l[1]),a.value.setZ(l[2]);break}case wh:{WZ(o,e,n);break}case jd:{a.value=o.map(l=>new Zt(...l));break}default:{a.value=o;break}}}return r}var XZ=class extends Hn{constructor(t,e,n){super("v3"),this.nodeType="Matcap",this.texture=t,this.alpha=e,this.mode=n,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.addFragmentVariable(this.calpha,"float");let n=t.include(XZ.Nodes.matcap);t.require("normal"),t.requires.normal=!0;let i=[];return i.push(this.texture.generate(t,"t")),i.push("normal"),i.push(this.alpha.build(t,"f")),i.push(this.mode.build(t,"i")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("MatcapNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},YZ=XZ;YZ.Nodes=function(){return{matcap:new _t(`vec3 matcap(sampler2D matcapTex, vec3 normal, float alpha, int mode, out float calpha) {
                vec3 viewDir = normalize( vViewPosition );
                vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
                vec3 y = cross( viewDir, x );
                vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks
                vec4 matcapColor = texture2D( matcapTex, uv );

                calpha =  alpha / clamp( alpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;
                
                return matcapColor.rgb;
            }
            `)}}();var zI=class extends NF{constructor(t,e){super("t"),this.image=t,this.wrap=e}get value(){return this.image.getTexture(this.wrap)}},pOe=class extends NF{constructor(t){super("v3"),this.image=t,this._value=new N}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},qZ=class extends Hn{constructor(t,e,n,i,r,s,o,a,l,c){super("v3"),this.nodeType="Toon",this.positioning=t,this.colors=e,this.steps=n,this.source=i,this.isWorldSpace=r,this.noiseStrength=s,this.noiseScale=o,this.shadowColor=a,this.offset=l,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("worldNormal"),t.require("worldPosition"),t.isShader("fragment")){t.define("COLORS_MAX",10),t.addFragmentVariable(this.calpha,"float");let n=t.include(qZ.Nodes.toon),i=[];return i.push(this.positioning.build(t,"i")),i.push(this.colors.build(t,"v4[]")),i.push(this.steps.build(t,"f[]")),i.push(this.source.build(t,"v3")),i.push(this.isWorldSpace.build(t,"b")),i.push(this.noiseStrength.build(t,"f")),i.push(this.noiseScale.build(t,"f")),i.push(this.shadowColor.build(t,"v4")),i.push(this.offset.build(t,"v3")),i.push(this.alpha.build(t,"f")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("ToonNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},QZ=qZ;QZ.Nodes=function(){let t=new _t(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),e=new _t(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),n=new _t(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[e]),i=new _t(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),r=new _t(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[i]);return{toon:new _t(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplex3d(st),
					// 	simplex3d(st + vec3(111.1, 143.89, 217.19)),
					// 	simplex3d(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[ia.simplex,t,n,r])}}();function m6(t,e,n){t.setUvTransform(n[0],n[1],e[0],e[1],0,0,0)}var mOe=class extends AZ{constructor(t,e){super(new Rr),this.repeat=t,this.offset=e,m6(this.value,t,e)}updateMatrix(){m6(this.value,this.repeat,this.offset)}},Mf=class{constructor(t,e,n,i){this.id=t,this.uuid=e,this.data=n,this.uniforms={};for(let r in i)this.uniforms[`f${this.id}_${r}`]=i[r];for(let r in n)JZ(r,this,n)}get type(){return this.data.type}static create(t,e,n,i){if(n.type==="light")return Jm.createLigherLayer(t,e,n,i);if(n.type==="texture"||n.type==="video"){let r=n.type==="texture"?i.image(n.texture.image):i.video(n.texture.video),s=new zI(r,n.texture.wrapping),o=new pOe(r),a=new mOe(n.texture.repeat,n.texture.offset),l=new gt(n.crop?1:0),c=new On(n.projection??0),h=new On(["x","y","z"].indexOf(n.axis)??0),u=new On(n.side??0),d=new Jo(n.size?new be(n.size[0],n.size[1]):new be(100,100)),f=new gt(n.alpha??1),p=new On(n.mode??0),v=new kZ(s,o,l,c,h,u,d,a,f,p),g=new Qn(v.calpha,"f");return new Tr(t,e,n,{texture:s,textureSize:o,crop:l,projection:c,axis:h,side:u,size:d,mat:a,alpha:f,mode:p},v,p,g)}else if(n.type==="matcap"){let r=i.image(n.texture.image),s=new zI(r,n.texture.wrapping),o=new gt(n.alpha??1),a=new On(n.mode??0),l=new YZ(s,o,a),c=new Qn(l.calpha,"f");return new Tr(t,e,n,{texture:s,alpha:o,mode:a},l,a,c)}else if(n.type==="displace")if(n.displacementType==="noise"){let r=new Xo(new N(...n.offset)),s=new gt(n.scale??10),o=new gt(n.intensity??8),a=new gt(n.movement??1),l=new On(n.noiseType??0),c=new FZ(o,a,r,s,l);return new KZ(t,e,n,{offset:r,scale:s,intensity:o,movement:a,noiseType:l},c)}else throw new Error;else return yOe(t,e,n,i)}updateByOp(t,e,n){var r;let i=t;if(i.path[0]===void 0){if(i.type===0)return"type"in i.props||"category"in i.props||"visible"in i.props?((r=n.scene)==null||r.markNeedsUpdateRendererDirty(),!0):fOe(i.props,n.shared,this,e)}else if(i.path[0]==="texture")return"texture"in e||"video"in e?WZ(i.props,n.shared,this):!0;return!1}dispose(){if(gOe(this)){let t=this.uniforms[`f${this.id}_texture`];if(!t)return!1;let e=t;e.image instanceof lf||e.image.deref()}}hasValueByKey(t){return this.uniforms[t]!==void 0}hasValue(t){return this.hasValueByKey(`f${this.id}_${t}`)}setValue(t,e){let n=`f${this.id}_${t}`;this.hasValueByKey(n)&&e!==void 0&&(this.uniforms[n].value=e)}getNode(t){let e=`f${this.id}_${t}`;if(this.hasValueByKey(e))return this.uniforms[e]}getValue(t){let e=`f${this.id}_${t}`;if(this.hasValueByKey(e))return this.uniforms[e].value}getName(t){let e=/f\d+_(.*)/.exec(t);if(e&&e.length>1)return e[1];console.log(`Layer.getName: error ${t}`)}getNames(){let t=[];for(let e in this.uniforms){let n=this.getName(e);n&&t.push(n)}return t}},Tr=class extends Mf{constructor(t,e,n,i,r,s,o){super(t,e,n,i),this.params=i,this.color=r,this.mode=s,this.alpha=o}},KZ=class extends Mf{constructor(t,e,n,i,r){super(t,e,n,i),this.position=r}},Jm=class extends Mf{constructor(t,e,n,i,r){super(t,e,n,r),this.node=i}static createLigherLayer(t,e,n,i){let r,s=new gt(n.alpha),o=new On(n.mode),a;if(!n.visible)r=new SZ,a={};else if(n.category==="lambert"){r=new WBe;let l=new bi(i.color(n.emissive)??0);a={emissive:l},r.emissive=l}else if(n.category==="toon"){r=new qBe;let l=new gt(n.shininess??30),c=new bi(i.color(n.specular)??1118481);a={shininess:l,specular:c},r.shininess=l,r.specular=c}else if(n.category==="physical"){r=new YBe;let l=new gt(n.roughness??.3),c=new gt(n.metalness??0),h=new gt(n.reflectivity??.5);a={roughness:l,metalness:c,reflectivity:h},r.roughness=l,r.metalness=c,r.reflectivity=h}else{r=new XBe;let l=new gt(n.shininess??30),c=new bi(n.specular!==void 0?i.color(n.specular)??1118481:1118481);a={shininess:l,specular:c},r.shininess=l,r.specular=c}return r.alpha=new gt(1),r.shadingAlpha=s,r.shadingBlend=o,a.alpha=r.shadingAlpha,a.mode=r.shadingBlend,new Jm(t,e,n,r,a)}get category(){return this.node.category}};function gOe(t){let e=t instanceof Mf?t.type:t;return e==="texture"||e==="video"||e==="displace_map"||e==="matcap"}function vOe(t,e,n,i){switch(t.type){case"color":{let r=new bi(i.color??5526619),s=new gt(i.alpha??1),o=new Qn("alpha / clamp(alpha + accumAlpha, 0.00001, 1.0 )","f");o.keywords.alpha=s;let a=new On(i.mode??0);return r.alpha=s,new Tr(e,n,t,{color:r,alpha:s,mode:a},r,a,o)}case"fresnel":{let r=new bi(i.color??16777215),s=new gt(i.bias??.1),o=new gt(i.scale??1),a=new gt(i.intensity??2),l=new gt(i.factor??1),c=new gt(i.alpha??1),h=new On(i.mode??0),u=new CZ(r,s,o,a,l,c,h),d=new Qn(u.calpha,"f");return new Tr(e,n,t,{color:r,bias:s,scale:o,intensity:a,factor:l,alpha:c,mode:h},u,h,d)}case"rainbow":{let r=new gt(i.filmThickness??30),s=new gt(i.movement??0),o=new Xo(i.wavelengths??new N(0,0,0)),a=new gt(i.noiseStrength??0),l=new gt(i.noiseScale??1),c=new Xo(i.offset??new N(0,0,0)),h=new gt(i.alpha??1),u=new PZ(r,s,o,a,l,c,h),d=new Qn(u.calpha,"f"),f=new On(i.mode??0);return new Tr(e,n,t,{filmThickness:r,movement:s,wavelengths:o,noiseStrength:a,noiseScale:l,offset:c,alpha:h,mode:f},u,f,d)}case"transmission":{let r=new gt(i.thickness??10),s=new gt(i.ior??1.5),o=new gt(i.roughness??.5),a=ti.transmissionSize,l=ti.transmissionRenderTarget,c=ti.transmissionRenderTargetDepth,h=window.innerWidth,u=window.innerHeight,d=h>=u?new Jo(u/h,1):new Jo(1,h/u),f=new gt(i.alpha??1),p=new IZ(r,s,o,a,l,c,d,f),v=new Qn(p.calpha,"f"),g=new On(i.mode??0);return new Tr(e,n,t,{thickness:r,ior:s,roughness:o,aspectRatio:d,alpha:f,mode:g},p,g,v)}case"toon":{let r=new On(i.positioning??0),s;i.colors?s=new jd(i.colors.length,i.colors):(s=new jd(10,new Zt(0,0,0,1)),s.value[1]=new Zt(1,1,1,1));let o;i.steps?o=new Vd(i.steps.length,i.steps):(o=new Vd(10,1),o.value[0]=0);let a=new Xo(i.source??new N(0,0,0)),l=new H0(i.isWorldSpace??!0),c=new gt(i.noiseStrength??0),h=new gt(i.noiseScale??1),u=new Kd(i.shadowColor),d=new Xo(i.offset??new N(0,0,0)),f=new gt(i.alpha??1),p=new QZ(r,s,o,a,l,c,h,u,d,f),v=new Qn(p.calpha,"f"),g=new On(i.mode??0);return new Tr(e,n,t,{positioning:r,colors:s,steps:o,source:a,isWorldSpace:l,noiseStrength:c,noiseScale:h,shadowColor:u,offset:d,alpha:f,mode:g},p,g,v)}case"outline":{let r=new bi(i.outlineColor??16777215),s=new bi(i.contourColor??16777215),o=new gt(i.outlineWidth??.1),a=new gt(i.contourWidth??.1),l=new gt(i.outlineThreshold??.1),c=new gt(i.contourThreshold??.1),h=new gt(i.outlineSmoothing??.1),u=new gt(i.contourFrequency??.1),d=new Xo(i.contourDirection??new N(0,1,0)),f=new H0(i.positionalLines??!1),p=new H0(i.compensation??!0),v=ti.normalRenderTarget,g=ti.normalRenderTargetDepth,m=ti.pixelRatioNode,y=ti.resolution,w=new gt(i.alpha??1),b=new RZ(r,s,o,a,l,c,h,u,d,f,p,y,v,g,m,w),A=new Qn(b.calpha,"f"),S=new On(i.mode??0);return new Tr(e,n,t,{outlineColor:r,contourColor:s,outlineWidth:o,contourWidth:a,outlineThreshold:l,contourThreshold:c,outlineSmoothing:h,contourFrequency:u,contourDirection:d,positionalLines:f,compensation:p,alpha:w,mode:S},b,S,A)}case"depth":{let r=new On(i.gradientType??0),s=new H0(i.smooth??!1),o=new gt(i.near??50),a=new gt(i.far??200),l=new gt(i.isVector??1),c=new gt(i.isWorldSpace??0),h=new Xo(i.origin??new N),u=new Xo(i.direction??new N),d;i.colors?d=new jd(i.colors.length,i.colors):(d=new jd(2,new Zt(0,0,0,1)),d.value[1]=new Zt(1,1,1,1));let f;i.steps?f=new Vd(i.steps.length,i.steps):(f=new Vd(2,1),f.value[0]=0);let p=new gt(i.alpha??1),v=new On(i.mode??0),g=new BZ(r,s,o,a,l,c,h,u,d,f,p),m=new Qn(g.calpha,"f");return new Tr(e,n,t,{gradientType:r,smooth:s,near:o,far:a,isVector:l,isWorldSpace:c,origin:h,direction:u,colors:d,steps:f,alpha:p,mode:v},g,v,m)}case"noise":{let r=new gt(i.scale??1),s=new Xo(i.size??new N(100,100,100)),o=new gt(i.move??1),a=new Jo(i.fA??new be(1.7,9.2)),l=new Jo(i.fB??new be(8.3,2.8)),c=new Jo(i.distortion??new be(1,1)),h=new Kd(i.colorA),u=new Kd(i.colorB),d=new Kd(i.colorC),f=new Kd(i.colorD),p=new gt(i.alpha??1),v=new On(i.mode??0),g=new On(i.noiseType??0),m=new MZ(r,s,o,a,l,c,h,u,d,f,p,g),y=new Qn(m.calpha,"f");return new Tr(e,n,t,{scale:r,size:s,move:o,fA:a,fB:l,distortion:c,colorA:h,colorB:u,colorC:d,colorD:f,alpha:p,mode:v,noiseType:g},m,v,y)}case"normal":{let r=new Xo(i.cnormal??new N(1,1,1)),s=new gt(i.alpha??1),o=new On(i.mode??0),a=new GZ(r,s),l=new Qn("alpha / clamp(alpha + accumAlpha, 0.00001, 1.0 )","f");return l.keywords.alpha=s,new Tr(e,n,t,{cnormal:r,alpha:s,mode:o},a,o,l)}case"gradient":{let r=new On(i.gradientType??0),s=new H0(i.smooth??!1),o;i.colors?o=new jd(i.colors.length,i.colors):(o=new jd(10,new Zt(0,0,0,1)),o.value[1]=new Zt(1,1,1,1));let a;i.steps?a=new Vd(i.steps.length,i.steps):(a=new Vd(10,1),a.value[0]=0);let l=new Jo(i.offset??new be(0,0)),c=new Jo(i.morph??new be(0,0)),h=new gt(i.angle??0),u=new gt(i.alpha??1),d=new On(i.mode??0),f=new UZ(r,s,o,a,l,c,h,u),p=new Qn(f.calpha,"f");return new Tr(e,n,t,{gradientType:r,smooth:s,colors:o,steps:a,offset:l,morph:c,angle:h,alpha:u,mode:d},f,d,p)}default:{let r=new bi(1,0,0,1),s=new gt(1),o=new Qn("alpha / clamp(alpha + accumAlpha, 0.00001, 1.0 )","f");o.keywords.alpha=s;let a=new On(0);return r.alpha=s,new Tr(e,n,t,{color:r,alpha:s,mode:a},r,a,o)}}}function yOe(t,e,n,i){let r=QBe(n,i);return vOe(n,t,e,r)}function JZ(t,e,n){if(n.type==="displace"&&(t==="intensity"||t==="visible")){let i=e.uniforms[`f${e.id}_intensity`];return i?(i.value=n.intensity*(n.visible?1:0),i):void 0}if(n.type!=="displace"&&(t==="alpha"||t==="visible")){let i=e.uniforms[`f${e.id}_alpha`];if(!i)return;if(i.value=n.alpha*(n.visible?1:0),n.type==="outline"&&t==="visible"){let r=e.uniforms[`f${e.id}_compensation`];r&&(r.value=n.compensation&&n.visible)}return i}}function vM(t,e){let n=0;for(let i of t.layers)if(i.data.type!=="displace"&&"alpha"in i.data&&i.data.type!=="light"&&i.data.type!=="fresnel"&&i.data.type!=="texture"&&i.data.type!=="matcap"&&i.data.type!=="rainbow"&&i.data.type!=="outline"){let r=i.data.visible?i.data.alpha:0;if(r===1&&i.data.type==="depth"||i.data.type==="gradient"){for(let s of i.data.colors)if(s[3]<1){r=s[3];break}}else if(r===1&&i.data.type==="noise"){let s=e.color(i.data.colorA).a,o=e.color(i.data.colorB).a,a=e.color(i.data.colorC).a,l=e.color(i.data.colorD).a,c=Math.min(s,Math.min(o,Math.min(a,l)));c<1&&(r=c)}n+=(1-n)*r}return n<1}var Kh=class extends ir{constructor(){super(void 0),this.flatShading=!1,this.cacheKey="",this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return this.cacheKey}},xOe=class extends Kh{constructor(t,e,n,i){super(),this.flatShading=t,this.side=e,this.wireframe=n,this.root=i}updateAfterBuild(){let t=this.root;this.lights=t.lights,this.vertexShader=t.vertexShader,this.fragmentShader=t.fragmentShader,this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.transparent=t.transparent,this.cacheKey=t.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(t,e){this.root.onBeforeCompile(t)}get data(){return this.root.data}get category(){return this.root.category}getFlavor(t,e,n){return this.root.getFlavor(t,e,n)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(t){return this.root.getLayersOfType(t)}getLayerByUuid(t){return this.root.getLayerByUuid(t)}updateByOp(t,e,n){this.root.updateByOp(t,e,n)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},ZZ=class extends Kh{constructor(t,e){super(),this.data=t,this.layerIdGen=0,this.flavors=[],this.type="NodeMaterial",this.updaters=[],this.reset0(t,e)}get nodeMaterial(){return this}getFlavor(t,e,n){let i=n?6:(t?3:0)+e;if(i===0)return this;this.flavors===void 0&&(this.flavors=[]),i-=1;let r=this.flavors[i];return r===void 0&&(r=new xOe(t,e,n,this),this.flavors[i]=r,r.flatShading=t,r.side=e,r.updateAfterBuild()),r}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}reset(t,e){this.data!==t&&this.reset0(t,e)}reset0(t,e){this.data=t;let n=t.layers??wo.defaultTwoLayerData("phong").layers;this.layers=n.map(i=>Mf.create(this.layerIdGen++,i.id,i.data,e.shared)),this.layers.reverse(),this.name=t.name??"Untitled Material",this.onUpdate(),this.transparent=vM(t,e.shared)}getLayersOfType(t){return this.layers.filter(e=>e.type===t)}getLayerByUuid(t){return this.layers.find(e=>e.uuid===t)}onUpdate(){this.cacheKey=this.computeCacheKey(),this.lightLayer=this.layers.find(t=>t instanceof Jm),this.lightLayer===void 0&&(this.lightLayer=new Jm(0,"",{...ea.defaultData("light","phong"),visible:!1},new SZ,{})),this.dispose();for(let t of this.flavors)t&&t.dispose();this.blendColors(),this.blendAfterColors(),this.blendPositions()}updateByOp(t,e,n){var i,r,s;if(e!==void 0?this.data=e:e=this.data,this.transparent=vM(e,n.shared),t.path[0]==="layers"){this.data=e;let o=n.shared,a=t.path[1];if(a===void 0){if(this.layers.reverse(),t.type===4){let l=Mf.create(this.layerIdGen++,t.id,t.data,n.shared);this.layers.splice(t.localIndex,0,l),(i=n.scene)==null||i.markNeedsUpdateRendererDirty()}else if(t.type===5)this.layers.splice(t.localIndex,1)[0].dispose(),(r=n.scene)==null||r.markNeedsUpdateRendererDirty();else if(t.type===6){let l=this.layers.findIndex(h=>h.uuid===t.id),c=this.layers[l];this.layers.splice(l,1),this.layers.splice(t.localIndex,0,c),(s=n.scene)==null||s.markNeedsUpdateRendererDirty()}this.layers.reverse(),this.onUpdate()}else{let l=this.layers.find(c=>c.uuid===a);if(l){let c=e.layers.data(a);if(l.updateByOp({...t,path:t.path.slice(2)},c,n)){let h=Mf.create(this.layerIdGen++,a,c,o);this.layers.splice(this.layers.findIndex(u=>u.uuid===a),1,h),this.onUpdate()}}}}else this.reset(e,n)}blendColors(){let t=this.layers.findIndex(n=>n instanceof Tr),e=this.layers.findIndex(n=>n instanceof Jm);if(t!==-1&&t<e){let n=this.layers[t].color;for(let i=t+1;i<e;++i){let r=this.layers[i];r instanceof Tr&&(n=new p6(n,r.color,r.alpha,r.mode))}this.fragment.color=n}else this.fragment.color=void 0}blendAfterColors(){let t=new Qn("outgoingLight","f"),e=this.layers.findIndex(n=>n instanceof Jm);if(this.layers.length>e+1){for(let n=e+1;n<this.layers.length;++n){let i=this.layers[n];i instanceof Tr&&(t=new p6(t,i.color,i.alpha,i.mode))}this.fragment.afterColor=t}else this.fragment.afterColor=void 0}blendPositions(){let t=this.layers.filter(e=>e instanceof KZ);if(t.length>0){let e=t[0].position;for(let n=1;n<t.length;++n)t[n]&&(e=new Hl(e,t[n].position,Hl.ADD),e=new Hl(e,new gt(.5).setReadonly(!0),Hl.MUL));this.fragment.position=e}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(t){this.build(),t.defines=this.defines,t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.extensionDerivatives=this.extensions.derivatives===!0,t.extensionFragDepth=this.extensions.fragDepth===!0,t.extensionDrawBuffers=this.extensions.drawBuffers===!0,t.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(t,e){let n=(i,r,s)=>Math.min(Math.max(i,r),s);for(let i of this.layers)if(i.type==="displace"){let r=n(i.uniforms[`f${i.id}_intensity`].value,t,e);i.uniforms[`f${i.id}_intensity`].value=r}}computeCacheKey(){let t="[";for(let{data:e}of this.data.layers)if(e.type==="light")t+=`"${e.visible?e.category.toUpperCase():"Basic"}"`;else{let n=(VZ[e.type]??[]).map(s=>e[s]),i=(jZ[e.type]??[]).map(s=>{var o;return((o=e[s])==null?void 0:o.length)??0}),r=[...n,...i];r.length?t+=`["${e.type}", "${r.join('","')}"],`:t+=`"${e.type}",`}return t=t.slice(0,-1)+"]",t}updateFrame(t){for(let e=0;e<this.updaters.length;++e)t.updateNode(this.updaters[e])}build(){let t=new jBe;this.lights=this.lightLayer.data.visible,t.build(this.fragment,this.fragment),this.vertexShader=t.getCode("vertex"),this.fragmentShader=t.getCode("fragment"),this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.updaters=t.updaters;for(let e of this.flavors)e&&e.updateAfterBuild();return this}nodeMaterialDispose(){this.layers.forEach(t=>t.dispose()),super.dispose();for(let t of this.flavors)t&&t.dispose()}assetsLoaded(){for(let t of this.layers)if(t instanceof Tr){let e=t.params.texture;if(e instanceof zI&&!e.image.loaded)return!1}return!0}getHash(){let t="{";return t+='"fragment":'+this.fragment.getHash(),t+="}",t}};Object.defineProperties(Kh.prototype,{properties:{get:function(){return this.fragment.properties}}});var GI=class extends ZZ{},wOe=B1(qye()),g6=new Map;function _Oe(t){if(typeof t=="string")return t;let e=g6.get(t);return e||(e={url:URL.createObjectURL(new Blob([t]))},g6.set(t,e)),e.url}var fy=class{constructor({src:t,volume:e,delay:n,loop:i}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let r;typeof t=="string"?r={src:t}:r={src:_Oe(t),format:"wav"},this.sound=new wOe.Howl(r),this.sound.on("end",this.onEnd),this.src=t,e!==void 0&&(this.volume=e),n!==void 0&&(this.delay=n),i!==void 0&&(this.loop=i)}get status(){return this._status}get volume(){return this._volume}set volume(t){this._volume=t,this.sound.volume(t)}get loop(){return this._loop}set loop(t){this._loop=t,this.loopsRemaining=t}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(t,e=1e3){t?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,e),this.clearFade()},t)):this.sound.fade(this._volume,0,e)}on(t,e,n){this.sound.on(t,e,n)}off(t,e,n){this.sound.off(t,e,n)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(t=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},bOe=class{constructor(){this.type="ShapePath",this.color=new Rt,this.subPaths=[],this.currentPath=null}moveTo(t,e){return this.currentPath=new NA,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this}lineTo(t,e){var n;return(n=this.currentPath)==null||n.lineTo(t,e),this}quadraticCurveTo(t,e,n,i){var r;return(r=this.currentPath)==null||r.quadraticCurveTo(t,e,n,i),this}bezierCurveTo(t,e,n,i,r,s){var o;return(o=this.currentPath)==null||o.bezierCurveTo(t,e,n,i,r,s),this}splineThru(t){var e;return(e=this.currentPath)==null||e.splineThru(t),this}toShapes(){let t={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},e={loc:t.ORIGIN,t:0};function n(f,p,v,g){let m=f.x,y=p.x,w=v.x,b=g.x,A=f.y,S=p.y,T=v.y,M=g.y,E=(b-w)*(A-T)-(M-T)*(m-w),P=(y-m)*(A-T)-(S-A)*(m-w),R=(M-T)*(y-m)-(b-w)*(S-A),F=E/R,B=P/R;if(R===0&&E!==0||F<=0||F>=1||B<0||B>1)return null;if(E===0&&R===0){for(let k=0;k<2;k++)if(i(k===0?v:g,f,p),e.loc===t.ORIGIN){let j=k===0?v:g;return{x:j.x,y:j.y,t:e.t}}else if(e.loc===t.BETWEEN){let j=+(m+e.t*(y-m)).toPrecision(10),Z=+(A+e.t*(S-A)).toPrecision(10);return{x:j,y:Z,t:e.t}}return null}else{for(let Z=0;Z<2;Z++)if(i(Z===0?v:g,f,p),e.loc===t.ORIGIN){let ee=Z===0?v:g;return{x:ee.x,y:ee.y,t:e.t}}let k=+(m+F*(y-m)).toPrecision(10),j=+(A+F*(S-A)).toPrecision(10);return{x:k,y:j,t:F}}}function i(f,p,v){let g=v.x-p.x,m=v.y-p.y,y=f.x-p.x,w=f.y-p.y,b=g*w-y*m;if(f.x===p.x&&f.y===p.y){e.loc=t.ORIGIN,e.t=0;return}if(f.x===v.x&&f.y===v.y){e.loc=t.DESTINATION,e.t=1;return}if(b<-Number.EPSILON){e.loc=t.LEFT;return}if(b>Number.EPSILON){e.loc=t.RIGHT;return}if(g*y<0||m*w<0){e.loc=t.BEHIND;return}if(Math.sqrt(g*g+m*m)<Math.sqrt(y*y+w*w)){e.loc=t.BEYOND;return}let A;g!==0?A=y/g:A=w/m,e.loc=t.BETWEEN,e.t=A}function r(f,p){let v=[],g=[];for(let m=1;m<f.length;m++){let y=f[m-1],w=f[m];for(let b=1;b<p.length;b++){let A=p[b-1],S=p[b],T=n(y,w,A,S);T!==null&&v.find(M=>M.t<=T.t+Number.EPSILON&&M.t>=T.t-Number.EPSILON)===void 0&&(v.push(T),g.push(new be(T.x,T.y)))}}return g}function s(f,p,v){let g=new be;p.getCenter(g);let m=[];return v.forEach(y=>{y.boundingBox.containsPoint(g)&&r(f,y.points).forEach(w=>{m.push({identifier:y.identifier,isCW:y.isCW,point:w})})}),m.sort((y,w)=>y.point.x-w.point.x),m}function o(f,p,v,g,m){(m==null||m==="")&&(m="nonzero");let y=new be;f.boundingBox.getCenter(y);let w=[new be(v,y.y),new be(g,y.y)],b=s(w,f.boundingBox,p);b.sort((P,R)=>P.point.x-R.point.x);let A=[],S=[];b.forEach(P=>{P.identifier===f.identifier?A.push(P):S.push(P)});let T=A[0].point.x,M=[],E=0;for(;E<S.length&&S[E].point.x<T;)M.length>0&&M[M.length-1]===S[E].identifier?M.pop():M.push(S[E].identifier),E++;if(M.push(f.identifier),m==="evenodd"){let P=M.length%2===0,R=M[M.length-2];return{identifier:f.identifier,isHole:P,for:R}}else if(m==="nonzero"){let P=!0,R=null,F=null;for(let B=0;B<M.length;B++){let k=M[B];p[k]&&(P?(F=p[k].isCW,P=!1,R=k):F!==p[k].isCW&&(F=p[k].isCW,P=!0))}return{identifier:f.identifier,isHole:P,for:R}}else console.warn('fill-rule: "'+m+'" is currently not implemented.')}let a=0,l=999999999,c=-999999999,h=[];this.subPaths.forEach(f=>{let p=f.getPoints(),v=-999999999,g=999999999,m=-999999999,y=999999999;for(let w=0;w<p.length;w++){let b=p[w];b.y>v&&(v=b.y),b.y<g&&(g=b.y),b.x>m&&(m=b.x),b.x<y&&(y=b.x)}c<=m&&(c=m+1),l>=y&&(l=y-1),p.length&&h.push({curves:f.curves,points:p,isCW:vK.isClockWise(p),identifier:a++,boundingBox:new jAe(new be(y,g),new be(m,v))})});let u=h.map(f=>{var p;return o(f,h,l,c,(p=this.userData)==null?void 0:p.style.fillRule)}),d=[];return h.forEach(f=>{let p=u[f.identifier];if(p&&!p.isHole){let v=new UA;v.curves=f.curves,u.filter(g=>(g==null?void 0:g.isHole)&&g.for===f.identifier).forEach(g=>{if(g){let m=h[g.identifier],y=new NA;y.curves=m.curves,v.holes.push(y)}}),d.push(v)}}),d}},$Z,v6=new Promise(t=>{$Z=t}),y6=!1;async function SOe(){if(y6)return;let t=await yE(()=>import("./opentype-fc28cde9.js"),[]);$Z(t),y6=!0}var AOe=class{async load(t,e,n=()=>{}){let{load:i}=await v6;i(t,(r,s)=>{r||!s?n(r??"Something went wrong"):e(s)})}async parse(t){let{parse:e,Bidi:n}=await v6;try{let i=e(t),r=new n,s=o=>i.charToGlyphIndex(o.char);return r.registerModifier("glyphIndex",null,s),r.applyFeatures(i,i.defaultRenderOptions.features),{font:i,bidi:r}}catch(i){console.error(i)}}};async function MOe(t){return await(await fetch(t)).arrayBuffer()}var EOe=new AOe;async function x6(t){let e,n,i=!1;if(t.url?(e=await MOe(t.url),n=t.url,i=t.url.startsWith("/")):t.data&&(e=t.data.buffer),e){let r=await EOe.parse(e);if(r)return{font:r.font,url:n,intercepted:i,arr:e,bidi:r.bidi}}}function COe(t,e){return e.state.glyphIndex===t||e.state.fina===t||e.state.medi===t||e.state.init===t}var TOe=class{constructor(t){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=t.isUserFont??!1,this._loadingPromise=x6(t).then(e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)})}update(t){this._isLoaded=!1,this._isUserFont=t.isUserFont??!1,this._loadingPromise=x6(t).then(e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(t,e,n){if(!this._bidi)return[];let i=this._bidi;i.getTextGlyphs(e);let r=i.tokenizer.tokens,s=[],o=0,a=n.length===r.length;for(let l=0;l<n.length;l++){let c=n[l].index,h=String.fromCharCode(n[l].unicode),u=r[o];if(COe(c,u)||a)s.push({char:h,index:c,replacements:[u.state.glyphIndex],replacementChars:[u.char]}),o++;else{let d=u.char,f="",p=[u.state.glyphIndex],v=[],g=!1;for(;!g;)o++,f=e.charAt(o),d+=f,p.push(t.charToGlyphIndex(f)),v=t.stringToGlyphs(d),v.length===1&&v[0].index===c&&(g=!0),o>e.length&&(g=!0);s.push({char:h,index:c,replacements:p,replacementChars:Array.from(d)}),o++}}return s}generateShapes(t,e){if(!this._isLoaded)return;let n=this.font,i=e.fontSize/this.unitsPerEm,r=e.fontSize*e.lineHeight,s=t.map(m=>this.getTextWidth(m,e)),o=e.width,a=this.getCharWidth(`
`,e),l=e.horizontalAlign===1?a:0,c=this.computeSpaceWidthForLine(t,0,e),h=this.getLineInitialOffsetX(s[0],o,e.horizontalAlign,t[0],a),u=this.getLineInitialOffsetY(r,t.length,e.height,i,e.verticalAlign),d=[],f=t.map(m=>[]),p=t.map(m=>[]),v;for(let m=0;m<t.length;m++){let y=t[m],w={features:{liga:!0}},b=[];try{b=n.stringToGlyphs(y,w)}catch(S){console.warn(S)}h=this.getLineInitialOffsetX(s[m],o,e.horizontalAlign,y,a);let A=[];try{A=this.reverseLigaturesTable(n,y,b)}catch(S){console.warn(S)}c=this.computeSpaceWidthForLine(t,m,e);for(let S=0;S<b.length;S++){let T=b[S],M=T.index===0?`
`:T.unicode?String.fromCharCode(T.unicode):void 0,E=A[S],P=0,R=0;S===0&&e.horizontalAlign===2&&T.leftSideBearing!==void 0&&(R=-T.leftSideBearing*i),v&&(P=n.getKerningValue(T,v)*i),h+=R+P;let F=0;if(M===`
`)F=l;else if(M===" ")F=c;else{let B=this.createPath(T,i,h,u,e);B&&(F=B.offsetX-(P+R),d.push(B.path))}if(E.replacements.length===1)p[m].push([h,u]),f[m].push(F);else{let B=E.replacements.map(ee=>(n.glyphs.get(ee).advanceWidth??0)*i),k=B.reduce((ee,O)=>ee+=O,0),j=B.map(ee=>ee/k),Z=h;for(let ee=0;ee<j.length;ee++){let O=F*j[ee];p[m].push([Z,u]),f[m].push(O),Z+=O}}h+=F,v=T}u-=r}let g=[];for(let m=0,y=d.length;m<y;m++)g.push(...d[m].toShapes());return{shapes:g,charWidths:f,lineWidths:s,charCoords:p}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var t;return((t=this.font)==null?void 0:t.ascender)??0}get descender(){var t;return((t=this.font)==null?void 0:t.descender)??0}get familyName(){var t;return((t=this.font)==null?void 0:t.names.fontFamily)??""}get subfamilyName(){var t;return((t=this.font)==null?void 0:t.names.fontSubfamily)??""}get unitsPerEm(){var t;return((t=this.font)==null?void 0:t.unitsPerEm)??1}getLineInitialOffsetX(t,e,n,i,r){return(n===3||n===2)&&i.indexOf(`
`)>=0&&(t-=r),n===3?e*.5-t*.5:n===2?e-t:0}getLineInitialOffsetY(t,e,n,i,r){let s=e*t,o=Math.abs(this.ascender-this.descender)*i,a=t-o,l=-this.ascender*i-a/2;return r===3?-(n-s-l):r===2?-(n*.5-s*.5-l):l}createPath(t,e,n,i,r){var l;let s=t.getPath(n,-i,r.fontSize,{kerning:!1,letterSpacing:r.letterSpacing});if(!s){console.error('THREE.Font: character "'+t+'" does not exists in font family '+this.familyName+".");return}let o=new bOe,a=(t.advanceWidth??1)*e;if(t)for(let c of s.commands){let h=(l=o.currentPath)==null?void 0:l.currentPoint;if(!(h&&c.type!=="Z"&&h.x===c.x&&-h.y===c.y))switch(c.type){case"M":o.moveTo(c.x,-c.y);break;case"L":o.lineTo(c.x,-c.y);break;case"Q":o.quadraticCurveTo(c.x1,-c.y1,c.x,-c.y);break;case"C":o.bezierCurveTo(c.x1,-c.y1,c.x2,-c.y2,c.x,-c.y);break}}return o.subPaths.forEach(c=>{let h=POe(c.curves);h!==void 0&&c.currentPoint.distanceTo(h)>0&&c.lineTo(h.x,h.y)}),{offsetX:a+r.fontSize*r.letterSpacing,path:o}}getCharWidth(t,e){var n;return((n=this.font)==null?void 0:n.getAdvanceWidth(t,e.fontSize,{kerning:!0,letterSpacing:e.letterSpacing}))??0}getTextWidth(t,e){var n;return((n=this.font)==null?void 0:n.getAdvanceWidth(t,e.fontSize,{kerning:!0,letterSpacing:e.letterSpacing}))??0}computeSpaceWidthForLine(t,e,n){let i=this.getCharWidth(" ",n),r=t[e];if(r){let s=this.countSpaces(r.trimEnd());if(n.horizontalAlign===4&&e<t.length-1&&s){let o=n.width,a=this.getTextWidth(r,n);return(o-(a-s*i))/s}}return i}countSpaces(t){return(t.match(/ /g)||[]).length}};function POe(t){if(t.length){let e=t[0];if(e instanceof Qa)return e.v1;if(e instanceof Ga||e instanceof qh)return e.v0}}var DOe=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(t){return this.objects.get(t)}get size(){return this.objects.size}get(t,e){let n=this.objects.get(t);return n===void 0?(n=this.createObject(t,e),this.objects.set(t,n)):n.isShared=!0,n}mutateIfUnique(t,e){let n=this.objects.get(t);if(n&&n.isShared!==!0)return this.objects.delete(t),this.objects.set(e,n),n}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(t,e){let n=this.objects.get(t);e===n&&this.unreachable.delete(t)}endGc(){this.unreachable.forEach(t=>{this.disposeObject(this.objects.get(t)),this.objects.delete(t)}),this.unreachable.clear()}dispose(){this.objects.forEach(t=>{this.disposeObject(t)}),this.objects.clear()}},w6=class extends DOe{constructor(t){super(),this.flatShading=t}disposeObject(t){t.dispose()}createObject(t,e){let n=mM(t,e,this.flatShading);return n.computeBoundingSphere(),n}},ROe={find(t){},markNeedsUpdateRendererDirty:function(){},markGeometryCacheDirty:function(){},addPendingExpandCloner:function(t){},addPendingUpdateCloner(t){},addPendingCommand(t){}},LOe=class extends hOe{constructor(t){super(),this.shared=t}create(t){return new HZ(t,this.shared)}},UE=class{constructor(t,e={}){if(this.geometryCache=new w6(!0),this.geometryCache2=new w6(!1),this.imageHolderCache=new LOe(this),this.thisContext={scene:ROe,shared:this},this.deletedMaterial=new GI(wo.defaultTwoLayerData("phong"),this.thisContext),this.deletedImage=new lf(cM.emptyImage,this),this.deletedVideo=new lf($A.defaultVideo,this),this.materials={},this.images={},this.videos={},this.colors={},this.audios={},this.fonts={},this.penumbraSize=[],this.requestRender=()=>{this._requestRender&&this._requestRender()},e.images)for(let[n,i]of Object.entries(e.images))this.addImage(n,i);if(e.videos)for(let[n,i]of Object.entries(e.videos))this.addVideo(n,i);if(e.audios)for(let[n,i]of Object.entries(e.audios))this.addAudio(n,i.data);this.reset(t)}setRequestRender(t){this._requestRender=t}reset(t){for(let[e,n]of Object.entries(t.images))this.addImage(e,n);for(let[e,n]of Object.entries(t.videos))this.addVideo(e,n);for(let[e,n]of Object.entries(t.colors))this.addColor(e,n);for(let[e,n]of Object.entries(t.materials))this.addMaterial(e,new GI(n,this.thisContext));for(let[e,n]of Object.entries(t.audios))this.addAudio(e,n.data);for(let[e,n]of Object.entries(t.fonts))this.addFont(e,n);this.penumbraSize=t.penumbraSize}addMaterial(t,e){e.uuid=t,this.materials[t]=e}deleteMaterial(t){this.materials[t]&&(this.materials[t].nodeMaterialDispose(),delete this.materials[t])}getMaterial(t){return this.materials[t]}getMaterialOrDeletedPlaceholder(t){return this.materials[t]??this.deletedMaterial}material(t){return typeof t=="string"?this.getMaterialOrDeletedPlaceholder(t):new ZZ(t,this.thisContext)}getMaterials(){return this.materials}addImage(t,e){return this.images[t]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[t].updateSrc(e.data),!0):(this.images[t]=new lf(e,this),!1)}deleteImage(t){let e=this.images[t];e&&(e.dispose(),delete this.images[t])}getDefaultImage(){return this.images.image_0}getImage(t){return this.images[t]??this.deletedImage}image(t){return typeof t=="string"?this.getImage(t):this.imageHolderCache.load(t)}addVideo(t,e){return this.videos[t]?(this.videos[t].updateSrc(e.data),!0):(this.videos[t]=new lf(e,this),!1)}deleteVideo(t){let e=this.videos[t];e&&(e.dispose(),delete this.videos[t])}getVideo(t){return this.videos[t]??this.deletedVideo}video(t){return typeof t=="string"?this.getVideo(t):this.imageHolderCache.load(t)}addColor(t,e){return this.colors[t]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in e?this.colors[t].setRGBA(e.r,e.g,e.b,e.a):this.colors[t].setRGBA(e.r,e.g,e.b,1),!0):("a"in e?this.colors[t]=new gM(e.r,e.g,e.b,e.a):this.colors[t]=new gM(e.r,e.g,e.b,1),!1)}updateColor(t,e){if(this.colors[t]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let n=this.colors[t];return this.colors[t].r=e.r??n.r,this.colors[t].g=e.g??n.g,this.colors[t].b=e.b??n.b,this.colors[t].a=e.a??n.a,!0}return!1}deleteColor(t){this.colors[t]&&delete this.colors[t]}getColor(t){return this.colors[t]}color(t){let e;if(typeof t=="string"){let n=this.getColor(t);n?e=n:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),e=new zs(0,0,0,0))}else return"a"in t?new zs(t.r,t.g,t.b,t.a):new zs(t.r,t.g,t.b,1);return e}addAudio(t,e){this.audios[t]=e}getAudio(t){let e=this.audios[t];if(e instanceof fy)return e;{let n=new fy({src:e});return this.audios[t]=n,n}}deleteAudio(t){let e=this.audios[t];e&&(e instanceof fy&&e.dispose(),delete this.audios[t])}addFont(t,e){this.fonts[t]=new TOe(e),this.fonts[t].loadingPromise.then(()=>this.requestRender())}getFont(t){return this.fonts[t]}deleteFont(t){this.fonts[t]&&delete this.fonts[t]}dispose(){Object.keys(this.materials).forEach(t=>this.deleteMaterial(t)),this._requestRender=void 0,Object.values(this.audios).forEach(t=>{t instanceof fy&&t.dispose()}),this.audios={},this.geometryCache.dispose(),this.geometryCache2.dispose()}};new UE(uM.emptyData());var kE=class extends Vs{updateByPatchedOp(t,e,n){if(super.updateByPatchedOp(t,e,n),_Le(t.path,["materials"])!==null&&t.type===0&&Array.isArray(this.material))for(let[i,r]of Object.entries(t.props)){let s=n.shared.material(r);this.material[Number(i)]=s}else if(oh(t.path,["material"])&&this.material instanceof Kh)"material"in e&&typeof e.material!="string"&&this.material.updateByOp(ho.drop(t,1),e.material,n);else if(oh(t.path,["materials","*"])&&Array.isArray(this.material)){let i=t.path[1];if("materials"in e&&i<this.material.length){let r=e.materials[i];typeof r!="string"&&this.material[i].updateByOp(ho.drop(t,2),r,n)}}}updateState(t,e){var i,r,s,o,a;super.updateState(t,e),t.castShadow!==void 0&&(this.castShadow=t.castShadow),t.receiveShadow!==void 0&&(this.receiveShadow=t.receiveShadow);let n=this.dataPatched;if(((i=t.geometry)==null?void 0:i.type)!=="NonParametricGeometry"&&"material"in t&&t.material!==void 0&&(this.disposeMaterial(),this.material=e.shared.material(t.material).getFlavor(n.flatShading,n.side,n.wireframe),(r=e.scene)==null||r.markNeedsUpdateRendererDirty()),((s=t.geometry)==null?void 0:s.type)==="NonParametricGeometry"&&("materials"in t&&t.materials!==void 0?(this.disposeMaterial(),this.material=t.materials.map(l=>e.shared.material(l).getFlavor(n.flatShading,n.side,n.wireframe)),(o=e.scene)==null||o.markNeedsUpdateRendererDirty()):"material"in t&&t.material!==void 0&&(this.disposeMaterial(),this.material=[e.shared.material(t.material).getFlavor(n.flatShading,n.side,n.wireframe)],(a=e.scene)==null||a.markNeedsUpdateRendererDirty())),t.flatShading!==void 0||t.wireframe!==void 0||t.side!==void 0)if(Array.isArray(this.material))for(let l=0;l<this.material.length;l++)this.material[l]=this.material[l].getFlavor(n.flatShading,n.side,n.wireframe);else this.material=this.material.getFlavor(n.flatShading,n.side,n.wireframe)}disposeMaterial(){this.material&&FJ(this.material).forEach(t=>{t instanceof Kh&&(t instanceof GI||t.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},fa=class extends kE{constructor(t,e,n){super(t,e),this.data=e,this.localGeometry=void 0}chooseGeoemtryCache(t){return t.geometryCache}markGeometryAsReachable(t){this.geometryCreateDeleyed instanceof Lt&&this.chooseGeoemtryCache(t).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof UE){let t=this.geometryCreateDeleyed,e=this.chooseGeoemtryCache(t);this.geometryCreateDeleyed=e.get(this.dataPatched.geometry,t)}return this.geometryCreateDeleyed}set geometry(t){this.localGeometry=t}get is2DAndNoDepth(){let t=this.dataPatched.geometry;return nM.is2DParametricMesh(t.type)&&t.depth===0}get is2DType(){return nM.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(t,e,n){super.updateByPatchedOp(t,e,n),oh(t.path,["geometry"])&&this.updateByPatchedOpGeometry(ho.drop(t,1),e.geometry,n)}removeInteractionGeometry(){var t;(t=this.localGeometry)==null||t.dispose(),this.localGeometry=void 0}updateGeometryInteractions(t,e){var i;this.invalidateDownstreamBooleanData();let n=this.data.geometry.type;if(n==="NonParametricGeometry"||n==="SubdivGeometry"){let r=t;if(this.localGeometry===void 0){let c={...this.data.geometry,...r};this.localGeometry=mM(c,e,this.data.flatShading)}let s,o,a;r.scaleBaked?[s,o,a]=r.scaleBaked:{width:s,height:o,depth:a}=r;let l=this.localGeometry.userData;l.sxPrev!==void 0&&NI(this.localGeometry.attributes,s/l.sxPrev,o/l.syPrev,a/l.szPrev),l.sxPrev=s,l.syPrev=o,l.szPrev=a}else{let r={...this.data.geometry,...t};(i=this.localGeometry)==null||i.dispose(),this.localGeometry=mM(r,e,this.data.flatShading)}}refreshAttachedCloners(t){for(let e of this.attachedSurfaceCloners)t.scene.addPendingUpdateCloner(e.object)}refreshAttachedPaths(t){for(let e of this.attachedPaths)t.scene.addPendingCommand(()=>e.updateShape())}createGeometryDelayed(t){this.geometryCreateDeleyed=t.shared,this.refreshAttachedCloners(t),this.refreshAttachedPaths(t)}updateByPatchedOpGeometry(t,e,n){var r;let i=!1;t.type===0&&t.path.length===0&&fF(["scaleBaked"],Object.keys(t.props))&&this.geometryCreateDeleyed instanceof fs&&this.chooseGeoemtryCache(n.shared).mutateIfUnique(this.geometryCreateDeleyed.data,e)===this.geometryCreateDeleyed&&(i=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(e,t.props.scaleBaked),this.refreshAttachedCloners(n),this.refreshAttachedPaths(n)),i||((r=n.scene)==null||r.markGeometryCacheDirty(),this.createGeometryDelayed(n)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(t,e){this.createGeometryDelayed(e)}updateState(t,e){t.geometry!==void 0&&this.updateGeometryOnStateUpdate(t.geometry,e),super.updateState(t,e)}updateGeometryGroupsIfNeeded(){var t;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((t=this.geometry.getIndex())==null?void 0:t.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(t,e){let n=this.geometry.userData.parameters;this.is2DType?t.set(0,0,n.depth*.5):this.isNonParametric?(t.setScalar(0),this.geometry.boundingSphere&&t.copy(this.geometry.boundingSphere.center),e.set(n.width,n.height,n.depth??0).multiplyScalar(.5)):t.setScalar(0),e.set(n.width,n.height,n.depth??0).multiplyScalar(.5)}};function IOe(t){var o,a;if(t.geometry.attributes.extrudeNormal||!t.geometry.attributes.position||!t.geometry.attributes.normal)return;let e=new Map,n=t.geometry.attributes,i=n.position.array,r=n.normal.array,s=new Float32Array(i.length);for(let l=0;l<i.length;l+=3){let c=`${i[l]}_${i[l+1]}_${i[l+2]}`,h=new N(r[l],r[l+1],r[l+2]);e.has(c)?(o=e.get(c))==null||o.normals.push(h):e.set(c,{normals:[h],result:new N})}e.forEach((l,c)=>{for(let h of l.normals)l.result.add(h);l.result.divideScalar(l.normals.length)});for(let l=0;l<i.length;l+=3){let c=`${i[l]}_${i[l+1]}_${i[l+2]}`,h=(a=e.get(c))==null?void 0:a.result;h&&(s[l]=h.x,s[l+1]=h.y,s[l+2]=h.z)}t.geometry.setAttribute("extrudeNormal",new ft(s,3))}function BOe(t){if(t.geometry.attributes.extrudeNormals||!t.geometry.attributes.position)return;let e=t.geometry.attributes.position.array,n=new Float32Array(e.length),i=new N;for(let r=0;r<e.length;r+=3)i.set(e[r],e[r+1],e[r+2]).normalize(),n[r]=i.x,n[r+1]=i.y,n[r+2]=i.z;t.geometry.setAttribute("extrudeNormal",new ft(n,3))}function UF(t){if(Array.isArray(t.material)){for(let e of t.material)if(e.getLayersOfType("outline").length===0)return}else if(!(t.material instanceof Kh)||t.material.getLayersOfType("outline").length===0)return;t instanceof fa&&t.is2DAndNoDepth?BOe(t):IOe(t)}function kF(t){if(!t.geometry.attributes.position)return;let e=t.geometry.attributes.position.array,n=new Float32Array(e.length),i=parseInt(t.uuid.replace(/\D/g,"")),r=[sn.seededRandom(i),sn.seededRandom(i+1e4),sn.seededRandom(i+2e4)];for(let s=0;s<e.length;s++)n[s]=r[s%3];t.geometry.setAttribute("randomColor",new Ut(n,3))}LF.then(t=>{});var Sl=new ji,V0=new N;function OOe(t){let e=!1;return t.scene.objects.traverse((n,i)=>{i.type==="Mesh"&&i.geometry.type==="SubdivGeometry"&&(e=!0)}),e}var qx=class extends fa{constructor(t,e,n){super(t,e,n),this.data=e,this.hiddenMatrixOld=new nt,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(t){return this.dataPatched.flatShading?t.geometryCache:t.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(t,e){let n=this.geometry.userData.parameters;t.copy(this.originalGeometryNew.boundingSphere.center),e.set(n.width,n.height,n.depth??0).multiplyScalar(.5)}createGeometryByControls(t){var s,o,a;if(this.skipReactionUpdate===!0)return;let e=(s=this.localGeometry)==null?void 0:s.uuid,{originalGeometry:n,subdividedGeometry:i,subdivPointer:r}=fs.build(t,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=r,n!==void 0&&((o=this.originalGeometry)==null||o.dispose(),this.originalGeometry=n),i!==void 0&&((a=this.subdividedGeometry)==null||a.dispose(),this.subdividedGeometry=i??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,UF(this),kF(this),this.calcBoundingBox(),e&&(this.localGeometry.uuid=e)}updateState(t,e){if(super.updateState(t,e),t.flatShading!==void 0){let n=this.material;this.material=n.getFlavor(!1,n.side,n.wireframe),this.smoothShading=!t.flatShading,this.createGeometryDelayed(e)}}updateMesh(t=!1){fs.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,t&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&fs.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,t&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=fs.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=fs.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(t,e){let n=this.localGeometry;this.localGeometry=this.originalGeometryNew,Vs.prototype.raycast.call(this,t,e),this.localGeometry=n}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let t=this.originalGeometry;t.boundingSphere===null&&(t.boundingSphere=new ha,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=t.boundingSphere));let e=t.attributes.position,n=t.boundingSphere.center;Sl.setFromBufferAttribute(e),Sl.getCenter(n),t.boundingSphere.radius=n.distanceTo(Sl.max),isNaN(t.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Sl.getSize(V0),this.hasNonUniformScale&&V0.divide(this.scale);let i={width:V0.x,height:V0.y,depth:V0.z};return this.geometry.userData.parameters=i,i}updateBoundingSphere(t){let e=this.originalGeometry;Sl.min.set(t[0],t[2],t[4]),Sl.max.set(t[1],t[3],t[5]),this.hasNonUniformScale&&(Sl.min.applyMatrix4(this.shearScaleInv),Sl.max.applyMatrix4(this.shearScaleInv)),e.boundingSphere===null&&(e.boundingSphere=new ha);let n=e.boundingSphere.center;Sl.getCenter(n),e.boundingSphere.radius=n.distanceTo(Sl.max)}freeSubdivPointer(){var t,e;this.subdivPointer&&(fs.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(t=this.originalGeometry)==null||t.dispose(),(e=this.subdividedGeometry)==null||e.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(t,e,n){super.updateByPatchedOpGeometry(t,e,n),this.localGeometry&&this.createGeometryByControls(e)}},_6=-1,FOe=1,NOe={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},UOe={polygon_center:0,edge:1,vertex:2},Qb=(t,e)=>(n,i)=>!e||n===0||t===0?0:t*i/100,Ht=(t,e)=>{let n=Math.abs(e),i=n*-1;return(t-_6)*(n-i)/(FOe-_6)+i};function kOe(t){let e=[],n={};for(var i=0,r=t.length;i<r;i++){var s=JSON.stringify(t[i].pos.map(o=>Math.round(o*1e4)/1e4));n[s]||(e.push(t[i]),n[s]=!0)}return e}var zOe=new N,Kb=new N,GOe=new N,HOe=new N;function Sg(t,e){let n=GOe.fromArray(t),i=HOe.fromArray(e);Kb.copy(i).sub(n);let r=Kb.length();return Kb.normalize().multiplyScalar(r*.5),zOe.copy(n).add(Kb).toArray()}var ta=new Ds,Jb=new N,yM=new N,Jd=new N;function VOe(t){let e=[];for(let n=0;n<=t.index.count;n++)if(Jb.fromArray(t.index.array,n*3),ta.setFromAttributeAndIndices(t.attributes.position,Jb.x,Jb.y,Jb.z),ta.getNormal(yM),ta.getMidpoint(Jd),!(isNaN(Jd.x)||isNaN(Jd.y)||isNaN(Jd.z))){let{a:i,b:r,c:s}=ta,o=i.toArray(),a=r.toArray(),l=s.toArray(),c=i.distanceTo(r),h=r.distanceTo(s),u=s.distanceTo(i),d=Sg(o,a),f=Sg(a,l),p=Sg(l,o),v=[c,h,u],g=Math.max(...v),m=v.filter(b=>Math.round(b)===Math.round(g)).length>1,y=[],w=ta.getMidpoint(Jd).toArray();g===c&&!m&&(y=[f,p,p],w=d),g===h&&!m&&(y=[d,p,p],w=f),g===u&&!m&&(y=[d,f,f],w=p),m&&(y=[d,f,p]),e.push({vertices:[o,a,l],faceCenters:y,midpoint:w,norm:ta.getNormal(yM).toArray()})}return e}function jOe(t){let e=[],{position:n}=t.attributes;for(let i=0;i<n.count;i++){ta.setFromAttributeAndIndices(n,i*3,i*3+1,i*3+2),ta.getNormal(yM),ta.getMidpoint(Jd);let r=ta.a.toArray(),s=ta.b.toArray(),o=ta.c.toArray();e.push({vertices:[r,s,o],faceCenters:[Sg(r,s),Sg(s,o),Sg(o,r)],midpoint:Jd.toArray(),norm:yM.toArray()})}return e}var WOe=4,XOe=.5,K2=t=>.5*(1-Math.cos(t*Math.PI)),YOe=class{constructor(){this.perlin=new Array(4095+1)}noise(t,e=0,n=0){if(this.perlin==null){this.perlin=new Array(4095+1);for(let g=0;g<4095+1;g++)this.perlin[g]=Math.random()}t<0&&(t=-t),e<0&&(e=-e),n<0&&(n=-n);let i=Math.floor(t),r=Math.floor(e),s=Math.floor(n),o=t-i,a=e-r,l=n-s,c,h,u=0,d=.5,f,p,v;for(let g=0;g<WOe;g++){let m=i+(r<<4)+(s<<8);c=K2(o),h=K2(a),f=this.perlin[m&4095],f+=c*(this.perlin[m+1&4095]-f),p=this.perlin[m+16&4095],p+=c*(this.perlin[m+16+1&4095]-p),f+=h*(p-f),m+=256,p=this.perlin[m&4095],p+=c*(this.perlin[m+1&4095]-p),v=this.perlin[m+16&4095],v+=c*(this.perlin[m+16+1&4095]-v),p+=h*(v-p),f+=K2(l)*(p-f),u+=f*d,d*=XOe,i<<=1,o*=2,r<<=1,a*=2,s<<=1,l*=2,o>=1&&(i++,o--),a>=1&&(r++,a--),l>=1&&(s++,l--)}return u}noiseSeed(t){let e=(()=>{let n,i;return{setSeed(r){i=n=(r??Math.random()*4294967296)>>>0},getSeed(){return n},rand(){return i=(1664525*i+1013904223)%4294967296,i/4294967296}}})();e.setSeed(t),this.perlin=new Array(4095+1);for(let n=0;n<4095+1;n++)this.perlin[n]=e.rand()}},qOe=YOe,b6=new N,S6=new nt,A6=new yv;function M6(t){let e=!1;return t.scene.objects.traverse((n,i)=>{i.type==="Mesh"&&i.geometry.type==="TextGeometry"&&(e=!0)}),e}var e$=class extends fa{constructor(t,e,n){super(t,e,n),this.data=e}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var e;let t=this.dataPatched;return((e=this.font)==null?void 0:e.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,t.geometry.height,this.fontScale,t.geometry.verticalAlign))??0}get fontScale(){let t=this.dataPatched;return this.font?t.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var t;return(((t=this.font)==null?void 0:t.ascender)??1)*this.fontScale}get descender(){var t;return(((t=this.font)==null?void 0:t.descender)??1)*this.fontScale}get lineHeight(){let t=this.dataPatched;return t.geometry.fontSize*t.geometry.lineHeight}raycast(t,e){let{matrixWorld:n}=this;if(!(isNaN(t.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(S6.copy(n).invert(),A6.copy(t.ray).applyMatrix4(S6),A6.intersectBox(this.singleBBox,b6))){let i=b6.applyMatrix4(n),r=t.ray.origin.distanceTo(i);e.push({distance:r,point:i.clone(),object:this})}}},os=1e-4,Al,t$,n$,i$,E6=new N,C6=new N;LF.then(t=>{Al=t,t$=[Al.get_face_center,Al.get_edge_midpoint,Al.get_vertex_position],n$=[Al.get_face_normal,Al.get_edge_normal,Al.get_vertex_normal],i$=[Al.face_count,Al.edge_count,Al.vertex_count]});var QOe=new nt,KOe=new nt,Vu=new N,Ld=new N,j0=new N,J2=new N,JOe=new N,ZOe=new N,Pc=new qOe,cf=class extends MF(Nn){constructor(t,e){super(),this.parameters=e,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.object=t}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(t){if(this.parent===null)this.updateState(this.parameters,t);else for(let e of this.children)e instanceof zl&&e.expand()}invalidateTransform(t){this.matrixWorldNeedsUpdate=!0,this.traverse(e=>{e instanceof zl&&e.object===t&&(e.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let t of this.children)t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD())}_updateCount(t){let e;if(t!==void 0?e=t:e=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"&&!this.parameters.toObject.object&&(e=0),this.parameters.type==="toObject"&&this.objectForSample){for(let i=0,r=this.children.length;i<r;++i)this.remove(this.children[0]);let n=this.children;if(n.length===e)return;if(n.length<e)for(let i=0,r=e-n.length;i<r;++i){let s=new zl(this.object);s.expand(),this.add(s)}else for(let i=0,r=n.length-e;i<r;++i)this.remove(n[i])}else{if(this.children.length===e)return;if(this.children.length<e)for(let n=0,i=e-this.children.length;n<i;++n){let r=new zl(this.object);r.expand(),this.add(r)}else for(let n=0,i=this.children.length-e;n<i;++n)this.remove(this.children[0])}}_updateRadial(t){let e=t.radial,n=e.start*sn.DEG2RAD,i=e.end*sn.DEG2RAD,r=n-i,s=new Dr(e.rotation[0],e.rotation[1],e.rotation[2]),o;switch(e.axis){case"z":o=new N(0,0,1);break;case"y":o=new N(0,1,0);break;default:case"x":o=new N(1,0,0);break}let a=t.randomnessObject??vh.defaultData([1,1,1]).randomnessObject,l=a.noiseType==="perlin";Pc.noiseSeed(a.seed);let c=O2((0,F0.default)(a.seed)),h=Qb(a.strength,this.parameters.randomness);for(let[u,d]of this.children.entries()){let f=u*(a.freqScale/10)+a.movement,p=l?Pc.noise(f):c(f,f);d.scale.x=e.scale[0]+h(u,Ht(p,a.scale[0]))||os,d.scale.y=e.scale[1]+h(u,Ht(p,a.scale[1]))||os,d.scale.z=e.scale[2]+h(u,Ht(p,a.scale[2]))||os,d.position.setScalar(0);let v=r/t.count*u-n;switch(e.axis){case"x":d.rotation.set(0,v,0);break;case"y":d.rotation.set(0,0,v);break;case"z":d.rotation.set(v,0,0);break}d.translateOnAxis(o,e.radius),d.position.x+=e.position[0]+h(u,Ht(p,a.position[0])),d.position.y+=e.position[1]+h(u,Ht(p,a.position[1])),d.position.z+=e.position[2]+h(u,Ht(p,a.position[2]));let g=h(u,Ht(p,a.rotation[0])),m=h(u,Ht(p,a.rotation[1])),y=h(u,Ht(p,a.rotation[2]));e.alignment===!0?(d.rotation.x+=s.x+g,d.rotation.y+=s.y+m,d.rotation.z+=s.z+y):d.rotation.set(s.x+g,s.y+m,s.z+y)}}_updateLinear(t){if(t.type!=="linear")throw new Error;let e=t.linear,n=new Dr(e.rotation[0],e.rotation[1],e.rotation[2]),i=t.randomnessObject??vh.defaultData([1,1,1]).randomnessObject,r=i.noiseType==="perlin";Pc.noiseSeed(i.seed);let s=O2((0,F0.default)(i.seed)),o=Qb(i.strength,this.parameters.randomness);for(let[a,l]of this.children.entries()){let c=a*(i.freqScale/10)+i.movement,h=r?Pc.noise(c):s(c,c),u=o(a,Ht(h,i.rotation[0])),d=o(a,Ht(h,i.rotation[1])),f=o(a,Ht(h,i.rotation[2]));l.scale.x=1+(e.scale[0]-1)*a+o(a,Ht(h,i.scale[0]))||os,l.scale.y=1+(e.scale[1]-1)*a+o(a,Ht(h,i.scale[1]))||os,l.scale.z=1+(e.scale[2]-1)*a+o(a,Ht(h,i.scale[2]))||os,l.rotation.x=n.x*a+u,l.rotation.y=n.y*a+d,l.rotation.z=n.z*a+f,l.position.x=e.position[0]*a+o(a,Ht(h,i.position[0])),l.position.y=e.position[1]*a+o(a,Ht(h,i.position[1])),l.position.z=e.position[2]*a+o(a,Ht(h,i.position[2]))}}_updateGrid(t){let e=0,n=t.grid,i=t.randomnessObject??vh.defaultData([1,1,1]).randomnessObject,r=Qb(i.strength,this.parameters.randomness),s=i.noiseType==="perlin";Pc.noiseSeed(i.seed);let o=ZIe((0,F0.default)(i.seed));if(n.useCenter===!0){let a={x:n.count[0]%2===0?2:1,y:n.count[1]%2===0?2:1,z:n.count[2]%2===0?2:1},l=new N(n.size[0]*(n.count[0]-a.x)*.5,n.size[1]*(n.count[1]-a.y)*.5,n.size[2]*(n.count[2]-a.z)*.5);for(let c=0;c<n.count[0];c++)for(let h=0;h<n.count[1];h++)for(let u=0;u<n.count[2];u++){let d=[(c+1)*(i.freqScale/10)+i.movement,(h+1)*(i.freqScale/10)+i.movement,(u+1)*(i.freqScale/10)+i.movement],f=s?Pc.noise(...d):o(...d),p=this.children[e++];p.scale.x=1+r(e,Ht(f,i.scale[0]))||os,p.scale.y=1+r(e,Ht(f,i.scale[1]))||os,p.scale.z=1+r(e,Ht(f,i.scale[2]))||os;let v=r(e,Ht(f,i.rotation[0])),g=r(e,Ht(f,i.rotation[1])),m=r(e,Ht(f,i.rotation[2]));p.rotation.set(v,g,m),p.position.x=n.size[0]*c-l.x+r(e,Ht(f,i.position[0])),p.position.y=n.size[1]*h-l.y+r(e,Ht(f,i.position[1])),p.position.z=n.size[2]*u-l.z+r(e,Ht(f,i.position[2]))}}else for(let a=0;a<n.count[0];a++)for(let l=0;l<n.count[1];l++)for(let c=0;c<n.count[2];c++){let h=[(a+1)*(i.freqScale/10)+i.movement,(l+1)*(i.freqScale/10)+i.movement,(c+1)*(i.freqScale/10)+i.movement],u=s?Pc.noise(...h):o(...h),d=this.children[e++];d.scale.x=1+r(e,Ht(u,i.scale[0]))||os,d.scale.y=1+r(e,Ht(u,i.scale[1]))||os,d.scale.z=1+r(e,Ht(u,i.scale[2]))||os;let f=r(e,Ht(u,i.rotation[0])),p=r(e,Ht(u,i.rotation[1])),v=r(e,Ht(u,i.rotation[2]));d.rotation.set(f,p,v),d.position.x=n.size[0]*a+r(e,Ht(u,i.position[0])),d.position.y=-n.size[1]*l+r(e,Ht(u,i.position[1])),d.position.z=-n.size[2]*c+r(e,Ht(u,i.position[2]))}}_updateToObject(t){var v;if(t.type!=="toObject")throw new Error;let{toObject:e}=t,n=new Dr(e.rotation[0],e.rotation[1],e.rotation[2]),i=t.randomnessObject??vh.defaultData([1,1,1]).randomnessObject,r=i.noiseType==="perlin";Pc.noiseSeed(i.seed);let s=O2((0,F0.default)(i.seed)),o=Qb(i.strength,this.parameters.randomness);if(!e.object){for(let[,g]of this.children.entries())g.position.set(0,0,0),g.scale.setScalar(1),g.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof e$)if(!((v=this.objectForSample.font)!=null&&v.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let a=this.getSubdivData(),l=[],c=g=>{let m=g.length,y=g.map(A=>A[0]).reduce((A,S)=>A+S,0),w=g.map(A=>A[1]).reduce((A,S)=>A+S,0),b=g.map(A=>A[2]).reduce((A,S)=>A+S,0);return[y/m,w/m,b/m]},h=g=>Math.round(g*1e6)/1e6;a.forEach(g=>{let m=a.filter(y=>h(g.pos[0])===h(y.pos[0])&&h(g.pos[1])===h(y.pos[1])&&h(g.pos[2])===h(y.pos[2]));m.length>1?l.push({pos:g.pos,norm:c(m.map(y=>y.norm))}):l.push(g)});let u=kOe(l);if(a.length>0){let g=Math.round(u.length*e.count/100);this._updateCount(g)}this.objectForSample.updateMatrixWorld();let d=new $Ie(this.objectForSample).build(),f=NOe[e.axis],p=this.children;d.setRandomGenerator((0,F0.default)(this.object.uuid+e.seed));for(let[g,m]of p.entries()){let y=g*(i.freqScale/10)+i.movement,w=r?Pc.noise(y):s(y,y),b=o(g,Ht(w,i.rotation[0])),A=o(g,Ht(w,i.rotation[1])),S=o(g,Ht(w,i.rotation[2]));e.spreadType==="random"?d.sample(j0,J2):(u.length&&(j0.fromArray(u[g].pos),J2.fromArray(u[g].norm)),this.objectForSample instanceof qx&&j0.applyMatrix4(QOe.copy(this.objectForSample.matrixWorld).invert())),j0.applyMatrix4(this.object.hiddenMatrix.clone().invert()),m.position.copy(j0),Vu.fromArray(f);let T=e.align==="normal"?J2:this.object.getWorldDirection(ZOe),M=Ld.fromArray(e.position);Ld.x+=Ld.x+o(g,Ht(w,i.position[0])),Ld.y+=Ld.y+o(g,Ht(w,i.position[1])),Ld.z+=Ld.z+o(g,Ht(w,i.position[2]));let E=Math.acos(T.dot(Vu)),P=JOe.crossVectors(Vu,T).normalize(),R=KOe.makeRotationAxis(P,E),F=T.clone().cross(this.object.up).normalize(),B=F.clone().cross(T).normalize(),k=new nt().makeBasis(F,T,B),j=new N(Vu.y,Vu.z,Vu.x).normalize(),Z=j.clone().cross(Vu).normalize(),ee=new nt().makeBasis(j,Vu,Z).invert(),O=new nt().multiplyMatrices(k,ee);m.rotation.setFromRotationMatrix(O),M.applyMatrix4(R),m.position.add(M),m.rotation.x=m.rotation.x+n.x+b,m.rotation.y=m.rotation.y+n.y+A,m.rotation.z=m.rotation.z+n.z+S,m.scale.setScalar(1),m.scale.x=m.scale.x+e.scale[0]+o(g,Ht(w,i.scale[0]))||os,m.scale.y=m.scale.y+e.scale[1]+o(g,Ht(w,i.scale[1]))||os,m.scale.z=m.scale.z+e.scale[2]+o(g,Ht(w,i.scale[2]))||os,m.scale.multiply(this.object.scale),m.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let t=this.parameters.toObject.spreadType;if(t==="random")return[];if(this.objectForSample instanceof qx){let e=this.objectForSample,n=UOe[t],i=i$[n],r=t$[n],s=n$[n],o=[],a=i(e.subdivPointerNew);for(let l=0;l<=a-1;l++){let c=r(e.subdivPointerNew,l),h=s(e.subdivPointerNew,l);E6.fromArray(c).applyMatrix4(e.matrixWorld),C6.fromArray(h),o.push({pos:E6.toArray(),norm:C6.toArray()})}return o}else return(this.objectForSample.geometry.index?VOe(this.objectForSample.geometry):jOe(this.objectForSample.geometry)).map((e,n)=>t==="polygon_center"?{pos:e.midpoint,norm:e.norm}:t==="vertex"?[{pos:e.vertices[0],norm:e.norm},{pos:e.vertices[1],norm:e.norm},{pos:e.vertices[2],norm:e.norm}]:t==="edge"?[{pos:e.faceCenters[0],norm:e.norm},{pos:e.faceCenters[1],norm:e.norm},{pos:e.faceCenters[2],norm:e.norm}]:[]).flat()}updateState(t,e){var n;if(this.parameters=DE(t),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(n=this.object.parent)==null||n.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let i=e.find(this.parameters.toObject.object);i instanceof Vs?this.objectForSample=i:this.objectForSample=void 0,this.matrix=new nt,this.hiddenMatrix=new nt,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,i&&i.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},H1=t=>{var e;return e=class extends t{},e.geometryHelper=new nc(30,30,30),e},Zb=new yv,Z2=new ha,T6=new nt,V1=(t,e,n,i,r=!1)=>{let s=e,o=t.matrixWorld;if(s.boundingSphere===null&&s.computeBoundingSphere(),Z2.copy(s.boundingSphere),Z2.applyMatrix4(o),n.ray.intersectsSphere(Z2)===!1||(T6.copy(o).invert(),Zb.copy(n.ray).applyMatrix4(T6),s.boundingBox!==null&&Zb.intersectsBox(s.boundingBox)===!1))return;let a,l,c,h,u=s.index,d=s.attributes.position,f=s.drawRange,p,v;if(r===!1){let m=Math.max(0,f.start),y=Math.min(u.count,f.start+f.count);for(p=m,v=y;p<v;p+=3)if(l=u.getX(p),c=u.getX(p+1),h=u.getX(p+2),a=g(t,n,Zb,d,l,c,h),a){a.faceIndex=Math.floor(p/3),i.push(a);return}}else{let m=s.attributes.position,y=new N,w=new N,b=new N,A=new N,S=2,T=1/((t.scale.x+t.scale.y+t.scale.z)/3),M=T*T,E=Math.max(0,f.start),P=Math.min(m.count,f.start+f.count);for(let R=E,F=P-1;R<F;R+=S){if(y.fromBufferAttribute(m,R),w.fromBufferAttribute(m,R+1),Zb.distanceSqToSegment(y,w,A,b)>M)continue;A.applyMatrix4(t.matrixWorld);let B=n.ray.origin.distanceTo(A);B<n.near||B>n.far||i.push({distance:B,point:b.clone().applyMatrix4(t.matrixWorld),object:t})}}function g(m,y,w,b,A,S,T){let M=new N,E=new N,P=new N,R=new N,F=new N;if(M.fromBufferAttribute(b,A),E.fromBufferAttribute(b,S),P.fromBufferAttribute(b,T),w.intersectTriangle(M,E,P,!1,R)===null)return null;F.copy(R),F.applyMatrix4(m.matrixWorld);let B=y.ray.origin.distanceTo(F);return B<y.near||B>y.far?null:{faceIndex:1,distance:B,point:F.clone(),object:m}}},$b=new N,Go=new wv,$Oe=class extends U1{constructor(t){let e=new Lt,n=new rd({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],s={},o=new Rt(15711266),a=new Rt(15711266),l=new Rt(2857471);c("n1","n2",o),c("n2","n4",o),c("n4","n3",o),c("n3","n1",o),c("f1","f2",o),c("f2","f4",o),c("f4","f3",o),c("f3","f1",o),c("n1","f1",o),c("n2","f2",o),c("n3","f3",o),c("n4","f4",o),c("p","n1",a),c("p","n2",a),c("p","n3",a),c("p","n4",a),c("u1","u2",l),c("u2","u3",l),c("u3","u1",l);function c(u,d,f){h(u,f),h(d,f)}function h(u,d){i.push(0,0,0),r.push(d.r,d.g,d.b),s[u]===void 0&&(s[u]=[]),s[u].push(i.length/3-1)}e.setAttribute("position",new ft(i,3)),e.setAttribute("color",new ft(r,3)),super(e,n),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let t=this.geometry,e=this.pointMap;Go.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let n=1,i=1,r=.8;Pa("n1",e,t,Go,-n,-i,r),Pa("n2",e,t,Go,n,-i,r),Pa("n3",e,t,Go,-n,i,r),Pa("n4",e,t,Go,n,i,r);let s=r;Pa("f1",e,t,Go,-n,-i,s),Pa("f2",e,t,Go,n,-i,s),Pa("f3",e,t,Go,-n,i,s),Pa("f4",e,t,Go,n,i,s);let o=s,a=.5;Pa("u1",e,t,Go,n*.7*a,i*1.1,o),Pa("u2",e,t,Go,-n*.7*a,i*1.1,o),Pa("u3",e,t,Go,0,i*(1.1+.9*a),o),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function Pa(t,e,n,i,r,s,o){$b.set(r,s,o).unproject(i);let a=e[t];if(a!==void 0){let l=n.getAttribute("position");for(let c=0,h=a.length;c<h;c++)l.setXYZ(a[c],$b.x,$b.y,$b.z)}}var eFe=class extends H1($Oe){constructor(t){super(t),this.object=t,this.object=t,this.name=`CombinedCameraHelper: ${t.uuid}`}updateMatrixWorld(t){super.updateMatrixWorld(t),this.updateTarget()}updateTarget(){let t=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(t)}raycast(t,e){V1(this.object,this.geometry,t,e,!0)}},HI;(t=>t.is=e=>"objectHelper"in e)(HI||(HI={}));var zE=(t,e)=>class extends XJ(t){constructor(){super(...arguments),this.objectHelper=new e(this),this.gizmos={}}get geometryHelper(){return e.geometryHelper}raycast(n,i){this.objectHelper.raycast(n,i)}showGizmos(){for(let n in this.gizmos){let i=this.gizmos[n];i instanceof zA&&(i.visible=!0)}}updateEntityBoxSize(n,i){this.objectHelper.visible&&this.geometryHelper instanceof nc?(n.setScalar(0),i.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(n,i)}hideGizmos(){for(let n in this.gizmos){let i=this.gizmos[n];i instanceof zA&&(i.visible=!1)}}},$2=790,lm=new N,eD=new N,tD=new on,nD=new N,W0=new N,iD=new N,Gs=class extends zE(wv,eFe){constructor(t="",e={...iM.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=Vx.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(t,e),this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let n=this.width,i=this.height;if(e.orthographic.autoZoom){let r=e.orthographic.autoZoomFrustumSize??$2,s=n/i,o=n>i?s:1,a=n>i?1:s;this.orthoCamera=new OA(-r*.5*o,r*.5*o,r*.5*(1/a),-r*.5*(1/a),-5e4,1e4)}else this.orthoCamera=new OA(n*-.5,n*.5,i*.5,i*-.5,-5e4,1e4);this.perspCamera=new Qr(45,n/i,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(t){this.perspCamera.fov=t}get fov(){return this.perspCamera.fov}setNear(t,e){t==="PerspectiveCamera"?this.perspCamera.near=e:this.orthoCamera.near=e}setZoom(t,e){e>=0&&(t==="PerspectiveCamera"?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}set cameraType(t){t==="PerspectiveCamera"?this.toPerspective():t==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(t){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=t:this.orthoCamera.near=t}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(t){t>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}lookAt(t,e,n){typeof t=="number"&&(t=new N(t,e,n)),super.lookAt(t),this.getWorldPosition(lm),this.targetOffset=lm.distanceTo(t)}getTarget(t=new N){return this.getWorldDirection(eD),this.getWorldPosition(lm),eD.multiplyScalar(this.targetOffset),t.copy(lm).add(eD),t}getDistanceToTarget(){let t=this.getTarget();return this.getWorldPosition(lm),lm.distanceTo(t)}updateUp(){this.getWorldQuaternion(tD),nD.set(0,0,1).applyQuaternion(tD),W0.copy(Nn.DEFAULT_UP),this.isUpVectorFlipped&&W0.negate(),W0.applyQuaternion(tD),iD.copy(Nn.DEFAULT_UP).projectOnPlane(nD),this.angleOffsetFromUp=iD.angleTo(W0),this.angleOffsetFromUp*=iD.cross(W0).dot(nD)>=0?1:-1}updateTransformState(t){let e=super.updateTransformState(t);return t.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=t.isUpVectorFlipped),this.updateUp(),e}getViewFrontToObject(t){let e=t.getWorldPosition(new N),n=t.getWorldDirection(new N).multiplyScalar(this.targetOffset);return{position:e.clone().add(n),target:e}}getViewToObject(t){let e=t.getWorldPosition(new N),n=this.getWorldDirection(new N).multiplyScalar(this.targetOffset);return{position:e.clone().sub(n),target:e}}setViewplaneSize(t,e){if(this.aspect=t/e,this.data.type==="OrthographicCamera"&&this.data.orthographic.autoZoom){let n=this.data.orthographic.autoZoomFrustumSize??$2,i=t>e?this.aspect:1,r=t>e?1:this.aspect;this.left=-n*.5*i,this.right=n*.5*i,this.top=n*.5*(1/r),this.bottom=-n*.5*(1/r)}else this.left=-t*.5,this.right=t*.5,this.top=e*.5,this.bottom=-e*.5;this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(t){this.perspCamera.setFocalLength(t),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(t,e,n,i,r,s){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(t,e,n,i,r,s):this.orthoCamera.setViewOffset(t,e,n,i,r,s)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(t,e){return super.copy(t,e),this.parent=t.parent,this.orthoCamera.copy(t.orthoCamera),this.perspCamera.copy(t.perspCamera),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.far=t.far,this.view=t.view===null?null:Object.assign({},t.view),this._cameraType=t._cameraType,this.aspect=t.aspect,this.fov=t.fov,this.focus=t.focus,this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this.targetOffset=t.targetOffset,this.updateProjectionMatrix(),this}toCameraState(t=[]){let e={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom,autoZoom:!0,autoZoomFrustumSize:$2},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return iI(e,t)}updateCameraSubtype(t,e){let n=t==="perspective"?"PerspectiveCamera":"OrthographicCamera";e.zoom!==void 0&&this.setZoom(n,e.zoom),e.near!==void 0&&this.setNear(n,e.near),e.fov!==void 0&&n==="PerspectiveCamera"&&(this.fov=e.fov)}updateState(t,e){this.updateCameraState(t,e)}updateCameraState(t,e){this.updateState_Entity(t,e),t.far!==void 0&&(this.far=t.far),t.orthographic!==void 0&&this.updateCameraSubtype("orthographic",t.orthographic),t.perspective!==void 0&&this.updateCameraSubtype("perspective",t.perspective),t.type!==void 0&&(this.cameraType=t.type),t.up!==void 0&&this.up.fromArray(t.up),t.targetOffset!==void 0&&(this.targetOffset=t.targetOffset),t.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=t.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(t,e,n){super.updateByPatchedOp(t,e,n),t.path.length===1&&t.type===0&&this.updateCameraSubtype(t.path[0],t.props)}toState(t){return{...super.toState(t),...this.toCameraState(t),type:this.cameraType}}},P6=new nt;function D6(t){let e=!1;return t.scene.objects.traverse((n,i)=>{var r;((r=i.geometry)==null?void 0:r.type)==="BooleanGeometry"&&(e=!0)}),e}var tv=class extends kE{constructor(t,e,n){super(t,e),this.data=e,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new Lt,this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(t,e,n){super.updateByPatchedOp(t,e,n),t.path.length===1&&t.path[0]==="geometry"&&t.type===0&&t.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(t,e=!0){var i;if(this.booleanMeshSetAddress!==-1&&!t)return;for(let r=0;r<this.children.length;r++){let s=this.children[r];s instanceof tv&&s.recomputeBoolean(t===!0,e)}this.meshSetAddresses=[];for(let r=0;r<this.children.length;r++){let s=this.children[r];if(s instanceof Vs&&s.dataPatched.visible===!0&&((i=s.geometry.attributes.position)==null?void 0:i.count)>0&&s.geometry.drawRange.count>0){if(s.booleanMeshSetAddress===-1){if((s.geometry.index??s.geometry.getAttribute("position")).count/3<15e5&&(s.booleanMeshSetAddress=nh.getMeshSet(s.geometry,t===!0,e)),s.booleanMeshSetAddress===-1)return;nh.transformMeshSet(s.booleanMeshSetAddress,s.matrix),s.booleanMatrixInvOld.copy(s.matrix).invert(),s.booleanWasTransformed=!1}else s instanceof tv&&s.needsTransformForDownstream===!0?(nh.transformMeshSet(s.booleanMeshSetAddress,s.matrix),s.needsTransformForDownstream=!1):s.booleanWasTransformed===!0&&(P6.multiplyMatrices(s.matrix,s.booleanMatrixInvOld),nh.transformMeshSet(s.booleanMeshSetAddress,P6),s.booleanMatrixInvOld.copy(s.matrix).invert(),s.booleanWasTransformed=!1);this.meshSetAddresses.push(s.booleanMeshSetAddress)}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new p1e([],0)),this.geometry.setDrawRange(0,0);return}if(t===!0)return nh.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let n=this.geometry;n.dispose(),this.geometry=new Lt,this.geometry.userData=n.userData,this.geometry.boundingSphere=n.boundingSphere;try{this.booleanMeshSetAddress=nh.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(r){this.booleanMeshSetAddress=0,console.error(r)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,UF(this),kF(this)}dispose(){super.dispose(),this.geometry.dispose()}},VI;(t=>{function e(n){return Pn.is(n)&&n instanceof k1}t.is=e})(VI||(VI={}));var zF=(t,e)=>class extends zE(t,e){updateState_Light(n,i){this.updateState_Entity(n,i),n.color!==void 0&&(this.color=i.shared.color(n.color)),n.intensity!==void 0&&(this.intensity=n.intensity),n.depth!==void 0&&(this.shadow.camera.far=n.depth,this.shadow.needsUpdate=!0),n.shadows!==void 0&&(this.castShadow=n.shadows)}},kl=t=>t instanceof Vs,Xc=t=>t!==null&&t instanceof tv,tFe=t=>t instanceof Gs,nFe=t=>VI.is(t),R6=t=>HI.is(t),GF=class extends H1(qAe){constructor(t,e=15){super(e),this.object=t,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${t.uuid}`,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}raycast(t,e){V1(this.object,GF.geometryHelper,t,e)}update(){}},xM=class extends zE(Xm,GF){constructor(t,e){super(),this.super_Entity(t,e),this.objectHelper.update()}updateState(t,e){this.updateState_Entity(t,e)}},r$=class extends H1(YAe){constructor(t,e=15,n=10066329){super(t,e,n),this.object=t,this.added=!1,this.name=`DirectionalLightHelper: ${t.uuid}`}raycast(t,e){V1(this.object,r$.geometryHelper,t,e)}},s$=class extends H1(XAe){constructor(t,e=15,n=6710886){super(t,e,n),this.object=t,this.name=`PointLightHelper: ${t.uuid}`}raycast(t,e){V1(this.object,s$.geometryHelper,t,e)}},jI=class extends H1(WAe){constructor(t,e=6710886){super(t,e),this.object=t,this.name=`SpotLightHelper: ${t.uuid}`}raycast(t,e){V1(this.object,jI.geometryHelper,t,e)}update(){if(this.object!==void 0){let t=jI._vector,e=this.object.distance?this.object.distance:1e3,n=e*Math.tan(this.object.angle);this.cone.scale.set(n,n,e),t.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(t);let i=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let r=0,s=this.cone.material.length;r<s;r++)this.cone.material[r].color.set(i);else this.cone.material.color.set(i)}}},o$=jI;o$._vector=new N;function iFe(t,e){t.shadow.camera.right=e/2,t.shadow.camera.left=-e/2,t.shadow.camera.top=e/2,t.shadow.camera.bottom=-e/2,t.shadow.needsUpdate=!0}var rFe=class extends zF(zAe,r$){constructor(t,e,n){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.top=1250,i.bottom=-1250,i.right=1250,i.left=-1250,i.near=-1e4,i.far=2500;let r=new kA(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r}update(){this.shadow.camera.updateProjectionMatrix();for(let t in this.gizmos){let e=this.gizmos[t];e instanceof kA&&e.update()}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e);let n=t.depth!==void 0&&t.depth!==this.shadow.camera.far||t.size!==void 0&&t.size/2!==this.shadow.camera.right;t.size!==void 0&&iFe(this,t.size),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),n&&this.update()}},sFe=class extends zF(UAe,s$){constructor(t,e,n){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=90,i.aspect=1,i.near=100,i.far=2500;let r=new N(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),s=new N(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z),o=new ji(r,s),a=new zA(o,new Rt(16755200));a.visible=!1,this.gizmos.shadowmap=a,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let t in this.gizmos){let e=this.gizmos[t];if(e instanceof zA){let n=this.shadow.camera,i=new N(-n.far+this.position.x,-n.far+this.position.y,-n.far+this.position.z),r=new N(n.far+this.position.x,n.far+this.position.y,n.far+this.position.z);e.box.set(i,r),e.updateMatrixWorld(!0)}}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e),t.distance!==void 0&&(this.distance=t.distance),t.decay!==void 0&&(this.decay=t.decay),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},L6=new N,I6=new N,B6=new on,oFe=class extends zF(FAe,o$){constructor(t,e,n){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=sn.RAD2DEG*2*this.angle,i.aspect=1,i.near=100,i.far=2500;let r=new kA(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let t in this.gizmos){let e=this.gizmos[t];e instanceof kA&&e.update()}}updateMatrixWorld(t){super.updateMatrixWorld(t),I6.setFromMatrixPosition(this.matrixWorld),B6.setFromRotationMatrix(this.matrixWorld),L6.copy(this.up).applyQuaternion(B6).negate().multiplyScalar(this.distance),this.target.position.copy(I6).add(L6),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e),t.distance!==void 0&&(this.distance=t.distance),t.decay!==void 0&&(this.decay=t.decay),t.angle!==void 0&&(this.angle=t.angle),t.penumbra!==void 0&&(this.penumbra=t.penumbra),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},aFe=class extends fa{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(t,e){let n=this.geometry.getAttribute("position");n!==void 0?BF(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,t,e):super.updateEntityBoxSize(t,e)}},HF=class extends fa{constructor(t,e,n){super(t,e,n),this._shapeId=null,this._context=n}updateState(t,e){super.updateState(t,e),this.updateShape()}updateShape(){var i;let t=this.data.geometry.extrusion.shape,e;if(t.type==="Custom"){let r=t.shapeId;if(r!==this._shapeId&&this.detachShape(),r){this._shapeId=r;let s=this._context.scene.find(r);s!=null&&s.data&&(s.attachedPaths.add(this),e=(i=s.geometry.userData)==null?void 0:i.shape),e||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let r;switch(t.type){case"Rectangle":r=uZ;break;case"Ellipse":r=DF;break;case"Polygon":r=cZ;break;case"Star":r=hZ;break;default:throw new Error(`Unknown shape type: ${t.type}`)}e=r.create({parameters:t}).userData.shape}let n=this.geometry;e&&n.inputs&&(n.inputs.shapeData=e,n.build(),this.attachedSurfaceCloners.forEach(r=>r.update()))}detachShape(){var t;this._shapeId!==null&&((t=this._context.scene.find(this._shapeId))==null||t.attachedPaths.delete(this))}createGeometryDelayed(t){this.geometryCreateDeleyed=t.shared,this.updateShape(),this.refreshAttachedPaths(t)}updateTransformState(t){return super.updateTransformState(t)}updateGeometryInteractions(t,e){super.updateGeometryInteractions(t,e),this.updateShape()}updateEntityBoxSize(t,e){let n=this.geometry.getAttribute("position");n!==void 0?BF(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,t,e):super.updateEntityBoxSize(t,e)}},Ag=class extends zE(Xm,GF){constructor(t,e,n){super(),e.type==="Instance"&&typeof t=="string"&&(e=this.transformAssignData(e,n)),this.super_Entity(t,e),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(t,e){let n=e.scene.data.objects.get(t.component);if(n){let i,r;for(let s of $g.rootOverrideProps)t[s]===void 0?(i===void 0&&(i={...t}),i[s]=n.data[s]):(r===void 0&&(r={}),r[s]=t[s]);return this.overrideData=r,i??t}return t}updateByOp(t,e,n,i){let r;if(this.isInstanceRoot&&!i&&(e=this.transformAssignData(e,n),t.type===0&&t.path.length===0&&this.component))for(let s of $g.rootOverrideProps)s in t.props&&t.props[s]===void 0&&(r===void 0&&(r={...t,props:{...t.props}}),r.props[s]=this.component.data[s]);super.updateByOp(r??t,e,n,i)}updateState(t,e){this.updateState_Entity(t,e)}expandInstanceChildren(t){let e=this.data;if(this.component===void 0){this.component=t.scene.find(e.component)??null;let n=!1;if(this.component!==this.oldComponent){if(this.oldComponent){let i=0;for(let r of this.children)if(Pn.is(r))t.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(r),VF(r),i+=1;else break;this.children.splice(0,i)}n=!0}this.component&&a$(t,[this.uuid],e.overrides,this,this.component,this.component,0,n),this.oldComponent=this.component}}};function VF(t){if(t.component){let e=t.component.instances.indexOf(t);e>=0&&t.component.instances.splice(e,1);for(let n of t.children)Pn.is(n)&&VF(n)}}function O6(t,e,n,i){return t.component===e&&fF(t.identity,i)?t.overrideData===n?2:1:0}function a$(t,e,n,i,r,s,o,a){if(o>50)return!1;if(i.component!==r){if(i.component){let c=i.component.instances.indexOf(i);c>=0&&i.component.instances.splice(c,1)}r.instances.push(i),i.component=r}r instanceof Ag&&r.isInstanceRoot&&r.expandInstanceChildren(t);let l=0;for(let c of r.children)if(Pn.is(c)){let h=[...e,...typeof c.identity=="string"?[c.identity]:c.identity],u=rM.resolve(n,h,1),d=null,f;if(!a){let p=i.children[l];if(d=Pn.is(p)?p:null,d!==null){let v=O6(d,c,u,h);f=v>=1?d.stateSelection:void 0,v!==2&&(d=null)}if(d===null&&(d=t.scene.findInstance(h)??null,d!==null)){let v=O6(d,c,u,h);if(f=v>=1?d.stateSelection:void 0,v!==2)d=null;else{let g=d.parent.children.indexOf(d);d.parent.children.splice(g,1),i.children.splice(l,0,d),d.parent===i?g<=l&&console.error("not possible"):(d.parent=i,d.matrixWorldNeedsUpdate=!0,d.resetBBoxNeedsUpdate(),d.updateVisible(),t.pendingDeletes.delete(d))}}}if(d===null){let p=u?bf.apply(c.data,u):c.data;zf.is(p.type)&&(p={...p,type:"Empty"}),d=yh.createEntity(h,p,t),d.overrideData=u,i.add(d),i.children.splice(i.children.length-1,1),i.children.splice(l,0,d),d.updateState(d.data,t),f&&d.changeSelectedState(f,t),t.scene.registerInstanceAndSetUuid(d)}l+=1,a$(t,e,n,d,c,s,o+1,a)}if(!a){let c=l;for(;;){let h=i.children[l];if(Pn.is(h))t.pendingDeletes.add(h);else break;l+=1}i.children.splice(c,l-c)}return!0}function lFe(t,e,n){let i;return e.geometry.type==="TextGeometry"?new e$(t,e,n):(e.geometry.type==="SubdivGeometry"?i=new qx(t,e,n):e.geometry.type==="PathGeometry"?i=new HF(t,e,n):e.geometry.type==="VectorGeometry"?i=new aFe(t,e,n):e.geometry.type==="BooleanGeometry"?i=new tv(t,e,n):i=new fa(t,e,n),i)}function jF(t,e,n){return e.type==="Mesh"?lFe(t,e,n):e.type==="Empty"?new xM(t,e):e.type==="PointLight"?new sFe(t,e,n):e.type==="SpotLight"?new oFe(t,e,n):e.type==="DirectionalLight"?new rFe(t,e,n):e.type==="Component"||e.type==="Instance"?new Ag(t,e,n):zf.is(e.type)?new Gs(t,e):(console.error(e),new xM(t,e))}yh.createEntity=jF;function cFe(t,e,n){let i=jF(t.identity,e,n),r=t.children,s=t.attachedPaths,o=t.parent,a=t.component,l=t.instances,c=t.overrideData,h=t.uuid,u=t.stateSelection;t.dispose();for(let d of Object.keys(t))delete t[d];Object.setPrototypeOf(t,Object.getPrototypeOf(i));for(let d of Object.keys(i))t[d]=i[d];t.children=[...t.children,...r],t.attachedPaths=s,t.parent=o,t.component=a,t.instances=l,t.uuid=h,t.overrideData=c,t.updateState(t.data,n),u&&t.changeSelectedState(u,n),t.resetBBoxNeedsUpdate()}yh.changeEntityProptotype=cFe;yh.Cloner=cf;function uFe(t,e,n,i){t.updateByOp(e,n,i,!1)}function F6(t,e){let n=!1,i=e.getLayersOfType("transmission"),r=e.getLayersOfType("outline");return r.length>0&&(t.layers.set(8),i.length>0&&t.layers.enable(3),n=!0,kF(t),UF(t)),i.length===0&&r.length===0&&t.layers.set(0),n}function N6(t,e){if(!e.layers)return!1;let n=!1,i=e.getLayersOfType("transmission").filter(s=>s.data.visible),r=e.getLayersOfType("outline").filter(s=>s.data.visible);return i.length>0&&(t.layers.set(3),r.length>0&&t.layers.enable(8),n=!0),i.length===0&&r.length===0&&t.layers.set(0),n}function hFe(t){let e=!1;return t.traverseEntity(n=>{if(n instanceof kE)if(Array.isArray(n.material))for(let i=0;i<n.material.length;i++)F6(n,n.material[i])&&(e=!0);else F6(n,n.material)&&(e=!0)}),e}function dFe(t){let e=!1;return t.traverseEntity(n=>{if(n instanceof kE)if(Array.isArray(n.material))for(let i=0;i<n.material.length;i++)N6(n,n.material[i])&&(e=!0);else N6(n,n.material)&&(e=!0)}),e}var fFe=new SK,pFe=new nt,mFe=new yv;function U6(t,e,n,i=!1){let r=t.cloner;if(r)for(let s of r.children){let o=pFe.copy(s.matrixWorld).invert(),a=mFe.copy(e.ray).applyMatrix4(o),l=t.matrixWorld;a.applyMatrix4(l);let c=fFe;c.set(a.origin,a.direction),c.near=e.near,c.far=e.far;let h=c.intersectObject(t,!1);h.length>0&&n.push({...h[0],object:i?s:t})}}var gFe=t=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${t};
const int gShadowSamples = ${t};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

vec2 vogelDiskSample(int sample_index, int sample_count, float angle)
{
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sample_index) + 0.5f) / sqrt(float(sample_count));
  float theta = float(sample_index) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// NOTE: For now we aren't using this screen-space noise. But we should enable
// it again once we do some sort of temporal AA. Then we could potentially lower
// the number of samples needed and still get a pretty smooth result.
// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos)
{
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

vec4 shadowmod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}
vec4 shadowperm(vec4 x){return shadowmod289(((x * 34.0) + 1.0) * x);}
float shadowNoise(vec3 p){
            vec3 a = floor(p);
            vec3 d = p - a;
            d = d * d * (3.0 - 2.0 * d);
            vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
            vec4 k1 = shadowperm(b.xyxy);
            vec4 k2 = shadowperm(k1.xyxy + b.zzww);
            vec4 c = k2 + a.zzzz;
            vec4 k3 = shadowperm(c);
            vec4 k4 = shadowperm(c + 1.0);
            vec4 o1 = fract(k3 * (1.0 / 41.0));
            vec4 o2 = fract(k4 * (1.0 / 41.0));
            vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
            vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
            return o4.y * d.y + o4.x * (1.0 - d.y);
        }

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;
    float temporalOffset = shadowNoise(floor(vWPosition * 10.));

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    //float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        float temporalOffset = shadowNoise(floor(vWPosition * 10.));
        float temporalAngle  = temporalOffset * PI2;


        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,vFe=jt.lights_fragment_begin,yFe=jt.shadowmask_pars_fragment,k6=!1,xFe=t=>{switch(t){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},wFe=(t="medium")=>{if(k6)return;k6=!0;let e=xFe(t);jt.shadowmap_pars_fragment=gFe(e);let n=vFe.slice();n=n.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),n=n.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),jt.lights_fragment_begin=n;let i=yFe.slice();i=i.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),jt.shadowmask_pars_fragment=i},_Fe=`
attribute vec3 randomColor;
varying vec3 vNormal;
flat out vec3 vColor;

void main()
{
vNormal = normal;
vColor = randomColor;
gl_Position = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
}
`,bFe=`
uniform float depthContrast;
varying vec3 vNormal;
flat in vec3 vColor;
void main()
{
vec3 normal = (normalize(vNormal)).rgb;

float contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;

vec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);
gl_FragColor = vec4(resultColor, vColor.r);
}
`,rD=new ir({vertexShader:_Fe,fragmentShader:bFe,uniforms:{depthContrast:{value:1}}}),SFe=class{constructor(){this._constraints=new Map}setConstraint(t,e){e===null?this._constraints.delete(t):this._constraints.set(t,e)}removeDependencies(t){this._constraints.delete(t)}applyConstraints(t){let e=new Set;this._constraints.forEach((n,i)=>{let r=[i,n],s=n;for(;this._constraints.has(s);)s=this._constraints.get(s),e.has(s)||r.push(s);for(let o=r.length-2;o>=0;o--)if(!e.has(r[o])){let a=t.find(r[o]);a?a.applyPathSnapping(t):console.warn(`missing entity ${r[o]}`),e.add(r[o])}})}findDependency(t,e){let n=t;for(;this._constraints.has(n);)if(n=this._constraints.get(n),n===e)return!0;return!1}},WI=new N1;WI.wireframe=!0;var z6=new N,l$=class extends _f{constructor(t,e){super(),this.data=t,this.backupFog=new lK(16777215,.1,2e3),this.fogUseBGColor=!1,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.bgColor=new zs(1,1,1,1),this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new SFe,this.needsRecomputeInstances=!1,this.ambientLight=new BAe(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.personalCamera=this.createPersonalCamera(),this.activeCamera=this.personalCamera,this.postprocessing=t.postprocessing,this.init(t,e),this.matrixAutoUpdate=!1}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=dFe(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=hFe(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(t){let e=t.identity.join("-"),n=this.entityIdentityToEntity[e];n&&(t.uuid=n.uuid),this.entityIdentityToEntity[e]=t,this.entityByUuid[t.uuid]=t}findInstance(t){return this.entityIdentityToEntity[t.join("-")]}getWithSortKey(t){let e=this.find(t);if(e===void 0)return;let n=[],i=e;for(;i!==this;){let r=i;i=i.parent;let s=i.children.indexOf(r);n.splice(0,0,s)}return{entity:e,sortKey:n}}getAllSorted(t){let e=[];for(let n of t){let i=this.getWithSortKey(n.id);i!==void 0&&e.push(i)}return e.sort((n,i)=>VLe(n.sortKey,i.sortKey)),e.map(n=>n.entity)}nonExistOrDescendantOf(t,e){let n=this.find(t);if(n===void 0)return!0;for(;n;){if(n.uuid===e)return!0;n=n.parent}return!1}find(t){if(t===""||t===void 0)return;let e=this.entityByUuid[t];return e===void 0?this.getObjectByProperty("uuid",t):e}debugEnsureEntity(t){let e=this.find(t);if(e){if(Array.isArray(e.identity)&&this.findInstance(e.identity)===void 0){console.error("not found instance");debugger}}else{console.error("not found");debugger}}addPendingExpandCloner(t){this.toExpandCloner.add(t)}addPendingUpdateCloner(t){this.toUpdateCloner.add(t)}markToExpandCloner(t){this.toExpandCloner.add(t),t.traverseEntityAncestors(e=>{this.toExpandCloner.add(e)})}doPendingExpandCloner(){this.toExpandCloner.forEach(t=>{t.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(t=>{var e;(e=t.cloner)==null||e.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(t){this.pendingCommands.push(t)}applyPendingCommands(){this.pendingCommands.forEach(t=>t()),this.pendingCommands.length=0}updateTreeByOp(t,e){var n;if(t.path.length===0&&t.type===7){let i=t.parent===null?this:this.find(t.parent);if(i===void 0)throw new Error("unexpected");let r=this.createObject(t.id,t.data,t.children,i,t.localIndex,e);r.updateVisible(),r.resetBBoxNeedsUpdate(),kl(r)&&Xc(r.parent)&&(r.invalidateUpstreamBooleanData(),r.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(i),this.markNeedsRecomputeInstancesForChildren(r),this.markToExpandCloner(r)}else if(t.path.length===0&&t.type===8){let i=this.find(t.id);if(i===void 0)throw new Error("unexpected");this.markToExpandCloner(i),i.resetBBoxNeedsUpdate(),this.unregisterObject(i);let r=i.parent;this.markNeedsRecomputeInstancesForAncessors(r),this.markNeedsRecomputeInstancesForChildren(i),i.parent.remove(i),Xc(i.parent)&&(i.parent.invalidateUpstreamBooleanData(),i.parent.invalidateDownstreamBooleanData().recomputeBoolean()),kl(i)&&(i.freeBooleanPointer(),r instanceof tv&&r.invalidateDownstreamBooleanData().recomputeBoolean()),i instanceof HF&&i.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(i),this.pathConstraints.removeDependencies(i.uuid)}else if(t.path.length===0&&t.type===9){let i=this.find(t.id);if(i===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(i);let r=i.parent;this.markNeedsRecomputeInstancesForAncessors(r),(n=i.cloner)==null||n.resetOnMove(),this.markToExpandCloner(i);let s=t.parent===null?this:this.find(t.parent);if(s===void 0)throw new Error("unexpected");s.add(i),this.markNeedsRecomputeInstancesForAncessors(s),this.markToExpandCloner(i),i.invalidateClonerTransform(i),i.updateVisible(),i.resetBBoxNeedsUpdate();let o=t.localIndex;s.children.splice(o,0,s.children.pop()),kl(i)&&(i.invalidateUpstreamBooleanData(),Xc(i.parent)?i.parent.invalidateDownstreamBooleanData().recomputeBoolean():r instanceof tv&&r.invalidateDownstreamBooleanData().recomputeBoolean())}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}updateEntityByOp(t,e,n,i){if(e.type===0){if(("overrides"in e.props||"component"in e.props)&&this.markNeedsRecomputeInstances(),e.path.includes("overrides")&&"states"in e.props){let{states:s,rest:o}=e.props;e={...e,props:o},this.markNeedsRecomputeInstances()}e.path[0]==="pathSnapping"&&e.props.pathId!==void 0&&this.pathConstraints.setConstraint(t,e.props.pathId)}let r=this.find(t);if(r)try{uFe(r,e,n,{scene:this,shared:i}),r instanceof fa&&r.updateGeometryGroupsIfNeeded()}catch(s){console.error(s)}}get enableFog(){return this.fog!==null}set enableFog(t){this.fog=t===!0?this.backupFog:null}init(t,e){if(this.createChildrenObjects(t.objects,this,e),this.personalCamera.removeFromParent(),this.add(this.personalCamera),this.ambientLight.removeFromParent(),this.add(this.ambientLight),this.setBackgroundColor(po(t.backgroundColor,e)),this.updateFog(t.fog,e),this.updateAmbientLight(t.environment.ambientLight,e),this.activeCamera=this.personalCamera,t.publish.playCamera!==null){let n=this.find(t.publish.playCamera);n instanceof Gs&&this.switchActiveCamera(n)}this.expandInstances(e,!0),this.traverseEntity(n=>{Xc(n)&&n.recomputeBoolean(),n instanceof Gs&&n.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(t){t.traverseEntity(e=>{(e.data.type==="Component"||e.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(t){Pn.is(t)&&(t.data.type==="Component"&&this.markNeedsRecomputeInstances(),t.traverseAncestors(e=>{Pn.is(e)&&e.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(t,e,n,i,r,s,o){t&&t!==i.uuid&&i.find(t)&&r.forInstancesRec(a=>{a.isInstanceRoot||(a.data=qA(a.data,l=>{let c=l.events.data(o.id),h=a.goUp(s);if(h){let u=[...FJ(h.identity),t].join("-"),d=this.entityIdentityToEntity[u];if(d){let f=d.uuid;Ql.zoom(c,e)[n]=f}else console.warn("cannot find instance")}}).data)})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(t=>{if(t instanceof Ag&&typeof t.identity=="string"&&t.data.type==="Component")return t.traverseEntity((e,n)=>{e.data.events.forEach(i=>{i.data.type==="GameControl"?e.forInstancesRec(r=>{r.isInstanceRoot||(r.data=qA(r.data,s=>{s.events.delete(i.id)}).data)}):i.data.type==="Conditional"?(i.data.condition.type==="Distance"?(this.relativeizeInner(i.data.condition.fromObject,["condition"],"fromObject",t,e,n,i),this.relativeizeInner(i.data.condition.toObject,["condition"],"toObject",t,e,n,i)):i.data.condition.type==="State"?this.relativeizeInner(i.data.condition.object,["condition"],"object",t,e,n,i):i.data.condition.type==="Comparison"&&(i.data.condition.lOperand.type==="Property"&&this.relativeizeInner(i.data.condition.lOperand.value[0],["condition","lOperand","value"],0,t,e,n,i),i.data.condition.rOperand.type==="Property"&&this.relativeizeInner(i.data.condition.rOperand.value[0],["condition","rOperand","value"],0,t,e,n,i)),i.data.inActions.forEach(r=>{r.data.type==="Transition"&&this.relativeizeInner(r.data.object,["inActions",r.id],"object",t,e,n,i)}),i.data.outActions.forEach(r=>{r.data.type==="Transition"&&this.relativeizeInner(r.data.object,["outActions",r.id],"object",t,e,n,i)})):"actions"in i.data&&i.data.actions.forEach(r=>{r.data.type==="Transition"&&this.relativeizeInner(r.data.object,["actions",r.id],"object",t,e,n,i)})})}),!0})}expandInstances(t,e){let n=new Set;this.traverseEntity(i=>{if(i instanceof Ag&&i.isInstanceRoot)return i.expandInstanceChildren({scene:this,shared:t,pendingDeletes:n}),e||i.resetBBoxNeedsUpdate(),!0});for(let i of n)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(i),VF(i)}recomputeInstances(t){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(e=>{e instanceof Ag&&e.isInstanceRoot&&(e.component=void 0)}),this.expandInstances(t,!1))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(t){t.traverseEntity(e=>{let n=typeof e.identity=="string"?e.identity:e.identity.join("-");this.entityIdentityToEntity[n]===e&&(delete this.entityByUuid[e.uuid],delete this.entityIdentityToEntity[n]),e.dispose()})}clearScene(){for(let t of this.children)Pn.is(t)&&t.disposeRecursively();this.children.length=0}resetAfterClear(t,e){this.init(t,e)}createPersonalCamera(){let t=new Gs(l$.PERSONAL_CAMERA_ID,{...iM.defaultData,name:"Personal Camera"});return t.objectHelper.visible=!1,this.registerObjectCreatedInLegacy(t),t}raycast(t){let e=[],n=i=>{for(let r of i.children){let s=r.cloner;Pn.is(r)&&!r.raycastLock&&(r.visible||s!=null&&s.object.data.visible)&&((kl(r)||R6(r)&&this.enableHelpers&&r.objectHelper.visible)&&(t.intersectObject(r,!1,e),U6(r,t,e)),n(r))}};return n(this),e}raycastWithClones(t){let e=[],n=i=>{for(let r of i.children){let s=r.cloner;Pn.is(r)&&!r.raycastLock&&(r.visible||s!=null&&s.object.data.visible)&&((kl(r)||R6(r)&&this.enableHelpers&&r.objectHelper.visible)&&(t.intersectObject(r,!1,e),U6(r,t,e,!0)),n(r))}};return n(this),e}forEachEntity(t){for(let e of this.children)Pn.is(e)&&t(e)}traverseEntity(t){for(let e of this.children)Pn.is(e)&&e.traverseEntity(t)}traverseObject(t){for(let e of this.children)fM.is(e)&&e.traverseObject(t)}traverseVisibleEntity(t){for(let e of this.children)Pn.is(e)&&e.visible&&e.traverseVisibleEntity(t)}updateFog(t,e){this.enableFog=t.enabled,this.fogUseBGColor=t.useBackgroundColor,t.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=po(t.color,e),this.backupFog.near=t.near,this.backupFog.far=t.far}dispose(){this.clearScene()}updateAmbientLight(t,e){t.color!==void 0&&(this.ambientLight.color=po(t.color,e)),t.intensity!==void 0&&(this.ambientLight.intensity=t.intensity),t.groundColor!==void 0&&(this.ambientLight.groundColor=po(t.groundColor,e)),t.enabled!==void 0&&(this.ambientLight.visible=t.enabled)}switchActiveCamera(t){this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=t,t.objectHelper.visible=!1}setBackgroundColor(t){this.bgColor=t,this.fogUseBGColor===!0&&(this.backupFog.color=t)}createChildrenObjects(t,e,n){let i=0;for(let r of t)this.createObject(r.id,r.data,r.children,e,i,n),i+=1}registerObjectCreatedInLegacy(t){this.entityByUuid[t.uuid]=t}unregisterObject(t){delete this.entityByUuid[t.uuid];for(let e of t.children)this.unregisterObject(e)}createObject(t,e,n,i,r,s){var l;let o={scene:this,shared:s},a=jF(t,e,o);return a&&(this.entityByUuid[t]=a,i.add(a),i.children.splice(r,0,i.children.pop()),n.length>0&&(a.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(n,a,s)),a.updateState(e,o),a instanceof fa&&a.updateGeometryGroupsIfNeeded(),a.updateVisible(),a.cloner&&this.toExpandCloner.add(a),(l=e.pathSnapping)!=null&&l.pathId&&this.pathConstraints.setConstraint(t,e.pathSnapping.pathId)),a}getCenter(t){let e=[];for(let i=0,r=t.length;i<r;++i){let{id:s,recursive:o}=t[i],a=this.find(s),l=o?a.recursiveBBox:a.singleBBox;e.push(...l.vertices)}let n=new ji;return n.setFromPoints(e),n.getCenter(z6),z6}copyMatrixWorld(t,e){if(t===null){e.identity();return}let n=this.find(t);n?e.copy(n.matrixWorld):e.identity()}copyParentMatrixWorld(t,e){var i;if(t===null){e.identity();return}let n=(i=this.find(t))==null?void 0:i.parent;n?e.copy(n.matrixWorld):e.identity()}traverseMaterial(t){this.traverseEntity(e=>{if(e instanceof Vs)if(Array.isArray(e.material))for(let n=0;n<e.material.length;n++)e.material[n]instanceof Kh&&t(e.material[n]);else e.material instanceof Kh&&t(e.material)})}updateCanvasSize(t,e){this.activeCamera.setViewplaneSize(t,e);let n,i;t>=e?(n=e/t,i=1):(n=1,i=t/e),this.traverseMaterial(r=>{r.getLayersOfType("transmission").forEach(s=>{s.uniforms[`f${s.id}_aspectRatio`].value.x=n,s.uniforms[`f${s.id}_aspectRatio`].value.y=i})})}},Kl=l$;Kl.PERSONAL_CAMERA_ID="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera",Kl.PERSONAL_CAMERA_EXPORT_ID="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCameraExport";var HS=(t,e)=>{let n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)},AFe=(t,e)=>{let n=e.x-t.x,i=e.y-t.y;return EFe(Math.atan2(i,n))},MFe=(t,e,n)=>{let i={x:0,y:0};return n=XI(n),i.x=t.x-e*Math.cos(n),i.y=t.y-e*Math.sin(n),i},XI=t=>t*(Math.PI/180),EFe=t=>t*(180/Math.PI),CFe=t=>isNaN(t.buttons)?t.pressure!==0:t.buttons!==0,sD=new Map,G6=t=>{sD.has(t)&&clearTimeout(sD.get(t)),sD.set(t,setTimeout(t,100))},wM=(t,e,n)=>{let i=e.split(/[ ,]+/g),r;for(let s=0;s<i.length;s+=1)r=i[s],t.addEventListener?t.addEventListener(r,n,!1):t.attachEvent&&t.attachEvent(r,n)},H6=(t,e,n)=>{let i=e.split(/[ ,]+/g),r;for(let s=0;s<i.length;s+=1)r=i[s],t.removeEventListener?t.removeEventListener(r,n):t.detachEvent&&t.detachEvent(r,n)},c$=t=>(t.preventDefault(),t.type.match(/^touch/)?t.changedTouches:t),V6=()=>{if(typeof window>"u")return;let t=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,e=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:t,y:e}},YI=(t,e)=>{e.top||e.right||e.bottom||e.left?(t.style.top=e.top,t.style.right=e.right,t.style.bottom=e.bottom,t.style.left=e.left):(t.style.left=e.x+"px",t.style.top=e.y+"px")},WF=(t,e,n)=>{let i=u$(t);for(let r in i)if(i.hasOwnProperty(r))if(typeof e=="string")i[r]=e+" "+n;else{let s="";for(let o=0,a=e.length;o<a;o+=1)s+=e[o]+" "+n+", ";i[r]=s.slice(0,-2)}return i},TFe=(t,e)=>{let n=u$(t);for(let i in n)n.hasOwnProperty(i)&&(n[i]=e);return n},u$=t=>{let e={};return e[t]="",["webkit","Moz","o"].forEach(function(n){e[n+t.charAt(0).toUpperCase()+t.slice(1)]=""}),e},oD=(t,e)=>{for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},PFe=(t,e)=>{let n={};for(let i in t)t.hasOwnProperty(i)&&e.hasOwnProperty(i)?n[i]=e[i]:t.hasOwnProperty(i)&&(n[i]=t[i]);return n},qI=(t,e)=>{if(t.length)for(let n=0,i=t.length;n<i;n+=1)e(t[n]);else e(t)},DFe=(t,e,n)=>({x:Math.min(Math.max(t.x,e.x-n),e.x+n),y:Math.min(Math.max(t.y,e.y-n),e.y+n)});typeof window<"u"&&(h$="ontouchstart"in window,d$=!!window.PointerEvent,f$=!!window.MSPointerEvent);var h$,d$,f$,X0={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},Zm,Qx={};d$?Zm=X0.pointer:f$?Zm=X0.MSPointer:h$?(Zm=X0.touch,Qx=X0.mouse):Zm=X0.mouse;function np(){}np.prototype.on=function(t,e){var n=this,i=t.split(/[ ,]+/g),r;n._handlers_=n._handlers_||{};for(var s=0;s<i.length;s+=1)r=i[s],n._handlers_[r]=n._handlers_[r]||[],n._handlers_[r].push(e);return n};np.prototype.off=function(t,e){var n=this;return n._handlers_=n._handlers_||{},t===void 0?n._handlers_={}:e===void 0?n._handlers_[t]=null:n._handlers_[t]&&n._handlers_[t].indexOf(e)>=0&&n._handlers_[t].splice(n._handlers_[t].indexOf(e),1),n};np.prototype.trigger=function(t,e){var n=this,i=t.split(/[ ,]+/g),r;n._handlers_=n._handlers_||{};for(var s=0;s<i.length;s+=1)r=i[s],n._handlers_[r]&&n._handlers_[r].length&&n._handlers_[r].forEach(function(o){o.call(n,{type:r,target:n},e)})};np.prototype.config=function(t){var e=this;e.options=e.defaults||{},t&&(e.options=PFe(e.options,t))};np.prototype.bindEvt=function(t,e){var n=this;return n._domHandlers_=n._domHandlers_||{},n._domHandlers_[e]=function(){typeof n["on"+e]=="function"?n["on"+e].apply(n,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},wM(t,Zm[e],n._domHandlers_[e]),Qx[e]&&wM(t,Qx[e],n._domHandlers_[e]),n};np.prototype.unbindEvt=function(t,e){var n=this;return n._domHandlers_=n._domHandlers_||{},H6(t,Zm[e],n._domHandlers_[e]),Qx[e]&&H6(t,Qx[e],n._domHandlers_[e]),delete n._domHandlers_[e],this};var XF=np;function or(t,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=t,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(e),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=or.id,or.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}or.prototype=new XF;or.constructor=or;or.id=0;or.prototype.buildEl=function(t){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};or.prototype.stylize=function(){if(this.options.dataOnly)return this;var t=this.options.fadeTime+"ms",e=TFe("borderRadius","50%"),n=WF("transition","opacity",t),i={};return i.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},i.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},i.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},oD(i.el,n),this.options.shape==="circle"&&oD(i.back,e),oD(i.front,e),this.applyStyles(i),this};or.prototype.applyStyles=function(t){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var n in t[e])this.ui[e].style[n]=t[e][n];return this};or.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};or.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};or.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};or.prototype.show=function(t){var e=this;return e.options.dataOnly||(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),typeof t=="function"&&t.call(this)},e.options.fadeTime)),e};or.prototype.hide=function(t){var e=this;if(e.options.dataOnly)return e;if(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var n=e.options.mode==="dynamic"?"none":"block";e.ui.el.style.display=n,typeof t=="function"&&t.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick){let n=e.options.restJoystick,i={};i.x=n===!0||n.x!==!1?0:e.instance.frontPosition.x,i.y=n===!0||n.y!==!1?0:e.instance.frontPosition.y,e.setPosition(t,i)}return e};or.prototype.setPosition=function(t,e){var n=this;n.frontPosition={x:e.x,y:e.y};var i=n.options.fadeTime+"ms",r={};r.front=WF("transition",["top","left"],i);var s={front:{}};s.front={left:n.frontPosition.x+"px",top:n.frontPosition.y+"px"},n.applyStyles(r),n.applyStyles(s),n.restTimeout=setTimeout(function(){typeof t=="function"&&t.call(n),n.restCallback()},n.options.fadeTime)};or.prototype.restCallback=function(){var t=this,e={};e.front=WF("transition","none",""),t.applyStyles(e),t.trigger("rested",t.instance)};or.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};or.prototype.computeDirection=function(t){var e=t.angle.radian,n=Math.PI/4,i=Math.PI/2,r,s,o;if(e>n&&e<n*3&&!t.lockX?r="up":e>-n&&e<=n&&!t.lockY?r="left":e>-n*3&&e<=-n&&!t.lockX?r="down":t.lockY||(r="right"),t.lockY||(e>-i&&e<i?s="left":s="right"),t.lockX||(e>0?o="up":o="down"),t.force>this.options.threshold){var a={},l;for(l in this.direction)this.direction.hasOwnProperty(l)&&(a[l]=this.direction[l]);var c={};this.direction={x:s,y:o,angle:r},t.direction=this.direction;for(l in a)a[l]===this.direction[l]&&(c[l]=!0);if(c.x&&c.y&&c.angle)return t;(!c.x||!c.y)&&this.trigger("plain",t),c.x||this.trigger("plain:"+s,t),c.y||this.trigger("plain:"+o,t),c.angle||this.trigger("dir dir:"+r,t)}else this.resetDirection();return t};var RFe=or;function Ri(t,e){var n=this;n.nipples=[],n.idles=[],n.actives=[],n.ids=[],n.pressureIntervals={},n.manager=t,n.id=Ri.id,Ri.id+=1,n.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},n.config(e),(n.options.mode==="static"||n.options.mode==="semi")&&(n.options.multitouch=!1),n.options.multitouch||(n.options.maxNumberOfNipples=1);let i=getComputedStyle(n.options.zone.parentElement);return i&&i.display==="flex"&&(n.parentIsFlex=!0),n.updateBox(),n.prepareNipples(),n.bindings(),n.begin(),n.nipples}Ri.prototype=new XF;Ri.constructor=Ri;Ri.id=0;Ri.prototype.prepareNipples=function(){var t=this,e=t.nipples;e.on=t.on.bind(t),e.off=t.off.bind(t),e.options=t.options,e.destroy=t.destroy.bind(t),e.ids=t.ids,e.id=t.id,e.processOnMove=t.processOnMove.bind(t),e.processOnEnd=t.processOnEnd.bind(t),e.get=function(n){if(n===void 0)return e[0];for(var i=0,r=e.length;i<r;i+=1)if(e[i].identifier===n)return e[i];return!1}};Ri.prototype.bindings=function(){var t=this;t.bindEvt(t.options.zone,"start"),t.options.zone.style.touchAction="none",t.options.zone.style.msTouchAction="none"};Ri.prototype.begin=function(){var t=this,e=t.options;if(e.mode==="static"){var n=t.createNipple(e.position,t.manager.getIdentifier());n.add(),t.idles.push(n)}};Ri.prototype.createNipple=function(t,e){var n=this,i=n.manager.scroll,r={},s=n.options,o={x:n.parentIsFlex?i.x:i.x+n.box.left,y:n.parentIsFlex?i.y:i.y+n.box.top};if(t.x&&t.y)r={x:t.x-o.x,y:t.y-o.y};else if(t.top||t.right||t.bottom||t.left){var a=document.createElement("DIV");a.style.display="hidden",a.style.top=t.top,a.style.right=t.right,a.style.bottom=t.bottom,a.style.left=t.left,a.style.position="absolute",s.zone.appendChild(a);var l=a.getBoundingClientRect();s.zone.removeChild(a),r=t,t={x:l.left+i.x,y:l.top+i.y}}var c=new RFe(n,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:e,position:t,zone:s.zone,frontPosition:{x:0,y:0},shape:s.shape});return s.dataOnly||(YI(c.ui.el,r),YI(c.ui.front,c.frontPosition)),n.nipples.push(c),n.trigger("added "+c.identifier+":added",c),n.manager.trigger("added "+c.identifier+":added",c),n.bindNipple(c),c};Ri.prototype.updateBox=function(){var t=this;t.box=t.options.zone.getBoundingClientRect()};Ri.prototype.bindNipple=function(t){var e=this,n,i=function(r,s){n=r.type+" "+s.id+":"+r.type,e.trigger(n,s)};t.on("destroyed",e.onDestroyed.bind(e)),t.on("shown hidden rested dir plain",i),t.on("dir:up dir:right dir:down dir:left",i),t.on("plain:up plain:right plain:down plain:left",i)};Ri.prototype.pressureFn=function(t,e,n){var i=this,r=0;clearInterval(i.pressureIntervals[n]),i.pressureIntervals[n]=setInterval(function(){var s=t.force||t.pressure||t.webkitForce||0;s!==r&&(e.trigger("pressure",s),i.trigger("pressure "+e.identifier+":pressure",s),r=s)}.bind(i),100)};Ri.prototype.onstart=function(t){var e=this,n=e.options,i=t;t=c$(t),e.updateBox();var r=function(s){e.actives.length<n.maxNumberOfNipples?e.processOnStart(s):i.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(o){if(Object.values(i.touches).findIndex(function(l){return l.identifier===o})<0){var a=[t[0]];a.identifier=o,e.processOnEnd(a)}}),e.actives.length<n.maxNumberOfNipples&&e.processOnStart(s))};return qI(t,r),e.manager.bindDocument(),!1};Ri.prototype.processOnStart=function(t){var e=this,n=e.options,i,r=e.manager.getIdentifier(t),s=t.force||t.pressure||t.webkitForce||0,o={x:t.pageX,y:t.pageY},a=e.getOrCreate(r,o);a.identifier!==r&&e.manager.removeIdentifier(a.identifier),a.identifier=r;var l=function(h){h.trigger("start",h),e.trigger("start "+h.id+":start",h),h.show(),s>0&&e.pressureFn(t,h,h.identifier),e.processOnMove(t)};if((i=e.idles.indexOf(a))>=0&&e.idles.splice(i,1),e.actives.push(a),e.ids.push(a.identifier),n.mode!=="semi")l(a);else{var c=HS(o,a.position);if(c<=n.catchDistance)l(a);else{a.destroy(),e.processOnStart(t);return}}return a};Ri.prototype.getOrCreate=function(t,e){var n=this,i=n.options,r;return/(semi|static)/.test(i.mode)?(r=n.idles[0],r?(n.idles.splice(0,1),r):i.mode==="semi"?n.createNipple(e,t):(console.warn("Coudln't find the needed nipple."),!1)):(r=n.createNipple(e,t),r)};Ri.prototype.processOnMove=function(t){var e=this,n=e.options,i=e.manager.getIdentifier(t),r=e.nipples.get(i),s=e.manager.scroll;if(!CFe(t)){this.processOnEnd(t);return}if(!r){console.error("Found zombie joystick with ID "+i),e.manager.removeIdentifier(i);return}if(n.dynamicPage){var o=r.el.getBoundingClientRect();r.position={x:s.x+o.left,y:s.y+o.top}}r.identifier=i;var a=r.options.size/2,l={x:t.pageX,y:t.pageY};n.lockX&&(l.y=r.position.y),n.lockY&&(l.x=r.position.x);var c=HS(l,r.position),h=AFe(l,r.position),u=XI(h),d=c/a,f={distance:c,position:l},p,v;if(r.options.shape==="circle"?(p=Math.min(c,a),v=MFe(r.position,p,h)):(v=DFe(l,r.position,a),p=HS(v,r.position)),n.follow){if(c>a){let w=l.x-v.x,b=l.y-v.y;r.position.x+=w,r.position.y+=b,r.el.style.top=r.position.y-(e.box.top+s.y)+"px",r.el.style.left=r.position.x-(e.box.left+s.x)+"px",c=HS(l,r.position)}}else l=v,c=p;var g=l.x-r.position.x,m=l.y-r.position.y;r.frontPosition={x:g,y:m},n.dataOnly||YI(r.ui.front,r.frontPosition);var y={identifier:r.identifier,position:l,force:d,pressure:t.force||t.pressure||t.webkitForce||0,distance:c,angle:{radian:u,degree:h},vector:{x:g/a,y:-m/a},raw:f,instance:r,lockX:n.lockX,lockY:n.lockY};y=r.computeDirection(y),y.angle={radian:XI(180-h),degree:180-h},r.trigger("move",y),e.trigger("move "+r.id+":move",y)};Ri.prototype.processOnEnd=function(t){var e=this,n=e.options,i=e.manager.getIdentifier(t),r=e.nipples.get(i),s=e.manager.removeIdentifier(r.identifier);!r||(n.dataOnly||r.hide(function(){n.mode==="dynamic"&&(r.trigger("removed",r),e.trigger("removed "+r.id+":removed",r),e.manager.trigger("removed "+r.id+":removed",r),r.destroy())}),clearInterval(e.pressureIntervals[r.identifier]),r.resetDirection(),r.trigger("end",r),e.trigger("end "+r.id+":end",r),e.ids.indexOf(r.identifier)>=0&&e.ids.splice(e.ids.indexOf(r.identifier),1),e.actives.indexOf(r)>=0&&e.actives.splice(e.actives.indexOf(r),1),/(semi|static)/.test(n.mode)?e.idles.push(r):e.nipples.indexOf(r)>=0&&e.nipples.splice(e.nipples.indexOf(r),1),e.manager.unbindDocument(),/(semi|static)/.test(n.mode)&&(e.manager.ids[s.id]=s.identifier))};Ri.prototype.onDestroyed=function(t,e){var n=this;n.nipples.indexOf(e)>=0&&n.nipples.splice(n.nipples.indexOf(e),1),n.actives.indexOf(e)>=0&&n.actives.splice(n.actives.indexOf(e),1),n.idles.indexOf(e)>=0&&n.idles.splice(n.idles.indexOf(e),1),n.ids.indexOf(e.identifier)>=0&&n.ids.splice(n.ids.indexOf(e.identifier),1),n.manager.removeIdentifier(e.identifier),n.manager.unbindDocument()};Ri.prototype.destroy=function(){var t=this;t.unbindEvt(t.options.zone,"start"),t.nipples.forEach(function(n){n.destroy()});for(var e in t.pressureIntervals)t.pressureIntervals.hasOwnProperty(e)&&clearInterval(t.pressureIntervals[e]);t.trigger("destroyed",t.nipples),t.manager.unbindDocument(),t.off()};var LFe=Ri;function Sr(t){var e=this;e.ids={},e.index=0,e.collections=[],e.scroll=V6(),e.config(t),e.prepareCollections();var n=function(){var r;e.collections.forEach(function(s){s.forEach(function(o){r=o.el.getBoundingClientRect(),o.position={x:e.scroll.x+r.left,y:e.scroll.y+r.top}})})};if(typeof window>"u")return e.collections;wM(window,"resize",function(){G6(n)});var i=function(){e.scroll=V6()};return wM(window,"scroll",function(){G6(i)}),e.collections}Sr.prototype=new XF;Sr.constructor=Sr;Sr.prototype.prepareCollections=function(){var t=this;t.collections.create=t.create.bind(t),t.collections.on=t.on.bind(t),t.collections.off=t.off.bind(t),t.collections.destroy=t.destroy.bind(t),t.collections.get=function(e){var n;return t.collections.every(function(i){return n=i.get(e),!n}),n}};Sr.prototype.create=function(t){return this.createCollection(t)};Sr.prototype.createCollection=function(t){var e=this,n=new LFe(e,t);return e.bindCollection(n),e.collections.push(n),n};Sr.prototype.bindCollection=function(t){var e=this,n,i=function(r,s){n=r.type+" "+s.id+":"+r.type,e.trigger(n,s)};t.on("destroyed",e.onDestroyed.bind(e)),t.on("shown hidden rested dir plain",i),t.on("dir:up dir:right dir:down dir:left",i),t.on("plain:up plain:right plain:down plain:left",i)};Sr.prototype.bindDocument=function(){var t=this;t.binded||(t.bindEvt(document,"move").bindEvt(document,"end"),t.binded=!0)};Sr.prototype.unbindDocument=function(t){var e=this;(!Object.keys(e.ids).length||t===!0)&&(e.unbindEvt(document,"move").unbindEvt(document,"end"),e.binded=!1)};Sr.prototype.getIdentifier=function(t){var e;return t?(e=t.identifier===void 0?t.pointerId:t.identifier,e===void 0&&(e=this.latest||0)):e=this.index,this.ids[e]===void 0&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]};Sr.prototype.removeIdentifier=function(t){var e={};for(var n in this.ids)if(this.ids[n]===t){e.id=n,e.identifier=this.ids[n],delete this.ids[n];break}return e};Sr.prototype.onmove=function(t){var e=this;return e.onAny("move",t),!1};Sr.prototype.onend=function(t){var e=this;return e.onAny("end",t),!1};Sr.prototype.oncancel=function(t){var e=this;return e.onAny("end",t),!1};Sr.prototype.onAny=function(t,e){var n=this,i,r="processOn"+t.charAt(0).toUpperCase()+t.slice(1);e=c$(e);var s=function(a,l,c){c.ids.indexOf(l)>=0&&(c[r](a),a._found_=!0)},o=function(a){i=n.getIdentifier(a),qI(n.collections,s.bind(null,a,i)),a._found_||n.removeIdentifier(i)};return qI(e,o),!1};Sr.prototype.destroy=function(){var t=this;t.unbindDocument(!0),t.ids={},t.index=0,t.collections.forEach(function(e){e.destroy()}),t.off()};Sr.prototype.onDestroyed=function(t,e){var n=this;if(n.collections.indexOf(e)<0)return!1;n.collections.splice(n.collections.indexOf(e),1)};var IFe=Sr,j6=new IFe,BFe={create:function(t){return j6.create(t)},factory:j6},OFe=B1(zQ());function cm(t,e){let n=new Lt;if(!t.getAttribute("position"))return n.setAttribute("position",new ft([],3)),n.setIndex([]),n;let{positions:i,triIndices:r}=IF(t.getAttribute("position"),t.getIndex());return n.setAttribute("position",new ft(i,3)),n.setIndex(r),e&&n.applyMatrix4(e),n}var FFe=new nt,NFe=new nt,Ml=[[0,0,0],[0,0,0],[0,0,0]];function p$(t){let e=t.elements;Ml[0][0]=e[0],Ml[0][1]=e[4],Ml[0][2]=e[8],Ml[1][0]=e[1],Ml[1][1]=e[5],Ml[1][2]=e[9],Ml[2][0]=e[2],Ml[2][1]=e[6],Ml[2][2]=e[10];let{u:n,v:i}=(0,OFe.SVD)(Ml),r=FFe.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),s=NFe.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1);return r.multiply(s.transpose())}var UFe=class extends SK{constructor(){super(),this.layers.enable(3),this.layers.enable(8)}setFromCamera(t,e){e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,-1).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):e.isPerspectiveCamera?(this.ray.origin.set(t.x,t.y,-1).unproject(e),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(t,e=!0,n=[]){return t.forEach(i=>{i.visible&&this.intersectObject(i,e,n)}),n}createRaycastLineHelper(){let t=new rd({color:65280,linewidth:10}),e=new N(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),n=new N(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),i=this.camera.far-this.camera.near,r=new N().addVectors(e,n.multiplyScalar(i)),s=new Lt;return s.setFromPoints([e,r]),new FA(s,t)}},m$=t=>t instanceof xM||t instanceof Ag;function kFe(t,e){return t.distance-e.distance}function g$(t,e,n){if(!(!lh(e)||!e.visible)){kl(e)&&e.raycast(t,n);for(let i of e.children)g$(t,i,n)}}function QI(t,e,n){if(!n.some(r=>_M(t,r)!==void 0))return[];let i=[];return e.children.forEach(r=>g$(t,r,i)),i.sort(kFe),i}function KI(t){let e=[];if(t.length){let n=t[0].object;lh(n)&&e.push(n);let i=n.parent;for(;i;)m$(i)&&e.push(i),i=i.parent}return e}function _M(t,e){if(kl(e)){if(e.visible){let n=[];return e.raycast(t,n),n.length?n[0]:void 0}}else if(m$(e))return v$(t,e)}function v$(t,e){if(!(!lh(e)||!e.visible)){if(kl(e)){let n=[];if(e.raycast(t,n),n.length)return n[0]}for(let n of e.children){let i=v$(t,n);if(i)return i}}}function zFe(t,e,n){return{x:(t-(n.left+window.scrollX))/n.width*2-1,y:-((e-(n.top+window.scrollY))/n.height)*2+1}}var GFe=class{constructor(t,e,n,i,r,s){this.isExport=s,this.raycaster=new UFe,this.raycasterNeedsUpdate=!0,this.stopRaycast=!1,this._useWindowEvents=!1,this.sharedAssets=new UE(uM.emptyData()),this.scene=new Kl({...MI.defaultData},this.sharedAssets),this.camera=new Gs,this.renderer=t,this._useWindowEvents=e.data.publish.mouseEventTarget==="window",this.domElement=t.domElement,this.eventElement=this._useWindowEvents?window:t.domElement,this.stopRaycast=r,this.sharedAssets=i,this.scene=e,this.camera=n}set useWindowEvents(t){this._useWindowEvents=t,this.eventElement=t?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}updateRaycaster(t){if(!this.raycasterNeedsUpdate)return;this.raycasterNeedsUpdate=!1;let{pageX:e,pageY:n}=t.touches!==void 0&&t.touches.length>0?t.touches[0]:t,i=this.domElement.getBoundingClientRect();this.raycaster.setFromCamera(zFe(e,n,i),this.camera)}},y$=(t=>(t[t.keydown=0]="keydown",t[t.keyup=1]="keyup",t[t.pointerdown=2]="pointerdown",t[t.pointerup=3]="pointerup",t[t.pointermove=4]="pointermove",t[t.wheel=5]="wheel",t[t.scroll=6]="scroll",t))(y$||{}),vu=class{constructor(t){this.eventContext=t,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},x$=new Map,zy=new Map,$m=class{constructor(t,e,n,i){this.data=e;let{audio:r,volume:s,delay:o,loop:a}=e;if(!r)throw new Error("Missing property");let l=typeof r=="string"?i.getAudio(r).src:r.data;this.audioPlayer=new fy({src:l,volume:s,delay:o,loop:a}),zy.has(n.uuid)?zy.get(n.uuid).push(this):zy.set(n.uuid,[this]),x$.set(t,this)}playByToggle(){this.data.toggle==="stop"?this.audioPlayer.status==="playing"?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):this.data.toggle==="pause"?this.audioPlayer.status==="playing"?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},JI=class{constructor(t){this.data=t}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(t){let e=x$.get(t);!e||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.audioPlayer[this.data.interaction](),this.disposeDelay()},this.data.delay)):e.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(t){let e=zy.get(t);!(e!=null&&e.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(n=>n.audioPlayer[this.data.interaction]()),this.disposeDelay()},this.data.delay)):e.forEach(n=>n.audioPlayer[this.data.interaction]()))}pauseAllAudios(){let t=[...zy.values()];!t.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(e=>{e.forEach(n=>{n.audioPlayer[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):t.forEach(e=>{e.forEach(n=>{n.audioPlayer[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},Gy=class{constructor(t,e,n,i){if(this.data=e,e.interaction==="play")this.interaction=new $m(t,e,n,i);else if(e.interaction==="pause"||e.interaction==="stop")this.interaction=new JI(e);else throw new Error("Missing property")}dispatchBasic(){this.interaction instanceof $m?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){this.interaction instanceof $m?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(t){this.interaction instanceof $m&&(t==="start"?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}};function HFe(t,e){let n=t.material.layers.find(i=>i.uuid===e);return n.color.texture.image.img instanceof HTMLVideoElement?n.color.texture.image.img:void 0}var w$=new Map,Hy=new Map,Vy=class{constructor(t,e,n){this.data=e,this.delay=0,this.status="stopped";let{layerId:i,loop:r,volume:s,delay:o}=e;if(this.object=n,i===void 0)throw new Error("Missing property");let a=HFe(n,i);if(a)this.videoElement=a,this.videoElement.loop=r===1/0,this.videoElement.autoplay=!0,s!==void 0&&(this.videoElement.volume=s);else throw new Error("Missing property");o!==void 0&&(this.delay=o),Hy.has(n.uuid)?Hy.get(n.uuid).push(this):Hy.set(n.uuid,[this]),w$.set(t,this),this.pause()}mute(){this.videoElement.muted=!0}unMute(){this.videoElement.muted=!1}play(t){let e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);t?(this.mute(),this.delay+=150):e?(this.mute(),window.setTimeout(()=>{this.unMute()},100)):this.unMute(),this.delayTimerId=window.setTimeout(()=>{this.videoElement.play(),this.clearDelay()},this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){this.videoElement.pause(),this.status="paused"}stop(){this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay()}playByToggle(){this.data.toggle==="stop"?this.status==="playing"?this.stop():(this.stop(),this.play()):this.data.toggle==="pause"?this.status==="playing"?this.pause():this.play():(this.stop(),this.play())}dispose(){this.stop(),this.videoElement.muted=!0}},ZI=class{constructor(t){this.data=t}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(t){let e=w$.get(t);!e||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e[this.data.interaction](),this.disposeDelay()},this.data.delay)):e[this.data.interaction]())}pauseAllVideosFromObject(t){let e=Hy.get(t);!(e!=null&&e.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(n=>n[this.data.interaction]()),this.disposeDelay()},this.data.delay)):e.forEach(n=>n[this.data.interaction]()))}pauseAllVideos(){let t=[...Hy.values()];!t.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(e=>{e.forEach(n=>{n[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):t.forEach(e=>{e.forEach(n=>{n[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},YF=class{constructor(t,e,n){if(this.data=e,e.interaction==="play")this.interaction=new Vy(t,e,n);else if(e.interaction==="pause"||e.interaction==="stop")this.interaction=new ZI(e);else throw new Error("Missing property")}dispatchBasic(){this.interaction instanceof Vy?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){this.interaction instanceof Vy?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},VFe="text/plain",jFe="us-ascii",W6=(t,e)=>e.some(n=>n instanceof RegExp?n.test(t):n===t),WFe=(t,{stripHash:e})=>{let n=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(t);if(!n)throw new Error(`Invalid URL: ${t}`);let{type:i,data:r,hash:s}=n.groups,o=i.split(";");s=e?"":s;let a=!1;o[o.length-1]==="base64"&&(o.pop(),a=!0);let l=(o.shift()||"").toLowerCase(),c=[...o.map(h=>{let[u,d=""]=h.split("=").map(f=>f.trim());return u==="charset"&&(d=d.toLowerCase(),d===jFe)?"":`${u}${d?`=${d}`:""}`}).filter(Boolean)];return a&&c.push("base64"),(c.length>0||l&&l!==VFe)&&c.unshift(l),`data:${c.join(";")},${a?r.trim():r}${s?`#${s}`:""}`};function XFe(t,e){if(e={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...e},t=t.trim(),/^data:/i.test(t))return WFe(t,e);if(/^view-source:/i.test(t))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let n=t.startsWith("//");!n&&/^\.*\//.test(t)||(t=t.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,e.defaultProtocol));let i=new URL(t);if(e.forceHttp&&e.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(e.forceHttp&&i.protocol==="https:"&&(i.protocol="http:"),e.forceHttps&&i.protocol==="http:"&&(i.protocol="https:"),e.stripAuthentication&&(i.username="",i.password=""),e.stripHash?i.hash="":e.stripTextFragment&&(i.hash=i.hash.replace(/#?:~:text.*?$/i,"")),i.pathname){let s=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,o=0,a="";for(;;){let c=s.exec(i.pathname);if(!c)break;let h=c[0],u=c.index,d=i.pathname.slice(o,u);a+=d.replace(/\/{2,}/g,"/"),a+=h,o=u+h.length}let l=i.pathname.slice(o,i.pathname.length);a+=l.replace(/\/{2,}/g,"/"),i.pathname=a}if(i.pathname)try{i.pathname=decodeURI(i.pathname)}catch{}if(e.removeDirectoryIndex===!0&&(e.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(e.removeDirectoryIndex)&&e.removeDirectoryIndex.length>0){let s=i.pathname.split("/"),o=s[s.length-1];W6(o,e.removeDirectoryIndex)&&(s=s.slice(0,-1),i.pathname=s.slice(1).join("/")+"/")}if(i.hostname&&(i.hostname=i.hostname.replace(/\.$/,""),e.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(i.hostname)&&(i.hostname=i.hostname.replace(/^www\./,""))),Array.isArray(e.removeQueryParameters))for(let s of[...i.searchParams.keys()])W6(s,e.removeQueryParameters)&&i.searchParams.delete(s);if(e.removeQueryParameters===!0&&(i.search=""),e.sortQueryParameters){i.searchParams.sort();try{i.search=decodeURIComponent(i.search)}catch{}}e.removeTrailingSlash&&(i.pathname=i.pathname.replace(/\/$/,""));let r=t;return t=i.toString(),!e.removeSingleSlash&&i.pathname==="/"&&!r.endsWith("/")&&i.hash===""&&(t=t.replace(/\/$/,"")),(e.removeTrailingSlash||i.pathname==="/")&&i.hash===""&&e.removeSingleSlash&&(t=t.replace(/\/$/,"")),n&&!e.normalizeProtocol&&(t=t.replace(/^http:\/\//,"//")),e.stripProtocol&&(t=t.replace(/^(?:https?:)?\/\//,"")),t}var YFe=class{constructor({url:t,context:e},n){if(this.managers=n,!t)throw new Error("Missing property");this.url=t.startsWith("mailto:")?t:XFe(t,{removeTrailingSlash:!1,removeSingleSlash:!1}),this.context=e??"tab"}dispatch(){var t;AI?window.location.assign(this.url):(this.context==="tab"?window.open(this.url,"_blank"):this.context==="window"?window.open(this.url,"_blank",`width=${window.innerWidth}, height=${window.innerHeight}`):window.open(this.url,"_parent"),(t=this.managers.controlsManager.orbitControls)==null||t.onPointerUp(Nt[0]),jLe())}},_$=class{constructor(t,e,n){this.data=t,this.managers=n,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=i=>{var a,l;this.timeoutIdQueue.shift();let r=this.scene.find(i);if(r===void 0)return;let s=this.controlsManager.sharedGameControlGlobals.rapierWorld,o=s?(a=r.dataPatched.physics)==null?void 0:a.fusedBody:!0;if(r.cloner){for(let c of r.cloner.children)o?(c.playModeVisible=!1,c.rigidBody&&((l=r.dataPatched.physics)==null?void 0:l.rigidBody)==="positioned"&&(s.removeRigidBody(c.rigidBody),c.rigidBody=void 0),c.boundsTree&&(c.boundsTree=void 0)):this.clone===void 0||this.clone===c?(c.playModeVisible=!1,c.rigidBody&&(s.removeRigidBody(c.rigidBody),c.rigidBody=void 0)):c.playModeVisible===void 0&&(c.playModeVisible=!0);(o||this.clone===void 0||this.clone===!1)&&(r.visible=!1,r.rigidBody&&(s.removeRigidBody(r.rigidBody),r.rigidBody=void 0),r.boundsTree&&(r.boundsTree=void 0))}else r.rigidBody&&(s.removeRigidBody(r.rigidBody),r.rigidBody=void 0),r.boundsTree&&(r.boundsTree=void 0),r.visible=!1;s===void 0?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(c=>c.boundsTree!==void 0):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(c=>c.rigidBody!==void 0),this.managers.eventManager.requestRender()},this.objects=[...t.objects],this.scene=e,this.controlsManager=n.controlsManager}dispatch(t){this.clone=t,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()}dispatchFromStart(){this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))}dispose(){this.timeoutIdQueue.forEach(t=>window.clearTimeout(t))}},X6=(()=>{let t,e,n,i;function r(a){!t&&!Y6()&&(e==null?void 0:e.sharedGameControlGlobals.createdObjects.length)>0&&(t=requestAnimationFrame(s)),a&&(e=a,i=a.requestRender)}function s(a){let l=n?a-n:0,c=e.sharedGameControlGlobals.createdObjects,h=e.sharedGameControlGlobals.nCreatedPerAction,u=c.length,d=0;for(;d<u;){let f=c[d];f.userData.createdTime===void 0&&(f.userData.createdTime=a),f.userData.lifetime===void 0&&f.userData.quantity===void 0||f.userData.lifetime&&a-f.userData.createdTime<f.userData.lifetime||f.userData.quantity&&h[f.userData.actionId]<=f.userData.quantity?(f.userData.velocity&&(f.position.addScaledVector(f.userData.velocity,l/1e3),f.updateMatrix(),i()),d++):(h[f.userData.actionId]>f.userData.quantity&&h[f.userData.actionId]--,c.splice(d,1),f.removeFromParent(),e.sharedGameControlGlobals.rapierWorld&&f.rigidBody?e.sharedGameControlGlobals.rapierWorld.removeRigidBody(f.rigidBody):(f.boundsTree=void 0,e.sharedGameControlGlobals.entitiesWithTransformAnim=e.sharedGameControlGlobals.entitiesWithTransformAnim.filter(p=>p.boundsTree!==void 0)),u--,i())}t=d>0?requestAnimationFrame(s):void 0,n=d>0?a:void 0}function o(){Y6()?t&&(cancelAnimationFrame(t),n=void 0):r()}return typeof document<"u"&&document.addEventListener("visibilitychange",o),r})();function Y6(){return!!document&&document.hidden}var q6=new on,qFe=new N,QFe=new N,jy=class{constructor(t,e,n){this.data=t,this.scene=e,this.controlsManager=n,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=sn.generateUUID(),this.dispatch=()=>{this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()},this.dispatchFromStart=()=>{this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))},this.dispatchThrottled=aLe(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{this.intervalId===null&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{if(this.timeoutIdQueue.shift(),this.object===void 0)return;let i=this.object.clone(!0);if(i.raycast=()=>{},i.visible=!0,this.data.coordinateSystem!=="world"){let s=this.data.coordinateSystem;s===Kl.PERSONAL_CAMERA_ID&&this.scene.find(Kl.PERSONAL_CAMERA_EXPORT_ID)&&(s=Kl.PERSONAL_CAMERA_EXPORT_ID);let o=this.scene.find(s);o&&(o.updateMatrixWorldSVD(),i.hiddenMatrix.setPosition(0,0,0),i.hiddenMatrix.premultiply(o.matrixWorldRigid),i.updateMatrixWorld())}i.position.fromArray(this.data.position),i.rotation.fromArray(this.data.rotation),i.updateMatrix(),this.scene.add(i);let r=this.controlsManager.sharedGameControlGlobals;r.createdObjects.push(i),r.nCreatedPerAction[this.uniqueId]===void 0?r.nCreatedPerAction[this.uniqueId]=1:r.nCreatedPerAction[this.uniqueId]++,i.updateWorldMatrix(!0,!0),this.controlsManager.sharedGameControlGlobals.rapierWorld?i.traverseObject(this.traverseObjectCB):this.traverseObjectCB(i),X6(),this.controlsManager.requestRender()},this.traverseObjectCB=i=>{var o,a,l,c;i.hasNonUniformScale&&i.updateMatrixWorldSVD();let r;if(i instanceof cf)if(i.objectForSample){if(i.objectForSample.dataPatched.physics.fusedBody)return;r=i.object}else return i.object.dataPatched.physics.fusedBody===!0&&i.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(i instanceof zl)r=i.object;else if(r=i,(o=r.dataPatched.cloner)==null?void 0:o.hideBase)return!0;this.data.destroy==="Time"?i.userData.lifetime=this.data.lifetime*1e3:this.data.destroy==="Quantity"&&(i.userData.quantity=this.data.destroyAfterQuantity,i.userData.actionId=this.uniqueId),i.matrixWorld.decompose(qFe,q6,QFe);let s=new N().fromArray(this.data.velocity).applyQuaternion(q6);if(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(i,r,{fromCreate:!0,dynamic:this.data.dynamic}),this.data.destroy==="Collision"&&((a=i.rigidBody)==null||a.collider(0).setActiveEvents(1),i.userData.hasCollisionDestroy=!0),this.data.velocity.some(h=>h!==0)&&this.data.dynamic&&((l=i.rigidBody)==null||l.setLinvel(s.divideScalar(this.controlsManager.pixelsPerMeter),!0))):(this.controlsManager.addBoundsTree(i),this.data.velocity.some(h=>h!==0)&&this.data.dynamic&&(i.userData.velocity=s)),((c=r.dataPatched.physics)==null?void 0:c.fusedBody)===!0)return!0},this.scene=e,this.object=this.scene.find(this.data.object),this.data.hideBase==="Yes"&&(this.object.visible=!1),X6(n)}dispose(){this.timeoutIdQueue.forEach(t=>window.clearTimeout(t)),this.dispatchThrottled.cancel(),this.scene.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},KFe=class{constructor(t,e,n,i){this.scene=e,this.sharedAssets=n,this.sceneData=t,this.managers=i}dispatch(){var t,e,n;z$(this.sceneData,this.scene,this.sharedAssets,!0),(t=this.managers.eventManager)==null||t.reset(),(e=this.managers.controlsManager.orbitControls)==null||e.reset(),(n=this.managers.controlsManager)==null||n.gameControls.forEach(i=>i.reset(!0))}},b$={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},qF={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},JFe=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],bM={CSS:{},springs:{}};function ja(t,e,n){return Math.min(Math.max(t,e),n)}function Wy(t,e){return t.indexOf(e)>-1}function aD(t,e){return t.apply(null,e)}var Dt={arr:function(t){return Array.isArray(t)},obj:function(t){return Wy(Object.prototype.toString.call(t),"Object")},pth:function(t){return Dt.obj(t)&&t.hasOwnProperty("totalLength")},svg:function(t){return t instanceof SVGElement},inp:function(t){return t instanceof HTMLInputElement},dom:function(t){return!("isNode"in t)&&(t.nodeType||Dt.svg(t))},str:function(t){return typeof t=="string"},fnc:function(t){return typeof t=="function"},und:function(t){return typeof t>"u"},hex:function(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)},rgb:function(t){return/^rgb/.test(t)},hsl:function(t){return/^hsl/.test(t)},col:function(t){return Dt.hex(t)||Dt.rgb(t)||Dt.hsl(t)},key:function(t){return!b$.hasOwnProperty(t)&&!qF.hasOwnProperty(t)&&t!=="targets"&&t!=="keyframes"}};function S$(t){var e=/\(([^)]+)\)/.exec(t);return e?e[1].split(",").map(function(n){return parseFloat(n)}):[]}function A$(t,e){var n=S$(t),i=ja(Dt.und(n[0])?1:n[0],.1,100),r=ja(Dt.und(n[1])?100:n[1],.1,100),s=ja(Dt.und(n[2])?10:n[2],.1,100),o=ja(Dt.und(n[3])?0:n[3],.1,100),a=Math.sqrt(r/i),l=s/(2*Math.sqrt(r*i)),c=l<1?a*Math.sqrt(1-l*l):0,h=1,u=l<1?(l*a+-o)/c:-o+a;function d(p){var v=e?e*p/1e3:p;return l<1?v=Math.exp(-v*l*a)*(h*Math.cos(c*v)+u*Math.sin(c*v)):v=(h+u*v)*Math.exp(-v*a),p===0||p===1?p:1-v}function f(){var p=bM.springs[t];if(p)return p;for(var v=1/6,g=0,m=0;;)if(g+=v,d(g)===1){if(m++,m>=16)break}else m=0;var y=g*v*1e3;return bM.springs[t]=y,y}return e?d:f}function ZFe(t){return t===void 0&&(t=10),function(e){return Math.ceil(ja(e,1e-6,1)*t)*(1/t)}}var $Fe=function(){var t=11,e=1/(t-1);function n(h,u){return 1-3*u+3*h}function i(h,u){return 3*u-6*h}function r(h){return 3*h}function s(h,u,d){return((n(u,d)*h+i(u,d))*h+r(u))*h}function o(h,u,d){return 3*n(u,d)*h*h+2*i(u,d)*h+r(u)}function a(h,u,d,f,p){var v,g,m=0;do g=u+(d-u)/2,v=s(g,f,p)-h,v>0?d=g:u=g;while(Math.abs(v)>1e-7&&++m<10);return g}function l(h,u,d,f){for(var p=0;p<4;++p){var v=o(u,d,f);if(v===0)return u;var g=s(u,d,f)-h;u-=g/v}return u}function c(h,u,d,f){if(!(0<=h&&h<=1&&0<=d&&d<=1))return;var p=new Float32Array(t);if(h!==u||d!==f)for(var v=0;v<t;++v)p[v]=s(v*e,h,d);function g(m){for(var y=0,w=1,b=t-1;w!==b&&p[w]<=m;++w)y+=e;--w;var A=(m-p[w])/(p[w+1]-p[w]),S=y+A*e,T=o(S,h,d);return T>=.001?l(m,S,h,d):T===0?S:a(m,y,y+e,h,d)}return function(m){return h===u&&d===f||m===0||m===1?m:s(g(m),u,f)}}return c}(),M$=function(){var t={linear:function(){return function(i){return i}}},e={Sine:function(){return function(i){return 1-Math.cos(i*Math.PI/2)}},Circ:function(){return function(i){return 1-Math.sqrt(1-i*i)}},Back:function(){return function(i){return i*i*(3*i-2)}},Bounce:function(){return function(i){for(var r,s=4;i<((r=Math.pow(2,--s))-1)/11;);return 1/Math.pow(4,3-s)-7.5625*Math.pow((r*3-2)/22-i,2)}},Elastic:function(i,r){i===void 0&&(i=1),r===void 0&&(r=.5);var s=ja(i,1,10),o=ja(r,.1,2);return function(a){return a===0||a===1?a:-s*Math.pow(2,10*(a-1))*Math.sin((a-1-o/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/o)}}},n=["Quad","Cubic","Quart","Quint","Expo"];return n.forEach(function(i,r){e[i]=function(){return function(s){return Math.pow(s,r+2)}}}),Object.keys(e).forEach(function(i){var r=e[i];t["easeIn"+i]=r,t["easeOut"+i]=function(s,o){return function(a){return 1-r(s,o)(1-a)}},t["easeInOut"+i]=function(s,o){return function(a){return a<.5?r(s,o)(a*2)/2:1-r(s,o)(a*-2+2)/2}}}),t}();function QF(t,e){if(Dt.fnc(t))return t;var n=t.split("(")[0],i=M$[n],r=S$(t);switch(n){case"spring":return A$(t,e);case"cubicBezier":return aD($Fe,r);case"steps":return aD(ZFe,r);default:return aD(i,r)}}function E$(t){try{var e=document.querySelectorAll(t);return e}catch{return}}function GE(t,e){for(var n=t.length,i=arguments.length>=2?arguments[1]:void 0,r=[],s=0;s<n;s++)if(s in t){var o=t[s];e.call(i,o,s,t)&&r.push(o)}return r}function HE(t){return t.reduce(function(e,n){return e.concat(Dt.arr(n)?HE(n):n)},[])}function Q6(t){return Dt.arr(t)?t:(Dt.str(t)&&(t=E$(t)||t),t instanceof NodeList||t instanceof HTMLCollection?[].slice.call(t):[t])}function KF(t,e){return t.some(function(n){return n===e})}function JF(t){var e={};for(var n in t)e[n]=t[n];return e}function $I(t,e){var n=JF(t);for(var i in t)n[i]=e.hasOwnProperty(i)?e[i]:t[i];return n}function VE(t,e){var n=JF(t);for(var i in e)n[i]=Dt.und(t[i])?e[i]:t[i];return n}function eNe(t){var e=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(t);return e?"rgba("+e[1]+",1)":t}function tNe(t){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,n=t.replace(e,function(a,l,c,h){return l+l+c+c+h+h}),i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n),r=parseInt(i[1],16),s=parseInt(i[2],16),o=parseInt(i[3],16);return"rgba("+r+","+s+","+o+",1)"}function nNe(t){var e=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(t),n=parseInt(e[1],10)/360,i=parseInt(e[2],10)/100,r=parseInt(e[3],10)/100,s=e[4]||1;function o(d,f,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?d+(f-d)*6*p:p<1/2?f:p<2/3?d+(f-d)*(2/3-p)*6:d}var a,l,c;if(i==0)a=l=c=r;else{var h=r<.5?r*(1+i):r+i-r*i,u=2*r-h;a=o(u,h,n+1/3),l=o(u,h,n),c=o(u,h,n-1/3)}return"rgba("+a*255+","+l*255+","+c*255+","+s+")"}function iNe(t){if(Dt.rgb(t))return eNe(t);if(Dt.hex(t))return tNe(t);if(Dt.hsl(t))return nNe(t)}function eu(t){var e=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(t);if(e)return e[1]}function rNe(t){if(Wy(t,"translate")||t==="perspective")return"px";if(Wy(t,"rotate")||Wy(t,"skew"))return"deg"}function e3(t,e){return Dt.fnc(t)?t(e.target,e.id,e.total):t}function Vl(t,e){return t.getAttribute(e)}function ZF(t,e,n){var i=eu(e);if(KF([n,"deg","rad","turn"],i))return e;var r=bM.CSS[e+n];if(!Dt.und(r))return r;var s=100,o=document.createElement(t.tagName),a=t.parentNode&&t.parentNode!==document?t.parentNode:document.body;a.appendChild(o),o.style.position="absolute",o.style.width=s+n;var l=s/o.offsetWidth;a.removeChild(o);var c=l*parseFloat(e);return bM.CSS[e+n]=c,c}function C$(t,e,n){if(e in t.style){var i=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=t.style[e]||getComputedStyle(t).getPropertyValue(i)||"0";return n?ZF(t,r,n):r}}function $F(t,e){if(Dt.dom(t)&&!Dt.inp(t)&&(Vl(t,e)||Dt.svg(t)&&t[e]))return"attribute";if(Dt.dom(t)&&KF(JFe,e))return"transform";if(Dt.dom(t)&&e!=="transform"&&C$(t,e))return"css";if(t[e]!=null)return"object"}function T$(t){if(Dt.dom(t)){for(var e=t.style.transform||"",n=/(\w+)\(([^)]*)\)/g,i=new Map,r;r=n.exec(e);)i.set(r[1],r[2]);return i}}function sNe(t,e,n,i){var r=Wy(e,"scale")?1:0+rNe(e),s=T$(t).get(e)||r;return n&&(n.transforms.list.set(e,s),n.transforms.last=e),i?ZF(t,s,i):s}function eN(t,e,n,i){switch($F(t,e)){case"transform":return sNe(t,e,i,n);case"css":return C$(t,e,n);case"attribute":return Vl(t,e);default:return t[e]||0}}function tN(t,e){var n=/^(\*=|\+=|-=)/.exec(t);if(!n)return t;var i=eu(t)||0,r=parseFloat(e),s=parseFloat(t.replace(n[0],""));switch(n[0][0]){case"+":return r+s+i;case"-":return r-s+i;case"*":return r*s+i}}function P$(t,e){if(Dt.col(t))return iNe(t);if(/\s/g.test(t))return t;var n=eu(t),i=n?t.substr(0,t.length-n.length):t;return e?i+e:i}function nN(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function oNe(t){return Math.PI*2*Vl(t,"r")}function aNe(t){return Vl(t,"width")*2+Vl(t,"height")*2}function lNe(t){return nN({x:Vl(t,"x1"),y:Vl(t,"y1")},{x:Vl(t,"x2"),y:Vl(t,"y2")})}function D$(t){for(var e=t.points,n=0,i,r=0;r<e.numberOfItems;r++){var s=e.getItem(r);r>0&&(n+=nN(i,s)),i=s}return n}function cNe(t){var e=t.points;return D$(t)+nN(e.getItem(e.numberOfItems-1),e.getItem(0))}function R$(t){if(t.getTotalLength)return t.getTotalLength();switch(t.tagName.toLowerCase()){case"circle":return oNe(t);case"rect":return aNe(t);case"line":return lNe(t);case"polyline":return D$(t);case"polygon":return cNe(t)}}function uNe(t){var e=R$(t);return t.setAttribute("stroke-dasharray",e),e}function hNe(t){for(var e=t.parentNode;Dt.svg(e)&&Dt.svg(e.parentNode);)e=e.parentNode;return e}function L$(t,e){var n=e||{},i=n.el||hNe(t),r=i.getBoundingClientRect(),s=Vl(i,"viewBox"),o=r.width,a=r.height,l=n.viewBox||(s?s.split(" "):[0,0,o,a]);return{el:i,viewBox:l,x:l[0]/1,y:l[1]/1,w:o/l[2],h:a/l[3]}}function dNe(t,e){var n=Dt.str(t)?E$(t)[0]:t,i=e||100;return function(r){return{property:r,el:n,svg:L$(n),totalLength:R$(n)*(i/100)}}}function fNe(t,e){function n(a){a===void 0&&(a=0);var l=e+a>=1?e+a:0;return t.el.getPointAtLength(l)}var i=L$(t.el,t.svg),r=n(),s=n(-1),o=n(1);switch(t.property){case"x":return(r.x-i.x)*i.w;case"y":return(r.y-i.y)*i.h;case"angle":return Math.atan2(o.y-s.y,o.x-s.x)*180/Math.PI}}function K6(t,e){var n=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,i=P$(Dt.pth(t)?t.totalLength:t,e)+"";return{original:i,numbers:i.match(n)?i.match(n).map(Number):[0],strings:Dt.str(t)||e?i.split(n):[]}}function I$(t){var e=t?HE(Dt.arr(t)?t.map(Q6):Q6(t)):[];return GE(e,function(n,i,r){return r.indexOf(n)===i})}function B$(t){var e=I$(t);return e.map(function(n,i){return{target:n,id:i,total:e.length,transforms:{list:T$(n)}}})}function pNe(t,e){var n=JF(e);if(/^spring/.test(n.easing)&&(n.duration=A$(n.easing)),Dt.arr(t)){var i=t.length,r=i===2&&!Dt.obj(t[0]);r?t={value:t}:Dt.fnc(e.duration)||(n.duration=e.duration/i)}var s=Dt.arr(t)?t:[t];return s.map(function(o,a){var l=Dt.obj(o)&&!Dt.pth(o)?o:{value:o};return Dt.und(l.delay)&&(l.delay=a?0:e.delay),Dt.und(l.endDelay)&&(l.endDelay=a===s.length-1?e.endDelay:0),l}).map(function(o){return VE(o,n)})}function mNe(t){for(var e=GE(HE(t.map(function(s){return Object.keys(s)})),function(s){return Dt.key(s)}).reduce(function(s,o){return s.indexOf(o)<0&&s.push(o),s},[]),n={},i=function(s){var o=e[s];n[o]=t.map(function(a){var l={};for(var c in a)Dt.key(c)?c==o&&(l.value=a[c]):l[c]=a[c];return l})},r=0;r<e.length;r++)i(r);return n}function gNe(t,e){var n=[],i=e.keyframes;i&&(e=VE(mNe(i),e));for(var r in e)Dt.key(r)&&n.push({name:r,tweens:pNe(e[r],t)});return n}function vNe(t,e){var n={};for(var i in t){var r=e3(t[i],e);Dt.arr(r)&&(r=r.map(function(s){return e3(s,e)}),r.length===1&&(r=r[0])),n[i]=r}return n.duration=parseFloat(n.duration),n.delay=parseFloat(n.delay),n}function yNe(t,e){var n;return t.tweens.map(function(i){var r=vNe(i,e),s=r.value,o=Dt.arr(s)?s[1]:s,a=eu(o),l=eN(e.target,t.name,a,e),c=n?n.to.original:l,h=Dt.arr(s)?s[0]:c,u=eu(h)||eu(l),d=a||u;return Dt.und(o)&&(o=c),r.from=K6(h,d),r.to=K6(tN(o,h),d),r.start=n?n.end:0,r.end=r.start+r.delay+r.duration+r.endDelay,r.easing=QF(r.easing,r.duration),r.isPath=Dt.pth(s),r.isColor=Dt.col(r.from.original),r.isColor&&(r.round=1),n=r,r})}var O$={css:function(t,e,n){return t.style[e]=n},attribute:function(t,e,n){return t.setAttribute(e,n)},object:function(t,e,n){return t[e]=n},transform:function(t,e,n,i,r){if(i.list.set(e,n),e===i.last||r){var s="";i.list.forEach(function(o,a){s+=a+"("+o+") "}),t.style.transform=s}}};function F$(t,e){var n=B$(t);n.forEach(function(i){for(var r in e){var s=e3(e[r],i),o=i.target,a=eu(s),l=eN(o,r,a,i),c=a||eu(l),h=tN(P$(s,c),l),u=$F(o,r);O$[u](o,r,h,i.transforms,!0)}})}function xNe(t,e){var n=$F(t.target,e.name);if(n){var i=yNe(e,t),r=i[i.length-1];return{type:n,property:e.name,animatable:t,tweens:i,duration:r.end,delay:i[0].delay,endDelay:r.endDelay}}}function wNe(t,e){return GE(HE(t.map(function(n){return e.map(function(i){return xNe(n,i)})})),function(n){return!Dt.und(n)})}function N$(t,e){var n=t.length,i=function(s){return s.timelineOffset?s.timelineOffset:0},r={};return r.duration=n?Math.max.apply(Math,t.map(function(s){let o=s.startOnceDelay??0,a=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return i(s)+o+a+l+s.duration*(s.loop??1)})):e.duration,r.delay=n?Math.min.apply(Math,t.map(function(s){let o=s.startOnceDelay??0,a=s.pingPongDelayCorrection??0;return i(s)+o+a+s.delay})):e.delay,r.endDelay=n?r.duration-Math.max.apply(Math,t.map(function(s){let o=s.startOnceDelay??0,a=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return i(s)+o+a+s.duration*(s.loop??1)-s.endDelay-l})):e.endDelay,r}var J6=0;function _Ne(t){var e=$I(b$,t),n=$I(qF,t),i=gNe(n,t),r=B$(t.targets),s=wNe(r,i),o=N$(s,n),a=J6;return J6++,VE(e,{id:a,children:[],animatables:r,animations:s,duration:o.duration,delay:o.delay,endDelay:o.endDelay,startOnceDelay:n.startOnceDelay,pingPongDelayCorrection:n.pingPongDelayCorrection,pingPongEndDelayCorrection:n.pingPongEndDelayCorrection})}var la=[],Z6=[],VS,bNe=function(){function t(){VS=requestAnimationFrame(e)}function e(n){var i=la.length;if(i){for(var r=0;r<i;){var s=la[r];s.paused?(la.splice(r,1),i-=1):(s.tick(n),r++)}t()}else VS=cancelAnimationFrame(VS)}return t}();function SNe(t){document.hidden?(la.forEach(function(e){return e.pause(t.timeStamp)}),Z6=la.slice(0),Di.running=la=[]):Z6.forEach(function(e){return e.play(t.timeStamp)})}typeof document<"u"&&document.addEventListener("visibilitychange",SNe);function Di(t){t===void 0&&(t={});var e=0,n=0,i=0,r,s,o=0,a=null;function l(S){var T=window.Promise&&new Promise(function(M){return a=M});return S.finished=T,T}var c=_Ne(t);l(c);function h(){var S=c.direction;S!=="alternate"&&(c.direction=S!=="normal"?"normal":"reverse"),c.reversed=!c.reversed,s.forEach(function(T){(T.loop===1||T.loop%2===0)&&(T.reversed=c.reversed)})}function u(){c.direction="normal",c.reversed=!1,s.forEach(function(S){return S.reversed=!1})}function d(S){return c.reversed?c.duration-S:S}function f(){e=0,n=d(c.currentTime)*(1/Di.speed)}function p(S,T){T&&(c.reversed?T.seek(T.duration*T.loop-(S-T.timelineOffset-T.pingPongDelayCorrection)):T.seek(S-T.timelineOffset-T.startOnceDelay-T.pingPongDelayCorrection))}function v(S){if(c.reversed)for(var T=o;T--;)p(S,s[T]);else for(var M=0;M<o;M++)p(S,s[M])}function g(S){var K,oe,ve,$,se,ne,ie,me,xe,Ae;var T=0,M=c.animations,E=M.length;for(c.direction!=="alternate"&&((K=c.parent)==null?void 0:K.direction)==="alternate"?((oe=c.parent)==null?void 0:oe.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1&&((ve=c.parent)!=null&&ve.reversed&&c.direction==="alternate"?S=c.duration-c.delay+c.endDelay-S:S=c.duration+c.delay-c.endDelay-S):b(!1,($=c.parent)==null?void 0:$.rewind,c.rewind,(se=c.parent)==null?void 0:se.reversePlayback,c.reversePlayback)&&((ne=c.parent)!=null&&ne.reversed&&c.direction==="alternate"?S=c.duration-c.delay+c.endDelay-S:S=c.duration+c.delay-c.endDelay-S);T<E;){var P=M[T],R=P.animatable,F=P.tweens,B=F.length-1,k=F[B];B&&(k=GE(F,function(Ee){return S<Ee.end})[0]||k);let _e;(ie=c.parent)!=null&&ie.reversed&&c.direction==="alternate"?_e=ja(S-k.start-k.endDelay,0,k.duration)/k.duration:_e=ja(S-k.start-k.delay,0,k.duration)/k.duration;for(var j=isNaN(_e)?1:k.easing(_e),Z=k.to.strings,ee=k.round,O=[],W=k.to.numbers.length,H=void 0,Y=0;Y<W;Y++){var z=void 0;let Ee,Re;c.direction!=="alternate"?((me=c.parent)==null?void 0:me.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1?(Ee=k.to.numbers[Y],Re=k.from.numbers[Y]||0):(Re=k.to.numbers[Y],Ee=k.from.numbers[Y]||0):b(!0,(xe=c.parent)==null?void 0:xe.rewind,c.rewind,(Ae=c.parent)==null?void 0:Ae.reversePlayback,c.reversePlayback)?(Ee=k.to.numbers[Y],Re=k.from.numbers[Y]||0):(Re=k.to.numbers[Y],Ee=k.from.numbers[Y]||0),k.isPath?z=fNe(k.value,j*Re):z=Ee+j*(Re-Ee),ee&&(k.isColor&&Y>2||(z=Math.round(z*ee)/ee)),O.push(z)}var X=Z.length;if(!X)H=O[0];else{H=Z[0];for(var q=0;q<X;q++){Z[q];var re=Z[q+1],G=O[q];isNaN(G)||(re?H+=G+re:H+=G+" ")}}O$[P.type](R.target,P.property,H,R.transforms),P.currentValue=H,T++}}function m(S){c[S]&&!c.passThrough&&c[S](c)}function y(){c.remaining&&c.remaining!==!0&&c.remaining--}let w={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function b(S,T,M,E,P){return w[S<<4|T<<3|M<<2|E<<1|P]}function A(S){var R;var T=c.duration;let M=c.delay,E=T-c.endDelay;(R=c.parent)!=null&&R.reversed&&c.direction==="alternate"&&(M=c.endDelay,E=T-c.delay);var P=d(S);if(c.progress=ja(P/T*100,0,100),c.reversePlayback=P<c.currentTime,o&&v(P),!c.began&&c.currentTime>=0&&(c.began=!0,m("begin")),!c.loopBegan&&c.currentTime>0&&(c.loopBegan=!0,m("loopBegin")),(c.reversed||P>=0)&&P<=M&&c.currentTime!==0&&(g(0),m("change")),(P>=E&&c.currentTime!==T+c.pingPongDelayCorrection||!T)&&(g(T),m("change")),P>M&&P<E?(c.changeBegan||(c.changeBegan=!0,c.changeCompleted=!1,m("changeBegin")),g(P),m("change")):c.changeBegan?(c.changeCompleted=!0,c.changeBegan=!1,m("change"),o&&m("timelineChangeComplete")):c.began&&P>E&&m("changeComplete"),c.currentTime=ja(P,0,T+c.pingPongDelayCorrection),c.began&&m("update"),S>=T)if(y(),!c.remaining)c.paused=!0,c.completed||(c.completed=!0,m("loopComplete"),m("complete"),!c.passThrough&&"Promise"in window&&(a(),l(c)));else{o?e+=c.duration/Di.speed:e+=c.duration;for(let F of s)F.setStartTime(0),F.remaining=F.loop;m("loopComplete"),c.loopBegan=!1,c.direction==="alternate"?h():o&&u()}}return c.reset=function(){var S=c.direction;c.passThrough=!1,c.currentTime=0,c.progress=0,c.paused=!0,c.began=!1,c.loopBegan=!1,c.changeBegan=!1,c.completed=!1,c.changeCompleted=!1,c.reversePlayback=!1,c.reversed=S==="reverse",c.remaining=c.loop,s=c.children,o=s.length;for(var T=o;T--;)c.children[T].reset();(c.reversed&&c.loop!==!0||S==="alternate"&&c.loop===1)&&c.remaining++,g(c.reversed?c.duration:0)},c.setStartTime=function(S){e=S},c.set=function(S,T){return F$(S,T),c},c.tick=function(S){i=S,e||(e=i),A((i+(n-e))*Di.speed)},c.seek=function(S){A(S-e)},c.pause=function(S){c.paused=!0,o&&(r=S??performance.now())},c.play=function(S){!c.paused||(c.completed&&c.reset(),c.paused=!1,la.push(c),o&&r!==void 0&&(e+=(S??performance.now())-r),VS||bNe())},c.reverse=function(){h(),c.completed=!c.reversed,f()},c.restart=function(){c.reset(),c.play()},c.reset(),c.autoplay&&c.play(),c}function $6(t,e){for(var n=e.length;n--;)KF(t,e[n].animatable.target)&&e.splice(n,1)}function ANe(t){for(var e=I$(t),n=la.length;n--;){var i=la[n],r=i.animations,s=i.children;$6(e,r);for(var o=s.length;o--;){var a=s[o],l=a.animations;$6(e,l),!l.length&&!a.children.length&&s.splice(o,1)}!r.length&&!s.length&&i.pause()}}function MNe(t,e){e===void 0&&(e={});var n=e.direction||"normal",i=e.easing?QF(e.easing):null,r=e.grid,s=e.axis,o=e.from||0,a=o==="first",l=o==="center",c=o==="last",h=Dt.arr(t),u=parseFloat(h?t[0]:t),d=h?parseFloat(t[1]):0,f=eu(h?t[1]:t)||0,p=e.start||0+(h?u:0),v=[],g=0;return function(m,y,w){if(a&&(o=0),l&&(o=(w-1)/2),c&&(o=w-1),!v.length){for(var b=0;b<w;b++){if(!r)v.push(Math.abs(o-b));else{var A=l?(r[0]-1)/2:o%r[0],S=l?(r[1]-1)/2:Math.floor(o/r[0]),T=b%r[0],M=Math.floor(b/r[0]),E=A-T,P=S-M,R=Math.sqrt(E*E+P*P);s==="x"&&(R=-E),s==="y"&&(R=-P),v.push(R)}g=Math.max.apply(Math,v)}i&&(v=v.map(function(B){return i(B/g)*g})),n==="reverse"&&(v=v.map(function(B){return s?B<0?B*-1:-B:Math.abs(g-B)}))}var F=h?(d-u)/g:u;return p+F*(Math.round(v[y]*100)/100)+f}}function ENe(t){t===void 0&&(t={});var e=Di(t);return e.duration=0,e.add=function(n,i){var r=la.indexOf(e),s=e.children;r>-1&&la.splice(r,1);function o(d){d.passThrough=!0}for(var a=0;a<s.length;a++)o(s[a]);var l=VE(n,$I(qF,t));l.targets=l.targets||t.targets;var c=e.duration;l.autoplay=!1,l.timelineOffset=Dt.und(i)?c:tN(i,c),o(e);var h=Di(l);o(h),s.push(h),h.parent=e;var u=N$(s,t);return e.delay=u.delay,e.endDelay=u.endDelay,e.duration=u.duration,h.loop===!0&&(e.duration=1/0),e.seek(0),e.reset(),e.autoplay&&e.play(),e},e}Di.version="3.2.0";Di.speed=1;Di.running=la;Di.remove=ANe;Di.get=eN;Di.set=F$;Di.convertPx=ZF;Di.path=dNe;Di.setDashoffset=uNe;Di.stagger=MNe;Di.timeline=ENe;Di.easing=QF;Di.penner=M$;Di.random=function(t,e){return Math.floor(Math.random()*(e-t+1))+t};var U$=Di,eW=new N,tW=new N,nW=new on;function CNe(t,e,n,i){if(i===0)return n.copy(t);if(i===1)return n.copy(e);let r=t.w*e.w+t.x*e.x+t.y*e.y+t.z*e.z;if(r>=1)return n.copy(t);let s=1-r*r;if(s<=Number.EPSILON){let h=1-i;return n.w=h*t.w+i*e.w,n.x=h*t.x+i*e.x,n.y=h*t.y+i*e.y,n.z=h*t.z+i*e.z,n.normalize(),n}let o=Math.sqrt(s),a=Math.atan2(o,r),l=Math.sin((1-i)*a)/o,c=Math.sin(i*a)/o;return n.w=t.w*l+e.w*c,n.x=t.x*l+e.x*c,n.y=t.y*l+e.y*c,n.z=t.z*l+e.z*c,n}function Hf(t,e,n,i,r){let s=n[t]?n[t]:void 0,o=i[t];if(o==null)return;let a=s??e[t],l=o;if(a!==l)return{update:c=>{let h=sn.lerp(a,l,c);r?e[t]=Math.trunc(h):e[t]=h},start:()=>{e[t]=a},end:()=>{e[t]=l}}}function k$(t,e,n,i,r){let s=n[t]?n[t]:void 0,o=i[t];if(!o)return;let a=e[t],l=[...s??a],c=[...o];if(!(l.length!==c.length||fF(l,c)))return{update:h=>{l.forEach((u,d)=>{let f=sn.lerp(u,c[d],h);e[t][d]=r?Math.trunc(f):f})},start:()=>{Object.assign(e[t],l)},end:()=>{Object.assign(e[t],c)}}}function iW(t,e,n,i){let r=n[t]?n[t]:void 0,s=i[t];if(!s)return;let o=e[t],a=r?new N().fromArray(r):o.clone(),l=new N().fromArray(s);if(!a.equals(l))return{update:c=>{o.lerpVectors(a,l,c)},start:()=>{o.copy(a)},end:()=>{o.copy(l)}}}function TNe(t,e,n,i){let r=n[t]?n[t]:void 0,s=i[t];if(!s)return;let o=e[t],a=r?new nt().fromArray(r):o.clone(),l=new N,c=new on,h=new N;a.decompose(l,c,h);let u=new nt().fromArray(s),d=new N,f=new on,p=new N;if(u.decompose(d,f,p),!a.equals(u))return{update:v=>{nW.slerpQuaternions(c,f,v),eW.lerpVectors(l,d,v),tW.lerpVectors(h,p,v),o.compose(eW,nW,tW)},start:()=>{o.compose(l,c,h)},end:()=>{o.compose(d,f,p)}}}function PNe(t,e,n,i,r){let s=n[t]?n[t]:void 0,o=i[t];if(!o)return;let a=e[t],l=s?typeof s=="string"?r.getColor(s).clone():new Rt().setRGB(s.r,s.g,s.b):a.clone(),c=typeof o=="string"?r.getColor(o).clone():new Rt().setRGB(o.r,o.g,o.b);if(l.equals(c))return;let h=a.clone();return e[t]=h,{update:u=>{h.lerpColors(l,c,u)},start:()=>{h.copy(l)},end:()=>{h.copy(c)}}}function od(t,e,n,i){if(typeof e[t]=="number")return Hf(t,e,n??{},i);if(Array.isArray(e[t]))return k$(t,e,n??{},i)}function DNe(t,e,n){var o,a,l,c;let i=[],r=t.cameraType==="OrthographicCamera"?(o=e.orthographic)==null?void 0:o.zoom:(a=e.perspective)==null?void 0:a.zoom,s=t.cameraType==="OrthographicCamera"?(l=n.orthographic)==null?void 0:l.zoom:(c=n.perspective)==null?void 0:c.zoom;if(s!==void 0){let h=r??t.zoom,u=s;h!==u&&i.push({update:d=>{t.zoom=sn.lerp(h,u,d),t.updateProjectionMatrix()},start:()=>{t.zoom=h,t.updateProjectionMatrix()},end:()=>{t.zoom=u,t.updateProjectionMatrix()}})}if(n.targetOffset!==void 0){let h=Hf("targetOffset",t,e,n);h&&i.push(h)}return i}function RNe(t,e,n,i){if(n.scaleBaked===void 0)return;let r=e.scaleBaked??t.data.geometry.scaleBaked,s=n.scaleBaked;if(Sf.isEqual(r,s))return;let o=[];return o.push({update:a=>{t.updateGeometryInteractions({scaleBaked:[sn.lerp(r[0],s[0],a),sn.lerp(r[1],s[1],a),sn.lerp(r[2],s[2],a)]},i),t.invalidateDownstreamBooleanData()},start:()=>{t.updateGeometryInteractions({scaleBaked:r},i),t.invalidateDownstreamBooleanData()},end:()=>{t.updateGeometryInteractions({scaleBaked:s},i),t.invalidateDownstreamBooleanData()}}),o}function LNe(t,e,n){if(!n.extrusion)return;let i=t.extrusion,r=e.extrusion??{},s=n.extrusion,o=[];return OJ.forEach(a=>{let l=od(a,i,r,s);l&&o.push(l)}),o}function INe(t,e,n,i){let r=[];if(!("geometry"in n))return r;let s=t.geometry.userData.parameters,o="geometry"in e?e.geometry:{},a=n.geometry;if(t instanceof qx){let l=RNe(t,o,a,i);l&&r.push(...l)}else{let l={};if(Object.assign(l,zx(s,hj)),hj.forEach(c=>{let h=od(c,l,o,a);h&&r.push(h)}),t instanceof HF){Object.assign(l,{extrusion:{...s.extrusion}});let c=LNe(l,o,a);c&&r.push(...c)}r.length&&r.push({update:c=>{t.updateGeometryInteractions(l,i),t.updateGeometryGroupsIfNeeded()},start:c=>{t.updateGeometryInteractions(l,i),t.updateGeometryGroupsIfNeeded()},end:c=>{t.updateGeometryInteractions(l,i),t.updateGeometryGroupsIfNeeded()}})}return r}function BNe(t,e,n,i){let r=[];if(n.intensity!==void 0){let s=Hf("intensity",t,e,n);s&&r.push(s)}if(n.color!==void 0){let s=PNe("color",t,e,n,i);s&&r.push(s)}return r}function ONe(t,e,n,i){let r=[];if(Array.isArray(t.material)){if(!("materials"in n&&n.materials))return r;let s="materials"in e&&e.materials?e.materials:[],o=n.materials;t.material.forEach((a,l)=>{if(!o[l])return;let c=s[l]??{},h=o[l];typeof c=="string"||typeof h=="string"||r.push(...rW(a,c,h,i))})}else{if(!("material"in n&&n.material))return r;let s="material"in e&&e.material?e.material:{},o=n.material;if(typeof s=="string"||typeof o=="string")return r;r.push(...rW(t.material,s,o,i))}return r}function rW(t,e,n,i){var o;let r=[],s=vM(n,i)||!!e.layers&&vM(e,i);r.push(jNe(t,s));for(let a of t.layers){let l=(o=e.layers)==null?void 0:o.data(a.uuid),c=n.layers.data(a.uuid);if(!c||!(a.visible??!0)||!(c.visible??!0))continue;let h=a.getNames().filter(u=>!LJ.some(d=>u.includes(d)));for(let u of h)try{let d=a.getValue(u),f;if(u==="colors")f=HNe(a,l,c,u);else if(Array.isArray(d))u==="steps"&&(f=GNe(a,l,c,u));else if(typeof d=="number")f=FNe(a,l,c,u);else{if(typeof d=="boolean")continue;d instanceof be?f=NNe(a,l,c,u):d instanceof N?f=UNe(a,l,c,u):d instanceof zs?f=zNe(a,l,c,u,i):d instanceof Rt?f=kNe(a,l,c,u,i):"isTexture"in d&&(f=VNe(a,l,c,u))}f&&(Array.isArray(f)?r.push(...f):r.push(f))}catch(d){console.error(`lerpMaterial: unexpected material layer for ${u}`,d)}}return r}function FNe(t,e,n,i){if(!t.hasValue(i)||!(i in n))return;let r=e?e[i]:t.getValue(i),s=n[i];if(r!==s)return{update:o=>{t.setValue(i,sn.lerp(r,s,o))},start:()=>{t.setValue(i,r)},end:()=>{t.setValue(i,s)}}}function NNe(t,e,n,i){if(!t.hasValue(i)||!(i in n))return;let r=t.getValue(i),s=e?new be().fromArray(e[i]):r.clone(),o=new be().fromArray(n[i]);if(!s.equals(o))return{update:a=>{r.lerpVectors(s,o,a)},start:()=>{r.copy(s)},end:()=>{r.copy(o)}}}function UNe(t,e,n,i){if(!t.hasValue(i)||!(i in n))return;let r=t.getValue(i),s=e?new N().fromArray(e[i]):r.clone(),o=new N().fromArray(n[i]);if(!s.equals(o))return{update:a=>{r.lerpVectors(s,o,a)},start:()=>{r.copy(s)},end:()=>{r.copy(o)}}}function kNe(t,e,n,i,r){if(!t.hasValue(i)||!(i in n))return;let s=e?e[i]:void 0,o=n[i],a=t.getValue(i),l=s?typeof s=="string"?r.getColor(s).clone():new Rt().setRGB(s.r,s.g,s.b):a.clone(),c=typeof o=="string"?r.getColor(o).clone():new Rt().setRGB(o.r,o.g,o.b);if(l.equals(c))return;let h=a.clone();return t.setValue(i,h),{update:u=>{h.lerpColors(l,c,u)},start:()=>{h.copy(l)},end:()=>{h.copy(c)}}}function zNe(t,e,n,i,r){if(!t.hasValue(i)||!(i in n))return;let s=e?e[i]:void 0,o=n[i],a=t.getValue(i),l=s?typeof s=="string"?r.getColor(s).clone():new Rt().setRGB(s.r,s.g,s.b):a.clone(),c=typeof o=="string"?r.getColor(o).clone():new zs(o.r,o.g,o.b,o.a);if(l.equals(c))return;let h=a.clone();return t.setValue(i,h),{update:u=>{h.lerpColors(l,c,u)},start:()=>{h.copy(l)},end:()=>{h.copy(c)}}}function GNe(t,e,n,i="steps"){if(!t.hasValue(i)||!(i in n))return;let r=[],s=t.getValue(i),o=e?e[i]:s,a=n[i];for(let l=0;l<s.length;++l){let c=o[l],h=a[l];c!==h&&r.push({update:u=>{s[l]=sn.lerp(c,h,u)},start:()=>{s[l]=c},end:()=>{s[l]=h}})}return r.length?r:void 0}function HNe(t,e,n,i="colors"){if(!t.hasValue(i)||!(i in n))return;let r=[],s=t.getValue(i),o=e?e[i]:s.map(l=>l.toArray()),a=n[i];for(let l=0;l<s.length;++l){let c=[...o[l]],h=[...a[l]];ZA.isEqual(c,h)||r.push({update:u=>{s[l].fromArray(ZA.lerp(c,h,u))},start:()=>{s[l].fromArray(c)},end:()=>{s[l].fromArray(h)}})}return r.length?r:void 0}function VNe(t,e,n,i="texture"){if(!t.hasValue(i)||!(i in n))return;let r=t.getNode("mat");if(!r)return;let s=e?e[i]:r,o=n[i],a=[...s.repeat],l=[...s.offset],c=[...o.repeat],h=[...o.offset];if(!qm.isEqual(a,c)||!qm.isEqual(l,h))return{update:u=>{r.repeat=qm.lerp(a,c,u),r.offset=qm.lerp(l,h,u),r.updateMatrix()},start:()=>{r.repeat=[...a],r.offset=[...l],r.updateMatrix()},end:()=>{r.repeat=[...c],r.offset=[...h],r.updateMatrix()}}}function jNe(t,e){return{update:()=>{t.transparent=e}}}var lD=new N,sW=new Dr;function WNe(t,e,n,i){let r=[],s,o,a,l,c,h,u={slide:(e.pathSnapping??t.updatedPathSnapping??t.dataPatched.pathSnapping).slide,offset:(e.pathSnapping??t.updatedPathSnapping??t.dataPatched.pathSnapping).offset};if(c=Hf("slide",u,e.pathSnapping??t.updatedPathSnapping??t.dataPatched.pathSnapping,n.pathSnapping??t.dataPatched.pathSnapping),c&&r.push(c),h=Hf("offset",u,e.pathSnapping??t.updatedPathSnapping??t.dataPatched.pathSnapping,n.pathSnapping??t.dataPatched.pathSnapping),h&&r.push(h),!c&&!h&&(s=iW("position",t,e,n),s&&r.push(s),o=iW("scale",t,e,n),o&&r.push(o),a=XNe(t,e,n,i),a&&r.push(a),l=TNe("hiddenMatrix",t,e,n),l&&r.push(l)),s||o||a||l||c||h){let d=()=>{var f;t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),(f=t.parent)!=null&&f.matrixWorldFusedFalse&&(t.matrixWorld.multiplyMatrices(t.parent.matrixWorldFusedFalse,t.matrix),t.matrixWorldNeedsUpdate=!1),kl(t)&&Xc(t.parent)&&t.invalidateDownstreamBooleanData(!0),t.updatePathSnapping(Object.assign({},e.pathSnapping,u))};r.push({update:d,start:d,end:d})}return r}function XNe(t,e,n,i){let r=e!=null&&e.rotation?e.rotation:void 0,s=n.rotation;if(!s)return;let o=r?new N().fromArray(r):new N().setFromEuler(t.rotation),a=new N().fromArray(s);if(o.equals(a))return;let l=lD.subVectors(a,o);if(i&&l.toArray().every(c=>Math.abs(c)<2*Math.PI)){let c=new on().setFromEuler(sW.setFromVector3(o)),h=new on().setFromEuler(sW.setFromVector3(a));return{update:u=>{CNe(c,h,t.quaternion,u)},start:()=>{t.rotation.setFromVector3(o)},end:()=>{t.rotation.setFromVector3(a)}}}else return{update:c=>{lD.lerpVectors(o,a,c),t.rotation.setFromVector3(lD)},start:()=>{t.rotation.setFromVector3(o)},end:()=>{t.rotation.setFromVector3(a)}}}function YNe(t,e,n){let i=[];if(!("cloner"in n)||!t.cloner)return i;let r=t.cloner,s="cloner"in e?e.cloner:{},o=n.cloner;EJ.forEach(d=>{let f;d==="count"?f=Hf("count",r.parameters,s,o,!0):f=od(d,r.parameters,s??{},o),f&&i.push(f)});let a=qNe(r,s,o);a!=null&&a.length&&i.push(...a);let l=QNe(r,s,o);l!=null&&l.length&&i.push(...l);let c=KNe(r,s,o);c!=null&&c.length&&i.push(...c);let h=JNe(r,s,o);h!=null&&h.length&&i.push(...h);let u=ZNe(r,s,o);return u!=null&&u.length&&i.push(...u),i.length&&i.push({update:()=>{r.update()}}),i}function qNe(t,e,n){if(t.parameters.type!=="radial")return;let i=e.radial,r=n.radial;if(!r)return;let s=t.parameters.radial,o=[];return CJ.forEach(a=>{let l=od(a,s,i??{},r);l&&o.push(l)}),o}function QNe(t,e,n){if(t.parameters.type!=="linear")return;let i=e.linear,r=n.linear;if(!r)return;let s=[],o=t.parameters.linear;return TJ.forEach(a=>{let l=od(a,o,i??{},r);l&&s.push(l)}),s}function KNe(t,e,n){if(t.parameters.type!=="grid")return;let i=e.grid,r=n.grid;if(!r)return;let s=[],o=t.parameters.grid;return PJ.forEach(a=>{let l;a==="count"?l=k$(a,o,i??{},r,!0):l=od(a,o,i??{},r),l&&s.push(l)}),s}function JNe(t,e,n){if(t.parameters.type!=="toObject")return;let i=e.toObject,r=n.toObject;if(!r)return;let s=[],o=t.parameters.toObject;return DJ.forEach(a=>{let l;a==="count"?l=Hf(a,o,i??{},r,!0):l=od(a,o,i??{},r),l&&s.push(l)}),s}function ZNe(t,e,n){if(!t.parameters.randomness)return;let i=e.randomnessObject,r=n.randomnessObject;if(!r)return;let s=[],o=t.parameters.randomnessObject;return RJ.forEach(a=>{let l=od(a,o,i??{},r);l&&s.push(l)}),s}function oW(t,e,n,i,r){let s=[];return t.data.visible&&s.push(...WNe(t,e,n,r)),t.data.visible&&s.push(...YNe(t,e,n)),kl(t)?(t instanceof fa&&t.data.visible&&s.push(...INe(t,e,n,i)),t.data.visible&&s.push(...ONe(t,e,n,i))):nFe(t)?t.data.visible&&s.push(...BNe(t,e,n,i)):tFe(t)&&s.push(...DNe(t,e,n)),s.length?{update:o=>{s.forEach(a=>a.update(o))},start:o=>{s.forEach(a=>{var l;return(l=a.start)==null?void 0:l.call(a,o)})},end:o=>{s.forEach(a=>{var l;return(l=a.end)==null?void 0:l.call(a,o)})}}:void 0}var aW=new N;function z$(t,e,n,i=!1){let r=[];e.traverseObject(s=>{var c,h,u,d,f;if(i&&((c=s.rigidBody)==null||c.setTranslation(s.position0,!0),(h=s.rigidBody)==null||h.setRotation(s.rotation0,!0),(u=s.rigidBody)==null||u.setLinvel(aW,!0),(d=s.rigidBody)==null||d.setAngvel(aW,!0)),!Pn.is(s))return;let o=s.uuid,a=s.data;if(delete s.states,!a.states)return;let l=!1;r.some(p=>t.objects.isDescendantOf(o,p))?l=!0:((f=a.physics)==null?void 0:f.fusedBody)===!0&&a.physics.rigidBody==="dynamic"&&r.push(o),s.data=a,s.currentState=null,s.reversibleToState=null,s.currentTransitionEvent=null;for(let p of a.states)t.environment.usePhysics===!0&&a.physics&&(a.physics.rigidBody==="dynamic"||l)&&(p.data.position!==void 0||p.data.rotation!==void 0||p.data.hiddenMatrix!==void 0)||(s.states||(s.states={}),s.states[p.id]=af.patch(a,p.data));$Ne(e,s,null,n,a.events.find(p=>p.data.type==="Follow"||p.data.type==="LookAt")!==void 0)})}function $Ne(t,e,n,i,r=!1){if(e instanceof fa&&e.removeInteractionGeometry(),e.changeSelectedState(n,{scene:t,shared:i},r),e instanceof fa&&e.updateGeometryGroupsIfNeeded(),e.cloner)for(let s of e.cloner.children)s.playModeVisible=void 0;e.updateVisible()}function G$(t){let e;switch(t.easing){case 0:e="cubicBezier( 0, 0, 1, 1 )";break;case 1:e="cubicBezier( .25, .1, .25, 1 )";break;case 2:e="cubicBezier( .42, 0, 1, 1 )";break;case 3:e="cubicBezier( 0, 0, .58, 1 )";break;case 4:e="cubicBezier( .42, 0, .58, 1 )";break;case 5:let{control1:n,control2:i}=t;e=`cubicBezier(
				${n[0]}, ${n[1]}, ${i[0]}, ${i[1]}
			)`;break;case 6:let{mass:r,stiffness:s,damping:o,velocity:a}=t;e=`spring( ${r}, ${s}, ${o}, ${a} )`;break;default:e="linear"}return{duration:t.duration,easing:e}}function H$(t){let e={delay:0,loop:t.repeat===-1?!0:t.repeat+1};if(t.repeat===0)e.direction="normal",e.rewind=!1;else switch(t.direction){case"pingpong":e.direction="alternate",e.rewind=!1;break;case"pingpong-rewind":e.direction="alternate",e.rewind=!0;break;default:e.direction="normal",e.rewind=!1;break}switch(e.delay=0,e.endDelay=0,e.startOnceDelay=0,e.pingPongDelayCorrection=0,e.pingPongEndDelayCorrection=0,t.delayDirection){case"start-once":e.startOnceDelay=t.delay;break;case"start":e.delay=t.delay;break;case"end":e.endDelay=t.delay;break;case"start-end":case void 0:e.delay=t.delay,e.endDelay=t.delay;break}return e.direction==="alternate"&&(e.delay/=2,e.endDelay/=2,t.delayDirection==="start"?(e.pingPongDelayCorrection=e.delay,typeof e.loop=="number"&&e.loop%2===0&&(e.pingPongEndDelayCorrection=e.delay)):t.delayDirection==="end"?typeof e.loop=="number"&&e.loop%2!==0&&(e.pingPongEndDelayCorrection=e.endDelay):t.delayDirection==="start-end"&&(e.pingPongDelayCorrection=e.delay,e.pingPongEndDelayCorrection=e.endDelay)),e}var eUe={type:"beginState"},tUe={type:"completeState",isfromEntity:!1},lW=class{constructor(t,e,n,i,r,s){if(this.object=t,this.data=i,this.sharedAssets=r,this.allowSlerp=s,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.dispatchEvent({type:"requestRender"})),this.targets.t===0||this.targets.t===1?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let o=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=o,this.object.dispatchEvent({type:"beginState",state:o}),this.object.traverseEntity(a=>{a!==this.object&&a instanceof Gs&&a.dispatchEvent(eUe)})},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let o=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=o,this.object.dispatchEvent({type:"completeState",state:o}),this.object.traverseEntity(a=>{a!==this.object&&a instanceof Gs&&a.dispatchEvent(tUe)})},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=oW(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},e===void 0){let o=jS(this.object,this.object.currentState===n?this.object.prevState:this.object.currentState);if(!o)throw new Error("Missing property");this.from=o}else{let o=jS(this.object,e);if(!o)throw new Error("Missing property");this.from=o}if(n===void 0)throw new Error("Missing property");{let o=jS(this.object,n);if(!o)throw new Error("Missing property");this.to=o}this.useCurrentState=e===void 0||n===void 0,this.params={targets:this.targets,t:1,autoplay:!1,...H$(i),...G$(i),change:this.onChange},this.callback=oW(this.object,e===void 0?{}:this.from.data,n===void 0?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},Xy=class extends _s{constructor(t,e,n){if(super(),this.data=t,this.scene=e,this.sharedAssets=n,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.useToggle=!1,this.onTimelineChangeComplete=()=>{var r;this.data.tweens[0].data.direction!=="normal"&&(this.toggleIsForward=!this.toggleIsForward),this.timelineNeedsRebuild!==!1&&((r=this.timeline)==null||r.pause(),this.buildTimeline({isForward:this.toggleIsForward,isRebuild:!0}),this.timeline.play())},!t.object)throw new Error("Missing property");let i=e.find(t.object);if(!i)throw new Error("Missing property");if(!i.states)throw new Error("Missing property");if(this.object=i,t.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay=t.tweens[0].data.delayDirection==="start-once"?t.tweens[0].data.delay:0,this.init()}get playing(){return this.tweens.some(t=>t.changeBegan)??!1}init(){this.initialCurrentState=jS(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return this.useToggle?this.initialCurrentState:this.object.currentState}buildTimeline({isForward:t=!0,isRebuild:e=!1}={}){var n,i,r,s;try{let o=H$(this.data.tweens[0].data),a=o.loop;e&&typeof o.loop=="number"&&o.loop--,(n=this.timeline)==null||n.pause(),this.timeline=U$.timeline({autoplay:!1,...o,...a===!0||a>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}});let l=this.tweens.findIndex(c=>c==null?void 0:c.changeBegan);if(this.timelineNeedsRebuild=l!==-1&&(a===!0||a>1),o.pingPongDelayCorrection&&e===!1&&(this.timelineNeedsRebuild=!0),t){let c=l===-1?0:l;for(let h=c;h<this.data.tweens.length-1;h++){let u=this.data.tweens[h],d=this.data.tweens[h+1],f;h===c&&(this.object.wasMovedByUser===!0||((i=this.object.previousAction)==null?void 0:i.playing)===!0)?(f=void 0,this.object instanceof Gs&&(this.object.wasMovedByUser=!1)):f=u.data.state===void 0?this.currentState:u.data.state;let p=new lW(this.object,f,d.data.state===void 0?this.currentState:d.data.state,d.data,this.sharedAssets,this.data.allowSlerp??!1);l!==-1&&h===c&&Object.assign(p.params,{startOnceDelay:0}),this.tweens[h]=p,this.timeline.add(p.params,this.timeline.duration+(h===c?o.delay:0)+(h===c&&!e?o.pingPongDelayCorrection:0))}this.timeline.duration+=o.endDelay}else{let c=l===-1?this.data.tweens.length-1:l+1;for(let h=c;h>0;h--){let u=this.data.tweens[h],d=this.data.tweens[h-1],f;h===c&&(this.object.wasMovedByUser===!0||((r=this.object.previousAction)==null?void 0:r.playing)===!0)?(f=void 0,this.object instanceof Gs&&(this.object.wasMovedByUser=!1)):f=u.data.state===void 0?this.currentState:u.data.state;let p=new lW(this.object,f,d.data.state===void 0?this.currentState:d.data.state,u.data,this.sharedAssets,this.data.allowSlerp??!1);l!==-1&&h===c&&Object.assign(p.params,{startOnceDelay:0}),this.tweens[h-1]=p,this.timeline.add(p.params,this.timeline.duration+(h===c?o.endDelay:0))}this.timeline.duration+=o.delay+(e?0:o.pingPongDelayCorrection)}}catch(o){o instanceof Error&&console.error(o.message)}((s=this.object.previousAction)==null?void 0:s.playing)===!0&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(this.playing)return!1;clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{try{this.buildTimeline(),this.timeline.play()}catch(t){t instanceof Error&&console.error(t.message)}},this.startOnceDelay)}pause(){var t;(t=this.timeline)==null||t.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let t=this.data.tweens[0].data.state===void 0?this.initialCurrentState:this.data.tweens[0].data.state;this.object.changeSelectedState(t,{scene:this.scene,shared:this.sharedAssets}),this.object.currentState=t}seek(t){var e;this.timeline===void 0&&this.buildTimeline(),(e=this.timeline)==null||e.seek(t*this.timeline.duration)}toggle(t){var e;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=t??!this.toggleIsForward,this.playing?((e=this.timeline)==null||e.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()):this.timeoutId=window.setTimeout(()=>{var n;(n=this.timeline)==null||n.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function jS(t,e){var r;let n,i;if(typeof e=="string"?(n=e,i=(r=t.states)==null?void 0:r[n]):e===null&&(n=null,i=t.data),!(n===void 0||i===void 0))return{id:n,data:i}}var nUe={type:"beginState"},iUe={type:"completeState",isfromEntity:!1},cW={type:"requestRender"},V$=class extends _s{constructor(t,e){super(),this.data=t,this.scene=e,this.toggleIsForward=!1,this.useToggle=!1,this.posStart=new N,this.posEnd=new N,this.qStart=new on,this.qEnd=new on,this.zoomStart=1,this.zoomEnd=1,this.toCamera=e.find(t.targetCamera)}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(t=!1){if(!this.data.animate)return;let e={t:0};this.posStart.copy(this.scene.activeCamera.position),this.qStart.copy(this.scene.activeCamera.quaternion),this.zoomStart=this.scene.activeCamera.zoom,this.animation=U$({targets:e,t:1,...G$(this.data),update:()=>{e.t===0&&(this.useToggle&&!this.toggleIsForward?(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera)):(this.posEnd.copy(this.toCamera.position),this.qEnd.copy(this.toCamera.quaternion),this.zoomEnd=this.toCamera.zoom,this.fromCamera=this.scene.activeCamera,this.switchCamera(this.toCamera)),this.scene.activeCamera.dispatchEvent(nUe));let n=this.scene.activeCamera;n.position.lerpVectors(this.posStart,this.posEnd,e.t),n.quaternion.slerpQuaternions(this.qStart,this.qEnd,e.t),n.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*e.t,n.wasMovedBySwitchCameraAction=!0,n.updateMatrix(),n.updateMatrixWorld(),n.dispatchEvent(cW),e.t===1&&n.dispatchEvent(iUe)}})}switchCamera(t){this.scene.activeCamera.dispatchEvent({type:"cameraChange",camera:t}),this.scene.switchActiveCamera(t)}play(){this.playing||this.scene.activeCamera!==this.toCamera&&(clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var t;delete this.timeoutId;try{this.data.animate?(this.buildAnimation(),(t=this.animation)==null||t.play()):this.switchCamera(this.toCamera)}catch(e){e instanceof Error&&console.error(e.message)}},this.data.delay*1e3))}pause(){var t;(t=this.animation)==null||t.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(t){var e,n;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=t??!this.toggleIsForward,this.playing?((e=this.animation)==null||e.pause(),this.buildAnimation(!0),(n=this.animation)==null||n.play()):this.timeoutId=window.setTimeout(()=>{var i,r;delete this.timeoutId,this.data.animate?((i=this.animation)==null||i.pause(),this.buildAnimation(),(r=this.animation)==null||r.play()):(this.toggleIsForward?this.switchCamera(this.toCamera):this.switchCamera(this.fromCamera),this.scene.activeCamera.dispatchEvent(cW))},this.data.delay*1e3)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function nl(t,e,n,i,r,s){let o={Audio:[],Video:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[]};return e.forEach(({id:a,data:l})=>{try{l.type==="Audio"?zu[t.type].includes("Audio")&&o.Audio.push(new Gy(a,l,s,i)):l.type==="Video"?zu[t.type].includes("Video")&&o.Video.push(new YF(a,l,s)):l.type==="Link"?zu[t.type].includes("Link")&&o.Link.push(new YFe(l,r)):l.type==="Create"?zu[t.type].includes("Create")&&o.Create.push(new jy(l,n,r.controlsManager)):l.type==="Destroy"?zu[t.type].includes("Destroy")&&o.Destroy.push(new _$(l,n,r)):l.type==="Reset"?zu[t.type].includes("Reset")&&o.Reset.push(new KFe(n.data,n,i,r)):l.type==="Transition"?zu[t.type].includes("Transition")&&o.Transition.push(new Xy(l,n,i)):l.type==="SwitchCamera"&&zu[t.type].includes("SwitchCamera")&&o.SwitchCamera.push(new V$(l,n))}catch{}}),o}function pa(t){Object.values(t).forEach(e=>{e.forEach(n=>{(n instanceof Gy||n instanceof YF||n instanceof Xy||n instanceof jy||n instanceof _$||n instanceof V$)&&n.dispose()})})}var iN=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],j$=t=>{var e;return(e=iN.find(([n,i])=>i===t))==null?void 0:e[0]},j1=t=>{var e;return(e=iN.find(([n])=>n===t))==null?void 0:e[1]},rUe=(t,e)=>{let n=j$(t);if(n){let i=new CustomEvent(n,{bubbles:!0});return Object.defineProperty(i,"target",{writable:!1,value:e}),i}},sUe=class extends vu{constructor(t){super(t),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=n=>{var s;if(!n.eventName||!n.target||n.eventName==="Scroll")return;let i=(s=this.splineEvents[j$(n.eventName)])==null?void 0:s[n.target.uuid];if(!i)return;n.eventName==="Scroll"&&n.deltaY!==void 0&&Object.assign(i,{deltaY:n.deltaY});let{domElement:r}=this.eventContext;r.dispatchEvent(i)};let{scene:e}=this.eventContext;e.traverseEntity(n=>{var i,r;if((i=n.data)!=null&&i.events.length){for(let[s,o]of iN)if(n.data.events.some(a=>a.data.type===o&&!a.data.disabled)){this.objectsPerEvents.has(s)?(r=this.objectsPerEvents.get(s))==null||r.push(n):this.objectsPerEvents.set(s,[n]);let a={id:n.uuid,name:n.name},l=rUe(o,a),c=this.splineEvents[s];c?c[n.uuid]=l:this.splineEvents[s]={[n.uuid]:l}}}})}connect(){this.objectsPerEvents.forEach(t=>{t.forEach(e=>{e.addEventListener("beginEvent",this.onBeginEvent)})})}disconnect(){this.objectsPerEvents.forEach(t=>{t.forEach(e=>{e.removeEventListener("beginEvent",this.onBeginEvent)})})}},oUe=class{constructor(t,e,n,i,r,s){if(this.id=t,this.data=e,this.object=n,this.entered=!1,this.useToggle=e.toggle,(e.type==="KeyDown"||e.type==="KeyUp"||e.type==="KeyPress")&&!e.key)throw new Error("Missing property");this.actions=nl(e,e.actions,i,r,s,n)}disconnect(){pa(this.actions)}dispatchHeld(t){this.actions.Create.forEach(e=>{t&&e.dispatchThrottled.cancel(),e.dispatchThrottled()})}dispatch(t=!1){let e=new Set;this.actions.Transition.forEach(n=>{n.object.currentTransitionEvent!==this?(n.object.currentTransitionEvent=this,n.init()):this.useToggle===!1&&e.add(n)}),this.useToggle?(this.actions.Transition.forEach(n=>{n.toggle()}),this.actions.SwitchCamera.forEach(n=>{n.toggle()})):this.data.type==="MousePress"||this.data.type==="KeyPress"?this.entered||(this.entered=!0,this.actions.Transition.forEach(n=>n.playFromCurrent()),this.actions.SwitchCamera.forEach(n=>n.playFromCurrent()),this.actions.Create.forEach(n=>n.dispatchStart())):(this.actions.Transition.some(n=>n.playing)||this.actions.Transition.forEach(n=>{e.has(n)===!1&&n.play()}),this.actions.SwitchCamera.some(n=>n.playing)||this.actions.SwitchCamera.forEach(n=>{n.play()})),this.actions.Link.forEach(n=>{n.dispatch()}),t===!1&&this.actions.Create.forEach(n=>{n.dispatch()}),this.actions.Destroy.forEach(n=>{n.dispatch()}),this.actions.Reset.forEach(n=>{n.dispatch()}),this.actions.Audio.forEach(n=>{n.dispatchBasic()}),this.actions.Video.forEach(n=>{n.dispatchBasic()})}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent()),this.actions.Create.forEach(t=>t.dispatchStop()))}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent())),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()})}},aUe=class extends vu{constructor(t,e){super(t),this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.onWindowMouseDown=r=>{r.target===this.eventContext.domElement&&this.canvasMouseEvents.forEach(s=>{(s.data.type==="MouseDown"||s.data.type==="MousePress")&&s.dispatch()})},this.onWindowMouseUp=r=>{r.target===this.eventContext.domElement&&this.canvasMouseEvents.forEach(s=>{s.data.type==="MouseUp"?s.dispatch():s.data.type==="MousePress"&&s.dispatchRelease()})},this.onMouseDown=r=>{Nt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseEvent("MouseDown"))},this.onMouseUp=r=>{Nt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=r=>{Nt.length>1||(this.eventContext.updateRaycaster(r),this.handleMousePressEvent())},this.onMousePressRelease=r=>{Nt.length>1||(this.eventContext.updateRaycaster(r),this.handleMousePressEvent(!0))},this.onKeyDown=r=>{this.heldKeys[r.key]||(this.handleKeyEvent(r,"KeyDown"),this.handleKeyEventHeld(r,"KeyDown",!0)),this.heldKeys[r.key]=!0},this.onKeyUp=r=>{this.handleKeyEvent(r,"KeyUp"),this.handleKeyEventHeld(r,"KeyUp",!0)},this.onKeyPressDown=r=>{this.heldKeysPress[r.key]?this.handleKeyEventHeld(r,"KeyPress"):(this.handleKeyEvent(r,"KeyPress"),this.handleKeyEventHeld(r,"KeyPress",!0)),this.heldKeysPress[r.key]=!0},this.onKeyPressUp=r=>{this.handleKeyEvent(r,"KeyPress",!0)},this.releaseHeldKey=r=>{delete this.heldKeys[r.key]},this.releaseHeldKeyPress=r=>{delete this.heldKeysPress[r.key]},this._onUserEvent=({eventName:r,target:s,reverse:o})=>{var l,c,h,u;if(!r||!s)return;let a=j1(r);a&&(a==="MouseDown"||a==="MouseUp"||a==="MousePress"?(s.dispatchEvent({type:"beginEvent",eventName:a}),(c=(l=this.eventsPerObjects[a])==null?void 0:l[s.uuid])==null||c.forEach(d=>{d.dispatchUserEvent(o)})):(a==="KeyDown"||a==="KeyUp"||a==="KeyPress")&&(s.dispatchEvent({type:"beginEvent",eventName:a}),(u=(h=this.eventsPerObjects[a])==null?void 0:h[s.uuid])==null||u.forEach(d=>{d.dispatchUserEvent()})))};let{scene:n,sharedAssets:i}=this.eventContext;n.traverseEntity(r=>{var o,a;if(!((o=r.data)!=null&&o.events.length))return;let s=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let l of s){let c=this.eventsPerObjects[l];r.data.events.filter(({data:h})=>h.type===l&&h.disabled!==!0).forEach(({id:h,data:u})=>{try{let d=new oUe(h,u,r,n,i,e);d.actions.Video.length&&(this.hasVideoAction=!0),(u.type==="MouseDown"||u.type==="MouseUp"||u.type==="MousePress")&&u.mode!=="Object"?u.mode==="Canvas"&&this.canvasMouseEvents.push(d):c[r.uuid]?c[r.uuid].push(d):c[r.uuid]=[d]}catch{}}),(a=c[r.uuid])!=null&&a.length&&this.objectsPerTypes[l].push(r)}})}connect(){var e,n,i,r,s,o;let{domElement:t}=this.eventContext;this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),typeof window<"u"&&(window.addEventListener("pointerdown",this.onWindowMouseDown,{capture:!0}),window.addEventListener("pointerup",this.onWindowMouseUp,{capture:!0})),(e=this.objectsPerTypes.MouseDown)!=null&&e.length&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseDown)),(n=this.objectsPerTypes.MouseUp)!=null&&n.length&&(this.domEventsNeeded.add("pointerup"),t.addEventListener("pointerup",this.onMouseUp)),(i=this.objectsPerTypes.MousePress)!=null&&i.length&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),t.addEventListener("pointerup",this.onMousePressRelease)),(r=this.objectsPerTypes.KeyDown)!=null&&r.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),(s=this.objectsPerTypes.KeyUp)!=null&&s.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),(o=this.objectsPerTypes.KeyPress)!=null&&o.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach(([a,l])=>{l.forEach(c=>{c.addEventListener("userEvent",this._onUserEvent)})})}disconnect(){let{domElement:t}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},typeof window<"u"&&(window.removeEventListener("pointerdown",this.onWindowMouseDown,{capture:!0}),window.removeEventListener("pointerup",this.onWindowMouseUp,{capture:!0})),t.removeEventListener("pointerdown",this.onMouseDown),t.removeEventListener("pointerdown",this.onMousePressDown),t.removeEventListener("pointerup",this.onMouseUp),t.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach(e=>{Object.values(e).forEach(n=>{n.forEach(i=>{i.disconnect()})})}),this.canvasMouseEvents.forEach(e=>{e.disconnect()}),Object.entries(this.objectsPerTypes).forEach(([e,n])=>{n.forEach(i=>{i.removeEventListener("userEvent",this._onUserEvent)})})}handleMouseEvent(t){let{stopRaycast:e,raycaster:n,scene:i}=this.eventContext,r=this.objectsPerTypes[t];if(r.length)if(e){let s=QI(n,i,r);KI(s).forEach(o=>{this.eventsPerObjects[t][o.uuid]&&this.handleObjectMouseEventDispatch(o,t)})}else r.forEach(s=>{_M(n,s)&&this.handleObjectMouseEventDispatch(s,t)})}handleMousePressEvent(t=!1){let e="MousePress",n=this.objectsPerTypes[e],i=[];if(n.length){if(!t){let{stopRaycast:r,raycaster:s,scene:o}=this.eventContext;if(r){let a=QI(s,o,n);i=KI(a)}else n.forEach(a=>{_M(s,a)&&i.push(a)})}this._prevObjects.length&&this._prevObjects.forEach(r=>{i.includes(r)||this.handleObjectMouseEventDispatchRelease(r,e)}),i.length&&i.forEach(r=>{this.handleObjectMouseEventDispatch(r,e)}),this._prevObjects=i}}handleObjectMouseEventDispatch(t,e){var n,i;t.dispatchEvent({type:"beginEvent",eventName:e}),(i=(n=this.eventsPerObjects[e])==null?void 0:n[t.uuid])==null||i.forEach(r=>{r.dispatch()})}handleObjectMouseEventDispatchRelease(t,e){var n,i;t.dispatchEvent({type:"beginEvent",eventName:e}),(i=(n=this.eventsPerObjects[e])==null?void 0:n[t.uuid])==null||i.forEach(r=>{r.dispatchRelease()})}handleKeyEvent(t,e,n=!1){this.objectsPerTypes[e].forEach(i=>{let r=this.eventsPerObjects[e][i.uuid];r.some(({data:s})=>"key"in s&&s.key===t.key)&&i.dispatchEvent({type:"beginEvent",eventName:e}),r.forEach(s=>{"key"in s.data&&s.data.key===t.key&&(n?s.dispatchRelease():s.dispatch(!0))})})}handleKeyEventHeld(t,e,n=!1){this.objectsPerTypes[e].forEach(i=>{this.eventsPerObjects[e][i.uuid].forEach(r=>{"key"in r.data&&r.data.key===t.key&&r.dispatchHeld(n)})})}},lUe=new N,cUe=new N,W$=class{constructor(t,e,n,i,r){this.actionsIn=nl(t,t.inActions,n,i,r,e),this.actionsOut=nl(t,t.outActions,n,i,r,e)}disconnect(){pa(this.actionsIn),pa(this.actionsOut)}},uUe=class extends W${constructor(t,e,n,i,r,s){super(e,n,i,r,s),this.id=t,this.data=e,this.object=n,this.stage="out",this.objects=[],this.onUpdateMatrix=()=>{let c=lUe.setFromMatrixPosition(this.objects[0].matrixWorld),h=cUe.setFromMatrixPosition(this.objects[1].matrixWorld),u=c.distanceTo(h)<=this.distance?"in":"out";if(this.stage!==u){let d=u==="in"?this.actionsIn:this.actionsOut;d.Audio.forEach(f=>f.dispatchConditional()),d.Video.forEach(f=>f.dispatchConditional()),d.Create.forEach(f=>f.dispatch()),d.Destroy.forEach(f=>f.dispatch()),d.Transition.forEach(f=>{f.object.currentTransitionEvent!==this&&(f.object.currentTransitionEvent=this),f.init()}),d.Transition.forEach(f=>f.play()),d.SwitchCamera.forEach(f=>f.play()),this.stage=u}};let{distance:o,fromObject:a,toObject:l}=e.condition;this.distance=o;for(let c of[a,l]){if(!c)throw new Error("Missing property");let h=i.find(c);if(!h)throw new Error("Missing property");this.objects.push(h)}}connect(){this.objects.forEach(t=>{t.addEventListener("updateMatrix",this.onUpdateMatrix)}),this.onUpdateMatrix()}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach(t=>{t.removeEventListener("updateMatrix",this.onUpdateMatrix)})}},hUe=class extends W${constructor(t,e,n,i,r,s){var l;super(e,n,i,r,s),this.id=t,this.data=e,this.object=n,this.onBegin=({target:c,state:h})=>{this.toState!==h&&(this.actionsOut.Audio.forEach(u=>u.dispatchConditional()),this.actionsOut.Video.forEach(u=>u.dispatchConditional()),this.actionsOut.Create.forEach(u=>u.dispatch()),this.actionsOut.Destroy.forEach(u=>u.dispatch()),this.actionsIn.Transition.forEach(u=>u.pause()),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach(u=>u.play()),this.actionsIn.SwitchCamera.forEach(u=>u.pause()),this.actionsOut.SwitchCamera.forEach(u=>u.play()))},this.onComplete=({target:c,state:h})=>{this.toState===h&&(this.actionsIn.Audio.forEach(u=>u.dispatchConditional()),this.actionsIn.Video.forEach(u=>u.dispatchConditional()),this.actionsIn.Create.forEach(u=>u.dispatch()),this.actionsIn.Destroy.forEach(u=>u.dispatch()),this.actionsOut.Transition.forEach(u=>u.pause()),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach(u=>u.play()),this.actionsOut.SwitchCamera.forEach(u=>u.pause()),this.actionsIn.SwitchCamera.forEach(u=>u.play()))};let{condition:o}=e;if(!o.object)throw new Error("Missing property");let a=i.find(o.object);if(!a)throw new Error("Missing property");if(this.toObject=a,o.state&&!((l=this.toObject.states)!=null&&l[o.state]))throw new Error("Missing property");this.toState=o.state}connect(){(this.actionsOut.Audio.length||this.actionsOut.Video.length||this.actionsOut.Create.length||this.actionsOut.Destroy.length||this.actionsOut.Transition.length||this.actionsOut.SwitchCamera.length)&&this.toObject.addEventListener("beginState",this.onBegin),(this.actionsIn.Audio.length||this.actionsIn.Video.length||this.actionsOut.Create.length||this.actionsIn.Destroy.length||this.actionsIn.Transition.length||this.actionsIn.SwitchCamera.length)&&this.toObject.addEventListener("completeState",this.onComplete)}disconnect(){super.disconnect(),(this.actionsOut.Audio.length||this.actionsOut.Video.length||this.actionsOut.Create.length||this.actionsOut.Destroy.length||this.actionsOut.Transition.length||this.actionsOut.SwitchCamera.length)&&this.toObject.removeEventListener("beginState",this.onBegin),(this.actionsIn.Audio.length||this.actionsIn.Video.length||this.actionsOut.Create.length||this.actionsIn.Destroy.length||this.actionsIn.Transition.length||this.actionsIn.SwitchCamera.length)&&this.toObject.removeEventListener("completeState",this.onComplete)}},dUe=class extends vu{constructor(t,e){super(t),this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1;let{scene:n,sharedAssets:i}=this.eventContext;n.traverseEntity(r=>{var s;if((s=r.data)!=null&&s.events.length){for(let{id:o,data:a}of r.data.events)if(!a.disabled&&a.type==="Conditional")try{let l;a.condition.type==="Comparison"||(a.condition.type==="Distance"?l=new uUe(o,a,r,n,i,e):a.condition.type==="State"&&(l=new hUe(o,a,r,n,i,e))),l&&(this.eventsPerConditions[a.condition.type].push(l),(l.actionsIn.Video.length||l.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch{}}})}connect(){super.connect(),Object.values(this.eventsPerConditions).forEach(t=>t.forEach(e=>e.connect()))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach(t=>t.forEach(e=>e.disconnect()))}},Y0=new N,ju=new N,as=new N,uW=new no,fUe=.01,An=new N,fr=new N,hW=new N,eS=new on,cD=new Dr,uD=new Rr,um=new N,El=new N,hm=.2,pUe=function(){let t=new nt;return(e,n,i)=>{t.copy(e.hiddenMatrix),e.parent!==null&&t.premultiply(e.parent.matrixWorld),t.invert(),e.position.copy(n),e.position.applyMatrix4(t),t.multiply(i??e.matrixWorld).decompose(An,e.quaternion,fr),e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),e instanceof Vs&&Xc(e.parent)&&e.invalidateDownstreamBooleanData(!0)}}(),mUe=class{constructor(t,e,n,i,r){this.object=t,this.data=e,this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=this.data.resetSpeed===0?1:8/this.data.resetSpeed+1,this.snapDampingFactor=this.data.snapSpeed===0?1:8/this.data.snapSpeed+1,this.actionsDrag=nl(e,e.dragDropActions.drag,n,i,r,this.object),this.actionsDrop=nl(e,e.dragDropActions.drop,n,i,r,this.object);let s=[];this.data.objects.forEach(o=>{let a=n.find(o);!a||a.dataPatched.visible!==!1&&(r.controlsManager.usePhysics?a.traverseEntity((l,c)=>{var h;if(l.geometry&&s.unshift(l),(h=l.dataPatched.physics)==null?void 0:h.fusedBody)return l.geometry||s.unshift(l),!0}):s.push(a))}),this.dragItems=s.map(o=>(this.data.planeMode==="locked"&&(o.userData.lockedPlane=!0),o.userData.worldPosition0=new N().setFromMatrixPosition(o.matrixWorld),{obj:o,fromPosition:new N().setFromMatrixPosition(o.matrixWorld),pointStart:new N,pointEnd:new N,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:new N().copy(o.position),quat0:new on().copy(o.quaternion),snapped:!1,orientationMatrix:new nt}))}get activeDragItem(){return this.activeIdx!==null?this.dragItems[this.activeIdx]:null}dispose(){pa(this.actionsDrag),pa(this.actionsDrop),this.dragItems.forEach(t=>{t.obj.recursiveBBoxNeedsUpdate=!0,t.obj.userData.lockedPlane=void 0,t.obj.position.copy(t.position0),t.obj.quaternion.copy(t.quat0),t.obj.updateMatrix()})}},gUe=class extends vu{constructor(t,e){super(t),this.managers=e,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=n=>{var o;if(Nt.length>1)return;this.eventContext.updateRaycaster(n);let{raycaster:i,scene:r}=this.eventContext,s=r.raycastWithClones(i);if(this.lastDropDestination=null,s.length===0){this.activeEvent=null;return}for(let a of this.events){let l=0;for(let{obj:c,pointEnd:h,pointStart:u}of a.dragItems){if(c===s[0].object||c===s[0].object.object||Pn.is(c)&&c.isAncestorOf(s[0].object.uuid)){if(a.activeIdx=l,a.activeDragItem.reset=!1,a.activeDragItem.currentDampingFactor=a.data.dampingFactor,a.activeDragItem.snapped=!1,a.data.cursor==="hand"&&this.setCursor("grabbing"),a.data.render==="on top"){let d=a.activeDragItem.obj;d.renderOrder=1,d.material.depthTest=!1,d.material.transparent0=d.material.transparent,d.material.transparent=!0}if(this.managers.controlsManager.usePhysics){a.activeDragItem.obj.rigidBody&&a.activeDragItem.obj.rigidBody.setBodyType(2,!0);let d=a.activeDragItem.obj;(d.hasNonUniformScale?d.matrixWorldRigid:d.matrixWorld).decompose(An,eS,fr),cD.setFromQuaternion(eS),d.prevR===void 0?(d.prevR=cD.clone(),d.prevT=An.clone()):(d.prevR.copy(cD),d.prevT.copy(An)),this.managers.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(a.activeDragItem.obj)}this.calcPlaneIntersectPos(c,u,a.data.plane,a.data.referenceFrame),h.copy(u),(this.managers.controlsManager.usePhysics&&((o=c.dataPatched.physics)==null?void 0:o.rigidBody)==="dynamic"||a.data.drop===!1||a.data.resetOnSnapFail===!1)&&a.activeDragItem.fromPosition.setFromMatrixPosition(a.activeDragItem.obj.matrixWorld),this.activeEvent=a,this.managers.controlsManager.orbitControls&&(this.managers.controlsManager.orbitControls.enabled=!1);return}l++}}this.activeEvent=null},this.onPointerMove=n=>{var o,a,l,c;if(Nt.length>1)return;this.eventContext.updateRaycaster(n);let{raycaster:i,scene:r}=this.eventContext,s=r.raycastWithClones(i);if(Nt.length===0){let h=!1;for(let u of this.events){for(let{obj:d}of u.dragItems)if(d===((o=s[0])==null?void 0:o.object)||d===((l=(a=s[0])==null?void 0:a.object)==null?void 0:l.object)||Pn.is(d)&&d.isAncestorOf((c=s[0])==null?void 0:c.object.uuid)){switch(h=!0,u.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move");break}break}if(h)break}h||this.setCursor("default");return}if(this.activeEvent&&this.activeEvent.activeDragItem){let h=this.activeEvent.activeDragItem;h.snapped=!1;let u;if(this.activeEvent.data.drop&&(u=s.filter(d=>h.obj!==d.object&&!h.obj.isAncestorOf(d.object.uuid)&&!(d.object instanceof xM)&&(this.activeEvent.data.dropOn==="all"||this.activeEvent.data.dropDestinations.includes(d.object.uuid)))[0]),u){let d=hW.copy(u.face.normal).applyMatrix3(uD.getNormalMatrix(u.object.matrixWorld));if(this.activeEvent.data.snapTo==="center")h.fromPosition.setFromMatrixPosition(u.object.matrixWorld);else if(this.activeEvent.data.snapTo==="surface"){if(h.fromPosition.copy(u.point),this.activeEvent.data.snapSurfaceMode==="bbox"){An.copy(d).applyMatrix3(uD.setFromMatrix4(h.obj.matrixWorld).transpose());let f=h.obj;An.x>hm?fr.x=-f.recursiveBBox.min.x:An.x<-hm&&(fr.x=-f.recursiveBBox.max.x),An.y>hm?fr.y=-f.recursiveBBox.min.y:An.y<-hm&&(fr.y=-f.recursiveBBox.max.y),An.z>hm?fr.z=-f.recursiveBBox.min.z:An.z<-hm&&(fr.z=-f.recursiveBBox.max.z),fr.applyMatrix3(uD.invert())}else fr.copy(d).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);h.fromPosition.add(fr)}this.activeEvent.data.autoOrient&&(An.set(0,1,0).cross(d),An.length()<1e-4&&An.set(-1,0,0).cross(d),fr.crossVectors(hW,An),h.orientationMatrix.makeBasis(An,fr,d)),h.pointStart.copy(h.fromPosition),h.pointEnd.copy(h.pointStart),h.currentDampingFactor=this.activeEvent.snapDampingFactor,h.snapped=!0,this.lastDropDestination!==u.object&&(this.lastDropDestination=u.object,this.activeEvent.actionsDrop.Transition.forEach(f=>{f.play()}),this.activeEvent.actionsDrop.Audio.forEach(f=>{f.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Create.forEach(f=>{f.dispatchThrottled()}))}else h.orientationMatrix.makeRotationFromQuaternion(h.quat0),this.lastDropDestination=null,h.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(h.obj,h.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach(d=>{d.stop(),d.object.currentState!==null&&d.object.changeSelectedState(null,{scene:this.eventContext.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrop.Audio.forEach(d=>{d.dispatchGameControl("stop")});this.activeEvent.actionsDrag.Create.forEach(d=>{d.dispatchThrottled()}),this.activeEvent.wasDragEventTriggered===!1&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach(d=>{d.play()}),this.activeEvent.actionsDrag.Audio.forEach(d=>{d.dispatchGameControl("start")})),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout(()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach(d=>{d.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Transition.forEach(d=>{d.stop(),d.object.currentState!==null&&d.object.changeSelectedState(null,{scene:this.eventContext.scene,shared:this.eventContext.sharedAssets})}))},500),this.updateDragItem(h,this.activeEvent.data.dampingFactor===1)}},this.onPointerUp=n=>{var i;if(this.activeEvent&&this.activeEvent.activeDragItem){if(this.activeEvent.data.cursor==="hand"&&this.setCursor("grab"),this.activeEvent.data.render==="on top"){let s=this.activeEvent.activeDragItem.obj;s.renderOrder=0,s.material.depthTest=!0,s.material.transparent=s.material.transparent0}let r=((i=this.activeEvent.activeDragItem.obj.dataPatched.physics)==null?void 0:i.rigidBody)==="dynamic";this.activeEvent.activeDragItem.snapped===!1&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(this.managers.controlsManager.usePhysics===!1||!r)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.managers.controlsManager.usePhysics&&r&&(this.managers.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),this.activeEvent.wasDragEventTriggered===!0&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach(s=>{s.stop(),s.object.currentState!==null&&s.object.changeSelectedState(null,{scene:this.eventContext.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Audio.forEach(s=>{s.dispatchGameControl("stop")})),this.managers.controlsManager.orbitControls&&(this.managers.controlsManager.orbitControls.enabled=!0)}},t.scene.traverseEntity(n=>{var i;(i=n.data)==null||i.events.filter(r=>r.data.type==="DragDrop"&&!r.data.disabled).forEach(r=>{this.events.push(new mUe(n,r.data,t.scene,t.sharedAssets,e))})})}connect(){if(!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let t=this.eventContext.domElement;t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let t=this.eventContext.domElement;t.removeEventListener("pointerdown",this.onPointerDown),t.removeEventListener("pointermove",this.onPointerMove),t.removeEventListener("pointerup",this.onPointerUp),this.events.forEach(e=>e.dispose())}setCursor(t){this.eventContext.domElement.style.cursor=t}onAnimationFrameDamping(){for(let t of this.events)for(let e of t.dragItems)e.paused||this.updateDragItem(e)}calcPlaneIntersectPos(t,e,n,i){let{camera:r,raycaster:s}=this.eventContext;r.getWorldDirection(ju),ju.negate();let o=eS.identity();switch(i==="local"&&t.matrixWorld.decompose(An,eS,fr),n){case"x":An.set(1,0,0).applyQuaternion(o),um.copy(ju).cross(An),El.copy(An).cross(um);break;case"y":An.set(0,1,0).applyQuaternion(o),um.copy(ju).cross(An),El.copy(An).cross(um);break;case"z":An.set(0,0,1).applyQuaternion(o),um.copy(ju).cross(An),El.copy(An).cross(um);break;case"xy":El.set(0,0,1).applyQuaternion(o);break;case"yz":El.set(1,0,0).applyQuaternion(o);break;case"xz":El.set(0,1,0).applyQuaternion(o);break;case"adaptive":ju.angleTo(fr.set(0,1,0))>Math.PI/6?(An.crossVectors(fr.set(0,1,0),ju),El.crossVectors(An,fr)):El.set(0,1,0);break;default:El.copy(ju);break}if(as.setFromMatrixPosition(t.matrixWorld),uW.setFromNormalAndCoplanarPoint(El,t.userData.lockedPlane?t.userData.worldPosition0:as),!!s.ray.intersectPlane(uW,e)&&(n==="x"||n==="y"||n==="z")){t.userData.lockedPlane&&(n==="x"&&(as.y=t.userData.worldPosition0.y,as.z=t.userData.worldPosition0.z),n==="y"&&(as.x=t.userData.worldPosition0.x,as.z=t.userData.worldPosition0.z),n==="z"&&(as.x=t.userData.worldPosition0.x,as.y=t.userData.worldPosition0.y));let a=fr.subVectors(e,as).dot(An);e.copy(as).addScaledVector(An,a)}}updateDragItem(t,e=!0){var n,i;as.setFromMatrixPosition(t.obj.matrixWorld),t.reset==="current"?Y0.subVectors(t.fromPosition,as).divideScalar(t.currentDampingFactor):t.reset==="original"?(Y0.subVectors(t.obj.userData.worldPosition0,as).divideScalar(t.currentDampingFactor),t.fromPosition.copy(t.obj.userData.worldPosition0),t.pointStart.copy(t.fromPosition),t.pointEnd.copy(t.pointStart)):Y0.subVectors(t.pointEnd,t.pointStart).add(t.fromPosition).sub(as).divideScalar(t.currentDampingFactor),t.paused=t.currentDampingFactor>1?Y0.length()<fUe:!0,e&&pUe(t.obj,Y0.add(as),(n=this.activeEvent)!=null&&n.data.drop&&((i=this.activeEvent)!=null&&i.data.autoOrient)?t.orientationMatrix:null),t.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.managers.eventManager.requestRender()}},dm=new N,hD=new N,Dc=new N,Rc=new N,dW=new no,vUe=.01,yUe={type:"requestRender"},xUe=function(){let t=new N,e=new N;return(n,i,r)=>r>0?(t.subVectors(n,i),t.length()<=r?n:e.copy(i).add(t.normalize().multiplyScalar(r))):i}(),fW=function(){let t=new nt;return(e,n)=>{e.position.copy(n),e.parent!==null&&(t.copy(e.parent.matrixWorld).invert(),e.position.applyMatrix4(t)),t.copy(e.hiddenMatrix).invert(),e.position.applyMatrix4(t),e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),e instanceof Vs&&Xc(e.parent)&&e.invalidateDownstreamBooleanData(!0)}}(),wUe=class{constructor(t,e,n,i,r){this.data=t,this.object=e,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new N,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...hI.defaultData,...t,...t.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},t.target===void 0||t.target==="cursor"||(t.target==="personal camera"?this.target=n.find(Kl.PERSONAL_CAMERA_ID):this.target=n.find(t.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=nl(t,t.actions,n,i,r,e)}},_Ue=class extends vu{constructor(t,e){super(t),this.events=[],this.pairOfEventListeners=[],this.onMouseMove=i=>{if(!(Nt.length>1)){this.eventContext.updateRaycaster(i);for(let r of this.events)r.target===void 0&&this.updateSingleEvent(r)}},this.onMouseEnter=i=>{for(let r of this.events)r.target===void 0&&(r.isReset=!1,r.currentDampingFactor=r.data.dampingFactor)},this.onMouseLeave=i=>{for(let r of this.events)r.target===void 0&&(r.data.resetOnPointerLeave&&(r.isReset=!0,r.currentDampingFactor=r.resetDampingFactor),this.updateSingleEvent(r))},this.onTargetChange=i=>()=>{this.updateSingleEvent(i)};let{scene:n}=this.eventContext;n.traverseEntity(i=>{var s,o;let r=(s=i.data)==null?void 0:s.events.find(a=>a.data.type==="Follow"&&!a.data.disabled);r&&(!n.data.environment.usePhysics||((o=i.dataPatched.physics)==null?void 0:o.rigidBody)!=="dynamic")&&this.events.push(new wUe(r.data,i,n,t.sharedAssets,e))})}connect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),fo&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),e.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let n of this.events)if(n.target!==void 0){let i=n.target,r=this.onTargetChange(n);this.pairOfEventListeners.push([i,r]),i.addEventListener("requestRender",r)}}disconnect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),fo&&t.removeEventListener("pointerdown",this.onMouseMove),e.removeEventListener("pointermove",this.onMouseMove),t.removeEventListener("pointerenter",this.onMouseEnter),t.removeEventListener("pointerleave",this.onMouseLeave);for(let[n,i]of this.pairOfEventListeners)n.removeEventListener("requestRender",i);for(let n of this.events)n.paused=!0,n.isReset=!1,pa(n.actions)}onAnimationFrameDamping(){for(let t of this.events)t.paused||this.updateSingleEvent(t)}updateSingleEvent(t){var s;this.events.forEach(o=>{o.actions.Create.forEach(a=>{a.dispatchThrottled()})});let{plane:e,limitDistance:n,limitDistanceEnabled:i}=t.data;if(t.object.getWorldPosition(Dc),t.isReset)Rc.copy(t.worldPosition0);else if(t.target)t.target.getWorldPosition(Rc);else{let{camera:o,raycaster:a}=this.eventContext;if(e==="custom"?(o.getWorldDirection(hD),hD.negate(),dm.copy(hD)):e==="xy"?dm.set(0,0,1):e==="xz"?dm.set(0,1,0):e==="yz"&&dm.set(1,0,0),dW.setFromNormalAndCoplanarPoint(dm,Dc),!a.ray.intersectPlane(dW,Rc))return}if(!t.isReset){if(Rc.distanceTo(t.worldPosition0)>n&&i&&t.target)if(t.snapComplete=!1,t.data.snapDelay&&(t.delayFinished=!1,typeof window<"u"&&t.timeoutId!==null&&(window.clearTimeout(t.timeoutId),t.timeoutId=null)),t.wasOutside=!0,t.data.resetAfterDistanceLimit)Rc.copy(t.worldPosition0),t.currentDampingFactor=t.resetDampingFactor;else return;else if(t.wasOutside&&(t.data.snapDelay&&typeof window<"u"&&(t.timeoutId=window.setTimeout(()=>{t.delayFinished=!0,t.paused=!1,this.updateSingleEvent(t)},t.data.snapDelay*1e3)),t.currentDampingFactor=t.data.dampingFactor,t.wasOutside=!1),t.delayFinished===!1)return}t.data.enabledTranslation[0]===!1&&(Rc.x=Dc.x),t.data.enabledTranslation[1]===!1&&(Rc.y=Dc.y),t.data.enabledTranslation[2]===!1&&(Rc.z=Dc.z);let r=xUe(Dc,Rc,t.wasOutside?0:t.data.maxDelta);if(t.currentDampingFactor>1){let o=dm.subVectors(r,Dc).divideScalar(t.currentDampingFactor);Dc.add(o),fW(t.object,Dc),t.paused=o.length()<vUe}else fW(t.object,r),t.paused=!0;(s=t.object)==null||s.dispatchEvent({type:"beginEvent",eventName:"Follow"}),t.object.dispatchEvent(yUe)}},q0=new N,tS=new N,Q0=new nt,fm=new on,Wu=new on,K0=new N,J0=new N,Id=new N,Lc=new N,dD=new no,bUe=1e-6,SUe={type:"requestRender"},AUe={type:"changeRotation"},pW=function(){let t=new nt;return function(e,n){e.parent!==null?t.multiplyMatrices(e.parent.matrixWorld,e.hiddenMatrix):t.copy(e.hiddenMatrix),n.premultiply(p$(t).invert()),e.rotation.setFromRotationMatrix(n),e.updateMatrix(),e instanceof Vs&&Xc(e.parent)&&e.invalidateDownstreamBooleanData(!0)}}(),MUe=class{constructor(t,e,n){this.object=e,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new on,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...dI.defaultData,...t,...t.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},t.target===void 0||t.target==="cursor"||(t.target==="personal camera"?this.target=n.find(Kl.PERSONAL_CAMERA_ID):this.target=n.find(t.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},EUe=class extends vu{constructor(t){super(t),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=n=>{if(!(Nt.length>1)){this._lastMouseEvent=n,this.eventContext.updateRaycaster(n);for(let i of this.events)i.target===void 0&&this.updateSingleEvent(i)}},this.onMouseEnter=n=>{for(let i of this.events)i.target===void 0&&(i.isReset=!1,i.currentDampingFactor=i.data.dampingFactor)},this.onMouseLeave=n=>{for(let i of this.events)i.target===void 0&&(i.data.resetOnPointerLeave&&(i.isReset=!0,i.currentDampingFactor=i.resetDampingFactor),this.updateSingleEvent(i))},this.onScroll=n=>{if(this._lastMouseEvent){let i=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(i)}},this.onTargetChange=n=>()=>{this.updateSingleEvent(n)},this.createUserEventListener=n=>({eventName:i,target:r})=>{if(!i||!r)return;let s=j1(i);s&&s==="LookAt"&&this.updateSingleEvent(n)};let{scene:e}=this.eventContext;e.traverseEntity(n=>{var r,s;let i=(r=n.data)==null?void 0:r.events.find(o=>o.data.type==="LookAt"&&!o.data.disabled);i&&(!e.data.environment.usePhysics||((s=n.dataPatched.physics)==null?void 0:s.rigidBody)!=="dynamic")&&this.events.push(new MUe(i.data,n,e))})}connect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),fo&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),e.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?e.addEventListener("scroll",this.onScroll):(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let n of this.events){if(n.target!==void 0){let s=this.onTargetChange(n),o=n.target;this.pairOfEventListeners.push([o,s]),o.addEventListener("requestRender",s)}let i=this.createUserEventListener(n),r=n.object;this.pairOfUserEventListeners.push([r,i]),r.addEventListener("userEvent",i)}}disconnect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),fo&&t.removeEventListener("pointerdown",this.onMouseMove),e.removeEventListener("pointermove",this.onMouseMove),t.removeEventListener("pointerenter",this.onMouseEnter),t.removeEventListener("pointerleave",this.onMouseLeave),e.removeEventListener("scroll",this.onScroll);for(let[n,i]of this.pairOfEventListeners)n.removeEventListener("requestRender",i);for(let[n,i]of this.pairOfUserEventListeners)n.removeEventListener("userEvent",i);for(let n of this.events)n.paused=!0,n.isReset=!1}onAnimationFrameDamping(){for(let t of this.events)t.paused||this.updateSingleEvent(t)}updateSingleEvent(t){var d;let{tilt:e,axis:n,distance:i,plane:r,limitDistance:s,enabledRotation:o,limitDistanceEnabled:a}=t.data,{camera:l,raycaster:c}=this.eventContext,{object:h,target:u}=t;if(h.getWorldPosition(K0),!t.isReset)if(t.target)t.target.getWorldPosition(J0);else{if(r==="custom"?(l.getWorldDirection(tS),tS.negate(),dD.setFromNormalAndCoplanarPoint(tS,K0)):(r==="xy"?q0.set(0,0,1):r==="xz"?q0.set(0,1,0):r==="yz"&&q0.set(1,0,0),dD.setFromNormalAndCoplanarPoint(q0,K0)),!c.ray.intersectPlane(dD,J0))return;i>0&&(r==="custom"||r===void 0)&&J0.addScaledVector(tS,i)}if(t.isReset||(u?e==="target"?Id.copy(u.up).applyMatrix4(Q0.extractRotation(u.matrixWorld)).normalize():o.some(f=>f===!1)?(n==="x"?(Lc.set(0,0,1),o[2]===!1&&Lc.set(0,1,0)):n==="y"?(Lc.set(1,0,0),o[0]===!1&&Lc.set(0,0,1)):(Lc.set(0,1,0),o[1]===!1&&Lc.set(1,0,0)),Id.copy(Lc).applyQuaternion(t.worldQuaternion0).normalize()):Id.set(0,1,0):r==="custom"?Id.set(0,1,0):Id.copy(q0)),t.isReset)Wu.copy(t.worldQuaternion0);else if(K0.distanceTo(J0)>s&&a&&u)if(t.data.snapDelay&&(t.delayFinished=!1,typeof window<"u"&&t.timeoutId!==null&&(window.clearTimeout(t.timeoutId),t.timeoutId=null)),t.wasOutside=!0,t.data.resetAfterDistanceLimit)Wu.copy(t.worldQuaternion0),t.currentDampingFactor=t.resetDampingFactor;else return;else{if(t.wasOutside&&(t.data.snapDelay&&typeof window<"u"&&(t.timeoutId=window.setTimeout(()=>{t.delayFinished=!0,t.paused=!1,this.updateSingleEvent(t)},t.data.snapDelay*1e3)),t.currentDampingFactor=t.data.dampingFactor,t.wasOutside=!1),t.delayFinished===!1)return;CUe(Q0,J0,K0,Id,n,Lc),Wu.setFromRotationMatrix(Q0),fm.setFromUnitVectors(Lc.applyQuaternion(Wu),Id),o.some(f=>f===!1)&&e!=="target"&&Wu.premultiply(fm).normalize()}t.currentDampingFactor>1?(h.updateWorldMatrix(!0,!1),fm.setFromRotationMatrix(p$(h.matrixWorld)),fm.slerp(Wu,1/t.currentDampingFactor),pW(h,Q0.makeRotationFromQuaternion(fm)),t.paused=8*(1-fm.dot(Wu))<bUe):(pW(h,Q0.makeRotationFromQuaternion(Wu)),t.paused=!0),(d=t.object)==null||d.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),h.dispatchEvent(SUe),h.dispatchEvent(AUe)}},Ho=new N,Qi=new N,Ti=new N;function CUe(t,e,n,i,r,s){let o=t.elements;Ti.subVectors(e,n),Ti.lengthSq()===0&&(Ti.z=1),Ti.normalize(),Qi.crossVectors(i,Ti),Qi.lengthSq()===0&&(Math.abs(i.z)===1?Ti.x+=1e-4:Ti.z+=1e-4,Ti.normalize(),Qi.crossVectors(i,Ti)),Qi.normalize(),Ho.crossVectors(Ti,Qi),r==="x"?s.z===1?[Qi,Ho,Ti]=[Ti,Qi,Ho]:(Qi.negate(),[Qi,Ti]=[Ti,Qi]):r==="y"?s.x===1?[Qi,Ho,Ti]=[Ho,Ti,Qi]:(Qi.negate(),[Ho,Ti]=[Ti,Ho]):s.x===1&&(Qi.negate(),[Qi,Ho]=[Ho,Qi]),o[0]=Qi.x,o[4]=Ho.x,o[8]=Ti.x,o[1]=Qi.y,o[5]=Ho.y,o[9]=Ti.y,o[2]=Qi.z,o[6]=Ho.z,o[10]=Ti.z}var TUe=class{constructor(t,e,n,i,r,s){this.id=t,this.data=e,this.object=n,this.entered=!1,this.actions=nl(e,e.actions,i,r,s,n)}disconnect(){pa(this.actions)}dispatchEnter(){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.entered||(this.entered=!0,this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatch()),this.actions.Destroy.forEach(t=>t.dispatch()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent()))}dispatchLeave(){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.entered&&(this.entered=!1,this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent()))}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent()))}},PUe=class extends vu{constructor(t,e){super(t),this.eventsPerObjects={},this.objects=[],this._prevObjects=[],this.onMouseDown=r=>{Nt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onMouseUp=r=>{Nt.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=r=>{Nt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onUserEvent=({eventName:r,target:s,reverse:o})=>{var l;if(!r||!s)return;let a=j1(r);a&&a==="MouseHover"&&(s.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(l=this.eventsPerObjects[s.uuid])==null||l.forEach(c=>c.dispatchUserEvent(o)))};let{scene:n,sharedAssets:i}=this.eventContext;n.traverseEntity(r=>{var s,o;if(!(!r.visible||!((s=r.data)!=null&&s.events.length))){for(let{id:a,data:l}of r.data.events)if(!l.disabled&&l.type==="MouseHover")try{let c=new TUe(a,l,r,n,i,e);this.eventsPerObjects[r.uuid]?this.eventsPerObjects[r.uuid].push(c):this.eventsPerObjects[r.uuid]=[c]}catch{}(o=this.eventsPerObjects[r.uuid])!=null&&o.length&&this.objects.push(r)}})}connect(){if(!this.objects.length)return;let{domElement:t}=this.eventContext;this.domEventsNeeded.clear(),fo&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),t.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),t.addEventListener("pointermove",this.onMouseMove),this.objects.forEach(e=>{e.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if(!this.objects.length)return;let{domElement:t}=this.eventContext;this.domEventsNeeded.clear(),fo&&(t.removeEventListener("pointerdown",this.onMouseDown),t.removeEventListener("pointerup",this.onMouseUp)),t.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach(e=>{e.forEach(n=>{n.disconnect()})}),this.objects.forEach(e=>{e.removeEventListener("userEvent",this.onUserEvent)})}handleMouseHoverEvent(t=!1){let e=[];if(!t){let{stopRaycast:n,raycaster:i,scene:r}=this.eventContext;if(n){let s=QI(i,r,this.objects);e=KI(s)}else this.objects.forEach(s=>{_M(i,s)&&e.push(s)})}this._prevObjects.length&&this._prevObjects.forEach(n=>{var i;e.includes(n)||(n.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(i=this.eventsPerObjects[n.uuid])==null||i.forEach(r=>r.dispatchLeave()))}),e.length&&e.forEach(n=>{var i;n.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(i=this.eventsPerObjects[n.uuid])==null||i.forEach(r=>r.dispatchEnter())}),this._prevObjects=e}},DUe=class{constructor(t,e,n,i,r,s){this.id=t,this.data=e,this.object=n,this.scrollCounter=0,this.actions=nl(e,e.actions,i,r,s,n)}connect(){this.scrollCounter=0}disconnect(){pa(this.actions)}dispatch(t){this.actions.Transition.forEach(i=>{i.object.currentTransitionEvent!==this&&(i.object.currentTransitionEvent=this,i.init())});let e=t>0?1:-1;this.scrollCounter+=e,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let n=this.scrollCounter/this.data.steps;this.actions.Transition.forEach(i=>i.seek(n)),this.actions.Create.forEach(i=>i.dispatchThrottled())}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?this.actions.Transition.forEach(e=>e.reverseFromCurrent()):this.actions.Transition.forEach(e=>{e.playFromCurrent()}),this.actions.Create.forEach(e=>e.dispatchThrottled())}},RUe=class{constructor(t,e,n,i,r,s,o){this.id=t,this.data=e,this.object=n,this.domElement=s,this.managers=o,this.scrollStart=0,this.scrollEnd=0,this.actions=nl(e,e.actions,i,r,o,n)}computeScrollBounds(){let t=this.domElement.getBoundingClientRect(),e=document.body,n=document.documentElement,i=window.pageYOffset||n.scrollTop||e.scrollTop,r=n.clientTop||e.clientTop||0,s=Math.round(t.top+i-r);if(this.data.startFrom==="enter"){let o=window.innerHeight,a=t.height,l=this.data.enterAnchor,c=l==="top"?o:l==="bottom"?o-a:o-a*.5;this.scrollStart=s-c}else this.scrollStart=0;this.scrollStart+=this.data.startOffset??0,this.scrollEnd=this.scrollStart+(this.data.endAfter??400),this.dispatch({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){pa(this.actions)}handleResize(){this.computeScrollBounds()}dispatch({x:t,y:e}){this.actions.Transition.forEach(r=>{r.object.currentTransitionEvent!==this&&(r.object.currentTransitionEvent=this,r.init())});let n=this.scrollEnd-this.scrollStart,i=Math.min(1,Math.max(0,(e-this.scrollStart)/n));this.actions.Transition.forEach(r=>r.seek(i)),this.actions.Create.forEach(r=>r.dispatchThrottled())}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?this.actions.Transition.forEach(e=>e.reverseFromCurrent()):this.actions.Transition.forEach(e=>{e.playFromCurrent()}),this.actions.Create.forEach(e=>e.dispatchThrottled())}},LUe=class extends vu{constructor(t,e){super(t),this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach(([o,a])=>{a.forEach(l=>l.handleResize())})},this.onScroll=o=>{if(!this.isInview)return;let a={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach(([l,c])=>{l.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:a}),c.forEach(h=>h.dispatch(a))})},this.onWheel=o=>{!this.isInview||o.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach(([a,l])=>{a.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:o.deltaY}),l.forEach(c=>c.dispatch(o.deltaY))})},this.onUserEvent=({eventName:o,target:a,reverse:l})=>{var h;if(!o||!a)return;let c=j1(o);c&&c==="Scroll"&&(a.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),(h=this.wheelEventsPerObject.get(a))==null||h.forEach(u=>{u.dispatchUserEvent(l)}))};let{scene:n,sharedAssets:i,domElement:r,isExport:s}=this.eventContext;n.traverseEntity(o=>{var a,l,c;if((a=o.data)!=null&&a.events.length){for(let{id:h,data:u}of o.data.events)if(!u.disabled&&u.type==="Scroll")if(u.trigger==="load"||!s){let d=new DUe(h,u,o,n,i,e);this.wheelEventsPerObject.has(o)?(l=this.wheelEventsPerObject.get(o))==null||l.push(d):this.wheelEventsPerObject.set(o,[d])}else{let d=new RUe(h,u,o,n,i,r,e);this.scrollEventsPerObject.has(o)?(c=this.scrollEventsPerObject.get(o))==null||c.push(d):this.scrollEventsPerObject.set(o,[d])}}}),this.intersectionObserver=new IntersectionObserver(o=>{let a=o[0];a&&(this.isInview=a.isIntersecting)},{root:null})}connect(){this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(n=>n.connect()),t.addEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(n=>n.connect()),t.addEventListener("userEvent",this.onUserEvent)}),[...this.wheelEventsPerObject.values()].some(t=>t.length)&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some(t=>t.length)&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(n=>n.disconnect()),t.removeEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(n=>n.disconnect()),t.removeEventListener("userEvent",this.onUserEvent)})}},IUe=class{constructor(t,e,n,i,r,s){this.id=t,this.data=e,this.object=n,this.actions=nl(e,e.actions,i,r,s,n)}disconnect(){pa(this.actions)}dispatch(){this.actions.Transition.forEach(t=>{t.play()}),this.actions.SwitchCamera.forEach(t=>{t.play()}),this.actions.Create.forEach(t=>{t.dispatchFromStart()}),this.actions.Destroy.forEach(t=>{t.dispatchFromStart()})}dispatchAfter(t){this.actions.Audio.forEach(e=>{(e.interaction.data.triggerAfter??"any")===t&&(e.interaction instanceof $m?e.interaction.audioPlayer.play():e.interaction instanceof JI&&e.interaction.dispatch())}),this.actions.Video.forEach(e=>{let n=e.interaction.data.triggerAfter??"autoplay";n===t&&(e.interaction instanceof Vy?e.interaction.play(n==="autoplay"):e.interaction instanceof ZI&&e.interaction.dispatch())})}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent())),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch()}),this.actions.Audio.forEach(e=>{e.interaction instanceof $m?e.interaction.audioPlayer.play():e.interaction instanceof JI&&e.interaction.dispatch()}),this.actions.Video.forEach(e=>{e.interaction instanceof Vy?e.interaction.play():e.interaction instanceof ZI&&e.interaction.dispatch()})}},BUe=class extends vu{constructor(t,e){super(t),this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,s])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),s.forEach(o=>{o.dispatchAfter("mouseDown")})})},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,s])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),s.forEach(o=>{o.dispatchAfter("keyDown")})})},this.onAny=()=>{let{domElement:r,isExport:s}=this.eventContext;(s?document:r).removeEventListener("pointerdown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([o,a])=>{o.dispatchEvent({type:"beginEvent",eventName:"Start"}),a.forEach(l=>{l.dispatchAfter("any")})})},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,s])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),s.forEach(o=>{o.dispatchAfter("autoplay")})})},this.onUserEvent=({eventName:r,target:s,reverse:o})=>{var l,c;if(!r||!s)return;let a=j1(r);a&&a==="Start"&&(s.dispatchEvent({type:"beginEvent",eventName:"Start"}),(l=this.eventsPerObject.get(s))==null||l.forEach(h=>{h.dispatchUserEvent(o)}),(c=this.eventsAfterPerObject.get(s))==null||c.forEach(h=>{h.dispatchUserEvent(o)}))};let{scene:n,sharedAssets:i}=this.eventContext;n.traverseEntity(r=>{var s,o,a,l;if((s=r.data)!=null&&s.events.length)for(let{id:c,data:h}of r.data.events){if(h.disabled||h.type!=="Start")continue;let u=new IUe(c,h,r,n,i,e);(u.actions.Transition.length||u.actions.SwitchCamera.length||u.actions.Create.length||u.actions.Destroy.length)&&(this.eventsPerObject.has(r)?(o=this.eventsPerObject.get(r))==null||o.push(u):this.eventsPerObject.set(r,[u])),u.actions.Audio.length&&(this.eventsAfterPerObject.has(r)?(a=this.eventsAfterPerObject.get(r))==null||a.push(u):this.eventsAfterPerObject.set(r,[u])),u.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(r)?(l=this.eventsAfterPerObject.get(r))==null||l.push(u):this.eventsAfterPerObject.set(r,[u]))}})}connect(){if([...this.eventsAfterPerObject.values()].some(t=>t.length)){let{domElement:t,isExport:e}=this.eventContext,n=e?document:t;n.addEventListener("pointerdown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),n.addEventListener("pointerdown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([i,r])=>{i.addEventListener("userEvent",this.onUserEvent)}),this.onPlay()}[...this.eventsPerObject.entries()].forEach(([t,e])=>{t.dispatchEvent({type:"beginEvent",eventName:"Start"}),e.forEach(n=>n.dispatch()),t.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if([...this.eventsAfterPerObject.values()].some(t=>t.length)){let{domElement:t,isExport:e}=this.eventContext,n=e?document:t;n.removeEventListener("pointerdown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),n.removeEventListener("pointerdown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([i,r])=>{i.removeEventListener("userEvent",this.onUserEvent),r.forEach(s=>s.disconnect())})}[...this.eventsPerObject.entries()].forEach(([t,e])=>{t.removeEventListener("userEvent",this.onUserEvent),e.forEach(n=>n.disconnect())})}},OUe=class{constructor(t,e,n,i,r,s){this.id=t,this.data=e,this.object=n,this.disabled=!0,this.actions=nl(e,e.actions,i,r,s,n),this.target=e.target,this.useToggle=e.toggle}disconnect(){pa(this.actions)}dispatch(t){this.disabled||(this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.useToggle?this.actions.Transition.forEach(e=>{e.toggle()}):this.actions.Transition.forEach(e=>{e.play()}),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch(t??!1)}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}))}},ei;lLe.then(t=>ei=t);var Ni=new N,Da=new on,Xu=new N,fD=new Dr(0,0,0,"YXZ"),FUe={type:"updateMatrix"},X$={type:"beginEvent",eventName:"Collision"};function NUe(t){if(t.scene.environment.usePhysics)return!0;let e=!1;return t.scene.objects.traverse((n,i)=>{for(let r of i.events)if(r.data.disabled!==!0&&r.data.type==="GameControl"&&r.data.collisionEnabled){e=!0;break}}),e}var mW=t=>t.states.some(e=>e.data.position!==void 0||e.data.rotation!==void 0||e.data.hiddenMatrix!==void 0||e.data.cloner!==void 0||e.data.pathSnapping!==void 0),UUe=class{constructor(t,e,n,i,r,s=!1){var g;this.scene=e,this.requestRender=i,this.sharedAssets=r,this.isExport=s,this.orbitControlsNeedsUpdate=!0,this.gameControls=[],this.gameControlStates=[],this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],eventsPerObjects:{},colliderToEntity:{},gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.processRigidBody=m=>{if(m.bodyType()!==ei.RigidBodyType.Dynamic)return;m.isSleeping()||this.nActiveRigidBodies++;let[y,w,b]=this.rigidBodyToMesh.get(m.handle);if(Ni.copy(m.translation()).multiplyScalar(this.pixelsPerMeter),Da.copy(m.rotation()),y.matrixWorld.compose(Ni,Da,w),y.hasNonUniformScale&&y.matrixWorld.multiply(y.shearScale),y.dispatchEvent(FUe),b){let A=y.cloner;if(A&&A.objectForSample===void 0){A.matrixWorld.copy(y.matrixWorld);for(let S of A.children)S.updateMatrixWorld(!0)}for(let S of y.children)S.updateMatrixWorld(!0)}},this.handleCollisionEvents=(m,y,w)=>{var b,A;if(w!==!1){for(let S=this.sharedGameControlGlobals.createdObjects.length-1;S>=0;S--){let T=this.sharedGameControlGlobals.createdObjects[S];if(T.userData.hasCollisionDestroy&&(((b=T.rigidBody)==null?void 0:b.collider(0).handle)===m||((A=T.rigidBody)==null?void 0:A.collider(0).handle)===y)){this.sharedGameControlGlobals.createdObjects.splice(S,1),T.removeFromParent(),requestAnimationFrame(()=>{var M;return(M=this.sharedGameControlGlobals.rapierWorld)==null?void 0:M.removeRigidBody(T.rigidBody)});break}}if(this.gameControls.some(S=>S.object===this.sharedGameControlGlobals.colliderToEntity[m])){let S=this.sharedGameControlGlobals.colliderToEntity[y],T=this.sharedGameControlGlobals.eventsPerObjects[S.uuid];if(T===void 0)return;for(let M of T)M.data.target==="character"&&this.dispatchCollisionEvent(M,S,y)}else if(this.gameControls.some(S=>S.object===this.sharedGameControlGlobals.colliderToEntity[y])){let S=this.sharedGameControlGlobals.colliderToEntity[m],T=this.sharedGameControlGlobals.eventsPerObjects[S.uuid];if(T===void 0)return;for(let M of T)M.data.target==="character"&&this.dispatchCollisionEvent(M,S,m)}else{let S=this.sharedGameControlGlobals.colliderToEntity[m],T=this.sharedGameControlGlobals.eventsPerObjects[S.uuid];if(T!==void 0)for(let P of T)P.data.target==="scene"&&this.dispatchCollisionEvent(P,S,m);let M=this.sharedGameControlGlobals.colliderToEntity[y],E=this.sharedGameControlGlobals.eventsPerObjects[M==null?void 0:M.uuid];if(E!==void 0)for(let P of E)P.data.target==="scene"&&this.dispatchCollisionEvent(P,M,y)}}},this.domElement=n.domElement;let o;t.scene.publish.playCamera===null?o=Kl.PERSONAL_CAMERA_ID:o=t.scene.publish.playCamera;let a=this.scene.find(o),l=!1,c,h=5,u=8,d=9,f="drag";if(this.usePhysics=t.scene.environment.usePhysics??io.defaultData.usePhysics,this.pixelsPerMeter=t.scene.environment.pixelsPerMeter??io.defaultData.pixelsPerMeter,this.gravity=t.scene.environment.gravity??io.defaultData.gravity,(g=t.scene.objects.data(t.scene.publish.gameControlObject))==null||g.events.forEach(m=>{m.data.disabled!==!0&&m.data.type==="GameControl"&&(c=m.data.keyAssignments,h=m.data.joystickPosLoc,u=m.data.joystickRotLoc,d=m.data.jumpTouchButtonLoc,f=m.data.rotByTouch)}),this.scene.traverseEntity(m=>{m.dataPatched.events.forEach(y=>{var b,A;if(y.data.disabled||y.data.type!=="GameControl")return;let w=m;for(;((b=w=w.parent)==null?void 0:b.parent)!==null;)if((A=w.dataPatched.physics)!=null&&A.fusedBody)return;y.data.collisionEnabled&&(this.needsCollisionDetection=!0),this.gameControlStates.push([m,y.data])})}),this.gameControlStates.forEach(([m,y])=>{l=l||y.camera===a.uuid||m.uuid===a.uuid;let w=new Y$(m,n.domElement,{...y,keyAssignments:c},t.scene.environment,this,m.uuid!==a.uuid&&y.camera===a.uuid,a,this.scene,r);w.addEventListener("change",i),w.addEventListener("end",i),w.addEventListener("start",i),this.gameControls.push(w),fo&&y.touchControl&&(this.joystickToGameControls[h]!==void 0?this.joystickToGameControls[h].push([w,"pos"]):this.joystickToGameControls[h]=[[w,"pos"]],y.moveMode==="walk"&&(this.joystickToGameControls[d]!==void 0?this.joystickToGameControls[d].push([w,"jmp"]):this.joystickToGameControls[d]=[[w,"jmp"]]),f==="joystick"&&(this.joystickToGameControls[u]!==void 0?this.joystickToGameControls[u].push([w,"rot"]):this.joystickToGameControls[u]=[[w,"rot"]]))}),l===!1){let{enableRotate:m,enablePan:y,enableZoom:w,autoRotate:b,hoverRotatePanMode:A}=t.scene.publish.orbitControls;(m||y||w||b||A!==0)&&(this.orbitControls=new q$(a,n.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",i),this.orbitControls.addEventListener("end",i),this.orbitControls.addEventListener("start",i),this.orbitControls.fromJSON(t.scene.publish.orbitControls,t.scene.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let p=n.domElement.width/n.getPixelRatio(),v=n.domElement.height/n.getPixelRatio();this.joystickToGameControls.forEach((m,y)=>{let w=document.body.appendChild(document.createElement("div")),[b,A,S]=(t.scene.publish.joystickSizeAndXYOffset??ev.defaultData.joystickSizeAndXYOffset)[y],T=(p-5*b)/4+b,M={},E=m.some(B=>B[1]==="jmp"),P=E?0:b;y<10?(y<5?M.top=P/2:M.bottom=P/2,M.left=P/2+y%5*T):y===10?(M.left=P/2,M.top=v/2):(M.right=P/2,M.top=v/2),M.top?M.top-=A[1]:M.bottom+=A[1],M.left?M.left+=A[0]:M.right-=A[0];for(let B in M)M[B]+="px";if(E){let B=w.appendChild(document.createElement("div"));Object.assign(B.style,M,{position:"absolute",width:b+"px",height:b+"px",backgroundColor:`rgba(255,255,255,${S==="show"?.4:0})`,zIndex:"9999",borderRadius:b+"px",border:S==="show"?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let k=b/16*16*.4;S==="show"&&(B.innerHTML=`
						<svg width="${k}" height="${b*.4}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					`),B.addEventListener("pointerdown",()=>{m.forEach(j=>{j[0].movementState.jump=1}),i()}),B.addEventListener("touchend",j=>j.preventDefault()),this.joysticks[y]=[void 0,w];return}let R={zone:w,mode:"static",position:M,size:b};S==="hide"&&(R.restOpacity=0);let F=BFe.create(R);F.on("move",(B,k)=>{m.forEach(j=>{let Z=j[0];j[1]==="pos"?k.force<.2?Z.moveForce=0:(Z.movementState.movePosZ=Math.sin(-k.angle.radian),Z.movementState.movePosX=Math.cos(-k.angle.radian),k.force<.3?Z.moveForce=(k.force-.2)/.1:Z.moveForce=1):k.force<.2?Z.rotForce=0:(Z.movementState.rotPosX=k.vector.y,Z.movementState.rotPosY=-k.vector.x,k.force<.3?Z.rotForce=(k.force-.2)/.1:Z.rotForce=1)}),i()}),F.on("end",(B,k)=>{m.forEach(j=>{let Z=j[0];j[1]==="pos"?(Z.movementState.movePosZ=0,Z.movementState.movePosX=0,Z.moveForce=1):(Z.movementState.rotPosX=0,Z.movementState.rotPosY=0,Z.rotForce=1)})}),this.joysticks[y]=[F,w]})}attachVRControllers(t){t.forEach(e=>{e.addEventListener("connected",n=>{"gamepad"in n.data&&"axes"in n.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(n.data.gamepad)})})}markIsDestroyTarget(){this.scene.traverseVisibleEntity(t=>{var n,i;let e=t.dataPatched;for(let r of e.events){if(r.data.disabled===!0)continue;let s=(i=(n=r.data.actions)==null?void 0:n.find(o=>o.data.type==="Destroy"))==null?void 0:i.data;if(s)for(let o of s.objects){let a=this.scene.find(o);a&&(a.userData.hasDestroy=!0)}}})}markIsDragObject(){this.scene.traverseVisibleEntity(t=>{let e=t.dataPatched;for(let n of e.events)if(!(n.data.disabled===!0||n.data.type!=="DragDrop"))for(let i of n.data.objects){let r=this.scene.find(i);r&&(r.userData.hasDrag=!0)}})}initBVH(){let t=[];if(this.scene.traverseObject(e=>{let n;if(e instanceof cf)return;e instanceof zl?n=e.object:n=e;let i=n.dataPatched;if(i.collision==="visibility"?!i.visible:!i.collision)return!0;let r=e.geometry,s=n.userData.hasDestroy===!0,o=n.userData.hasDrag===!0;if(mW(i)||s||o||n.dataPatched.events.some(a=>a.data.disabled!==!0&&a.data.type==="GameControl"))return e.updateMatrixWorldSVD(),this.addBoundsTree(e),!0;r&&t.push(cm(r,e.matrixWorld))}),t.length>0){let e=Qm(t,!1);this.sharedGameControlGlobals.staticMeshBVH=new Or(e)}}addRigidBody(t,e,n){let i=[],r=t.geometry,s=e.dataPatched;if((r==null?void 0:r.getAttribute("position"))!==void 0&&i.push(cm(r,t.shearScale)),s.physics.fusedBody){let o=this.gatherChildrenGeom(t,i);t.traverseObject(o),t.children.forEach(l=>l.updateMatrixWorld(!0));let a=t.cloner;a&&a.objectForSample===void 0&&s.physics.rigidBody==="dynamic"&&(a.traverseObject(o),a.children.forEach(l=>l.updateMatrixWorld(!0)))}if(i.length>0){let o,a=!n.fromCreate&&s.physics.rigidBody==="dynamic"||n.fromCreate&&n.dynamic;a?(o=ei.RigidBodyDesc.dynamic(),o.setLinearDamping(s.physics.damping).setAdditionalMass(1e-9).setGravityScale(s.physics.gravityScale).enabledRotations(...s.physics.enabledRotation).enabledTranslations(...s.physics.enabledTranslation)):(n.hasTransformAnim||n.hasFollow||n.hasDrag)&&!n.fromCreate?(o=ei.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(t)):o=ei.RigidBodyDesc.fixed();let l=Qm(i);(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(Ni,Da,Xu),t.position0=Ni.clone().divideScalar(this.pixelsPerMeter),t.rotation0=Da.clone(),Ni.divideScalar(this.pixelsPerMeter),o.setTranslation(Ni.x,Ni.y,Ni.z).setRotation(Da),r?l==null||l.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):l==null||l.scale(Xu.x/this.pixelsPerMeter,Xu.y/this.pixelsPerMeter,Xu.z/this.pixelsPerMeter);let c=this.sharedGameControlGlobals.rapierWorld.createRigidBody(o);a&&this.rigidBodyToMesh.set(c.handle,[t,Xu.clone(),s.physics.fusedBody]);let h=!(s.geometry===void 0||s.geometry.type==="SubdivGeometry"||s.geometry.type==="NonParametricGeometry"||s.geometry.type==="BooleanGeometry"||s.geometry.type==="VectorGeometry"||s.geometry.type==="StarGeometry"||s.geometry.type==="RectangleGeometry"||s.geometry.type==="EllipseGeometry"||s.geometry.type==="TriangleGeometry"||s.geometry.type==="TorusGeometry"||s.geometry.type==="HelixGeometry");try{this.addCollider(c,s.physics,l,n.fromCreate?void 0:e,h)}catch{try{this.addCollider(c,s.physics,l,n.fromCreate?void 0:e,!1)}catch(u){console.error(u)}}t.rigidBody=c}}addBoundsTree(t){let e=[];if("geometry"in t&&t.geometry.getAttribute("position")!==void 0&&e.push(cm(t.geometry,t.shearScale)),t.traverseObject(this.gatherChildrenGeom(t,e)),t.children.forEach(n=>n.updateMatrixWorld(!0)),e.length>0){let n=Qm(e,!1);t.boundsTree=new Or(n),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(t)}}addCollider(t,e,n,i,r=!0){var a,l;if((n==null?void 0:n.getAttribute("position").count)===0||((a=n==null?void 0:n.getIndex())==null?void 0:a.count)===0)return;let s;n&&(e.colliderType==="trimesh"?s=ei.ColliderDesc.trimesh(n.getAttribute("position").array,n.getIndex().array):s=ei.ColliderDesc.convexMesh(n.getAttribute("position").array,r?n.getIndex().array:void 0)),s.setFrictionCombineRule(ei.CoefficientCombineRule.Average).setRestitutionCombineRule(ei.CoefficientCombineRule.Average).setDensity(e.density).setFriction(e.friction).setRestitution(e.restitution);let o=this.sharedGameControlGlobals.rapierWorld.createCollider(s,t);i&&(this.sharedGameControlGlobals.colliderToEntity[o.handle]=i,(l=this.sharedGameControlGlobals.eventsPerObjects[i.uuid])!=null&&l.some(c=>c.target==="scene")&&o.setActiveEvents(ei.ActiveEvents.COLLISION_EVENTS))}gatherChildrenGeom(t,e){return(n,i)=>{var a;if(i===0)return;let r;if(n instanceof cf)if(n.objectForSample){if(n.objectForSample.dataPatched.physics.fusedBody)return;r=n.object}else return n.object.dataPatched.physics.fusedBody===!0&&n.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(n instanceof zl)r=n.object;else if(r=n,(a=r.dataPatched.cloner)==null?void 0:a.hideBase)return!0;let s=r.dataPatched;if(s.collision==="visibility"?!s.visible:!s.collision)return!0;i===1?t.hasNonUniformScale?n.matrixWorld.multiplyMatrices(t.shearScale,n.hiddenMatrix):n.matrixWorld.copy(n.hiddenMatrix):n.matrixWorld.multiplyMatrices(n.parent.matrixWorld,n.hiddenMatrix),n.matrixWorld.multiply(n.matrix);let o=n.geometry;(o==null?void 0:o.getAttribute("position"))!==void 0&&e.push(cm(o,n.matrixWorld))}}init(t){this.eventManager=t,this.markIsDestroyTarget(),this.markIsDragObject(),this.usePhysics&&(this.gameControlStates.length===0||this.needsCollisionDetection)&&this.initPhysics(),this.usePhysics===!1&&this.needsCollisionDetection&&this.initBVH(),this.initializationCounter++,window.setTimeout(()=>this.collisionEvents.forEach(e=>e.disabled=!1),80)}initPhysics(){this.sharedGameControlGlobals.rapierWorld=new ei.World(new ei.Vector3(0,this.gravity,0)),this.events=new ei.EventQueue(!0);let t=[];if(this.scene.traverseObject(s=>{var v,g,m,y;let o;if(s instanceof cf)if(s.objectForSample){if(s.objectForSample.dataPatched.physics.fusedBody)return;o=s.object}else return s.object.dataPatched.physics.fusedBody===!0&&s.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(s instanceof zl)o=s.object;else if(o=s,((v=o.dataPatched.cloner)==null?void 0:v.disabled)===!1&&((g=o.dataPatched.cloner)==null?void 0:g.hideBase)&&((m=o.dataPatched.physics)==null?void 0:m.fusedBody)!==!0)return!0;let a=o.dataPatched;if(!a.physics||(a.collision==="visibility"?!a.visible:!a.collision))return!0;s.updateMatrixWorldSVD();let l=mW(a),c,h=!1,u=o.userData.hasDestroy,d=o.userData.hasDrag,f=!1;for(let w of a.events)if(w.data.disabled!==!0){if(w.data.type==="GameControl")c=w.data;else if(w.data.type==="Collision"){h=!0;let b=new OUe(w.id,w.data,o,this.scene,this.sharedAssets,{controlsManager:this,eventManager:this.eventManager});this.collisionEvents.push(b),this.sharedGameControlGlobals.eventsPerObjects[o.uuid]&&this.sharedGameControlGlobals.eventsPerObjects[o.uuid].every(A=>A.id!==w.id)?this.sharedGameControlGlobals.eventsPerObjects[o.uuid].push(b):this.sharedGameControlGlobals.eventsPerObjects[o.uuid]=[b]}else if(w.data.type==="Follow"){f=!0;let b=w.data.target;s.traverseVisible(A=>{A.userData.isFollowingObj=b})}}a.physics.rigidBody==="dynamic"&&a.physics.fusedBody===!1&&(s.matrixWorldFusedFalse=s.matrixWorld.clone());let p=s.geometry;if(c!==void 0){let w=ei.RigidBodyDesc.kinematicPositionBased();(s.hasNonUniformScale?s.matrixWorldRigid:s.matrixWorld).decompose(Ni,Da,Xu),s.position0=Ni.clone().divideScalar(this.pixelsPerMeter),s.rotation0=Da.clone(),Ni.divideScalar(this.pixelsPerMeter),w.setTranslation(Ni.x,Ni.y,Ni.z).setRotation(Da);let b=this.sharedGameControlGlobals.rapierWorld.createRigidBody(w);s.rigidBody=b;let A;c.collider.type==="sphere"?A=ei.ColliderDesc.ball(c.collider.radius/this.pixelsPerMeter):c.collider.type==="capsule"?A=ei.ColliderDesc.capsule((c.collider.height/2-c.collider.radius)/this.pixelsPerMeter,c.collider.radius/this.pixelsPerMeter):A=ei.ColliderDesc.cuboid(c.collider.width/this.pixelsPerMeter/2,c.collider.height/this.pixelsPerMeter/2,c.collider.depth/this.pixelsPerMeter/2),A.setFrictionCombineRule(ei.CoefficientCombineRule.Average).setRestitutionCombineRule(ei.CoefficientCombineRule.Average).setDensity(a.physics.density).setFriction(a.physics.friction).setRestitution(a.physics.restitution);let S=this.sharedGameControlGlobals.rapierWorld.createCollider(A,b);this.sharedGameControlGlobals.colliderToEntity[S.handle]=o,Ni.fromArray(c.collider.position).multiply(Xu.setFromMatrixScale(o.matrixWorld)).divideScalar(this.pixelsPerMeter),S.setTranslationWrtParent(Ni);let T=new on().setFromEuler(new Dr().setFromVector3(new N().fromArray(c.collider.rotation)));S.setRotationWrtParent(T),S.setActiveEvents(ei.ActiveEvents.COLLISION_EVENTS)}else a.physics.rigidBody==="dynamic"||l||f||u||d||h?this.addRigidBody(s,o,{hasFollow:f,hasTransformAnim:l,hasDrag:d}):(p&&t.push(cm(p,s.matrixWorld)),a.physics.fusedBody&&s.traverseObject((w,b)=>{var M;if(b===0)return;let A;if(w instanceof cf)if(w.objectForSample){if(w.objectForSample.dataPatched.physics.fusedBody)return;A=w.object}else return w.object.dataPatched.physics.fusedBody===!0&&w.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(w instanceof zl)A=w.object;else if(A=w,(M=A.dataPatched.cloner)==null?void 0:M.hideBase)return!0;let S=A.dataPatched;if(S.collision==="visibility"?!S.visible:!S.collision)return!0;let T=w.geometry;(T==null?void 0:T.getAttribute("position"))!==void 0&&t.push(cm(T,w.matrixWorld))}));if(((y=a.physics)==null?void 0:y.fusedBody)===!0||c)return!0}),t.length===0)return;let e=Qm(t);e.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let n=ei.RigidBodyDesc.fixed(),i=this.sharedGameControlGlobals.rapierWorld.createRigidBody(n),r=ei.ColliderDesc.trimesh(e.getAttribute("position").array,e.getIndex().array).setFrictionCombineRule(ei.CoefficientCombineRule.Multiply).setRestitutionCombineRule(ei.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(r,i)}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){var t;this.usePhysics?((t=this.sharedGameControlGlobals.rapierWorld)==null||t.free(),this.initPhysics()):(this.sharedGameControlGlobals.staticMeshBVH=void 0,this.initBVH())}dispose(){var t;this.scene.traverse(e=>{let n=e;n.matrixWorldFusedFalse&&(n.matrixWorldFusedFalse=void 0),n.rigidBody&&(n.rigidBody=void 0),n.position0&&(n.position0=void 0),n.rotation0&&(n.rotation0=void 0)}),(t=this.sharedGameControlGlobals.rapierWorld)==null||t.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.gameControls.forEach(e=>{e.reset(),e.dispose()}),this.gameControls=[],this.joysticks.forEach(([e,n])=>{e==null||e.destroy(),n.remove()}),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0);for(let e of Object.values(this.sharedGameControlGlobals.eventsPerObjects))e.forEach(n=>n.disconnect());this.sharedGameControlGlobals.eventsPerObjects={},this.scene.updateMatrixWorld(!0)}update(t,e,n){var r;let i=!0;if(this.orbitControls!==void 0&&this.orbitControls.needsUpdate&&(i=!this.orbitControls.update()),this.initializationCounter>=0&&this.initializationCounter<2)this.initializationCounter++,i=!1;else if(this.initializationCounter===2)for(let s of this.gameControls)i=!s.update(t,e,n)&&i;if(this.usePhysics){for(let s of this.sharedGameControlGlobals.entitiesWithTransformAnim){(s.hasNonUniformScale?s.matrixWorldRigid:s.matrixWorld).decompose(Ni,Da,Xu),fD.setFromQuaternion(Da);let o=s;o.prevR===void 0?(o.prevR=fD.clone(),o.prevT=Ni.clone()):(o.prevR.copy(fD),o.prevT.copy(Ni)),s.rigidBody.setNextKinematicTranslation(Ni.divideScalar(this.pixelsPerMeter)),s.rigidBody.setNextKinematicRotation(Da)}this.sharedGameControlGlobals.rapierWorld.step(this.events),(r=this.events)==null||r.drainCollisionEvents(this.handleCollisionEvents),i=!this.updatePositions()&&i}return i}dispatchCollisionEvent(t,e,n){var s;let i=((s=this.sharedGameControlGlobals.rapierWorld)==null?void 0:s.getCollider(n))._parent,r;if(e.cloner){for(let o of e.cloner.children)if(o.rigidBody===i){r=o;break}}t.dispatch(r),e.dispatchEvent(X$)}updateUseWindowEvents(t){var e;(e=this.orbitControls)==null||e.updateUseWindowEvents(t)}},pD={type:"change"},kUe={type:"lock"},zUe={type:"unlock"};new N;var gW=new N,vW=new N,GUe=new N,ls=new N,$s=new N,Yu=new N,mD=new nt,yW=new nt,HUe=new nt;new nt;var Ra=new on,Ic=new on,Cl=new Dr(0,0,0,"YXZ"),VUe=new N(1,0,0),La=new N(0,1,0),jUe=new N(0,0,1),xW=new N(1,1,1),WUe=1,XUe=.025,YUe=16e-6,wW=12,qUe=20,Xr=new oa,Vo=new ji,QUe={type:"requestRender"},_W=Math.PI/6,t3=class extends _s{constructor(t,e,n,i,r,s,o,a,l){var p;super(),this.object=t,this.domElement=e,this.controlsManager=r,this.cameraFollow=s,this.camera=o,this.scene=a,this.sharedAssets=l,this.enableDamping=!0,this.position0=new N,this.rotation0=new Dr(0,0,0,"XYZ"),this.scale0=new N,this.hiddenMatrix0=new nt,this.target0=new N,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.euler0=new Dr(0,0,0,"YXZ"),this.position0Cam=new N,this.quat0Cam=new on,this.scale0Cam=new N,this.hiddenMatrix0Cam=new nt,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new oa(new N(0,-40,0),new N(0,40,0)),matrix:new nt,position:new N,rotation:new on},this.euler=new Dr(0,0,0,"YXZ"),this.eulerDelta=new N,this.lastPosition=new N,this.lastCameraQuaternion=new on,this.lastCameraPosition=new N,this.PI_2=Math.PI/2,this.prevMouse=new be,this.velocityTarget=new N,this.velocity=new N,this.directionXZ=new N,this.rotVelocityStick=new N,this.rotVelocityTarget=new N,this.rotVelocity=new N,this.rotDirection=new N,this.nonColliderRotOffset=new nt,this.nonColliderPosOffset=new nt,this.firstPointerId=-1,this.rot=new N,this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new nt,this.objectToTarget=new N,this.objectToTarget0=new N,this.objectToCamXZ=new N,this.objectToCamXZ0=new N,this.targetToCamera=new N,this.targetToCamera0=new N,this.cameraPolarAxis0=new N,this.targetPos=new N,this.targetQuat=new on,this.lerpFactorPos=new N().setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new on,this.objXZQuatInv=new on,this.objXZRotMat=new nt,this.isFirstPerson=!1,this.actions={},this.didHit=!1,this.groundVelocity=new N,this.pushedVelocity=new N,this.groundYRotation=0,this.objectRealQuat=new on,this.colliderWorldQuat=new on,this.groundNormal=new N,this.groundTilt=new on,this.groundTiltInv=new on,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.onPointerDown=v=>{v.target!==this.domElement||this.firstPointerId!==-1||(this.firstPointerId=v.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.rotBy!=="keys"&&!fo&&(!gj||vj>=15.5)&&this.domElement.requestPointerLock(),this.prevMouse.set(v.clientX,v.clientY))},this.onPointerUp=v=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),v.pointerType==="mouse"&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=v=>{if(v.pointerId!==this.firstPointerId)return;let g=v.clientX-this.prevMouse.x,m=v.clientY-this.prevMouse.y;this.prevMouse.set(v.clientX,v.clientY),v.pointerType==="mouse"&&this.rotBy!=="keys"&&(gj&&vj<15.5&&!fo?(this.eulerDelta.y=-g*this.mouseOrbitSensitivity,this.eulerDelta.x=-m*this.mouseOrbitSensitivity):(this.eulerDelta.y=-v.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-v.movementY*this.mouseOrbitSensitivity)),v.pointerType!=="mouse"&&this.rotByTouch==="drag"&&(this.eulerDelta.y=-g*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-m*this.mouseOrbitSensitivity*5),this.dispatchEvent(pD)},this.onPointerlockChange=v=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(kUe),t3.isLocked=!0):(this.dispatchEvent(zUe),t3.isLocked=!1)},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.onKeyDown=v=>{!(v.target instanceof HTMLInputElement)&&(v.code==="ArrowLeft"||v.code==="ArrowUp"||v.code==="ArrowRight"||v.code==="ArrowDown"||v.code==="Space")&&v.preventDefault();for(let g of this.keyAssignments)if(v.key.toUpperCase()===g[1]||v.key===g[1]){this.movementState[g[0]]=1;break}this.dispatchEvent(pD)},this.onKeyUp=v=>{for(let g of this.keyAssignments)if(v.key.toUpperCase()===g[1]||v.key===g[1]||v.code.slice(3,v.code.length).toUpperCase()===g[1]){this.movementState[g[0]]=0;break}},this.copyVRGamePadValues=(v,g)=>{for(let m=2;m<4;m++){let y=v.axes[m];g===0?m===2?this.movementState.movePosX=y:this.movementState.movePosZ=y:(v.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,m===2?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(y)>=.3&&(this.vrEulerYOffset+=y<0?1:-1),this.movementState.rotPosY=y):this.moveMode==="fly"&&(this.movementState.moveNegY=y))}},this.sharedGameControlGlobals=r.sharedGameControlGlobals,t===o&&(this.isFirstPerson=!0),this.position0.copy(this.object.position),this.rotation0.copy(this.object.rotation),this.scale0.copy(this.object.scale),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.object.position,this.object.quaternion,this.object.scale),this.object.rotation.reorder("YXZ"),this.euler0.copy(this.object.rotation);let c=this.object.rotation.y;if(this.objectRealQuat.copy(this.object.quaternion),this.object.rotation.y=0,this.objXZQuat.copy(this.object.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.object.quaternion),this.object.rotation.set(0,c,0),this.rot.setFromEuler(this.object.rotation),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||this.cameraFollow===!0)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),this.cameraFollow===!0){this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy((p=this.camera)==null?void 0:p.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let v=new N(0,0,-1).applyQuaternion(this.camera.quaternion),g=new N().subVectors(this.object.position,this.camera.position);this.objectToCamXZ.copy(g),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ);let m,y;Math.abs(v.y)<1e-6?(g.y=0,v.y=0,y=g.projectOnVector(v)):g.y/v.y>0?y=v.multiplyScalar(g.y/v.y):y=v.multiplyScalar(g.length()),this.targetToCamera0.copy(y).negate(),m=this.camera.position.clone().add(y),this.objectToTarget0.subVectors(m,this.object.position);let w=new Dr().setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-w.x,w.x=0,w.z=0,w.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(w)}if(this.object instanceof Gs&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.object.quaternion,"YXZ"),this.connect(),this.rotByTouch=n.rotByTouch??"joystick",this.rotBy=n.rotBy??"keys",this.rotationMode=n.rotationMode??"normal",this.moveMode=n.moveMode??"walk",this.collisionEnabled=n.collisionEnabled,this.speedTranslate=(n.speedTranslate??250)*WUe,this.speedOrbit=(n.speedRotate??100)*XUe,this.mouseOrbitSensitivity=(n.speedRotate??100)*YUe,this.keyAssignments=n.keyAssignments.map(v=>{let g=[v[0],v[1]];return g[1]===""?g[1]="ArrowUp":g[1]===""?g[1]="ArrowLeft":g[1]===""?g[1]="ArrowDown":g[1]===""?g[1]="ArrowRight":g[1]===""?g[1]="Shift":g[1]===""?g[1]="Enter":g[1]==="Space"?g[1]=" ":g[1]===""?g[1]="Meta":g[1]==="Ctrl"?g[1]="Control":g[1]==="Esc"&&(g[1]="Escape"),g}),n.rotBy==="mouse"){let v;v=this.keyAssignments.findIndex(g=>g[0]==="rotNegX"),v!==-1&&(this.keyAssignments[v][1]=""),v=this.keyAssignments.findIndex(g=>g[0]==="rotPosX"),v!==-1&&(this.keyAssignments[v][1]=""),v=this.keyAssignments.findIndex(g=>g[0]==="rotPosY"),v!==-1&&(this.keyAssignments[v][1]=""),v=this.keyAssignments.findIndex(g=>g[0]==="rotNegY"),v!==-1&&(this.keyAssignments[v][1]="")}this.lerpFactorPosStart=1-.02**(1/((n.delayPos[0]??.3)*60)),this.lerpFactorPosEnd=1-.02**(1/((n.delayPos[1]??.3)*60)),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/((n.delayRot[0]??.3)*60)),this.lerpFactorRotEnd=1-.02**(1/((n.delayRot[1]??.3)*60)),this.lerpFactorPosCamera=1-.02**(1/((n.delayPosCamera??.3)*60)),this.lerpFactorRotCamera=1-.02**(1/((n.delayRotCamera??.3)*60)),this.gravity=(i.gravity??io.defaultData.gravity)*wW,this.pixelsPerMeter=i.pixelsPerMeter??io.defaultData.pixelsPerMeter,this.usePhysics=i.usePhysics??io.defaultData.usePhysics,this.jumpPower=n.jumpPower*qUe,this.resetYPosition=this.object.position.y+Math.abs(n.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=n.alignToGround??!1,this.orientMode=n.autoOrientMove?n.orientMode:"none",this.orientWith=n.orientWith??EI.defaultDataThirdPerson.orientWith;let h=i.skinWidthRelative??io.defaultData.skinWidthRelative,u=i.stepThreshRelative??io.defaultData.stepThreshRelative;this.slopeThresh=(i.slopeThresh??io.defaultData.slopeThresh)*Math.PI/180,n.collider.type==="capsule"?(this.collider.radius=n.collider.radius,this.collider.segment.start.y=n.collider.height/2-n.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=n.collider.height*h/this.pixelsPerMeter,this.stepThresh=n.collider.height*u/this.pixelsPerMeter):n.collider.type==="sphere"?(this.collider.radius=n.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*n.collider.radius*h/this.pixelsPerMeter,this.stepThresh=2*n.collider.radius*u/this.pixelsPerMeter):(this.offset=n.collider.height*h/this.pixelsPerMeter,this.stepThresh=n.collider.height*u/this.pixelsPerMeter),this.collider.type=n.collider.type;let d=new N().fromArray(n.collider.position),f=new on().setFromEuler(new Dr().fromArray([...n.collider.rotation,"XYZ"]));this.collider.position.copy(d).multiply(this.object.scale),this.collider.rotation.copy(f),this.collider.matrix.compose(d,f,xW),n.cameraXAxis!==void 0&&(this.cameraXAxis=n.cameraXAxis,this.cameraYAxis=n.cameraYAxis,this.minPolarAngle=n.cameraRotXLimits[0],this.maxPolarAngle=n.cameraRotXLimits[1],this.minAzimuthAngleRel=n.cameraRotYLimits[0],this.maxAzimuthAngleRel=n.cameraRotYLimits[1]),n.gameActions!==void 0&&Object.entries(n.gameActions).forEach(([v,g],m)=>{g.forEach(({id:y,data:w})=>{try{this.actions[v]===void 0&&(this.actions[v]=[]),w.type==="Transition"?this.actions[v].push(new Xy(w,a,l)):w.type==="Audio"?this.actions[v].push(new Gy(y,w,t,l)):w.type==="Video"?this.actions[v].push(new YF(y,w,t)):w.type==="Create"&&this.actions[v].push(new jy(w,a,this.controlsManager))}catch{}})}),this.dispatchStopEvent("move"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle")}reset(t=!1){if(this.object.rotation.copy(this.rotation0),this.object.position.copy(this.position0),this.object.scale.copy(this.scale0),this.object.hiddenMatrix.copy(this.hiddenMatrix0),t===!0){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.object.position,this.object.quaternion,this.object.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.rotation.reorder("YXZ");let e=this.object.rotation.y;this.object.rotation.y=0,this.objXZQuat.copy(this.object.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.object.quaternion),this.object.rotation.set(0,e,0),this.rot.setFromEuler(this.object.rotation),this.euler.setFromQuaternion(this.object.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}t===!1&&(this.object instanceof Gs?this.object.matrixAutoUpdate=!0:this.object.updateMatrix()),this.cameraFollow===!0&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.dispatchEvent(pD)}connect(){this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError)}disconnect(){this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError)}dispose(){this.disconnect(),pa(this.actions)}dispatchStartEvent(t){this.actions[t]!==void 0&&(this.actionState[t]||(this.actionState[t]=!0,this.actions[t].forEach(e=>{e instanceof Xy?e.play():e instanceof jy?e.dispatchStart():e instanceof Gy&&e.dispatchGameControl("start")})))}dispatchStopEvent(t){this.actions[t]!==void 0&&(!this.actionState[t]||(this.actionState[t]=!1,this.actions[t].forEach(e=>{e instanceof Xy?(e.stop(),e.object.currentState!==null&&e.object.changeSelectedState(null,{scene:this.scene,shared:this.sharedAssets})):e instanceof jy?e.dispatchStop():e instanceof Gy&&e.dispatchGameControl("stop")})))}update(t,e,n){var a,l,c,h,u,d,f;if(this.gravity<0?this.object.position.y<this.resetYPosition:this.object.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let i=(this.isFirstFrame?16.6:t)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let r=i*60,s=!1;if(this.usePhysics&&this.collisionEnabled){let p=$s.set(0,(this.velocity.y===0?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/(10*wW),1)*(this.gravity>0?1:-1):this.velocity.y)*i,0).divideScalar(this.pixelsPerMeter),v=this.sharedGameControlGlobals.rapierWorld.castShape(ls.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.object.position).divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,p,(a=this.object.rigidBody)==null?void 0:a.collider(0).shape,1,!1,void 0,void 0,void 0,this.object.rigidBody);if(v){this.onObject=!0,this.groundNormal.set(v.normal2.x,v.normal2.y,v.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(s=!0),((l=v.collider.parent())==null?void 0:l.bodyType())===0&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let g=v.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let m of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(m.rigidBody===g&&m.userData.isFollowingObj!==this.object.uuid){(m.hasNonUniformScale?m.matrixWorldRigid:m.matrixWorld).decompose(ls,Ic,$s),this.groundVelocity.subVectors(ls,m.prevT),this.object.getWorldPosition($s).add(this.collider.position).sub(m.position),this.groundYRotation=Cl.setFromQuaternion(Ic).y-m.prevR.y,Yu.copy($s).applyAxisAngle(La,this.groundYRotation),this.groundVelocity.add(Yu.sub($s)).divideScalar(i);break}}else this.onObject=!1}this.moveMode==="walk"&&this.collisionEnabled&&(this.movementState.jump===1&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*r),this.moveMode==="fly"&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,this.directionXZ.normalize(),this.movementState.moveNegZ||this.movementState.movePosZ?this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce:this.velocityTarget.z=0,this.movementState.moveNegX||this.movementState.movePosX?this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce:this.velocityTarget.x=0,(this.moveMode==="walk"?this.velocityTarget.x+this.velocityTarget.z===0:this.velocityTarget.manhattanLength()===0)?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.moveMode==="walk"&&(this.lerpFactorPos.y=1),this.didHit===!1&&this.pushedVelocity.manhattanLength()===0||this.usePhysics===!1?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**r),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**r),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**r)):this.velocity.copy(this.velocityTarget),(this.moveMode==="walk"?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("move")));let o=GUe.copy(this.velocity);if(this.orientMode!=="none"&&this.isFirstPerson===!1){let p=$s.copy(o);p.y=0,o.set(0,o.y,p.length()*-1)}if(Cl.setFromVector3(this.rot),this.moveMode==="walk"&&(Cl.x=0),o.applyEuler(Cl),s&&(Ic.setFromUnitVectors(La,this.groundNormal),o.applyQuaternion(Ic)),n){let p=Cl.set(0,this.vrEulerYOffset*_W,0);n.applyEuler(p),o.x+=n.x,o.z+=n.z,this.nonColliderPosOffset.elements[13]+=n.y*i}if(this.usePhysics===!0){let p=$s;this.pushedVelocity.set(0,0,0);for(let v of this.sharedGameControlGlobals.entitiesWithTransformAnim){let g=Yu.setFromMatrixPosition(v.matrixWorld).sub(v.prevT).divideScalar(i).divideScalar(this.pixelsPerMeter),m=v.rigidBody.collider(0).castCollider(g,this.object.rigidBody.collider(0),ls.copy(o).divideScalar(this.pixelsPerMeter),i,!1);if(g.multiplyScalar(this.pixelsPerMeter),m!==null){this.pushedVelocity.copy(g),p.copy(m.normal1).applyQuaternion(v.quaternion);break}}if(this.pushedVelocity.manhattanLength()!==0){let v=p.dot(o);v<0&&o.addScaledVector(p,-v),o.add(this.pushedVelocity)}else o.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),this.rotationMode==="normal"&&(this.movementState.rotPosX||this.movementState.rotNegX)||this.rotationMode==="steer"&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||this.moveMode==="walk")?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,this.rotationMode==="normal"&&(this.movementState.rotPosY||this.movementState.rotNegY)||this.rotationMode==="steer"&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(i),this.rotVelocityStick),this.rotVelocityTarget.manhattanLength()===0?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**r):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**r),this.euler.x+=this.rotVelocity.x*i,this.euler.y+=this.rotVelocity.y*i+this.groundYRotation,this.rotVelocityTarget.y===0&&this.directionXZ.manhattanLength()===0?this.rotationAccumWhenOrientWithCamera=0:(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*i),this.isFirstPerson===!1&&this.orientMode!=="none"&&this.directionXZ.manhattanLength()>0){let p=ls,v=$s.copy(this.directionXZ);v.x*=-1,this.camera.getWorldDirection(p);let g=Yu.copy(La).multiplyScalar(p.dot(La));if(p.sub(g),this.orientWith==="camera"?this.rot.y=p.angleTo(v)*(p.cross(v).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera:this.rot.y=this.euler.y+Math.atan2(-this.directionXZ.z,this.directionXZ.x)-Math.PI/2,this.orientMode==="radial"){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(La,this.euler.y-this.euler0.y);let m=$s.copy(this.objectToCamXZ).normalize(),y=Yu.copy(o).multiplyScalar(i);y.y=0;let w=y.sub(ls.copy(m).multiplyScalar(y.dot(m))).cross(m).y;this.euler.y-=Math.atan2(w,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*i+this.groundYRotation,this.rotVelocityTarget.y!==0&&(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.euler.y=this.rot.y);if(this.cameraFollow===!0&&(this.moveMode==="walk"?this.cameraXAxis==="Limit"?this.euler.x=sn.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=sn.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):this.cameraXAxis==="Limit"&&(this.euler.x=sn.clamp(this.euler.x,-this.PI_2,this.PI_2))),this.moveMode==="fly"?this.rot.x=this.euler.x:this.isFirstPerson&&(e?(Cl.copy(e),Cl.y=0):(Cl.copy(this.euler),Cl.y=0),this.nonColliderRotOffset.makeRotationFromEuler(Cl)),e&&(this.moveMode==="walk"?(this.rot.y=e.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(e),this.rot.y+=this.vrEulerYOffset*_W),Ra.setFromAxisAngle(VUe,this.rot.x),Ic.setFromAxisAngle(La,this.rot.y),Ic.multiply(Ra),Ra.setFromAxisAngle(jUe,this.rot.z),Ic.multiply(Ra),this.object.quaternion.copy(Ic),this.objectRealQuat.multiplyQuaternions(this.object.quaternion,this.objXZQuat),this.objectRealQuat.multiply(this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){let p=$s.copy(o).multiplyScalar(i/this.pixelsPerMeter),v=null;this.didHit=!1;let g=new N;for(let m=0;m<5;m++){let y=p.length(),w=Yu.copy(p).normalize();if(v=this.sharedGameControlGlobals.rapierWorld.castShape(ls.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.object.position).divideScalar(this.pixelsPerMeter).add(g),this.colliderWorldQuat,w,(c=this.object.rigidBody)==null?void 0:c.collider(0).shape,y,!1,8,void 0,void 0,this.object.rigidBody),v!==null){this.didHit=!0;let b=this.sharedGameControlGlobals.colliderToEntity[v.collider.handle];if(b!==this.lastHitObj&&m===0){this.lastHitObj=b;let M=this.sharedGameControlGlobals.eventsPerObjects[b==null?void 0:b.uuid];if(M){for(let E of M)if(E.data.target==="character"){let P=((h=this.sharedGameControlGlobals.rapierWorld)==null?void 0:h.getCollider(v.collider.handle))._parent,R;if(b.cloner){for(let F of b.cloner.children)if(F.rigidBody===P){R=F;break}}E.dispatch(R),b.dispatchEvent(X$)}}}let A=gW.set(v.normal2.x,v.normal2.y,v.normal2.z).applyQuaternion(this.colliderWorldQuat),S=vW.copy(w).multiplyScalar(v.toi).dot(A),T=v.toi;if(T===0&&(this.object.position.y+=this.offset*this.pixelsPerMeter),S>this.offset&&(T=v.toi*(S-this.offset)/S,g.addScaledVector(w,T)),p.copy(w).multiplyScalar(y-T),Math.acos(-A.y)>this.slopeThresh){let M=ls.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.object.position).divideScalar(this.pixelsPerMeter).add(g),E=Yu.copy(v.witness2).applyQuaternion(this.colliderWorldQuat);E.y=0;let P=M.add(E);P.y+=this.stepThresh;let R=this.sharedGameControlGlobals.rapierWorld.castShape(P,this.colliderWorldQuat,p,(u=this.object.rigidBody)==null?void 0:u.collider(0).shape,1,!1,8,void 0,void 0,this.object.rigidBody);R!==null&&R.toi===0&&(A.y=0,A.normalize())}p.addScaledVector(A,-p.dot(A))}else{m===0&&this.directionXZ.manhattanLength()!==0&&(this.lastHitObj=null),g.add(p);break}}this.object.position.addScaledVector(g,this.pixelsPerMeter),(d=this.object.rigidBody)==null||d.setTranslation(ls.copy(this.object.position).divideScalar(this.pixelsPerMeter),!0),(f=this.object.rigidBody)==null||f.setRotation(Ra.copy(this.object.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let p=this.onObject?1:5,v=o.multiplyScalar(i/p);for(let g=0;g<p;g++)this.object.position.add(v),this.collisionAdjustment(i/p)}else this.object.position.addScaledVector(o,i);if(this.moveMode==="walk"&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.object.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.updateMatrix(),this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.object.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),this.cameraFollow===!0){this.updateFollowArms();let p=this.objectToTarget.add(this.object.position),v=this.targetToCamera.add(p);mD.lookAt(v,p,La).setPosition(v),mD.decompose(this.targetPos,this.targetQuat,ls),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**r),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**r),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraYAxis==="Limit"&&this.orientMode==="cartesian"&&(this.euler.y=sn.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=sn.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.lastPosition.distanceToSquared(this.object.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(this.camera===void 0||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate)&&(this.moveMode==="fly"||this.onObject===!0||this.collisionEnabled===!1)?!1:(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.object.position),this.object.dispatchEvent(QUe),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let t=Ra.setFromAxisAngle(La,this.cameraYAxis==="Limit"&&this.orientMode!=="radial"?sn.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&this.objectToTarget.applyQuaternion(t);let e;this.cameraXAxis==="Limit"?e=sn.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):e=sn.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let n=ls.copy(this.cameraPolarAxis0);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&n.applyQuaternion(t);let i=Ic.setFromAxisAngle(n,e);this.cameraYAxis!=="Locked"&&this.targetToCamera.applyQuaternion(t),this.cameraXAxis!=="Locked"&&this.targetToCamera.applyQuaternion(i)}groundTiltAdjustment(t){La.angleTo(t)*180/Math.PI<15||La.angleTo(t)*180/Math.PI>85?Ra.identity():Ra.setFromUnitVectors(La,t),this.groundTilt.slerp(Ra,.06),this.groundTiltInv.copy(this.groundTilt).invert()}collisionAdjustment(t){var r;let e=vW.set(0,0,0);this.object.updateMatrix();let n=mD.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(ls,Ra,$s).compose(ls,Ra,xW);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach(s=>{if(s===this.object||s.isDescendantOf(this.object))return;Vo.makeEmpty(),s.updateMatrixWorldSVD();let o=s.matrixWorldRigid,a=yW.copy(o).invert(),l=HUe.copy(yW).multiply(n);Xr.copy(this.collider.segment),Xr.start.applyMatrix4(l),Xr.end.applyMatrix4(l);let c=gW.copy(this.object.position).applyMatrix4(a);Vo.expandByPoint(Xr.start),Vo.expandByPoint(Xr.end),Vo.min.addScalar(-this.collider.radius),Vo.max.addScalar(this.collider.radius),s.boundsTree.shapecast({intersectsBounds:h=>h.intersectsBox(Vo),intersectsTriangle:h=>{let u=ls,d=$s,f=h.closestPointToSegment(Xr,u,d);if(f<this.collider.radius){let p=this.collider.radius-f,v=d.sub(u).normalize(),g=Yu.copy(c);g.addScaledVector(v,p);let m=g.applyMatrix4(o).sub(this.object.position);e.add(m),Xr.start.addScaledVector(v,p),Xr.end.addScaledVector(v,p)}}})}),Vo.makeEmpty(),Xr.copy(this.collider.segment),Xr.start.applyMatrix4(n),Xr.end.applyMatrix4(n),Vo.expandByPoint(Xr.start),Vo.expandByPoint(Xr.end),Vo.min.addScalar(-this.collider.radius),Vo.max.addScalar(this.collider.radius),(r=this.sharedGameControlGlobals.staticMeshBVH)==null||r.shapecast({intersectsBounds:s=>s.intersectsBox(Vo),intersectsTriangle:s=>{let o=ls,a=$s,l=s.closestPointToSegment(Xr,o,a);if(l<this.collider.radius){let c=this.collider.radius-l,h=a.sub(o).normalize();this.alignToGround&&this.groundTiltAdjustment(h),e.addScaledVector(h,c),Xr.start.addScaledVector(h,c),Xr.end.addScaledVector(h,c)}}}),this.onObject=Math.abs(e.y)>Math.abs(t*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let i=Math.max(0,e.length()-1e-5);e.normalize().multiplyScalar(i),this.object.position.add(e)}},Y$=t3;Y$.isLocked=!1;var gD={type:"change"},bW={type:"changeZoom"},KUe={type:"changePan"},pm={type:"start"},mm={type:"end",changed:!0},JUe={type:"end",changed:!1},vD=new on,SW=new be,ZUe=2*Math.PI,$Ue=1e-8,eke=.01,yD=new N,nS=new be,xD=new N,iS=new on,AW=new nt,tke={type:"requestRender"},q$=class extends _s{constructor(t,e,n={isPlayMode:!1,isExport:!1}){super(),this.object=t,this.domElement=e,this.options=n,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,ko.DOLLY_ROTATE,ko.PAN],this.offset=new N,this.eye=new N,this.lastPosition=new N,this.lastQuaternion=new on,this.current=new be,this.overShoot=new be,this.overRatio=new be,this.spherical=new JV,this.sphericalDelta=new JV,this.panOffset=new N,this.panLeftV=new N,this.panUpV=new N,this.panV=new N,this.rotateStart=new be,this.rotateEnd=new be,this.rotateDelta=new be,this.panStart=new be,this.panEnd=new be,this.panDelta=new be,this.dollyStart=new be,this.dollyEnd=new be,this.dollyDelta=new be,this.rotationRangeFactor=new be,this.panRangeFactor=new be,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=i=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=i.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(xD,iS,yD),this.offset.copy(xD).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&this.state===-1&&this.rotateLeft((this.autoRotateClockwise===!0?1:-1)*this.getAutoRotationAngle()),this.rotationLimitsMode!==0&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),this.rotationLimitsMode!==2&&(this.spherical.phi+=this.sphericalDelta.phi),(this.rotationLimitsMode!==1||this.autoRotate===!0)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),this.panLimitsMode!==0&&(this.target.applyQuaternion(vD.copy(iS).invert()),this.panOffset.applyQuaternion(vD),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(iS),this.panOffset.applyQuaternion(iS)),this.panLimitsMode===2&&(this.panOffset.y=0),this.panLimitsMode===1&&(this.panOffset.x=0),this.state===-1&&!this.gesture?(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)):(this.target.add(this.panOffset),this.panOffset.set(0,0,0)),this.offset.setFromSpherical(this.spherical),xD.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(AW.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(AW));let i=this.spherical.phi%ZUe;return this.eye.copy(this.offset).normalize(),this.object.up.copy(Nn.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),i>0&&i>Math.PI||i<0&&i>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),this.state===-1||this.enableDamping===!0?(this.sphericalDelta.theta*=1-this.dampingFactor,this.sphericalDelta.phi*=1-this.dampingFactor):this.sphericalDelta.set(0,0,0),this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>eke||8*(1-this.lastQuaternion.dot(this.object.quaternion))>$Ue?(this.dispatchEvent(gD),this.object.dispatchEvent(tke),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=i=>{this.enabled!==!1&&(i.pointerType==="touch"||i.pointerType==="pen"&&fo?this.onPointerDownTouch(i):this.onPointerDownMouse(i),this.state!==-1&&(this.isPointerDown=!0,this.dispatchEvent(pm),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),i.stopPropagation(),i.pointerType==="touch"||i.pointerType==="pen"&&fo||this.domElement.setPointerCapture(i.pointerId)))},this.onPointerLeave=i=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(this.hoverRotatePanMode===1?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,yD.subVectors(this.position0,this.target0),this.spherical.setFromVector3(yD),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):this.hoverRotatePanMode===2&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=i},this.onPointerEnter=i=>{this.resetHoverEffectOnPointerLeave||this.pointerLeaveEvent===void 0?nS.set(i.clientX-this.domElement.clientWidth/2,i.clientY-this.domElement.clientHeight/2):nS.set(i.clientX-this.pointerLeaveEvent.clientX,i.clientY-this.pointerLeaveEvent.clientY),this.hoverRotatePanMode===1?(this.rotateDelta.copy(nS).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(SW,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(i.clientX,i.clientY)):this.hoverRotatePanMode===2&&(this.panDelta.copy(nS).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(i.clientX,i.clientY)),this.update()},this.onPointerMove=i=>{this.enabled!==!1&&(i.pointerType==="touch"||i.pointerType==="pen"&&fo?this.onPointerMoveTouch(i):this.onPointerMoveMouse(i),i.stopPropagation())},this.onPointerUp=i=>{this.isPointerDown=!1,Nt.length===0&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),this.hasChange?this.dispatchEvent(mm):this.dispatchEvent(JUe),this.state=-1,i&&(i.stopPropagation(),i.pointerType==="touch"||i.pointerType==="pen"&&fo||this.domElement.releasePointerCapture(i.pointerId))},this.onPointerDownMouse=i=>{let r;switch(this.useKeyEvents?r=this.mouseButtons[i.button]:r=this.mouseButtonsPlay[i.button],r){case 0:if(i.altKey===!0&&!i.shiftKey&&!Rb(i)){if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}else if(this.key===" "){if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}break;case 4:if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2;break;case 3:if(Rb(i)||i.shiftKey){if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}else{if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}break;case 5:if(Rb(i)||i.shiftKey){if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}else{if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=i=>{switch(this.state){case 0:if(this.enableRotate===!1)return;this.handleMouseMoveRotate(i);break;case 1:if(this.enableZoom===!1)return;this.handleMouseMoveDolly(i);break;case 2:if(this.enablePan===!1)return;this.handleMouseMovePan(i);break}this.object.wasMovedByUser=!0},this.onPointerDownTouch=i=>{switch(this.touches[Nt.length-1]){case ko.ROTATE:if(this.enableRotate===!1){this.state=-1;return}this.handleTouchStartRotate(),this.state=3;break;case ko.PAN:if(this.enablePan===!1){this.state=-1;return}this.handleTouchStartPan(),this.state=4;break;case ko.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1||this.isTouchZoom===!1)return;this.handleTouchStartDollyPan(),this.state=5;break;case ko.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1||this.isTouchZoom===!1)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=i=>{switch(this.state){case 3:if(this.enableRotate===!1)return;this.handleTouchMoveRotate(i),this.update();break;case 4:if(this.enablePan===!1)return;this.handleTouchMovePan(i),this.update();break;case 5:if(this.enableZoom===!1&&this.enablePan===!1||this.isTouchZoom===!1)return;this.handleTouchMoveDollyPan(i),this.update();break;case 6:if(this.enableZoom===!1&&this.enableRotate===!1||this.isTouchZoom===!1)return;this.handleTouchMoveDollyRotate(i),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=dF(()=>this.dispatchEvent(mm),33),this.onMouseWheel=i=>{this.enabled===!1||this.enableZoom===!1&&this.enablePan===!1||(this.options.isExport===!1&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&i.preventDefault(),this.dispatchEvent(pm),this.handleMouseWheel(i),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=i=>{if(this.enabled!==!1)if(i.preventDefault(),i.type==="gesturechange"){if(this.enableZoom===!1||this.isTouchZoom===!1)return;this.dispatchEvent(pm),i.scale>this.prevScale?this.dollyIn(this.getZoomScale()):i.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=i.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(mm)},this.onContextMenu=i=>{this.enabled!==!1&&i.preventDefault()},this.onTouchEnd=i=>{i.preventDefault()},this.onKeyDown=i=>{this.enabled!==!1&&(this.key=i.key,i.key===" "&&this.dispatchEvent(pm))},this.onKeyUp=i=>{this.enabled!==!1&&(this.key=void 0,this.state!==-1&&this.onPointerUp(Nt[0]),i.key===" "&&this.dispatchEvent(mm))},this.onPointerHover=i=>{i.pointerType!=="mouse"||this.enabled===!1||this.state!==-1||this.hoverRotatePanMode===2&&this.isPanOverShoot||this.hoverRotatePanMode===1&&this.isRotateOverShoot||(this.isPointerDown=!0,this.hoverRotatePanMode===2?this.handleMouseMovePan(i,this.hoverRotatePanStrength):this.hoverRotatePanMode===1&&this.handleMouseMoveRotate(i,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=i=>{i.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.addEventListenersToCamera()}dispatchEvent(t){t.type==="start"?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(t)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}reset(){this.object.quaternion.copy(this.quat0),this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.isUpVectorFlipped=this.isUpVectorFlipped0,this.object.updateProjectionMatrix(),this.dispatchEvent(gD),this.state=-1,this.pointerLeaveEvent=void 0}resetTo(t,e,n,i,r=!1){this.object.quaternion.copy(i),this.target.copy(t),this.object.position.copy(e),this.object.zoom=n,this.object.isUpVectorFlipped=r,this.object.updateProjectionMatrix(),this.dispatchEvent(gD),this.update(),this.state=-1}updateUseWindowEvents(t){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=t,this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(t,e){this.setEnableDampingSpeed(t.enableDamping),this.enablePan=t.enablePan,this.enableZoom=t.enableZoom,this.enableRotate=t.enableRotate,this.rotationLimitsMode=t.rotationLimitsMode,this.thetaIsFree=t.rotationHorizontalOffset.min===t.rotationHorizontalOffset.max&&t.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=t.rotationVerticalOffset.min===t.rotationVerticalOffset.max&&t.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=t.panLimitsMode,this.panSoftLimit=t.panSoftLimit,this.rotationSoftLimit=t.rotationSoftLimit,this.hoverRotatePanMode=t.hoverRotatePanMode,this.useWindowEvents=e==="window",this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let n=t.hoverRotatePanStrength/100;this.hoverRotatePanStrength=n**2,this.zoomLimitsEnabled=t.zoomLimitsEnabled,this.minZoom=t.zoomLimits.min,this.maxZoom=Math.max(t.zoomLimits.min,t.zoomLimits.max),this.minDistance=1e3/t.zoomLimits.max,this.maxDistance=Math.max(this.minDistance,1e3/t.zoomLimits.min),this.autoRotate=t.autoRotate,this.autoRotateSpeed=t.autoRotateSpeed,this.autoRotateClockwise=t.autoRotateClockwise;let i=this.object.getTarget().applyQuaternion(vD.copy(this.object.quaternion).invert());this.minV=-t.panVerticalOffset.min+i.y,this.maxV=t.panVerticalOffset.max+i.y,this.minH=-t.panHorizontalOffset.min+i.x,this.maxH=t.panHorizontalOffset.max+i.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=Tl(this.spherical.phi-t.rotationVerticalOffset.min),this.maxPhi=Tl(this.spherical.phi+t.rotationVerticalOffset.max),this.minTheta=Tl(Tl(this.spherical.theta)-t.rotationHorizontalOffset.min),this.maxTheta=Tl(Tl(this.spherical.theta)+t.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,t.orbitTouches===1&&(this.touches[0]=ko.ROTATE),t.panTouches===1&&(this.touches[0]=ko.PAN),t.orbitTouches===2&&(this.touches[1]=ko.DOLLY_ROTATE),t.panTouches===2&&(this.touches[1]=ko.DOLLY_PAN),t.orbitTouches===3&&(this.touches[2]=ko.ROTATE),t.panTouches===3&&(this.touches[2]=ko.PAN),this.isTouchZoom=t.isTouchZoom,this.resetHoverEffectOnPointerLeave=t.resetHoverEffectOnPointerLeave??!1}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),AI||(this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture)),this.domElement.addEventListener("touchend",this.onTouchEnd),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let t=this.useWindowEvents?window:this.domElement;t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),AI||(this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture)),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(t,e,n,i,r,s,o,a){this.overShoot.set(0,0);let l,c,h;t instanceof N?(l=t.x,c=t.y,this.current.set(this.target.x,this.target.y),h=!0):(l=t.theta,c=t.phi,this.current.set(Tl(this.spherical.theta),Tl(this.spherical.phi)),h=!1),n===0&&(this.current.x+=l,this.current.y+=c),(e===3||e===2)&&(!h&&this.isThetaFlipped?this.current.x>i&&this.current.x<0?this.overShoot.x=i-this.current.x:this.current.x<r&&this.current.x>0&&(this.overShoot.x=r-this.current.x):this.current.x>i?this.overShoot.x=i-this.current.x:this.current.x<r&&(this.overShoot.x=r-this.current.x)),(e===3||e===1)&&(this.current.y>s?this.overShoot.y=s-this.current.y:this.current.y<o&&(this.overShoot.y=o-this.current.y)),h||(this.overShoot.x=Tl(this.overShoot.x),this.overShoot.y=Tl(this.overShoot.y)),n!==0?(this.overRatio.copy(this.overShoot).divide(a),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),n===1&&(this.overRatio.x=MW(Math.abs(this.overRatio.x)),this.overRatio.y=MW(Math.abs(this.overRatio.y))),this.isPointerDown||n===1?n===2&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),c*this.overShoot.y<0&&!this.phiIsFree&&(c*=1-this.overRatio.y)):n===2&&(!h&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||h&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=this.overShoot.x*.05),this.phiIsFree||(c=this.overShoot.y*.05),h?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):h?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,c+=this.overShoot.y),t instanceof N?(t.x=l,t.y=c):(this.thetaIsFree||(t.theta=l),this.phiIsFree||(t.phi=c))}setEnableDampingSpeed(t){this.enableDamping=t,this.rotateSpeed=t===!0?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(t){this.sphericalDelta.theta-=t}rotateUp(t){this.sphericalDelta.phi-=t}panLeft(t,e){this.panLeftV.setFromMatrixColumn(e,0),this.panLeftV.multiplyScalar(-t),this.panOffset.add(this.panLeftV)}panUp(t,e){this.panUpV.setFromMatrixColumn(e,1),this.panUpV.multiplyScalar(t),this.panOffset.add(this.panUpV)}pan(t,e){let n=this.domElement;if(n&&this.object.isPerspectiveCamera){let i=this.object.position;this.panV.copy(i).sub(this.target);let r=this.panV.length();r*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*t*r/n.clientHeight,this.object.matrixWorld),this.panUp(2*e*r/n.clientHeight,this.object.matrixWorld)}else n&&this.object.isOrthographicCamera&&(this.panLeft(t*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrixWorld),this.panUp(e*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrixWorld));this.dispatchEvent(KUe)}dollyOut(t){this.object.isPerspectiveCamera?this.scale/=t:this.object.isOrthographicCamera&&(this.object.zoom*=t,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(bW)}dollyIn(t){this.object.isPerspectiveCamera?this.scale*=t:this.object.isOrthographicCamera&&(this.object.zoom/=t,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(bW)}zoomOut(t=this.getZoomScale()){this.dispatchEvent(pm),this.dollyOut(t),this.dispatchEvent(mm)}zoomIn(t=this.getZoomScale()){this.dispatchEvent(pm),this.dollyIn(t),this.dispatchEvent(mm)}handleMouseDownRotate(t){this.rotateStart.set(t.clientX,t.clientY)}handleMouseDownDolly(t){this.dollyStart.set(t.clientX,t.clientY)}handleMouseDownPan(t){this.panStart.set(t.clientX,t.clientY)}handleMouseMoveRotate(t,e=1){t.movementX!==void 0?this.rotateDelta.set(t.movementX,t.movementY):(this.rotateEnd.set(t.clientX,t.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*e).rotateAround(SW,-this.object.angleOffsetFromUp);let n=this.domElement,i=this.useWindowEvents?window.innerHeight:n.clientHeight,r=2*Math.PI*this.rotateDelta.x/i,s=2*Math.PI*this.rotateDelta.y/i;this.rotateLeft(r),this.rotateUp(s),this.update()}handleMouseMoveDolly(t){this.dollyEnd.set(t.clientX,t.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(t,e=1){t.movementX!==void 0?this.panDelta.set(t.movementX,t.movementY):(this.panEnd.set(t.clientX,t.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*e),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(t){if(HLe===!1&&Rb(t)===!1&&nke(t)===!0){if(this.enablePan===!1)return;this.gesture?(this.panDelta.set(-t.deltaX,-t.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),t.altKey?this.pan(0,this.panDelta.y):t.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.gesture=!1,this.isPointerDown=!1},30)}else{if(this.enableZoom===!1)return;t.deltaY===0?t.deltaX<0?this.dollyIn(this.getZoomScale()):t.deltaX>0&&this.dollyOut(this.getZoomScale()):t.deltaY<0?this.dollyIn(this.getZoomScale()):t.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(Nt.length===2){let t=.5*(Nt[0].pageX+Nt[1].pageX),e=.5*(Nt[0].pageY+Nt[1].pageY);this.rotateStart.set(t,e)}else this.rotateStart.set(Nt[0].pageX,Nt[0].pageY)}handleTouchStartPan(){if(Nt.length===2){let t=.5*(Nt[0].pageX+Nt[1].pageX),e=.5*(Nt[0].pageY+Nt[1].pageY);this.panStart.set(t,e)}else this.panStart.set(Nt[0].pageX,Nt[0].pageY)}handleTouchStartDolly(){let t=Nt[0].pageX-Nt[1].pageX,e=Nt[0].pageY-Nt[1].pageY,n=Math.sqrt(t*t+e*e);this.dollyStart.set(0,n)}handleTouchStartDollyPan(){this.enableZoom&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(t){if(Nt.length===2){let n=T2(t),i=.5*(t.pageX+n.x),r=.5*(t.pageY+n.y);this.rotateEnd.set(i,r)}else{if(t.pointerId!==Nt[0].pointerId)return;this.rotateEnd.set(t.pageX,t.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let e=this.domElement;e&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/e.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/e.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(t){if(Nt.length===2){let e=T2(t),n=.5*(t.pageX+e.x),i=.5*(t.pageY+e.y);this.panEnd.set(n,i)}else{if(t.pointerId!==Nt[0].pointerId)return;this.panEnd.set(t.pageX,t.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(t){let e=T2(t),n=t.pageX-e.x,i=t.pageY-e.y,r=Math.sqrt(n*n+i*i);this.dollyEnd.set(0,r),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(t){this.enableZoom&&this.handleTouchMoveDolly(t),this.enablePan&&this.handleTouchMovePan(t)}handleTouchMoveDollyRotate(t){this.enableZoom&&this.handleTouchMoveDolly(t),this.enableRotate&&this.handleTouchMoveRotate(t)}};function Tl(t){let e=Math.PI*2;for(;t<=-Math.PI;)t+=e;for(;t>Math.PI;)t-=e;return t}function MW(t){return 1-Math.pow(1-t,4)}function nke(t){return t.wheelDeltaY===0||t.deltaY===0?FE&&t.shiftKey&&Math.abs(t.wheelDeltaX)>=120?!1:t.wheelDeltaX?t.wheelDeltaX===-3*t.deltaX:t.deltaMode===0:t.wheelDeltaY?t.wheelDeltaY===-3*t.deltaY:t.deltaMode===0}var wD=new WeakMap,ike=class extends XO{constructor(t){super(t),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(t){return this.decoderPath=t,this}setDecoderConfig(t){return this.decoderConfig=t,this}setWorkerLimit(t){return this.workerLimit=t,this}load(t,e,n,i){let r=new qL(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(t,s=>{this.decodeDracoFile(s,e).catch(i)},n,i)}decodeDracoFile(t,e,n,i){let r={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!n};return this.decodeGeometry(t,r).then(e)}decodeGeometry(t,e){let n=JSON.stringify(e);if(wD.has(t)){let a=wD.get(t);if(a.key===n)return a.promise;if(t.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i,r=this.workerNextTaskID++,s=t.byteLength,o=this._getWorker(r,s).then(a=>(i=a,new Promise((l,c)=>{i._callbacks[r]={resolve:l,reject:c},i.postMessage({type:"decode",id:r,taskConfig:e,buffer:t},[t])}))).then(a=>this._createGeometry(a.geometry));return o.catch(()=>!0).then(()=>{i&&r&&this._releaseTask(i,r)}),wD.set(t,{key:n,promise:o}),o}_createGeometry(t){let e=new Lt;t.index&&e.setIndex(new Ut(t.index.array,1));for(let n=0;n<t.attributes.length;n++){let i=t.attributes[n],r=i.name,s=i.array,o=i.itemSize;e.setAttribute(r,new Ut(s,o))}return e}_loadLibrary(t,e){let n=new qL(this.manager);return n.setPath(this.decoderPath),n.setResponseType(e),n.setWithCredentials(this.withCredentials),new Promise((i,r)=>{n.load(t,i,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let t=typeof WebAssembly!="object"||this.decoderConfig.type==="js",e=[];return t?e.push(this._loadLibrary("draco_decoder.js","text")):(e.push(this._loadLibrary("draco_wasm_wrapper.js","text")),e.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(e).then(n=>{let i=n[0];t||(this.decoderConfig.wasmBinary=n[1]);let r=rke.toString(),s=["/* draco decoder */",i,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(t,e){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(r){let s=r.data;switch(s.type){case"decode":i._callbacks[s.id].resolve(s);break;case"error":i._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,r){return i._taskLoad>r._taskLoad?-1:1});let n=this.workerPool[this.workerPool.length-1];return n._taskCosts[t]=e,n._taskLoad+=e,n})}_releaseTask(t,e){t._taskLoad-=t._taskCosts[e],delete t._callbacks[e],delete t._taskCosts[e]}debug(){console.log("Task load: ",this.workerPool.map(t=>t._taskLoad))}dispose(){for(let t=0;t<this.workerPool.length;++t)this.workerPool[t].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}};function rke(){let t,e;onmessage=function(o){let a=o.data;switch(a.type){case"init":t=a.decoderConfig,e=new Promise(function(h){t.onModuleLoaded=function(u){h({draco:u})},DracoDecoderModule(t)});break;case"decode":let l=a.buffer,c=a.taskConfig;e.then(h=>{let u=h.draco,d=new u.Decoder,f=new u.DecoderBuffer;f.Init(new Int8Array(l),l.byteLength);try{let p=n(u,d,f,c),v=p.attributes.map(g=>g.array.buffer);p.index&&v.push(p.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:p},v)}catch(p){console.error(p),self.postMessage({type:"error",id:a.id,error:p.message})}finally{u.destroy(f),u.destroy(d)}});break}};function n(o,a,l,c){let h=c.attributeIDs,u=c.attributeTypes,d,f,p=a.GetEncodedGeometryType(l);if(p===o.TRIANGULAR_MESH)d=new o.Mesh,f=a.DecodeBufferToMesh(l,d);else if(p===o.POINT_CLOUD)d=new o.PointCloud,f=a.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!f.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());let v={index:null,attributes:[]};for(let g in h){let m=self[u[g]],y,w;if(c.useUniqueIDs)w=h[g],y=a.GetAttributeByUniqueId(d,w);else{if(w=a.GetAttributeId(d,o[h[g]]),w===-1)continue;y=a.GetAttribute(d,w)}v.attributes.push(r(o,a,d,g,m,y))}return p===o.TRIANGULAR_MESH&&(v.index=i(o,a,d)),o.destroy(d),v}function i(o,a,l){let c=l.num_faces()*3,h=c*4,u=o._malloc(h);a.GetTrianglesUInt32Array(l,h,u);let d=new Uint32Array(o.HEAPF32.buffer,u,c).slice();return o._free(u),{array:d,itemSize:1}}function r(o,a,l,c,h,u){let d=u.num_components(),f=l.num_points()*d,p=f*h.BYTES_PER_ELEMENT,v=s(o,h),g=o._malloc(p);a.GetAttributeDataArrayForAllPoints(l,u,v,p,g);let m=new h(o.HEAPF32.buffer,g,f).slice();return o._free(g),{name:c,array:m,itemSize:d}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}var _h;function ske(){return _h||(_h=new ike,_h.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),_h.decoderPending}async function oke(t){if(_h){let e={attributeIDs:_h.defaultAttributeIDs,attributeTypes:_h.defaultAttributeTypes,useUniqueIDs:!1},n;try{n=await _h.decodeGeometry(new Int8Array(t).buffer,e)}catch(i){console.error(i)}if(n)return{index:n.index?{array:n.index.array}:void 0,attributes:Object.entries(n.attributes).map(([i,r])=>({name:i,itemSize:r.itemSize,array:r.array}))}}return null}async function ake(t,e){let[n,i]=fJ(cI.deserialize(new Uint8Array(t)));AIe(n);let r=[];n.scene.objects.traverse((s,o)=>{o.type==="Mesh"&&o.geometry.type==="NonParametricGeometry"&&o.geometry.data.draco!==void 0&&r.push(o)}),r.length&&await ske();for(let s of r){let o=await oke(Kr(s.geometry.data.draco));if(o){o.index&&(s.geometry.data.index={array:o.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let a={};o.attributes.forEach(({name:l,array:c,itemSize:h})=>{a[l]={array:c,itemSize:h,type:"Float32Array",normalized:!1}}),s.geometry.data.attributes=a,s.geometry.data.draco=void 0}}return e&&e(n),i.result().data}var EW=Object.keys(y$).filter(t=>isNaN(Number(t))),lke=class{constructor(t,e,n,i,r,s,o,a){this.requestRender=s,this.isEnable=!1,this.onResetRaycaster=()=>{this.eventContext.raycasterNeedsUpdate=!0},this.onTouchMovePreventScroll=c=>{(c.touches.length>1||this.preventTouchScroll)&&c.preventDefault()},this.onMouseWheelPreventScroll=c=>{this.preventScroll&&c.preventDefault()},this.stopRaycast=i.stopRaycast,this.preventScroll=i.preventScroll,this.preventTouchScroll=i.preventTouchScroll,this.hideCursor=i.hideCursor,this.eventContext=new GFe(t,e,n,r,i.stopRaycast,a??!1);let l={controlsManager:o,eventManager:this};this.handlers={Spline:new sUe(this.eventContext),Conditional:new dUe(this.eventContext,l),Start:new BUe(this.eventContext,l),Basic:new aUe(this.eventContext,l),MouseHover:new PUe(this.eventContext,l),Scroll:new LUe(this.eventContext,l),Follow:new _Ue(this.eventContext,l),DragDrop:new gUe(this.eventContext,l),LookAt:new EUe(this.eventContext)}}activate(){let{scene:t,domElement:e,eventElement:n}=this.eventContext;this.hideCursor&&(e.style.cursor="none"),this.isEnable=!0,t.traverseEntity(i=>{i.addEventListener("requestRender",this.requestRender)}),Object.values(this.handlers).forEach(i=>i.connect()),EW.forEach(i=>{Object.values(this.handlers).some(r=>r.domEventsNeeded.has(i))&&(e.addEventListener(i,this.onResetRaycaster),n.addEventListener(i,this.onResetRaycaster))}),e.addEventListener("wheel",this.onMouseWheelPreventScroll),e.addEventListener("touchmove",this.onTouchMovePreventScroll)}deactivate(){let{scene:t,domElement:e}=this.eventContext;this.isEnable=!1,e.style.cursor="",Object.values(this.handlers).forEach(n=>n.disconnect()),t.traverseEntity(n=>{n.removeEventListener("requestRender",this.requestRender)}),EW.forEach(n=>{e.removeEventListener(n,this.onResetRaycaster)}),e.removeEventListener("touchmove",this.onTouchMovePreventScroll),e.removeEventListener("wheel",this.onMouseWheelPreventScroll)}reset(){this.deactivate(),this.activate()}updateUseWindowEvents(t){let e=this.isEnable;e&&this.deactivate(),this.eventContext.useWindowEvents=t,e&&this.activate()}},cke=class{constructor(t,e,n,i,r){this._aspect=1,this._renderer=t,this._camera=e,this._frameSize=new be().copy(n),this._editorSize=new be().copy(i),this._aspect=e.aspect,this._fov=r??e.fov}set frameSize(t){this._frameSize.copy(t)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||this._camera.cameraType!=="PerspectiveCamera")return;let t=this._frameSize.x,e=this._frameSize.y,n=this._editorSize.y;this._aspect=t/e,e<=n&&(this._camera.zoom*=n/e),this._renderer.setViewport(0,0,t,e)}updateCamera(){if(this._camera)if(this._camera.cameraType==="PerspectiveCamera"){let t=this._frameSize.y,e=this._editorSize.y,n=this._fov;if(t>e){let i=uke(t,1080,2160,1,15)/100;n*=t/e,n*=1-i}this._camera.aspect=this._aspect,this._camera.fov=n,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y)}setCamera(t){this._camera=t,this._aspect=t.aspect,this._fov=t.fov}revert(){let t=window.innerWidth,e=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,t,e),this._renderer.setSize(t,e)),this._camera&&(this._camera.aspect=t/e,this._camera.fov=this._fov,this._camera.setViewplaneSize(t,e),this._camera.updateProjectionMatrix())}};function uke(t,e,n,i,r){return(t-e)/(n-e)*(r-i)+i}var Q$={RED:0,GREEN:1,BLUE:2,ALPHA:3},W1="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",hke=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;
#if PASS == 1
uniform vec4 kernel64[32];
#else
uniform vec4 kernel16[8];
#endif
varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;
#else
float CoC=texture2D(cocBuffer,vUv).g*scale;
#endif
if(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(CoC,CoCNearFar.g*scale);
#else
vec2 step=texelSize*CoC;
#endif
#if PASS == 1
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;
#else
vec4 maxValue=texture2D(inputBuffer,vUv);for(int i=0;i<8;++i){vec4 kernel=kernel16[i];vec2 uv=step*kernel.xy+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);uv=step*kernel.zw+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);}gl_FragColor=maxValue;
#endif
}}`,rS=class extends ir{constructor(t=!1,e=!1){super({name:"BokehMaterial",defines:{PASS:t?"2":"1"},uniforms:{kernel64:new wt(null),kernel16:new wt(null),inputBuffer:new wt(null),cocBuffer:new wt(null),texelSize:new wt(new be),scale:new wt(1)},blending:Ir,depthWrite:!1,depthTest:!1,fragmentShader:hke,vertexShader:W1}),this.toneMapped=!1,e&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}set cocBuffer(t){this.uniforms.cocBuffer.value=t}setCoCBuffer(t){this.uniforms.cocBuffer.value=t}get scale(){return this.uniforms.scale.value}set scale(t){this.uniforms.scale.value=t}getScale(t){return this.uniforms.scale.value=t}setScale(t){this.uniforms.scale.value=t}generateKernel(){let t=2.39996323,e=new Float32Array(128),n=new Float32Array(32),i=0,r=0;for(let a=0;a<80;++a){let l=a*t,c=Math.sqrt(a)/Math.sqrt(80),h=c*Math.cos(l),u=c*Math.sin(l);a%5===0?(n[r++]=h,n[r++]=u):(e[i++]=h,e[i++]=u)}let s=[],o=[];for(let a=0;a<128;)s.push(new Zt(e[a++],e[a++],e[a++],e[a++]));for(let a=0;a<32;)o.push(new Zt(n[a++],n[a++],n[a++],n[a++]));this.uniforms.kernel64.value=s,this.uniforms.kernel16.value=o}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e)}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}};function CW(t,e,n){return t*(e-n)-e}function n3(t,e,n){return Math.min(Math.max((t+e)/(e-n),0),1)}var dke=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,fke=class extends ir{constructor(t){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new wt(null),focusDistance:new wt(0),focusRange:new wt(0),cameraNear:new wt(.3),cameraFar:new wt(1e3)},blending:Ir,depthWrite:!1,depthTest:!1,fragmentShader:dke,vertexShader:W1}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(t)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(t){this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=gu){this.depthBuffer=t,this.depthPacking=e}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(t){this.uniforms.focusDistance.value=t}get worldFocusDistance(){return-CW(this.focusDistance,this.near,this.far)}set worldFocusDistance(t){this.focusDistance=n3(-t,this.near,this.far)}getFocusDistance(t){this.uniforms.focusDistance.value=t}setFocusDistance(t){this.uniforms.focusDistance.value=t}get focalLength(){return this.focusRange}set focalLength(t){this.focusRange=t}get focusRange(){return this.uniforms.focusRange.value}set focusRange(t){this.uniforms.focusRange.value=t}get worldFocusRange(){return-CW(this.focusRange,this.near,this.far)}set worldFocusRange(t){this.focusRange=n3(-t,this.near,this.far)}getFocalLength(t){return this.focusRange}setFocalLength(t){this.focusRange=t}adoptCameraSettings(t){t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,t instanceof Qr?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},pke=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <encodings_fragment>
#include <dithering_fragment>
}`,mke="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",TW=class extends ir{constructor(t=new be){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new wt(null),texelSize:new wt(new be),halfTexelSize:new wt(new be),kernel:new wt(0),scale:new wt(1)},blending:Ir,depthWrite:!1,depthTest:!1,fragmentShader:pke,vertexShader:mke}),this.toneMapped=!1,this.setTexelSize(t.x,t.y)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.inputBuffer=t}get scale(){return this.uniforms.scale.value}set scale(t){this.uniforms.scale.value=t}getScale(){return this.uniforms.scale.value}setScale(t){this.uniforms.scale.value=t}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(t){this.uniforms.kernel.value=t}setKernel(t){this.kernel=t}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e),this.uniforms.halfTexelSize.value.set(t,e).multiplyScalar(.5)}setSize(t,e){let n=this.uniforms;n.texelSize.value.set(1/t,1/e),n.halfTexelSize.value.copy(n.texelSize.value).multiplyScalar(.5)}},gke=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,vke=class extends ir{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new wt(null),opacity:new wt(1)},blending:Ir,depthWrite:!1,depthTest:!1,fragmentShader:gke,vertexShader:W1}),this.toneMapped=!1}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}getOpacity(t){return this.uniforms.opacity.value}setOpacity(t){this.uniforms.opacity.value=t}},yke=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,xke=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,rN={DEPTH:0,LUMA:1,COLOR:2},K$={DISABLED:0,DEPTH:1,CUSTOM:2},wke=class extends ir{constructor(t=new be,e=rN.COLOR){super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:vv.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new wt(null),depthBuffer:new wt(null),predicationBuffer:new wt(null),texelSize:new wt(t)},blending:Ir,depthWrite:!1,depthTest:!1,fragmentShader:yke,vertexShader:xke}),this.toneMapped=!1,this.edgeDetectionMode=e}set depthBuffer(t){this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=gu){this.depthBuffer=t,this.depthPacking=e}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(t){this.defines.EDGE_DETECTION_MODE=t.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(t){this.edgeDetectionMode=t}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(t){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=t.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(t){this.localContrastAdaptationFactor=t}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(t){this.defines.EDGE_THRESHOLD=t.toFixed("6"),this.defines.DEPTH_THRESHOLD=(t*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(t){this.edgeDetectionThreshold=t}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(t){this.defines.PREDICATION_MODE=t.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(t){this.predicationMode=t}set predicationBuffer(t){this.uniforms.predicationBuffer.value=t}setPredicationBuffer(t){this.uniforms.predicationBuffer.value=t}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(t){this.defines.PREDICATION_THRESHOLD=t.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(t){this.predicationThreshold=t}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(t){this.defines.PREDICATION_SCALE=t.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(t){this.predicationScale=t}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(t){this.defines.PREDICATION_STRENGTH=t.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(t){this.predicationStrength=t}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}},_ke=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,bke="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",Ia={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},i3=class extends ir{constructor(t,e,n,i,r=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:vv.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new wt(null),depthBuffer:new wt(null),resolution:new wt(new be),texelSize:new wt(new be),cameraNear:new wt(.3),cameraFar:new wt(1e3),aspect:new wt(1),time:new wt(0)},blending:Ir,depthWrite:!1,depthTest:!1,dithering:r}),this.toneMapped=!1,t&&this.setShaderParts(t),e&&this.setDefines(e),n&&this.setUniforms(n),this.adoptCameraSettings(i)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(t){this.uniforms.depthBuffer.value=t}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=gu){this.depthBuffer=t,this.depthPacking=e}setShaderParts(t){return this.fragmentShader=_ke.replace(Ia.FRAGMENT_HEAD,t.get(Ia.FRAGMENT_HEAD)).replace(Ia.FRAGMENT_MAIN_UV,t.get(Ia.FRAGMENT_MAIN_UV)).replace(Ia.FRAGMENT_MAIN_IMAGE,t.get(Ia.FRAGMENT_MAIN_IMAGE)),this.vertexShader=bke.replace(Ia.VERTEX_HEAD,t.get(Ia.VERTEX_HEAD)).replace(Ia.VERTEX_MAIN_SUPPORT,t.get(Ia.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(t){for(let e of t.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(t){for(let e of t.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(t){this.extensions={};for(let e of t)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(t){this.encodeOutput!==t&&(t?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(t){return this.encodeOutput}setOutputEncodingEnabled(t){this.encodeOutput=t}get time(){return this.uniforms.time.value}set time(t){this.uniforms.time.value=t}setDeltaTime(t){this.uniforms.time.value+=t}adoptCameraSettings(t){t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,t instanceof Qr?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(t,e){let n=this.uniforms;n.resolution.value.set(t,e),n.texelSize.value.set(1/t,1/e),n.aspect.value=t/e}static get Section(){return Ia}},Ske=`#include <common>
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,Ake=class extends ir{constructor(t=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:vv.replace(/\D+/g,"")},uniforms:{inputBuffer:new wt(null),threshold:new wt(0),smoothing:new wt(1),range:new wt(null)},blending:Ir,depthWrite:!1,depthTest:!1,fragmentShader:Ske,vertexShader:W1}),this.toneMapped=!1,this.colorOutput=t,this.luminanceRange=e}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get threshold(){return this.uniforms.threshold.value}set threshold(t){this.smoothing>0||t>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=t}getThreshold(){return this.threshold}setThreshold(t){this.threshold=t}get smoothing(){return this.uniforms.smoothing.value}set smoothing(t){this.threshold>0||t>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=t}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(t){this.smoothing=t}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(t){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(t){t?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(t){return this.colorOutput}setColorOutputEnabled(t){this.colorOutput=t}get useRange(){return this.luminanceRange!==null}set useRange(t){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(t){t!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=t,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(t){this.luminanceRange=t}},Mke=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,J$={DISCARD:0,MULTIPLY:1,MULTIPLY_RGB_SET_ALPHA:2},Eke=class extends ir{constructor(t=null){super({name:"MaskMaterial",uniforms:{maskTexture:new wt(t),inputBuffer:new wt(null),strength:new wt(1)},blending:Ir,depthWrite:!1,depthTest:!1,fragmentShader:Mke,vertexShader:W1}),this.toneMapped=!1,this.setColorChannel(Q$.RED),this.setMaskFunction(J$.DISCARD)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}set maskTexture(t){this.uniforms.maskTexture.value=t,delete this.defines.MASK_PRECISION_HIGH,t.type!==Zr&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(t){this.maskTexture=t}set colorChannel(t){this.defines.COLOR_CHANNEL=t.toFixed(0),this.needsUpdate=!0}setColorChannel(t){this.colorChannel=t}set maskFunction(t){this.defines.MASK_FUNCTION=t.toFixed(0),this.needsUpdate=!0}setMaskFunction(t){this.maskFunction=t}get inverted(){return this.defines.INVERTED!==void 0}set inverted(t){this.inverted&&!t?delete this.defines.INVERTED:t&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(t){this.inverted=t}get strength(){return this.uniforms.strength.value}set strength(t){this.uniforms.strength.value=t}getStrength(){return this.strength}setStrength(t){this.strength=t}},Cke=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,Tke="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",Pke=class extends ir{constructor(t=new be,e=new be){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new wt(null),searchTexture:new wt(null),areaTexture:new wt(null),resolution:new wt(e),texelSize:new wt(t)},blending:Ir,depthWrite:!1,depthTest:!1,fragmentShader:Cke,vertexShader:Tke}),this.toneMapped=!1}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(t){this.uniforms.searchTexture.value=t}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(t){this.uniforms.areaTexture.value=t}setLookupTextures(t,e){this.searchTexture=t,this.areaTexture=e}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(t){let e=Math.min(Math.max(t,0),112);this.defines.MAX_SEARCH_STEPS_INT=e.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=e.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(t){this.orthogonalSearchSteps=t}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(t){let e=Math.min(Math.max(t,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=e.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=e.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(t){this.diagonalSearchSteps=t}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(t){t?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(t){this.diagonalDetection=t}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(t){let e=Math.min(Math.max(t,0),100);this.defines.CORNER_ROUNDING=e.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(e/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(t){this.cornerRounding=t}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(t){t?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(t){this.cornerDetection=t}setSize(t,e){let n=this.uniforms;n.texelSize.value.set(1/t,1/e),n.resolution.value.set(t,e)}},Dke=new wv,qu=null;function Rke(){if(qu===null){let t=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]);qu=new Lt,qu.setAttribute!==void 0?(qu.setAttribute("position",new Ut(t,3)),qu.setAttribute("uv",new Ut(e,2))):(qu.addAttribute("position",new Ut(t,3)),qu.addAttribute("uv",new Ut(e,2)))}return qu}var ma=class{constructor(t="Pass",e=new _f,n=Dke){this.name=t,this.renderer=null,this.scene=e,this.camera=n,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(t){if(this.rtt===t){let e=this.getFullscreenMaterial();e!==null&&(e.needsUpdate=!0),this.rtt=!t}}setRenderer(t){this.renderer=t}isEnabled(){return this.enabled}setEnabled(t){this.enabled=t}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(t){let e=this.screen;e!==null?e.material=t:(e=new uo(Rke(),t),e.frustumCulled=!1,this.scene===null&&(this.scene=new _f),this.scene.add(e),this.screen=e)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(t){this.fullscreenMaterial=t}getDepthTexture(){return null}setDepthTexture(t,e=gu){}render(t,e,n,i,r){throw new Error("Render method not implemented!")}setSize(t,e){}initialize(t,e,n){}dispose(){for(let t of Object.keys(this)){let e=this[t];if(e!==null&&typeof e.dispose=="function"){if(e instanceof _f||e===this.renderer)continue;this[t].dispose()}}}},SM=class extends ma{constructor(t,e=!0){super("CopyPass"),this.fullscreenMaterial=new vke,this.needsSwap=!1,this.renderTarget=t,t===void 0&&(this.renderTarget=new er(1,1,{minFilter:En,magFilter:En,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(t){this.autoResize=t}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(t){this.autoResize=t}render(t,e,n,i,r){this.fullscreenMaterial.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){this.autoResize&&this.renderTarget.setSize(t,e)}initialize(t,e,n){n!==void 0&&(this.renderTarget.texture.type=n,n!==Zr?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":t.outputEncoding===Wt&&(this.renderTarget.texture.encoding=Wt))}},Lke=class extends ma{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(t,e,n,i,r){let s=t.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},_D=new Rt,jE=class extends ma{constructor(t=!0,e=!0,n=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=t,this.depth=e,this.stencil=n,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(t,e,n){this.color=t,this.depth=e,this.stencil=n}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(t){this.overrideClearColor=t}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(t){this.overrideClearAlpha=t}render(t,e,n,i,r){let s=this.overrideClearColor,o=this.overrideClearAlpha,a=t.getClearAlpha(),l=s!==null,c=o>=0;l?(_D.copy(t.getClearColor(_D)),t.setClearColor(s,c?o:a)):c&&t.setClearAlpha(o),t.setRenderTarget(this.renderToScreen?null:e),t.clear(this.color,this.depth,this.stencil),l?t.setClearColor(_D,a):c&&t.setClearAlpha(a)}},Qu=-1,Os=class extends _s{constructor(e,n=Qu,i=Qu,r=1){super(),this.resizable=e,this.base=new be(1,1),this.preferred=new be(n,i),this.target=this.preferred,this.s=r}get width(){let{base:e,preferred:n,scale:i}=this,r;return n.width!==Qu?r=n.width:n.height!==Qu?r=Math.round(n.height*(e.width/Math.max(e.height,1))):r=Math.round(e.width*i),r}set width(e){this.preferredWidth=e}get height(){let{base:e,preferred:n,scale:i}=this,r;return n.height!==Qu?r=n.height:n.width!==Qu?r=Math.round(n.width/Math.max(e.width/Math.max(e.height,1),1)):r=Math.round(e.height*i),r}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferred.setScalar(Qu),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.base.width}set baseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(e){this.base.height!==e&&(this.base.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,n){(this.base.width!==e||this.base.height!==n)&&(this.base.set(e,n),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(e){this.preferred.width!==e&&(this.preferred.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferred.height}set preferredHeight(e){this.preferred.height!==e&&(this.preferred.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,n){(this.preferred.width!==e||this.preferred.height!==n)&&(this.preferred.set(e,n),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(e){this.base.set(e.getBaseWidth(),e.getBaseHeight()),this.preferred.set(e.getPreferredWidth(),e.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return Qu}},bD=!1,PW=class{constructor(t=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(t),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let n;if(e.material.flatShading)switch(e.material.side){case co:n=this.materialsFlatShadedDoubleSide;break;case xr:n=this.materialsFlatShadedBackSide;break;default:n=this.materialsFlatShaded;break}else switch(e.material.side){case co:n=this.materialsDoubleSide;break;case xr:n=this.materialsBackSide;break;default:n=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=n[2]:e.isInstancedMesh?e.material=n[1]:e.material=n[0],++this.meshCount}}}setMaterial(t){if(this.disposeMaterials(),this.material=t,t!==null){let e=this.materials=[t.clone(),t.clone(),t.clone()];for(let n of e)n.uniforms=Object.assign({},t.uniforms),n.side=el;e[2].skinning=!0,this.materialsBackSide=e.map(n=>{let i=n.clone();return i.uniforms=Object.assign({},t.uniforms),i.side=xr,i}),this.materialsDoubleSide=e.map(n=>{let i=n.clone();return i.uniforms=Object.assign({},t.uniforms),i.side=co,i}),this.materialsFlatShaded=e.map(n=>{let i=n.clone();return i.uniforms=Object.assign({},t.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=e.map(n=>{let i=n.clone();return i.uniforms=Object.assign({},t.uniforms),i.flatShading=!0,i.side=xr,i}),this.materialsFlatShadedDoubleSide=e.map(n=>{let i=n.clone();return i.uniforms=Object.assign({},t.uniforms),i.flatShading=!0,i.side=co,i})}}render(t,e,n){let i=t.shadowMap.enabled;if(t.shadowMap.enabled=!1,bD){let r=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),t.render(e,n);for(let s of r)s[0].material=s[1];this.meshCount!==r.size&&r.clear()}else{let r=e.overrideMaterial;e.overrideMaterial=this.material,t.render(e,n),e.overrideMaterial=r}t.shadowMap.enabled=i}disposeMaterials(){if(this.material!==null){let t=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let e of t)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return bD}static set workaroundEnabled(t){bD=t}},Ike=class extends ma{constructor(t,e,n=null){super("RenderPass",t,e),this.needsSwap=!1,this.clearPass=new jE,this.overrideMaterialManager=n===null?null:new PW(n),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(t){super.renderToScreen=t,this.clearPass.renderToScreen=t}get overrideMaterial(){let t=this.overrideMaterialManager;return t!==null?t.material:null}set overrideMaterial(t){let e=this.overrideMaterialManager;t!==null?e!==null?e.setMaterial(t):this.overrideMaterialManager=new PW(t):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(t){this.overrideMaterial=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getSelection(){return this.selection}setSelection(t){this.selection=t}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(t){this.ignoreBackground=t}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(t){this.skipShadowMapUpdate=t}getClearPass(){return this.clearPass}render(t,e,n,i,r){let s=this.scene,o=this.camera,a=this.selection,l=o.layers.mask,c=s.background,h=t.shadowMap.autoUpdate,u=this.renderToScreen?null:e;a!==null&&o.layers.set(a.getLayer()),this.skipShadowMapUpdate&&(t.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(t,e),t.setRenderTarget(u),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(t,s,o):t.render(s,o),o.layers.mask=l,s.background=c,t.shadowMap.autoUpdate=h}},DW=class extends ma{constructor(t,e,{resolutionScale:n=1,width:i=Os.AUTO_SIZE,height:r=Os.AUTO_SIZE,renderTarget:s}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new Ike(t,e,new oK({depthPacking:YQ}));let o=this.renderPass;o.skipShadowMapUpdate=!0,o.ignoreBackground=!0;let a=o.getClearPass();a.overrideClearColor=new Rt(16777215),a.overrideClearAlpha=1,this.renderTarget=s,this.renderTarget===void 0&&(this.renderTarget=new er(1,1,{minFilter:oi,magFilter:oi,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new Os(this,i,r,n);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,n,i,r){let s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(t,s)}setSize(t,e){let n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height)}},hn={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},Bke="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",Oke="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",Fke="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",Nke="float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Uke="float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",kke="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",zke="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",Gke="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",Hke="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",Vke="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",jke="float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Wke="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",Xke="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",Yke="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",qke="float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Qke="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",Kke="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",Jke="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",Zke=new Map([[hn.SKIP,null],[hn.ADD,Bke],[hn.ALPHA,Oke],[hn.AVERAGE,Fke],[hn.COLOR_BURN,Nke],[hn.COLOR_DODGE,Uke],[hn.DARKEN,kke],[hn.DIFFERENCE,zke],[hn.EXCLUSION,Gke],[hn.LIGHTEN,Hke],[hn.MULTIPLY,Vke],[hn.DIVIDE,jke],[hn.NEGATION,Wke],[hn.NORMAL,Xke],[hn.OVERLAY,Yke],[hn.REFLECT,qke],[hn.SCREEN,Qke],[hn.SOFT_LIGHT,Kke],[hn.SUBTRACT,Jke]]),$ke=class extends _s{constructor(t,e=1){super(),this.f=t,this.opacity=new wt(e)}getOpacity(){return this.opacity.value}setOpacity(t){this.opacity.value=t}get blendFunction(){return this.f}set blendFunction(t){this.f=t,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(t){this.blendFunction=t}getShaderCode(){return Zke.get(this.blendFunction)}},Jl={NONE:0,DEPTH:1,CONVOLUTION:2},lc=class extends _s{constructor(t,e,{attributes:n=Jl.NONE,blendFunction:i=hn.SCREEN,defines:r=new Map,uniforms:s=new Map,extensions:o=null,vertexShader:a=null}={}){super(),this.name=t,this.renderer=null,this.attributes=n,this.fragmentShader=e,this.vertexShader=a,this.defines=r,this.uniforms=s,this.extensions=o,this.blendMode=new $ke(i),this.blendMode.addEventListener("change",l=>this.setChanged())}getName(){return this.name}setRenderer(t){this.renderer=t}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(t){this.attributes=t,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(t){this.fragmentShader=t,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(t){this.vertexShader=t,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(t,e=gu){}update(t,e,n){}setSize(t,e){}initialize(t,e,n){}dispose(){for(let t of Object.keys(this)){let e=this[t];if(e!==null&&typeof e.dispose=="function"){if(e instanceof _f||e===this.renderer)continue;this[t].dispose()}}}};function RW(t,e,n){for(let i of e){let r="$1"+t+i.charAt(0).toUpperCase()+i.slice(1),s=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(let o of n.entries())o[1]!==null&&n.set(o[0],o[1].replace(s,r))}}function eze(t,e,n,i,r,s,o){let a=new Map([["fragment",e.getFragmentShader()],["vertex",e.getVertexShader()]]),l=a.get("fragment")!==void 0&&/mainImage/.test(a.get("fragment")),c=a.get("fragment")!==void 0&&/mainUv/.test(a.get("fragment")),h=[],u=[],d=!1,f=!1;if(a.get("fragment")===void 0)console.error("Missing fragment shader",e);else if(c&&o&Jl.CONVOLUTION)console.error("Effects that transform UV coordinates are incompatible with convolution effects",e);else if(!l&&!c)console.error("The fragment shader contains neither a mainImage nor a mainUv function",e);else{let p=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,v=i3.Section;if(c){let m=`	${t}MainUv(UV);
`;n.set(v.FRAGMENT_MAIN_UV,n.get(v.FRAGMENT_MAIN_UV)+m),d=!0}if(a.get("vertex")!==null&&/mainSupport/.test(a.get("vertex"))){let m=`	${t}MainSupport(`;m+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(a.get("vertex"))?`vUv);
`:`);
`,n.set(v.VERTEX_MAIN_SUPPORT,n.get(v.VERTEX_MAIN_SUPPORT)+m),h=h.concat([...a.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(y=>y[1])),u=u.concat(h).concat([...a.get("vertex").matchAll(p)].map(y=>y[1]))}u=u.concat([...a.get("fragment").matchAll(p)].map(m=>m[1])),u=u.concat([...e.defines.keys()].map(m=>m.replace(/\([\w\s,]*\)/g,""))),u=u.concat([...e.uniforms.keys()]),e.uniforms.forEach((m,y)=>s.set(t+y.charAt(0).toUpperCase()+y.slice(1),m)),e.defines.forEach((m,y)=>r.set(t+y.charAt(0).toUpperCase()+y.slice(1),m)),RW(t,u,r),RW(t,u,a);let g=e.blendMode;if(i.set(g.blendFunction,g),l){let m=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,y=`${t}MainImage(color0, UV, `;o&Jl.DEPTH&&m.test(a.get("fragment"))&&(y+="depth, ",f=!0),y+=`color1);
	`;let w=t+"BlendOpacity";s.set(w,g.opacity),y+=`color0 = blend${g.blendFunction}(color0, color1, ${w});

	`,n.set(v.FRAGMENT_MAIN_IMAGE,n.get(v.FRAGMENT_MAIN_IMAGE)+y),y=`uniform float ${w};

`,n.set(v.FRAGMENT_HEAD,n.get(v.FRAGMENT_HEAD)+y)}n.set(v.FRAGMENT_HEAD,n.get(v.FRAGMENT_HEAD)+a.get("fragment")+`
`),a.get("vertex")!==null&&n.set(v.VERTEX_HEAD,n.get(v.VERTEX_HEAD)+a.get("vertex")+`
`)}return{varyings:h,transformedUv:d,readDepth:f}}var SD=class extends ma{constructor(t,...e){super("EffectPass"),this.fullscreenMaterial=new i3(null,null,null,t),this.effects=e.sort((n,i)=>i.attributes-n.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(t){this.fullscreenMaterial.encodeOutput=t}get dithering(){return this.fullscreenMaterial.dithering}set dithering(t){let e=this.fullscreenMaterial;e.dithering=t,e.needsUpdate=!0}verifyResources(){let t=this.renderer.capabilities,e=Math.min(t.maxFragmentUniforms,t.maxVertexUniforms);this.uniformCount>e&&console.warn("The current rendering context doesn't support more than "+e+" uniforms, but "+this.uniformCount+" were defined"),e=t.maxVaryings,this.varyingCount>e&&console.warn("The current rendering context doesn't support more than "+e+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let t=i3.Section,e=new Map([[t.FRAGMENT_HEAD,""],[t.FRAGMENT_MAIN_UV,""],[t.FRAGMENT_MAIN_IMAGE,""],[t.VERTEX_HEAD,""],[t.VERTEX_MAIN_SUPPORT,""]]),n=new Map,i=new Map,r=new Map,s=new Set,o=0,a=0,l=0,c=!1,h=!1;for(let d of this.effects)if(d.blendMode.blendFunction===hn.SKIP)l|=d.getAttributes()&Jl.DEPTH;else if(l&d.getAttributes()&Jl.CONVOLUTION)console.error("Convolution effects cannot be merged",d);else{l|=d.getAttributes();let f="e"+o++,p=eze(f,d,e,n,i,r,l);if(a+=p.varyings.length,c=c||p.transformedUv,h=h||p.readDepth,d.extensions!==null)for(let v of d.extensions)s.add(v)}let u=/\bblend\b/g;for(let d of n.values()){let f=d.getShaderCode().replace(u,`blend${d.blendFunction}`);e.set(t.FRAGMENT_HEAD,e.get(t.FRAGMENT_HEAD)+f+`
`)}if(l&Jl.DEPTH){if(h){let d=`float depth = readDepth(UV);

	`;e.set(t.FRAGMENT_MAIN_IMAGE,d+e.get(t.FRAGMENT_MAIN_IMAGE))}this.needsDepthTexture=this.getDepthTexture()===null}else this.needsDepthTexture=!1;if(c){let d=`vec2 transformedUv = vUv;
`;e.set(t.FRAGMENT_MAIN_UV,d+e.get(t.FRAGMENT_MAIN_UV)),i.set("UV","transformedUv")}else i.set("UV","vUv");e.forEach((d,f,p)=>p.set(f,d.trim().replace(/^#/,`
#`))),this.uniformCount=r.size,this.varyingCount=a,this.skipRendering=o===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(e).setExtensions(s).setUniforms(r).setDefines(i)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(t,e=gu){this.fullscreenMaterial.depthBuffer=t,this.fullscreenMaterial.depthPacking=e;for(let n of this.effects)n.setDepthTexture(t,e)}render(t,e,n,i,r){for(let s of this.effects)s.update(t,e,i);if(!this.skipRendering||this.renderToScreen){let s=this.fullscreenMaterial;s.inputBuffer=e.texture,s.time+=i,t.setRenderTarget(this.renderToScreen?null:n),t.render(this.scene,this.camera)}}setSize(t,e){this.fullscreenMaterial.setSize(t,e);for(let n of this.effects)n.setSize(t,e)}initialize(t,e,n){this.renderer=t;for(let i of this.effects)i.initialize(t,e,n),i.addEventListener("change",r=>this.handleEvent(r));this.updateMaterial(),this.verifyResources(),n!==void 0&&n!==Zr&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let t of this.effects)t.dispose()}handleEvent(t){switch(t.type){case"change":this.recompile();break}}},tze=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],Z$=class extends ma{constructor({resolutionScale:t=.5,width:e=Os.AUTO_SIZE,height:n=Os.AUTO_SIZE,kernelSize:i=sN.LARGE}={}){super("KawaseBlurPass"),this.renderTargetA=new er(1,1,{minFilter:En,magFilter:En,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let r=this.resolution=new Os(this,e,n,t);r.addEventListener("change",s=>this.setSize(r.baseWidth,r.baseHeight)),this.blurMaterial=new TW,this.ditheredBlurMaterial=new TW,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=i}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(t){this.resolution.preferredWidth=t}get height(){return this.resolution.height}set height(t){this.resolution.preferredHeight=t}get scale(){return this.blurMaterial.scale}set scale(t){this.blurMaterial.scale=t}getScale(){return this.blurMaterial.scale}setScale(t){this.blurMaterial.scale=t}getKernelSize(){return this.kernelSize}setKernelSize(t){this.kernelSize=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,n,i,r){let s=this.scene,o=this.camera,a=this.renderTargetA,l=this.renderTargetB,c=tze[this.kernelSize],h=this.blurMaterial,u=e,d,f;for(this.fullscreenMaterial=h,d=0,f=c.length-1;d<f;++d){let p=d&1?l:a;h.kernel=c[d],h.inputBuffer=u.texture,t.setRenderTarget(p),t.render(s,o),u=p}this.dithering&&(h=this.ditheredBlurMaterial,this.fullscreenMaterial=h),h.kernel=c[d],h.inputBuffer=u.texture,t.setRenderTarget(this.renderToScreen?null:n),t.render(s,o)}setSize(t,e){let n=this.resolution;n.setBaseSize(t,e);let i=n.width,r=n.height;this.renderTargetA.setSize(i,r),this.renderTargetB.setSize(i,r),this.blurMaterial.setSize(i,r),this.ditheredBlurMaterial.setSize(i,r)}initialize(t,e,n){n!==void 0&&(this.renderTargetA.texture.type=n,this.renderTargetB.texture.type=n,n!==Zr?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):t.outputEncoding===Wt&&(this.renderTargetA.texture.encoding=Wt,this.renderTargetB.texture.encoding=Wt))}static get AUTO_SIZE(){return Os.AUTO_SIZE}},nze=class extends ma{constructor({width:t=Os.AUTO_SIZE,height:e=Os.AUTO_SIZE,renderTarget:n,luminanceRange:i,colorOutput:r}={}){super("LuminancePass"),this.fullscreenMaterial=new Ake(r,i),this.needsSwap=!1,this.renderTarget=n,this.renderTarget===void 0&&(this.renderTarget=new er(1,1,{minFilter:En,magFilter:En,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let s=this.resolution=new Os(this,t,e);s.addEventListener("change",o=>this.setSize(s.baseWidth,s.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(t,e,n,i,r){let s=this.fullscreenMaterial;s.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){let n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height)}initialize(t,e,n){n!==void 0&&n!==Zr&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},ize=class extends ma{constructor(t,e){super("MaskPass",t,e),this.needsSwap=!1,this.clearPass=new jE(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(t){this.inverse=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(t){this.inverted=t}render(t,e,n,i,r){let s=t.getContext(),o=t.state.buffers,a=this.scene,l=this.camera,c=this.clearPass,h=this.inverted?0:1,u=1-h;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.stencil.setFunc(s.ALWAYS,h,4294967295),o.stencil.setClear(u),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(t,null):(c.render(t,e),c.render(t,n))),this.renderToScreen?(t.setRenderTarget(null),t.render(a,l)):(t.setRenderTarget(e),t.render(a,l),t.setRenderTarget(n),t.render(a,l)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(s.EQUAL,1,4294967295),o.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.stencil.setLocked(!0)}},ih=class extends ma{constructor(t,e="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=t,this.inputBufferUniform=null,this.setInput(e)}setInput(t){if(this.inputBufferUniform=null,this.fullscreenMaterial!==null){let e=this.fullscreenMaterial.uniforms;e!==void 0&&e[t]!==void 0&&(this.inputBufferUniform=e[t])}}render(t,e,n,i,r){this.inputBufferUniform!==null&&e!==null&&(this.inputBufferUniform.value=e.texture),t.setRenderTarget(this.renderToScreen?null:n),t.render(this.scene,this.camera)}initialize(t,e,n){n!==void 0&&n!==Zr&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},AD=1/1e3,rze=1e3,sze=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(t){return this.fixedDeltaEnabled=t,this}isAutoResetEnabled(t){return this.autoReset}setAutoResetEnabled(t){return typeof document<"u"&&document.hidden!==void 0&&(t?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=t),this}getDelta(){return this.delta*AD}getFixedDelta(){return this.fixedDelta*AD}setFixedDelta(t){return this.fixedDelta=t*rze,this}getElapsed(){return this.elapsed*AD}getTimescale(){return this.timescale}setTimescale(t){return this.timescale=t,this}update(t){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=t!==void 0?t:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(t){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},oze=class{constructor(t=null,{depthBuffer:e=!0,stencilBuffer:n=!1,multisampling:i=0,frameBufferType:r}={}){this.renderer=null,this.inputBuffer=this.createBuffer(e,n,r,i),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new SM,this.depthTexture=null,this.passes=[],this.timer=new sze,this.autoRenderToScreen=!0,this.setRenderer(t)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(t){let e=this.inputBuffer,n=this.multisampling;n>0&&t>0?(this.inputBuffer.samples=t,this.outputBuffer.samples=t,this.inputBuffer.dispose(),this.outputBuffer.dispose()):n!==t&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,t),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(t){if(this.renderer=t,t!==null){let e=t.getSize(new be),n=t.getContext().getContextAttributes().alpha,i=this.inputBuffer.texture.type;i===Zr&&t.outputEncoding===Wt&&(this.inputBuffer.texture.encoding=Wt,this.outputBuffer.texture.encoding=Wt,this.inputBuffer.dispose(),this.outputBuffer.dispose()),t.autoClear=!1,this.setSize(e.width,e.height);for(let r of this.passes)r.initialize(t,n,i)}}replaceRenderer(t,e=!0){let n=this.renderer,i=n.domElement.parentNode;return this.setRenderer(t),e&&i!==null&&(i.removeChild(n.domElement),i.appendChild(t.domElement)),n}createDepthTexture(){let t=this.depthTexture=new zO;return this.inputBuffer.depthTexture=t,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(t.format=Uf,t.type=yf):t.type=fh,t}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let t of this.passes)t.setDepthTexture(null)}}createBuffer(t,e,n,i){let r=this.renderer,s=r===null?new be:r.getDrawingBufferSize(new be),o={minFilter:En,magFilter:En,stencilBuffer:e,depthBuffer:t,type:n},a=new er(s.width,s.height,o);return i>0&&(a.ignoreDepthForMultisampleCopy=!1,a.samples=i),n===Zr&&r!==null&&r.outputEncoding===Wt&&(a.texture.encoding=Wt),a.texture.name="EffectComposer.Buffer",a.texture.generateMipmaps=!1,a}addPass(t,e){let n=this.passes,i=this.renderer,r=i.getDrawingBufferSize(new be),s=i.getContext().getContextAttributes().alpha,o=this.inputBuffer.texture.type;if(t.setRenderer(i),t.setSize(r.width,r.height),t.initialize(i,s,o),this.autoRenderToScreen&&(n.length>0&&(n[n.length-1].renderToScreen=!1),t.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?n.splice(e,0,t):n.push(t),this.autoRenderToScreen&&(n[n.length-1].renderToScreen=!0),t.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){let a=this.createDepthTexture();for(t of n)t.setDepthTexture(a)}else t.setDepthTexture(this.depthTexture)}removePass(t){let e=this.passes,n=e.indexOf(t);if(n!==-1&&e.splice(n,1).length>0){if(this.depthTexture!==null){let i=(r,s)=>r||s.needsDepthTexture;e.reduce(i,!1)||(t.getDepthTexture()===this.depthTexture&&t.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&n===e.length&&(t.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){let t=this.passes;this.deleteDepthTexture(),t.length>0&&(this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!1),this.passes=[])}render(t){let e=this.renderer,n=this.copyPass,i=this.inputBuffer,r=this.outputBuffer,s=!1,o,a,l;t===void 0&&(t=this.timer.update().getDelta());for(let c of this.passes)c.enabled&&(c.render(e,i,r,t,s),c.needsSwap&&(s&&(n.renderToScreen=c.renderToScreen,o=e.getContext(),a=e.state.buffers.stencil,a.setFunc(o.NOTEQUAL,1,4294967295),n.render(e,i,r,t,s),a.setFunc(o.EQUAL,1,4294967295)),l=i,i=r,r=l),c instanceof ize?s=!0:c instanceof Lke&&(s=!1))}setSize(t,e,n){let i=this.renderer;if(t===void 0||e===void 0){let s=i.getSize(new be);t=s.width,e=s.height}i.setSize(t,e,n);let r=i.getDrawingBufferSize(new be);this.inputBuffer.setSize(r.width,r.height),this.outputBuffer.setSize(r.width,r.height);for(let s of this.passes)s.setSize(r.width,r.height)}reset(){let t=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(t)}dispose(){for(let t of this.passes)t.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},sN={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},aze=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,lze=class extends lc{constructor({blendFunction:t=hn.SCREEN,luminanceThreshold:e=.9,luminanceSmoothing:n=.025,resolutionScale:i=.5,intensity:r=1,width:s=Os.AUTO_SIZE,height:o=Os.AUTO_SIZE,kernelSize:a=sN.LARGE}={}){super("BloomEffect",aze,{blendFunction:t,uniforms:new Map([["map",new wt(null)],["intensity",new wt(r)]])}),this.renderTarget=new er(1,1,{minFilter:En,magFilter:En,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new nze({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothingFactor=n,this.blurPass=new Z$({resolutionScale:i,width:s,height:o,kernelSize:a});let l=this.blurPass.getResolution();l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(t){this.resolution.preferredWidth=t}get height(){return this.resolution.height}set height(t){this.resolution.preferredHeight=t}get dithering(){return this.blurPass.dithering}set dithering(t){this.blurPass.dithering=t}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(t){this.blurPass.kernelSize=t}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(t){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(t){this.uniforms.get("intensity").value=t}getIntensity(){return this.intensity}setIntensity(t){this.intensity=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}update(t,e,n){let i=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(t,e,i),this.blurPass.render(t,i,i)):this.blurPass.render(t,e,i)}setSize(t,e){let n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height),this.luminancePass.resolution.copy(n)}initialize(t,e,n){this.blurPass.initialize(t,e,n),n!==void 0&&(this.renderTarget.texture.type=n,t.outputEncoding===Wt&&(this.renderTarget.texture.encoding=Wt))}},cze="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",uze=class extends lc{constructor({blendFunction:t=hn.NORMAL,brightness:e=0,contrast:n=0}={}){super("BrightnessContrastEffect",cze,{blendFunction:t,uniforms:new Map([["brightness",new wt(e)],["contrast",new wt(n)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(t){this.uniforms.get("brightness").value=t}getBrightness(t){return this.brightness}setBrightness(t){this.brightness=t}get contrast(){return this.uniforms.get("contrast").value}set contrast(t){this.uniforms.get("contrast").value=t}getContrast(t){return this.contrast}setContrast(t){this.contrast=t}},hze="void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",dze=class extends lc{constructor(t=hn.NORMAL){super("ColorAverageEffect",hze,{blendFunction:t})}},fze="varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",pze="uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",mze=class extends lc{constructor({blendFunction:t=hn.NORMAL,offset:e=new be(.001,5e-4)}={}){super("ChromaticAberrationEffect",fze,{vertexShader:pze,blendFunction:t,attributes:Jl.CONVOLUTION,uniforms:new Map([["offset",new wt(e)]])})}get offset(){return this.uniforms.get("offset").value}set offset(t){this.uniforms.get("offset").value=t}getOffset(){return this.offset}setOffset(t){this.offset=t}},gze=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}`,vze=class extends lc{constructor(t,{blendFunction:e=hn.NORMAL,worldFocusDistance:n,worldFocusRange:i,focusDistance:r=0,focalLength:s=.1,focusRange:o=s,bokehScale:a=1,width:l=Os.AUTO_SIZE,height:c=Os.AUTO_SIZE}={}){super("DepthOfFieldEffect",gze,{blendFunction:e,attributes:Jl.DEPTH,uniforms:new Map([["nearColorBuffer",new wt(null)],["farColorBuffer",new wt(null)],["nearCoCBuffer",new wt(null)],["scale",new wt(1)]])}),this.camera=t,this.renderTarget=new er(1,1,{minFilter:En,magFilter:En,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new ih(new fke(t));let h=this.cocMaterial;h.focusDistance=r,h.focusRange=o,n!==void 0&&(h.worldFocusDistance=n),i!==void 0&&(h.worldFocusRange=i),this.blurPass=new Z$({kernelSize:sN.MEDIUM,width:l,height:c});let u=this.blurPass.getResolution();u.addEventListener("change",f=>this.setSize(u.getBaseWidth(),u.getBaseHeight())),this.maskPass=new ih(new Eke(this.renderTargetCoC.texture));let d=this.maskPass.fullscreenMaterial;d.maskFunction=J$.MULTIPLY,d.colorChannel=Q$.GREEN,this.bokehNearBasePass=new ih(new rS(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new ih(new rS(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new ih(new rS(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new ih(new rS(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=a}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(t){let e=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let n of e)n.fullscreenMaterial.setScale(t);this.maskPass.fullscreenMaterial.setStrength(t),this.uniforms.get("scale").value=t}getBokehScale(){return this.bokehScale}setBokehScale(t){this.bokehScale=t}getTarget(){return this.target}setTarget(t){this.target=t}calculateFocusDistance(t){let e=this.camera,n=e.position.distanceTo(t);return n3(-n,e.near,e.far)}setDepthTexture(t,e=gu){this.circleOfConfusionMaterial.depthBuffer=t,this.circleOfConfusionMaterial.depthPacking=e}update(t,e,n){let i=this.renderTarget,r=this.renderTargetCoC,s=this.renderTargetCoCBlurred,o=this.renderTargetMasked;if(this.target!==null){let a=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=a}this.cocPass.render(t,null,r),this.blurPass.render(t,r,s),this.maskPass.render(t,e,o),this.bokehFarBasePass.render(t,o,i),this.bokehFarFillPass.render(t,i,this.renderTargetFar),this.bokehNearBasePass.render(t,e,i),this.bokehNearFillPass.render(t,i,this.renderTargetNear)}setSize(t,e){let n=this.resolution;n.setBaseSize(t,e);let i=n.width,r=n.height,s=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];s.push(this.renderTargetCoC,this.renderTargetMasked),s.forEach(o=>o.setSize(t,e)),s=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],s.forEach(o=>o.setSize(i,r)),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(o=>o.fullscreenMaterial.setSize(i,r))}initialize(t,e,n){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(i=>i.initialize(t,e,n)),this.blurPass.initialize(t,e,Zr),n!==void 0&&(this.renderTarget.texture.type=n,this.renderTargetNear.texture.type=n,this.renderTargetFar.texture.type=n,this.renderTargetMasked.texture.type=n,t.outputEncoding===Wt&&(this.renderTarget.texture.encoding=Wt,this.renderTargetNear.texture.encoding=Wt,this.renderTargetFar.texture.encoding=Wt,this.renderTargetMasked.texture.encoding=Wt))}};new N;new nt;var yze="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",xze=class extends lc{constructor({blendFunction:t=hn.NORMAL,hue:e=0,saturation:n=0}={}){super("HueSaturationEffect",yze,{blendFunction:t,uniforms:new Map([["hue",new wt(new N)],["saturation",new wt(n)]])}),this.hue=e}get saturation(){return this.uniforms.get("saturation").value}set saturation(t){this.uniforms.get("saturation").value=t}getSaturation(){return this.saturation}setSaturation(t){this.saturation=t}get hue(){let t=this.uniforms.get("hue").value;return Math.acos((t.x*3-1)/2)}set hue(t){let e=Math.sin(t),n=Math.cos(t);this.uniforms.get("hue").value.set((2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3)}getHue(){return this.hue}setHue(t){this.hue=t}};new Rt;var wze=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,_ze=class extends lc{constructor({blendFunction:t=hn.SCREEN,premultiply:e=!1}={}){super("NoiseEffect",wze,{blendFunction:t}),this.premultiply=e}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(t){this.premultiply!==t&&(t?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(t){this.premultiply=t}},bze="uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",Sze=class extends lc{constructor(t=30){super("PixelationEffect",bze,{uniforms:new Map([["active",new wt(!1)],["d",new wt(new be)]])}),this.resolution=new be,this.d=0,this.granularity=t}get granularity(){return this.d}set granularity(t){let e=Math.floor(t);e%2>0&&(e+=1),this.d=e,this.uniforms.get("active").value=e>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(t){this.granularity=t}setSize(t,e){this.resolution.set(t,e),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}};new N;new N;var LW="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",IW="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",Aze="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",Mze="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",Am={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},Eze=class extends lc{constructor({preset:t=Am.MEDIUM,edgeDetectionMode:e=rN.COLOR,predicationMode:n=K$.DISABLED}={}){super("SMAAEffect",Aze,{vertexShader:Mze,blendFunction:hn.NORMAL,attributes:Jl.CONVOLUTION|Jl.DEPTH,uniforms:new Map([["weightMap",new wt(null)]])});let i,r;arguments.length>1&&(i=arguments[0],r=arguments[1],arguments.length>2&&(t=arguments[2]),arguments.length>3&&(e=arguments[3])),this.renderTargetEdges=new er(1,1,{minFilter:En,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new jE(!0,!1,!1),this.clearPass.overrideClearColor=new Rt(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new ih(new wke),this.edgeDetectionMaterial.edgeDetectionMode=e,this.edgeDetectionMaterial.predicationMode=n,this.weightsPass=new ih(new Pke);let s=new wK;s.onLoad=()=>{let o=new br(i);o.name="SMAA.Search",o.magFilter=oi,o.minFilter=oi,o.generateMipmaps=!1,o.needsUpdate=!0,o.flipY=!0,this.weightsMaterial.searchTexture=o;let a=new br(r);a.name="SMAA.Area",a.magFilter=En,a.minFilter=En,a.generateMipmaps=!1,a.needsUpdate=!0,a.flipY=!1,this.weightsMaterial.areaTexture=a,this.dispatchEvent({type:"load"})},s.itemStart("search"),s.itemStart("area"),i!==void 0&&r!==void 0?(s.itemEnd("search"),s.itemEnd("area")):typeof Image<"u"&&(i=new Image,r=new Image,i.addEventListener("load",()=>s.itemEnd("search")),r.addEventListener("load",()=>s.itemEnd("area")),i.src=LW,r.src=IW),this.applyPreset(t)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(t){this.edgeDetectionMaterial.edgeDetectionThreshold=t}setOrthogonalSearchSteps(t){this.weightsMaterial.orthogonalSearchSteps=t}applyPreset(t){let e=this.edgeDetectionMaterial,n=this.weightsMaterial;switch(t){case Am.LOW:e.edgeDetectionThreshold=.15,n.orthogonalSearchSteps=4,n.diagonalDetection=!1,n.cornerDetection=!1;break;case Am.MEDIUM:e.edgeDetectionThreshold=.1,n.orthogonalSearchSteps=8,n.diagonalDetection=!1,n.cornerDetection=!1;break;case Am.HIGH:e.edgeDetectionThreshold=.1,n.orthogonalSearchSteps=16,n.diagonalSearchSteps=8,n.cornerRounding=25,n.diagonalDetection=!0,n.cornerDetection=!0;break;case Am.ULTRA:e.edgeDetectionThreshold=.05,n.orthogonalSearchSteps=32,n.diagonalSearchSteps=16,n.cornerRounding=25,n.diagonalDetection=!0,n.cornerDetection=!0;break}}setDepthTexture(t,e=gu){this.edgeDetectionMaterial.depthBuffer=t,this.edgeDetectionMaterial.depthPacking=e}update(t,e,n){this.clearPass.render(t,this.renderTargetEdges),this.edgeDetectionPass.render(t,e,this.renderTargetEdges),this.weightsPass.render(t,this.renderTargetEdges,this.renderTargetWeights)}setSize(t,e){this.edgeDetectionMaterial.setSize(t,e),this.weightsMaterial.setSize(t,e),this.renderTargetEdges.setSize(t,e),this.renderTargetWeights.setSize(t,e)}dispose(){let{searchTexture:t,areaTexture:e}=this.weightsMaterial;t!==null&&e!==null&&(t.dispose(),e.dispose()),super.dispose()}static get searchImageDataURL(){return LW}static get areaImageDataURL(){return IW}},Cze=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,sS={DEFAULT:0,ESKIL:1},Tze=class extends lc{constructor({blendFunction:t=hn.NORMAL,technique:e=sS.DEFAULT,eskil:n=!1,offset:i=.5,darkness:r=.5}={}){super("VignetteEffect",Cze,{blendFunction:t,defines:new Map([["VIGNETTE_TECHNIQUE",e.toFixed(0)]]),uniforms:new Map([["offset",new wt(i)],["darkness",new wt(r)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(t){this.technique!==t&&(this.defines.set("VIGNETTE_TECHNIQUE",t.toFixed(0)),this.setChanged())}get eskil(){return this.technique===sS.ESKIL}set eskil(t){this.technique=t?sS.ESKIL:sS.DEFAULT}getTechnique(){return this.technique}setTechnique(t){this.technique=t}get offset(){return this.uniforms.get("offset").value}set offset(t){this.uniforms.get("offset").value=t}getOffset(){return this.offset}setOffset(t){this.offset=t}get darkness(){return this.uniforms.get("darkness").value}set darkness(t){this.uniforms.get("darkness").value=t}getDarkness(){return this.darkness}setDarkness(t){this.darkness=t}};Yr(0,0,0,0),new Float32Array([0,0,0,0]),Yr(0,0,0,1),new Float32Array([0,0,0,1]),Yr(0,0,1,0),new Float32Array([0,0,1,0]),Yr(0,0,1,1),new Float32Array([0,0,1,1]),Yr(0,1,0,0),new Float32Array([0,1,0,0]),Yr(0,1,0,1),new Float32Array([0,1,0,1]),Yr(0,1,1,0),new Float32Array([0,1,1,0]),Yr(0,1,1,1),new Float32Array([0,1,1,1]),Yr(1,0,0,0),new Float32Array([1,0,0,0]),Yr(1,0,0,1),new Float32Array([1,0,0,1]),Yr(1,0,1,0),new Float32Array([1,0,1,0]),Yr(1,0,1,1),new Float32Array([1,0,1,1]),Yr(1,1,0,0),new Float32Array([1,1,0,0]),Yr(1,1,0,1),new Float32Array([1,1,0,1]),Yr(1,1,1,0),new Float32Array([1,1,1,0]),Yr(1,1,1,1),new Float32Array([1,1,1,1]);function MD(t,e,n){return t+(e-t)*n}function Yr(t,e,n,i){let r=MD(t,e,.75),s=MD(n,i,1-.25);return MD(r,s,1-.125)}var yu=class{constructor(t,e){this.enabled=!1,this.effect=new t(e),Object.defineProperty(this,"opacity",{enumerable:!0,set(n){this.effect.blendMode.opacity.value=n},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(n){this.effect.blendMode.setBlendFunction(Number(n))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=hn.NORMAL}},Pze=class extends yu{constructor(){super(lze),this.blendFunction=hn.SCREEN}set intensity(t){this.effect.intensity=t}get intensity(){return this.effect.intensity}set luminanceThreshold(t){this.effect.luminanceMaterial.threshold=t}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(t){this.effect.luminanceMaterial.smoothing=t}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(t){this.effect.blurPass.scale=t}get blurScale(){return this.effect.blurPass.scale}set kernelSize(t){this.effect.blurPass.kernelSize=t}get kernelSize(){return this.effect.blurPass.kernelSize}},Dze=class extends yu{constructor(){super(uze)}set contrast(t){this.effect.uniforms.get("contrast").value=t}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(t){this.effect.uniforms.get("brightness").value=t}get brightness(){return this.effect.uniforms.get("brightness").value}},Rze=class extends yu{constructor(){super(mze),this.effect.offset=new be(.01,.01)}set offset(t){this.effect.offset.set(t[0]/1e3,t[1]/1e3)}get offset(){return[this.effect.offset.x*1e3,this.effect.offset.y*1e3]}},Lze=class extends yu{constructor(){super(dze)}},Ize=class extends yu{constructor(){super(xze),this._hue=0}set hue(t){this._hue=t,this.effect.setHue(t)}get hue(){return this._hue}set saturation(t){this.effect.uniforms.get("saturation").value=t}get saturation(){return this.effect.uniforms.get("saturation").value}},Bze=class extends yu{constructor(){super(_ze),this.blendFunction=hn.OVERLAY}},Oze=class extends yu{constructor(){super(Tze)}get eskil(){return this.effect.eskil}set eskil(t){this.effect.eskil=t}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(t){this.effect.uniforms.get("darkness").value=t}get offset(){return this.effect.uniforms.get("offset").value}set offset(t){this.effect.uniforms.get("offset").value=t}},Fze=class extends yu{constructor(t){super(vze,t)}set focalLength(t){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=t}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(t){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=t}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(t){this.effect.bokehScale=t}},Nze=class extends yu{constructor(){super(Sze)}get granularity(){return this.effect.getGranularity()}set granularity(t){this.effect.setGranularity(t)}},Uze=class extends ma{constructor(t,e,n){super("TransmissionPass",t,e),this.copyPass=new SM(n.transmissionRenderTarget),this.depthPass=new DW(t,e,{renderTarget:n.transmissionDepthTarget}),this.needsSwap=!1}updatePasses(t){this.copyPass=new SM(t.transmissionRenderTarget),this.depthPass=new DW(this.scene,this.camera,{renderTarget:t.transmissionDepthTarget})}setCamera(t){this.camera=t}setScene(t){this.scene=t}render(t,e,n){let i=this.camera.layers.mask;this.copyPass.render(t,e,n),this.camera.layers.disable(3),this.depthPass.render(t,e,n),t.shadowMap.needsUpdate=!1,t.shadowMap.autoUpdate=!1;let r=this.renderToScreen?null:e;this.camera.layers.set(3),t.setRenderTarget(r),t.render(this.scene,this.camera),this.camera.layers.mask=i}},BW=new _f,kze=new ir({transparent:!0,vertexShader:`
        void main() {
            gl_Position = vec4(0.0);
        }
    `,fragmentShader:`
        void main() {
            gl_FragColor = vec4(0.0);
        }
    `}),ED=class extends ma{constructor(t,e){super("OpaquePass",t??BW,e),this.hasTransmissionPass=!1,this.clear=!0,this.needsSwap=!1,this.originalMaterials=new Map}setCamera(t){this.camera=t}setScene(t){this.scene=t??BW}getScene(){return this.scene}render(t,e){this.originalMaterials.clear(),this.camera.layers.enable(3),this.hasTransmissionPass&&this.scene.traverse(i=>{i.layers.isEnabled(3)&&i instanceof Vs&&(this.originalMaterials.set(i.id,i.material),i.material=kze)}),this.camera.layers.enable(8),t.shadowMap.needsUpdate=!0,t.shadowMap.autoUpdate=!0;let n=this.renderToScreen?null:e;t.setRenderTarget(n),this.clear&&t.clear(),t.render(this.scene,this.camera),this.hasTransmissionPass&&this.originalMaterials.forEach((i,r)=>{let s=this.scene.getObjectById(r);s&&(s.material=i)})}};function OW(t,e){return e&&e.enabled&&t.push(e.effect),t}var zze=t=>Object.values(hn).includes(t)?t:hn.NORMAL,Gze=class extends _s{constructor(t){super(),this.postprocessingState=jx.defaultData,this._scene=new _f,this._camera=new Gs,this.effects=new Map,this._renderToScreen=!0,this.clock=new HAe,this.renderer=t,this.debug=!1,this.effects.set("bloom",new Pze),this.effects.set("chromaticAberration",new Rze),this.effects.set("vignette",new Oze),this.effects.set("noise",new Bze),this.effects.set("colorAverage",new Lze),this.effects.set("hueSaturation",new Ize),this.effects.set("brightnessContrast",new Dze),this.effects.set("depthOfField",new Fze),this.effects.set("pixelation",new Nze),this.effectComposer=new oze(this.renderer),this.opaquePass=new ED(this.scene,this.camera),this.transmissionPass=new Uze(this.scene,this.camera,this.renderer),this.helperPass=new ED(void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperClearPass=new jE(!1,!0,!1),this.helperPassOnTop=new ED(void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this._initCopyPass(),this._initSmaa(),this._initPasses()}get scene(){return this._scene}set scene(t){this._scene=t,this.opaquePass.setScene(t),this.transmissionPass.setScene(t)}set sceneHelpers(t){this.helperPass.setScene(t)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(t){this.helperPassOnTop.setScene(t)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}get camera(){return this._camera}set camera(t){this._camera=t,this.opaquePass.setCamera(t),this.transmissionPass.setCamera(t),this.helperPass.setCamera(t),this.helperPassOnTop.setCamera(t)}setTransmissionPassEnabled(t){this.transmissionPass.enabled=t,this.opaquePass.hasTransmissionPass=t}disableHelpers(){this.helperPass.enabled=!1,this.helperClearPass.enabled=!1,this.helperPassOnTop.enabled=!1}enableHelpers(){this.helperPass.enabled=!0,this.helperClearPass.enabled=!0,this.helperPassOnTop.enabled=!0}_initSmaa(){let t=new Eze({preset:Am.ULTRA,edgeDetectionMode:rN.COLOR}),e=()=>{t.removeEventListener("load",e),this.dispatchEvent({type:"smaaloaded"})};t.addEventListener("load",e),t.edgeDetectionMaterial.predicationMode=K$.DEPTH,t.edgeDetectionMaterial.edgeDetectionThreshold=.05,t.edgeDetectionMaterial.predicationThreshold=.002,t.edgeDetectionMaterial.predicationScale=1,this.smaaPass=new SD(this.camera,t)}_initPasses(){var t,e;if((t=this.uvEffectPass)==null||t.dispose(),(e=this.effectPass)==null||e.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.postprocessingState.enabled){let n=[this.effects.get("pixelation")].reduce(OW,[]);n.length>0&&(this.uvEffectPass=new SD(this.camera,...n),this.effectComposer.addPass(this.uvEffectPass));let i=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(OW,[]);i.length>0&&(this.effectPass=new SD(this.camera,...i),this.effectComposer.addPass(this.effectPass))}this.effectComposer.addPass(this.helperPass),this.effectComposer.addPass(this.helperClearPass),this.effectComposer.addPass(this.helperPassOnTop),this.effectComposer.addPass(this.smaaPass)}_initCopyPass(){if(this._savePass)return;let t=new be;this.renderer.getDrawingBufferSize(t),this._rt=new er(t.x,t.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:Rx,wrapT:Rx}),this._rt.samples=0,this._savePass=new SM(this._rt,!1),this._savePass.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(t){if(this._renderToScreen===t)return;let e=this.effectComposer;!e||(t===!0?(e.removePass(this._savePass),e.passes[e.passes.length-1].renderToScreen=!0,e.autoRenderToScreen=!0):(e.autoRenderToScreen=!1,e.passes[e.passes.length-1].renderToScreen=!1,this._savePass.renderToScreen=!1,this.postprocessingState.enabled||(this._savePass.needsDepthTexture=!0),e.addPass(this._savePass)),this._renderToScreen=t)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(t){let{enabled:e,...n}=t,i=!1;e!==this.postprocessingState.enabled&&(i=!0);for(let r of Object.entries(n)){let s=r[1],o=this.effects.get(r[0]);if(o){o.enabled!==s.enabled&&(i=!0),o.enabled=s.enabled;for(let[a,l]of Object.entries(s))a==="blendFunction"?o.blendFunction=zze(l):o[a]=l}}this.postprocessingState=t,i&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(t,e,n,i){t instanceof Zt?(this.effectComposer.inputBuffer.scissor.set(t.x,t.y,t.z,t.w),this.effectComposer.outputBuffer.scissor.set(t.x,t.y,t.z,t.w)):(this.effectComposer.inputBuffer.scissor.set(t,e,n,i),this.effectComposer.outputBuffer.scissor.set(t,e,n,i));let r=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(r),this.effectComposer.outputBuffer.scissor.multiplyScalar(r),this.renderer.setScissor(t,e,n,i)}setScissorTest(t){this.effectComposer.inputBuffer.scissorTest=t,this.effectComposer.outputBuffer.scissorTest=t,this.renderer.setScissorTest(t)}setViewport(t,e,n,i){t instanceof Zt?(this.effectComposer.inputBuffer.viewport.copy(t),this.effectComposer.outputBuffer.viewport.copy(t)):(this.effectComposer.inputBuffer.viewport.set(t,e,n,i),this.effectComposer.outputBuffer.viewport.set(t,e,n,i))}resize(t,e,n){if(this.effectComposer.setSize(t,e,n),this._rt){let i=this.renderer.getPixelRatio();this._rt.setSize(t*i,e*i)}}dispose(){var t,e;(t=this.uvEffectPass)==null||t.dispose(),(e=this.effectPass)==null||e.dispose(),this.effectComposer.dispose()}},FW=new br,Hze=class extends aK{constructor(t){super(t),this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new be,this.pipeline=new Gze(this),this.overrideTransmission=t==null?void 0:t.overrideTransmission,this.autoClear=!1;let e=this.setPixelRatio.bind(this),n=this.setSize.bind(this),i=this.getContext();if(i&&"drawingBufferColorSpace"in i)try{i.drawingBufferColorSpace="display-p3"}catch(r){console.warn(r)}this.setPixelRatio=r=>{this._pixelRatio=r,e(r)},this.setSize=(r,s,o=!0)=>{var a,l,c;(this.viewportWidth!==r||this.viewportHeight!==s)&&(this.viewportWidth=r,this.viewportHeight=s,n(r,s,o),(a=this.normalRenderTarget)==null||a.setSize(r*this._pixelRatio,s*this._pixelRatio),(l=this.transmissionRenderTarget)==null||l.setSize(r*this._pixelRatio/2,s*this._pixelRatio/2),(c=this.transmissionDepthTarget)==null||c.setSize(r*this._pixelRatio/2,s*this._pixelRatio/2),this.pipeline.resize(r,s,o))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createTransmissionRenderTarget(){this.transmissionRenderTarget===void 0&&(this.transmissionRenderTarget=new er(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{generateMipmaps:!0,minFilter:Xg,magFilter:En,wrapS:ro,wrapT:ro,depthBuffer:!1}),this.transmissionDepthTarget=new er(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:oi,magFilter:oi,depthBuffer:!1}))}createNormalRenderTarget(){this.normalRenderTarget===void 0&&(this.normalRenderTarget=new er(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:oi,magFilter:oi,type:ph,depthTexture:new zO(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(t,e){this.normalRenderTarget&&(this.setClearColor(0),e.layers.enable(8),e.layers.disable(0),e.layers.disable(3),this.setRenderTarget(this.normalRenderTarget),this.clear(),e instanceof Gs?rD.uniforms.depthContrast.value=(e.far-e.near)/1e4:rD.uniforms.depthContrast.value=1,t.overrideMaterial=rD,this.render(t,e),this.setClearColor(t.bgColor,t.bgColor.a),this.setRenderTarget(null),t.overrideMaterial=t.wireframeState?WI:null,e.layers.enable(0),e.layers.enable(3))}renderSplineScene(t,e,n,i,r){this.setClearColor(t.bgColor,t.bgColor.a),n.penumbraSize.forEach((o,a)=>{ti.penumbraSize.value[a]=o}),ti.pixelRatioNode.value=this.getPixelRatio(),this.resolution.x!==0&&this.resolution.y!==0?ti.resolution.value.set(this.resolution.x,this.resolution.y):ti.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),this.overrideNormal!==void 0?(ti.normalRenderTarget.value=this.overrideNormal,ti.normalRenderTargetDepth.value=FW):t.needsNormal()&&(this.createNormalRenderTarget(),ti.normalRenderTarget.value=this.normalRenderTarget.texture,ti.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(t,e));let s=!1;if(this.overrideTransmission!==void 0)ti.transmissionRenderTarget.value=this.overrideTransmission,ti.transmissionRenderTargetDepth.value=FW,this.pipeline.setTransmissionPassEnabled(!1);else{let o=t.needsTransmission();o&&(this.transmissionRenderTarget===void 0&&(s=!0),this.createTransmissionRenderTarget(),ti.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,ti.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(o)}e.layers.enable(3),e.layers.enable(8),this.pipeline.sceneHelpers=i,this.pipeline.sceneHelpersOnTop=r,this.pipeline.scene=t,this.pipeline.camera=e,s&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==t.postprocessing&&this.pipeline.updatePostprocessing(t.postprocessing),this.clearAlphaOverride!==void 0&&this.setClearAlpha(this.clearAlphaOverride),t.overrideMaterial=t.wireframeState?WI:null,this.pipeline.render()}_currentDispose(){var t,e,n,i,r;this._superDispose(),this.pipeline.dispose(),(t=this.transmissionRenderTarget)==null||t.dispose(),(e=this.transmissionDepthTarget)==null||e.dispose(),(n=this.normalRenderTarget)==null||n.dispose(),(r=(i=this.normalRenderTarget)==null?void 0:i.depthTexture)==null||r.dispose()}},Vze=class{get sharedAssets(){return this.shared}constructor(t,e={}){this.shared=new UE(t.shared,e),this.scene=new Kl(t.scene,this.sharedAssets),this.scene.switchActiveCamera(this.scene.activeCamera)}reset(t,e){this.scene.clearScene(),this.sharedAssets.reset(t.shared),this.scene.resetAfterClear(t.scene,this.sharedAssets)}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity(t=>{t instanceof fa&&t.markGeometryAsReachable(this.shared)}),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},jze=class{constructor({x:t=10,y:e=10}){this._startTime=0;let n=document.getElementById("spe-perfs");n?this.element=n:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left=`${t}px`,this.element.style.top=`${e}px`}dispose(){var t;(t=this.element.parentElement)==null||t.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let t=performance.now()-this._startTime;this.element.innerHTML=t.toFixed(3)+" ms"}};function Wze(t){let e;if(t.index)for(let n=0;n<t.index.array.length;n+=3)e=t.index.array[n],t.index.array[n]=t.index.array[n+2],t.index.array[n+2]=e}function Yy(t){return t instanceof qx?"SubdivObject":t.geometry.type==="NonParametricGeometry"?"NonParametric":"Mesh"}function Xze(t,e){let n={};return t.traverseEntity(i=>{var l;if(!i.visible||!(i instanceof Vs)||i.type!=="Mesh"||Array.isArray(i.material)||i.states&&Object.keys(i.states).length)return;let r=i.parent;for(;r;){if(r instanceof Vs&&i.states&&Object.keys(i.states).length)return;r=r.parent}let s=i.material.uuid,o=e.shared.materials[s];if(o){if(!wo.isMergable(o))return}else{let c=(l=e.scene.objects.get(i.uuid))==null?void 0:l.data;if(c&&"material"in c&&typeof c.material!="string"){if(!wo.isMergable(c.material))return;s=wo.getHash(c.material)}}n[s]||(n[s]={});let a=n[s][Yy(i)];if(a){if(a.push(i),i.cloner)for(let c of i.cloner.children)a.push(c)}else if(n[s][Yy(i)]=[i],i.cloner)for(let c of i.cloner.children)n[s][Yy(i)].push(c)}),n}function Yze(t){let e=0;return Object.values(t).forEach(n=>{Object.values(n).forEach(i=>{let r=i.length;r>e&&(e=r)})}),e}function qze(t,e){let n=Xze(e,t),i=Yze(n),r=new Array(i),s=0,o=new Array(i),a=0,l=new Array(i),c=0,h=new Array(i),u=0;for(let[d,f]of Object.entries(n))for(let p of Object.values(f)){if(a=0,c=0,p.forEach(g=>{g instanceof Vs&&(o[a++]=g.geometry.clone(),l[c++]=g)}),c<2)continue;for(let g=0;g<c;g++)l[g].updateWorldMatrix(!0,!1),o[g].applyMatrix4(l[g].matrixWorld),l[g].matrixWorld.determinant()<0&&Wze(o[g]);let v=Qm(o.slice(0,a),!1);if(v){let g;switch(d){case"SubdivObject":{console.warn("Turning subdiv object into mesh"),g=new uo(v,l[0].material);break}default:{g=new uo(v,l[0].material);break}}g.castShadow=l[0].castShadow,g.receiveShadow=l[0].receiveShadow,e.add(g);let m=y=>{u=0;for(let w of y)w.children&&m(w.children),w instanceof Vs&&(Array.isArray(w.material)||n[w.material.uuid]&&n[w.material.uuid][Yy(w)]&&n[w.material.uuid][Yy(w)].length>1||(h[u++]=w));for(let w=0;w<u;w++)e.attach(h[w])};for(let y=0;y<c;y++){let w=l[y];m(w.children),r[s++]=w}}}for(let d=0;d<s;d++)r[d].removeFromParent()}var Qze=B1(Qye(),1),Kze=new be;function Jze(t){let e="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";t.endsWith(".spline")?console.warn(e+" The .spline files are only meant to be used by the Editor."):t.endsWith(".splinecode")||console.warn(e)}var Zze=class{constructor(t,{renderOnDemand:e=!0}={}){this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._lastTime=performance.now(),this.time=performance.now(),this.dt=0,this._skipRender=!1,this.renderOnDemand=!0,this.disposed=!1,this.requestRender=()=>{this._skipRender=!1},this.render=n=>{var i,r,s;!this._renderer||(this._rafId=requestAnimationFrame(this.render),this.time=n,this.dt=this.time-this._lastTime,this._lastTime=this.time,(i=this._perfs)==null||i.start(),!(this.renderOnDemand&&this._skipRender)&&(this._skipRender=((r=this._controls)==null?void 0:r.update(this.dt))??!0,this._eventManager&&(this._eventManager.isEnable||this._eventManager.activate(),this._eventManager.handlers.Follow.onAnimationFrameDamping(),this._eventManager.handlers.LookAt.onAnimationFrameDamping(),this._eventManager.handlers.DragDrop.onAnimationFrameDamping(),(this._eventManager.handlers.Start.hasVideoAction||this._eventManager.handlers.Basic.hasVideoAction||this._eventManager.handlers.Conditional.hasVideoAction)&&(this._skipRender=!1)),this._scene&&this._camera&&(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.renderSplineScene(this._scene,this._camera,this._sharedAssetsManager)),(s=this._perfs)==null||s.end()))},this._resize=dF(()=>{var n;!this._renderer||(this._viewportMode===1&&this._frameView&&(this._frameView.frameSize=Kze.set(this._viewportWidth,this._viewportHeight)),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._camera&&((n=this._frameView)==null||n.updateCamera(),this._camera.cameraType==="PerspectiveCamera"&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()),this.requestRender())},10),this.canvas=t,this.renderOnDemand=e,window.location.search.includes("perfs")&&(this._perfs=new jze({x:10,y:10})),WLe(t)}async load(t,e){Jze(t),this.disposed=!1;let n=await(await fetch(t,e)).arrayBuffer();await this.start(n)}async start(t,{interactive:e=!0}={}){var r;if(this.disposed)return;let n=await ake(t);this._data=n,n.version&&(0,Qze.default)(n.version,"0.9.314")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),await Promise.all([D6(n)&&ABe(),OOe(n)&&_Be(),n.scene.environment.usePhysics&&cLe(),M6(n)&&SOe()].filter(Boolean)),this._eventManager&&this._eventManager.deactivate(),this._controls&&this._controls.dispose(),(r=this._scene)==null||r.dispose();let i=new Vze(n);if(this._scene=i.scene,this._sharedAssetsManager=i.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let s=performance.now();qze(n,i.scene);let o=performance.now();console.log("Merged geometries in ",o-s," ms")}if(D6(n)&&this._scene.traverse(s=>{Xc(s)&&s.recomputeBoolean()}),this._sharedAssetsManager.setRequestRender(()=>{var s;this.requestRender(),(s=this._scene)==null||s.traverse(o=>{o instanceof cf&&o.pendingMediaLoad&&o.update()})}),M6(n)&&NUe(n)){let s=Object.keys(n.shared.fonts).map(o=>this._sharedAssetsManager.getFont(o)).map(o=>o.loadingPromise);await Promise.all(s)}if(this._scene.rewriteEventsBeforeGoToPlayMode(),z$(n.scene,this._scene,this._sharedAssetsManager),this._renderer||(this._renderer=new Hze({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.addEventListener("smaaloaded",this.requestRender),this._renderer.shadowMap.enabled=!0,this._renderer.shadowMap.type=n.scene.environment.ambientLight.softShadows?BO:GQ,wFe(n.scene.environment.ambientLight.softShadowQuality)),this._frameView)this._frameView.setCamera(this._camera);else{let s=Object.values(n.frames)[0];s.preset==="fullscreen"?(this._viewportMode=1,this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=s.size[0],this._viewportHeight=s.size[1],this.canvas.style.width=`${this._viewportWidth}px`,this.canvas.style.height=`${this._viewportHeight}px`),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new cke(this._renderer,this._camera,new be(this._viewportWidth,this._viewportHeight),new be(window.innerWidth,window.innerHeight))}if(e&&(this._scene.updateMatrixWorld(!0),this._controls=new UUe(n,this._scene,this._renderer,this.requestRender,this._sharedAssetsManager,!0),this._eventManager=new lke(this._renderer,this._scene,this._camera,n.scene.publish,this._sharedAssetsManager,this.requestRender,this._controls,!0),this._controls.init(this._eventManager)),this._resize(),!this._resizeObserver&&this.canvas.parentElement){let s=!0;this._resizeObserver=new ResizeObserver(()=>{if(s){s=!1;return}this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._resize()}),this._resizeObserver.observe(this.canvas.parentElement)}this._rafId===void 0?this.render(performance.now()):this.requestRender()}findObjectById(t){var n;let e=(n=this._scene)==null?void 0:n.getObjectByProperty("uuid",t);return this._createProxyObject(e)}findObjectByName(t){var n;let e=(n=this._scene)==null?void 0:n.getObjectByName(t);return this._createProxyObject(e)}getSplineEvents(){var t;return((t=this._eventManager)==null?void 0:t.handlers.Spline).splineEvents}emitEvent(t,e){var n;(n=this.findObjectById(e)||this.findObjectByName(e))==null||n.emitEvent(t)}emitEventReverse(t,e){var n;(n=this.findObjectById(e)||this.findObjectByName(e))==null||n.emitEventReverse(t)}addEventListener(t,e){this.canvas.addEventListener(t,e)}removeEventListener(t,e){this.canvas.removeEventListener(t,e)}setZoom(t){var e,n;((e=this._controls)==null?void 0:e.orbitControls)instanceof q$&&((n=this._controls)==null||n.orbitControls.zoomOut(t))}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(t,e){this._viewportWidth=t,this._viewportHeight=e,this._viewportMode=2,this._resize()}setBackgroundColor(t){var o;let{r:e,g:n,b:i,a:r}={r:0,g:0,b:0,a:1},s=new zs(e,n,i,r);try{s.setStyle(t)}catch{console.error("This is not a valid css color",t)}(o=this._scene)==null||o.setBackgroundColor(s),this.requestRender()}dispose(){var t,e,n,i,r,s;this.disposed=!0,(t=this._eventManager)==null||t.deactivate(),(e=this._scene)==null||e.dispose(),(n=this._sharedAssetsManager)==null||n.dispose(),this._rafId&&cancelAnimationFrame(this._rafId),this._proxyObjectCache.forEach(o=>{a5.unsubscribe(o)}),(i=this._renderer)==null||i.dispose(),(r=this._sharedAssetsManager)==null||r.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),(s=this._controls)==null||s.dispose(),XLe(this.canvas)}get data(){return this._data}_createProxyObject(t){if(t==null)return;if(this._proxyObjectCache.has(t.uuid))return this._proxyObjectCache.get(t.uuid);let e={name:t.name,uuid:t.uuid,visible:t.visible,intensity:t.intensity,position:t.position,rotation:t.rotation,scale:t.scale,emitEvent(i){t.dispatchEvent({type:"userEvent",eventName:i})},emitEventReverse(i){t.dispatchEvent({type:"userEvent",eventName:i,reverse:!0})}},n=a5(e,(i,r)=>{var s;typeof t[i]!="object"&&((s=Object.getOwnPropertyDescriptor(t,i))!=null&&s.writable)&&(t[i]=r),this.requestRender(),t.updateMatrix()});return this._proxyObjectCache.set(t.uuid,n),n}},oS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},r3={},$ze={get exports(){return r3},set exports(t){r3=t}},Z0={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NW;function e4e(){if(NW)return Z0;NW=1;var t=du,e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,c){var h,u={},d=null,f=null;c!==void 0&&(d=""+c),l.key!==void 0&&(d=""+l.key),l.ref!==void 0&&(f=l.ref);for(h in l)i.call(l,h)&&!s.hasOwnProperty(h)&&(u[h]=l[h]);if(a&&a.defaultProps)for(h in l=a.defaultProps,l)u[h]===void 0&&(u[h]=l[h]);return{$$typeof:e,type:a,key:d,ref:f,props:u,_owner:r.current}}return Z0.Fragment=n,Z0.jsx=o,Z0.jsxs=o,Z0}(function(t){t.exports=e4e()})($ze);const s3=r3.jsx;var t4e="Expected a function",UW=0/0,n4e="[object Symbol]",i4e=/^\s+|\s+$/g,r4e=/^[-+]0x[0-9a-f]+$/i,s4e=/^0b[01]+$/i,o4e=/^0o[0-7]+$/i,a4e=parseInt,l4e=typeof oS=="object"&&oS&&oS.Object===Object&&oS,c4e=typeof self=="object"&&self&&self.Object===Object&&self,u4e=l4e||c4e||Function("return this")(),h4e=Object.prototype,d4e=h4e.toString,f4e=Math.max,p4e=Math.min,CD=function(){return u4e.Date.now()};function m4e(t,e,n){var i,r,s,o,a,l,c=0,h=!1,u=!1,d=!0;if(typeof t!="function")throw new TypeError(t4e);e=kW(e)||0,o3(n)&&(h=!!n.leading,u="maxWait"in n,s=u?f4e(kW(n.maxWait)||0,e):s,d="trailing"in n?!!n.trailing:d);function f(S){var T=i,M=r;return i=r=void 0,c=S,o=t.apply(M,T),o}function p(S){return c=S,a=setTimeout(m,e),h?f(S):o}function v(S){var T=S-l,M=S-c,E=e-T;return u?p4e(E,s-M):E}function g(S){var T=S-l,M=S-c;return l===void 0||T>=e||T<0||u&&M>=s}function m(){var S=CD();if(g(S))return y(S);a=setTimeout(m,v(S))}function y(S){return a=void 0,d&&i?f(S):(i=r=void 0,o)}function w(){a!==void 0&&clearTimeout(a),c=0,i=l=r=a=void 0}function b(){return a===void 0?o:y(CD())}function A(){var S=CD(),T=g(S);if(i=arguments,r=this,l=S,T){if(a===void 0)return p(l);if(u)return a=setTimeout(m,e),f(l)}return a===void 0&&(a=setTimeout(m,e)),o}return A.cancel=w,A.flush=b,A}function o3(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function g4e(t){return!!t&&typeof t=="object"}function v4e(t){return typeof t=="symbol"||g4e(t)&&d4e.call(t)==n4e}function kW(t){if(typeof t=="number")return t;if(v4e(t))return UW;if(o3(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=o3(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(i4e,"");var n=s4e.test(t);return n||o4e.test(t)?a4e(t.slice(2),n?2:8):r4e.test(t)?UW:+t}var y4e=m4e;function x4e(t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}const w4e=[],_4e={width:"100%",height:"100%"},b4e=ge.forwardRef(function({className:t,children:e,debounceTime:n=300,ignoreDimensions:i=w4e,parentSizeStyles:r,enableDebounceLeadingCall:s=!0,resizeObserverPolyfill:o,...a},l){const c=ge.useRef(null),h=ge.useRef(0),[u,d]=ge.useState({width:0,height:0,top:0,left:0}),f=ge.useMemo(()=>{const p=Array.isArray(i)?i:[i];return y4e(v=>{d(g=>Object.keys(g).filter(m=>g[m]!==v[m]).every(m=>p.includes(m))?g:v)},n,{leading:s})},[n,s,i]);return ge.useEffect(()=>{const p=o||window.ResizeObserver,v=new p(g=>{g.forEach(m=>{const{left:y,top:w,width:b,height:A}=(m==null?void 0:m.contentRect)??{};h.current=window.requestAnimationFrame(()=>{f({width:b,height:A,top:w,left:y})})})});return c.current&&v.observe(c.current),()=>{window.cancelAnimationFrame(h.current),v.disconnect(),f.cancel()}},[f,o]),s3("div",{style:{..._4e,...r},ref:x4e([l,c]),className:t,...a,children:e({...u,ref:c.current,resize:f})})}),zW=ge.forwardRef(({scene:t,style:e,onMouseDown:n,onMouseUp:i,onMouseHover:r,onKeyDown:s,onKeyUp:o,onStart:a,onLookAt:l,onFollow:c,onWheel:h,onLoad:u,renderOnDemand:d=!0,...f},p)=>{const v=ge.useRef(null),[g,m]=ge.useState(!0);return ge.useEffect(()=>{m(!0);let y;const w=[{name:"mouseDown",cb:n},{name:"mouseUp",cb:i},{name:"mouseHover",cb:r},{name:"keyDown",cb:s},{name:"keyUp",cb:o},{name:"start",cb:a},{name:"lookAt",cb:l},{name:"follow",cb:c},{name:"scroll",cb:h}];if(v.current){y=new Zze(v.current,{renderOnDemand:d});async function b(){await y.load(t);for(let A of w)A.cb&&y.addEventListener(A.name,A.cb);m(!1),u==null||u(y)}b()}return()=>{for(let b of w)b.cb&&y.removeEventListener(b.name,b.cb);y.dispose()}},[t]),s3(b4e,{ref:p,parentSizeStyles:e,debounceTime:50,...f,children:()=>s3("canvas",{ref:v,style:{display:g?"none":"block"}})})});var $$={exports:{}},In={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ar=typeof Symbol=="function"&&Symbol.for,oN=Ar?Symbol.for("react.element"):60103,aN=Ar?Symbol.for("react.portal"):60106,WE=Ar?Symbol.for("react.fragment"):60107,XE=Ar?Symbol.for("react.strict_mode"):60108,YE=Ar?Symbol.for("react.profiler"):60114,qE=Ar?Symbol.for("react.provider"):60109,QE=Ar?Symbol.for("react.context"):60110,lN=Ar?Symbol.for("react.async_mode"):60111,KE=Ar?Symbol.for("react.concurrent_mode"):60111,JE=Ar?Symbol.for("react.forward_ref"):60112,ZE=Ar?Symbol.for("react.suspense"):60113,S4e=Ar?Symbol.for("react.suspense_list"):60120,$E=Ar?Symbol.for("react.memo"):60115,eC=Ar?Symbol.for("react.lazy"):60116,A4e=Ar?Symbol.for("react.block"):60121,M4e=Ar?Symbol.for("react.fundamental"):60117,E4e=Ar?Symbol.for("react.responder"):60118,C4e=Ar?Symbol.for("react.scope"):60119;function Co(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case oN:switch(t=t.type,t){case lN:case KE:case WE:case YE:case XE:case ZE:return t;default:switch(t=t&&t.$$typeof,t){case QE:case JE:case eC:case $E:case qE:return t;default:return e}}case aN:return e}}}function eee(t){return Co(t)===KE}In.AsyncMode=lN;In.ConcurrentMode=KE;In.ContextConsumer=QE;In.ContextProvider=qE;In.Element=oN;In.ForwardRef=JE;In.Fragment=WE;In.Lazy=eC;In.Memo=$E;In.Portal=aN;In.Profiler=YE;In.StrictMode=XE;In.Suspense=ZE;In.isAsyncMode=function(t){return eee(t)||Co(t)===lN};In.isConcurrentMode=eee;In.isContextConsumer=function(t){return Co(t)===QE};In.isContextProvider=function(t){return Co(t)===qE};In.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===oN};In.isForwardRef=function(t){return Co(t)===JE};In.isFragment=function(t){return Co(t)===WE};In.isLazy=function(t){return Co(t)===eC};In.isMemo=function(t){return Co(t)===$E};In.isPortal=function(t){return Co(t)===aN};In.isProfiler=function(t){return Co(t)===YE};In.isStrictMode=function(t){return Co(t)===XE};In.isSuspense=function(t){return Co(t)===ZE};In.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===WE||t===KE||t===YE||t===XE||t===ZE||t===S4e||typeof t=="object"&&t!==null&&(t.$$typeof===eC||t.$$typeof===$E||t.$$typeof===qE||t.$$typeof===QE||t.$$typeof===JE||t.$$typeof===M4e||t.$$typeof===E4e||t.$$typeof===C4e||t.$$typeof===A4e)};In.typeOf=Co;$$.exports=In;var cN=$$.exports;function T4e(t){function e(z,X,q,re,G){for(var K=0,oe=0,ve=0,$=0,se,ne,ie=0,me=0,xe,Ae=xe=se=0,_e=0,Ee=0,Re=0,Ue=0,Ne=q.length,U=Ne-1,L,te="",we="",Te="",Ie="",Qe;_e<Ne;){if(ne=q.charCodeAt(_e),_e===U&&oe+$+ve+K!==0&&(oe!==0&&(ne=oe===47?10:47),$=ve=K=0,Ne++,U++),oe+$+ve+K===0){if(_e===U&&(0<Ee&&(te=te.replace(d,"")),0<te.trim().length)){switch(ne){case 32:case 9:case 59:case 13:case 10:break;default:te+=q.charAt(_e)}ne=59}switch(ne){case 123:for(te=te.trim(),se=te.charCodeAt(0),xe=1,Ue=++_e;_e<Ne;){switch(ne=q.charCodeAt(_e)){case 123:xe++;break;case 125:xe--;break;case 47:switch(ne=q.charCodeAt(_e+1)){case 42:case 47:e:{for(Ae=_e+1;Ae<U;++Ae)switch(q.charCodeAt(Ae)){case 47:if(ne===42&&q.charCodeAt(Ae-1)===42&&_e+2!==Ae){_e=Ae+1;break e}break;case 10:if(ne===47){_e=Ae+1;break e}}_e=Ae}}break;case 91:ne++;case 40:ne++;case 34:case 39:for(;_e++<U&&q.charCodeAt(_e)!==ne;);}if(xe===0)break;_e++}switch(xe=q.substring(Ue,_e),se===0&&(se=(te=te.replace(u,"").trim()).charCodeAt(0)),se){case 64:switch(0<Ee&&(te=te.replace(d,"")),ne=te.charCodeAt(1),ne){case 100:case 109:case 115:case 45:Ee=X;break;default:Ee=Z}if(xe=e(X,Ee,xe,ne,G+1),Ue=xe.length,0<O&&(Ee=n(Z,te,Re),Qe=a(3,xe,Ee,X,B,F,Ue,ne,G,re),te=Ee.join(""),Qe!==void 0&&(Ue=(xe=Qe.trim()).length)===0&&(ne=0,xe="")),0<Ue)switch(ne){case 115:te=te.replace(S,o);case 100:case 109:case 45:xe=te+"{"+xe+"}";break;case 107:te=te.replace(y,"$1 $2"),xe=te+"{"+xe+"}",xe=j===1||j===2&&s("@"+xe,3)?"@-webkit-"+xe+"@"+xe:"@"+xe;break;default:xe=te+xe,re===112&&(xe=(we+=xe,""))}else xe="";break;default:xe=e(X,n(X,te,Re),xe,re,G+1)}Te+=xe,xe=Re=Ee=Ae=se=0,te="",ne=q.charCodeAt(++_e);break;case 125:case 59:if(te=(0<Ee?te.replace(d,""):te).trim(),1<(Ue=te.length))switch(Ae===0&&(se=te.charCodeAt(0),se===45||96<se&&123>se)&&(Ue=(te=te.replace(" ",":")).length),0<O&&(Qe=a(1,te,X,z,B,F,we.length,re,G,re))!==void 0&&(Ue=(te=Qe.trim()).length)===0&&(te="\0\0"),se=te.charCodeAt(0),ne=te.charCodeAt(1),se){case 0:break;case 64:if(ne===105||ne===99){Ie+=te+q.charAt(_e);break}default:te.charCodeAt(Ue-1)!==58&&(we+=r(te,se,ne,te.charCodeAt(2)))}Re=Ee=Ae=se=0,te="",ne=q.charCodeAt(++_e)}}switch(ne){case 13:case 10:oe===47?oe=0:1+se===0&&re!==107&&0<te.length&&(Ee=1,te+="\0"),0<O*H&&a(0,te,X,z,B,F,we.length,re,G,re),F=1,B++;break;case 59:case 125:if(oe+$+ve+K===0){F++;break}default:switch(F++,L=q.charAt(_e),ne){case 9:case 32:if($+K+oe===0)switch(ie){case 44:case 58:case 9:case 32:L="";break;default:ne!==32&&(L=" ")}break;case 0:L="\\0";break;case 12:L="\\f";break;case 11:L="\\v";break;case 38:$+oe+K===0&&(Ee=Re=1,L="\f"+L);break;case 108:if($+oe+K+k===0&&0<Ae)switch(_e-Ae){case 2:ie===112&&q.charCodeAt(_e-3)===58&&(k=ie);case 8:me===111&&(k=me)}break;case 58:$+oe+K===0&&(Ae=_e);break;case 44:oe+ve+$+K===0&&(Ee=1,L+="\r");break;case 34:case 39:oe===0&&($=$===ne?0:$===0?ne:$);break;case 91:$+oe+ve===0&&K++;break;case 93:$+oe+ve===0&&K--;break;case 41:$+oe+K===0&&ve--;break;case 40:if($+oe+K===0){if(se===0)switch(2*ie+3*me){case 533:break;default:se=1}ve++}break;case 64:oe+ve+$+K+Ae+xe===0&&(xe=1);break;case 42:case 47:if(!(0<$+K+ve))switch(oe){case 0:switch(2*ne+3*q.charCodeAt(_e+1)){case 235:oe=47;break;case 220:Ue=_e,oe=42}break;case 42:ne===47&&ie===42&&Ue+2!==_e&&(q.charCodeAt(Ue+2)===33&&(we+=q.substring(Ue,_e+1)),L="",oe=0)}}oe===0&&(te+=L)}me=ie,ie=ne,_e++}if(Ue=we.length,0<Ue){if(Ee=X,0<O&&(Qe=a(2,we,Ee,z,B,F,Ue,re,G,re),Qe!==void 0&&(we=Qe).length===0))return Ie+we+Te;if(we=Ee.join(",")+"{"+we+"}",j*k!==0){switch(j!==2||s(we,2)||(k=0),k){case 111:we=we.replace(b,":-moz-$1")+we;break;case 112:we=we.replace(w,"::-webkit-input-$1")+we.replace(w,"::-moz-$1")+we.replace(w,":-ms-input-$1")+we}k=0}}return Ie+we+Te}function n(z,X,q){var re=X.trim().split(g);X=re;var G=re.length,K=z.length;switch(K){case 0:case 1:var oe=0;for(z=K===0?"":z[0]+" ";oe<G;++oe)X[oe]=i(z,X[oe],q).trim();break;default:var ve=oe=0;for(X=[];oe<G;++oe)for(var $=0;$<K;++$)X[ve++]=i(z[$]+" ",re[oe],q).trim()}return X}function i(z,X,q){var re=X.charCodeAt(0);switch(33>re&&(re=(X=X.trim()).charCodeAt(0)),re){case 38:return X.replace(m,"$1"+z.trim());case 58:return z.trim()+X.replace(m,"$1"+z.trim());default:if(0<1*q&&0<X.indexOf("\f"))return X.replace(m,(z.charCodeAt(0)===58?"":"$1")+z.trim())}return z+X}function r(z,X,q,re){var G=z+";",K=2*X+3*q+4*re;if(K===944){z=G.indexOf(":",9)+1;var oe=G.substring(z,G.length-1).trim();return oe=G.substring(0,z).trim()+oe+";",j===1||j===2&&s(oe,1)?"-webkit-"+oe+oe:oe}if(j===0||j===2&&!s(G,1))return G;switch(K){case 1015:return G.charCodeAt(10)===97?"-webkit-"+G+G:G;case 951:return G.charCodeAt(3)===116?"-webkit-"+G+G:G;case 963:return G.charCodeAt(5)===110?"-webkit-"+G+G:G;case 1009:if(G.charCodeAt(4)!==100)break;case 969:case 942:return"-webkit-"+G+G;case 978:return"-webkit-"+G+"-moz-"+G+G;case 1019:case 983:return"-webkit-"+G+"-moz-"+G+"-ms-"+G+G;case 883:if(G.charCodeAt(8)===45)return"-webkit-"+G+G;if(0<G.indexOf("image-set(",11))return G.replace(R,"$1-webkit-$2")+G;break;case 932:if(G.charCodeAt(4)===45)switch(G.charCodeAt(5)){case 103:return"-webkit-box-"+G.replace("-grow","")+"-webkit-"+G+"-ms-"+G.replace("grow","positive")+G;case 115:return"-webkit-"+G+"-ms-"+G.replace("shrink","negative")+G;case 98:return"-webkit-"+G+"-ms-"+G.replace("basis","preferred-size")+G}return"-webkit-"+G+"-ms-"+G+G;case 964:return"-webkit-"+G+"-ms-flex-"+G+G;case 1023:if(G.charCodeAt(8)!==99)break;return oe=G.substring(G.indexOf(":",15)).replace("flex-","").replace("space-between","justify"),"-webkit-box-pack"+oe+"-webkit-"+G+"-ms-flex-pack"+oe+G;case 1005:return p.test(G)?G.replace(f,":-webkit-")+G.replace(f,":-moz-")+G:G;case 1e3:switch(oe=G.substring(13).trim(),X=oe.indexOf("-")+1,oe.charCodeAt(0)+oe.charCodeAt(X)){case 226:oe=G.replace(A,"tb");break;case 232:oe=G.replace(A,"tb-rl");break;case 220:oe=G.replace(A,"lr");break;default:return G}return"-webkit-"+G+"-ms-"+oe+G;case 1017:if(G.indexOf("sticky",9)===-1)break;case 975:switch(X=(G=z).length-10,oe=(G.charCodeAt(X)===33?G.substring(0,X):G).substring(z.indexOf(":",7)+1).trim(),K=oe.charCodeAt(0)+(oe.charCodeAt(7)|0)){case 203:if(111>oe.charCodeAt(8))break;case 115:G=G.replace(oe,"-webkit-"+oe)+";"+G;break;case 207:case 102:G=G.replace(oe,"-webkit-"+(102<K?"inline-":"")+"box")+";"+G.replace(oe,"-webkit-"+oe)+";"+G.replace(oe,"-ms-"+oe+"box")+";"+G}return G+";";case 938:if(G.charCodeAt(5)===45)switch(G.charCodeAt(6)){case 105:return oe=G.replace("-items",""),"-webkit-"+G+"-webkit-box-"+oe+"-ms-flex-"+oe+G;case 115:return"-webkit-"+G+"-ms-flex-item-"+G.replace(M,"")+G;default:return"-webkit-"+G+"-ms-flex-line-pack"+G.replace("align-content","").replace(M,"")+G}break;case 973:case 989:if(G.charCodeAt(3)!==45||G.charCodeAt(4)===122)break;case 931:case 953:if(P.test(z)===!0)return(oe=z.substring(z.indexOf(":")+1)).charCodeAt(0)===115?r(z.replace("stretch","fill-available"),X,q,re).replace(":fill-available",":stretch"):G.replace(oe,"-webkit-"+oe)+G.replace(oe,"-moz-"+oe.replace("fill-",""))+G;break;case 962:if(G="-webkit-"+G+(G.charCodeAt(5)===102?"-ms-"+G:"")+G,q+re===211&&G.charCodeAt(13)===105&&0<G.indexOf("transform",10))return G.substring(0,G.indexOf(";",27)+1).replace(v,"$1-webkit-$2")+G}return G}function s(z,X){var q=z.indexOf(X===1?":":"{"),re=z.substring(0,X!==3?q:10);return q=z.substring(q+1,z.length-1),W(X!==2?re:re.replace(E,"$1"),q,X)}function o(z,X){var q=r(X,X.charCodeAt(0),X.charCodeAt(1),X.charCodeAt(2));return q!==X+";"?q.replace(T," or ($1)").substring(4):"("+X+")"}function a(z,X,q,re,G,K,oe,ve,$,se){for(var ne=0,ie=X,me;ne<O;++ne)switch(me=ee[ne].call(h,z,ie,q,re,G,K,oe,ve,$,se)){case void 0:case!1:case!0:case null:break;default:ie=me}if(ie!==X)return ie}function l(z){switch(z){case void 0:case null:O=ee.length=0;break;default:if(typeof z=="function")ee[O++]=z;else if(typeof z=="object")for(var X=0,q=z.length;X<q;++X)l(z[X]);else H=!!z|0}return l}function c(z){return z=z.prefix,z!==void 0&&(W=null,z?typeof z!="function"?j=1:(j=2,W=z):j=0),c}function h(z,X){var q=z;if(33>q.charCodeAt(0)&&(q=q.trim()),Y=q,q=[Y],0<O){var re=a(-1,X,q,q,B,F,0,0,0,0);re!==void 0&&typeof re=="string"&&(X=re)}var G=e(Z,q,X,0,0);return 0<O&&(re=a(-2,G,q,q,B,F,G.length,0,0,0),re!==void 0&&(G=re)),Y="",k=0,F=B=1,G}var u=/^\0+/g,d=/[\0\r\f]/g,f=/: */g,p=/zoo|gra/,v=/([,: ])(transform)/g,g=/,\r+?/g,m=/([\t\r\n ])*\f?&/g,y=/@(k\w+)\s*(\S*)\s*/,w=/::(place)/g,b=/:(read-only)/g,A=/[svh]\w+-[tblr]{2}/,S=/\(\s*(.*)\s*\)/g,T=/([\s\S]*?);/g,M=/-self|flex-/g,E=/[^]*?(:[rp][el]a[\w-]+)[^]*/,P=/stretch|:\s*\w+\-(?:conte|avail)/,R=/([^-])(image-set\()/,F=1,B=1,k=0,j=1,Z=[],ee=[],O=0,W=null,H=0,Y="";return h.use=l,h.set=c,t!==void 0&&c(t),h}var P4e={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function D4e(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var R4e=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,GW=D4e(function(t){return R4e.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),uN=cN,L4e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},I4e={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},B4e={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},tee={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},hN={};hN[uN.ForwardRef]=B4e;hN[uN.Memo]=tee;function HW(t){return uN.isMemo(t)?tee:hN[t.$$typeof]||L4e}var O4e=Object.defineProperty,F4e=Object.getOwnPropertyNames,VW=Object.getOwnPropertySymbols,N4e=Object.getOwnPropertyDescriptor,U4e=Object.getPrototypeOf,jW=Object.prototype;function nee(t,e,n){if(typeof e!="string"){if(jW){var i=U4e(e);i&&i!==jW&&nee(t,i,n)}var r=F4e(e);VW&&(r=r.concat(VW(e)));for(var s=HW(t),o=HW(e),a=0;a<r.length;++a){var l=r[a];if(!I4e[l]&&!(n&&n[l])&&!(o&&o[l])&&!(s&&s[l])){var c=N4e(e,l);try{O4e(t,l,c)}catch{}}}}return t}var k4e=nee;const z4e=Zx(k4e);function Yc(){return(Yc=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}var WW=function(t,e){for(var n=[t[0]],i=0,r=e.length;i<r;i+=1)n.push(e[i],t[i+1]);return n},a3=function(t){return t!==null&&typeof t=="object"&&(t.toString?t.toString():Object.prototype.toString.call(t))==="[object Object]"&&!cN.typeOf(t)},AM=Object.freeze([]),Uh=Object.freeze({});function Kx(t){return typeof t=="function"}function XW(t){return t.displayName||t.name||"Component"}function dN(t){return t&&typeof t.styledComponentId=="string"}var nv=typeof process<"u"&&process.env!==void 0&&({}.REACT_APP_SC_ATTR||{}.SC_ATTR)||"data-styled",fN=typeof window<"u"&&"HTMLElement"in window,G4e=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&process.env!==void 0&&({}.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&{}.REACT_APP_SC_DISABLE_SPEEDY!==""?{}.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&{}.REACT_APP_SC_DISABLE_SPEEDY:{}.SC_DISABLE_SPEEDY!==void 0&&{}.SC_DISABLE_SPEEDY!==""&&{}.SC_DISABLE_SPEEDY!=="false"&&{}.SC_DISABLE_SPEEDY));function X1(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];throw new Error("An error occurred. See https://git.io/JUIaE#"+t+" for more information."+(n.length>0?" Args: "+n.join(", "):""))}var H4e=function(){function t(n){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=n}var e=t.prototype;return e.indexOfGroup=function(n){for(var i=0,r=0;r<n;r++)i+=this.groupSizes[r];return i},e.insertRules=function(n,i){if(n>=this.groupSizes.length){for(var r=this.groupSizes,s=r.length,o=s;n>=o;)(o<<=1)<0&&X1(16,""+n);this.groupSizes=new Uint32Array(o),this.groupSizes.set(r),this.length=o;for(var a=s;a<o;a++)this.groupSizes[a]=0}for(var l=this.indexOfGroup(n+1),c=0,h=i.length;c<h;c++)this.tag.insertRule(l,i[c])&&(this.groupSizes[n]++,l++)},e.clearGroup=function(n){if(n<this.length){var i=this.groupSizes[n],r=this.indexOfGroup(n),s=r+i;this.groupSizes[n]=0;for(var o=r;o<s;o++)this.tag.deleteRule(r)}},e.getGroup=function(n){var i="";if(n>=this.length||this.groupSizes[n]===0)return i;for(var r=this.groupSizes[n],s=this.indexOfGroup(n),o=s+r,a=s;a<o;a++)i+=this.tag.getRule(a)+`/*!sc*/
`;return i},t}(),WS=new Map,MM=new Map,qy=1,aS=function(t){if(WS.has(t))return WS.get(t);for(;MM.has(qy);)qy++;var e=qy++;return WS.set(t,e),MM.set(e,t),e},V4e=function(t){return MM.get(t)},j4e=function(t,e){e>=qy&&(qy=e+1),WS.set(t,e),MM.set(e,t)},W4e="style["+nv+'][data-styled-version="5.3.10"]',X4e=new RegExp("^"+nv+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),Y4e=function(t,e,n){for(var i,r=n.split(","),s=0,o=r.length;s<o;s++)(i=r[s])&&t.registerName(e,i)},q4e=function(t,e){for(var n=(e.textContent||"").split(`/*!sc*/
`),i=[],r=0,s=n.length;r<s;r++){var o=n[r].trim();if(o){var a=o.match(X4e);if(a){var l=0|parseInt(a[1],10),c=a[2];l!==0&&(j4e(c,l),Y4e(t,c,a[3]),t.getTag().insertRules(l,i)),i.length=0}else i.push(o)}}},Q4e=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null},iee=function(t){var e=document.head,n=t||e,i=document.createElement("style"),r=function(a){for(var l=a.childNodes,c=l.length;c>=0;c--){var h=l[c];if(h&&h.nodeType===1&&h.hasAttribute(nv))return h}}(n),s=r!==void 0?r.nextSibling:null;i.setAttribute(nv,"active"),i.setAttribute("data-styled-version","5.3.10");var o=Q4e();return o&&i.setAttribute("nonce",o),n.insertBefore(i,s),i},K4e=function(){function t(n){var i=this.element=iee(n);i.appendChild(document.createTextNode("")),this.sheet=function(r){if(r.sheet)return r.sheet;for(var s=document.styleSheets,o=0,a=s.length;o<a;o++){var l=s[o];if(l.ownerNode===r)return l}X1(17)}(i),this.length=0}var e=t.prototype;return e.insertRule=function(n,i){try{return this.sheet.insertRule(i,n),this.length++,!0}catch{return!1}},e.deleteRule=function(n){this.sheet.deleteRule(n),this.length--},e.getRule=function(n){var i=this.sheet.cssRules[n];return i!==void 0&&typeof i.cssText=="string"?i.cssText:""},t}(),J4e=function(){function t(n){var i=this.element=iee(n);this.nodes=i.childNodes,this.length=0}var e=t.prototype;return e.insertRule=function(n,i){if(n<=this.length&&n>=0){var r=document.createTextNode(i),s=this.nodes[n];return this.element.insertBefore(r,s||null),this.length++,!0}return!1},e.deleteRule=function(n){this.element.removeChild(this.nodes[n]),this.length--},e.getRule=function(n){return n<this.length?this.nodes[n].textContent:""},t}(),Z4e=function(){function t(n){this.rules=[],this.length=0}var e=t.prototype;return e.insertRule=function(n,i){return n<=this.length&&(this.rules.splice(n,0,i),this.length++,!0)},e.deleteRule=function(n){this.rules.splice(n,1),this.length--},e.getRule=function(n){return n<this.length?this.rules[n]:""},t}(),YW=fN,$4e={isServer:!fN,useCSSOMInjection:!G4e},ree=function(){function t(n,i,r){n===void 0&&(n=Uh),i===void 0&&(i={}),this.options=Yc({},$4e,{},n),this.gs=i,this.names=new Map(r),this.server=!!n.isServer,!this.server&&fN&&YW&&(YW=!1,function(s){for(var o=document.querySelectorAll(W4e),a=0,l=o.length;a<l;a++){var c=o[a];c&&c.getAttribute(nv)!=="active"&&(q4e(s,c),c.parentNode&&c.parentNode.removeChild(c))}}(this))}t.registerId=function(n){return aS(n)};var e=t.prototype;return e.reconstructWithOptions=function(n,i){return i===void 0&&(i=!0),new t(Yc({},this.options,{},n),this.gs,i&&this.names||void 0)},e.allocateGSInstance=function(n){return this.gs[n]=(this.gs[n]||0)+1},e.getTag=function(){return this.tag||(this.tag=(r=(i=this.options).isServer,s=i.useCSSOMInjection,o=i.target,n=r?new Z4e(o):s?new K4e(o):new J4e(o),new H4e(n)));var n,i,r,s,o},e.hasNameForId=function(n,i){return this.names.has(n)&&this.names.get(n).has(i)},e.registerName=function(n,i){if(aS(n),this.names.has(n))this.names.get(n).add(i);else{var r=new Set;r.add(i),this.names.set(n,r)}},e.insertRules=function(n,i,r){this.registerName(n,i),this.getTag().insertRules(aS(n),r)},e.clearNames=function(n){this.names.has(n)&&this.names.get(n).clear()},e.clearRules=function(n){this.getTag().clearGroup(aS(n)),this.clearNames(n)},e.clearTag=function(){this.tag=void 0},e.toString=function(){return function(n){for(var i=n.getTag(),r=i.length,s="",o=0;o<r;o++){var a=V4e(o);if(a!==void 0){var l=n.names.get(a),c=i.getGroup(o);if(l&&c&&l.size){var h=nv+".g"+o+'[id="'+a+'"]',u="";l!==void 0&&l.forEach(function(d){d.length>0&&(u+=d+",")}),s+=""+c+h+'{content:"'+u+`"}/*!sc*/
`}}}return s}(this)},t}(),eGe=/(a)(d)/gi,qW=function(t){return String.fromCharCode(t+(t>25?39:97))};function l3(t){var e,n="";for(e=Math.abs(t);e>52;e=e/52|0)n=qW(e%52)+n;return(qW(e%52)+n).replace(eGe,"$1-$2")}var eg=function(t,e){for(var n=e.length;n;)t=33*t^e.charCodeAt(--n);return t},see=function(t){return eg(5381,t)};function tGe(t){for(var e=0;e<t.length;e+=1){var n=t[e];if(Kx(n)&&!dN(n))return!1}return!0}var nGe=see("5.3.10"),iGe=function(){function t(e,n,i){this.rules=e,this.staticRulesId="",this.isStatic=(i===void 0||i.isStatic)&&tGe(e),this.componentId=n,this.baseHash=eg(nGe,n),this.baseStyle=i,ree.registerId(n)}return t.prototype.generateAndInjectStyles=function(e,n,i){var r=this.componentId,s=[];if(this.baseStyle&&s.push(this.baseStyle.generateAndInjectStyles(e,n,i)),this.isStatic&&!i.hash)if(this.staticRulesId&&n.hasNameForId(r,this.staticRulesId))s.push(this.staticRulesId);else{var o=iv(this.rules,e,n,i).join(""),a=l3(eg(this.baseHash,o)>>>0);if(!n.hasNameForId(r,a)){var l=i(o,"."+a,void 0,r);n.insertRules(r,a,l)}s.push(a),this.staticRulesId=a}else{for(var c=this.rules.length,h=eg(this.baseHash,i.hash),u="",d=0;d<c;d++){var f=this.rules[d];if(typeof f=="string")u+=f;else if(f){var p=iv(f,e,n,i),v=Array.isArray(p)?p.join(""):p;h=eg(h,v+d),u+=v}}if(u){var g=l3(h>>>0);if(!n.hasNameForId(r,g)){var m=i(u,"."+g,void 0,r);n.insertRules(r,g,m)}s.push(g)}}return s.join(" ")},t}(),rGe=/^\s*\/\/.*$/gm,sGe=[":","[",".","#"];function oGe(t){var e,n,i,r,s=t===void 0?Uh:t,o=s.options,a=o===void 0?Uh:o,l=s.plugins,c=l===void 0?AM:l,h=new T4e(a),u=[],d=function(v){function g(m){if(m)try{v(m+"}")}catch{}}return function(m,y,w,b,A,S,T,M,E,P){switch(m){case 1:if(E===0&&y.charCodeAt(0)===64)return v(y+";"),"";break;case 2:if(M===0)return y+"/*|*/";break;case 3:switch(M){case 102:case 112:return v(w[0]+y),"";default:return y+(P===0?"/*|*/":"")}case-2:y.split("/*|*/}").forEach(g)}}}(function(v){u.push(v)}),f=function(v,g,m){return g===0&&sGe.indexOf(m[n.length])!==-1||m.match(r)?v:"."+e};function p(v,g,m,y){y===void 0&&(y="&");var w=v.replace(rGe,""),b=g&&m?m+" "+g+" { "+w+" }":w;return e=y,n=g,i=new RegExp("\\"+n+"\\b","g"),r=new RegExp("(\\"+n+"\\b){2,}"),h(m||!g?"":g,b)}return h.use([].concat(c,[function(v,g,m){v===2&&m.length&&m[0].lastIndexOf(n)>0&&(m[0]=m[0].replace(i,f))},d,function(v){if(v===-2){var g=u;return u=[],g}}])),p.hash=c.length?c.reduce(function(v,g){return g.name||X1(15),eg(v,g.name)},5381).toString():"",p}var oee=du.createContext();oee.Consumer;var aee=du.createContext(),aGe=(aee.Consumer,new ree),c3=oGe();function lGe(){return ge.useContext(oee)||aGe}function cGe(){return ge.useContext(aee)||c3}var uGe=function(){function t(e,n){var i=this;this.inject=function(r,s){s===void 0&&(s=c3);var o=i.name+s.hash;r.hasNameForId(i.id,o)||r.insertRules(i.id,o,s(i.rules,o,"@keyframes"))},this.toString=function(){return X1(12,String(i.name))},this.name=e,this.id="sc-keyframes-"+e,this.rules=n}return t.prototype.getName=function(e){return e===void 0&&(e=c3),this.name+e.hash},t}(),hGe=/([A-Z])/,dGe=/([A-Z])/g,fGe=/^ms-/,pGe=function(t){return"-"+t.toLowerCase()};function QW(t){return hGe.test(t)?t.replace(dGe,pGe).replace(fGe,"-ms-"):t}var KW=function(t){return t==null||t===!1||t===""};function iv(t,e,n,i){if(Array.isArray(t)){for(var r,s=[],o=0,a=t.length;o<a;o+=1)(r=iv(t[o],e,n,i))!==""&&(Array.isArray(r)?s.push.apply(s,r):s.push(r));return s}if(KW(t))return"";if(dN(t))return"."+t.styledComponentId;if(Kx(t)){if(typeof(c=t)!="function"||c.prototype&&c.prototype.isReactComponent||!e)return t;var l=t(e);return iv(l,e,n,i)}var c;return t instanceof uGe?n?(t.inject(n,i),t.getName(i)):t:a3(t)?function h(u,d){var f,p,v=[];for(var g in u)u.hasOwnProperty(g)&&!KW(u[g])&&(Array.isArray(u[g])&&u[g].isCss||Kx(u[g])?v.push(QW(g)+":",u[g],";"):a3(u[g])?v.push.apply(v,h(u[g],g)):v.push(QW(g)+": "+(f=g,(p=u[g])==null||typeof p=="boolean"||p===""?"":typeof p!="number"||p===0||f in P4e||f.startsWith("--")?String(p).trim():p+"px")+";"));return d?[d+" {"].concat(v,["}"]):v}(t):t.toString()}var JW=function(t){return Array.isArray(t)&&(t.isCss=!0),t};function mGe(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return Kx(t)||a3(t)?JW(iv(WW(AM,[t].concat(n)))):n.length===0&&t.length===1&&typeof t[0]=="string"?t:JW(iv(WW(t,n)))}var gGe=function(t,e,n){return n===void 0&&(n=Uh),t.theme!==n.theme&&t.theme||e||n.theme},vGe=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,yGe=/(^-|-$)/g;function TD(t){return t.replace(vGe,"-").replace(yGe,"")}var xGe=function(t){return l3(see(t)>>>0)};function lS(t){return typeof t=="string"&&!0}var u3=function(t){return typeof t=="function"||typeof t=="object"&&t!==null&&!Array.isArray(t)},wGe=function(t){return t!=="__proto__"&&t!=="constructor"&&t!=="prototype"};function _Ge(t,e,n){var i=t[n];u3(e)&&u3(i)?lee(i,e):t[n]=e}function lee(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];for(var r=0,s=n;r<s.length;r++){var o=s[r];if(u3(o))for(var a in o)wGe(a)&&_Ge(t,o[a],a)}return t}var cee=du.createContext();cee.Consumer;var PD={};function uee(t,e,n){var i=dN(t),r=!lS(t),s=e.attrs,o=s===void 0?AM:s,a=e.componentId,l=a===void 0?function(y,w){var b=typeof y!="string"?"sc":TD(y);PD[b]=(PD[b]||0)+1;var A=b+"-"+xGe("5.3.10"+b+PD[b]);return w?w+"-"+A:A}(e.displayName,e.parentComponentId):a,c=e.displayName,h=c===void 0?function(y){return lS(y)?"styled."+y:"Styled("+XW(y)+")"}(t):c,u=e.displayName&&e.componentId?TD(e.displayName)+"-"+e.componentId:e.componentId||l,d=i&&t.attrs?Array.prototype.concat(t.attrs,o).filter(Boolean):o,f=e.shouldForwardProp;i&&t.shouldForwardProp&&(f=e.shouldForwardProp?function(y,w,b){return t.shouldForwardProp(y,w,b)&&e.shouldForwardProp(y,w,b)}:t.shouldForwardProp);var p,v=new iGe(n,u,i?t.componentStyle:void 0),g=v.isStatic&&o.length===0,m=function(y,w){return function(b,A,S,T){var M=b.attrs,E=b.componentStyle,P=b.defaultProps,R=b.foldedComponentIds,F=b.shouldForwardProp,B=b.styledComponentId,k=b.target,j=function(re,G,K){re===void 0&&(re=Uh);var oe=Yc({},G,{theme:re}),ve={};return K.forEach(function($){var se,ne,ie,me=$;for(se in Kx(me)&&(me=me(oe)),me)oe[se]=ve[se]=se==="className"?(ne=ve[se],ie=me[se],ne&&ie?ne+" "+ie:ne||ie):me[se]}),[oe,ve]}(gGe(A,ge.useContext(cee),P)||Uh,A,M),Z=j[0],ee=j[1],O=function(re,G,K,oe){var ve=lGe(),$=cGe(),se=G?re.generateAndInjectStyles(Uh,ve,$):re.generateAndInjectStyles(K,ve,$);return se}(E,T,Z),W=S,H=ee.$as||A.$as||ee.as||A.as||k,Y=lS(H),z=ee!==A?Yc({},A,{},ee):A,X={};for(var q in z)q[0]!=="$"&&q!=="as"&&(q==="forwardedAs"?X.as=z[q]:(F?F(q,GW,H):!Y||GW(q))&&(X[q]=z[q]));return A.style&&ee.style!==A.style&&(X.style=Yc({},A.style,{},ee.style)),X.className=Array.prototype.concat(R,B,O!==B?O:null,A.className,ee.className).filter(Boolean).join(" "),X.ref=W,ge.createElement(H,X)}(p,y,w,g)};return m.displayName=h,(p=du.forwardRef(m)).attrs=d,p.componentStyle=v,p.displayName=h,p.shouldForwardProp=f,p.foldedComponentIds=i?Array.prototype.concat(t.foldedComponentIds,t.styledComponentId):AM,p.styledComponentId=u,p.target=i?t.target:t,p.withComponent=function(y){var w=e.componentId,b=function(S,T){if(S==null)return{};var M,E,P={},R=Object.keys(S);for(E=0;E<R.length;E++)M=R[E],T.indexOf(M)>=0||(P[M]=S[M]);return P}(e,["componentId"]),A=w&&w+"-"+(lS(y)?y:TD(XW(y)));return uee(y,Yc({},b,{attrs:d,componentId:A}),n)},Object.defineProperty(p,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(y){this._foldedDefaultProps=i?lee({},t.defaultProps,y):y}}),Object.defineProperty(p,"toString",{value:function(){return"."+p.styledComponentId}}),r&&z4e(p,t,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),p}var h3=function(t){return function e(n,i,r){if(r===void 0&&(r=Uh),!cN.isValidElementType(i))return X1(1,String(i));var s=function(){return n(i,r,mGe.apply(void 0,arguments))};return s.withConfig=function(o){return e(n,i,Yc({},r,{},o))},s.attrs=function(o){return e(n,i,Yc({},r,{attrs:Array.prototype.concat(r.attrs,o).filter(Boolean)}))},s}(uee,t)};["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach(function(t){h3[t]=h3(t)});const bGe=h3;var hee={exports:{}};(function(t,e){(function(i,r){t.exports=r(ge)})(xte,n=>(()=>{var i={"./node_modules/css-mediaquery/index.js":(a,l)=>{l.match=p,l.parse=v;var c=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,h=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,u=/^(?:(min|max)-)?(.+)/,d=/(em|rem|px|cm|mm|in|pt|pc)?$/,f=/(dpi|dpcm|dppx)?$/;function p(w,b){return v(w).some(function(A){var S=A.inverse,T=A.type==="all"||b.type===A.type;if(T&&S||!(T||S))return!1;var M=A.expressions.every(function(E){var P=E.feature,R=E.modifier,F=E.value,B=b[P];if(!B)return!1;switch(P){case"orientation":case"scan":return B.toLowerCase()===F.toLowerCase();case"width":case"height":case"device-width":case"device-height":F=y(F),B=y(B);break;case"resolution":F=m(F),B=m(B);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":F=g(F),B=g(B);break;case"grid":case"color":case"color-index":case"monochrome":F=parseInt(F,10)||1,B=parseInt(B,10)||0;break}switch(R){case"min":return B>=F;case"max":return B<=F;default:return B===F}});return M&&!S||!M&&S})}function v(w){return w.split(",").map(function(b){b=b.trim();var A=b.match(c),S=A[1],T=A[2],M=A[3]||"",E={};return E.inverse=!!S&&S.toLowerCase()==="not",E.type=T?T.toLowerCase():"all",M=M.match(/\([^\)]+\)/g)||[],E.expressions=M.map(function(P){var R=P.match(h),F=R[1].toLowerCase().match(u);return{modifier:F[1],feature:F[2],value:R[2]}}),E})}function g(w){var b=Number(w),A;return b||(A=w.match(/^(\d+)\s*\/\s*(\d+)$/),b=A[1]/A[2]),b}function m(w){var b=parseFloat(w),A=String(w).match(f)[1];switch(A){case"dpcm":return b/2.54;case"dppx":return b*96;default:return b}}function y(w){var b=parseFloat(w),A=String(w).match(d)[1];switch(A){case"em":return b*16;case"rem":return b*16;case"cm":return b*96/2.54;case"mm":return b*96/2.54/10;case"in":return b*96;case"pt":return b*72;case"pc":return b*72/12;default:return b}}},"./node_modules/hyphenate-style-name/index.js":(a,l,c)=>{c.r(l),c.d(l,{default:()=>v});var h=/[A-Z]/g,u=/^ms-/,d={};function f(g){return"-"+g.toLowerCase()}function p(g){if(d.hasOwnProperty(g))return d[g];var m=g.replace(h,f);return d[g]=u.test(m)?"-"+m:m}const v=p},"./node_modules/matchmediaquery/index.js":(a,l,c)=>{var h=c("./node_modules/css-mediaquery/index.js").match,u=typeof window<"u"?window.matchMedia:null;function d(p,v,g){var m=this;if(u&&!g){var y=u.call(window,p);this.matches=y.matches,this.media=y.media,y.addListener(A)}else this.matches=h(p,v),this.media=p;this.addListener=w,this.removeListener=b,this.dispose=S;function w(T){y&&y.addListener(T)}function b(T){y&&y.removeListener(T)}function A(T){m.matches=T.matches,m.media=T.media}function S(){y&&y.removeListener(A)}}function f(p,v,g){return new d(p,v,g)}a.exports=f},"./node_modules/object-assign/index.js":a=>{/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var l=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable;function u(f){if(f==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(f)}function d(){try{if(!Object.assign)return!1;var f=new String("abc");if(f[5]="de",Object.getOwnPropertyNames(f)[0]==="5")return!1;for(var p={},v=0;v<10;v++)p["_"+String.fromCharCode(v)]=v;var g=Object.getOwnPropertyNames(p).map(function(y){return p[y]});if(g.join("")!=="0123456789")return!1;var m={};return"abcdefghijklmnopqrst".split("").forEach(function(y){m[y]=y}),Object.keys(Object.assign({},m)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}a.exports=d()?Object.assign:function(f,p){for(var v,g=u(f),m,y=1;y<arguments.length;y++){v=Object(arguments[y]);for(var w in v)c.call(v,w)&&(g[w]=v[w]);if(l){m=l(v);for(var b=0;b<m.length;b++)h.call(v,m[b])&&(g[m[b]]=v[m[b]])}}return g}},"./node_modules/prop-types/checkPropTypes.js":(a,l,c)=>{var h=function(){};{var u=c("./node_modules/prop-types/lib/ReactPropTypesSecret.js"),d={},f=c("./node_modules/prop-types/lib/has.js");h=function(v){var g="Warning: "+v;typeof console<"u"&&console.error(g);try{throw new Error(g)}catch{}}}function p(v,g,m,y,w){for(var b in v)if(f(v,b)){var A;try{if(typeof v[b]!="function"){var S=Error((y||"React class")+": "+m+" type `"+b+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof v[b]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw S.name="Invariant Violation",S}A=v[b](g,b,y,m,null,u)}catch(M){A=M}if(A&&!(A instanceof Error)&&h((y||"React class")+": type specification of "+m+" `"+b+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof A+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),A instanceof Error&&!(A.message in d)){d[A.message]=!0;var T=w?w():"";h("Failed "+m+" type: "+A.message+(T??""))}}}p.resetWarningCache=function(){d={}},a.exports=p},"./node_modules/prop-types/factoryWithTypeCheckers.js":(a,l,c)=>{var h=c("./node_modules/react-is/index.js"),u=c("./node_modules/object-assign/index.js"),d=c("./node_modules/prop-types/lib/ReactPropTypesSecret.js"),f=c("./node_modules/prop-types/lib/has.js"),p=c("./node_modules/prop-types/checkPropTypes.js"),v=function(){};v=function(m){var y="Warning: "+m;typeof console<"u"&&console.error(y);try{throw new Error(y)}catch{}};function g(){return null}a.exports=function(m,y){var w=typeof Symbol=="function"&&Symbol.iterator,b="@@iterator";function A($){var se=$&&(w&&$[w]||$[b]);if(typeof se=="function")return se}var S="<<anonymous>>",T={array:R("array"),bigint:R("bigint"),bool:R("boolean"),func:R("function"),number:R("number"),object:R("object"),string:R("string"),symbol:R("symbol"),any:F(),arrayOf:B,element:k(),elementType:j(),instanceOf:Z,node:H(),objectOf:O,oneOf:ee,oneOfType:W,shape:z,exact:X};function M($,se){return $===se?$!==0||1/$===1/se:$!==$&&se!==se}function E($,se){this.message=$,this.data=se&&typeof se=="object"?se:{},this.stack=""}E.prototype=Error.prototype;function P($){var se={},ne=0;function ie(xe,Ae,_e,Ee,Re,Ue,Ne){if(Ee=Ee||S,Ue=Ue||_e,Ne!==d){if(y){var U=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw U.name="Invariant Violation",U}else if(typeof console<"u"){var L=Ee+":"+_e;!se[L]&&ne<3&&(v("You are manually calling a React.PropTypes validation function for the `"+Ue+"` prop on `"+Ee+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),se[L]=!0,ne++)}}return Ae[_e]==null?xe?Ae[_e]===null?new E("The "+Re+" `"+Ue+"` is marked as required "+("in `"+Ee+"`, but its value is `null`.")):new E("The "+Re+" `"+Ue+"` is marked as required in "+("`"+Ee+"`, but its value is `undefined`.")):null:$(Ae,_e,Ee,Re,Ue)}var me=ie.bind(null,!1);return me.isRequired=ie.bind(null,!0),me}function R($){function se(ne,ie,me,xe,Ae,_e){var Ee=ne[ie],Re=G(Ee);if(Re!==$){var Ue=K(Ee);return new E("Invalid "+xe+" `"+Ae+"` of type "+("`"+Ue+"` supplied to `"+me+"`, expected ")+("`"+$+"`."),{expectedType:$})}return null}return P(se)}function F(){return P(g)}function B($){function se(ne,ie,me,xe,Ae){if(typeof $!="function")return new E("Property `"+Ae+"` of component `"+me+"` has invalid PropType notation inside arrayOf.");var _e=ne[ie];if(!Array.isArray(_e)){var Ee=G(_e);return new E("Invalid "+xe+" `"+Ae+"` of type "+("`"+Ee+"` supplied to `"+me+"`, expected an array."))}for(var Re=0;Re<_e.length;Re++){var Ue=$(_e,Re,me,xe,Ae+"["+Re+"]",d);if(Ue instanceof Error)return Ue}return null}return P(se)}function k(){function $(se,ne,ie,me,xe){var Ae=se[ne];if(!m(Ae)){var _e=G(Ae);return new E("Invalid "+me+" `"+xe+"` of type "+("`"+_e+"` supplied to `"+ie+"`, expected a single ReactElement."))}return null}return P($)}function j(){function $(se,ne,ie,me,xe){var Ae=se[ne];if(!h.isValidElementType(Ae)){var _e=G(Ae);return new E("Invalid "+me+" `"+xe+"` of type "+("`"+_e+"` supplied to `"+ie+"`, expected a single ReactElement type."))}return null}return P($)}function Z($){function se(ne,ie,me,xe,Ae){if(!(ne[ie]instanceof $)){var _e=$.name||S,Ee=ve(ne[ie]);return new E("Invalid "+xe+" `"+Ae+"` of type "+("`"+Ee+"` supplied to `"+me+"`, expected ")+("instance of `"+_e+"`."))}return null}return P(se)}function ee($){if(!Array.isArray($))return arguments.length>1?v("Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z])."):v("Invalid argument supplied to oneOf, expected an array."),g;function se(ne,ie,me,xe,Ae){for(var _e=ne[ie],Ee=0;Ee<$.length;Ee++)if(M(_e,$[Ee]))return null;var Re=JSON.stringify($,function(Ne,U){var L=K(U);return L==="symbol"?String(U):U});return new E("Invalid "+xe+" `"+Ae+"` of value `"+String(_e)+"` "+("supplied to `"+me+"`, expected one of "+Re+"."))}return P(se)}function O($){function se(ne,ie,me,xe,Ae){if(typeof $!="function")return new E("Property `"+Ae+"` of component `"+me+"` has invalid PropType notation inside objectOf.");var _e=ne[ie],Ee=G(_e);if(Ee!=="object")return new E("Invalid "+xe+" `"+Ae+"` of type "+("`"+Ee+"` supplied to `"+me+"`, expected an object."));for(var Re in _e)if(f(_e,Re)){var Ue=$(_e,Re,me,xe,Ae+"."+Re,d);if(Ue instanceof Error)return Ue}return null}return P(se)}function W($){if(!Array.isArray($))return v("Invalid argument supplied to oneOfType, expected an instance of array."),g;for(var se=0;se<$.length;se++){var ne=$[se];if(typeof ne!="function")return v("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+oe(ne)+" at index "+se+"."),g}function ie(me,xe,Ae,_e,Ee){for(var Re=[],Ue=0;Ue<$.length;Ue++){var Ne=$[Ue],U=Ne(me,xe,Ae,_e,Ee,d);if(U==null)return null;U.data&&f(U.data,"expectedType")&&Re.push(U.data.expectedType)}var L=Re.length>0?", expected one of type ["+Re.join(", ")+"]":"";return new E("Invalid "+_e+" `"+Ee+"` supplied to "+("`"+Ae+"`"+L+"."))}return P(ie)}function H(){function $(se,ne,ie,me,xe){return q(se[ne])?null:new E("Invalid "+me+" `"+xe+"` supplied to "+("`"+ie+"`, expected a ReactNode."))}return P($)}function Y($,se,ne,ie,me){return new E(($||"React class")+": "+se+" type `"+ne+"."+ie+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+me+"`.")}function z($){function se(ne,ie,me,xe,Ae){var _e=ne[ie],Ee=G(_e);if(Ee!=="object")return new E("Invalid "+xe+" `"+Ae+"` of type `"+Ee+"` "+("supplied to `"+me+"`, expected `object`."));for(var Re in $){var Ue=$[Re];if(typeof Ue!="function")return Y(me,xe,Ae,Re,K(Ue));var Ne=Ue(_e,Re,me,xe,Ae+"."+Re,d);if(Ne)return Ne}return null}return P(se)}function X($){function se(ne,ie,me,xe,Ae){var _e=ne[ie],Ee=G(_e);if(Ee!=="object")return new E("Invalid "+xe+" `"+Ae+"` of type `"+Ee+"` "+("supplied to `"+me+"`, expected `object`."));var Re=u({},ne[ie],$);for(var Ue in Re){var Ne=$[Ue];if(f($,Ue)&&typeof Ne!="function")return Y(me,xe,Ae,Ue,K(Ne));if(!Ne)return new E("Invalid "+xe+" `"+Ae+"` key `"+Ue+"` supplied to `"+me+"`.\nBad object: "+JSON.stringify(ne[ie],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys($),null,"  "));var U=Ne(_e,Ue,me,xe,Ae+"."+Ue,d);if(U)return U}return null}return P(se)}function q($){switch(typeof $){case"number":case"string":case"undefined":return!0;case"boolean":return!$;case"object":if(Array.isArray($))return $.every(q);if($===null||m($))return!0;var se=A($);if(se){var ne=se.call($),ie;if(se!==$.entries){for(;!(ie=ne.next()).done;)if(!q(ie.value))return!1}else for(;!(ie=ne.next()).done;){var me=ie.value;if(me&&!q(me[1]))return!1}}else return!1;return!0;default:return!1}}function re($,se){return $==="symbol"?!0:se?se["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&se instanceof Symbol:!1}function G($){var se=typeof $;return Array.isArray($)?"array":$ instanceof RegExp?"object":re(se,$)?"symbol":se}function K($){if(typeof $>"u"||$===null)return""+$;var se=G($);if(se==="object"){if($ instanceof Date)return"date";if($ instanceof RegExp)return"regexp"}return se}function oe($){var se=K($);switch(se){case"array":case"object":return"an "+se;case"boolean":case"date":case"regexp":return"a "+se;default:return se}}function ve($){return!$.constructor||!$.constructor.name?S:$.constructor.name}return T.checkPropTypes=p,T.resetWarningCache=p.resetWarningCache,T.PropTypes=T,T}},"./node_modules/prop-types/index.js":(a,l,c)=>{{var h=c("./node_modules/react-is/index.js"),u=!0;a.exports=c("./node_modules/prop-types/factoryWithTypeCheckers.js")(h.isElement,u)}},"./node_modules/prop-types/lib/ReactPropTypesSecret.js":a=>{var l="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";a.exports=l},"./node_modules/prop-types/lib/has.js":a=>{a.exports=Function.call.bind(Object.prototype.hasOwnProperty)},"./node_modules/react-is/cjs/react-is.development.js":(a,l)=>{/** @license React v16.13.1
 * react-is.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){var c=typeof Symbol=="function"&&Symbol.for,h=c?Symbol.for("react.element"):60103,u=c?Symbol.for("react.portal"):60106,d=c?Symbol.for("react.fragment"):60107,f=c?Symbol.for("react.strict_mode"):60108,p=c?Symbol.for("react.profiler"):60114,v=c?Symbol.for("react.provider"):60109,g=c?Symbol.for("react.context"):60110,m=c?Symbol.for("react.async_mode"):60111,y=c?Symbol.for("react.concurrent_mode"):60111,w=c?Symbol.for("react.forward_ref"):60112,b=c?Symbol.for("react.suspense"):60113,A=c?Symbol.for("react.suspense_list"):60120,S=c?Symbol.for("react.memo"):60115,T=c?Symbol.for("react.lazy"):60116,M=c?Symbol.for("react.block"):60121,E=c?Symbol.for("react.fundamental"):60117,P=c?Symbol.for("react.responder"):60118,R=c?Symbol.for("react.scope"):60119;function F(Ne){return typeof Ne=="string"||typeof Ne=="function"||Ne===d||Ne===y||Ne===p||Ne===f||Ne===b||Ne===A||typeof Ne=="object"&&Ne!==null&&(Ne.$$typeof===T||Ne.$$typeof===S||Ne.$$typeof===v||Ne.$$typeof===g||Ne.$$typeof===w||Ne.$$typeof===E||Ne.$$typeof===P||Ne.$$typeof===R||Ne.$$typeof===M)}function B(Ne){if(typeof Ne=="object"&&Ne!==null){var U=Ne.$$typeof;switch(U){case h:var L=Ne.type;switch(L){case m:case y:case d:case p:case f:case b:return L;default:var te=L&&L.$$typeof;switch(te){case g:case w:case T:case S:case v:return te;default:return U}}case u:return U}}}var k=m,j=y,Z=g,ee=v,O=h,W=w,H=d,Y=T,z=S,X=u,q=p,re=f,G=b,K=!1;function oe(Ne){return K||(K=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),ve(Ne)||B(Ne)===m}function ve(Ne){return B(Ne)===y}function $(Ne){return B(Ne)===g}function se(Ne){return B(Ne)===v}function ne(Ne){return typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===h}function ie(Ne){return B(Ne)===w}function me(Ne){return B(Ne)===d}function xe(Ne){return B(Ne)===T}function Ae(Ne){return B(Ne)===S}function _e(Ne){return B(Ne)===u}function Ee(Ne){return B(Ne)===p}function Re(Ne){return B(Ne)===f}function Ue(Ne){return B(Ne)===b}l.AsyncMode=k,l.ConcurrentMode=j,l.ContextConsumer=Z,l.ContextProvider=ee,l.Element=O,l.ForwardRef=W,l.Fragment=H,l.Lazy=Y,l.Memo=z,l.Portal=X,l.Profiler=q,l.StrictMode=re,l.Suspense=G,l.isAsyncMode=oe,l.isConcurrentMode=ve,l.isContextConsumer=$,l.isContextProvider=se,l.isElement=ne,l.isForwardRef=ie,l.isFragment=me,l.isLazy=xe,l.isMemo=Ae,l.isPortal=_e,l.isProfiler=Ee,l.isStrictMode=Re,l.isSuspense=Ue,l.isValidElementType=F,l.typeOf=B})()},"./node_modules/react-is/index.js":(a,l,c)=>{a.exports=c("./node_modules/react-is/cjs/react-is.development.js")},"./node_modules/shallow-equal/dist/index.esm.js":(a,l,c)=>{c.r(l),c.d(l,{shallowEqualArrays:()=>u,shallowEqualObjects:()=>h});function h(d,f){if(d===f)return!0;if(!d||!f)return!1;var p=Object.keys(d),v=Object.keys(f),g=p.length;if(v.length!==g)return!1;for(var m=0;m<g;m++){var y=p[m];if(d[y]!==f[y]||!Object.prototype.hasOwnProperty.call(f,y))return!1}return!0}function u(d,f){if(d===f)return!0;if(!d||!f)return!1;var p=d.length;if(f.length!==p)return!1;for(var v=0;v<p;v++)if(d[v]!==f[v])return!1;return!0}},"./src/Component.ts":function(a,l,c){var h=this&&this.__rest||function(p,v){var g={};for(var m in p)Object.prototype.hasOwnProperty.call(p,m)&&v.indexOf(m)<0&&(g[m]=p[m]);if(p!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,m=Object.getOwnPropertySymbols(p);y<m.length;y++)v.indexOf(m[y])<0&&Object.prototype.propertyIsEnumerable.call(p,m[y])&&(g[m[y]]=p[m[y]]);return g},u=this&&this.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(l,"__esModule",{value:!0});var d=u(c("./src/useMediaQuery.ts")),f=function(p){var v=p.children,g=p.device,m=p.onChange,y=h(p,["children","device","onChange"]),w=(0,d.default)(y,g,m);return typeof v=="function"?v(w):w?v:null};l.default=f},"./src/Context.ts":(a,l,c)=>{Object.defineProperty(l,"__esModule",{value:!0});var h=c("react"),u=(0,h.createContext)(void 0);l.default=u},"./src/index.ts":function(a,l,c){var h=this&&this.__importDefault||function(v){return v&&v.__esModule?v:{default:v}};Object.defineProperty(l,"__esModule",{value:!0}),l.Context=l.toQuery=l.useMediaQuery=l.default=void 0;var u=h(c("./src/useMediaQuery.ts"));l.useMediaQuery=u.default;var d=h(c("./src/Component.ts"));l.default=d.default;var f=h(c("./src/toQuery.ts"));l.toQuery=f.default;var p=h(c("./src/Context.ts"));l.Context=p.default},"./src/mediaQuery.ts":function(a,l,c){var h=this&&this.__assign||function(){return h=Object.assign||function(b){for(var A,S=1,T=arguments.length;S<T;S++){A=arguments[S];for(var M in A)Object.prototype.hasOwnProperty.call(A,M)&&(b[M]=A[M])}return b},h.apply(this,arguments)},u=this&&this.__rest||function(b,A){var S={};for(var T in b)Object.prototype.hasOwnProperty.call(b,T)&&A.indexOf(T)<0&&(S[T]=b[T]);if(b!=null&&typeof Object.getOwnPropertySymbols=="function")for(var M=0,T=Object.getOwnPropertySymbols(b);M<T.length;M++)A.indexOf(T[M])<0&&Object.prototype.propertyIsEnumerable.call(b,T[M])&&(S[T[M]]=b[T[M]]);return S},d=this&&this.__importDefault||function(b){return b&&b.__esModule?b:{default:b}};Object.defineProperty(l,"__esModule",{value:!0});var f=d(c("./node_modules/prop-types/index.js")),p=f.default.oneOfType([f.default.string,f.default.number]),v={all:f.default.bool,grid:f.default.bool,aural:f.default.bool,braille:f.default.bool,handheld:f.default.bool,print:f.default.bool,projection:f.default.bool,screen:f.default.bool,tty:f.default.bool,tv:f.default.bool,embossed:f.default.bool},g={orientation:f.default.oneOf(["portrait","landscape"]),scan:f.default.oneOf(["progressive","interlace"]),aspectRatio:f.default.string,deviceAspectRatio:f.default.string,height:p,deviceHeight:p,width:p,deviceWidth:p,color:f.default.bool,colorIndex:f.default.bool,monochrome:f.default.bool,resolution:p,type:Object.keys(v)};g.type;var m=u(g,["type"]),y=h({minAspectRatio:f.default.string,maxAspectRatio:f.default.string,minDeviceAspectRatio:f.default.string,maxDeviceAspectRatio:f.default.string,minHeight:p,maxHeight:p,minDeviceHeight:p,maxDeviceHeight:p,minWidth:p,maxWidth:p,minDeviceWidth:p,maxDeviceWidth:p,minColor:f.default.number,maxColor:f.default.number,minColorIndex:f.default.number,maxColorIndex:f.default.number,minMonochrome:f.default.number,maxMonochrome:f.default.number,minResolution:p,maxResolution:p},m),w=h(h({},v),y);l.default={all:w,types:v,matchers:g,features:y}},"./src/toQuery.ts":function(a,l,c){var h=this&&this.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(l,"__esModule",{value:!0});var u=h(c("./node_modules/hyphenate-style-name/index.js")),d=h(c("./src/mediaQuery.ts")),f=function(m){return"not ".concat(m)},p=function(m,y){var w=(0,u.default)(m);return typeof y=="number"&&(y="".concat(y,"px")),y===!0?w:y===!1?f(w):"(".concat(w,": ").concat(y,")")},v=function(m){return m.join(" and ")},g=function(m){var y=[];return Object.keys(d.default.all).forEach(function(w){var b=m[w];b!=null&&y.push(p(w,b))}),v(y)};l.default=g},"./src/useMediaQuery.ts":function(a,l,c){var h=this&&this.__importDefault||function(E){return E&&E.__esModule?E:{default:E}};Object.defineProperty(l,"__esModule",{value:!0});var u=c("react"),d=h(c("./node_modules/matchmediaquery/index.js")),f=h(c("./node_modules/hyphenate-style-name/index.js")),p=c("./node_modules/shallow-equal/dist/index.esm.js"),v=h(c("./src/toQuery.ts")),g=h(c("./src/Context.ts")),m=function(E){return E.query||(0,v.default)(E)},y=function(E){if(E){var P=Object.keys(E);return P.reduce(function(R,F){return R[(0,f.default)(F)]=E[F],R},{})}},w=function(){var E=(0,u.useRef)(!1);return(0,u.useEffect)(function(){E.current=!0},[]),E.current},b=function(E){var P=(0,u.useContext)(g.default),R=function(){return y(E)||y(P)},F=(0,u.useState)(R),B=F[0],k=F[1];return(0,u.useEffect)(function(){var j=R();(0,p.shallowEqualObjects)(B,j)||k(j)},[E,P]),B},A=function(E){var P=function(){return m(E)},R=(0,u.useState)(P),F=R[0],B=R[1];return(0,u.useEffect)(function(){var k=P();F!==k&&B(k)},[E]),F},S=function(E,P){var R=function(){return(0,d.default)(E,P||{},!!P)},F=(0,u.useState)(R),B=F[0],k=F[1],j=w();return(0,u.useEffect)(function(){if(j){var Z=R();return k(Z),function(){Z&&Z.dispose()}}},[E,P]),B},T=function(E){var P=(0,u.useState)(E.matches),R=P[0],F=P[1];return(0,u.useEffect)(function(){var B=function(k){F(k.matches)};return E.addListener(B),F(E.matches),function(){E.removeListener(B)}},[E]),R},M=function(E,P,R){var F=b(P),B=A(E);if(!B)throw new Error("Invalid or missing MediaQuery!");var k=S(B,F),j=T(k),Z=w();return(0,u.useEffect)(function(){Z&&R&&R(j)},[j]),(0,u.useEffect)(function(){return function(){k&&k.dispose()}},[]),j};l.default=M},react:a=>{a.exports=n}},r={};function s(a){var l=r[a];if(l!==void 0)return l.exports;var c=r[a]={exports:{}};return i[a].call(c.exports,c,c.exports,s),c.exports}s.d=(a,l)=>{for(var c in l)s.o(l,c)&&!s.o(a,c)&&Object.defineProperty(a,c,{enumerable:!0,get:l[c]})},s.o=(a,l)=>Object.prototype.hasOwnProperty.call(a,l),s.r=a=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})};var o=s("./src/index.ts");return o})())})(hee);var SGe=hee.exports;const AGe=()=>{const t=SGe.useMediaQuery({maxWidth:1068});return We.jsx(We.Fragment,{children:We.jsx("div",{children:We.jsx(MGe,{className:"flex flex-col w-screen h-screen min-h-screen items-center justify-center relative",children:t?We.jsx(zW,{className:"splinesm",scene:"https://prod.spline.design/2UDr40IsmI03S33u/scene.splinecode"}):We.jsx(zW,{className:"spline",scene:"https://prod.spline.design/fHSFs1CucN88MZIU/scene.splinecode"})})})})},MGe=bGe.div`



.spline {
  position: absolute;
  //  width: 200%;
  // height: 100%
  // overflow-x: hidden;

  // @media (max-width: 576px){
  //   display: none;
  // }
   
  @media (min-width: 390px){
    transform: scale(0.25) translateX(-1100px);
    
  }
  @media (min-width: 600px){
    transform: scale(0.4) translateX(-1000px);
    
  }
  @media (min-width: 824px){
    transform: scale(0.5) translateX(-850px);
  }
  @media (min-width: 1024px){
    transform: scale(0.6) translateX(-700px);
  }
  @media (min-width: 1224px){
    transform: scale(0.7) translateX(-600px);
  }
  @media (min-width: 1524px){
    transform: scale(0.8) translateX(-500px);
  }
  @media (min-width: 1754px){
    transform: scale(0.9) translateX(-400px);
  }
  @media (min-width: 1954px){
    transform: scale(1) translateX(-300px);
  }
   
}

.splinesm {
  position: absolute;
  //  width: 200%;
  // height: 100%
  // overflow-x: hidden;

  // @media (max-width: 576px){
  //   display: none;
  // }

  //WIDTH

  @media (min-width: 290px){
    transform: scale(.9) translateY(250px);
    
  }
  @media (min-width: 390px){
    transform: scale(1) translateY(250px);
    
  }
  @media (min-width: 500px){
    transform: scale(1.2) translateX(100px)  translateY(150px);
  }
  @media (min-width: 600px){
    transform: scale(1.2) translateX(220px)  translateY(300px);
    
  }
  @media (min-width: 800px){
    transform: scale(1.2) translateX(250px)  translateY(350px);
  }
  @media (min-width: 900px){
    transform: scale(1.5) translateX(300px)  translateY(450px);
  }

// Height

  
}

`,EGe=()=>We.jsxs("div",{className:"absolute top-40",children:[We.jsxs("div",{className:"relative",children:[We.jsxs("h1",{className:`${au.heroHeadText} text-white ml-20`,children:[We.jsxs("div",{className:"static-texts",children:["Hi, I'm ",We.jsx("span",{className:"text-[#08B6F9]",children:"Steven"})]}),We.jsx("span",{className:"text-[#08B6F9]",children:We.jsx("ul",{className:"dynamic-texts"})})]}),We.jsxs("p",{className:`${au.heroSubText} mt-2 ml-20 text-white-100`,children:["A Computer Engineering Student ",We.jsx("br",{className:"sm:block hidden"})]})]}),We.jsxs("div",{className:"flex flex-col justify-center ml-10 mt-5 relative",children:[We.jsx("div",{className:"w-5 h-5 rounded-full bg-[#08B6F9]"}),We.jsx("div",{className:"flex flex-col neon-gradient ml-2"}),We.jsx("div",{className:"flex flex-col neonFade-gradient ml-2"})]})]}),CGe=()=>We.jsxs("div",{className:"relative z-0 bg-primary",children:[We.jsx(ime,{}),We.jsx(qpe,{}),We.jsx(EGe,{}),We.jsx(AGe,{}),We.jsx("div",{className:" bg-cover bg-no-repeat bg-center pointer-events-none"}),We.jsxs("div",{className:"relative z-0",children:[We.jsx("div",{id:"about",children:We.jsx(DQ,{})}),We.jsx("div",{id:"project",children:We.jsx(Rye,{})}),We.jsx("div",{id:"contact",children:We.jsx(kQ,{})})]})]}),TGe=()=>We.jsx("div",{children:"NoPage"});function Fn(t){console.warn("[react-ga]",t)}function d3(t){return d3=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d3(t)}var PGe=["to","target"];function ZW(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function $W(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ZW(Object(n),!0).forEach(function(i){pN(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ZW(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function DGe(t,e){if(t==null)return{};var n=RGe(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function RGe(t,e){if(t==null)return{};var n={},i=Object.keys(t),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function LGe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e8(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function IGe(t,e,n){return e&&e8(t.prototype,e),n&&e8(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function BGe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f3(t,e)}function f3(t,e){return f3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,r){return i.__proto__=r,i},f3(t,e)}function OGe(t){var e=NGe();return function(){var i=EM(t),r;if(e){var s=EM(this).constructor;r=Reflect.construct(i,arguments,s)}else r=i.apply(this,arguments);return FGe(this,r)}}function FGe(t,e){if(e&&(d3(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return dee(t)}function dee(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function NGe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function EM(t){return EM=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},EM(t)}function pN(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var t8="_blank",UGe=1,Vf=function(t){BGe(n,t);var e=OGe(n);function n(){var i;LGe(this,n);for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i=e.call.apply(e,[this].concat(s)),pN(dee(i),"handleClick",function(a){var l=i.props,c=l.target,h=l.eventLabel,u=l.to,d=l.onClick,f=l.trackerNames,p={label:h},v=c!==t8,g=!(a.ctrlKey||a.shiftKey||a.metaKey||a.button===UGe);v&&g?(a.preventDefault(),n.trackLink(p,function(){window.location.href=u},f)):n.trackLink(p,function(){},f),d&&d(a)}),i}return IGe(n,[{key:"render",value:function(){var r=this.props,s=r.to,o=r.target,a=DGe(r,PGe),l=$W($W({},a),{},{target:o,href:s,onClick:this.handleClick});return o===t8&&(l.rel="".concat(l.rel?l.rel:""," noopener noreferrer").trim()),delete l.eventLabel,delete l.trackerNames,du.createElement("a",l)}}]),n}(ge.Component);pN(Vf,"trackLink",function(){Fn("ga tracking not enabled")});Vf.propTypes={eventLabel:Hp.string.isRequired,target:Hp.string,to:Hp.string,onClick:Hp.func,trackerNames:Hp.arrayOf(Hp.string)};Vf.defaultProps={target:null,to:null,onClick:null,trackerNames:null};function kGe(t){return typeof t=="string"&&t.indexOf("@")!==-1}var zGe="REDACTED (Potential Email Address)";function GGe(t){return kGe(t)?(Fn("This arg looks like an email address, redacting."),zGe):t}function tC(t){return t&&t.toString().replace(/^\s+|\s+$/g,"")}var HGe=/^(a|an|and|as|at|but|by|en|for|if|in|nor|of|on|or|per|the|to|vs?\.?|via)$/i;function VGe(t){return tC(t).replace(/[A-Za-z0-9\u00C0-\u00FF]+[^\s-]*/g,function(e,n,i){return n>0&&n+e.length!==i.length&&e.search(HGe)>-1&&i.charAt(n-2)!==":"&&(i.charAt(n+e.length)!=="-"||i.charAt(n-1)==="-")&&i.charAt(n-1).search(/[^\s-]/)<0?e.toLowerCase():e.substr(1).search(/[A-Z]|\../)>-1?e:e.charAt(0).toUpperCase()+e.substr(1)})}function jGe(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=t||"";return e&&(i=VGe(t)),n&&(i=GGe(i)),i}function WGe(t){return t.substring(0,1)==="/"?t.substring(1):t}var n8=!1;function XGe(t){if(!n8){n8=!0;var e="https://www.google-analytics.com/analytics.js";t&&t.gaAddress?e=t.gaAddress:t&&t.debug&&(e="https://www.google-analytics.com/analytics_debug.js");var n=t&&t.onerror;(function(i,r,s,o,a,l,c){i.GoogleAnalyticsObject=a,i[a]=i[a]||function(){(i[a].q=i[a].q||[]).push(arguments)},i[a].l=1*new Date,l=r.createElement(s),c=r.getElementsByTagName(s)[0],l.async=1,l.src=o,l.onerror=n,c.parentNode.insertBefore(l,c)})(window,document,"script",e,"ga")}}function gr(t){console.info("[react-ga]",t)}var DD=[];const CM={calls:DD,ga:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];DD.push([].concat(n))},resetCalls:function(){DD.length=0}};var YGe=["category","action","label","value","nonInteraction","transport"];function qGe(t,e){if(t==null)return{};var n=QGe(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function QGe(t,e){if(t==null)return{};var n={},i=Object.keys(t),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function i8(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function KGe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?i8(Object(n),!0).forEach(function(i){JGe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i8(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function JGe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jx(t){return Jx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jx(t)}function ZGe(t){return nHe(t)||tHe(t)||eHe(t)||$Ge()}function $Ge(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eHe(t,e){if(t){if(typeof t=="string")return p3(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p3(t,e)}}function tHe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function nHe(t){if(Array.isArray(t))return p3(t)}function p3(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var fee=typeof window>"u"||typeof document>"u",za=!1,pee=!0,mee=!1,gee=!0,vee=!0,Mg=function(){var e;return mee?CM.ga.apply(CM,arguments):fee?!1:window.ga?(e=window).ga.apply(e,arguments):Fn("ReactGA.initialize must be called first or GoogleAnalytics should be loaded manually")};function kh(t){return jGe(t,pee,vee)}function nC(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var r=n[0];if(typeof Mg=="function"){if(typeof r!="string"){Fn("ga command must be a string");return}(gee||!Array.isArray(t))&&Mg.apply(void 0,n),Array.isArray(t)&&t.forEach(function(s){Mg.apply(void 0,ZGe(["".concat(s,".").concat(r)].concat(n.slice(1))))})}}function r8(t,e){if(!t){Fn("gaTrackingID is required in initialize()");return}e&&(e.debug&&e.debug===!0&&(za=!0),e.titleCase===!1&&(pee=!1),e.redactEmail===!1&&(vee=!1),e.useExistingGa)||(e&&e.gaOptions?Mg("create",t,e.gaOptions):Mg("create",t,"auto"))}function yee(t,e){return Array.isArray(t)?t.forEach(function(n){if(Jx(n)!=="object"){Fn("All configs must be an object");return}r8(n.trackingId,n)}):r8(t,e),!0}function xee(t,e){if(e&&e.testMode===!0)mee=!0;else{if(fee)return;(!e||e.standardImplementation!==!0)&&XGe(e)}gee=e&&typeof e.alwaysSendToDefaultTracker=="boolean"?e.alwaysSendToDefaultTracker:!0,yee(t,e)}function ps(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length>0&&(Mg.apply(void 0,e),za&&(gr("called ga('arguments');"),gr("with arguments: ".concat(JSON.stringify(e))))),window.ga}function wee(t,e){if(!t){Fn("`fieldsObject` is required in .set()");return}if(Jx(t)!=="object"){Fn("Expected `fieldsObject` arg to be an Object");return}Object.keys(t).length===0&&Fn("empty `fieldsObject` given to .set()"),nC(e,"set",t),za&&(gr("called ga('set', fieldsObject);"),gr("with fieldsObject: ".concat(JSON.stringify(t))))}function Dv(t,e){nC(e,"send",t),za&&(gr("called ga('send', fieldObject);"),gr("with fieldObject: ".concat(JSON.stringify(t))),gr("with trackers: ".concat(JSON.stringify(e))))}function _ee(t,e,n){if(!t){Fn("path is required in .pageview()");return}var i=tC(t);if(i===""){Fn("path cannot be an empty string in .pageview()");return}var r={};if(n&&(r.title=n),typeof ps=="function"&&(nC(e,"send",KGe({hitType:"pageview",page:i},r)),za)){gr("called ga('send', 'pageview', path);");var s="";n&&(s=" and title: ".concat(n)),gr("with path: ".concat(i).concat(s))}}function bee(t,e){if(!t){Fn("modalName is required in .modalview(modalName)");return}var n=WGe(tC(t));if(n===""){Fn("modalName cannot be an empty string or a single / in .modalview()");return}if(typeof ps=="function"){var i="/modal/".concat(n);nC(e,"send","pageview",i),za&&(gr("called ga('send', 'pageview', path);"),gr("with path: ".concat(i)))}}function See(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.category,n=t.variable,i=t.value,r=t.label,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;if(typeof ps=="function"){if(!e||!n||typeof i!="number"){Fn("args.category, args.variable AND args.value are required in timing() AND args.value has to be a number");return}var o={hitType:"timing",timingCategory:kh(e),timingVar:kh(n),timingValue:i};r&&(o.timingLabel=kh(r)),Dv(o,s)}}function Aee(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.category,n=t.action,i=t.label,r=t.value,s=t.nonInteraction,o=t.transport,a=qGe(t,YGe),l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:void 0;if(typeof ps=="function"){if(!e||!n){Fn("args.category AND args.action are required in event()");return}var c={hitType:"event",eventCategory:kh(e),eventAction:kh(n)};i&&(c.eventLabel=kh(i)),typeof r<"u"&&(typeof r!="number"?Fn("Expected `args.value` arg to be a Number."):c.eventValue=r),typeof s<"u"&&(typeof s!="boolean"?Fn("`args.nonInteraction` must be a boolean."):c.nonInteraction=s),typeof o<"u"&&(typeof o!="string"?Fn("`args.transport` must be a string."):(["beacon","xhr","image"].indexOf(o)===-1&&Fn("`args.transport` must be either one of these values: `beacon`, `xhr` or `image`"),c.transport=o)),Object.keys(a).filter(function(h){return h.substr(0,9)==="dimension"}).forEach(function(h){c[h]=a[h]}),Object.keys(a).filter(function(h){return h.substr(0,6)==="metric"}).forEach(function(h){c[h]=a[h]}),Dv(c,l)}}function Mee(t,e){var n=t.description,i=t.fatal;if(typeof ps=="function"){var r={hitType:"exception"};n&&(r.exDescription=kh(n)),typeof i<"u"&&(typeof i!="boolean"?Fn("`args.fatal` must be a boolean."):r.exFatal=i),Dv(r,e)}}var Eee={require:function(e,n,i){if(typeof ps=="function"){if(!e){Fn("`name` is required in .require()");return}var r=tC(e);if(r===""){Fn("`name` cannot be an empty string in .require()");return}var s=i?"".concat(i,".require"):"require";if(n){if(Jx(n)!=="object"){Fn("Expected `options` arg to be an Object");return}Object.keys(n).length===0&&Fn("Empty `options` given to .require()"),ps(s,r,n),za&&gr("called ga('require', '".concat(r,"', ").concat(JSON.stringify(n)))}else ps(s,r),za&&gr("called ga('require', '".concat(r,"');"))}},execute:function(e,n){for(var i,r,s=arguments.length,o=new Array(s>2?s-2:0),a=2;a<s;a++)o[a-2]=arguments[a];if(o.length===1?i=o[0]:(r=o[0],i=o[1]),typeof ps=="function")if(typeof e!="string")Fn("Expected `pluginName` arg to be a String.");else if(typeof n!="string")Fn("Expected `action` arg to be a String.");else{var l="".concat(e,":").concat(n);i=i||null,r&&i?(ps(l,r,i),za&&(gr("called ga('".concat(l,"');")),gr('actionType: "'.concat(r,'" with payload: ').concat(JSON.stringify(i))))):i?(ps(l,i),za&&(gr("called ga('".concat(l,"');")),gr("with payload: ".concat(JSON.stringify(i))))):(ps(l),za&&gr("called ga('".concat(l,"');")))}}};function mN(t,e,n){if(typeof e!="function"){Fn("hitCallback function is required");return}if(typeof ps=="function"){if(!t||!t.label){Fn("args.label is required in outboundLink()");return}var i={hitType:"event",eventCategory:"Outbound",eventAction:"Click",eventLabel:kh(t.label)},r=!1,s=function(){r=!0,e()},o=setTimeout(s,250),a=function(){clearTimeout(o),r||e()};i.hitCallback=a,Dv(i,n)}else setTimeout(e,0)}var iHe=CM;const rHe={initialize:xee,ga:ps,set:wee,send:Dv,pageview:_ee,modalview:bee,timing:See,event:Aee,exception:Mee,plugin:Eee,outboundLink:mN,testModeAPI:CM},sHe=Object.freeze(Object.defineProperty({__proto__:null,addTrackers:yee,default:rHe,event:Aee,exception:Mee,ga:ps,initialize:xee,modalview:bee,outboundLink:mN,pageview:_ee,plugin:Eee,send:Dv,set:wee,testModeAPI:iHe,timing:See},Symbol.toStringTag,{value:"Module"}));function s8(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function o8(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?s8(Object(n),!0).forEach(function(i){oHe(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s8(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function oHe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Vf.origTrackLink=Vf.trackLink;Vf.trackLink=mN;var aHe=Vf;const a8=o8(o8({},sHe),{},{OutboundLink:aHe}),lHe=()=>(a8.initialize("G-W0ER081JHJ"),ge.useEffect(()=>{a8.pageview(window.location.pathname+window.location.search)},[]),We.jsx(kre,{children:We.jsxs(Bre,{children:[We.jsx(gm,{index:!0,element:We.jsx(CGe,{})}),We.jsx(gm,{path:"/Tech",element:We.jsx(fye,{})}),We.jsx(gm,{path:"/About",element:We.jsx(DQ,{})}),We.jsx(gm,{path:"/Contact",element:We.jsx(kQ,{})}),We.jsx(gm,{path:"*",element:We.jsx(TGe,{})})]})}));RD.createRoot(document.getElementById("root")).render(We.jsx(du.StrictMode,{children:We.jsx(lHe,{})}))});export default cHe();
