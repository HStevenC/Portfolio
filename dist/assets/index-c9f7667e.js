var Cee=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var k4e=Cee((ho,fo)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var Tee=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function mM(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Pee(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function i(){if(this instanceof i){var r=[null];r.push.apply(r,arguments);var s=Function.bind.apply(e,r);return new s}return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}),n}var RW={exports:{}},gM={},LW={exports:{}},cn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hx=Symbol.for("react.element"),Dee=Symbol.for("react.portal"),Ree=Symbol.for("react.fragment"),Lee=Symbol.for("react.strict_mode"),Iee=Symbol.for("react.profiler"),Bee=Symbol.for("react.provider"),Oee=Symbol.for("react.context"),Fee=Symbol.for("react.forward_ref"),Nee=Symbol.for("react.suspense"),Uee=Symbol.for("react.memo"),kee=Symbol.for("react.lazy"),PU=Symbol.iterator;function zee(t){return t===null||typeof t!="object"?null:(t=PU&&t[PU]||t["@@iterator"],typeof t=="function"?t:null)}var IW={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},BW=Object.assign,OW={};function Kg(t,e,n){this.props=t,this.context=e,this.refs=OW,this.updater=n||IW}Kg.prototype.isReactComponent={};Kg.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Kg.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function FW(){}FW.prototype=Kg.prototype;function JI(t,e,n){this.props=t,this.context=e,this.refs=OW,this.updater=n||IW}var ZI=JI.prototype=new FW;ZI.constructor=JI;BW(ZI,Kg.prototype);ZI.isPureReactComponent=!0;var DU=Array.isArray,NW=Object.prototype.hasOwnProperty,$I={current:null},UW={key:!0,ref:!0,__self:!0,__source:!0};function kW(t,e,n){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)NW.call(e,i)&&!UW.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:Hx,type:t,key:s,ref:o,props:r,_owner:$I.current}}function Gee(t,e){return{$$typeof:Hx,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function e3(t){return typeof t=="object"&&t!==null&&t.$$typeof===Hx}function Hee(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var RU=/\/+/g;function YC(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Hee(""+t.key):e.toString(36)}function ZS(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Hx:case Dee:o=!0}}if(o)return o=t,r=r(o),t=i===""?"."+YC(o,0):i,DU(r)?(n="",t!=null&&(n=t.replace(RU,"$&/")+"/"),ZS(r,e,n,"",function(c){return c})):r!=null&&(e3(r)&&(r=Gee(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(RU,"$&/")+"/")+t)),e.push(r)),1;if(o=0,i=i===""?".":i+":",DU(t))for(var a=0;a<t.length;a++){s=t[a];var l=i+YC(s,a);o+=ZS(s,e,n,l,r)}else if(l=zee(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=i+YC(s,a++),o+=ZS(s,e,n,l,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function D_(t,e,n){if(t==null)return t;var i=[],r=0;return ZS(t,i,"","",function(s){return e.call(n,s,r++)}),i}function Vee(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ms={current:null},$S={transition:null},jee={ReactCurrentDispatcher:ms,ReactCurrentBatchConfig:$S,ReactCurrentOwner:$I};cn.Children={map:D_,forEach:function(t,e,n){D_(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return D_(t,function(){e++}),e},toArray:function(t){return D_(t,function(e){return e})||[]},only:function(t){if(!e3(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};cn.Component=Kg;cn.Fragment=Ree;cn.Profiler=Iee;cn.PureComponent=JI;cn.StrictMode=Lee;cn.Suspense=Nee;cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jee;cn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=BW({},t.props),r=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=$I.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)NW.call(e,l)&&!UW.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];i.children=a}return{$$typeof:Hx,type:t.type,key:r,ref:s,props:i,_owner:o}};cn.createContext=function(t){return t={$$typeof:Oee,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Bee,_context:t},t.Consumer=t};cn.createElement=kW;cn.createFactory=function(t){var e=kW.bind(null,t);return e.type=t,e};cn.createRef=function(){return{current:null}};cn.forwardRef=function(t){return{$$typeof:Fee,render:t}};cn.isValidElement=e3;cn.lazy=function(t){return{$$typeof:kee,_payload:{_status:-1,_result:t},_init:Vee}};cn.memo=function(t,e){return{$$typeof:Uee,type:t,compare:e===void 0?null:e}};cn.startTransition=function(t){var e=$S.transition;$S.transition={};try{t()}finally{$S.transition=e}};cn.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};cn.useCallback=function(t,e){return ms.current.useCallback(t,e)};cn.useContext=function(t){return ms.current.useContext(t)};cn.useDebugValue=function(){};cn.useDeferredValue=function(t){return ms.current.useDeferredValue(t)};cn.useEffect=function(t,e){return ms.current.useEffect(t,e)};cn.useId=function(){return ms.current.useId()};cn.useImperativeHandle=function(t,e,n){return ms.current.useImperativeHandle(t,e,n)};cn.useInsertionEffect=function(t,e){return ms.current.useInsertionEffect(t,e)};cn.useLayoutEffect=function(t,e){return ms.current.useLayoutEffect(t,e)};cn.useMemo=function(t,e){return ms.current.useMemo(t,e)};cn.useReducer=function(t,e,n){return ms.current.useReducer(t,e,n)};cn.useRef=function(t){return ms.current.useRef(t)};cn.useState=function(t){return ms.current.useState(t)};cn.useSyncExternalStore=function(t,e,n){return ms.current.useSyncExternalStore(t,e,n)};cn.useTransition=function(){return ms.current.useTransition()};cn.version="18.2.0";LW.exports=cn;var ge=LW.exports;const Wh=mM(ge);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wee=ge,Xee=Symbol.for("react.element"),Yee=Symbol.for("react.fragment"),qee=Object.prototype.hasOwnProperty,Qee=Wee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Kee={key:!0,ref:!0,__self:!0,__source:!0};function zW(t,e,n){var i,r={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)qee.call(e,i)&&!Kee.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:Xee,type:t,key:s,ref:o,props:r,_owner:Qee.current}}gM.Fragment=Yee;gM.jsx=zW;gM.jsxs=zW;RW.exports=gM;var We=RW.exports,gD={},GW={exports:{}},wo={},HW={exports:{}},VW={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(O,W){var H=O.length;O.push(W);e:for(;0<H;){var Y=H-1>>>1,z=O[Y];if(0<r(z,W))O[Y]=W,O[H]=z,H=Y;else break e}}function n(O){return O.length===0?null:O[0]}function i(O){if(O.length===0)return null;var W=O[0],H=O.pop();if(H!==W){O[0]=H;e:for(var Y=0,z=O.length,X=z>>>1;Y<X;){var q=2*(Y+1)-1,re=O[q],G=q+1,K=O[G];if(0>r(re,H))G<z&&0>r(K,re)?(O[Y]=K,O[G]=H,Y=G):(O[Y]=re,O[q]=H,Y=q);else if(G<z&&0>r(K,H))O[Y]=K,O[G]=H,Y=G;else break e}}return W}function r(O,W){var H=O.sortIndex-W.sortIndex;return H!==0?H:O.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,u=null,d=3,f=!1,p=!1,v=!1,g=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(O){for(var W=n(c);W!==null;){if(W.callback===null)i(c);else if(W.startTime<=O)i(c),W.sortIndex=W.expirationTime,e(l,W);else break;W=n(c)}}function S(O){if(v=!1,_(O),!p)if(n(l)!==null)p=!0,Z(A);else{var W=n(c);W!==null&&ee(S,W.startTime-O)}}function A(O,W){p=!1,v&&(v=!1,m(M),M=-1),f=!0;var H=d;try{for(_(W),u=n(l);u!==null&&(!(u.expirationTime>W)||O&&!R());){var Y=u.callback;if(typeof Y=="function"){u.callback=null,d=u.priorityLevel;var z=Y(u.expirationTime<=W);W=t.unstable_now(),typeof z=="function"?u.callback=z:u===n(l)&&i(l),_(W)}else i(l);u=n(l)}if(u!==null)var X=!0;else{var q=n(c);q!==null&&ee(S,q.startTime-W),X=!1}return X}finally{u=null,d=H,f=!1}}var b=!1,T=null,M=-1,E=5,P=-1;function R(){return!(t.unstable_now()-P<E)}function F(){if(T!==null){var O=t.unstable_now();P=O;var W=!0;try{W=T(!0,O)}finally{W?B():(b=!1,T=null)}}else b=!1}var B;if(typeof y=="function")B=function(){y(F)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,j=k.port2;k.port1.onmessage=F,B=function(){j.postMessage(null)}}else B=function(){g(F,0)};function Z(O){T=O,b||(b=!0,B())}function ee(O,W){M=g(function(){O(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,Z(A))},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(O){switch(d){case 1:case 2:case 3:var W=3;break;default:W=d}var H=d;d=W;try{return O()}finally{d=H}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(O,W){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var H=d;d=O;try{return W()}finally{d=H}},t.unstable_scheduleCallback=function(O,W,H){var Y=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?Y+H:Y):H=Y,O){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=H+z,O={id:h++,callback:W,priorityLevel:O,startTime:H,expirationTime:z,sortIndex:-1},H>Y?(O.sortIndex=H,e(c,O),n(l)===null&&O===n(c)&&(v?(m(M),M=-1):v=!0,ee(S,H-Y))):(O.sortIndex=z,e(l,O),p||f||(p=!0,Z(A))),O},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(O){var W=d;return function(){var H=d;d=W;try{return O.apply(this,arguments)}finally{d=H}}}})(VW);HW.exports=VW;var Jee=HW.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jW=ge,yo=Jee;function Je(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var WW=new Set,zy={};function Uf(t,e){yg(t,e),yg(t+"Capture",e)}function yg(t,e){for(zy[t]=e,t=0;t<e.length;t++)WW.add(e[t])}var Jc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),vD=Object.prototype.hasOwnProperty,Zee=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,LU={},IU={};function $ee(t){return vD.call(IU,t)?!0:vD.call(LU,t)?!1:Zee.test(t)?IU[t]=!0:(LU[t]=!0,!1)}function ete(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function tte(t,e,n,i){if(e===null||typeof e>"u"||ete(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function gs(t,e,n,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Br={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Br[t]=new gs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Br[e]=new gs(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Br[t]=new gs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Br[t]=new gs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Br[t]=new gs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Br[t]=new gs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Br[t]=new gs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Br[t]=new gs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Br[t]=new gs(t,5,!1,t.toLowerCase(),null,!1,!1)});var t3=/[\-:]([a-z])/g;function n3(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(t3,n3);Br[e]=new gs(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(t3,n3);Br[e]=new gs(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(t3,n3);Br[e]=new gs(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Br[t]=new gs(t,1,!1,t.toLowerCase(),null,!1,!1)});Br.xlinkHref=new gs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Br[t]=new gs(t,1,!1,t.toLowerCase(),null,!0,!0)});function i3(t,e,n,i){var r=Br.hasOwnProperty(e)?Br[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(tte(e,n,r,i)&&(n=null),i||r===null?$ee(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var lu=jW.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,R_=Symbol.for("react.element"),ym=Symbol.for("react.portal"),xm=Symbol.for("react.fragment"),r3=Symbol.for("react.strict_mode"),yD=Symbol.for("react.profiler"),XW=Symbol.for("react.provider"),YW=Symbol.for("react.context"),s3=Symbol.for("react.forward_ref"),xD=Symbol.for("react.suspense"),_D=Symbol.for("react.suspense_list"),o3=Symbol.for("react.memo"),Xu=Symbol.for("react.lazy"),qW=Symbol.for("react.offscreen"),BU=Symbol.iterator;function Gv(t){return t===null||typeof t!="object"?null:(t=BU&&t[BU]||t["@@iterator"],typeof t=="function"?t:null)}var di=Object.assign,qC;function j0(t){if(qC===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);qC=e&&e[1]||""}return`
`+qC+t}var QC=!1;function KC(t,e){if(!t||QC)return"";QC=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var i=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){i=c}t.call(e.prototype)}else{try{throw Error()}catch(c){i=c}t()}}catch(c){if(c&&i&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var l=`
`+r[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{QC=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?j0(t):""}function nte(t){switch(t.tag){case 5:return j0(t.type);case 16:return j0("Lazy");case 13:return j0("Suspense");case 19:return j0("SuspenseList");case 0:case 2:case 15:return t=KC(t.type,!1),t;case 11:return t=KC(t.type.render,!1),t;case 1:return t=KC(t.type,!0),t;default:return""}}function wD(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case xm:return"Fragment";case ym:return"Portal";case yD:return"Profiler";case r3:return"StrictMode";case xD:return"Suspense";case _D:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case YW:return(t.displayName||"Context")+".Consumer";case XW:return(t._context.displayName||"Context")+".Provider";case s3:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case o3:return e=t.displayName||null,e!==null?e:wD(t.type)||"Memo";case Xu:e=t._payload,t=t._init;try{return wD(t(e))}catch{}}return null}function ite(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return wD(e);case 8:return e===r3?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Bh(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function QW(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function rte(t){var e=QW(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function L_(t){t._valueTracker||(t._valueTracker=rte(t))}function KW(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=QW(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function Ob(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function SD(t,e){var n=e.checked;return di({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function OU(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=Bh(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function JW(t,e){e=e.checked,e!=null&&i3(t,"checked",e,!1)}function bD(t,e){JW(t,e);var n=Bh(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?AD(t,e.type,n):e.hasOwnProperty("defaultValue")&&AD(t,e.type,Bh(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function FU(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function AD(t,e,n){(e!=="number"||Ob(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var W0=Array.isArray;function qm(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+Bh(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function MD(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Je(91));return di({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function NU(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Je(92));if(W0(n)){if(1<n.length)throw Error(Je(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Bh(n)}}function ZW(t,e){var n=Bh(e.value),i=Bh(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function UU(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function $W(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ED(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?$W(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var I_,e8=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(I_=I_||document.createElement("div"),I_.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=I_.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Gy(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var sy={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ste=["Webkit","ms","Moz","O"];Object.keys(sy).forEach(function(t){ste.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),sy[e]=sy[t]})});function t8(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||sy.hasOwnProperty(t)&&sy[t]?(""+e).trim():e+"px"}function n8(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=t8(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var ote=di({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function CD(t,e){if(e){if(ote[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Je(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Je(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Je(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Je(62))}}function TD(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var PD=null;function a3(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var DD=null,Qm=null,Km=null;function kU(t){if(t=Wx(t)){if(typeof DD!="function")throw Error(Je(280));var e=t.stateNode;e&&(e=wM(e),DD(t.stateNode,t.type,e))}}function i8(t){Qm?Km?Km.push(t):Km=[t]:Qm=t}function r8(){if(Qm){var t=Qm,e=Km;if(Km=Qm=null,kU(t),e)for(t=0;t<e.length;t++)kU(e[t])}}function s8(t,e){return t(e)}function o8(){}var JC=!1;function a8(t,e,n){if(JC)return t(e,n);JC=!0;try{return s8(t,e,n)}finally{JC=!1,(Qm!==null||Km!==null)&&(o8(),r8())}}function Hy(t,e){var n=t.stateNode;if(n===null)return null;var i=wM(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Je(231,e,typeof n));return n}var RD=!1;if(Jc)try{var Hv={};Object.defineProperty(Hv,"passive",{get:function(){RD=!0}}),window.addEventListener("test",Hv,Hv),window.removeEventListener("test",Hv,Hv)}catch{RD=!1}function ate(t,e,n,i,r,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(h){this.onError(h)}}var oy=!1,Fb=null,Nb=!1,LD=null,lte={onError:function(t){oy=!0,Fb=t}};function cte(t,e,n,i,r,s,o,a,l){oy=!1,Fb=null,ate.apply(lte,arguments)}function ute(t,e,n,i,r,s,o,a,l){if(cte.apply(this,arguments),oy){if(oy){var c=Fb;oy=!1,Fb=null}else throw Error(Je(198));Nb||(Nb=!0,LD=c)}}function kf(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function l8(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function zU(t){if(kf(t)!==t)throw Error(Je(188))}function hte(t){var e=t.alternate;if(!e){if(e=kf(t),e===null)throw Error(Je(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return zU(r),t;if(s===i)return zU(r),e;s=s.sibling}throw Error(Je(188))}if(n.return!==i.return)n=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===n){o=!0,n=r,i=s;break}if(a===i){o=!0,i=r,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,i=r;break}if(a===i){o=!0,i=s,n=r;break}a=a.sibling}if(!o)throw Error(Je(189))}}if(n.alternate!==i)throw Error(Je(190))}if(n.tag!==3)throw Error(Je(188));return n.stateNode.current===n?t:e}function c8(t){return t=hte(t),t!==null?u8(t):null}function u8(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=u8(t);if(e!==null)return e;t=t.sibling}return null}var h8=yo.unstable_scheduleCallback,GU=yo.unstable_cancelCallback,dte=yo.unstable_shouldYield,fte=yo.unstable_requestPaint,Ti=yo.unstable_now,pte=yo.unstable_getCurrentPriorityLevel,l3=yo.unstable_ImmediatePriority,d8=yo.unstable_UserBlockingPriority,Ub=yo.unstable_NormalPriority,mte=yo.unstable_LowPriority,f8=yo.unstable_IdlePriority,vM=null,zl=null;function gte(t){if(zl&&typeof zl.onCommitFiberRoot=="function")try{zl.onCommitFiberRoot(vM,t,void 0,(t.current.flags&128)===128)}catch{}}var Ga=Math.clz32?Math.clz32:xte,vte=Math.log,yte=Math.LN2;function xte(t){return t>>>=0,t===0?32:31-(vte(t)/yte|0)|0}var B_=64,O_=4194304;function X0(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function kb(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~r;a!==0?i=X0(a):(s&=o,s!==0&&(i=X0(s)))}else o=n&~r,o!==0?i=X0(o):s!==0&&(i=X0(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-Ga(e),r=1<<n,i|=t[n],e&=~r;return i}function _te(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wte(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Ga(s),a=1<<o,l=r[o];l===-1?(!(a&n)||a&i)&&(r[o]=_te(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function ID(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function p8(){var t=B_;return B_<<=1,!(B_&4194240)&&(B_=64),t}function ZC(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Vx(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ga(e),t[e]=n}function Ste(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Ga(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}function c3(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-Ga(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var Ln=0;function m8(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var g8,u3,v8,y8,x8,BD=!1,F_=[],vh=null,yh=null,xh=null,Vy=new Map,jy=new Map,$u=[],bte="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function HU(t,e){switch(t){case"focusin":case"focusout":vh=null;break;case"dragenter":case"dragleave":yh=null;break;case"mouseover":case"mouseout":xh=null;break;case"pointerover":case"pointerout":Vy.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":jy.delete(e.pointerId)}}function Vv(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=Wx(e),e!==null&&u3(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function Ate(t,e,n,i,r){switch(e){case"focusin":return vh=Vv(vh,t,e,n,i,r),!0;case"dragenter":return yh=Vv(yh,t,e,n,i,r),!0;case"mouseover":return xh=Vv(xh,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return Vy.set(s,Vv(Vy.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,jy.set(s,Vv(jy.get(s)||null,t,e,n,i,r)),!0}return!1}function _8(t){var e=Yd(t.target);if(e!==null){var n=kf(e);if(n!==null){if(e=n.tag,e===13){if(e=l8(n),e!==null){t.blockedOn=e,x8(t.priority,function(){v8(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function eb(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=OD(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);PD=i,n.target.dispatchEvent(i),PD=null}else return e=Wx(n),e!==null&&u3(e),t.blockedOn=n,!1;e.shift()}return!0}function VU(t,e,n){eb(t)&&n.delete(e)}function Mte(){BD=!1,vh!==null&&eb(vh)&&(vh=null),yh!==null&&eb(yh)&&(yh=null),xh!==null&&eb(xh)&&(xh=null),Vy.forEach(VU),jy.forEach(VU)}function jv(t,e){t.blockedOn===e&&(t.blockedOn=null,BD||(BD=!0,yo.unstable_scheduleCallback(yo.unstable_NormalPriority,Mte)))}function Wy(t){function e(r){return jv(r,t)}if(0<F_.length){jv(F_[0],t);for(var n=1;n<F_.length;n++){var i=F_[n];i.blockedOn===t&&(i.blockedOn=null)}}for(vh!==null&&jv(vh,t),yh!==null&&jv(yh,t),xh!==null&&jv(xh,t),Vy.forEach(e),jy.forEach(e),n=0;n<$u.length;n++)i=$u[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<$u.length&&(n=$u[0],n.blockedOn===null);)_8(n),n.blockedOn===null&&$u.shift()}var Jm=lu.ReactCurrentBatchConfig,zb=!0;function Ete(t,e,n,i){var r=Ln,s=Jm.transition;Jm.transition=null;try{Ln=1,h3(t,e,n,i)}finally{Ln=r,Jm.transition=s}}function Cte(t,e,n,i){var r=Ln,s=Jm.transition;Jm.transition=null;try{Ln=4,h3(t,e,n,i)}finally{Ln=r,Jm.transition=s}}function h3(t,e,n,i){if(zb){var r=OD(t,e,n,i);if(r===null)lT(t,e,i,Gb,n),HU(t,i);else if(Ate(r,t,e,n,i))i.stopPropagation();else if(HU(t,i),e&4&&-1<bte.indexOf(t)){for(;r!==null;){var s=Wx(r);if(s!==null&&g8(s),s=OD(t,e,n,i),s===null&&lT(t,e,i,Gb,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else lT(t,e,i,null,n)}}var Gb=null;function OD(t,e,n,i){if(Gb=null,t=a3(i),t=Yd(t),t!==null)if(e=kf(t),e===null)t=null;else if(n=e.tag,n===13){if(t=l8(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Gb=t,null}function w8(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pte()){case l3:return 1;case d8:return 4;case Ub:case mte:return 16;case f8:return 536870912;default:return 16}default:return 16}}var rh=null,d3=null,tb=null;function S8(){if(tb)return tb;var t,e=d3,n=e.length,i,r="value"in rh?rh.value:rh.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(i=1;i<=o&&e[n-i]===r[s-i];i++);return tb=r.slice(t,1<i?1-i:void 0)}function nb(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function N_(){return!0}function jU(){return!1}function So(t){function e(n,i,r,s,o){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?N_:jU,this.isPropagationStopped=jU,this}return di(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=N_)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=N_)},persist:function(){},isPersistent:N_}),e}var Jg={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},f3=So(Jg),jx=di({},Jg,{view:0,detail:0}),Tte=So(jx),$C,eT,Wv,yM=di({},jx,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:p3,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Wv&&(Wv&&t.type==="mousemove"?($C=t.screenX-Wv.screenX,eT=t.screenY-Wv.screenY):eT=$C=0,Wv=t),$C)},movementY:function(t){return"movementY"in t?t.movementY:eT}}),WU=So(yM),Pte=di({},yM,{dataTransfer:0}),Dte=So(Pte),Rte=di({},jx,{relatedTarget:0}),tT=So(Rte),Lte=di({},Jg,{animationName:0,elapsedTime:0,pseudoElement:0}),Ite=So(Lte),Bte=di({},Jg,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Ote=So(Bte),Fte=di({},Jg,{data:0}),XU=So(Fte),Nte={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ute={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kte={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zte(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=kte[t])?!!e[t]:!1}function p3(){return zte}var Gte=di({},jx,{key:function(t){if(t.key){var e=Nte[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=nb(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Ute[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:p3,charCode:function(t){return t.type==="keypress"?nb(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?nb(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Hte=So(Gte),Vte=di({},yM,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),YU=So(Vte),jte=di({},jx,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:p3}),Wte=So(jte),Xte=di({},Jg,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yte=So(Xte),qte=di({},yM,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Qte=So(qte),Kte=[9,13,27,32],m3=Jc&&"CompositionEvent"in window,ay=null;Jc&&"documentMode"in document&&(ay=document.documentMode);var Jte=Jc&&"TextEvent"in window&&!ay,b8=Jc&&(!m3||ay&&8<ay&&11>=ay),qU=String.fromCharCode(32),QU=!1;function A8(t,e){switch(t){case"keyup":return Kte.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function M8(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var _m=!1;function Zte(t,e){switch(t){case"compositionend":return M8(e);case"keypress":return e.which!==32?null:(QU=!0,qU);case"textInput":return t=e.data,t===qU&&QU?null:t;default:return null}}function $te(t,e){if(_m)return t==="compositionend"||!m3&&A8(t,e)?(t=S8(),tb=d3=rh=null,_m=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return b8&&e.locale!=="ko"?null:e.data;default:return null}}var ene={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function KU(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!ene[t.type]:e==="textarea"}function E8(t,e,n,i){i8(i),e=Hb(e,"onChange"),0<e.length&&(n=new f3("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var ly=null,Xy=null;function tne(t){N8(t,0)}function xM(t){var e=bm(t);if(KW(e))return t}function nne(t,e){if(t==="change")return e}var C8=!1;if(Jc){var nT;if(Jc){var iT="oninput"in document;if(!iT){var JU=document.createElement("div");JU.setAttribute("oninput","return;"),iT=typeof JU.oninput=="function"}nT=iT}else nT=!1;C8=nT&&(!document.documentMode||9<document.documentMode)}function ZU(){ly&&(ly.detachEvent("onpropertychange",T8),Xy=ly=null)}function T8(t){if(t.propertyName==="value"&&xM(Xy)){var e=[];E8(e,Xy,t,a3(t)),a8(tne,e)}}function ine(t,e,n){t==="focusin"?(ZU(),ly=e,Xy=n,ly.attachEvent("onpropertychange",T8)):t==="focusout"&&ZU()}function rne(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return xM(Xy)}function sne(t,e){if(t==="click")return xM(e)}function one(t,e){if(t==="input"||t==="change")return xM(e)}function ane(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Xa=typeof Object.is=="function"?Object.is:ane;function Yy(t,e){if(Xa(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!vD.call(e,r)||!Xa(t[r],e[r]))return!1}return!0}function $U(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ek(t,e){var n=$U(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=$U(n)}}function P8(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?P8(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function D8(){for(var t=window,e=Ob();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ob(t.document)}return e}function g3(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function lne(t){var e=D8(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&P8(n.ownerDocument.documentElement,n)){if(i!==null&&g3(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=ek(n,s);var o=ek(n,i);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var cne=Jc&&"documentMode"in document&&11>=document.documentMode,wm=null,FD=null,cy=null,ND=!1;function tk(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ND||wm==null||wm!==Ob(i)||(i=wm,"selectionStart"in i&&g3(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),cy&&Yy(cy,i)||(cy=i,i=Hb(FD,"onSelect"),0<i.length&&(e=new f3("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=wm)))}function U_(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Sm={animationend:U_("Animation","AnimationEnd"),animationiteration:U_("Animation","AnimationIteration"),animationstart:U_("Animation","AnimationStart"),transitionend:U_("Transition","TransitionEnd")},rT={},R8={};Jc&&(R8=document.createElement("div").style,"AnimationEvent"in window||(delete Sm.animationend.animation,delete Sm.animationiteration.animation,delete Sm.animationstart.animation),"TransitionEvent"in window||delete Sm.transitionend.transition);function _M(t){if(rT[t])return rT[t];if(!Sm[t])return t;var e=Sm[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in R8)return rT[t]=e[n];return t}var L8=_M("animationend"),I8=_M("animationiteration"),B8=_M("animationstart"),O8=_M("transitionend"),F8=new Map,nk="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xh(t,e){F8.set(t,e),Uf(e,[t])}for(var sT=0;sT<nk.length;sT++){var oT=nk[sT],une=oT.toLowerCase(),hne=oT[0].toUpperCase()+oT.slice(1);Xh(une,"on"+hne)}Xh(L8,"onAnimationEnd");Xh(I8,"onAnimationIteration");Xh(B8,"onAnimationStart");Xh("dblclick","onDoubleClick");Xh("focusin","onFocus");Xh("focusout","onBlur");Xh(O8,"onTransitionEnd");yg("onMouseEnter",["mouseout","mouseover"]);yg("onMouseLeave",["mouseout","mouseover"]);yg("onPointerEnter",["pointerout","pointerover"]);yg("onPointerLeave",["pointerout","pointerover"]);Uf("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Uf("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Uf("onBeforeInput",["compositionend","keypress","textInput","paste"]);Uf("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Uf("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Uf("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Y0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dne=new Set("cancel close invalid load scroll toggle".split(" ").concat(Y0));function ik(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,ute(i,e,void 0,t),t.currentTarget=null}function N8(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&r.isPropagationStopped())break e;ik(r,a,c),s=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&r.isPropagationStopped())break e;ik(r,a,c),s=l}}}if(Nb)throw t=LD,Nb=!1,LD=null,t}function Xn(t,e){var n=e[HD];n===void 0&&(n=e[HD]=new Set);var i=t+"__bubble";n.has(i)||(U8(e,t,2,!1),n.add(i))}function aT(t,e,n){var i=0;e&&(i|=4),U8(n,t,i,e)}var k_="_reactListening"+Math.random().toString(36).slice(2);function qy(t){if(!t[k_]){t[k_]=!0,WW.forEach(function(n){n!=="selectionchange"&&(dne.has(n)||aT(n,!1,t),aT(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[k_]||(e[k_]=!0,aT("selectionchange",!1,e))}}function U8(t,e,n,i){switch(w8(e)){case 1:var r=Ete;break;case 4:r=Cte;break;default:r=h3}n=r.bind(null,e,n,t),r=void 0,!RD||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function lT(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;o=o.return}for(;a!==null;){if(o=Yd(a),o===null)return;if(l=o.tag,l===5||l===6){i=s=o;continue e}a=a.parentNode}}i=i.return}a8(function(){var c=s,h=a3(n),u=[];e:{var d=F8.get(t);if(d!==void 0){var f=f3,p=t;switch(t){case"keypress":if(nb(n)===0)break e;case"keydown":case"keyup":f=Hte;break;case"focusin":p="focus",f=tT;break;case"focusout":p="blur",f=tT;break;case"beforeblur":case"afterblur":f=tT;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=WU;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=Dte;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=Wte;break;case L8:case I8:case B8:f=Ite;break;case O8:f=Yte;break;case"scroll":f=Tte;break;case"wheel":f=Qte;break;case"copy":case"cut":case"paste":f=Ote;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=YU}var v=(e&4)!==0,g=!v&&t==="scroll",m=v?d!==null?d+"Capture":null:d;v=[];for(var y=c,_;y!==null;){_=y;var S=_.stateNode;if(_.tag===5&&S!==null&&(_=S,m!==null&&(S=Hy(y,m),S!=null&&v.push(Qy(y,S,_)))),g)break;y=y.return}0<v.length&&(d=new f(d,p,null,n,h),u.push({event:d,listeners:v}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",d&&n!==PD&&(p=n.relatedTarget||n.fromElement)&&(Yd(p)||p[Zc]))break e;if((f||d)&&(d=h.window===h?h:(d=h.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=c,p=p?Yd(p):null,p!==null&&(g=kf(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(v=WU,S="onMouseLeave",m="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(v=YU,S="onPointerLeave",m="onPointerEnter",y="pointer"),g=f==null?d:bm(f),_=p==null?d:bm(p),d=new v(S,y+"leave",f,n,h),d.target=g,d.relatedTarget=_,S=null,Yd(h)===c&&(v=new v(m,y+"enter",p,n,h),v.target=_,v.relatedTarget=g,S=v),g=S,f&&p)t:{for(v=f,m=p,y=0,_=v;_;_=hp(_))y++;for(_=0,S=m;S;S=hp(S))_++;for(;0<y-_;)v=hp(v),y--;for(;0<_-y;)m=hp(m),_--;for(;y--;){if(v===m||m!==null&&v===m.alternate)break t;v=hp(v),m=hp(m)}v=null}else v=null;f!==null&&rk(u,d,f,v,!1),p!==null&&g!==null&&rk(u,g,p,v,!0)}}e:{if(d=c?bm(c):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var A=nne;else if(KU(d))if(C8)A=one;else{A=rne;var b=ine}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(A=sne);if(A&&(A=A(t,c))){E8(u,A,n,h);break e}b&&b(t,d,c),t==="focusout"&&(b=d._wrapperState)&&b.controlled&&d.type==="number"&&AD(d,"number",d.value)}switch(b=c?bm(c):window,t){case"focusin":(KU(b)||b.contentEditable==="true")&&(wm=b,FD=c,cy=null);break;case"focusout":cy=FD=wm=null;break;case"mousedown":ND=!0;break;case"contextmenu":case"mouseup":case"dragend":ND=!1,tk(u,n,h);break;case"selectionchange":if(cne)break;case"keydown":case"keyup":tk(u,n,h)}var T;if(m3)e:{switch(t){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else _m?A8(t,n)&&(M="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(b8&&n.locale!=="ko"&&(_m||M!=="onCompositionStart"?M==="onCompositionEnd"&&_m&&(T=S8()):(rh=h,d3="value"in rh?rh.value:rh.textContent,_m=!0)),b=Hb(c,M),0<b.length&&(M=new XU(M,t,null,n,h),u.push({event:M,listeners:b}),T?M.data=T:(T=M8(n),T!==null&&(M.data=T)))),(T=Jte?Zte(t,n):$te(t,n))&&(c=Hb(c,"onBeforeInput"),0<c.length&&(h=new XU("onBeforeInput","beforeinput",null,n,h),u.push({event:h,listeners:c}),h.data=T))}N8(u,e)})}function Qy(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Hb(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=Hy(t,n),s!=null&&i.unshift(Qy(t,s,r)),s=Hy(t,e),s!=null&&i.push(Qy(t,s,r))),t=t.return}return i}function hp(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function rk(t,e,n,i,r){for(var s=e._reactName,o=[];n!==null&&n!==i;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&c!==null&&(a=c,r?(l=Hy(n,s),l!=null&&o.unshift(Qy(n,l,a))):r||(l=Hy(n,s),l!=null&&o.push(Qy(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var fne=/\r\n?/g,pne=/\u0000|\uFFFD/g;function sk(t){return(typeof t=="string"?t:""+t).replace(fne,`
`).replace(pne,"")}function z_(t,e,n){if(e=sk(e),sk(t)!==e&&n)throw Error(Je(425))}function Vb(){}var UD=null,kD=null;function zD(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var GD=typeof setTimeout=="function"?setTimeout:void 0,mne=typeof clearTimeout=="function"?clearTimeout:void 0,ok=typeof Promise=="function"?Promise:void 0,gne=typeof queueMicrotask=="function"?queueMicrotask:typeof ok<"u"?function(t){return ok.resolve(null).then(t).catch(vne)}:GD;function vne(t){setTimeout(function(){throw t})}function cT(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),Wy(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);Wy(e)}function _h(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function ak(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Zg=Math.random().toString(36).slice(2),Rl="__reactFiber$"+Zg,Ky="__reactProps$"+Zg,Zc="__reactContainer$"+Zg,HD="__reactEvents$"+Zg,yne="__reactListeners$"+Zg,xne="__reactHandles$"+Zg;function Yd(t){var e=t[Rl];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Zc]||n[Rl]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=ak(t);t!==null;){if(n=t[Rl])return n;t=ak(t)}return e}t=n,n=t.parentNode}return null}function Wx(t){return t=t[Rl]||t[Zc],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function bm(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Je(33))}function wM(t){return t[Ky]||null}var VD=[],Am=-1;function Yh(t){return{current:t}}function Kn(t){0>Am||(t.current=VD[Am],VD[Am]=null,Am--)}function Vn(t,e){Am++,VD[Am]=t.current,t.current=e}var Oh={},Qr=Yh(Oh),Is=Yh(!1),wf=Oh;function xg(t,e){var n=t.type.contextTypes;if(!n)return Oh;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=e[s];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Bs(t){return t=t.childContextTypes,t!=null}function jb(){Kn(Is),Kn(Qr)}function lk(t,e,n){if(Qr.current!==Oh)throw Error(Je(168));Vn(Qr,e),Vn(Is,n)}function k8(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(Je(108,ite(t)||"Unknown",r));return di({},n,i)}function Wb(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Oh,wf=Qr.current,Vn(Qr,t),Vn(Is,Is.current),!0}function ck(t,e,n){var i=t.stateNode;if(!i)throw Error(Je(169));n?(t=k8(t,e,wf),i.__reactInternalMemoizedMergedChildContext=t,Kn(Is),Kn(Qr),Vn(Qr,t)):Kn(Is),Vn(Is,n)}var Ic=null,SM=!1,uT=!1;function z8(t){Ic===null?Ic=[t]:Ic.push(t)}function _ne(t){SM=!0,z8(t)}function qh(){if(!uT&&Ic!==null){uT=!0;var t=0,e=Ln;try{var n=Ic;for(Ln=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}Ic=null,SM=!1}catch(r){throw Ic!==null&&(Ic=Ic.slice(t+1)),h8(l3,qh),r}finally{Ln=e,uT=!1}}return null}var Mm=[],Em=0,Xb=null,Yb=0,Qo=[],Ko=0,Sf=null,Fc=1,Nc="";function Pd(t,e){Mm[Em++]=Yb,Mm[Em++]=Xb,Xb=t,Yb=e}function G8(t,e,n){Qo[Ko++]=Fc,Qo[Ko++]=Nc,Qo[Ko++]=Sf,Sf=t;var i=Fc;t=Nc;var r=32-Ga(i)-1;i&=~(1<<r),n+=1;var s=32-Ga(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,Fc=1<<32-Ga(e)+r|n<<r|i,Nc=s+t}else Fc=1<<s|n<<r|i,Nc=t}function v3(t){t.return!==null&&(Pd(t,1),G8(t,1,0))}function y3(t){for(;t===Xb;)Xb=Mm[--Em],Mm[Em]=null,Yb=Mm[--Em],Mm[Em]=null;for(;t===Sf;)Sf=Qo[--Ko],Qo[Ko]=null,Nc=Qo[--Ko],Qo[Ko]=null,Fc=Qo[--Ko],Qo[Ko]=null}var po=null,io=null,ti=!1,Ba=null;function H8(t,e){var n=ta(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function uk(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,po=t,io=_h(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,po=t,io=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Sf!==null?{id:Fc,overflow:Nc}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ta(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,po=t,io=null,!0):!1;default:return!1}}function jD(t){return(t.mode&1)!==0&&(t.flags&128)===0}function WD(t){if(ti){var e=io;if(e){var n=e;if(!uk(t,e)){if(jD(t))throw Error(Je(418));e=_h(n.nextSibling);var i=po;e&&uk(t,e)?H8(i,n):(t.flags=t.flags&-4097|2,ti=!1,po=t)}}else{if(jD(t))throw Error(Je(418));t.flags=t.flags&-4097|2,ti=!1,po=t}}}function hk(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;po=t}function G_(t){if(t!==po)return!1;if(!ti)return hk(t),ti=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!zD(t.type,t.memoizedProps)),e&&(e=io)){if(jD(t))throw V8(),Error(Je(418));for(;e;)H8(t,e),e=_h(e.nextSibling)}if(hk(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Je(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){io=_h(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}io=null}}else io=po?_h(t.stateNode.nextSibling):null;return!0}function V8(){for(var t=io;t;)t=_h(t.nextSibling)}function _g(){io=po=null,ti=!1}function x3(t){Ba===null?Ba=[t]:Ba.push(t)}var wne=lu.ReactCurrentBatchConfig;function Ra(t,e){if(t&&t.defaultProps){e=di({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var qb=Yh(null),Qb=null,Cm=null,_3=null;function w3(){_3=Cm=Qb=null}function S3(t){var e=qb.current;Kn(qb),t._currentValue=e}function XD(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function Zm(t,e){Qb=t,_3=Cm=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ds=!0),t.firstContext=null)}function oa(t){var e=t._currentValue;if(_3!==t)if(t={context:t,memoizedValue:e,next:null},Cm===null){if(Qb===null)throw Error(Je(308));Cm=t,Qb.dependencies={lanes:0,firstContext:t}}else Cm=Cm.next=t;return e}var qd=null;function b3(t){qd===null?qd=[t]:qd.push(t)}function j8(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,b3(e)):(n.next=r.next,r.next=n),e.interleaved=n,$c(t,i)}function $c(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Yu=!1;function A3(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function W8(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function jc(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function wh(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,gn&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,$c(t,n)}return r=i.interleaved,r===null?(e.next=e,b3(i)):(e.next=r.next,r.next=e),i.interleaved=e,$c(t,n)}function ib(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,c3(t,n)}}function dk(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Kb(t,e,n,i){var r=t.updateQueue;Yu=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=c:a.next=c,h.lastBaseUpdate=l))}if(s!==null){var u=r.baseState;o=0,h=c=l=null,a=s;do{var d=a.lane,f=a.eventTime;if((i&d)===d){h!==null&&(h=h.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,v=a;switch(d=e,f=n,v.tag){case 1:if(p=v.payload,typeof p=="function"){u=p.call(f,u,d);break e}u=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=v.payload,d=typeof p=="function"?p.call(f,u,d):p,d==null)break e;u=di({},u,d);break e;case 2:Yu=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,d=r.effects,d===null?r.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(c=h=f,l=u):h=h.next=f,o|=d;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;d=a,a=d.next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}while(1);if(h===null&&(l=u),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=h,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Af|=o,t.lanes=o,t.memoizedState=u}}function fk(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(Je(191,r));r.call(i)}}}var X8=new jW.Component().refs;function YD(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:di({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var bM={isMounted:function(t){return(t=t._reactInternals)?kf(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=ds(),r=bh(t),s=jc(i,r);s.payload=e,n!=null&&(s.callback=n),e=wh(t,s,r),e!==null&&(Ha(e,t,r,i),ib(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=ds(),r=bh(t),s=jc(i,r);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=wh(t,s,r),e!==null&&(Ha(e,t,r,i),ib(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ds(),i=bh(t),r=jc(n,i);r.tag=2,e!=null&&(r.callback=e),e=wh(t,r,i),e!==null&&(Ha(e,t,i,n),ib(e,t,i))}};function pk(t,e,n,i,r,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!Yy(n,i)||!Yy(r,s):!0}function Y8(t,e,n){var i=!1,r=Oh,s=e.contextType;return typeof s=="object"&&s!==null?s=oa(s):(r=Bs(e)?wf:Qr.current,i=e.contextTypes,s=(i=i!=null)?xg(t,r):Oh),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=bM,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function mk(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&bM.enqueueReplaceState(e,e.state,null)}function qD(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=X8,A3(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=oa(s):(s=Bs(e)?wf:Qr.current,r.context=xg(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(YD(t,e,s,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&bM.enqueueReplaceState(r,r.state,null),Kb(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Xv(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Je(309));var i=n.stateNode}if(!i)throw Error(Je(147,t));var r=i,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;a===X8&&(a=r.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Je(284));if(!n._owner)throw Error(Je(290,t))}return t}function H_(t,e){throw t=Object.prototype.toString.call(e),Error(Je(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function gk(t){var e=t._init;return e(t._payload)}function q8(t){function e(m,y){if(t){var _=m.deletions;_===null?(m.deletions=[y],m.flags|=16):_.push(y)}}function n(m,y){if(!t)return null;for(;y!==null;)e(m,y),y=y.sibling;return null}function i(m,y){for(m=new Map;y!==null;)y.key!==null?m.set(y.key,y):m.set(y.index,y),y=y.sibling;return m}function r(m,y){return m=Ah(m,y),m.index=0,m.sibling=null,m}function s(m,y,_){return m.index=_,t?(_=m.alternate,_!==null?(_=_.index,_<y?(m.flags|=2,y):_):(m.flags|=2,y)):(m.flags|=1048576,y)}function o(m){return t&&m.alternate===null&&(m.flags|=2),m}function a(m,y,_,S){return y===null||y.tag!==6?(y=vT(_,m.mode,S),y.return=m,y):(y=r(y,_),y.return=m,y)}function l(m,y,_,S){var A=_.type;return A===xm?h(m,y,_.props.children,S,_.key):y!==null&&(y.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Xu&&gk(A)===y.type)?(S=r(y,_.props),S.ref=Xv(m,y,_),S.return=m,S):(S=cb(_.type,_.key,_.props,null,m.mode,S),S.ref=Xv(m,y,_),S.return=m,S)}function c(m,y,_,S){return y===null||y.tag!==4||y.stateNode.containerInfo!==_.containerInfo||y.stateNode.implementation!==_.implementation?(y=yT(_,m.mode,S),y.return=m,y):(y=r(y,_.children||[]),y.return=m,y)}function h(m,y,_,S,A){return y===null||y.tag!==7?(y=of(_,m.mode,S,A),y.return=m,y):(y=r(y,_),y.return=m,y)}function u(m,y,_){if(typeof y=="string"&&y!==""||typeof y=="number")return y=vT(""+y,m.mode,_),y.return=m,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case R_:return _=cb(y.type,y.key,y.props,null,m.mode,_),_.ref=Xv(m,null,y),_.return=m,_;case ym:return y=yT(y,m.mode,_),y.return=m,y;case Xu:var S=y._init;return u(m,S(y._payload),_)}if(W0(y)||Gv(y))return y=of(y,m.mode,_,null),y.return=m,y;H_(m,y)}return null}function d(m,y,_,S){var A=y!==null?y.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return A!==null?null:a(m,y,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case R_:return _.key===A?l(m,y,_,S):null;case ym:return _.key===A?c(m,y,_,S):null;case Xu:return A=_._init,d(m,y,A(_._payload),S)}if(W0(_)||Gv(_))return A!==null?null:h(m,y,_,S,null);H_(m,_)}return null}function f(m,y,_,S,A){if(typeof S=="string"&&S!==""||typeof S=="number")return m=m.get(_)||null,a(y,m,""+S,A);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case R_:return m=m.get(S.key===null?_:S.key)||null,l(y,m,S,A);case ym:return m=m.get(S.key===null?_:S.key)||null,c(y,m,S,A);case Xu:var b=S._init;return f(m,y,_,b(S._payload),A)}if(W0(S)||Gv(S))return m=m.get(_)||null,h(y,m,S,A,null);H_(y,S)}return null}function p(m,y,_,S){for(var A=null,b=null,T=y,M=y=0,E=null;T!==null&&M<_.length;M++){T.index>M?(E=T,T=null):E=T.sibling;var P=d(m,T,_[M],S);if(P===null){T===null&&(T=E);break}t&&T&&P.alternate===null&&e(m,T),y=s(P,y,M),b===null?A=P:b.sibling=P,b=P,T=E}if(M===_.length)return n(m,T),ti&&Pd(m,M),A;if(T===null){for(;M<_.length;M++)T=u(m,_[M],S),T!==null&&(y=s(T,y,M),b===null?A=T:b.sibling=T,b=T);return ti&&Pd(m,M),A}for(T=i(m,T);M<_.length;M++)E=f(T,m,M,_[M],S),E!==null&&(t&&E.alternate!==null&&T.delete(E.key===null?M:E.key),y=s(E,y,M),b===null?A=E:b.sibling=E,b=E);return t&&T.forEach(function(R){return e(m,R)}),ti&&Pd(m,M),A}function v(m,y,_,S){var A=Gv(_);if(typeof A!="function")throw Error(Je(150));if(_=A.call(_),_==null)throw Error(Je(151));for(var b=A=null,T=y,M=y=0,E=null,P=_.next();T!==null&&!P.done;M++,P=_.next()){T.index>M?(E=T,T=null):E=T.sibling;var R=d(m,T,P.value,S);if(R===null){T===null&&(T=E);break}t&&T&&R.alternate===null&&e(m,T),y=s(R,y,M),b===null?A=R:b.sibling=R,b=R,T=E}if(P.done)return n(m,T),ti&&Pd(m,M),A;if(T===null){for(;!P.done;M++,P=_.next())P=u(m,P.value,S),P!==null&&(y=s(P,y,M),b===null?A=P:b.sibling=P,b=P);return ti&&Pd(m,M),A}for(T=i(m,T);!P.done;M++,P=_.next())P=f(T,m,M,P.value,S),P!==null&&(t&&P.alternate!==null&&T.delete(P.key===null?M:P.key),y=s(P,y,M),b===null?A=P:b.sibling=P,b=P);return t&&T.forEach(function(F){return e(m,F)}),ti&&Pd(m,M),A}function g(m,y,_,S){if(typeof _=="object"&&_!==null&&_.type===xm&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case R_:e:{for(var A=_.key,b=y;b!==null;){if(b.key===A){if(A=_.type,A===xm){if(b.tag===7){n(m,b.sibling),y=r(b,_.props.children),y.return=m,m=y;break e}}else if(b.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Xu&&gk(A)===b.type){n(m,b.sibling),y=r(b,_.props),y.ref=Xv(m,b,_),y.return=m,m=y;break e}n(m,b);break}else e(m,b);b=b.sibling}_.type===xm?(y=of(_.props.children,m.mode,S,_.key),y.return=m,m=y):(S=cb(_.type,_.key,_.props,null,m.mode,S),S.ref=Xv(m,y,_),S.return=m,m=S)}return o(m);case ym:e:{for(b=_.key;y!==null;){if(y.key===b)if(y.tag===4&&y.stateNode.containerInfo===_.containerInfo&&y.stateNode.implementation===_.implementation){n(m,y.sibling),y=r(y,_.children||[]),y.return=m,m=y;break e}else{n(m,y);break}else e(m,y);y=y.sibling}y=yT(_,m.mode,S),y.return=m,m=y}return o(m);case Xu:return b=_._init,g(m,y,b(_._payload),S)}if(W0(_))return p(m,y,_,S);if(Gv(_))return v(m,y,_,S);H_(m,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,y!==null&&y.tag===6?(n(m,y.sibling),y=r(y,_),y.return=m,m=y):(n(m,y),y=vT(_,m.mode,S),y.return=m,m=y),o(m)):n(m,y)}return g}var wg=q8(!0),Q8=q8(!1),Xx={},Gl=Yh(Xx),Jy=Yh(Xx),Zy=Yh(Xx);function Qd(t){if(t===Xx)throw Error(Je(174));return t}function M3(t,e){switch(Vn(Zy,e),Vn(Jy,t),Vn(Gl,Xx),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ED(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=ED(e,t)}Kn(Gl),Vn(Gl,e)}function Sg(){Kn(Gl),Kn(Jy),Kn(Zy)}function K8(t){Qd(Zy.current);var e=Qd(Gl.current),n=ED(e,t.type);e!==n&&(Vn(Jy,t),Vn(Gl,n))}function E3(t){Jy.current===t&&(Kn(Gl),Kn(Jy))}var ri=Yh(0);function Jb(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var hT=[];function C3(){for(var t=0;t<hT.length;t++)hT[t]._workInProgressVersionPrimary=null;hT.length=0}var rb=lu.ReactCurrentDispatcher,dT=lu.ReactCurrentBatchConfig,bf=0,hi=null,Qi=null,pr=null,Zb=!1,uy=!1,$y=0,Sne=0;function kr(){throw Error(Je(321))}function T3(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Xa(t[n],e[n]))return!1;return!0}function P3(t,e,n,i,r,s){if(bf=s,hi=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,rb.current=t===null||t.memoizedState===null?Ene:Cne,t=n(i,r),uy){s=0;do{if(uy=!1,$y=0,25<=s)throw Error(Je(301));s+=1,pr=Qi=null,e.updateQueue=null,rb.current=Tne,t=n(i,r)}while(uy)}if(rb.current=$b,e=Qi!==null&&Qi.next!==null,bf=0,pr=Qi=hi=null,Zb=!1,e)throw Error(Je(300));return t}function D3(){var t=$y!==0;return $y=0,t}function El(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pr===null?hi.memoizedState=pr=t:pr=pr.next=t,pr}function aa(){if(Qi===null){var t=hi.alternate;t=t!==null?t.memoizedState:null}else t=Qi.next;var e=pr===null?hi.memoizedState:pr.next;if(e!==null)pr=e,Qi=t;else{if(t===null)throw Error(Je(310));Qi=t,t={memoizedState:Qi.memoizedState,baseState:Qi.baseState,baseQueue:Qi.baseQueue,queue:Qi.queue,next:null},pr===null?hi.memoizedState=pr=t:pr=pr.next=t}return pr}function ex(t,e){return typeof e=="function"?e(t):e}function fT(t){var e=aa(),n=e.queue;if(n===null)throw Error(Je(311));n.lastRenderedReducer=t;var i=Qi,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,l=null,c=s;do{var h=c.lane;if((bf&h)===h)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:t(i,c.action);else{var u={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=u,o=i):l=l.next=u,hi.lanes|=h,Af|=h}c=c.next}while(c!==null&&c!==s);l===null?o=i:l.next=a,Xa(i,e.memoizedState)||(Ds=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do s=r.lane,hi.lanes|=s,Af|=s,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function pT(t){var e=aa(),n=e.queue;if(n===null)throw Error(Je(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do s=t(s,o.action),o=o.next;while(o!==r);Xa(s,e.memoizedState)||(Ds=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function J8(){}function Z8(t,e){var n=hi,i=aa(),r=e(),s=!Xa(i.memoizedState,r);if(s&&(i.memoizedState=r,Ds=!0),i=i.queue,R3(t9.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||pr!==null&&pr.memoizedState.tag&1){if(n.flags|=2048,tx(9,e9.bind(null,n,i,r,e),void 0,null),yr===null)throw Error(Je(349));bf&30||$8(n,e,r)}return r}function $8(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=hi.updateQueue,e===null?(e={lastEffect:null,stores:null},hi.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function e9(t,e,n,i){e.value=n,e.getSnapshot=i,n9(e)&&i9(t)}function t9(t,e,n){return n(function(){n9(e)&&i9(t)})}function n9(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Xa(t,n)}catch{return!0}}function i9(t){var e=$c(t,1);e!==null&&Ha(e,t,1,-1)}function vk(t){var e=El();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ex,lastRenderedState:t},e.queue=t,t=t.dispatch=Mne.bind(null,hi,t),[e.memoizedState,t]}function tx(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=hi.updateQueue,e===null?(e={lastEffect:null,stores:null},hi.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function r9(){return aa().memoizedState}function sb(t,e,n,i){var r=El();hi.flags|=t,r.memoizedState=tx(1|e,n,void 0,i===void 0?null:i)}function AM(t,e,n,i){var r=aa();i=i===void 0?null:i;var s=void 0;if(Qi!==null){var o=Qi.memoizedState;if(s=o.destroy,i!==null&&T3(i,o.deps)){r.memoizedState=tx(e,n,s,i);return}}hi.flags|=t,r.memoizedState=tx(1|e,n,s,i)}function yk(t,e){return sb(8390656,8,t,e)}function R3(t,e){return AM(2048,8,t,e)}function s9(t,e){return AM(4,2,t,e)}function o9(t,e){return AM(4,4,t,e)}function a9(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function l9(t,e,n){return n=n!=null?n.concat([t]):null,AM(4,4,a9.bind(null,e,t),n)}function L3(){}function c9(t,e){var n=aa();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&T3(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function u9(t,e){var n=aa();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&T3(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function h9(t,e,n){return bf&21?(Xa(n,e)||(n=p8(),hi.lanes|=n,Af|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ds=!0),t.memoizedState=n)}function bne(t,e){var n=Ln;Ln=n!==0&&4>n?n:4,t(!0);var i=dT.transition;dT.transition={};try{t(!1),e()}finally{Ln=n,dT.transition=i}}function d9(){return aa().memoizedState}function Ane(t,e,n){var i=bh(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},f9(t))p9(e,n);else if(n=j8(t,e,n,i),n!==null){var r=ds();Ha(n,t,i,r),m9(n,e,i)}}function Mne(t,e,n){var i=bh(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(f9(t))p9(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(r.hasEagerState=!0,r.eagerState=a,Xa(a,o)){var l=e.interleaved;l===null?(r.next=r,b3(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=j8(t,e,r,i),n!==null&&(r=ds(),Ha(n,t,i,r),m9(n,e,i))}}function f9(t){var e=t.alternate;return t===hi||e!==null&&e===hi}function p9(t,e){uy=Zb=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function m9(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,c3(t,n)}}var $b={readContext:oa,useCallback:kr,useContext:kr,useEffect:kr,useImperativeHandle:kr,useInsertionEffect:kr,useLayoutEffect:kr,useMemo:kr,useReducer:kr,useRef:kr,useState:kr,useDebugValue:kr,useDeferredValue:kr,useTransition:kr,useMutableSource:kr,useSyncExternalStore:kr,useId:kr,unstable_isNewReconciler:!1},Ene={readContext:oa,useCallback:function(t,e){return El().memoizedState=[t,e===void 0?null:e],t},useContext:oa,useEffect:yk,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,sb(4194308,4,a9.bind(null,e,t),n)},useLayoutEffect:function(t,e){return sb(4194308,4,t,e)},useInsertionEffect:function(t,e){return sb(4,2,t,e)},useMemo:function(t,e){var n=El();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=El();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=Ane.bind(null,hi,t),[i.memoizedState,t]},useRef:function(t){var e=El();return t={current:t},e.memoizedState=t},useState:vk,useDebugValue:L3,useDeferredValue:function(t){return El().memoizedState=t},useTransition:function(){var t=vk(!1),e=t[0];return t=bne.bind(null,t[1]),El().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=hi,r=El();if(ti){if(n===void 0)throw Error(Je(407));n=n()}else{if(n=e(),yr===null)throw Error(Je(349));bf&30||$8(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,yk(t9.bind(null,i,s,t),[t]),i.flags|=2048,tx(9,e9.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=El(),e=yr.identifierPrefix;if(ti){var n=Nc,i=Fc;n=(i&~(1<<32-Ga(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=$y++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Sne++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Cne={readContext:oa,useCallback:c9,useContext:oa,useEffect:R3,useImperativeHandle:l9,useInsertionEffect:s9,useLayoutEffect:o9,useMemo:u9,useReducer:fT,useRef:r9,useState:function(){return fT(ex)},useDebugValue:L3,useDeferredValue:function(t){var e=aa();return h9(e,Qi.memoizedState,t)},useTransition:function(){var t=fT(ex)[0],e=aa().memoizedState;return[t,e]},useMutableSource:J8,useSyncExternalStore:Z8,useId:d9,unstable_isNewReconciler:!1},Tne={readContext:oa,useCallback:c9,useContext:oa,useEffect:R3,useImperativeHandle:l9,useInsertionEffect:s9,useLayoutEffect:o9,useMemo:u9,useReducer:pT,useRef:r9,useState:function(){return pT(ex)},useDebugValue:L3,useDeferredValue:function(t){var e=aa();return Qi===null?e.memoizedState=t:h9(e,Qi.memoizedState,t)},useTransition:function(){var t=pT(ex)[0],e=aa().memoizedState;return[t,e]},useMutableSource:J8,useSyncExternalStore:Z8,useId:d9,unstable_isNewReconciler:!1};function bg(t,e){try{var n="",i=e;do n+=nte(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function mT(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function QD(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Pne=typeof WeakMap=="function"?WeakMap:Map;function g9(t,e,n){n=jc(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){tA||(tA=!0,sR=i),QD(t,e)},n}function v9(t,e,n){n=jc(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){QD(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){QD(t,e),typeof i!="function"&&(Sh===null?Sh=new Set([this]):Sh.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function xk(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new Pne;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=Vne.bind(null,t,e,n),e.then(t,t))}function _k(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function wk(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=jc(-1,1),e.tag=2,wh(n,e,1))),n.lanes|=1),t)}var Dne=lu.ReactCurrentOwner,Ds=!1;function us(t,e,n,i){e.child=t===null?Q8(e,null,n,i):wg(e,t.child,n,i)}function Sk(t,e,n,i,r){n=n.render;var s=e.ref;return Zm(e,r),i=P3(t,e,n,i,s,r),n=D3(),t!==null&&!Ds?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,eu(t,e,r)):(ti&&n&&v3(e),e.flags|=1,us(t,e,i,r),e.child)}function bk(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!z3(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,y9(t,e,s,i,r)):(t=cb(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&r)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Yy,n(o,i)&&t.ref===e.ref)return eu(t,e,r)}return e.flags|=1,t=Ah(s,i),t.ref=e.ref,t.return=e,e.child=t}function y9(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(Yy(s,i)&&t.ref===e.ref)if(Ds=!1,e.pendingProps=i=s,(t.lanes&r)!==0)t.flags&131072&&(Ds=!0);else return e.lanes=t.lanes,eu(t,e,r)}return KD(t,e,n,i,r)}function x9(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vn(Pm,Js),Js|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Vn(Pm,Js),Js|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,Vn(Pm,Js),Js|=i}else s!==null?(i=s.baseLanes|n,e.memoizedState=null):i=n,Vn(Pm,Js),Js|=i;return us(t,e,r,n),e.child}function _9(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function KD(t,e,n,i,r){var s=Bs(n)?wf:Qr.current;return s=xg(e,s),Zm(e,r),n=P3(t,e,n,i,s,r),i=D3(),t!==null&&!Ds?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,eu(t,e,r)):(ti&&i&&v3(e),e.flags|=1,us(t,e,n,r),e.child)}function Ak(t,e,n,i,r){if(Bs(n)){var s=!0;Wb(e)}else s=!1;if(Zm(e,r),e.stateNode===null)ob(t,e),Y8(e,n,i),qD(e,n,i,r),i=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=oa(c):(c=Bs(n)?wf:Qr.current,c=xg(e,c));var h=n.getDerivedStateFromProps,u=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";u||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==c)&&mk(e,o,i,c),Yu=!1;var d=e.memoizedState;o.state=d,Kb(e,i,o,r),l=e.memoizedState,a!==i||d!==l||Is.current||Yu?(typeof h=="function"&&(YD(e,n,h,i),l=e.memoizedState),(a=Yu||pk(e,n,a,i,d,l,c))?(u||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=c,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,W8(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Ra(e.type,a),o.props=c,u=e.pendingProps,d=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=oa(l):(l=Bs(n)?wf:Qr.current,l=xg(e,l));var f=n.getDerivedStateFromProps;(h=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==u||d!==l)&&mk(e,o,i,l),Yu=!1,d=e.memoizedState,o.state=d,Kb(e,i,o,r);var p=e.memoizedState;a!==u||d!==p||Is.current||Yu?(typeof f=="function"&&(YD(e,n,f,i),p=e.memoizedState),(c=Yu||pk(e,n,c,i,d,p,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=p),o.props=i,o.state=p,o.context=l,i=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),i=!1)}return JD(t,e,n,i,s,r)}function JD(t,e,n,i,r,s){_9(t,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&ck(e,n,!1),eu(t,e,s);i=e.stateNode,Dne.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&o?(e.child=wg(e,t.child,null,s),e.child=wg(e,null,a,s)):us(t,e,a,s),e.memoizedState=i.state,r&&ck(e,n,!0),e.child}function w9(t){var e=t.stateNode;e.pendingContext?lk(t,e.pendingContext,e.pendingContext!==e.context):e.context&&lk(t,e.context,!1),M3(t,e.containerInfo)}function Mk(t,e,n,i,r){return _g(),x3(r),e.flags|=256,us(t,e,n,i),e.child}var ZD={dehydrated:null,treeContext:null,retryLane:0};function $D(t){return{baseLanes:t,cachePool:null,transitions:null}}function S9(t,e,n){var i=e.pendingProps,r=ri.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),Vn(ri,r&1),t===null)return WD(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,t=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=CM(o,i,0,null),t=of(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=$D(n),e.memoizedState=ZD,t):I3(e,o));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return Rne(t,e,o,i,a,r,n);if(s){s=i.fallback,o=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=Ah(r,l),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=Ah(a,s):(s=of(s,o,n,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=t.child.memoizedState,o=o===null?$D(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=ZD,i}return s=t.child,t=s.sibling,i=Ah(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function I3(t,e){return e=CM({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function V_(t,e,n,i){return i!==null&&x3(i),wg(e,t.child,null,n),t=I3(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Rne(t,e,n,i,r,s,o){if(n)return e.flags&256?(e.flags&=-257,i=mT(Error(Je(422))),V_(t,e,o,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=CM({mode:"visible",children:i.children},r,0,null),s=of(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&wg(e,t.child,null,o),e.child.memoizedState=$D(o),e.memoizedState=ZD,s);if(!(e.mode&1))return V_(t,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(Je(419)),i=mT(s,i,void 0),V_(t,e,o,i)}if(a=(o&t.childLanes)!==0,Ds||a){if(i=yr,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,$c(t,r),Ha(i,t,r,-1))}return k3(),i=mT(Error(Je(421))),V_(t,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=jne.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,io=_h(r.nextSibling),po=e,ti=!0,Ba=null,t!==null&&(Qo[Ko++]=Fc,Qo[Ko++]=Nc,Qo[Ko++]=Sf,Fc=t.id,Nc=t.overflow,Sf=e),e=I3(e,i.children),e.flags|=4096,e)}function Ek(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),XD(t.return,e,n)}function gT(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function b9(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(us(t,e,i.children,n),i=ri.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ek(t,n,e);else if(t.tag===19)Ek(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Vn(ri,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Jb(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),gT(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Jb(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}gT(e,!0,n,null,s);break;case"together":gT(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ob(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function eu(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Af|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Je(153));if(e.child!==null){for(t=e.child,n=Ah(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ah(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Lne(t,e,n){switch(e.tag){case 3:w9(e),_g();break;case 5:K8(e);break;case 1:Bs(e.type)&&Wb(e);break;case 4:M3(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Vn(qb,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Vn(ri,ri.current&1),e.flags|=128,null):n&e.child.childLanes?S9(t,e,n):(Vn(ri,ri.current&1),t=eu(t,e,n),t!==null?t.sibling:null);Vn(ri,ri.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return b9(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Vn(ri,ri.current),i)break;return null;case 22:case 23:return e.lanes=0,x9(t,e,n)}return eu(t,e,n)}var A9,eR,M9,E9;A9=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};eR=function(){};M9=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,Qd(Gl.current);var s=null;switch(n){case"input":r=SD(t,r),i=SD(t,i),s=[];break;case"select":r=di({},r,{value:void 0}),i=di({},i,{value:void 0}),s=[];break;case"textarea":r=MD(t,r),i=MD(t,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=Vb)}CD(n,i);var o;n=null;for(c in r)if(!i.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(zy.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in i){var l=i[c];if(a=r!=null?r[c]:void 0,i.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(zy.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Xn("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};E9=function(t,e,n,i){n!==i&&(e.flags|=4)};function Yv(t,e){if(!ti)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function zr(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function Ine(t,e,n){var i=e.pendingProps;switch(y3(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return zr(e),null;case 1:return Bs(e.type)&&jb(),zr(e),null;case 3:return i=e.stateNode,Sg(),Kn(Is),Kn(Qr),C3(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(G_(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ba!==null&&(lR(Ba),Ba=null))),eR(t,e),zr(e),null;case 5:E3(e);var r=Qd(Zy.current);if(n=e.type,t!==null&&e.stateNode!=null)M9(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(Je(166));return zr(e),null}if(t=Qd(Gl.current),G_(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[Rl]=e,i[Ky]=s,t=(e.mode&1)!==0,n){case"dialog":Xn("cancel",i),Xn("close",i);break;case"iframe":case"object":case"embed":Xn("load",i);break;case"video":case"audio":for(r=0;r<Y0.length;r++)Xn(Y0[r],i);break;case"source":Xn("error",i);break;case"img":case"image":case"link":Xn("error",i),Xn("load",i);break;case"details":Xn("toggle",i);break;case"input":OU(i,s),Xn("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Xn("invalid",i);break;case"textarea":NU(i,s),Xn("invalid",i)}CD(n,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&z_(i.textContent,a,t),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&z_(i.textContent,a,t),r=["children",""+a]):zy.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Xn("scroll",i)}switch(n){case"input":L_(i),FU(i,s,!0);break;case"textarea":L_(i),UU(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=Vb)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=$W(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=o.createElement(n,{is:i.is}):(t=o.createElement(n),n==="select"&&(o=t,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):t=o.createElementNS(t,n),t[Rl]=e,t[Ky]=i,A9(t,e,!1,!1),e.stateNode=t;e:{switch(o=TD(n,i),n){case"dialog":Xn("cancel",t),Xn("close",t),r=i;break;case"iframe":case"object":case"embed":Xn("load",t),r=i;break;case"video":case"audio":for(r=0;r<Y0.length;r++)Xn(Y0[r],t);r=i;break;case"source":Xn("error",t),r=i;break;case"img":case"image":case"link":Xn("error",t),Xn("load",t),r=i;break;case"details":Xn("toggle",t),r=i;break;case"input":OU(t,i),r=SD(t,i),Xn("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=di({},i,{value:void 0}),Xn("invalid",t);break;case"textarea":NU(t,i),r=MD(t,i),Xn("invalid",t);break;default:r=i}CD(n,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?n8(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&e8(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Gy(t,l):typeof l=="number"&&Gy(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(zy.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Xn("scroll",t):l!=null&&i3(t,s,l,o))}switch(n){case"input":L_(t),FU(t,i,!1);break;case"textarea":L_(t),UU(t);break;case"option":i.value!=null&&t.setAttribute("value",""+Bh(i.value));break;case"select":t.multiple=!!i.multiple,s=i.value,s!=null?qm(t,!!i.multiple,s,!1):i.defaultValue!=null&&qm(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=Vb)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return zr(e),null;case 6:if(t&&e.stateNode!=null)E9(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(Je(166));if(n=Qd(Zy.current),Qd(Gl.current),G_(e)){if(i=e.stateNode,n=e.memoizedProps,i[Rl]=e,(s=i.nodeValue!==n)&&(t=po,t!==null))switch(t.tag){case 3:z_(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&z_(i.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[Rl]=e,e.stateNode=i}return zr(e),null;case 13:if(Kn(ri),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ti&&io!==null&&e.mode&1&&!(e.flags&128))V8(),_g(),e.flags|=98560,s=!1;else if(s=G_(e),i!==null&&i.dehydrated!==null){if(t===null){if(!s)throw Error(Je(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Je(317));s[Rl]=e}else _g(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;zr(e),s=!1}else Ba!==null&&(lR(Ba),Ba=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||ri.current&1?Zi===0&&(Zi=3):k3())),e.updateQueue!==null&&(e.flags|=4),zr(e),null);case 4:return Sg(),eR(t,e),t===null&&qy(e.stateNode.containerInfo),zr(e),null;case 10:return S3(e.type._context),zr(e),null;case 17:return Bs(e.type)&&jb(),zr(e),null;case 19:if(Kn(ri),s=e.memoizedState,s===null)return zr(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)Yv(s,!1);else{if(Zi!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Jb(t),o!==null){for(e.flags|=128,Yv(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)s=n,t=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Vn(ri,ri.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ti()>Ag&&(e.flags|=128,i=!0,Yv(s,!1),e.lanes=4194304)}else{if(!i)if(t=Jb(o),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Yv(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ti)return zr(e),null}else 2*Ti()-s.renderingStartTime>Ag&&n!==1073741824&&(e.flags|=128,i=!0,Yv(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ti(),e.sibling=null,n=ri.current,Vn(ri,i?n&1|2:n&1),e):(zr(e),null);case 22:case 23:return U3(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Js&1073741824&&(zr(e),e.subtreeFlags&6&&(e.flags|=8192)):zr(e),null;case 24:return null;case 25:return null}throw Error(Je(156,e.tag))}function Bne(t,e){switch(y3(e),e.tag){case 1:return Bs(e.type)&&jb(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Sg(),Kn(Is),Kn(Qr),C3(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return E3(e),null;case 13:if(Kn(ri),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Je(340));_g()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Kn(ri),null;case 4:return Sg(),null;case 10:return S3(e.type._context),null;case 22:case 23:return U3(),null;case 24:return null;default:return null}}var j_=!1,Xr=!1,One=typeof WeakSet=="function"?WeakSet:Set,pt=null;function Tm(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){gi(t,e,i)}else n.current=null}function tR(t,e,n){try{n()}catch(i){gi(t,e,i)}}var Ck=!1;function Fne(t,e){if(UD=zb,t=D8(),g3(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,h=0,u=t,d=null;t:for(;;){for(var f;u!==n||r!==0&&u.nodeType!==3||(a=o+r),u!==s||i!==0&&u.nodeType!==3||(l=o+i),u.nodeType===3&&(o+=u.nodeValue.length),(f=u.firstChild)!==null;)d=u,u=f;for(;;){if(u===t)break t;if(d===n&&++c===r&&(a=o),d===s&&++h===i&&(l=o),(f=u.nextSibling)!==null)break;u=d,d=u.parentNode}u=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(kD={focusedElem:t,selectionRange:n},zb=!1,pt=e;pt!==null;)if(e=pt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,pt=t;else for(;pt!==null;){e=pt;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var v=p.memoizedProps,g=p.memoizedState,m=e.stateNode,y=m.getSnapshotBeforeUpdate(e.elementType===e.type?v:Ra(e.type,v),g);m.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var _=e.stateNode.containerInfo;_.nodeType===1?_.textContent="":_.nodeType===9&&_.documentElement&&_.removeChild(_.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Je(163))}}catch(S){gi(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,pt=t;break}pt=e.return}return p=Ck,Ck=!1,p}function hy(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&tR(e,n,s)}r=r.next}while(r!==i)}}function MM(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function nR(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function C9(t){var e=t.alternate;e!==null&&(t.alternate=null,C9(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Rl],delete e[Ky],delete e[HD],delete e[yne],delete e[xne])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function T9(t){return t.tag===5||t.tag===3||t.tag===4}function Tk(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||T9(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function iR(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Vb));else if(i!==4&&(t=t.child,t!==null))for(iR(t,e,n),t=t.sibling;t!==null;)iR(t,e,n),t=t.sibling}function rR(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(rR(t,e,n),t=t.sibling;t!==null;)rR(t,e,n),t=t.sibling}var Mr=null,Ia=!1;function Su(t,e,n){for(n=n.child;n!==null;)P9(t,e,n),n=n.sibling}function P9(t,e,n){if(zl&&typeof zl.onCommitFiberUnmount=="function")try{zl.onCommitFiberUnmount(vM,n)}catch{}switch(n.tag){case 5:Xr||Tm(n,e);case 6:var i=Mr,r=Ia;Mr=null,Su(t,e,n),Mr=i,Ia=r,Mr!==null&&(Ia?(t=Mr,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Mr.removeChild(n.stateNode));break;case 18:Mr!==null&&(Ia?(t=Mr,n=n.stateNode,t.nodeType===8?cT(t.parentNode,n):t.nodeType===1&&cT(t,n),Wy(t)):cT(Mr,n.stateNode));break;case 4:i=Mr,r=Ia,Mr=n.stateNode.containerInfo,Ia=!0,Su(t,e,n),Mr=i,Ia=r;break;case 0:case 11:case 14:case 15:if(!Xr&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&tR(n,e,o),r=r.next}while(r!==i)}Su(t,e,n);break;case 1:if(!Xr&&(Tm(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(a){gi(n,e,a)}Su(t,e,n);break;case 21:Su(t,e,n);break;case 22:n.mode&1?(Xr=(i=Xr)||n.memoizedState!==null,Su(t,e,n),Xr=i):Su(t,e,n);break;default:Su(t,e,n)}}function Pk(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new One),e.forEach(function(i){var r=Wne.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function ya(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Mr=a.stateNode,Ia=!1;break e;case 3:Mr=a.stateNode.containerInfo,Ia=!0;break e;case 4:Mr=a.stateNode.containerInfo,Ia=!0;break e}a=a.return}if(Mr===null)throw Error(Je(160));P9(s,o,r),Mr=null,Ia=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){gi(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)D9(e,t),e=e.sibling}function D9(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ya(e,t),dl(t),i&4){try{hy(3,t,t.return),MM(3,t)}catch(v){gi(t,t.return,v)}try{hy(5,t,t.return)}catch(v){gi(t,t.return,v)}}break;case 1:ya(e,t),dl(t),i&512&&n!==null&&Tm(n,n.return);break;case 5:if(ya(e,t),dl(t),i&512&&n!==null&&Tm(n,n.return),t.flags&32){var r=t.stateNode;try{Gy(r,"")}catch(v){gi(t,t.return,v)}}if(i&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&JW(r,s),TD(a,o);var c=TD(a,s);for(o=0;o<l.length;o+=2){var h=l[o],u=l[o+1];h==="style"?n8(r,u):h==="dangerouslySetInnerHTML"?e8(r,u):h==="children"?Gy(r,u):i3(r,h,u,c)}switch(a){case"input":bD(r,s);break;case"textarea":ZW(r,s);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?qm(r,!!s.multiple,f,!1):d!==!!s.multiple&&(s.defaultValue!=null?qm(r,!!s.multiple,s.defaultValue,!0):qm(r,!!s.multiple,s.multiple?[]:"",!1))}r[Ky]=s}catch(v){gi(t,t.return,v)}}break;case 6:if(ya(e,t),dl(t),i&4){if(t.stateNode===null)throw Error(Je(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(v){gi(t,t.return,v)}}break;case 3:if(ya(e,t),dl(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{Wy(e.containerInfo)}catch(v){gi(t,t.return,v)}break;case 4:ya(e,t),dl(t);break;case 13:ya(e,t),dl(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(F3=Ti())),i&4&&Pk(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(Xr=(c=Xr)||h,ya(e,t),Xr=c):ya(e,t),dl(t),i&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!h&&t.mode&1)for(pt=t,h=t.child;h!==null;){for(u=pt=h;pt!==null;){switch(d=pt,f=d.child,d.tag){case 0:case 11:case 14:case 15:hy(4,d,d.return);break;case 1:Tm(d,d.return);var p=d.stateNode;if(typeof p.componentWillUnmount=="function"){i=d,n=d.return;try{e=i,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(v){gi(i,n,v)}}break;case 5:Tm(d,d.return);break;case 22:if(d.memoizedState!==null){Rk(u);continue}}f!==null?(f.return=d,pt=f):Rk(u)}h=h.sibling}e:for(h=null,u=t;;){if(u.tag===5){if(h===null){h=u;try{r=u.stateNode,c?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=u.stateNode,l=u.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=t8("display",o))}catch(v){gi(t,t.return,v)}}}else if(u.tag===6){if(h===null)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(v){gi(t,t.return,v)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===t)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===t)break e;for(;u.sibling===null;){if(u.return===null||u.return===t)break e;h===u&&(h=null),u=u.return}h===u&&(h=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:ya(e,t),dl(t),i&4&&Pk(t);break;case 21:break;default:ya(e,t),dl(t)}}function dl(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(T9(n)){var i=n;break e}n=n.return}throw Error(Je(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Gy(r,""),i.flags&=-33);var s=Tk(t);rR(t,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=Tk(t);iR(t,a,o);break;default:throw Error(Je(161))}}catch(l){gi(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Nne(t,e,n){pt=t,R9(t)}function R9(t,e,n){for(var i=(t.mode&1)!==0;pt!==null;){var r=pt,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||j_;if(!o){var a=r.alternate,l=a!==null&&a.memoizedState!==null||Xr;a=j_;var c=Xr;if(j_=o,(Xr=l)&&!c)for(pt=r;pt!==null;)o=pt,l=o.child,o.tag===22&&o.memoizedState!==null?Lk(r):l!==null?(l.return=o,pt=l):Lk(r);for(;s!==null;)pt=s,R9(s),s=s.sibling;pt=r,j_=a,Xr=c}Dk(t)}else r.subtreeFlags&8772&&s!==null?(s.return=r,pt=s):Dk(t)}}function Dk(t){for(;pt!==null;){var e=pt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Xr||MM(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Xr)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Ra(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&fk(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}fk(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var h=c.memoizedState;if(h!==null){var u=h.dehydrated;u!==null&&Wy(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Je(163))}Xr||e.flags&512&&nR(e)}catch(d){gi(e,e.return,d)}}if(e===t){pt=null;break}if(n=e.sibling,n!==null){n.return=e.return,pt=n;break}pt=e.return}}function Rk(t){for(;pt!==null;){var e=pt;if(e===t){pt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,pt=n;break}pt=e.return}}function Lk(t){for(;pt!==null;){var e=pt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{MM(4,e)}catch(l){gi(e,n,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){gi(e,r,l)}}var s=e.return;try{nR(e)}catch(l){gi(e,s,l)}break;case 5:var o=e.return;try{nR(e)}catch(l){gi(e,o,l)}}}catch(l){gi(e,e.return,l)}if(e===t){pt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,pt=a;break}pt=e.return}}var Une=Math.ceil,eA=lu.ReactCurrentDispatcher,B3=lu.ReactCurrentOwner,na=lu.ReactCurrentBatchConfig,gn=0,yr=null,ki=null,Dr=0,Js=0,Pm=Yh(0),Zi=0,nx=null,Af=0,EM=0,O3=0,dy=null,As=null,F3=0,Ag=1/0,Lc=null,tA=!1,sR=null,Sh=null,W_=!1,sh=null,nA=0,fy=0,oR=null,ab=-1,lb=0;function ds(){return gn&6?Ti():ab!==-1?ab:ab=Ti()}function bh(t){return t.mode&1?gn&2&&Dr!==0?Dr&-Dr:wne.transition!==null?(lb===0&&(lb=p8()),lb):(t=Ln,t!==0||(t=window.event,t=t===void 0?16:w8(t.type)),t):1}function Ha(t,e,n,i){if(50<fy)throw fy=0,oR=null,Error(Je(185));Vx(t,n,i),(!(gn&2)||t!==yr)&&(t===yr&&(!(gn&2)&&(EM|=n),Zi===4&&eh(t,Dr)),Os(t,i),n===1&&gn===0&&!(e.mode&1)&&(Ag=Ti()+500,SM&&qh()))}function Os(t,e){var n=t.callbackNode;wte(t,e);var i=kb(t,t===yr?Dr:0);if(i===0)n!==null&&GU(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&GU(n),e===1)t.tag===0?_ne(Ik.bind(null,t)):z8(Ik.bind(null,t)),gne(function(){!(gn&6)&&qh()}),n=null;else{switch(m8(i)){case 1:n=l3;break;case 4:n=d8;break;case 16:n=Ub;break;case 536870912:n=f8;break;default:n=Ub}n=k9(n,L9.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function L9(t,e){if(ab=-1,lb=0,gn&6)throw Error(Je(327));var n=t.callbackNode;if($m()&&t.callbackNode!==n)return null;var i=kb(t,t===yr?Dr:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=iA(t,i);else{e=i;var r=gn;gn|=2;var s=B9();(yr!==t||Dr!==e)&&(Lc=null,Ag=Ti()+500,sf(t,e));do try{Gne();break}catch(a){I9(t,a)}while(1);w3(),eA.current=s,gn=r,ki!==null?e=0:(yr=null,Dr=0,e=Zi)}if(e!==0){if(e===2&&(r=ID(t),r!==0&&(i=r,e=aR(t,r))),e===1)throw n=nx,sf(t,0),eh(t,i),Os(t,Ti()),n;if(e===6)eh(t,i);else{if(r=t.current.alternate,!(i&30)&&!kne(r)&&(e=iA(t,i),e===2&&(s=ID(t),s!==0&&(i=s,e=aR(t,s))),e===1))throw n=nx,sf(t,0),eh(t,i),Os(t,Ti()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(Je(345));case 2:Dd(t,As,Lc);break;case 3:if(eh(t,i),(i&130023424)===i&&(e=F3+500-Ti(),10<e)){if(kb(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){ds(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=GD(Dd.bind(null,t,As,Lc),e);break}Dd(t,As,Lc);break;case 4:if(eh(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var o=31-Ga(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=Ti()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Une(i/1960))-i,10<i){t.timeoutHandle=GD(Dd.bind(null,t,As,Lc),i);break}Dd(t,As,Lc);break;case 5:Dd(t,As,Lc);break;default:throw Error(Je(329))}}}return Os(t,Ti()),t.callbackNode===n?L9.bind(null,t):null}function aR(t,e){var n=dy;return t.current.memoizedState.isDehydrated&&(sf(t,e).flags|=256),t=iA(t,e),t!==2&&(e=As,As=n,e!==null&&lR(e)),t}function lR(t){As===null?As=t:As.push.apply(As,t)}function kne(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!Xa(s(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function eh(t,e){for(e&=~O3,e&=~EM,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ga(e),i=1<<n;t[n]=-1,e&=~i}}function Ik(t){if(gn&6)throw Error(Je(327));$m();var e=kb(t,0);if(!(e&1))return Os(t,Ti()),null;var n=iA(t,e);if(t.tag!==0&&n===2){var i=ID(t);i!==0&&(e=i,n=aR(t,i))}if(n===1)throw n=nx,sf(t,0),eh(t,e),Os(t,Ti()),n;if(n===6)throw Error(Je(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Dd(t,As,Lc),Os(t,Ti()),null}function N3(t,e){var n=gn;gn|=1;try{return t(e)}finally{gn=n,gn===0&&(Ag=Ti()+500,SM&&qh())}}function Mf(t){sh!==null&&sh.tag===0&&!(gn&6)&&$m();var e=gn;gn|=1;var n=na.transition,i=Ln;try{if(na.transition=null,Ln=1,t)return t()}finally{Ln=i,na.transition=n,gn=e,!(gn&6)&&qh()}}function U3(){Js=Pm.current,Kn(Pm)}function sf(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,mne(n)),ki!==null)for(n=ki.return;n!==null;){var i=n;switch(y3(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&jb();break;case 3:Sg(),Kn(Is),Kn(Qr),C3();break;case 5:E3(i);break;case 4:Sg();break;case 13:Kn(ri);break;case 19:Kn(ri);break;case 10:S3(i.type._context);break;case 22:case 23:U3()}n=n.return}if(yr=t,ki=t=Ah(t.current,null),Dr=Js=e,Zi=0,nx=null,O3=EM=Af=0,As=dy=null,qd!==null){for(e=0;e<qd.length;e++)if(n=qd[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}n.pending=i}qd=null}return t}function I9(t,e){do{var n=ki;try{if(w3(),rb.current=$b,Zb){for(var i=hi.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Zb=!1}if(bf=0,pr=Qi=hi=null,uy=!1,$y=0,B3.current=null,n===null||n.return===null){Zi=1,nx=e,ki=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Dr,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,h=a,u=h.tag;if(!(h.mode&1)&&(u===0||u===11||u===15)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var f=_k(o);if(f!==null){f.flags&=-257,wk(f,o,a,s,e),f.mode&1&&xk(s,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var v=new Set;v.add(l),e.updateQueue=v}else p.add(l);break e}else{if(!(e&1)){xk(s,c,e),k3();break e}l=Error(Je(426))}}else if(ti&&a.mode&1){var g=_k(o);if(g!==null){!(g.flags&65536)&&(g.flags|=256),wk(g,o,a,s,e),x3(bg(l,a));break e}}s=l=bg(l,a),Zi!==4&&(Zi=2),dy===null?dy=[s]:dy.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var m=g9(s,l,e);dk(s,m);break e;case 1:a=l;var y=s.type,_=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Sh===null||!Sh.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e;var S=v9(s,a,e);dk(s,S);break e}}s=s.return}while(s!==null)}F9(n)}catch(A){e=A,ki===n&&n!==null&&(ki=n=n.return);continue}break}while(1)}function B9(){var t=eA.current;return eA.current=$b,t===null?$b:t}function k3(){(Zi===0||Zi===3||Zi===2)&&(Zi=4),yr===null||!(Af&268435455)&&!(EM&268435455)||eh(yr,Dr)}function iA(t,e){var n=gn;gn|=2;var i=B9();(yr!==t||Dr!==e)&&(Lc=null,sf(t,e));do try{zne();break}catch(r){I9(t,r)}while(1);if(w3(),gn=n,eA.current=i,ki!==null)throw Error(Je(261));return yr=null,Dr=0,Zi}function zne(){for(;ki!==null;)O9(ki)}function Gne(){for(;ki!==null&&!dte();)O9(ki)}function O9(t){var e=U9(t.alternate,t,Js);t.memoizedProps=t.pendingProps,e===null?F9(t):ki=e,B3.current=null}function F9(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Bne(n,e),n!==null){n.flags&=32767,ki=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Zi=6,ki=null;return}}else if(n=Ine(n,e,Js),n!==null){ki=n;return}if(e=e.sibling,e!==null){ki=e;return}ki=e=t}while(e!==null);Zi===0&&(Zi=5)}function Dd(t,e,n){var i=Ln,r=na.transition;try{na.transition=null,Ln=1,Hne(t,e,n,i)}finally{na.transition=r,Ln=i}return null}function Hne(t,e,n,i){do $m();while(sh!==null);if(gn&6)throw Error(Je(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Je(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(Ste(t,s),t===yr&&(ki=yr=null,Dr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||W_||(W_=!0,k9(Ub,function(){return $m(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=na.transition,na.transition=null;var o=Ln;Ln=1;var a=gn;gn|=4,B3.current=null,Fne(t,n),D9(n,t),lne(kD),zb=!!UD,kD=UD=null,t.current=n,Nne(n),fte(),gn=a,Ln=o,na.transition=s}else t.current=n;if(W_&&(W_=!1,sh=t,nA=r),s=t.pendingLanes,s===0&&(Sh=null),gte(n.stateNode),Os(t,Ti()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(tA)throw tA=!1,t=sR,sR=null,t;return nA&1&&t.tag!==0&&$m(),s=t.pendingLanes,s&1?t===oR?fy++:(fy=0,oR=t):fy=0,qh(),null}function $m(){if(sh!==null){var t=m8(nA),e=na.transition,n=Ln;try{if(na.transition=null,Ln=16>t?16:t,sh===null)var i=!1;else{if(t=sh,sh=null,nA=0,gn&6)throw Error(Je(331));var r=gn;for(gn|=4,pt=t.current;pt!==null;){var s=pt,o=s.child;if(pt.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(pt=c;pt!==null;){var h=pt;switch(h.tag){case 0:case 11:case 15:hy(8,h,s)}var u=h.child;if(u!==null)u.return=h,pt=u;else for(;pt!==null;){h=pt;var d=h.sibling,f=h.return;if(C9(h),h===c){pt=null;break}if(d!==null){d.return=f,pt=d;break}pt=f}}}var p=s.alternate;if(p!==null){var v=p.child;if(v!==null){p.child=null;do{var g=v.sibling;v.sibling=null,v=g}while(v!==null)}}pt=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,pt=o;else e:for(;pt!==null;){if(s=pt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:hy(9,s,s.return)}var m=s.sibling;if(m!==null){m.return=s.return,pt=m;break e}pt=s.return}}var y=t.current;for(pt=y;pt!==null;){o=pt;var _=o.child;if(o.subtreeFlags&2064&&_!==null)_.return=o,pt=_;else e:for(o=y;pt!==null;){if(a=pt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:MM(9,a)}}catch(A){gi(a,a.return,A)}if(a===o){pt=null;break e}var S=a.sibling;if(S!==null){S.return=a.return,pt=S;break e}pt=a.return}}if(gn=r,qh(),zl&&typeof zl.onPostCommitFiberRoot=="function")try{zl.onPostCommitFiberRoot(vM,t)}catch{}i=!0}return i}finally{Ln=n,na.transition=e}}return!1}function Bk(t,e,n){e=bg(n,e),e=g9(t,e,1),t=wh(t,e,1),e=ds(),t!==null&&(Vx(t,1,e),Os(t,e))}function gi(t,e,n){if(t.tag===3)Bk(t,t,n);else for(;e!==null;){if(e.tag===3){Bk(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Sh===null||!Sh.has(i))){t=bg(n,t),t=v9(e,t,1),e=wh(e,t,1),t=ds(),e!==null&&(Vx(e,1,t),Os(e,t));break}}e=e.return}}function Vne(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=ds(),t.pingedLanes|=t.suspendedLanes&n,yr===t&&(Dr&n)===n&&(Zi===4||Zi===3&&(Dr&130023424)===Dr&&500>Ti()-F3?sf(t,0):O3|=n),Os(t,e)}function N9(t,e){e===0&&(t.mode&1?(e=O_,O_<<=1,!(O_&130023424)&&(O_=4194304)):e=1);var n=ds();t=$c(t,e),t!==null&&(Vx(t,e,n),Os(t,n))}function jne(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),N9(t,n)}function Wne(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(Je(314))}i!==null&&i.delete(e),N9(t,n)}var U9;U9=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Is.current)Ds=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ds=!1,Lne(t,e,n);Ds=!!(t.flags&131072)}else Ds=!1,ti&&e.flags&1048576&&G8(e,Yb,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;ob(t,e),t=e.pendingProps;var r=xg(e,Qr.current);Zm(e,n),r=P3(null,e,i,t,r,n);var s=D3();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Bs(i)?(s=!0,Wb(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,A3(e),r.updater=bM,e.stateNode=r,r._reactInternals=e,qD(e,i,t,n),e=JD(null,e,i,!0,s,n)):(e.tag=0,ti&&s&&v3(e),us(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(ob(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=Yne(i),t=Ra(i,t),r){case 0:e=KD(null,e,i,t,n);break e;case 1:e=Ak(null,e,i,t,n);break e;case 11:e=Sk(null,e,i,t,n);break e;case 14:e=bk(null,e,i,Ra(i.type,t),n);break e}throw Error(Je(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ra(i,r),KD(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ra(i,r),Ak(t,e,i,r,n);case 3:e:{if(w9(e),t===null)throw Error(Je(387));i=e.pendingProps,s=e.memoizedState,r=s.element,W8(t,e),Kb(e,i,null,n);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=bg(Error(Je(423)),e),e=Mk(t,e,i,n,r);break e}else if(i!==r){r=bg(Error(Je(424)),e),e=Mk(t,e,i,n,r);break e}else for(io=_h(e.stateNode.containerInfo.firstChild),po=e,ti=!0,Ba=null,n=Q8(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(_g(),i===r){e=eu(t,e,n);break e}us(t,e,i,n)}e=e.child}return e;case 5:return K8(e),t===null&&WD(e),i=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,o=r.children,zD(i,r)?o=null:s!==null&&zD(i,s)&&(e.flags|=32),_9(t,e),us(t,e,o,n),e.child;case 6:return t===null&&WD(e),null;case 13:return S9(t,e,n);case 4:return M3(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=wg(e,null,i,n):us(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ra(i,r),Sk(t,e,i,r,n);case 7:return us(t,e,e.pendingProps,n),e.child;case 8:return us(t,e,e.pendingProps.children,n),e.child;case 12:return us(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,Vn(qb,i._currentValue),i._currentValue=o,s!==null)if(Xa(s.value,o)){if(s.children===r.children&&!Is.current){e=eu(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=jc(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var h=c.pending;h===null?l.next=l:(l.next=h.next,h.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),XD(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Je(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),XD(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}us(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,Zm(e,n),r=oa(r),i=i(r),e.flags|=1,us(t,e,i,n),e.child;case 14:return i=e.type,r=Ra(i,e.pendingProps),r=Ra(i.type,r),bk(t,e,i,r,n);case 15:return y9(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Ra(i,r),ob(t,e),e.tag=1,Bs(i)?(t=!0,Wb(e)):t=!1,Zm(e,n),Y8(e,i,r),qD(e,i,r,n),JD(null,e,i,!0,t,n);case 19:return b9(t,e,n);case 22:return x9(t,e,n)}throw Error(Je(156,e.tag))};function k9(t,e){return h8(t,e)}function Xne(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ta(t,e,n,i){return new Xne(t,e,n,i)}function z3(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Yne(t){if(typeof t=="function")return z3(t)?1:0;if(t!=null){if(t=t.$$typeof,t===s3)return 11;if(t===o3)return 14}return 2}function Ah(t,e){var n=t.alternate;return n===null?(n=ta(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function cb(t,e,n,i,r,s){var o=2;if(i=t,typeof t=="function")z3(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case xm:return of(n.children,r,s,e);case r3:o=8,r|=8;break;case yD:return t=ta(12,n,e,r|2),t.elementType=yD,t.lanes=s,t;case xD:return t=ta(13,n,e,r),t.elementType=xD,t.lanes=s,t;case _D:return t=ta(19,n,e,r),t.elementType=_D,t.lanes=s,t;case qW:return CM(n,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case XW:o=10;break e;case YW:o=9;break e;case s3:o=11;break e;case o3:o=14;break e;case Xu:o=16,i=null;break e}throw Error(Je(130,t==null?t:typeof t,""))}return e=ta(o,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function of(t,e,n,i){return t=ta(7,t,i,e),t.lanes=n,t}function CM(t,e,n,i){return t=ta(22,t,i,e),t.elementType=qW,t.lanes=n,t.stateNode={isHidden:!1},t}function vT(t,e,n){return t=ta(6,t,null,e),t.lanes=n,t}function yT(t,e,n){return e=ta(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function qne(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ZC(0),this.expirationTimes=ZC(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ZC(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function G3(t,e,n,i,r,s,o,a,l){return t=new qne(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ta(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},A3(s),t}function Qne(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ym,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function z9(t){if(!t)return Oh;t=t._reactInternals;e:{if(kf(t)!==t||t.tag!==1)throw Error(Je(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Bs(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Je(171))}if(t.tag===1){var n=t.type;if(Bs(n))return k8(t,n,e)}return e}function G9(t,e,n,i,r,s,o,a,l){return t=G3(n,i,!0,t,r,s,o,a,l),t.context=z9(null),n=t.current,i=ds(),r=bh(n),s=jc(i,r),s.callback=e??null,wh(n,s,r),t.current.lanes=r,Vx(t,r,i),Os(t,i),t}function TM(t,e,n,i){var r=e.current,s=ds(),o=bh(r);return n=z9(n),e.context===null?e.context=n:e.pendingContext=n,e=jc(s,o),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=wh(r,e,o),t!==null&&(Ha(t,r,o,s),ib(t,r,o)),o}function rA(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Ok(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function H3(t,e){Ok(t,e),(t=t.alternate)&&Ok(t,e)}function Kne(){return null}var H9=typeof reportError=="function"?reportError:function(t){console.error(t)};function V3(t){this._internalRoot=t}PM.prototype.render=V3.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Je(409));TM(t,e,null,null)};PM.prototype.unmount=V3.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Mf(function(){TM(null,t,null,null)}),e[Zc]=null}};function PM(t){this._internalRoot=t}PM.prototype.unstable_scheduleHydration=function(t){if(t){var e=y8();t={blockedOn:null,target:t,priority:e};for(var n=0;n<$u.length&&e!==0&&e<$u[n].priority;n++);$u.splice(n,0,t),n===0&&_8(t)}};function j3(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function DM(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Fk(){}function Jne(t,e,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var c=rA(o);s.call(c)}}var o=G9(e,i,t,0,null,!1,!1,"",Fk);return t._reactRootContainer=o,t[Zc]=o.current,qy(t.nodeType===8?t.parentNode:t),Mf(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var c=rA(l);a.call(c)}}var l=G3(t,0,!1,null,null,!1,!1,"",Fk);return t._reactRootContainer=l,t[Zc]=l.current,qy(t.nodeType===8?t.parentNode:t),Mf(function(){TM(e,l,n,i)}),l}function RM(t,e,n,i,r){var s=n._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var l=rA(o);a.call(l)}}TM(e,o,t,r)}else o=Jne(n,e,t,r,i);return rA(o)}g8=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=X0(e.pendingLanes);n!==0&&(c3(e,n|1),Os(e,Ti()),!(gn&6)&&(Ag=Ti()+500,qh()))}break;case 13:Mf(function(){var i=$c(t,1);if(i!==null){var r=ds();Ha(i,t,1,r)}}),H3(t,1)}};u3=function(t){if(t.tag===13){var e=$c(t,134217728);if(e!==null){var n=ds();Ha(e,t,134217728,n)}H3(t,134217728)}};v8=function(t){if(t.tag===13){var e=bh(t),n=$c(t,e);if(n!==null){var i=ds();Ha(n,t,e,i)}H3(t,e)}};y8=function(){return Ln};x8=function(t,e){var n=Ln;try{return Ln=t,e()}finally{Ln=n}};DD=function(t,e,n){switch(e){case"input":if(bD(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=wM(i);if(!r)throw Error(Je(90));KW(i),bD(i,r)}}}break;case"textarea":ZW(t,n);break;case"select":e=n.value,e!=null&&qm(t,!!n.multiple,e,!1)}};s8=N3;o8=Mf;var Zne={usingClientEntryPoint:!1,Events:[Wx,bm,wM,i8,r8,N3]},qv={findFiberByHostInstance:Yd,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},$ne={bundleType:qv.bundleType,version:qv.version,rendererPackageName:qv.rendererPackageName,rendererConfig:qv.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:lu.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=c8(t),t===null?null:t.stateNode},findFiberByHostInstance:qv.findFiberByHostInstance||Kne,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var X_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!X_.isDisabled&&X_.supportsFiber)try{vM=X_.inject($ne),zl=X_}catch{}}wo.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Zne;wo.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!j3(e))throw Error(Je(200));return Qne(t,e,null,n)};wo.createRoot=function(t,e){if(!j3(t))throw Error(Je(299));var n=!1,i="",r=H9;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=G3(t,1,!1,null,null,n,!1,i,r),t[Zc]=e.current,qy(t.nodeType===8?t.parentNode:t),new V3(e)};wo.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Je(188)):(t=Object.keys(t).join(","),Error(Je(268,t)));return t=c8(e),t=t===null?null:t.stateNode,t};wo.flushSync=function(t){return Mf(t)};wo.hydrate=function(t,e,n){if(!DM(e))throw Error(Je(200));return RM(null,t,e,!0,n)};wo.hydrateRoot=function(t,e,n){if(!j3(t))throw Error(Je(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",o=H9;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=G9(e,null,t,1,n??null,r,!1,s,o),t[Zc]=e.current,qy(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new PM(e)};wo.render=function(t,e,n){if(!DM(e))throw Error(Je(200));return RM(null,t,e,!1,n)};wo.unmountComponentAtNode=function(t){if(!DM(t))throw Error(Je(40));return t._reactRootContainer?(Mf(function(){RM(null,null,t,!1,function(){t._reactRootContainer=null,t[Zc]=null})}),!0):!1};wo.unstable_batchedUpdates=N3;wo.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!DM(n))throw Error(Je(200));if(t==null||t._reactInternals===void 0)throw Error(Je(38));return RM(t,e,n,!1,i)};wo.version="18.2.0-next-9e3b772b8-20220608";function V9(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(V9)}catch(t){console.error(t)}}V9(),GW.exports=wo;var eie=GW.exports,j9,Nk=eie;j9=gD.createRoot=Nk.createRoot,gD.hydrateRoot=Nk.hydrateRoot;/**
 * @remix-run/router v1.6.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ix(){return ix=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},ix.apply(this,arguments)}var oh;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(oh||(oh={}));const Uk="popstate";function tie(t){t===void 0&&(t={});function e(i,r){let{pathname:s,search:o,hash:a}=i.location;return cR("",{pathname:s,search:o,hash:a},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(i,r){return typeof r=="string"?r:sA(r)}return iie(e,n,null,t)}function Gi(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function W3(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function nie(){return Math.random().toString(36).substr(2,8)}function kk(t,e){return{usr:t.state,key:t.key,idx:e}}function cR(t,e,n,i){return n===void 0&&(n=null),ix({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?$g(e):e,{state:n,key:e&&e.key||i||nie()})}function sA(t){let{pathname:e="/",search:n="",hash:i=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function $g(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substr(i),t=t.substr(0,i)),t&&(e.pathname=t)}return e}function iie(t,e,n,i){i===void 0&&(i={});let{window:r=document.defaultView,v5Compat:s=!1}=i,o=r.history,a=oh.Pop,l=null,c=h();c==null&&(c=0,o.replaceState(ix({},o.state,{idx:c}),""));function h(){return(o.state||{idx:null}).idx}function u(){a=oh.Pop;let g=h(),m=g==null?null:g-c;c=g,l&&l({action:a,location:v.location,delta:m})}function d(g,m){a=oh.Push;let y=cR(v.location,g,m);n&&n(y,g),c=h()+1;let _=kk(y,c),S=v.createHref(y);try{o.pushState(_,"",S)}catch{r.location.assign(S)}s&&l&&l({action:a,location:v.location,delta:1})}function f(g,m){a=oh.Replace;let y=cR(v.location,g,m);n&&n(y,g),c=h();let _=kk(y,c),S=v.createHref(y);o.replaceState(_,"",S),s&&l&&l({action:a,location:v.location,delta:0})}function p(g){let m=r.location.origin!=="null"?r.location.origin:r.location.href,y=typeof g=="string"?g:sA(g);return Gi(m,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,m)}let v={get action(){return a},get location(){return t(r,o)},listen(g){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(Uk,u),l=g,()=>{r.removeEventListener(Uk,u),l=null}},createHref(g){return e(r,g)},createURL:p,encodeLocation(g){let m=p(g);return{pathname:m.pathname,search:m.search,hash:m.hash}},push:d,replace:f,go(g){return o.go(g)}};return v}var zk;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(zk||(zk={}));function rie(t,e,n){n===void 0&&(n="/");let i=typeof e=="string"?$g(e):e,r=X3(i.pathname||"/",n);if(r==null)return null;let s=W9(t);sie(s);let o=null;for(let a=0;o==null&&a<s.length;++a)o=pie(s[a],vie(r));return o}function W9(t,e,n,i){e===void 0&&(e=[]),n===void 0&&(n=[]),i===void 0&&(i="");let r=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Gi(l.relativePath.startsWith(i),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+i+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(i.length));let c=Mh([i,l.relativePath]),h=n.concat(l);s.children&&s.children.length>0&&(Gi(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),W9(s.children,e,h,c)),!(s.path==null&&!s.index)&&e.push({path:c,score:die(c,s.index),routesMeta:h})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))r(s,o);else for(let l of X9(s.path))r(s,o,l)}),e}function X9(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,r=n.endsWith("?"),s=n.replace(/\?$/,"");if(i.length===0)return r?[s,""]:[s];let o=X9(i.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),r&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function sie(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:fie(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}const oie=/^:\w+$/,aie=3,lie=2,cie=1,uie=10,hie=-2,Gk=t=>t==="*";function die(t,e){let n=t.split("/"),i=n.length;return n.some(Gk)&&(i+=hie),e&&(i+=lie),n.filter(r=>!Gk(r)).reduce((r,s)=>r+(oie.test(s)?aie:s===""?cie:uie),i)}function fie(t,e){return t.length===e.length&&t.slice(0,-1).every((i,r)=>i===e[r])?t[t.length-1]-e[e.length-1]:0}function pie(t,e){let{routesMeta:n}=t,i={},r="/",s=[];for(let o=0;o<n.length;++o){let a=n[o],l=o===n.length-1,c=r==="/"?e:e.slice(r.length)||"/",h=mie({path:a.relativePath,caseSensitive:a.caseSensitive,end:l},c);if(!h)return null;Object.assign(i,h.params);let u=a.route;s.push({params:i,pathname:Mh([r,h.pathname]),pathnameBase:wie(Mh([r,h.pathnameBase])),route:u}),h.pathnameBase!=="/"&&(r=Mh([r,h.pathnameBase]))}return s}function mie(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=gie(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let s=r[0],o=s.replace(/(.)\/+$/,"$1"),a=r.slice(1);return{params:i.reduce((c,h,u)=>{if(h==="*"){let d=a[u]||"";o=s.slice(0,s.length-d.length).replace(/(.)\/+$/,"$1")}return c[h]=yie(a[u]||"",h),c},{}),pathname:s,pathnameBase:o,pattern:t}}function gie(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),W3(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let i=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(o,a)=>(i.push(a),"/([^\\/]+)"));return t.endsWith("*")?(i.push("*"),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),i]}function vie(t){try{return decodeURI(t)}catch(e){return W3(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function yie(t,e){try{return decodeURIComponent(t)}catch(n){return W3(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function X3(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}function xie(t,e){e===void 0&&(e="/");let{pathname:n,search:i="",hash:r=""}=typeof t=="string"?$g(t):t;return{pathname:n?n.startsWith("/")?n:_ie(n,e):e,search:Sie(i),hash:bie(r)}}function _ie(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function xT(t,e,n,i){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(i)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Y9(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function q9(t,e,n,i){i===void 0&&(i=!1);let r;typeof t=="string"?r=$g(t):(r=ix({},t),Gi(!r.pathname||!r.pathname.includes("?"),xT("?","pathname","search",r)),Gi(!r.pathname||!r.pathname.includes("#"),xT("#","pathname","hash",r)),Gi(!r.search||!r.search.includes("#"),xT("#","search","hash",r)));let s=t===""||r.pathname==="",o=s?"/":r.pathname,a;if(i||o==null)a=n;else{let u=e.length-1;if(o.startsWith("..")){let d=o.split("/");for(;d[0]==="..";)d.shift(),u-=1;r.pathname=d.join("/")}a=u>=0?e[u]:"/"}let l=xie(r,a),c=o&&o!=="/"&&o.endsWith("/"),h=(s||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(c||h)&&(l.pathname+="/"),l}const Mh=t=>t.join("/").replace(/\/\/+/g,"/"),wie=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Sie=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,bie=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Aie(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Q9=["post","put","patch","delete"];new Set(Q9);const Mie=["get",...Q9];new Set(Mie);/**
 * React Router v6.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function oA(){return oA=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},oA.apply(this,arguments)}const Y3=ge.createContext(null),Eie=ge.createContext(null),ev=ge.createContext(null),LM=ge.createContext(null),tv=ge.createContext({outlet:null,matches:[]}),K9=ge.createContext(null);function Cie(t,e){let{relative:n}=e===void 0?{}:e;Yx()||Gi(!1);let{basename:i,navigator:r}=ge.useContext(ev),{hash:s,pathname:o,search:a}=Z9(t,{relative:n}),l=o;return i!=="/"&&(l=o==="/"?i:Mh([i,o])),r.createHref({pathname:l,search:a,hash:s})}function Yx(){return ge.useContext(LM)!=null}function IM(){return Yx()||Gi(!1),ge.useContext(LM).location}function J9(t){ge.useContext(ev).static||ge.useLayoutEffect(t)}function Tie(){return ge.useContext(Y3)!=null?Gie():Pie()}function Pie(){Yx()||Gi(!1);let{basename:t,navigator:e}=ge.useContext(ev),{matches:n}=ge.useContext(tv),{pathname:i}=IM(),r=JSON.stringify(Y9(n).map(a=>a.pathnameBase)),s=ge.useRef(!1);return J9(()=>{s.current=!0}),ge.useCallback(function(a,l){if(l===void 0&&(l={}),!s.current)return;if(typeof a=="number"){e.go(a);return}let c=q9(a,JSON.parse(r),i,l.relative==="path");t!=="/"&&(c.pathname=c.pathname==="/"?t:Mh([t,c.pathname])),(l.replace?e.replace:e.push)(c,l.state,l)},[t,e,r,i])}function Z9(t,e){let{relative:n}=e===void 0?{}:e,{matches:i}=ge.useContext(tv),{pathname:r}=IM(),s=JSON.stringify(Y9(i).map(o=>o.pathnameBase));return ge.useMemo(()=>q9(t,JSON.parse(s),r,n==="path"),[t,s,r,n])}function Die(t,e){return Rie(t,e)}function Rie(t,e,n){Yx()||Gi(!1);let{navigator:i}=ge.useContext(ev),{matches:r}=ge.useContext(tv),s=r[r.length-1],o=s?s.params:{};s&&s.pathname;let a=s?s.pathnameBase:"/";s&&s.route;let l=IM(),c;if(e){var h;let v=typeof e=="string"?$g(e):e;a==="/"||(h=v.pathname)!=null&&h.startsWith(a)||Gi(!1),c=v}else c=l;let u=c.pathname||"/",d=a==="/"?u:u.slice(a.length)||"/",f=rie(t,{pathname:d}),p=Fie(f&&f.map(v=>Object.assign({},v,{params:Object.assign({},o,v.params),pathname:Mh([a,i.encodeLocation?i.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?a:Mh([a,i.encodeLocation?i.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),r,n);return e&&p?ge.createElement(LM.Provider,{value:{location:oA({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:oh.Pop}},p):p}function Lie(){let t=zie(),e=Aie(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return ge.createElement(ge.Fragment,null,ge.createElement("h2",null,"Unexpected Application Error!"),ge.createElement("h3",{style:{fontStyle:"italic"}},e),n?ge.createElement("pre",{style:r},n):null,s)}const Iie=ge.createElement(Lie,null);class Bie extends ge.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error?ge.createElement(tv.Provider,{value:this.props.routeContext},ge.createElement(K9.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Oie(t){let{routeContext:e,match:n,children:i}=t,r=ge.useContext(Y3);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),ge.createElement(tv.Provider,{value:e},i)}function Fie(t,e,n){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),t==null){var r;if((r=n)!=null&&r.errors)t=n.matches;else return null}let s=t,o=(i=n)==null?void 0:i.errors;if(o!=null){let a=s.findIndex(l=>l.route.id&&(o==null?void 0:o[l.route.id]));a>=0||Gi(!1),s=s.slice(0,Math.min(s.length,a+1))}return s.reduceRight((a,l,c)=>{let h=l.route.id?o==null?void 0:o[l.route.id]:null,u=null;n&&(u=l.route.errorElement||Iie);let d=e.concat(s.slice(0,c+1)),f=()=>{let p;return h?p=u:l.route.element?p=l.route.element:p=a,ge.createElement(Oie,{match:l,routeContext:{outlet:a,matches:d},children:p})};return n&&(l.route.ErrorBoundary||l.route.errorElement||c===0)?ge.createElement(Bie,{location:n.location,revalidation:n.revalidation,component:u,error:h,children:f(),routeContext:{outlet:null,matches:d}}):f()},null)}var uR;(function(t){t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate"})(uR||(uR={}));var rx;(function(t){t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId"})(rx||(rx={}));function Nie(t){let e=ge.useContext(Y3);return e||Gi(!1),e}function Uie(t){let e=ge.useContext(Eie);return e||Gi(!1),e}function kie(t){let e=ge.useContext(tv);return e||Gi(!1),e}function $9(t){let e=kie(),n=e.matches[e.matches.length-1];return n.route.id||Gi(!1),n.route.id}function zie(){var t;let e=ge.useContext(K9),n=Uie(rx.UseRouteError),i=$9(rx.UseRouteError);return e||((t=n.errors)==null?void 0:t[i])}function Gie(){let{router:t}=Nie(uR.UseNavigateStable),e=$9(rx.UseNavigateStable),n=ge.useRef(!1);return J9(()=>{n.current=!0}),ge.useCallback(function(r,s){s===void 0&&(s={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,oA({fromRouteId:e},s)))},[t,e])}function cm(t){Gi(!1)}function Hie(t){let{basename:e="/",children:n=null,location:i,navigationType:r=oh.Pop,navigator:s,static:o=!1}=t;Yx()&&Gi(!1);let a=e.replace(/^\/*/,"/"),l=ge.useMemo(()=>({basename:a,navigator:s,static:o}),[a,s,o]);typeof i=="string"&&(i=$g(i));let{pathname:c="/",search:h="",hash:u="",state:d=null,key:f="default"}=i,p=ge.useMemo(()=>{let v=X3(c,a);return v==null?null:{location:{pathname:v,search:h,hash:u,state:d,key:f},navigationType:r}},[a,c,h,u,d,f,r]);return p==null?null:ge.createElement(ev.Provider,{value:l},ge.createElement(LM.Provider,{children:n,value:p}))}function Vie(t){let{children:e,location:n}=t;return Die(hR(e),n)}var Hk;(function(t){t[t.pending=0]="pending",t[t.success=1]="success",t[t.error=2]="error"})(Hk||(Hk={}));new Promise(()=>{});function hR(t,e){e===void 0&&(e=[]);let n=[];return ge.Children.forEach(t,(i,r)=>{if(!ge.isValidElement(i))return;let s=[...e,r];if(i.type===ge.Fragment){n.push.apply(n,hR(i.props.children,s));return}i.type!==cm&&Gi(!1),!i.props.index||!i.props.children||Gi(!1);let o={id:i.props.id||s.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(o.children=hR(i.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.11.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function dR(){return dR=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},dR.apply(this,arguments)}function jie(t,e){if(t==null)return{};var n={},i=Object.keys(t),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function Wie(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Xie(t,e){return t.button===0&&(!e||e==="_self")&&!Wie(t)}const Yie=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function qie(t){let{basename:e,children:n,window:i}=t,r=ge.useRef();r.current==null&&(r.current=tie({window:i,v5Compat:!0}));let s=r.current,[o,a]=ge.useState({action:s.action,location:s.location});return ge.useLayoutEffect(()=>s.listen(a),[s]),ge.createElement(Hie,{basename:e,children:n,location:o.location,navigationType:o.action,navigator:s})}const Qie=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Kie=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Jie=ge.forwardRef(function(e,n){let{onClick:i,relative:r,reloadDocument:s,replace:o,state:a,target:l,to:c,preventScrollReset:h}=e,u=jie(e,Yie),{basename:d}=ge.useContext(ev),f,p=!1;if(typeof c=="string"&&Kie.test(c)&&(f=c,Qie))try{let y=new URL(window.location.href),_=c.startsWith("//")?new URL(y.protocol+c):new URL(c),S=X3(_.pathname,d);_.origin===y.origin&&S!=null?c=S+_.search+_.hash:p=!0}catch{}let v=Cie(c,{relative:r}),g=Zie(c,{replace:o,state:a,target:l,preventScrollReset:h,relative:r});function m(y){i&&i(y),y.defaultPrevented||g(y)}return ge.createElement("a",dR({},u,{href:f||v,onClick:p||s?i:m,ref:n,target:l}))});var Vk;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmitImpl="useSubmitImpl",t.UseFetcher="useFetcher"})(Vk||(Vk={}));var jk;(function(t){t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(jk||(jk={}));function Zie(t,e){let{target:n,replace:i,state:r,preventScrollReset:s,relative:o}=e===void 0?{}:e,a=Tie(),l=IM(),c=Z9(t,{relative:o});return ge.useCallback(h=>{if(Xie(h,n)){h.preventDefault();let u=i!==void 0?i:sA(l)===sA(c);a(t,{replace:u,state:r,preventScrollReset:s,relative:o})}},[l,a,c,i,r,n,t,s,o])}/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const BM="152",Rd={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Ld={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},eX=0,fR=1,tX=2,$ie=3,nX=0,OM=1,py=2,La=3,ql=0,fs=1,$o=2,ere=2,Wc=0,af=1,pR=2,mR=3,gR=4,iX=5,zd=100,rX=101,sX=102,vR=103,yR=104,oX=200,aX=201,lX=202,cX=203,q3=204,Q3=205,uX=206,hX=207,dX=208,fX=209,pX=210,mX=0,gX=1,vX=2,aA=3,yX=4,xX=5,_X=6,wX=7,qx=0,SX=1,bX=2,Va=0,AX=1,MX=2,EX=3,K3=4,CX=5,FM=300,Fh=301,Nh=302,sx=303,ox=304,nv=306,Uh=1e3,Cr=1001,Mg=1002,vi=1003,ax=1004,tre=1004,eg=1005,nre=1005,oi=1006,NM=1007,ire=1007,Ql=1008,rre=1008,tu=1009,TX=1010,PX=1011,J3=1012,DX=1013,ah=1014,Uc=1015,Eg=1016,RX=1017,LX=1018,lf=1020,IX=1021,Es=1023,BX=1024,OX=1025,Eh=1026,Ef=1027,FX=1028,NX=1029,UX=1030,kX=1031,zX=1033,ub=33776,hb=33777,db=33778,fb=33779,xR=35840,_R=35841,wR=35842,SR=35843,GX=36196,bR=37492,AR=37496,MR=37808,ER=37809,CR=37810,TR=37811,PR=37812,DR=37813,RR=37814,LR=37815,IR=37816,BR=37817,OR=37818,FR=37819,NR=37820,UR=37821,pb=36492,HX=36283,kR=36284,zR=36285,GR=36286,VX=2200,jX=2201,WX=2202,Cg=2300,Cf=2301,mb=2302,Kd=2400,Jd=2401,lx=2402,UM=2500,Z3=2501,XX=0,$3=1,lA=2,eB=3e3,mo=3001,YX=3200,qX=3201,Qh=0,QX=1,Ch="",Jt="srgb",Ya="srgb-linear",tB="display-p3",sre=0,gb=7680,ore=7681,are=7682,lre=7683,cre=34055,ure=34056,hre=5386,dre=512,fre=513,pre=514,mre=515,gre=516,vre=517,yre=518,KX=519,cx=35044,cf=35048,xre=35040,_re=35045,wre=35049,Sre=35041,bre=35046,Are=35050,Mre=35042,Ere="100",HR="300 es",cA=1035;class tc{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}const Gr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Wk=1234567;const uf=Math.PI/180,Tg=180/Math.PI;function go(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Gr[t&255]+Gr[t>>8&255]+Gr[t>>16&255]+Gr[t>>24&255]+"-"+Gr[e&255]+Gr[e>>8&255]+"-"+Gr[e>>16&15|64]+Gr[e>>24&255]+"-"+Gr[n&63|128]+Gr[n>>8&255]+"-"+Gr[n>>16&255]+Gr[n>>24&255]+Gr[i&255]+Gr[i>>8&255]+Gr[i>>16&255]+Gr[i>>24&255]).toLowerCase()}function yi(t,e,n){return Math.max(e,Math.min(n,t))}function nB(t,e){return(t%e+e)%e}function Cre(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)}function Tre(t,e,n){return t!==e?(n-t)/(e-t):0}function my(t,e,n){return(1-n)*t+n*e}function Pre(t,e,n,i){return my(t,e,1-Math.exp(-n*i))}function Dre(t,e=1){return e-Math.abs(nB(t,e*2)-e)}function Rre(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function Lre(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function Ire(t,e){return t+Math.floor(Math.random()*(e-t+1))}function Bre(t,e){return t+Math.random()*(e-t)}function Ore(t){return t*(.5-Math.random())}function Fre(t){t!==void 0&&(Wk=t);let e=Wk+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function Nre(t){return t*uf}function Ure(t){return t*Tg}function VR(t){return(t&t-1)===0&&t!==0}function JX(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function ZX(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function kre(t,e,n,i,r){const s=Math.cos,o=Math.sin,a=s(n/2),l=o(n/2),c=s((e+i)/2),h=o((e+i)/2),u=s((e-i)/2),d=o((e-i)/2),f=s((i-e)/2),p=o((i-e)/2);switch(r){case"XYX":t.set(a*h,l*u,l*d,a*c);break;case"YZY":t.set(l*d,a*h,l*u,a*c);break;case"ZXZ":t.set(l*u,l*d,a*h,a*c);break;case"XZX":t.set(a*h,l*p,l*f,a*c);break;case"YXY":t.set(l*f,a*h,l*p,a*c);break;case"ZYZ":t.set(l*p,l*f,a*h,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function ro(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function nn(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const $X={DEG2RAD:uf,RAD2DEG:Tg,generateUUID:go,clamp:yi,euclideanModulo:nB,mapLinear:Cre,inverseLerp:Tre,lerp:my,damp:Pre,pingpong:Dre,smoothstep:Rre,smootherstep:Lre,randInt:Ire,randFloat:Bre,randFloatSpread:Ore,seededRandom:Fre,degToRad:Nre,radToDeg:Ure,isPowerOfTwo:VR,ceilPowerOfTwo:JX,floorPowerOfTwo:ZX,setQuaternionFromProperEuler:kre,normalize:nn,denormalize:ro};class Ye{constructor(e=0,n=0){Ye.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,r=e.elements;return this.x=r[0]*n+r[3]*i+r[6],this.y=r[1]*n+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(yi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),r=Math.sin(n),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ln{constructor(){ln.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,n,i,r,s,o,a,l,c){const h=this.elements;return h[0]=e,h[1]=r,h[2]=a,h[3]=n,h[4]=s,h[5]=l,h[6]=i,h[7]=o,h[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,o=i[0],a=i[3],l=i[6],c=i[1],h=i[4],u=i[7],d=i[2],f=i[5],p=i[8],v=r[0],g=r[3],m=r[6],y=r[1],_=r[4],S=r[7],A=r[2],b=r[5],T=r[8];return s[0]=o*v+a*y+l*A,s[3]=o*g+a*_+l*b,s[6]=o*m+a*S+l*T,s[1]=c*v+h*y+u*A,s[4]=c*g+h*_+u*b,s[7]=c*m+h*S+u*T,s[2]=d*v+f*y+p*A,s[5]=d*g+f*_+p*b,s[8]=d*m+f*S+p*T,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8];return n*o*h-n*a*c-i*s*h+i*a*l+r*s*c-r*o*l}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8],u=h*o-a*c,d=a*l-h*s,f=c*s-o*l,p=n*u+i*d+r*f;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const v=1/p;return e[0]=u*v,e[1]=(r*c-h*i)*v,e[2]=(a*i-r*o)*v,e[3]=d*v,e[4]=(h*n-r*l)*v,e[5]=(r*s-a*n)*v,e[6]=f*v,e[7]=(i*l-c*n)*v,e[8]=(o*n-i*s)*v,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,r,s,o,a){const l=Math.cos(s),c=Math.sin(s);return this.set(i*l,i*c,-i*(l*o+c*a)+o+e,-r*c,r*l,-r*(-c*o+l*a)+a+n,0,0,1),this}scale(e,n){return this.premultiply(_T.makeScale(e,n)),this}rotate(e){return this.premultiply(_T.makeRotation(-e)),this}translate(e,n){return this.premultiply(_T.makeTranslation(e,n)),this}makeTranslation(e,n){return this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<9;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const _T=new ln;function e7(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}const zre={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Dm(t,e){return new zre[t](e)}function ux(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}const Xk={};function gy(t){t in Xk||(Xk[t]=!0,console.warn(t))}function tg(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function wT(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}const Gre=new ln().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),Hre=new ln().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]);function Vre(t){return t.convertSRGBToLinear().applyMatrix3(Hre)}function jre(t){return t.applyMatrix3(Gre).convertLinearToSRGB()}const Wre={[Ya]:t=>t,[Jt]:t=>t.convertSRGBToLinear(),[tB]:Vre},Xre={[Ya]:t=>t,[Jt]:t=>t.convertLinearToSRGB(),[tB]:jre},Go={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(t){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!t},get workingColorSpace(){return Ya},set workingColorSpace(t){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(t,e,n){if(this.enabled===!1||e===n||!e||!n)return t;const i=Wre[e],r=Xre[n];if(i===void 0||r===void 0)throw new Error(`Unsupported color space conversion, "${e}" to "${n}".`);return r(i(t))},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}};let dp;class iB{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{dp===void 0&&(dp=ux("canvas")),dp.width=e.width,dp.height=e.height;const i=dp.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),n=dp}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=ux("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=tg(s[o]/255)*255;return i.putImageData(r,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(tg(n[i]/255)*255):n[i]=tg(n[i]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Zd{constructor(e=null){this.isSource=!0,this.uuid=go(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(ST(r[o].image)):s.push(ST(r[o]))}else s=ST(r);i.url=s}return n||(e.images[this.uuid]=i),i}}function ST(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?iB.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Yre=0;class ni extends tc{constructor(e=ni.DEFAULT_IMAGE,n=ni.DEFAULT_MAPPING,i=Cr,r=Cr,s=oi,o=Ql,a=Es,l=tu,c=ni.DEFAULT_ANISOTROPY,h=Ch){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Yre++}),this.uuid=go(),this.name="",this.source=new Zd(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=c,this.format=a,this.internalFormat=null,this.type=l,this.offset=new Ye(0,0),this.repeat=new Ye(1,1),this.center=new Ye(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ln,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof h=="string"?this.colorSpace=h:(gy("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=h===mo?Jt:Ch),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==FM)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Uh:e.x=e.x-Math.floor(e.x);break;case Cr:e.x=e.x<0?0:1;break;case Mg:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Uh:e.y=e.y-Math.floor(e.y);break;case Cr:e.y=e.y<0?0:1;break;case Mg:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return gy("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Jt?mo:eB}set encoding(e){gy("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===mo?Jt:Ch}}ni.DEFAULT_IMAGE=null;ni.DEFAULT_MAPPING=FM;ni.DEFAULT_ANISOTROPY=1;class Dn{constructor(e=0,n=0,i=0,r=1){Dn.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*n+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*n+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*n+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*n+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,r,s;const l=e.elements,c=l[0],h=l[4],u=l[8],d=l[1],f=l[5],p=l[9],v=l[2],g=l[6],m=l[10];if(Math.abs(h-d)<.01&&Math.abs(u-v)<.01&&Math.abs(p-g)<.01){if(Math.abs(h+d)<.1&&Math.abs(u+v)<.1&&Math.abs(p+g)<.1&&Math.abs(c+f+m-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const _=(c+1)/2,S=(f+1)/2,A=(m+1)/2,b=(h+d)/4,T=(u+v)/4,M=(p+g)/4;return _>S&&_>A?_<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(_),r=b/i,s=T/i):S>A?S<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(S),i=b/r,s=M/r):A<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(A),i=T/s,r=M/s),this.set(i,r,s,n),this}let y=Math.sqrt((g-p)*(g-p)+(u-v)*(u-v)+(d-h)*(d-h));return Math.abs(y)<.001&&(y=1),this.x=(g-p)/y,this.y=(u-v)/y,this.z=(d-h)/y,this.w=Math.acos((c+f+m-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class qa extends tc{constructor(e=1,n=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=n,this.depth=1,this.scissor=new Dn(0,0,e,n),this.scissorTest=!1,this.viewport=new Dn(0,0,e,n);const r={width:e,height:n,depth:1};i.encoding!==void 0&&(gy("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===mo?Jt:Ch),this.texture=new ni(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:oi,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(e,n,i=1){(this.width!==e||this.height!==n||this.depth!==i)&&(this.width=e,this.height=n,this.depth=i,this.texture.image.width=e,this.texture.image.height=n,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const n=Object.assign({},e.texture.image);return this.texture.source=new Zd(n),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class kM extends ni{constructor(e=null,n=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=vi,this.minFilter=vi,this.wrapR=Cr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class qre extends qa{constructor(e=1,n=1,i=1){super(e,n),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new kM(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class rB extends ni{constructor(e=null,n=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=vi,this.minFilter=vi,this.wrapR=Cr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Qre extends qa{constructor(e=1,n=1,i=1){super(e,n),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new rB(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class Kre extends qa{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<i;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,n,i=1){if(this.width!==e||this.height!==n||this.depth!==i){this.width=e,this.height=n,this.depth=i;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=n,this.texture[r].image.depth=i;this.dispose()}return this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let n=0,i=e.texture.length;n<i;n++)this.texture[n]=e.texture[n].clone(),this.texture[n].isRenderTargetTexture=!0;return this}}class xr{constructor(e=0,n=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=r}static slerpFlat(e,n,i,r,s,o,a){let l=i[r+0],c=i[r+1],h=i[r+2],u=i[r+3];const d=s[o+0],f=s[o+1],p=s[o+2],v=s[o+3];if(a===0){e[n+0]=l,e[n+1]=c,e[n+2]=h,e[n+3]=u;return}if(a===1){e[n+0]=d,e[n+1]=f,e[n+2]=p,e[n+3]=v;return}if(u!==v||l!==d||c!==f||h!==p){let g=1-a;const m=l*d+c*f+h*p+u*v,y=m>=0?1:-1,_=1-m*m;if(_>Number.EPSILON){const A=Math.sqrt(_),b=Math.atan2(A,m*y);g=Math.sin(g*b)/A,a=Math.sin(a*b)/A}const S=a*y;if(l=l*g+d*S,c=c*g+f*S,h=h*g+p*S,u=u*g+v*S,g===1-a){const A=1/Math.sqrt(l*l+c*c+h*h+u*u);l*=A,c*=A,h*=A,u*=A}}e[n]=l,e[n+1]=c,e[n+2]=h,e[n+3]=u}static multiplyQuaternionsFlat(e,n,i,r,s,o){const a=i[r],l=i[r+1],c=i[r+2],h=i[r+3],u=s[o],d=s[o+1],f=s[o+2],p=s[o+3];return e[n]=a*p+h*u+l*f-c*d,e[n+1]=l*p+h*d+c*u-a*f,e[n+2]=c*p+h*f+a*d-l*u,e[n+3]=h*p-a*u-l*d-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,r){return this._x=e,this._y=n,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,l=Math.sin,c=a(i/2),h=a(r/2),u=a(s/2),d=l(i/2),f=l(r/2),p=l(s/2);switch(o){case"XYZ":this._x=d*h*u+c*f*p,this._y=c*f*u-d*h*p,this._z=c*h*p+d*f*u,this._w=c*h*u-d*f*p;break;case"YXZ":this._x=d*h*u+c*f*p,this._y=c*f*u-d*h*p,this._z=c*h*p-d*f*u,this._w=c*h*u+d*f*p;break;case"ZXY":this._x=d*h*u-c*f*p,this._y=c*f*u+d*h*p,this._z=c*h*p+d*f*u,this._w=c*h*u-d*f*p;break;case"ZYX":this._x=d*h*u-c*f*p,this._y=c*f*u+d*h*p,this._z=c*h*p-d*f*u,this._w=c*h*u+d*f*p;break;case"YZX":this._x=d*h*u+c*f*p,this._y=c*f*u+d*h*p,this._z=c*h*p-d*f*u,this._w=c*h*u-d*f*p;break;case"XZY":this._x=d*h*u-c*f*p,this._y=c*f*u-d*h*p,this._z=c*h*p+d*f*u,this._w=c*h*u+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return n!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],r=n[4],s=n[8],o=n[1],a=n[5],l=n[9],c=n[2],h=n[6],u=n[10],d=i+a+u;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(h-l)*f,this._y=(s-c)*f,this._z=(o-r)*f}else if(i>a&&i>u){const f=2*Math.sqrt(1+i-a-u);this._w=(h-l)/f,this._x=.25*f,this._y=(r+o)/f,this._z=(s+c)/f}else if(a>u){const f=2*Math.sqrt(1+a-i-u);this._w=(s-c)/f,this._x=(r+o)/f,this._y=.25*f,this._z=(l+h)/f}else{const f=2*Math.sqrt(1+u-i-a);this._w=(o-r)/f,this._x=(s+c)/f,this._y=(l+h)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(yi(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,n/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,r=e._y,s=e._z,o=e._w,a=n._x,l=n._y,c=n._z,h=n._w;return this._x=i*h+o*a+r*c-s*l,this._y=r*h+o*l+s*a-i*c,this._z=s*h+o*c+i*l-r*a,this._w=o*h-i*a-r*l-s*c,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const l=1-a*a;if(l<=Number.EPSILON){const f=1-n;return this._w=f*o+n*this._w,this._x=f*i+n*this._x,this._y=f*r+n*this._y,this._z=f*s+n*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),h=Math.atan2(c,a),u=Math.sin((1-n)*h)/c,d=Math.sin(n*h)/c;return this._w=o*u+this._w*d,this._x=i*u+this._x*d,this._y=r*u+this._y*d,this._z=s*u+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=Math.random(),n=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(n*Math.cos(r),i*Math.sin(s),i*Math.cos(s),n*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ae{constructor(e=0,n=0,i=0){ae.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(Yk.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(Yk.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6]*r,this.y=s[1]*n+s[4]*i+s[7]*r,this.z=s[2]*n+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*n+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*n+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*n+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*n+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const n=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*n+o*r-a*i,h=l*i+a*n-s*r,u=l*r+s*i-o*n,d=-s*n-o*i-a*r;return this.x=c*l+d*-s+h*-a-u*-o,this.y=h*l+d*-o+u*-s-c*-a,this.z=u*l+d*-a+c*-o-h*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[4]*i+s[8]*r,this.y=s[1]*n+s[5]*i+s[9]*r,this.z=s[2]*n+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,r=e.y,s=e.z,o=n.x,a=n.y,l=n.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return bT.copy(this).projectOnVector(e),this.sub(bT)}reflect(e){return this.sub(bT.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(yi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return n*n+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const r=Math.sin(n)*e;return this.x=r*Math.sin(i),this.y=Math.cos(n)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=r,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,n=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(n),this.y=i*Math.sin(n),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const bT=new ae,Yk=new xr;class $a{constructor(e=new ae(1/0,1/0,1/0),n=new ae(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(fc.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(fc.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=fc.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){if(e.updateWorldMatrix(!1,!1),e.boundingBox!==void 0)e.boundingBox===null&&e.computeBoundingBox(),fp.copy(e.boundingBox),fp.applyMatrix4(e.matrixWorld),this.union(fp);else{const r=e.geometry;if(r!==void 0)if(n&&r.attributes!==void 0&&r.attributes.position!==void 0){const s=r.attributes.position;for(let o=0,a=s.count;o<a;o++)fc.fromBufferAttribute(s,o).applyMatrix4(e.matrixWorld),this.expandByPoint(fc)}else r.boundingBox===null&&r.computeBoundingBox(),fp.copy(r.boundingBox),fp.applyMatrix4(e.matrixWorld),this.union(fp)}const i=e.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],n);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,fc),fc.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Qv),Y_.subVectors(this.max,Qv),pp.subVectors(e.a,Qv),mp.subVectors(e.b,Qv),gp.subVectors(e.c,Qv),bu.subVectors(mp,pp),Au.subVectors(gp,mp),dd.subVectors(pp,gp);let n=[0,-bu.z,bu.y,0,-Au.z,Au.y,0,-dd.z,dd.y,bu.z,0,-bu.x,Au.z,0,-Au.x,dd.z,0,-dd.x,-bu.y,bu.x,0,-Au.y,Au.x,0,-dd.y,dd.x,0];return!AT(n,pp,mp,gp,Y_)||(n=[1,0,0,0,1,0,0,0,1],!AT(n,pp,mp,gp,Y_))?!1:(q_.crossVectors(bu,Au),n=[q_.x,q_.y,q_.z],AT(n,pp,mp,gp,Y_))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,fc).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(fc).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(dc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),dc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),dc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),dc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),dc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),dc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),dc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),dc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(dc),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const dc=[new ae,new ae,new ae,new ae,new ae,new ae,new ae,new ae],fc=new ae,fp=new $a,pp=new ae,mp=new ae,gp=new ae,bu=new ae,Au=new ae,dd=new ae,Qv=new ae,Y_=new ae,q_=new ae,fd=new ae;function AT(t,e,n,i,r){for(let s=0,o=t.length-3;s<=o;s+=3){fd.fromArray(t,s);const a=r.x*Math.abs(fd.x)+r.y*Math.abs(fd.y)+r.z*Math.abs(fd.z),l=e.dot(fd),c=n.dot(fd),h=i.dot(fd);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>a)return!1}return!0}const Jre=new $a,Kv=new ae,MT=new ae;class el{constructor(e=new ae,n=-1){this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):Jre.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Kv.subVectors(e,this.center);const n=Kv.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),r=(i-this.radius)*.5;this.center.addScaledVector(Kv,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(MT.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Kv.copy(e.center).add(MT)),this.expandByPoint(Kv.copy(e.center).sub(MT))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const pc=new ae,ET=new ae,Q_=new ae,Mu=new ae,CT=new ae,K_=new ae,TT=new ae;class Qx{constructor(e=new ae,n=new ae(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,pc)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=pc.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(pc.copy(this.origin).addScaledVector(this.direction,n),pc.distanceToSquared(e))}distanceSqToSegment(e,n,i,r){ET.copy(e).add(n).multiplyScalar(.5),Q_.copy(n).sub(e).normalize(),Mu.copy(this.origin).sub(ET);const s=e.distanceTo(n)*.5,o=-this.direction.dot(Q_),a=Mu.dot(this.direction),l=-Mu.dot(Q_),c=Mu.lengthSq(),h=Math.abs(1-o*o);let u,d,f,p;if(h>0)if(u=o*l-a,d=o*a-l,p=s*h,u>=0)if(d>=-p)if(d<=p){const v=1/h;u*=v,d*=v,f=u*(u+o*d+2*a)+d*(o*u+d+2*l)+c}else d=s,u=Math.max(0,-(o*d+a)),f=-u*u+d*(d+2*l)+c;else d=-s,u=Math.max(0,-(o*d+a)),f=-u*u+d*(d+2*l)+c;else d<=-p?(u=Math.max(0,-(-o*s+a)),d=u>0?-s:Math.min(Math.max(-s,-l),s),f=-u*u+d*(d+2*l)+c):d<=p?(u=0,d=Math.min(Math.max(-s,-l),s),f=d*(d+2*l)+c):(u=Math.max(0,-(o*s+a)),d=u>0?s:Math.min(Math.max(-s,-l),s),f=-u*u+d*(d+2*l)+c);else d=o>0?-s:s,u=Math.max(0,-(o*d+a)),f=-u*u+d*(d+2*l)+c;return i&&i.copy(this.origin).addScaledVector(this.direction,u),r&&r.copy(ET).addScaledVector(Q_,d),f}intersectSphere(e,n){pc.subVectors(e.center,this.origin);const i=pc.dot(this.direction),r=pc.dot(pc)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,l=i+o;return l<0?null:a<0?this.at(l,n):this.at(a,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,r,s,o,a,l;const c=1/this.direction.x,h=1/this.direction.y,u=1/this.direction.z,d=this.origin;return c>=0?(i=(e.min.x-d.x)*c,r=(e.max.x-d.x)*c):(i=(e.max.x-d.x)*c,r=(e.min.x-d.x)*c),h>=0?(s=(e.min.y-d.y)*h,o=(e.max.y-d.y)*h):(s=(e.max.y-d.y)*h,o=(e.min.y-d.y)*h),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),u>=0?(a=(e.min.z-d.z)*u,l=(e.max.z-d.z)*u):(a=(e.max.z-d.z)*u,l=(e.min.z-d.z)*u),i>l||a>r)||((a>i||i!==i)&&(i=a),(l<r||r!==r)&&(r=l),r<0)?null:this.at(i>=0?i:r,n)}intersectsBox(e){return this.intersectBox(e,pc)!==null}intersectTriangle(e,n,i,r,s){CT.subVectors(n,e),K_.subVectors(i,e),TT.crossVectors(CT,K_);let o=this.direction.dot(TT),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Mu.subVectors(this.origin,e);const l=a*this.direction.dot(K_.crossVectors(Mu,K_));if(l<0)return null;const c=a*this.direction.dot(CT.cross(Mu));if(c<0||l+c>o)return null;const h=-a*Mu.dot(TT);return h<0?null:this.at(h/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class kt{constructor(){kt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,n,i,r,s,o,a,l,c,h,u,d,f,p,v,g){const m=this.elements;return m[0]=e,m[4]=n,m[8]=i,m[12]=r,m[1]=s,m[5]=o,m[9]=a,m[13]=l,m[2]=c,m[6]=h,m[10]=u,m[14]=d,m[3]=f,m[7]=p,m[11]=v,m[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new kt().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,r=1/vp.setFromMatrixColumn(e,0).length(),s=1/vp.setFromMatrixColumn(e,1).length(),o=1/vp.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[3]=0,n[4]=i[4]*s,n[5]=i[5]*s,n[6]=i[6]*s,n[7]=0,n[8]=i[8]*o,n[9]=i[9]*o,n[10]=i[10]*o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),h=Math.cos(s),u=Math.sin(s);if(e.order==="XYZ"){const d=o*h,f=o*u,p=a*h,v=a*u;n[0]=l*h,n[4]=-l*u,n[8]=c,n[1]=f+p*c,n[5]=d-v*c,n[9]=-a*l,n[2]=v-d*c,n[6]=p+f*c,n[10]=o*l}else if(e.order==="YXZ"){const d=l*h,f=l*u,p=c*h,v=c*u;n[0]=d+v*a,n[4]=p*a-f,n[8]=o*c,n[1]=o*u,n[5]=o*h,n[9]=-a,n[2]=f*a-p,n[6]=v+d*a,n[10]=o*l}else if(e.order==="ZXY"){const d=l*h,f=l*u,p=c*h,v=c*u;n[0]=d-v*a,n[4]=-o*u,n[8]=p+f*a,n[1]=f+p*a,n[5]=o*h,n[9]=v-d*a,n[2]=-o*c,n[6]=a,n[10]=o*l}else if(e.order==="ZYX"){const d=o*h,f=o*u,p=a*h,v=a*u;n[0]=l*h,n[4]=p*c-f,n[8]=d*c+v,n[1]=l*u,n[5]=v*c+d,n[9]=f*c-p,n[2]=-c,n[6]=a*l,n[10]=o*l}else if(e.order==="YZX"){const d=o*l,f=o*c,p=a*l,v=a*c;n[0]=l*h,n[4]=v-d*u,n[8]=p*u+f,n[1]=u,n[5]=o*h,n[9]=-a*h,n[2]=-c*h,n[6]=f*u+p,n[10]=d-v*u}else if(e.order==="XZY"){const d=o*l,f=o*c,p=a*l,v=a*c;n[0]=l*h,n[4]=-u,n[8]=c*h,n[1]=d*u+v,n[5]=o*h,n[9]=f*u-p,n[2]=p*u-f,n[6]=a*h,n[10]=v*u+d}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Zre,e,$re)}lookAt(e,n,i){const r=this.elements;return Xs.subVectors(e,n),Xs.lengthSq()===0&&(Xs.z=1),Xs.normalize(),Eu.crossVectors(i,Xs),Eu.lengthSq()===0&&(Math.abs(i.z)===1?Xs.x+=1e-4:Xs.z+=1e-4,Xs.normalize(),Eu.crossVectors(i,Xs)),Eu.normalize(),J_.crossVectors(Xs,Eu),r[0]=Eu.x,r[4]=J_.x,r[8]=Xs.x,r[1]=Eu.y,r[5]=J_.y,r[9]=Xs.y,r[2]=Eu.z,r[6]=J_.z,r[10]=Xs.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],h=i[1],u=i[5],d=i[9],f=i[13],p=i[2],v=i[6],g=i[10],m=i[14],y=i[3],_=i[7],S=i[11],A=i[15],b=r[0],T=r[4],M=r[8],E=r[12],P=r[1],R=r[5],F=r[9],B=r[13],k=r[2],j=r[6],Z=r[10],ee=r[14],O=r[3],W=r[7],H=r[11],Y=r[15];return s[0]=o*b+a*P+l*k+c*O,s[4]=o*T+a*R+l*j+c*W,s[8]=o*M+a*F+l*Z+c*H,s[12]=o*E+a*B+l*ee+c*Y,s[1]=h*b+u*P+d*k+f*O,s[5]=h*T+u*R+d*j+f*W,s[9]=h*M+u*F+d*Z+f*H,s[13]=h*E+u*B+d*ee+f*Y,s[2]=p*b+v*P+g*k+m*O,s[6]=p*T+v*R+g*j+m*W,s[10]=p*M+v*F+g*Z+m*H,s[14]=p*E+v*B+g*ee+m*Y,s[3]=y*b+_*P+S*k+A*O,s[7]=y*T+_*R+S*j+A*W,s[11]=y*M+_*F+S*Z+A*H,s[15]=y*E+_*B+S*ee+A*Y,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],h=e[2],u=e[6],d=e[10],f=e[14],p=e[3],v=e[7],g=e[11],m=e[15];return p*(+s*l*u-r*c*u-s*a*d+i*c*d+r*a*f-i*l*f)+v*(+n*l*f-n*c*d+s*o*d-r*o*f+r*c*h-s*l*h)+g*(+n*c*u-n*a*f-s*o*u+i*o*f+s*a*h-i*c*h)+m*(-r*a*h-n*l*u+n*a*d+r*o*u-i*o*d+i*l*h)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=n,r[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8],u=e[9],d=e[10],f=e[11],p=e[12],v=e[13],g=e[14],m=e[15],y=u*g*c-v*d*c+v*l*f-a*g*f-u*l*m+a*d*m,_=p*d*c-h*g*c-p*l*f+o*g*f+h*l*m-o*d*m,S=h*v*c-p*u*c+p*a*f-o*v*f-h*a*m+o*u*m,A=p*u*l-h*v*l-p*a*d+o*v*d+h*a*g-o*u*g,b=n*y+i*_+r*S+s*A;if(b===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const T=1/b;return e[0]=y*T,e[1]=(v*d*s-u*g*s-v*r*f+i*g*f+u*r*m-i*d*m)*T,e[2]=(a*g*s-v*l*s+v*r*c-i*g*c-a*r*m+i*l*m)*T,e[3]=(u*l*s-a*d*s-u*r*c+i*d*c+a*r*f-i*l*f)*T,e[4]=_*T,e[5]=(h*g*s-p*d*s+p*r*f-n*g*f-h*r*m+n*d*m)*T,e[6]=(p*l*s-o*g*s-p*r*c+n*g*c+o*r*m-n*l*m)*T,e[7]=(o*d*s-h*l*s+h*r*c-n*d*c-o*r*f+n*l*f)*T,e[8]=S*T,e[9]=(p*u*s-h*v*s-p*i*f+n*v*f+h*i*m-n*u*m)*T,e[10]=(o*v*s-p*a*s+p*i*c-n*v*c-o*i*m+n*a*m)*T,e[11]=(h*a*s-o*u*s-h*i*c+n*u*c+o*i*f-n*a*f)*T,e[12]=A*T,e[13]=(h*v*r-p*u*r+p*i*d-n*v*d-h*i*g+n*u*g)*T,e[14]=(p*a*r-o*v*r-p*i*l+n*v*l+o*i*g-n*a*g)*T,e[15]=(o*u*r-h*a*r+h*i*l-n*u*l-o*i*d+n*a*d)*T,this}scale(e){const n=this.elements,i=e.x,r=e.y,s=e.z;return n[0]*=i,n[4]*=r,n[8]*=s,n[1]*=i,n[5]*=r,n[9]*=s,n[2]*=i,n[6]*=r,n[10]*=s,n[3]*=i,n[7]*=r,n[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,r))}makeTranslation(e,n,i){return this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),r=Math.sin(n),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,h=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,h*a+i,h*l-r*o,0,c*l-r*a,h*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,n,r,1,0,0,0,0,1),this}compose(e,n,i){const r=this.elements,s=n._x,o=n._y,a=n._z,l=n._w,c=s+s,h=o+o,u=a+a,d=s*c,f=s*h,p=s*u,v=o*h,g=o*u,m=a*u,y=l*c,_=l*h,S=l*u,A=i.x,b=i.y,T=i.z;return r[0]=(1-(v+m))*A,r[1]=(f+S)*A,r[2]=(p-_)*A,r[3]=0,r[4]=(f-S)*b,r[5]=(1-(d+m))*b,r[6]=(g+y)*b,r[7]=0,r[8]=(p+_)*T,r[9]=(g-y)*T,r[10]=(1-(d+v))*T,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,n,i){const r=this.elements;let s=vp.set(r[0],r[1],r[2]).length();const o=vp.set(r[4],r[5],r[6]).length(),a=vp.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],xa.copy(this);const c=1/s,h=1/o,u=1/a;return xa.elements[0]*=c,xa.elements[1]*=c,xa.elements[2]*=c,xa.elements[4]*=h,xa.elements[5]*=h,xa.elements[6]*=h,xa.elements[8]*=u,xa.elements[9]*=u,xa.elements[10]*=u,n.setFromRotationMatrix(xa),i.x=s,i.y=o,i.z=a,this}makePerspective(e,n,i,r,s,o){const a=this.elements,l=2*s/(n-e),c=2*s/(i-r),h=(n+e)/(n-e),u=(i+r)/(i-r),d=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=l,a[4]=0,a[8]=h,a[12]=0,a[1]=0,a[5]=c,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,n,i,r,s,o){const a=this.elements,l=1/(n-e),c=1/(i-r),h=1/(o-s),u=(n+e)*l,d=(i+r)*c,f=(o+s)*h;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*h,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<16;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}}const vp=new ae,xa=new kt,Zre=new ae(0,0,0),$re=new ae(1,1,1),Eu=new ae,J_=new ae,Xs=new ae,qk=new kt,Qk=new xr;class Kx{constructor(e=0,n=0,i=0,r=Kx.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,r=this._order){return this._x=e,this._y=n,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],l=r[1],c=r[5],h=r[9],u=r[2],d=r[6],f=r[10];switch(n){case"XYZ":this._y=Math.asin(yi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-h,f),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-yi(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(a,f),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-u,s),this._z=0);break;case"ZXY":this._x=Math.asin(yi(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-u,f),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-yi(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(yi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,c),this._y=Math.atan2(-u,s)):(this._x=0,this._y=Math.atan2(a,f));break;case"XZY":this._z=Math.asin(-yi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-h,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return qk.makeRotationFromQuaternion(e),this.setFromRotationMatrix(qk,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return Qk.setFromEuler(this),this.setFromQuaternion(Qk,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Kx.DEFAULT_ORDER="XYZ";class hf{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let ese=0;const Kk=new ae,yp=new xr,mc=new kt,Z_=new ae,Jv=new ae,tse=new ae,nse=new xr,Jk=new ae(1,0,0),Zk=new ae(0,1,0),$k=new ae(0,0,1),ise={type:"added"},ez={type:"removed"};class mn extends tc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ese++}),this.uuid=go(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=mn.DEFAULT_UP.clone();const e=new ae,n=new Kx,i=new xr,r=new ae(1,1,1);function s(){i.setFromEuler(n,!1)}function o(){n.setFromQuaternion(i,void 0,!1)}n._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new kt},normalMatrix:{value:new ln}}),this.matrix=new kt,this.matrixWorld=new kt,this.matrixAutoUpdate=mn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=mn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new hf,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return yp.setFromAxisAngle(e,n),this.quaternion.multiply(yp),this}rotateOnWorldAxis(e,n){return yp.setFromAxisAngle(e,n),this.quaternion.premultiply(yp),this}rotateX(e){return this.rotateOnAxis(Jk,e)}rotateY(e){return this.rotateOnAxis(Zk,e)}rotateZ(e){return this.rotateOnAxis($k,e)}translateOnAxis(e,n){return Kk.copy(e).applyQuaternion(this.quaternion),this.position.add(Kk.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(Jk,e)}translateY(e){return this.translateOnAxis(Zk,e)}translateZ(e){return this.translateOnAxis($k,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(mc.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?Z_.copy(e):Z_.set(e,n,i);const r=this.parent;this.updateWorldMatrix(!0,!1),Jv.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?mc.lookAt(Jv,Z_,this.up):mc.lookAt(Z_,Jv,this.up),this.quaternion.setFromRotationMatrix(mc),r&&(mc.extractRotation(r.matrixWorld),yp.setFromRotationMatrix(mc),this.quaternion.premultiply(yp.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(ise)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(ez)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const n=this.children[e];n.parent=null,n.dispatchEvent(ez)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),mc.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),mc.multiply(e.parent.matrixWorld)),e.applyMatrix4(mc),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,n);if(o!==void 0)return o}}getObjectsByProperty(e,n){let i=[];this[e]===n&&i.push(this);for(let r=0,s=this.children.length;r<s;r++){const o=this.children[r].getObjectsByProperty(e,n);o.length>0&&(i=i.concat(o))}return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Jv,e,tse),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Jv,nse,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,r=n.length;i<r;i++){const s=n[i];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++){const a=r[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function s(a,l){return a[l.uuid]===void 0&&(a[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const l=a.shapes;if(Array.isArray(l))for(let c=0,h=l.length;c<h;c++){const u=l[c];s(e.shapes,u)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let l=0,c=this.material.length;l<c;l++)a.push(s(e.materials,this.material[l]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const l=this.animations[a];r.animations.push(s(e.animations,l))}}if(n){const a=o(e.geometries),l=o(e.materials),c=o(e.textures),h=o(e.images),u=o(e.shapes),d=o(e.skeletons),f=o(e.animations),p=o(e.nodes);a.length>0&&(i.geometries=a),l.length>0&&(i.materials=l),c.length>0&&(i.textures=c),h.length>0&&(i.images=h),u.length>0&&(i.shapes=u),d.length>0&&(i.skeletons=d),f.length>0&&(i.animations=f),p.length>0&&(i.nodes=p)}return i.object=r,i;function o(a){const l=[];for(const c in a){const h=a[c];delete h.metadata,l.push(h)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations,this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}mn.DEFAULT_UP=new ae(0,1,0);mn.DEFAULT_MATRIX_AUTO_UPDATE=!0;mn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _a=new ae,gc=new ae,PT=new ae,vc=new ae,xp=new ae,_p=new ae,tz=new ae,DT=new ae,RT=new ae,LT=new ae;let $_=!1;class Ms{constructor(e=new ae,n=new ae,i=new ae){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,r){r.subVectors(i,n),_a.subVectors(e,n),r.cross(_a);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,n,i,r,s){_a.subVectors(r,n),gc.subVectors(i,n),PT.subVectors(e,n);const o=_a.dot(_a),a=_a.dot(gc),l=_a.dot(PT),c=gc.dot(gc),h=gc.dot(PT),u=o*c-a*a;if(u===0)return s.set(-2,-1,-1);const d=1/u,f=(c*l-a*h)*d,p=(o*h-a*l)*d;return s.set(1-f-p,p,f)}static containsPoint(e,n,i,r){return this.getBarycoord(e,n,i,r,vc),vc.x>=0&&vc.y>=0&&vc.x+vc.y<=1}static getUV(e,n,i,r,s,o,a,l){return $_===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),$_=!0),this.getInterpolation(e,n,i,r,s,o,a,l)}static getInterpolation(e,n,i,r,s,o,a,l){return this.getBarycoord(e,n,i,r,vc),l.setScalar(0),l.addScaledVector(s,vc.x),l.addScaledVector(o,vc.y),l.addScaledVector(a,vc.z),l}static isFrontFacing(e,n,i,r){return _a.subVectors(i,n),gc.subVectors(e,n),_a.cross(gc).dot(r)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,r){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,n,i,r){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return _a.subVectors(this.c,this.b),gc.subVectors(this.a,this.b),_a.cross(gc).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Ms.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return Ms.getBarycoord(e,this.a,this.b,this.c,n)}getUV(e,n,i,r,s){return $_===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),$_=!0),Ms.getInterpolation(e,this.a,this.b,this.c,n,i,r,s)}getInterpolation(e,n,i,r,s){return Ms.getInterpolation(e,this.a,this.b,this.c,n,i,r,s)}containsPoint(e){return Ms.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Ms.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,r=this.b,s=this.c;let o,a;xp.subVectors(r,i),_p.subVectors(s,i),DT.subVectors(e,i);const l=xp.dot(DT),c=_p.dot(DT);if(l<=0&&c<=0)return n.copy(i);RT.subVectors(e,r);const h=xp.dot(RT),u=_p.dot(RT);if(h>=0&&u<=h)return n.copy(r);const d=l*u-h*c;if(d<=0&&l>=0&&h<=0)return o=l/(l-h),n.copy(i).addScaledVector(xp,o);LT.subVectors(e,s);const f=xp.dot(LT),p=_p.dot(LT);if(p>=0&&f<=p)return n.copy(s);const v=f*c-l*p;if(v<=0&&c>=0&&p<=0)return a=c/(c-p),n.copy(i).addScaledVector(_p,a);const g=h*p-f*u;if(g<=0&&u-h>=0&&f-p>=0)return tz.subVectors(s,r),a=(u-h)/(u-h+(f-p)),n.copy(r).addScaledVector(tz,a);const m=1/(g+v+d);return o=v*m,a=d*m,n.copy(i).addScaledVector(xp,o).addScaledVector(_p,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let rse=0;class Hi extends tc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:rse++}),this.uuid=go(),this.name="",this.type="Material",this.blending=af,this.side=ql,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=q3,this.blendDst=Q3,this.blendEquation=zd,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=aA,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=KX,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=gb,this.stencilZFail=gb,this.stencilZPass=gb,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const i=e[n];if(i===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const r=this[n];if(r===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==af&&(i.blending=this.blending),this.side!==ql&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(i.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const l=s[a];delete l.metadata,o.push(l)}return o}if(n){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(n!==null){const r=n.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=n[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}const t7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},wa={h:0,s:0,l:0},ew={h:0,s:0,l:0};function IT(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}class st{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,n===void 0&&i===void 0?this.set(e):this.setRGB(e,n,i)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=Jt){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Go.toWorkingColorSpace(this,n),this}setRGB(e,n,i,r=Go.workingColorSpace){return this.r=e,this.g=n,this.b=i,Go.toWorkingColorSpace(this,r),this}setHSL(e,n,i,r=Go.workingColorSpace){if(e=nB(e,1),n=yi(n,0,1),i=yi(i,0,1),n===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+n):i+n-i*n,o=2*i-s;this.r=IT(o,s,e+1/3),this.g=IT(o,s,e),this.b=IT(o,s,e-1/3)}return Go.toWorkingColorSpace(this,r),this}setStyle(e,n=Jt){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,n);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,n);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,n);if(o===6)return this.setHex(parseInt(s,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=Jt){const i=t7[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=tg(e.r),this.g=tg(e.g),this.b=tg(e.b),this}copyLinearToSRGB(e){return this.r=wT(e.r),this.g=wT(e.g),this.b=wT(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Jt){return Go.fromWorkingColorSpace(Hr.copy(this),e),Math.round(yi(Hr.r*255,0,255))*65536+Math.round(yi(Hr.g*255,0,255))*256+Math.round(yi(Hr.b*255,0,255))}getHexString(e=Jt){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=Go.workingColorSpace){Go.fromWorkingColorSpace(Hr.copy(this),n);const i=Hr.r,r=Hr.g,s=Hr.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let l,c;const h=(a+o)/2;if(a===o)l=0,c=0;else{const u=o-a;switch(c=h<=.5?u/(o+a):u/(2-o-a),o){case i:l=(r-s)/u+(r<s?6:0);break;case r:l=(s-i)/u+2;break;case s:l=(i-r)/u+4;break}l/=6}return e.h=l,e.s=c,e.l=h,e}getRGB(e,n=Go.workingColorSpace){return Go.fromWorkingColorSpace(Hr.copy(this),n),e.r=Hr.r,e.g=Hr.g,e.b=Hr.b,e}getStyle(e=Jt){Go.fromWorkingColorSpace(Hr.copy(this),e);const n=Hr.r,i=Hr.g,r=Hr.b;return e!==Jt?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,n,i){return this.getHSL(wa),wa.h+=e,wa.s+=n,wa.l+=i,this.setHSL(wa.h,wa.s,wa.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(wa),e.getHSL(ew);const i=my(wa.h,ew.h,n),r=my(wa.s,ew.s,n),s=my(wa.l,ew.l,n);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*n+s[3]*i+s[6]*r,this.g=s[1]*n+s[4]*i+s[7]*r,this.b=s[2]*n+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Hr=new st;st.NAMES=t7;class so extends Hi{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new st(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=qx,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Bc=sse();function sse(){const t=new ArrayBuffer(4),e=new Float32Array(t),n=new Uint32Array(t),i=new Uint32Array(512),r=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(i[l]=0,i[l|256]=32768,r[l]=24,r[l|256]=24):c<-14?(i[l]=1024>>-c-14,i[l|256]=1024>>-c-14|32768,r[l]=-c-1,r[l|256]=-c-1):c<=15?(i[l]=c+15<<10,i[l|256]=c+15<<10|32768,r[l]=13,r[l|256]=13):c<128?(i[l]=31744,i[l|256]=64512,r[l]=24,r[l|256]=24):(i[l]=31744,i[l|256]=64512,r[l]=13,r[l|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,h=0;for(;!(c&8388608);)c<<=1,h-=8388608;c&=-8388609,h+=947912704,s[l]=c|h}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)o[l]=l<<23;o[31]=1199570944,o[32]=2147483648;for(let l=33;l<63;++l)o[l]=2147483648+(l-32<<23);o[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(a[l]=1024);return{floatView:e,uint32View:n,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function bs(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=yi(t,-65504,65504),Bc.floatView[0]=t;const e=Bc.uint32View[0],n=e>>23&511;return Bc.baseTable[n]+((e&8388607)>>Bc.shiftTable[n])}function q0(t){const e=t>>10;return Bc.uint32View[0]=Bc.mantissaTable[Bc.offsetTable[e]+(t&1023)]+Bc.exponentTable[e],Bc.floatView[0]}const ose={toHalfFloat:bs,fromHalfFloat:q0},Bi=new ae,tw=new Ye;class bn{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=cx,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=n.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)tw.fromBufferAttribute(this,n),tw.applyMatrix3(e),this.setXY(n,tw.x,tw.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)Bi.fromBufferAttribute(this,n),Bi.applyMatrix3(e),this.setXYZ(n,Bi.x,Bi.y,Bi.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)Bi.fromBufferAttribute(this,n),Bi.applyMatrix4(e),this.setXYZ(n,Bi.x,Bi.y,Bi.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)Bi.fromBufferAttribute(this,n),Bi.applyNormalMatrix(e),this.setXYZ(n,Bi.x,Bi.y,Bi.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)Bi.fromBufferAttribute(this,n),Bi.transformDirection(e),this.setXYZ(n,Bi.x,Bi.y,Bi.z);return this}set(e,n=0){return this.array.set(e,n),this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=ro(n,this.array)),n}setX(e,n){return this.normalized&&(n=nn(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=ro(n,this.array)),n}setY(e,n){return this.normalized&&(n=nn(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=ro(n,this.array)),n}setZ(e,n){return this.normalized&&(n=nn(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=ro(n,this.array)),n}setW(e,n){return this.normalized&&(n=nn(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=nn(n,this.array),i=nn(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=nn(n,this.array),i=nn(i,this.array),r=nn(r,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=nn(n,this.array),i=nn(i,this.array),r=nn(r,this.array),s=nn(s,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==cx&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class ase extends bn{constructor(e,n,i){super(new Int8Array(e),n,i)}}class lse extends bn{constructor(e,n,i){super(new Uint8Array(e),n,i)}}class cse extends bn{constructor(e,n,i){super(new Uint8ClampedArray(e),n,i)}}class use extends bn{constructor(e,n,i){super(new Int16Array(e),n,i)}}class sB extends bn{constructor(e,n,i){super(new Uint16Array(e),n,i)}}class hse extends bn{constructor(e,n,i){super(new Int32Array(e),n,i)}}class oB extends bn{constructor(e,n,i){super(new Uint32Array(e),n,i)}}class dse extends bn{constructor(e,n,i){super(new Uint16Array(e),n,i),this.isFloat16BufferAttribute=!0}getX(e){let n=q0(this.array[e*this.itemSize]);return this.normalized&&(n=ro(n,this.array)),n}setX(e,n){return this.normalized&&(n=nn(n,this.array)),this.array[e*this.itemSize]=bs(n),this}getY(e){let n=q0(this.array[e*this.itemSize+1]);return this.normalized&&(n=ro(n,this.array)),n}setY(e,n){return this.normalized&&(n=nn(n,this.array)),this.array[e*this.itemSize+1]=bs(n),this}getZ(e){let n=q0(this.array[e*this.itemSize+2]);return this.normalized&&(n=ro(n,this.array)),n}setZ(e,n){return this.normalized&&(n=nn(n,this.array)),this.array[e*this.itemSize+2]=bs(n),this}getW(e){let n=q0(this.array[e*this.itemSize+3]);return this.normalized&&(n=ro(n,this.array)),n}setW(e,n){return this.normalized&&(n=nn(n,this.array)),this.array[e*this.itemSize+3]=bs(n),this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=nn(n,this.array),i=nn(i,this.array)),this.array[e+0]=bs(n),this.array[e+1]=bs(i),this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=nn(n,this.array),i=nn(i,this.array),r=nn(r,this.array)),this.array[e+0]=bs(n),this.array[e+1]=bs(i),this.array[e+2]=bs(r),this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=nn(n,this.array),i=nn(i,this.array),r=nn(r,this.array),s=nn(s,this.array)),this.array[e+0]=bs(n),this.array[e+1]=bs(i),this.array[e+2]=bs(r),this.array[e+3]=bs(s),this}}class xt extends bn{constructor(e,n,i){super(new Float32Array(e),n,i)}}class fse extends bn{constructor(e,n,i){super(new Float64Array(e),n,i)}}let pse=0;const Io=new kt,BT=new mn,wp=new ae,Ys=new $a,Zv=new $a,ur=new ae;class Kt extends tc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:pse++}),this.uuid=go(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(e7(e)?oB:sB)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new ln().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Io.makeRotationFromQuaternion(e),this.applyMatrix4(Io),this}rotateX(e){return Io.makeRotationX(e),this.applyMatrix4(Io),this}rotateY(e){return Io.makeRotationY(e),this.applyMatrix4(Io),this}rotateZ(e){return Io.makeRotationZ(e),this.applyMatrix4(Io),this}translate(e,n,i){return Io.makeTranslation(e,n,i),this.applyMatrix4(Io),this}scale(e,n,i){return Io.makeScale(e,n,i),this.applyMatrix4(Io),this}lookAt(e){return BT.lookAt(e),BT.updateMatrix(),this.applyMatrix4(BT.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(wp).negate(),this.translate(wp.x,wp.y,wp.z),this}setFromPoints(e){const n=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];n.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new xt(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new $a);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new ae(-1/0,-1/0,-1/0),new ae(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,r=n.length;i<r;i++){const s=n[i];Ys.setFromBufferAttribute(s),this.morphTargetsRelative?(ur.addVectors(this.boundingBox.min,Ys.min),this.boundingBox.expandByPoint(ur),ur.addVectors(this.boundingBox.max,Ys.max),this.boundingBox.expandByPoint(ur)):(this.boundingBox.expandByPoint(Ys.min),this.boundingBox.expandByPoint(Ys.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new el);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new ae,1/0);return}if(e){const i=this.boundingSphere.center;if(Ys.setFromBufferAttribute(e),n)for(let s=0,o=n.length;s<o;s++){const a=n[s];Zv.setFromBufferAttribute(a),this.morphTargetsRelative?(ur.addVectors(Ys.min,Zv.min),Ys.expandByPoint(ur),ur.addVectors(Ys.max,Zv.max),Ys.expandByPoint(ur)):(Ys.expandByPoint(Zv.min),Ys.expandByPoint(Zv.max))}Ys.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)ur.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(ur));if(n)for(let s=0,o=n.length;s<o;s++){const a=n[s],l=this.morphTargetsRelative;for(let c=0,h=a.count;c<h;c++)ur.fromBufferAttribute(a,c),l&&(wp.fromBufferAttribute(e,c),ur.add(wp)),r=Math.max(r,i.distanceToSquared(ur))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,r=n.position.array,s=n.normal.array,o=n.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new bn(new Float32Array(4*a),4));const l=this.getAttribute("tangent").array,c=[],h=[];for(let P=0;P<a;P++)c[P]=new ae,h[P]=new ae;const u=new ae,d=new ae,f=new ae,p=new Ye,v=new Ye,g=new Ye,m=new ae,y=new ae;function _(P,R,F){u.fromArray(r,P*3),d.fromArray(r,R*3),f.fromArray(r,F*3),p.fromArray(o,P*2),v.fromArray(o,R*2),g.fromArray(o,F*2),d.sub(u),f.sub(u),v.sub(p),g.sub(p);const B=1/(v.x*g.y-g.x*v.y);isFinite(B)&&(m.copy(d).multiplyScalar(g.y).addScaledVector(f,-v.y).multiplyScalar(B),y.copy(f).multiplyScalar(v.x).addScaledVector(d,-g.x).multiplyScalar(B),c[P].add(m),c[R].add(m),c[F].add(m),h[P].add(y),h[R].add(y),h[F].add(y))}let S=this.groups;S.length===0&&(S=[{start:0,count:i.length}]);for(let P=0,R=S.length;P<R;++P){const F=S[P],B=F.start,k=F.count;for(let j=B,Z=B+k;j<Z;j+=3)_(i[j+0],i[j+1],i[j+2])}const A=new ae,b=new ae,T=new ae,M=new ae;function E(P){T.fromArray(s,P*3),M.copy(T);const R=c[P];A.copy(R),A.sub(T.multiplyScalar(T.dot(R))).normalize(),b.crossVectors(M,R);const B=b.dot(h[P])<0?-1:1;l[P*4]=A.x,l[P*4+1]=A.y,l[P*4+2]=A.z,l[P*4+3]=B}for(let P=0,R=S.length;P<R;++P){const F=S[P],B=F.start,k=F.count;for(let j=B,Z=B+k;j<Z;j+=3)E(i[j+0]),E(i[j+1]),E(i[j+2])}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new bn(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let d=0,f=i.count;d<f;d++)i.setXYZ(d,0,0,0);const r=new ae,s=new ae,o=new ae,a=new ae,l=new ae,c=new ae,h=new ae,u=new ae;if(e)for(let d=0,f=e.count;d<f;d+=3){const p=e.getX(d+0),v=e.getX(d+1),g=e.getX(d+2);r.fromBufferAttribute(n,p),s.fromBufferAttribute(n,v),o.fromBufferAttribute(n,g),h.subVectors(o,s),u.subVectors(r,s),h.cross(u),a.fromBufferAttribute(i,p),l.fromBufferAttribute(i,v),c.fromBufferAttribute(i,g),a.add(h),l.add(h),c.add(h),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(v,l.x,l.y,l.z),i.setXYZ(g,c.x,c.y,c.z)}else for(let d=0,f=n.count;d<f;d+=3)r.fromBufferAttribute(n,d+0),s.fromBufferAttribute(n,d+1),o.fromBufferAttribute(n,d+2),h.subVectors(o,s),u.subVectors(r,s),h.cross(u),i.setXYZ(d+0,h.x,h.y,h.z),i.setXYZ(d+1,h.x,h.y,h.z),i.setXYZ(d+2,h.x,h.y,h.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)ur.fromBufferAttribute(e,n),ur.normalize(),e.setXYZ(n,ur.x,ur.y,ur.z)}toNonIndexed(){function e(a,l){const c=a.array,h=a.itemSize,u=a.normalized,d=new c.constructor(l.length*h);let f=0,p=0;for(let v=0,g=l.length;v<g;v++){a.isInterleavedBufferAttribute?f=l[v]*a.data.stride+a.offset:f=l[v]*h;for(let m=0;m<h;m++)d[p++]=c[f++]}return new bn(d,h,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new Kt,i=this.index.array,r=this.attributes;for(const a in r){const l=r[a],c=e(l,i);n.setAttribute(a,c)}const s=this.morphAttributes;for(const a in s){const l=[],c=s[a];for(let h=0,u=c.length;h<u;h++){const d=c[h],f=e(d,i);l.push(f)}n.morphAttributes[a]=l}n.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,l=o.length;a<l;a++){const c=o[a];n.addGroup(c.start,c.count,c.materialIndex)}return n}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const l in i){const c=i[l];e.data.attributes[l]=c.toJSON(e.data)}const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],h=[];for(let u=0,d=c.length;u<d;u++){const f=c[u];h.push(f.toJSON(e.data))}h.length>0&&(r[l]=h,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(n));const r=e.attributes;for(const c in r){const h=r[c];this.setAttribute(c,h.clone(n))}const s=e.morphAttributes;for(const c in s){const h=[],u=s[c];for(let d=0,f=u.length;d<f;d++)h.push(u[d].clone(n));this.morphAttributes[c]=h}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let c=0,h=o.length;c<h;c++){const u=o[c];this.addGroup(u.start,u.count,u.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const nz=new kt,fl=new Qx,nw=new el,iz=new ae,Sp=new ae,bp=new ae,Ap=new ae,OT=new ae,iw=new ae,rw=new Ye,sw=new Ye,ow=new Ye,rz=new ae,sz=new ae,oz=new ae,aw=new ae,lw=new ae;class gr extends mn{constructor(e=new Kt,n=new so){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,n){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;n.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){iw.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const h=a[l],u=s[l];h!==0&&(OT.fromBufferAttribute(u,e),o?iw.addScaledVector(OT,h):iw.addScaledVector(OT.sub(n),h))}n.add(iw)}return n}raycast(e,n){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),nw.copy(i.boundingSphere),nw.applyMatrix4(s),fl.copy(e.ray).recast(e.near),!(nw.containsPoint(fl.origin)===!1&&(fl.intersectSphere(nw,iz)===null||fl.origin.distanceToSquared(iz)>(e.far-e.near)**2))&&(nz.copy(s).invert(),fl.copy(e.ray).applyMatrix4(nz),!(i.boundingBox!==null&&fl.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n)))}_computeIntersections(e,n){let i;const r=this.geometry,s=this.material,o=r.index,a=r.attributes.position,l=r.attributes.uv,c=r.attributes.uv1,h=r.attributes.normal,u=r.groups,d=r.drawRange;if(o!==null)if(Array.isArray(s))for(let f=0,p=u.length;f<p;f++){const v=u[f],g=s[v.materialIndex],m=Math.max(v.start,d.start),y=Math.min(o.count,Math.min(v.start+v.count,d.start+d.count));for(let _=m,S=y;_<S;_+=3){const A=o.getX(_),b=o.getX(_+1),T=o.getX(_+2);i=cw(this,g,e,fl,l,c,h,A,b,T),i&&(i.faceIndex=Math.floor(_/3),i.face.materialIndex=v.materialIndex,n.push(i))}}else{const f=Math.max(0,d.start),p=Math.min(o.count,d.start+d.count);for(let v=f,g=p;v<g;v+=3){const m=o.getX(v),y=o.getX(v+1),_=o.getX(v+2);i=cw(this,s,e,fl,l,c,h,m,y,_),i&&(i.faceIndex=Math.floor(v/3),n.push(i))}}else if(a!==void 0)if(Array.isArray(s))for(let f=0,p=u.length;f<p;f++){const v=u[f],g=s[v.materialIndex],m=Math.max(v.start,d.start),y=Math.min(a.count,Math.min(v.start+v.count,d.start+d.count));for(let _=m,S=y;_<S;_+=3){const A=_,b=_+1,T=_+2;i=cw(this,g,e,fl,l,c,h,A,b,T),i&&(i.faceIndex=Math.floor(_/3),i.face.materialIndex=v.materialIndex,n.push(i))}}else{const f=Math.max(0,d.start),p=Math.min(a.count,d.start+d.count);for(let v=f,g=p;v<g;v+=3){const m=v,y=v+1,_=v+2;i=cw(this,s,e,fl,l,c,h,m,y,_),i&&(i.faceIndex=Math.floor(v/3),n.push(i))}}}}function mse(t,e,n,i,r,s,o,a){let l;if(e.side===fs?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===ql,a),l===null)return null;lw.copy(a),lw.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(lw);return c<n.near||c>n.far?null:{distance:c,point:lw.clone(),object:t}}function cw(t,e,n,i,r,s,o,a,l,c){t.getVertexPosition(a,Sp),t.getVertexPosition(l,bp),t.getVertexPosition(c,Ap);const h=mse(t,e,n,i,Sp,bp,Ap,aw);if(h){r&&(rw.fromBufferAttribute(r,a),sw.fromBufferAttribute(r,l),ow.fromBufferAttribute(r,c),h.uv=Ms.getInterpolation(aw,Sp,bp,Ap,rw,sw,ow,new Ye)),s&&(rw.fromBufferAttribute(s,a),sw.fromBufferAttribute(s,l),ow.fromBufferAttribute(s,c),h.uv1=Ms.getInterpolation(aw,Sp,bp,Ap,rw,sw,ow,new Ye),h.uv2=h.uv1),o&&(rz.fromBufferAttribute(o,a),sz.fromBufferAttribute(o,l),oz.fromBufferAttribute(o,c),h.normal=Ms.getInterpolation(aw,Sp,bp,Ap,rz,sz,oz,new ae),h.normal.dot(i.direction)>0&&h.normal.multiplyScalar(-1));const u={a,b:l,c,normal:new ae,materialIndex:0};Ms.getNormal(Sp,bp,Ap,u.normal),h.face=u}return h}class Kh extends Kt{constructor(e=1,n=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const l=[],c=[],h=[],u=[];let d=0,f=0;p("z","y","x",-1,-1,i,n,e,o,s,0),p("z","y","x",1,-1,i,n,-e,o,s,1),p("x","z","y",1,1,e,i,n,r,o,2),p("x","z","y",1,-1,e,i,-n,r,o,3),p("x","y","z",1,-1,e,n,i,r,s,4),p("x","y","z",-1,-1,e,n,-i,r,s,5),this.setIndex(l),this.setAttribute("position",new xt(c,3)),this.setAttribute("normal",new xt(h,3)),this.setAttribute("uv",new xt(u,2));function p(v,g,m,y,_,S,A,b,T,M,E){const P=S/T,R=A/M,F=S/2,B=A/2,k=b/2,j=T+1,Z=M+1;let ee=0,O=0;const W=new ae;for(let H=0;H<Z;H++){const Y=H*R-B;for(let z=0;z<j;z++){const X=z*P-F;W[v]=X*y,W[g]=Y*_,W[m]=k,c.push(W.x,W.y,W.z),W[v]=0,W[g]=0,W[m]=b>0?1:-1,h.push(W.x,W.y,W.z),u.push(z/T),u.push(1-H/M),ee+=1}}for(let H=0;H<M;H++)for(let Y=0;Y<T;Y++){const z=d+Y+j*H,X=d+Y+j*(H+1),q=d+(Y+1)+j*(H+1),re=d+(Y+1)+j*H;l.push(z,X,re),l.push(X,q,re),O+=6}a.addGroup(f,O,E),f+=O,d+=ee}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Kh(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Pg(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][i]=null):e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function as(t){const e={};for(let n=0;n<t.length;n++){const i=Pg(t[n]);for(const r in i)e[r]=i[r]}return e}function gse(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function n7(t){return t.getRenderTarget()===null?t.outputColorSpace:Ya}const i7={clone:Pg,merge:as};var vse=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,yse=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Kl extends Hi{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=vse,this.fragmentShader=yse,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Pg(e.uniforms),this.uniformsGroups=gse(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?n.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?n.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?n.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?n.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?n.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?n.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?n.uniforms[r]={type:"m4",value:o.toArray()}:n.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}}class Jx extends mn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new kt,this.projectionMatrix=new kt,this.projectionMatrixInverse=new kt}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(-n[8],-n[9],-n[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class zn extends Jx{constructor(e=50,n=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=Tg*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(uf*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Tg*2*Math.atan(Math.tan(uf*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,n,i,r,s,o){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(uf*.5*this.fov)/this.zoom,i=2*n,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,c=o.fullHeight;s+=o.offsetX*r/l,n-=o.offsetY*i/c,r*=o.width/l,i*=o.height/c}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,n,n-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const Mp=-90,Ep=1;class aB extends mn{constructor(e,n,i){super(),this.type="CubeCamera",this.renderTarget=i;const r=new zn(Mp,Ep,e,n);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(1,0,0),this.add(r);const s=new zn(Mp,Ep,e,n);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(-1,0,0),this.add(s);const o=new zn(Mp,Ep,e,n);o.layers=this.layers,o.up.set(0,0,-1),o.lookAt(0,1,0),this.add(o);const a=new zn(Mp,Ep,e,n);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);const l=new zn(Mp,Ep,e,n);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,1),this.add(l);const c=new zn(Mp,Ep,e,n);c.layers=this.layers,c.up.set(0,1,0),c.lookAt(0,0,-1),this.add(c)}update(e,n){this.parent===null&&this.updateMatrixWorld();const i=this.renderTarget,[r,s,o,a,l,c]=this.children,h=e.getRenderTarget(),u=e.toneMapping,d=e.xr.enabled;e.toneMapping=Va,e.xr.enabled=!1;const f=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(n,r),e.setRenderTarget(i,1),e.render(n,s),e.setRenderTarget(i,2),e.render(n,o),e.setRenderTarget(i,3),e.render(n,a),e.setRenderTarget(i,4),e.render(n,l),i.texture.generateMipmaps=f,e.setRenderTarget(i,5),e.render(n,c),e.setRenderTarget(h),e.toneMapping=u,e.xr.enabled=d,i.texture.needsPMREMUpdate=!0}}class Zx extends ni{constructor(e,n,i,r,s,o,a,l,c,h){e=e!==void 0?e:[],n=n!==void 0?n:Fh,super(e,n,i,r,s,o,a,l,c,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class lB extends qa{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];n.encoding!==void 0&&(gy("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),n.colorSpace=n.encoding===mo?Jt:Ch),this.texture=new Zx(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:oi}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new Kh(5,5,5),s=new Kl({name:"CubemapFromEquirect",uniforms:Pg(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:fs,blending:Wc});s.uniforms.tEquirect.value=n;const o=new gr(r,s),a=n.minFilter;return n.minFilter===Ql&&(n.minFilter=oi),new aB(1,10,this).update(e,o),n.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,n,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(n,i,r);e.setRenderTarget(s)}}const FT=new ae,xse=new ae,_se=new ln;class qu{constructor(e=new ae(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,r){return this.normal.set(e,n,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const r=FT.subVectors(i,n).cross(xse.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const i=e.delta(FT),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:n.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||_se.getNormalMatrix(e),r=this.coplanarPoint(FT).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const pd=new el,uw=new ae;class zM{constructor(e=new qu,n=new qu,i=new qu,r=new qu,s=new qu,o=new qu){this.planes=[e,n,i,r,s,o]}set(e,n,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(n),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const n=this.planes,i=e.elements,r=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=i[5],h=i[6],u=i[7],d=i[8],f=i[9],p=i[10],v=i[11],g=i[12],m=i[13],y=i[14],_=i[15];return n[0].setComponents(a-r,u-l,v-d,_-g).normalize(),n[1].setComponents(a+r,u+l,v+d,_+g).normalize(),n[2].setComponents(a+s,u+c,v+f,_+m).normalize(),n[3].setComponents(a-s,u-c,v-f,_-m).normalize(),n[4].setComponents(a-o,u-h,v-p,_-y).normalize(),n[5].setComponents(a+o,u+h,v+p,_+y).normalize(),this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),pd.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),pd.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(pd)}intersectsSprite(e){return pd.center.set(0,0,0),pd.radius=.7071067811865476,pd.applyMatrix4(e.matrixWorld),this.intersectsSphere(pd)}intersectsSphere(e){const n=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(n[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const r=n[i];if(uw.x=r.normal.x>0?e.max.x:e.min.x,uw.y=r.normal.y>0?e.max.y:e.min.y,uw.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(uw)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function r7(){let t=null,e=!1,n=null,i=null;function r(s,o){n(s,o),i=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&n!==null&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){n=s},setContext:function(s){t=s}}}function wse(t,e){const n=e.isWebGL2,i=new WeakMap;function r(c,h){const u=c.array,d=c.usage,f=t.createBuffer();t.bindBuffer(h,f),t.bufferData(h,u,d),c.onUploadCallback();let p;if(u instanceof Float32Array)p=t.FLOAT;else if(u instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(n)p=t.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else p=t.UNSIGNED_SHORT;else if(u instanceof Int16Array)p=t.SHORT;else if(u instanceof Uint32Array)p=t.UNSIGNED_INT;else if(u instanceof Int32Array)p=t.INT;else if(u instanceof Int8Array)p=t.BYTE;else if(u instanceof Uint8Array)p=t.UNSIGNED_BYTE;else if(u instanceof Uint8ClampedArray)p=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:f,type:p,bytesPerElement:u.BYTES_PER_ELEMENT,version:c.version}}function s(c,h,u){const d=h.array,f=h.updateRange;t.bindBuffer(u,c),f.count===-1?t.bufferSubData(u,0,d):(n?t.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):t.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1),h.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);const h=i.get(c);h&&(t.deleteBuffer(h.buffer),i.delete(c))}function l(c,h){if(c.isGLBufferAttribute){const d=i.get(c);(!d||d.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const u=i.get(c);u===void 0?i.set(c,r(c,h)):u.version<c.version&&(s(u.buffer,c,h),u.version=c.version)}return{get:o,remove:a,update:l}}class iv extends Kt{constructor(e=1,n=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:r};const s=e/2,o=n/2,a=Math.floor(i),l=Math.floor(r),c=a+1,h=l+1,u=e/a,d=n/l,f=[],p=[],v=[],g=[];for(let m=0;m<h;m++){const y=m*d-o;for(let _=0;_<c;_++){const S=_*u-s;p.push(S,-y,0),v.push(0,0,1),g.push(_/a),g.push(1-m/l)}}for(let m=0;m<l;m++)for(let y=0;y<a;y++){const _=y+c*m,S=y+c*(m+1),A=y+1+c*(m+1),b=y+1+c*m;f.push(_,S,b),f.push(S,A,b)}this.setIndex(f),this.setAttribute("position",new xt(p,3)),this.setAttribute("normal",new xt(v,3)),this.setAttribute("uv",new xt(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new iv(e.width,e.height,e.widthSegments,e.heightSegments)}}var Sse=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,bse=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Ase=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,Mse=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Ese=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Cse=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Tse="vec3 transformed = vec3( position );",Pse=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Dse=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,Rse=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Lse=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Ise=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Bse=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Ose=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Fse=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Nse=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Use=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,kse=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,zse=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Gse=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Hse=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Vse=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,jse=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Wse=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Xse=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Yse=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,qse="gl_FragColor = linearToOutputTexel( gl_FragColor );",Qse=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Kse=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Jse=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Zse=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,$se=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,eoe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,toe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,noe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,ioe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,roe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,soe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,ooe=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,aoe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,loe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,coe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,uoe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,hoe=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,doe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,foe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,poe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,moe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,goe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif`,voe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,yoe=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,xoe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,_oe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,woe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Soe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,boe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Aoe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Moe=`#ifdef USE_MAP
	diffuseColor *= texture2D( map, vMapUv );
#endif`,Eoe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Coe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Toe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Poe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Doe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Roe=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Loe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,Ioe=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Boe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Ooe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#ifdef USE_NORMALMAP_TANGENTSPACE
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal, vNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 geometryNormal = normal;`,Foe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Noe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Uoe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,koe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,zoe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Goe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,Hoe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Voe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,joe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Woe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Xoe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Yoe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,qoe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Qoe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Koe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Joe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Zoe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,$oe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,eae=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,tae=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,nae=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,iae=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,rae=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,sae=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,oae=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,aae=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,lae=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,cae=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,uae=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,hae=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,dae=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,fae=`#ifdef USE_UV
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,pae=`#ifdef USE_UV
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,mae=`#ifdef USE_UV
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,gae=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const vae=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,yae=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,xae=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,_ae=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,wae=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Sae=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,bae=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Aae=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,Mae=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Eae=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Cae=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Tae=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Pae=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Dae=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Rae=`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Lae=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Iae=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Bae=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Oae=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Fae=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Nae=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Uae=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,kae=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,zae=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Gae=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Hae=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Vae=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,jae=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Wae=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Xae=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Yae=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,qae=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Qae=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Kae=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,tn={alphamap_fragment:Sse,alphamap_pars_fragment:bse,alphatest_fragment:Ase,alphatest_pars_fragment:Mse,aomap_fragment:Ese,aomap_pars_fragment:Cse,begin_vertex:Tse,beginnormal_vertex:Pse,bsdfs:Dse,iridescence_fragment:Rse,bumpmap_pars_fragment:Lse,clipping_planes_fragment:Ise,clipping_planes_pars_fragment:Bse,clipping_planes_pars_vertex:Ose,clipping_planes_vertex:Fse,color_fragment:Nse,color_pars_fragment:Use,color_pars_vertex:kse,color_vertex:zse,common:Gse,cube_uv_reflection_fragment:Hse,defaultnormal_vertex:Vse,displacementmap_pars_vertex:jse,displacementmap_vertex:Wse,emissivemap_fragment:Xse,emissivemap_pars_fragment:Yse,encodings_fragment:qse,encodings_pars_fragment:Qse,envmap_fragment:Kse,envmap_common_pars_fragment:Jse,envmap_pars_fragment:Zse,envmap_pars_vertex:$se,envmap_physical_pars_fragment:hoe,envmap_vertex:eoe,fog_vertex:toe,fog_pars_vertex:noe,fog_fragment:ioe,fog_pars_fragment:roe,gradientmap_pars_fragment:soe,lightmap_fragment:ooe,lightmap_pars_fragment:aoe,lights_lambert_fragment:loe,lights_lambert_pars_fragment:coe,lights_pars_begin:uoe,lights_toon_fragment:doe,lights_toon_pars_fragment:foe,lights_phong_fragment:poe,lights_phong_pars_fragment:moe,lights_physical_fragment:goe,lights_physical_pars_fragment:voe,lights_fragment_begin:yoe,lights_fragment_maps:xoe,lights_fragment_end:_oe,logdepthbuf_fragment:woe,logdepthbuf_pars_fragment:Soe,logdepthbuf_pars_vertex:boe,logdepthbuf_vertex:Aoe,map_fragment:Moe,map_pars_fragment:Eoe,map_particle_fragment:Coe,map_particle_pars_fragment:Toe,metalnessmap_fragment:Poe,metalnessmap_pars_fragment:Doe,morphcolor_vertex:Roe,morphnormal_vertex:Loe,morphtarget_pars_vertex:Ioe,morphtarget_vertex:Boe,normal_fragment_begin:Ooe,normal_fragment_maps:Foe,normal_pars_fragment:Noe,normal_pars_vertex:Uoe,normal_vertex:koe,normalmap_pars_fragment:zoe,clearcoat_normal_fragment_begin:Goe,clearcoat_normal_fragment_maps:Hoe,clearcoat_pars_fragment:Voe,iridescence_pars_fragment:joe,output_fragment:Woe,packing:Xoe,premultiplied_alpha_fragment:Yoe,project_vertex:qoe,dithering_fragment:Qoe,dithering_pars_fragment:Koe,roughnessmap_fragment:Joe,roughnessmap_pars_fragment:Zoe,shadowmap_pars_fragment:$oe,shadowmap_pars_vertex:eae,shadowmap_vertex:tae,shadowmask_pars_fragment:nae,skinbase_vertex:iae,skinning_pars_vertex:rae,skinning_vertex:sae,skinnormal_vertex:oae,specularmap_fragment:aae,specularmap_pars_fragment:lae,tonemapping_fragment:cae,tonemapping_pars_fragment:uae,transmission_fragment:hae,transmission_pars_fragment:dae,uv_pars_fragment:fae,uv_pars_vertex:pae,uv_vertex:mae,worldpos_vertex:gae,background_vert:vae,background_frag:yae,backgroundCube_vert:xae,backgroundCube_frag:_ae,cube_vert:wae,cube_frag:Sae,depth_vert:bae,depth_frag:Aae,distanceRGBA_vert:Mae,distanceRGBA_frag:Eae,equirect_vert:Cae,equirect_frag:Tae,linedashed_vert:Pae,linedashed_frag:Dae,meshbasic_vert:Rae,meshbasic_frag:Lae,meshlambert_vert:Iae,meshlambert_frag:Bae,meshmatcap_vert:Oae,meshmatcap_frag:Fae,meshnormal_vert:Nae,meshnormal_frag:Uae,meshphong_vert:kae,meshphong_frag:zae,meshphysical_vert:Gae,meshphysical_frag:Hae,meshtoon_vert:Vae,meshtoon_frag:jae,points_vert:Wae,points_frag:Xae,shadow_vert:Yae,shadow_frag:qae,sprite_vert:Qae,sprite_frag:Kae},rt={common:{diffuse:{value:new st(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new ln},alphaMap:{value:null},alphaMapTransform:{value:new ln},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new ln}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new ln}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new ln}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new ln},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new ln},normalScale:{value:new Ye(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new ln},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new ln}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new ln}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new ln}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new st(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new st(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ln}},sprite:{diffuse:{value:new st(16777215)},opacity:{value:1},center:{value:new Ye(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new ln},alphaMap:{value:null},alphaTest:{value:0}}},Oa={basic:{uniforms:as([rt.common,rt.specularmap,rt.envmap,rt.aomap,rt.lightmap,rt.fog]),vertexShader:tn.meshbasic_vert,fragmentShader:tn.meshbasic_frag},lambert:{uniforms:as([rt.common,rt.specularmap,rt.envmap,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.fog,rt.lights,{emissive:{value:new st(0)}}]),vertexShader:tn.meshlambert_vert,fragmentShader:tn.meshlambert_frag},phong:{uniforms:as([rt.common,rt.specularmap,rt.envmap,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.fog,rt.lights,{emissive:{value:new st(0)},specular:{value:new st(1118481)},shininess:{value:30}}]),vertexShader:tn.meshphong_vert,fragmentShader:tn.meshphong_frag},standard:{uniforms:as([rt.common,rt.envmap,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.roughnessmap,rt.metalnessmap,rt.fog,rt.lights,{emissive:{value:new st(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:tn.meshphysical_vert,fragmentShader:tn.meshphysical_frag},toon:{uniforms:as([rt.common,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.gradientmap,rt.fog,rt.lights,{emissive:{value:new st(0)}}]),vertexShader:tn.meshtoon_vert,fragmentShader:tn.meshtoon_frag},matcap:{uniforms:as([rt.common,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.fog,{matcap:{value:null}}]),vertexShader:tn.meshmatcap_vert,fragmentShader:tn.meshmatcap_frag},points:{uniforms:as([rt.points,rt.fog]),vertexShader:tn.points_vert,fragmentShader:tn.points_frag},dashed:{uniforms:as([rt.common,rt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:tn.linedashed_vert,fragmentShader:tn.linedashed_frag},depth:{uniforms:as([rt.common,rt.displacementmap]),vertexShader:tn.depth_vert,fragmentShader:tn.depth_frag},normal:{uniforms:as([rt.common,rt.bumpmap,rt.normalmap,rt.displacementmap,{opacity:{value:1}}]),vertexShader:tn.meshnormal_vert,fragmentShader:tn.meshnormal_frag},sprite:{uniforms:as([rt.sprite,rt.fog]),vertexShader:tn.sprite_vert,fragmentShader:tn.sprite_frag},background:{uniforms:{uvTransform:{value:new ln},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:tn.background_vert,fragmentShader:tn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:tn.backgroundCube_vert,fragmentShader:tn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:tn.cube_vert,fragmentShader:tn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:tn.equirect_vert,fragmentShader:tn.equirect_frag},distanceRGBA:{uniforms:as([rt.common,rt.displacementmap,{referencePosition:{value:new ae},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:tn.distanceRGBA_vert,fragmentShader:tn.distanceRGBA_frag},shadow:{uniforms:as([rt.lights,rt.fog,{color:{value:new st(0)},opacity:{value:1}}]),vertexShader:tn.shadow_vert,fragmentShader:tn.shadow_frag}};Oa.physical={uniforms:as([Oa.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new ln},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new ln},clearcoatNormalScale:{value:new Ye(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new ln},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new ln},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new ln},sheen:{value:0},sheenColor:{value:new st(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new ln},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new ln},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new ln},transmissionSamplerSize:{value:new Ye},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new ln},attenuationDistance:{value:0},attenuationColor:{value:new st(0)},specularColor:{value:new st(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new ln},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new ln}}]),vertexShader:tn.meshphysical_vert,fragmentShader:tn.meshphysical_frag};const hw={r:0,b:0,g:0};function Jae(t,e,n,i,r,s,o){const a=new st(0);let l=s===!0?0:1,c,h,u=null,d=0,f=null;function p(g,m){let y=!1,_=m.isScene===!0?m.background:null;switch(_&&_.isTexture&&(_=(m.backgroundBlurriness>0?n:e).get(_)),_===null?v(a,l):_&&_.isColor&&(v(_,1),y=!0),t.xr.getEnvironmentBlendMode()){case"opaque":y=!0;break;case"additive":i.buffers.color.setClear(0,0,0,1,o),y=!0;break;case"alpha-blend":i.buffers.color.setClear(0,0,0,0,o),y=!0;break}(t.autoClear||y)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),_&&(_.isCubeTexture||_.mapping===nv)?(h===void 0&&(h=new gr(new Kh(1,1,1),new Kl({name:"BackgroundCubeMaterial",uniforms:Pg(Oa.backgroundCube.uniforms),vertexShader:Oa.backgroundCube.vertexShader,fragmentShader:Oa.backgroundCube.fragmentShader,side:fs,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(b,T,M){this.matrixWorld.copyPosition(M.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(h)),h.material.uniforms.envMap.value=_,h.material.uniforms.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,h.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,h.material.toneMapped=_.colorSpace!==Jt,(u!==_||d!==_.version||f!==t.toneMapping)&&(h.material.needsUpdate=!0,u=_,d=_.version,f=t.toneMapping),h.layers.enableAll(),g.unshift(h,h.geometry,h.material,0,0,null)):_&&_.isTexture&&(c===void 0&&(c=new gr(new iv(2,2),new Kl({name:"BackgroundMaterial",uniforms:Pg(Oa.background.uniforms),vertexShader:Oa.background.vertexShader,fragmentShader:Oa.background.fragmentShader,side:ql,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=_,c.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,c.material.toneMapped=_.colorSpace!==Jt,_.matrixAutoUpdate===!0&&_.updateMatrix(),c.material.uniforms.uvTransform.value.copy(_.matrix),(u!==_||d!==_.version||f!==t.toneMapping)&&(c.material.needsUpdate=!0,u=_,d=_.version,f=t.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}function v(g,m){g.getRGB(hw,n7(t)),i.buffers.color.setClear(hw.r,hw.g,hw.b,m,o)}return{getClearColor:function(){return a},setClearColor:function(g,m=1){a.set(g),l=m,v(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,v(a,l)},render:p}}function Zae(t,e,n,i){const r=t.getParameter(t.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||s!==null,a={},l=g(null);let c=l,h=!1;function u(k,j,Z,ee,O){let W=!1;if(o){const H=v(ee,Z,j);c!==H&&(c=H,f(c.object)),W=m(k,ee,Z,O),W&&y(k,ee,Z,O)}else{const H=j.wireframe===!0;(c.geometry!==ee.id||c.program!==Z.id||c.wireframe!==H)&&(c.geometry=ee.id,c.program=Z.id,c.wireframe=H,W=!0)}O!==null&&n.update(O,t.ELEMENT_ARRAY_BUFFER),(W||h)&&(h=!1,M(k,j,Z,ee),O!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.get(O).buffer))}function d(){return i.isWebGL2?t.createVertexArray():s.createVertexArrayOES()}function f(k){return i.isWebGL2?t.bindVertexArray(k):s.bindVertexArrayOES(k)}function p(k){return i.isWebGL2?t.deleteVertexArray(k):s.deleteVertexArrayOES(k)}function v(k,j,Z){const ee=Z.wireframe===!0;let O=a[k.id];O===void 0&&(O={},a[k.id]=O);let W=O[j.id];W===void 0&&(W={},O[j.id]=W);let H=W[ee];return H===void 0&&(H=g(d()),W[ee]=H),H}function g(k){const j=[],Z=[],ee=[];for(let O=0;O<r;O++)j[O]=0,Z[O]=0,ee[O]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:j,enabledAttributes:Z,attributeDivisors:ee,object:k,attributes:{},index:null}}function m(k,j,Z,ee){const O=c.attributes,W=j.attributes;let H=0;const Y=Z.getAttributes();for(const z in Y)if(Y[z].location>=0){const q=O[z];let re=W[z];if(re===void 0&&(z==="instanceMatrix"&&k.instanceMatrix&&(re=k.instanceMatrix),z==="instanceColor"&&k.instanceColor&&(re=k.instanceColor)),q===void 0||q.attribute!==re||re&&q.data!==re.data)return!0;H++}return c.attributesNum!==H||c.index!==ee}function y(k,j,Z,ee){const O={},W=j.attributes;let H=0;const Y=Z.getAttributes();for(const z in Y)if(Y[z].location>=0){let q=W[z];q===void 0&&(z==="instanceMatrix"&&k.instanceMatrix&&(q=k.instanceMatrix),z==="instanceColor"&&k.instanceColor&&(q=k.instanceColor));const re={};re.attribute=q,q&&q.data&&(re.data=q.data),O[z]=re,H++}c.attributes=O,c.attributesNum=H,c.index=ee}function _(){const k=c.newAttributes;for(let j=0,Z=k.length;j<Z;j++)k[j]=0}function S(k){A(k,0)}function A(k,j){const Z=c.newAttributes,ee=c.enabledAttributes,O=c.attributeDivisors;Z[k]=1,ee[k]===0&&(t.enableVertexAttribArray(k),ee[k]=1),O[k]!==j&&((i.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](k,j),O[k]=j)}function b(){const k=c.newAttributes,j=c.enabledAttributes;for(let Z=0,ee=j.length;Z<ee;Z++)j[Z]!==k[Z]&&(t.disableVertexAttribArray(Z),j[Z]=0)}function T(k,j,Z,ee,O,W){i.isWebGL2===!0&&(Z===t.INT||Z===t.UNSIGNED_INT)?t.vertexAttribIPointer(k,j,Z,O,W):t.vertexAttribPointer(k,j,Z,ee,O,W)}function M(k,j,Z,ee){if(i.isWebGL2===!1&&(k.isInstancedMesh||ee.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;_();const O=ee.attributes,W=Z.getAttributes(),H=j.defaultAttributeValues;for(const Y in W){const z=W[Y];if(z.location>=0){let X=O[Y];if(X===void 0&&(Y==="instanceMatrix"&&k.instanceMatrix&&(X=k.instanceMatrix),Y==="instanceColor"&&k.instanceColor&&(X=k.instanceColor)),X!==void 0){const q=X.normalized,re=X.itemSize,G=n.get(X);if(G===void 0)continue;const K=G.buffer,oe=G.type,ve=G.bytesPerElement;if(X.isInterleavedBufferAttribute){const $=X.data,se=$.stride,ne=X.offset;if($.isInstancedInterleavedBuffer){for(let ie=0;ie<z.locationSize;ie++)A(z.location+ie,$.meshPerAttribute);k.isInstancedMesh!==!0&&ee._maxInstanceCount===void 0&&(ee._maxInstanceCount=$.meshPerAttribute*$.count)}else for(let ie=0;ie<z.locationSize;ie++)S(z.location+ie);t.bindBuffer(t.ARRAY_BUFFER,K);for(let ie=0;ie<z.locationSize;ie++)T(z.location+ie,re/z.locationSize,oe,q,se*ve,(ne+re/z.locationSize*ie)*ve)}else{if(X.isInstancedBufferAttribute){for(let $=0;$<z.locationSize;$++)A(z.location+$,X.meshPerAttribute);k.isInstancedMesh!==!0&&ee._maxInstanceCount===void 0&&(ee._maxInstanceCount=X.meshPerAttribute*X.count)}else for(let $=0;$<z.locationSize;$++)S(z.location+$);t.bindBuffer(t.ARRAY_BUFFER,K);for(let $=0;$<z.locationSize;$++)T(z.location+$,re/z.locationSize,oe,q,re*ve,re/z.locationSize*$*ve)}}else if(H!==void 0){const q=H[Y];if(q!==void 0)switch(q.length){case 2:t.vertexAttrib2fv(z.location,q);break;case 3:t.vertexAttrib3fv(z.location,q);break;case 4:t.vertexAttrib4fv(z.location,q);break;default:t.vertexAttrib1fv(z.location,q)}}}}b()}function E(){F();for(const k in a){const j=a[k];for(const Z in j){const ee=j[Z];for(const O in ee)p(ee[O].object),delete ee[O];delete j[Z]}delete a[k]}}function P(k){if(a[k.id]===void 0)return;const j=a[k.id];for(const Z in j){const ee=j[Z];for(const O in ee)p(ee[O].object),delete ee[O];delete j[Z]}delete a[k.id]}function R(k){for(const j in a){const Z=a[j];if(Z[k.id]===void 0)continue;const ee=Z[k.id];for(const O in ee)p(ee[O].object),delete ee[O];delete Z[k.id]}}function F(){B(),h=!0,c!==l&&(c=l,f(c.object))}function B(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:u,reset:F,resetDefaultState:B,dispose:E,releaseStatesOfGeometry:P,releaseStatesOfProgram:R,initAttributes:_,enableAttribute:S,disableUnusedAttributes:b}}function $ae(t,e,n,i){const r=i.isWebGL2;let s;function o(c){s=c}function a(c,h){t.drawArrays(s,c,h),n.update(h,s,1)}function l(c,h,u){if(u===0)return;let d,f;if(r)d=t,f="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[f](s,c,h,u),n.update(h,s,u)}this.setMode=o,this.render=a,this.renderInstances=l}function ele(t,e,n){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const T=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(T){if(T==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";T="mediump"}return T==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&t.constructor.name==="WebGL2RenderingContext";let a=n.precision!==void 0?n.precision:"highp";const l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);const c=o||e.has("WEBGL_draw_buffers"),h=n.logarithmicDepthBuffer===!0,u=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),d=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=t.getParameter(t.MAX_TEXTURE_SIZE),p=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),v=t.getParameter(t.MAX_VERTEX_ATTRIBS),g=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),m=t.getParameter(t.MAX_VARYING_VECTORS),y=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),_=d>0,S=o||e.has("OES_texture_float"),A=_&&S,b=o?t.getParameter(t.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:h,maxTextures:u,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:v,maxVertexUniforms:g,maxVaryings:m,maxFragmentUniforms:y,vertexTextures:_,floatFragmentTextures:S,floatVertexTextures:A,maxSamples:b}}function tle(t){const e=this;let n=null,i=0,r=!1,s=!1;const o=new qu,a=new ln,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,d){const f=u.length!==0||d||i!==0||r;return r=d,i=u.length,f},this.beginShadows=function(){s=!0,h(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(u,d){n=h(u,d,0)},this.setState=function(u,d,f){const p=u.clippingPlanes,v=u.clipIntersection,g=u.clipShadows,m=t.get(u);if(!r||p===null||p.length===0||s&&!g)s?h(null):c();else{const y=s?0:i,_=y*4;let S=m.clippingState||null;l.value=S,S=h(p,d,_,f);for(let A=0;A!==_;++A)S[A]=n[A];m.clippingState=S,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==n&&(l.value=n,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function h(u,d,f,p){const v=u!==null?u.length:0;let g=null;if(v!==0){if(g=l.value,p!==!0||g===null){const m=f+v*4,y=d.matrixWorldInverse;a.getNormalMatrix(y),(g===null||g.length<m)&&(g=new Float32Array(m));for(let _=0,S=f;_!==v;++_,S+=4)o.copy(u[_]).applyMatrix4(y,a),o.normal.toArray(g,S),g[S+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=v,e.numIntersection=0,g}}function nle(t){let e=new WeakMap;function n(o,a){return a===sx?o.mapping=Fh:a===ox&&(o.mapping=Nh),o}function i(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){const a=o.mapping;if(a===sx||a===ox)if(e.has(o)){const l=e.get(o).texture;return n(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const c=new lB(l.height/2);return c.fromEquirectangularTexture(t,o),e.set(o,c),o.addEventListener("dispose",r),n(c.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}class ja extends Jx{constructor(e=-1,n=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+n,l=r-n;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,o=s+c*this.view.width,a-=h*this.view.offsetY,l=a-h*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,l,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}const Rm=4,az=[.125,.215,.35,.446,.526,.582],Gd=20,NT=new ja,lz=new st;let UT=null;const Id=(1+Math.sqrt(5))/2,Cp=1/Id,cz=[new ae(1,1,1),new ae(-1,1,1),new ae(1,1,-1),new ae(-1,1,-1),new ae(0,Id,Cp),new ae(0,Id,-Cp),new ae(Cp,0,Id),new ae(-Cp,0,Id),new ae(Id,Cp,0),new ae(-Id,Cp,0)];class jR{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,i=.1,r=100){UT=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),n>0&&this._blur(s,0,0,n),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=dz(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=hz(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(UT),e.scissorTest=!1,dw(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===Fh||e.mapping===Nh?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),UT=this._renderer.getRenderTarget();const i=n||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,i={magFilter:oi,minFilter:oi,generateMipmaps:!1,type:Eg,format:Es,colorSpace:Ya,depthBuffer:!1},r=uz(e,n,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=uz(e,n,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=ile(s)),this._blurMaterial=rle(s,e,n)}return r}_compileMaterial(e){const n=new gr(this._lodPlanes[0],e);this._renderer.compile(n,NT)}_sceneToCubeUV(e,n,i,r){const a=new zn(90,1,n,i),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],h=this._renderer,u=h.autoClear,d=h.toneMapping;h.getClearColor(lz),h.toneMapping=Va,h.autoClear=!1;const f=new so({name:"PMREM.Background",side:fs,depthWrite:!1,depthTest:!1}),p=new gr(new Kh,f);let v=!1;const g=e.background;g?g.isColor&&(f.color.copy(g),e.background=null,v=!0):(f.color.copy(lz),v=!0);for(let m=0;m<6;m++){const y=m%3;y===0?(a.up.set(0,l[m],0),a.lookAt(c[m],0,0)):y===1?(a.up.set(0,0,l[m]),a.lookAt(0,c[m],0)):(a.up.set(0,l[m],0),a.lookAt(0,0,c[m]));const _=this._cubeSize;dw(r,y*_,m>2?_:0,_,_),h.setRenderTarget(r),v&&h.render(p,a),h.render(e,a)}p.geometry.dispose(),p.material.dispose(),h.toneMapping=d,h.autoClear=u,e.background=g}_textureToCubeUV(e,n){const i=this._renderer,r=e.mapping===Fh||e.mapping===Nh;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=dz()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=hz());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new gr(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const l=this._cubeSize;dw(n,0,0,3*l,2*l),i.setRenderTarget(n),i.render(o,NT)}_applyPMREM(e){const n=this._renderer,i=n.autoClear;n.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=cz[(r-1)%cz.length];this._blur(e,r-1,r,s,o)}n.autoClear=i}_blur(e,n,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,n,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,n,i,r,s,o,a){const l=this._renderer,c=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const h=3,u=new gr(this._lodPlanes[r],c),d=c.uniforms,f=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/(2*Gd-1),v=s/p,g=isFinite(s)?1+Math.floor(h*v):Gd;g>Gd&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${g} samples when the maximum is set to ${Gd}`);const m=[];let y=0;for(let T=0;T<Gd;++T){const M=T/v,E=Math.exp(-M*M/2);m.push(E),T===0?y+=E:T<g&&(y+=2*E)}for(let T=0;T<m.length;T++)m[T]=m[T]/y;d.envMap.value=e.texture,d.samples.value=g,d.weights.value=m,d.latitudinal.value=o==="latitudinal",a&&(d.poleAxis.value=a);const{_lodMax:_}=this;d.dTheta.value=p,d.mipInt.value=_-i;const S=this._sizeLods[r],A=3*S*(r>_-Rm?r-_+Rm:0),b=4*(this._cubeSize-S);dw(n,A,b,3*S,2*S),l.setRenderTarget(n),l.render(u,NT)}}function ile(t){const e=[],n=[],i=[];let r=t;const s=t-Rm+1+az.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);n.push(a);let l=1/a;o>t-Rm?l=az[o-t+Rm-1]:o===0&&(l=0),i.push(l);const c=1/(a-2),h=-c,u=1+c,d=[h,h,u,h,u,u,h,h,u,u,h,u],f=6,p=6,v=3,g=2,m=1,y=new Float32Array(v*p*f),_=new Float32Array(g*p*f),S=new Float32Array(m*p*f);for(let b=0;b<f;b++){const T=b%3*2/3-1,M=b>2?0:-1,E=[T,M,0,T+2/3,M,0,T+2/3,M+1,0,T,M,0,T+2/3,M+1,0,T,M+1,0];y.set(E,v*p*b),_.set(d,g*p*b);const P=[b,b,b,b,b,b];S.set(P,m*p*b)}const A=new Kt;A.setAttribute("position",new bn(y,v)),A.setAttribute("uv",new bn(_,g)),A.setAttribute("faceIndex",new bn(S,m)),e.push(A),r>Rm&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}function uz(t,e,n){const i=new qa(t,e,n);return i.texture.mapping=nv,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function dw(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function rle(t,e,n){const i=new Float32Array(Gd),r=new ae(0,1,0);return new Kl({name:"SphericalGaussianBlur",defines:{n:Gd,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:cB(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Wc,depthTest:!1,depthWrite:!1})}function hz(){return new Kl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:cB(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Wc,depthTest:!1,depthWrite:!1})}function dz(){return new Kl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:cB(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Wc,depthTest:!1,depthWrite:!1})}function cB(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function sle(t){let e=new WeakMap,n=null;function i(a){if(a&&a.isTexture){const l=a.mapping,c=l===sx||l===ox,h=l===Fh||l===Nh;if(c||h)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let u=e.get(a);return n===null&&(n=new jR(t)),u=c?n.fromEquirectangular(a,u):n.fromCubemap(a,u),e.set(a,u),u.texture}else{if(e.has(a))return e.get(a).texture;{const u=a.image;if(c&&u&&u.height>0||h&&u&&r(u)){n===null&&(n=new jR(t));const d=c?n.fromEquirectangular(a):n.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}else return null}}}return a}function r(a){let l=0;const c=6;for(let h=0;h<c;h++)a[h]!==void 0&&l++;return l===c}function s(a){const l=a.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:o}}function ole(t){const e={};function n(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(i)}return e[i]=r,r}return{has:function(i){return n(i)!==null},init:function(i){i.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(i){const r=n(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function ale(t,e,n,i){const r={},s=new WeakMap;function o(u){const d=u.target;d.index!==null&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);d.removeEventListener("dispose",o),delete r[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),i.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,n.memory.geometries--}function a(u,d){return r[d.id]===!0||(d.addEventListener("dispose",o),r[d.id]=!0,n.memory.geometries++),d}function l(u){const d=u.attributes;for(const p in d)e.update(d[p],t.ARRAY_BUFFER);const f=u.morphAttributes;for(const p in f){const v=f[p];for(let g=0,m=v.length;g<m;g++)e.update(v[g],t.ARRAY_BUFFER)}}function c(u){const d=[],f=u.index,p=u.attributes.position;let v=0;if(f!==null){const y=f.array;v=f.version;for(let _=0,S=y.length;_<S;_+=3){const A=y[_+0],b=y[_+1],T=y[_+2];d.push(A,b,b,T,T,A)}}else{const y=p.array;v=p.version;for(let _=0,S=y.length/3-1;_<S;_+=3){const A=_+0,b=_+1,T=_+2;d.push(A,b,b,T,T,A)}}const g=new(e7(d)?oB:sB)(d,1);g.version=v;const m=s.get(u);m&&e.remove(m),s.set(u,g)}function h(u){const d=s.get(u);if(d){const f=u.index;f!==null&&d.version<f.version&&c(u)}else c(u);return s.get(u)}return{get:a,update:l,getWireframeAttribute:h}}function lle(t,e,n,i){const r=i.isWebGL2;let s;function o(d){s=d}let a,l;function c(d){a=d.type,l=d.bytesPerElement}function h(d,f){t.drawElements(s,f,a,d*l),n.update(f,s,1)}function u(d,f,p){if(p===0)return;let v,g;if(r)v=t,g="drawElementsInstanced";else if(v=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",v===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}v[g](s,f,a,d*l,p),n.update(f,s,p)}this.setMode=o,this.setIndex=c,this.render=h,this.renderInstances=u}function cle(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(n.calls++,o){case t.TRIANGLES:n.triangles+=a*(s/3);break;case t.LINES:n.lines+=a*(s/2);break;case t.LINE_STRIP:n.lines+=a*(s-1);break;case t.LINE_LOOP:n.lines+=a*s;break;case t.POINTS:n.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:r,update:i}}function ule(t,e){return t[0]-e[0]}function hle(t,e){return Math.abs(e[1])-Math.abs(t[1])}function dle(t,e,n){const i={},r=new Float32Array(8),s=new WeakMap,o=new Dn,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,h,u){const d=c.morphTargetInfluences;if(e.isWebGL2===!0){const p=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,v=p!==void 0?p.length:0;let g=s.get(h);if(g===void 0||g.count!==v){let j=function(){B.dispose(),s.delete(h),h.removeEventListener("dispose",j)};var f=j;g!==void 0&&g.texture.dispose();const _=h.morphAttributes.position!==void 0,S=h.morphAttributes.normal!==void 0,A=h.morphAttributes.color!==void 0,b=h.morphAttributes.position||[],T=h.morphAttributes.normal||[],M=h.morphAttributes.color||[];let E=0;_===!0&&(E=1),S===!0&&(E=2),A===!0&&(E=3);let P=h.attributes.position.count*E,R=1;P>e.maxTextureSize&&(R=Math.ceil(P/e.maxTextureSize),P=e.maxTextureSize);const F=new Float32Array(P*R*4*v),B=new kM(F,P,R,v);B.type=Uc,B.needsUpdate=!0;const k=E*4;for(let Z=0;Z<v;Z++){const ee=b[Z],O=T[Z],W=M[Z],H=P*R*4*Z;for(let Y=0;Y<ee.count;Y++){const z=Y*k;_===!0&&(o.fromBufferAttribute(ee,Y),F[H+z+0]=o.x,F[H+z+1]=o.y,F[H+z+2]=o.z,F[H+z+3]=0),S===!0&&(o.fromBufferAttribute(O,Y),F[H+z+4]=o.x,F[H+z+5]=o.y,F[H+z+6]=o.z,F[H+z+7]=0),A===!0&&(o.fromBufferAttribute(W,Y),F[H+z+8]=o.x,F[H+z+9]=o.y,F[H+z+10]=o.z,F[H+z+11]=W.itemSize===4?o.w:1)}}g={count:v,texture:B,size:new Ye(P,R)},s.set(h,g),h.addEventListener("dispose",j)}let m=0;for(let _=0;_<d.length;_++)m+=d[_];const y=h.morphTargetsRelative?1:1-m;u.getUniforms().setValue(t,"morphTargetBaseInfluence",y),u.getUniforms().setValue(t,"morphTargetInfluences",d),u.getUniforms().setValue(t,"morphTargetsTexture",g.texture,n),u.getUniforms().setValue(t,"morphTargetsTextureSize",g.size)}else{const p=d===void 0?0:d.length;let v=i[h.id];if(v===void 0||v.length!==p){v=[];for(let S=0;S<p;S++)v[S]=[S,0];i[h.id]=v}for(let S=0;S<p;S++){const A=v[S];A[0]=S,A[1]=d[S]}v.sort(hle);for(let S=0;S<8;S++)S<p&&v[S][1]?(a[S][0]=v[S][0],a[S][1]=v[S][1]):(a[S][0]=Number.MAX_SAFE_INTEGER,a[S][1]=0);a.sort(ule);const g=h.morphAttributes.position,m=h.morphAttributes.normal;let y=0;for(let S=0;S<8;S++){const A=a[S],b=A[0],T=A[1];b!==Number.MAX_SAFE_INTEGER&&T?(g&&h.getAttribute("morphTarget"+S)!==g[b]&&h.setAttribute("morphTarget"+S,g[b]),m&&h.getAttribute("morphNormal"+S)!==m[b]&&h.setAttribute("morphNormal"+S,m[b]),r[S]=T,y+=T):(g&&h.hasAttribute("morphTarget"+S)===!0&&h.deleteAttribute("morphTarget"+S),m&&h.hasAttribute("morphNormal"+S)===!0&&h.deleteAttribute("morphNormal"+S),r[S]=0)}const _=h.morphTargetsRelative?1:1-y;u.getUniforms().setValue(t,"morphTargetBaseInfluence",_),u.getUniforms().setValue(t,"morphTargetInfluences",r)}}return{update:l}}function fle(t,e,n,i){let r=new WeakMap;function s(l){const c=i.render.frame,h=l.geometry,u=e.get(l,h);return r.get(u)!==c&&(e.update(u),r.set(u,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),n.update(l.instanceMatrix,t.ARRAY_BUFFER),l.instanceColor!==null&&n.update(l.instanceColor,t.ARRAY_BUFFER)),u}function o(){r=new WeakMap}function a(l){const c=l.target;c.removeEventListener("dispose",a),n.remove(c.instanceMatrix),c.instanceColor!==null&&n.remove(c.instanceColor)}return{update:s,dispose:o}}const s7=new ni,o7=new kM,a7=new rB,l7=new Zx,fz=[],pz=[],mz=new Float32Array(16),gz=new Float32Array(9),vz=new Float32Array(4);function rv(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let s=fz[r];if(s===void 0&&(s=new Float32Array(r),fz[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=n,t[o].toArray(s,a)}return s}function er(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function tr(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function GM(t,e){let n=pz[e];n===void 0&&(n=new Int32Array(e),pz[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function ple(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function mle(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(er(n,e))return;t.uniform2fv(this.addr,e),tr(n,e)}}function gle(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(er(n,e))return;t.uniform3fv(this.addr,e),tr(n,e)}}function vle(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(er(n,e))return;t.uniform4fv(this.addr,e),tr(n,e)}}function yle(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(er(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),tr(n,e)}else{if(er(n,i))return;vz.set(i),t.uniformMatrix2fv(this.addr,!1,vz),tr(n,i)}}function xle(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(er(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),tr(n,e)}else{if(er(n,i))return;gz.set(i),t.uniformMatrix3fv(this.addr,!1,gz),tr(n,i)}}function _le(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(er(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),tr(n,e)}else{if(er(n,i))return;mz.set(i),t.uniformMatrix4fv(this.addr,!1,mz),tr(n,i)}}function wle(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Sle(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(er(n,e))return;t.uniform2iv(this.addr,e),tr(n,e)}}function ble(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(er(n,e))return;t.uniform3iv(this.addr,e),tr(n,e)}}function Ale(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(er(n,e))return;t.uniform4iv(this.addr,e),tr(n,e)}}function Mle(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Ele(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(er(n,e))return;t.uniform2uiv(this.addr,e),tr(n,e)}}function Cle(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(er(n,e))return;t.uniform3uiv(this.addr,e),tr(n,e)}}function Tle(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(er(n,e))return;t.uniform4uiv(this.addr,e),tr(n,e)}}function Ple(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2D(e||s7,r)}function Dle(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||a7,r)}function Rle(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||l7,r)}function Lle(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||o7,r)}function Ile(t){switch(t){case 5126:return ple;case 35664:return mle;case 35665:return gle;case 35666:return vle;case 35674:return yle;case 35675:return xle;case 35676:return _le;case 5124:case 35670:return wle;case 35667:case 35671:return Sle;case 35668:case 35672:return ble;case 35669:case 35673:return Ale;case 5125:return Mle;case 36294:return Ele;case 36295:return Cle;case 36296:return Tle;case 35678:case 36198:case 36298:case 36306:case 35682:return Ple;case 35679:case 36299:case 36307:return Dle;case 35680:case 36300:case 36308:case 36293:return Rle;case 36289:case 36303:case 36311:case 36292:return Lle}}function Ble(t,e){t.uniform1fv(this.addr,e)}function Ole(t,e){const n=rv(e,this.size,2);t.uniform2fv(this.addr,n)}function Fle(t,e){const n=rv(e,this.size,3);t.uniform3fv(this.addr,n)}function Nle(t,e){const n=rv(e,this.size,4);t.uniform4fv(this.addr,n)}function Ule(t,e){const n=rv(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function kle(t,e){const n=rv(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function zle(t,e){const n=rv(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function Gle(t,e){t.uniform1iv(this.addr,e)}function Hle(t,e){t.uniform2iv(this.addr,e)}function Vle(t,e){t.uniform3iv(this.addr,e)}function jle(t,e){t.uniform4iv(this.addr,e)}function Wle(t,e){t.uniform1uiv(this.addr,e)}function Xle(t,e){t.uniform2uiv(this.addr,e)}function Yle(t,e){t.uniform3uiv(this.addr,e)}function qle(t,e){t.uniform4uiv(this.addr,e)}function Qle(t,e,n){const i=this.cache,r=e.length,s=GM(n,r);er(i,s)||(t.uniform1iv(this.addr,s),tr(i,s));for(let o=0;o!==r;++o)n.setTexture2D(e[o]||s7,s[o])}function Kle(t,e,n){const i=this.cache,r=e.length,s=GM(n,r);er(i,s)||(t.uniform1iv(this.addr,s),tr(i,s));for(let o=0;o!==r;++o)n.setTexture3D(e[o]||a7,s[o])}function Jle(t,e,n){const i=this.cache,r=e.length,s=GM(n,r);er(i,s)||(t.uniform1iv(this.addr,s),tr(i,s));for(let o=0;o!==r;++o)n.setTextureCube(e[o]||l7,s[o])}function Zle(t,e,n){const i=this.cache,r=e.length,s=GM(n,r);er(i,s)||(t.uniform1iv(this.addr,s),tr(i,s));for(let o=0;o!==r;++o)n.setTexture2DArray(e[o]||o7,s[o])}function $le(t){switch(t){case 5126:return Ble;case 35664:return Ole;case 35665:return Fle;case 35666:return Nle;case 35674:return Ule;case 35675:return kle;case 35676:return zle;case 5124:case 35670:return Gle;case 35667:case 35671:return Hle;case 35668:case 35672:return Vle;case 35669:case 35673:return jle;case 5125:return Wle;case 36294:return Xle;case 36295:return Yle;case 36296:return qle;case 35678:case 36198:case 36298:case 36306:case 35682:return Qle;case 35679:case 36299:case 36307:return Kle;case 35680:case 36300:case 36308:case 36293:return Jle;case 36289:case 36303:case 36311:case 36292:return Zle}}class ece{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.setValue=Ile(n.type)}}class tce{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.size=n.size,this.setValue=$le(n.type)}}class nce{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,n[a.id],i)}}}const kT=/(\w+)(\])?(\[|\.)?/g;function yz(t,e){t.seq.push(e),t.map[e.id]=e}function ice(t,e,n){const i=t.name,r=i.length;for(kT.lastIndex=0;;){const s=kT.exec(i),o=kT.lastIndex;let a=s[1];const l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){yz(n,c===void 0?new ece(a,t,e):new tce(a,t,e));break}else{let u=n.map[a];u===void 0&&(u=new nce(a),yz(n,u)),n=u}}}class vb{constructor(e,n){this.seq=[],this.map={};const i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(n,r),o=e.getUniformLocation(n,s.name);ice(s,o,this)}}setValue(e,n,i,r){const s=this.map[n];s!==void 0&&s.setValue(e,i,r)}setOptional(e,n,i){const r=n[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,n,i,r){for(let s=0,o=n.length;s!==o;++s){const a=n[s],l=i[a.id];l.needsUpdate!==!1&&a.setValue(e,l.value,r)}}static seqWithValue(e,n){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in n&&i.push(o)}return i}}function xz(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}let rce=0;function sce(t,e){const n=t.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${n[o]}`)}return i.join(`
`)}function oce(t){switch(t){case Ya:return["Linear","( value )"];case Jt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",t),["Linear","( value )"]}}function _z(t,e,n){const i=t.getShaderParameter(e,t.COMPILE_STATUS),r=t.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return n.toUpperCase()+`

`+r+`

`+sce(t.getShaderSource(e),o)}else return r}function ace(t,e){const n=oce(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function lce(t,e){let n;switch(e){case AX:n="Linear";break;case MX:n="Reinhard";break;case EX:n="OptimizedCineon";break;case K3:n="ACESFilmic";break;case CX:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function cce(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.normalMapTangentSpace||t.clearcoatNormalMap||t.flatShading||t.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Q0).join(`
`)}function uce(t){const e=[];for(const n in t){const i=t[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function hce(t,e){const n={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=t.getActiveAttrib(e,r),o=s.name;let a=1;s.type===t.FLOAT_MAT2&&(a=2),s.type===t.FLOAT_MAT3&&(a=3),s.type===t.FLOAT_MAT4&&(a=4),n[o]={type:s.type,location:t.getAttribLocation(e,o),locationSize:a}}return n}function Q0(t){return t!==""}function wz(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Sz(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const dce=/^[ \t]*#include +<([\w\d./]+)>/gm;function WR(t){return t.replace(dce,fce)}function fce(t,e){const n=tn[e];if(n===void 0)throw new Error("Can not resolve #include <"+e+">");return WR(n)}const pce=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function bz(t){return t.replace(pce,mce)}function mce(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function Az(t){let e="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function gce(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===OM?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===py?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===La&&(e="SHADOWMAP_TYPE_VSM"),e}function vce(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case Fh:case Nh:e="ENVMAP_TYPE_CUBE";break;case nv:e="ENVMAP_TYPE_CUBE_UV";break}return e}function yce(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case Nh:e="ENVMAP_MODE_REFRACTION";break}return e}function xce(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case qx:e="ENVMAP_BLENDING_MULTIPLY";break;case SX:e="ENVMAP_BLENDING_MIX";break;case bX:e="ENVMAP_BLENDING_ADD";break}return e}function _ce(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:i,maxMip:n}}function wce(t,e,n,i){const r=t.getContext(),s=n.defines;let o=n.vertexShader,a=n.fragmentShader;const l=gce(n),c=vce(n),h=yce(n),u=xce(n),d=_ce(n),f=n.isWebGL2?"":cce(n),p=uce(s),v=r.createProgram();let g,m,y=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(g=[p].filter(Q0).join(`
`),g.length>0&&(g+=`
`),m=[f,p].filter(Q0).join(`
`),m.length>0&&(m+=`
`)):(g=[Az(n),"#define SHADER_NAME "+n.shaderName,p,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Q0).join(`
`),m=[f,Az(n),"#define SHADER_NAME "+n.shaderName,p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+h:"",n.envMap?"#define "+u:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Va?"#define TONE_MAPPING":"",n.toneMapping!==Va?tn.tonemapping_pars_fragment:"",n.toneMapping!==Va?lce("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",tn.encodings_pars_fragment,ace("linearToOutputTexel",n.outputColorSpace),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(Q0).join(`
`)),o=WR(o),o=wz(o,n),o=Sz(o,n),a=WR(a),a=wz(a,n),a=Sz(a,n),o=bz(o),a=bz(a),n.isWebGL2&&n.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,m=["#define varying in",n.glslVersion===HR?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===HR?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+m);const _=y+g+o,S=y+m+a,A=xz(r,r.VERTEX_SHADER,_),b=xz(r,r.FRAGMENT_SHADER,S);if(r.attachShader(v,A),r.attachShader(v,b),n.index0AttributeName!==void 0?r.bindAttribLocation(v,0,n.index0AttributeName):n.morphTargets===!0&&r.bindAttribLocation(v,0,"position"),r.linkProgram(v),t.debug.checkShaderErrors){const E=r.getProgramInfoLog(v).trim(),P=r.getShaderInfoLog(A).trim(),R=r.getShaderInfoLog(b).trim();let F=!0,B=!0;if(r.getProgramParameter(v,r.LINK_STATUS)===!1)if(F=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(r,v,A,b);else{const k=_z(r,A,"vertex"),j=_z(r,b,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(v,r.VALIDATE_STATUS)+`

Program Info Log: `+E+`
`+k+`
`+j)}else E!==""?console.warn("THREE.WebGLProgram: Program Info Log:",E):(P===""||R==="")&&(B=!1);B&&(this.diagnostics={runnable:F,programLog:E,vertexShader:{log:P,prefix:g},fragmentShader:{log:R,prefix:m}})}r.deleteShader(A),r.deleteShader(b);let T;this.getUniforms=function(){return T===void 0&&(T=new vb(r,v)),T};let M;return this.getAttributes=function(){return M===void 0&&(M=hce(r,v)),M},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(v),this.program=void 0},this.name=n.shaderName,this.id=rce++,this.cacheKey=e,this.usedTimes=1,this.program=v,this.vertexShader=A,this.fragmentShader=b,this}let Sce=0;class bce{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(n),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const i of n)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let i=n.get(e);return i===void 0&&(i=new Set,n.set(e,i)),i}_getShaderStage(e){const n=this.shaderCache;let i=n.get(e);return i===void 0&&(i=new Ace(e),n.set(e,i)),i}}class Ace{constructor(e){this.id=Sce++,this.code=e,this.usedTimes=0}}function Mce(t,e,n,i,r,s,o){const a=new hf,l=new bce,c=[],h=r.isWebGL2,u=r.logarithmicDepthBuffer,d=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(E){return E===1?"uv1":E===2?"uv2":E===3?"uv3":"uv"}function g(E,P,R,F,B){const k=F.fog,j=B.geometry,Z=E.isMeshStandardMaterial?F.environment:null,ee=(E.isMeshStandardMaterial?n:e).get(E.envMap||Z),O=ee&&ee.mapping===nv?ee.image.height:null,W=p[E.type];E.precision!==null&&(f=r.getMaxPrecision(E.precision),f!==E.precision&&console.warn("THREE.WebGLProgram.getParameters:",E.precision,"not supported, using",f,"instead."));const H=j.morphAttributes.position||j.morphAttributes.normal||j.morphAttributes.color,Y=H!==void 0?H.length:0;let z=0;j.morphAttributes.position!==void 0&&(z=1),j.morphAttributes.normal!==void 0&&(z=2),j.morphAttributes.color!==void 0&&(z=3);let X,q,re,G;if(W){const vt=Oa[W];X=vt.vertexShader,q=vt.fragmentShader}else X=E.vertexShader,q=E.fragmentShader,l.update(E),re=l.getVertexShaderID(E),G=l.getFragmentShaderID(E);const K=t.getRenderTarget(),oe=B.isInstancedMesh===!0,ve=!!E.map,$=!!E.matcap,se=!!ee,ne=!!E.aoMap,ie=!!E.lightMap,me=!!E.bumpMap,xe=!!E.normalMap,Ae=!!E.displacementMap,we=!!E.emissiveMap,Ee=!!E.metalnessMap,Re=!!E.roughnessMap,Ue=E.clearcoat>0,Ne=E.iridescence>0,U=E.sheen>0,L=E.transmission>0,te=Ue&&!!E.clearcoatMap,_e=Ue&&!!E.clearcoatNormalMap,Te=Ue&&!!E.clearcoatRoughnessMap,Ie=Ne&&!!E.iridescenceMap,Qe=Ne&&!!E.iridescenceThicknessMap,Ge=U&&!!E.sheenColorMap,ye=U&&!!E.sheenRoughnessMap,Ve=!!E.specularMap,ue=!!E.specularColorMap,Me=!!E.specularIntensityMap,Be=L&&!!E.transmissionMap,ze=L&&!!E.thicknessMap,$e=!!E.gradientMap,dt=!!E.alphaMap,Bt=E.alphaTest>0,J=!!E.extensions,fe=!!j.attributes.uv1,be=!!j.attributes.uv2,Oe=!!j.attributes.uv3;return{isWebGL2:h,shaderID:W,shaderName:E.type,vertexShader:X,fragmentShader:q,defines:E.defines,customVertexShaderID:re,customFragmentShaderID:G,isRawShaderMaterial:E.isRawShaderMaterial===!0,glslVersion:E.glslVersion,precision:f,instancing:oe,instancingColor:oe&&B.instanceColor!==null,supportsVertexTextures:d,outputColorSpace:K===null?t.outputColorSpace:K.isXRRenderTarget===!0?K.texture.colorSpace:Ya,map:ve,matcap:$,envMap:se,envMapMode:se&&ee.mapping,envMapCubeUVHeight:O,aoMap:ne,lightMap:ie,bumpMap:me,normalMap:xe,displacementMap:d&&Ae,emissiveMap:we,normalMapObjectSpace:xe&&E.normalMapType===QX,normalMapTangentSpace:xe&&E.normalMapType===Qh,metalnessMap:Ee,roughnessMap:Re,clearcoat:Ue,clearcoatMap:te,clearcoatNormalMap:_e,clearcoatRoughnessMap:Te,iridescence:Ne,iridescenceMap:Ie,iridescenceThicknessMap:Qe,sheen:U,sheenColorMap:Ge,sheenRoughnessMap:ye,specularMap:Ve,specularColorMap:ue,specularIntensityMap:Me,transmission:L,transmissionMap:Be,thicknessMap:ze,gradientMap:$e,opaque:E.transparent===!1&&E.blending===af,alphaMap:dt,alphaTest:Bt,combine:E.combine,mapUv:ve&&v(E.map.channel),aoMapUv:ne&&v(E.aoMap.channel),lightMapUv:ie&&v(E.lightMap.channel),bumpMapUv:me&&v(E.bumpMap.channel),normalMapUv:xe&&v(E.normalMap.channel),displacementMapUv:Ae&&v(E.displacementMap.channel),emissiveMapUv:we&&v(E.emissiveMap.channel),metalnessMapUv:Ee&&v(E.metalnessMap.channel),roughnessMapUv:Re&&v(E.roughnessMap.channel),clearcoatMapUv:te&&v(E.clearcoatMap.channel),clearcoatNormalMapUv:_e&&v(E.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Te&&v(E.clearcoatRoughnessMap.channel),iridescenceMapUv:Ie&&v(E.iridescenceMap.channel),iridescenceThicknessMapUv:Qe&&v(E.iridescenceThicknessMap.channel),sheenColorMapUv:Ge&&v(E.sheenColorMap.channel),sheenRoughnessMapUv:ye&&v(E.sheenRoughnessMap.channel),specularMapUv:Ve&&v(E.specularMap.channel),specularColorMapUv:ue&&v(E.specularColorMap.channel),specularIntensityMapUv:Me&&v(E.specularIntensityMap.channel),transmissionMapUv:Be&&v(E.transmissionMap.channel),thicknessMapUv:ze&&v(E.thicknessMap.channel),alphaMapUv:dt&&v(E.alphaMap.channel),vertexTangents:xe&&!!j.attributes.tangent,vertexColors:E.vertexColors,vertexAlphas:E.vertexColors===!0&&!!j.attributes.color&&j.attributes.color.itemSize===4,vertexUv1s:fe,vertexUv2s:be,vertexUv3s:Oe,pointsUvs:B.isPoints===!0&&!!j.attributes.uv&&(ve||dt),fog:!!k,useFog:E.fog===!0,fogExp2:k&&k.isFogExp2,flatShading:E.flatShading===!0,sizeAttenuation:E.sizeAttenuation===!0,logarithmicDepthBuffer:u,skinning:B.isSkinnedMesh===!0,morphTargets:j.morphAttributes.position!==void 0,morphNormals:j.morphAttributes.normal!==void 0,morphColors:j.morphAttributes.color!==void 0,morphTargetsCount:Y,morphTextureStride:z,numDirLights:P.directional.length,numPointLights:P.point.length,numSpotLights:P.spot.length,numSpotLightMaps:P.spotLightMap.length,numRectAreaLights:P.rectArea.length,numHemiLights:P.hemi.length,numDirLightShadows:P.directionalShadowMap.length,numPointLightShadows:P.pointShadowMap.length,numSpotLightShadows:P.spotShadowMap.length,numSpotLightShadowsWithMaps:P.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:E.dithering,shadowMapEnabled:t.shadowMap.enabled&&R.length>0,shadowMapType:t.shadowMap.type,toneMapping:E.toneMapped?t.toneMapping:Va,useLegacyLights:t.useLegacyLights,premultipliedAlpha:E.premultipliedAlpha,doubleSided:E.side===$o,flipSided:E.side===fs,useDepthPacking:E.depthPacking>=0,depthPacking:E.depthPacking||0,index0AttributeName:E.index0AttributeName,extensionDerivatives:J&&E.extensions.derivatives===!0,extensionFragDepth:J&&E.extensions.fragDepth===!0,extensionDrawBuffers:J&&E.extensions.drawBuffers===!0,extensionShaderTextureLOD:J&&E.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:h||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||i.has("EXT_shader_texture_lod"),customProgramCacheKey:E.customProgramCacheKey()}}function m(E){const P=[];if(E.shaderID?P.push(E.shaderID):(P.push(E.customVertexShaderID),P.push(E.customFragmentShaderID)),E.defines!==void 0)for(const R in E.defines)P.push(R),P.push(E.defines[R]);return E.isRawShaderMaterial===!1&&(y(P,E),_(P,E),P.push(t.outputColorSpace)),P.push(E.customProgramCacheKey),P.join()}function y(E,P){E.push(P.precision),E.push(P.outputColorSpace),E.push(P.envMapMode),E.push(P.envMapCubeUVHeight),E.push(P.mapUv),E.push(P.alphaMapUv),E.push(P.lightMapUv),E.push(P.aoMapUv),E.push(P.bumpMapUv),E.push(P.normalMapUv),E.push(P.displacementMapUv),E.push(P.emissiveMapUv),E.push(P.metalnessMapUv),E.push(P.roughnessMapUv),E.push(P.clearcoatMapUv),E.push(P.clearcoatNormalMapUv),E.push(P.clearcoatRoughnessMapUv),E.push(P.iridescenceMapUv),E.push(P.iridescenceThicknessMapUv),E.push(P.sheenColorMapUv),E.push(P.sheenRoughnessMapUv),E.push(P.specularMapUv),E.push(P.specularColorMapUv),E.push(P.specularIntensityMapUv),E.push(P.transmissionMapUv),E.push(P.thicknessMapUv),E.push(P.combine),E.push(P.fogExp2),E.push(P.sizeAttenuation),E.push(P.morphTargetsCount),E.push(P.morphAttributeCount),E.push(P.numDirLights),E.push(P.numPointLights),E.push(P.numSpotLights),E.push(P.numSpotLightMaps),E.push(P.numHemiLights),E.push(P.numRectAreaLights),E.push(P.numDirLightShadows),E.push(P.numPointLightShadows),E.push(P.numSpotLightShadows),E.push(P.numSpotLightShadowsWithMaps),E.push(P.shadowMapType),E.push(P.toneMapping),E.push(P.numClippingPlanes),E.push(P.numClipIntersection),E.push(P.depthPacking)}function _(E,P){a.disableAll(),P.isWebGL2&&a.enable(0),P.supportsVertexTextures&&a.enable(1),P.instancing&&a.enable(2),P.instancingColor&&a.enable(3),P.matcap&&a.enable(4),P.envMap&&a.enable(5),P.normalMapObjectSpace&&a.enable(6),P.normalMapTangentSpace&&a.enable(7),P.clearcoat&&a.enable(8),P.iridescence&&a.enable(9),P.alphaTest&&a.enable(10),P.vertexColors&&a.enable(11),P.vertexAlphas&&a.enable(12),P.vertexUv1s&&a.enable(13),P.vertexUv2s&&a.enable(14),P.vertexUv3s&&a.enable(15),P.vertexTangents&&a.enable(16),E.push(a.mask),a.disableAll(),P.fog&&a.enable(0),P.useFog&&a.enable(1),P.flatShading&&a.enable(2),P.logarithmicDepthBuffer&&a.enable(3),P.skinning&&a.enable(4),P.morphTargets&&a.enable(5),P.morphNormals&&a.enable(6),P.morphColors&&a.enable(7),P.premultipliedAlpha&&a.enable(8),P.shadowMapEnabled&&a.enable(9),P.useLegacyLights&&a.enable(10),P.doubleSided&&a.enable(11),P.flipSided&&a.enable(12),P.useDepthPacking&&a.enable(13),P.dithering&&a.enable(14),P.transmission&&a.enable(15),P.sheen&&a.enable(16),P.opaque&&a.enable(17),P.pointsUvs&&a.enable(18),E.push(a.mask)}function S(E){const P=p[E.type];let R;if(P){const F=Oa[P];R=i7.clone(F.uniforms)}else R=E.uniforms;return R}function A(E,P){let R;for(let F=0,B=c.length;F<B;F++){const k=c[F];if(k.cacheKey===P){R=k,++R.usedTimes;break}}return R===void 0&&(R=new wce(t,P,E,s),c.push(R)),R}function b(E){if(--E.usedTimes===0){const P=c.indexOf(E);c[P]=c[c.length-1],c.pop(),E.destroy()}}function T(E){l.remove(E)}function M(){l.dispose()}return{getParameters:g,getProgramCacheKey:m,getUniforms:S,acquireProgram:A,releaseProgram:b,releaseShaderCache:T,programs:c,dispose:M}}function Ece(){let t=new WeakMap;function e(s){let o=t.get(s);return o===void 0&&(o={},t.set(s,o)),o}function n(s){t.delete(s)}function i(s,o,a){t.get(s)[o]=a}function r(){t=new WeakMap}return{get:e,remove:n,update:i,dispose:r}}function Cce(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function Mz(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Ez(){const t=[];let e=0;const n=[],i=[],r=[];function s(){e=0,n.length=0,i.length=0,r.length=0}function o(u,d,f,p,v,g){let m=t[e];return m===void 0?(m={id:u.id,object:u,geometry:d,material:f,groupOrder:p,renderOrder:u.renderOrder,z:v,group:g},t[e]=m):(m.id=u.id,m.object=u,m.geometry=d,m.material=f,m.groupOrder=p,m.renderOrder=u.renderOrder,m.z=v,m.group=g),e++,m}function a(u,d,f,p,v,g){const m=o(u,d,f,p,v,g);f.transmission>0?i.push(m):f.transparent===!0?r.push(m):n.push(m)}function l(u,d,f,p,v,g){const m=o(u,d,f,p,v,g);f.transmission>0?i.unshift(m):f.transparent===!0?r.unshift(m):n.unshift(m)}function c(u,d){n.length>1&&n.sort(u||Cce),i.length>1&&i.sort(d||Mz),r.length>1&&r.sort(d||Mz)}function h(){for(let u=e,d=t.length;u<d;u++){const f=t[u];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:n,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:h,sort:c}}function Tce(){let t=new WeakMap;function e(i,r){const s=t.get(i);let o;return s===void 0?(o=new Ez,t.set(i,[o])):r>=s.length?(o=new Ez,s.push(o)):o=s[r],o}function n(){t=new WeakMap}return{get:e,dispose:n}}function Pce(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new ae,color:new st};break;case"SpotLight":n={position:new ae,direction:new ae,color:new st,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new ae,color:new st,distance:0,decay:0};break;case"HemisphereLight":n={direction:new ae,skyColor:new st,groundColor:new st};break;case"RectAreaLight":n={color:new st,position:new ae,halfWidth:new ae,halfHeight:new ae};break}return t[e.id]=n,n}}}function Dce(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ye};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ye};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ye,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let Rce=0;function Lce(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function Ice(t,e){const n=new Pce,i=Dce(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let h=0;h<9;h++)r.probe.push(new ae);const s=new ae,o=new kt,a=new kt;function l(h,u){let d=0,f=0,p=0;for(let R=0;R<9;R++)r.probe[R].set(0,0,0);let v=0,g=0,m=0,y=0,_=0,S=0,A=0,b=0,T=0,M=0;h.sort(Lce);const E=u===!0?Math.PI:1;for(let R=0,F=h.length;R<F;R++){const B=h[R],k=B.color,j=B.intensity,Z=B.distance,ee=B.shadow&&B.shadow.map?B.shadow.map.texture:null;if(B.isAmbientLight)d+=k.r*j*E,f+=k.g*j*E,p+=k.b*j*E;else if(B.isLightProbe)for(let O=0;O<9;O++)r.probe[O].addScaledVector(B.sh.coefficients[O],j);else if(B.isDirectionalLight){const O=n.get(B);if(O.color.copy(B.color).multiplyScalar(B.intensity*E),B.castShadow){const W=B.shadow,H=i.get(B);H.shadowBias=W.bias,H.shadowNormalBias=W.normalBias,H.shadowRadius=W.radius,H.shadowMapSize=W.mapSize,r.directionalShadow[v]=H,r.directionalShadowMap[v]=ee,r.directionalShadowMatrix[v]=B.shadow.matrix,S++}r.directional[v]=O,v++}else if(B.isSpotLight){const O=n.get(B);O.position.setFromMatrixPosition(B.matrixWorld),O.color.copy(k).multiplyScalar(j*E),O.distance=Z,O.coneCos=Math.cos(B.angle),O.penumbraCos=Math.cos(B.angle*(1-B.penumbra)),O.decay=B.decay,r.spot[m]=O;const W=B.shadow;if(B.map&&(r.spotLightMap[T]=B.map,T++,W.updateMatrices(B),B.castShadow&&M++),r.spotLightMatrix[m]=W.matrix,B.castShadow){const H=i.get(B);H.shadowBias=W.bias,H.shadowNormalBias=W.normalBias,H.shadowRadius=W.radius,H.shadowMapSize=W.mapSize,r.spotShadow[m]=H,r.spotShadowMap[m]=ee,b++}m++}else if(B.isRectAreaLight){const O=n.get(B);O.color.copy(k).multiplyScalar(j),O.halfWidth.set(B.width*.5,0,0),O.halfHeight.set(0,B.height*.5,0),r.rectArea[y]=O,y++}else if(B.isPointLight){const O=n.get(B);if(O.color.copy(B.color).multiplyScalar(B.intensity*E),O.distance=B.distance,O.decay=B.decay,B.castShadow){const W=B.shadow,H=i.get(B);H.shadowBias=W.bias,H.shadowNormalBias=W.normalBias,H.shadowRadius=W.radius,H.shadowMapSize=W.mapSize,H.shadowCameraNear=W.camera.near,H.shadowCameraFar=W.camera.far,r.pointShadow[g]=H,r.pointShadowMap[g]=ee,r.pointShadowMatrix[g]=B.shadow.matrix,A++}r.point[g]=O,g++}else if(B.isHemisphereLight){const O=n.get(B);O.skyColor.copy(B.color).multiplyScalar(j*E),O.groundColor.copy(B.groundColor).multiplyScalar(j*E),r.hemi[_]=O,_++}}y>0&&(e.isWebGL2||t.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=rt.LTC_FLOAT_1,r.rectAreaLTC2=rt.LTC_FLOAT_2):t.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=rt.LTC_HALF_1,r.rectAreaLTC2=rt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;const P=r.hash;(P.directionalLength!==v||P.pointLength!==g||P.spotLength!==m||P.rectAreaLength!==y||P.hemiLength!==_||P.numDirectionalShadows!==S||P.numPointShadows!==A||P.numSpotShadows!==b||P.numSpotMaps!==T)&&(r.directional.length=v,r.spot.length=m,r.rectArea.length=y,r.point.length=g,r.hemi.length=_,r.directionalShadow.length=S,r.directionalShadowMap.length=S,r.pointShadow.length=A,r.pointShadowMap.length=A,r.spotShadow.length=b,r.spotShadowMap.length=b,r.directionalShadowMatrix.length=S,r.pointShadowMatrix.length=A,r.spotLightMatrix.length=b+T-M,r.spotLightMap.length=T,r.numSpotLightShadowsWithMaps=M,P.directionalLength=v,P.pointLength=g,P.spotLength=m,P.rectAreaLength=y,P.hemiLength=_,P.numDirectionalShadows=S,P.numPointShadows=A,P.numSpotShadows=b,P.numSpotMaps=T,r.version=Rce++)}function c(h,u){let d=0,f=0,p=0,v=0,g=0;const m=u.matrixWorldInverse;for(let y=0,_=h.length;y<_;y++){const S=h[y];if(S.isDirectionalLight){const A=r.directional[d];A.direction.setFromMatrixPosition(S.matrixWorld),s.setFromMatrixPosition(S.target.matrixWorld),A.direction.sub(s),A.direction.transformDirection(m),d++}else if(S.isSpotLight){const A=r.spot[p];A.position.setFromMatrixPosition(S.matrixWorld),A.position.applyMatrix4(m),A.direction.setFromMatrixPosition(S.matrixWorld),s.setFromMatrixPosition(S.target.matrixWorld),A.direction.sub(s),A.direction.transformDirection(m),p++}else if(S.isRectAreaLight){const A=r.rectArea[v];A.position.setFromMatrixPosition(S.matrixWorld),A.position.applyMatrix4(m),a.identity(),o.copy(S.matrixWorld),o.premultiply(m),a.extractRotation(o),A.halfWidth.set(S.width*.5,0,0),A.halfHeight.set(0,S.height*.5,0),A.halfWidth.applyMatrix4(a),A.halfHeight.applyMatrix4(a),v++}else if(S.isPointLight){const A=r.point[f];A.position.setFromMatrixPosition(S.matrixWorld),A.position.applyMatrix4(m),f++}else if(S.isHemisphereLight){const A=r.hemi[g];A.direction.setFromMatrixPosition(S.matrixWorld),A.direction.transformDirection(m),g++}}}return{setup:l,setupView:c,state:r}}function Cz(t,e){const n=new Ice(t,e),i=[],r=[];function s(){i.length=0,r.length=0}function o(u){i.push(u)}function a(u){r.push(u)}function l(u){n.setup(i,u)}function c(u){n.setupView(i,u)}return{init:s,state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function Bce(t,e){let n=new WeakMap;function i(s,o=0){const a=n.get(s);let l;return a===void 0?(l=new Cz(t,e),n.set(s,[l])):o>=a.length?(l=new Cz(t,e),a.push(l)):l=a[o],l}function r(){n=new WeakMap}return{get:i,dispose:r}}class uB extends Hi{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=YX,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class hB extends Hi{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const Oce=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Fce=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Nce(t,e,n){let i=new zM;const r=new Ye,s=new Ye,o=new Dn,a=new uB({depthPacking:qX}),l=new hB,c={},h=n.maxTextureSize,u={[ql]:fs,[fs]:ql,[$o]:$o},d=new Kl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ye},radius:{value:4}},vertexShader:Oce,fragmentShader:Fce}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new Kt;p.setAttribute("position",new bn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const v=new gr(p,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=OM;let m=this.type;this.render=function(A,b,T){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||A.length===0)return;const M=t.getRenderTarget(),E=t.getActiveCubeFace(),P=t.getActiveMipmapLevel(),R=t.state;R.setBlending(Wc),R.buffers.color.setClear(1,1,1,1),R.buffers.depth.setTest(!0),R.setScissorTest(!1);const F=m!==La&&this.type===La,B=m===La&&this.type!==La;for(let k=0,j=A.length;k<j;k++){const Z=A[k],ee=Z.shadow;if(ee===void 0){console.warn("THREE.WebGLShadowMap:",Z,"has no shadow.");continue}if(ee.autoUpdate===!1&&ee.needsUpdate===!1)continue;r.copy(ee.mapSize);const O=ee.getFrameExtents();if(r.multiply(O),s.copy(ee.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(s.x=Math.floor(h/O.x),r.x=s.x*O.x,ee.mapSize.x=s.x),r.y>h&&(s.y=Math.floor(h/O.y),r.y=s.y*O.y,ee.mapSize.y=s.y)),ee.map===null||F===!0||B===!0){const H=this.type!==La?{minFilter:vi,magFilter:vi}:{};ee.map!==null&&ee.map.dispose(),ee.map=new qa(r.x,r.y,H),ee.map.texture.name=Z.name+".shadowMap",ee.camera.updateProjectionMatrix()}t.setRenderTarget(ee.map),t.clear();const W=ee.getViewportCount();for(let H=0;H<W;H++){const Y=ee.getViewport(H);o.set(s.x*Y.x,s.y*Y.y,s.x*Y.z,s.y*Y.w),R.viewport(o),ee.updateMatrices(Z,H),i=ee.getFrustum(),S(b,T,ee.camera,Z,this.type)}ee.isPointLightShadow!==!0&&this.type===La&&y(ee,T),ee.needsUpdate=!1}m=this.type,g.needsUpdate=!1,t.setRenderTarget(M,E,P)};function y(A,b){const T=e.update(v);d.defines.VSM_SAMPLES!==A.blurSamples&&(d.defines.VSM_SAMPLES=A.blurSamples,f.defines.VSM_SAMPLES=A.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),A.mapPass===null&&(A.mapPass=new qa(r.x,r.y)),d.uniforms.shadow_pass.value=A.map.texture,d.uniforms.resolution.value=A.mapSize,d.uniforms.radius.value=A.radius,t.setRenderTarget(A.mapPass),t.clear(),t.renderBufferDirect(b,null,T,d,v,null),f.uniforms.shadow_pass.value=A.mapPass.texture,f.uniforms.resolution.value=A.mapSize,f.uniforms.radius.value=A.radius,t.setRenderTarget(A.map),t.clear(),t.renderBufferDirect(b,null,T,f,v,null)}function _(A,b,T,M){let E=null;const P=T.isPointLight===!0?A.customDistanceMaterial:A.customDepthMaterial;if(P!==void 0)E=P;else if(E=T.isPointLight===!0?l:a,t.localClippingEnabled&&b.clipShadows===!0&&Array.isArray(b.clippingPlanes)&&b.clippingPlanes.length!==0||b.displacementMap&&b.displacementScale!==0||b.alphaMap&&b.alphaTest>0||b.map&&b.alphaTest>0){const R=E.uuid,F=b.uuid;let B=c[R];B===void 0&&(B={},c[R]=B);let k=B[F];k===void 0&&(k=E.clone(),B[F]=k),E=k}if(E.visible=b.visible,E.wireframe=b.wireframe,M===La?E.side=b.shadowSide!==null?b.shadowSide:b.side:E.side=b.shadowSide!==null?b.shadowSide:u[b.side],E.alphaMap=b.alphaMap,E.alphaTest=b.alphaTest,E.map=b.map,E.clipShadows=b.clipShadows,E.clippingPlanes=b.clippingPlanes,E.clipIntersection=b.clipIntersection,E.displacementMap=b.displacementMap,E.displacementScale=b.displacementScale,E.displacementBias=b.displacementBias,E.wireframeLinewidth=b.wireframeLinewidth,E.linewidth=b.linewidth,T.isPointLight===!0&&E.isMeshDistanceMaterial===!0){const R=t.properties.get(E);R.light=T}return E}function S(A,b,T,M,E){if(A.visible===!1)return;if(A.layers.test(b.layers)&&(A.isMesh||A.isLine||A.isPoints)&&(A.castShadow||A.receiveShadow&&E===La)&&(!A.frustumCulled||i.intersectsObject(A))){A.modelViewMatrix.multiplyMatrices(T.matrixWorldInverse,A.matrixWorld);const F=e.update(A),B=A.material;if(Array.isArray(B)){const k=F.groups;for(let j=0,Z=k.length;j<Z;j++){const ee=k[j],O=B[ee.materialIndex];if(O&&O.visible){const W=_(A,O,M,E);t.renderBufferDirect(T,null,F,W,A,ee)}}}else if(B.visible){const k=_(A,B,M,E);t.renderBufferDirect(T,null,F,k,A,null)}}const R=A.children;for(let F=0,B=R.length;F<B;F++)S(R[F],b,T,M,E)}}function Uce(t,e,n){const i=n.isWebGL2;function r(){let J=!1;const fe=new Dn;let be=null;const Oe=new Dn(0,0,0,0);return{setMask:function(qe){be!==qe&&!J&&(t.colorMask(qe,qe,qe,qe),be=qe)},setLocked:function(qe){J=qe},setClear:function(qe,vt,Et,un,ji){ji===!0&&(qe*=un,vt*=un,Et*=un),fe.set(qe,vt,Et,un),Oe.equals(fe)===!1&&(t.clearColor(qe,vt,Et,un),Oe.copy(fe))},reset:function(){J=!1,be=null,Oe.set(-1,0,0,0)}}}function s(){let J=!1,fe=null,be=null,Oe=null;return{setTest:function(qe){qe?K(t.DEPTH_TEST):oe(t.DEPTH_TEST)},setMask:function(qe){fe!==qe&&!J&&(t.depthMask(qe),fe=qe)},setFunc:function(qe){if(be!==qe){switch(qe){case mX:t.depthFunc(t.NEVER);break;case gX:t.depthFunc(t.ALWAYS);break;case vX:t.depthFunc(t.LESS);break;case aA:t.depthFunc(t.LEQUAL);break;case yX:t.depthFunc(t.EQUAL);break;case xX:t.depthFunc(t.GEQUAL);break;case _X:t.depthFunc(t.GREATER);break;case wX:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}be=qe}},setLocked:function(qe){J=qe},setClear:function(qe){Oe!==qe&&(t.clearDepth(qe),Oe=qe)},reset:function(){J=!1,fe=null,be=null,Oe=null}}}function o(){let J=!1,fe=null,be=null,Oe=null,qe=null,vt=null,Et=null,un=null,ji=null;return{setTest:function(Ot){J||(Ot?K(t.STENCIL_TEST):oe(t.STENCIL_TEST))},setMask:function(Ot){fe!==Ot&&!J&&(t.stencilMask(Ot),fe=Ot)},setFunc:function(Ot,jn,Wn){(be!==Ot||Oe!==jn||qe!==Wn)&&(t.stencilFunc(Ot,jn,Wn),be=Ot,Oe=jn,qe=Wn)},setOp:function(Ot,jn,Wn){(vt!==Ot||Et!==jn||un!==Wn)&&(t.stencilOp(Ot,jn,Wn),vt=Ot,Et=jn,un=Wn)},setLocked:function(Ot){J=Ot},setClear:function(Ot){ji!==Ot&&(t.clearStencil(Ot),ji=Ot)},reset:function(){J=!1,fe=null,be=null,Oe=null,qe=null,vt=null,Et=null,un=null,ji=null}}}const a=new r,l=new s,c=new o,h=new WeakMap,u=new WeakMap;let d={},f={},p=new WeakMap,v=[],g=null,m=!1,y=null,_=null,S=null,A=null,b=null,T=null,M=null,E=!1,P=null,R=null,F=null,B=null,k=null;const j=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Z=!1,ee=0;const O=t.getParameter(t.VERSION);O.indexOf("WebGL")!==-1?(ee=parseFloat(/^WebGL (\d)/.exec(O)[1]),Z=ee>=1):O.indexOf("OpenGL ES")!==-1&&(ee=parseFloat(/^OpenGL ES (\d)/.exec(O)[1]),Z=ee>=2);let W=null,H={};const Y=t.getParameter(t.SCISSOR_BOX),z=t.getParameter(t.VIEWPORT),X=new Dn().fromArray(Y),q=new Dn().fromArray(z);function re(J,fe,be,Oe){const qe=new Uint8Array(4),vt=t.createTexture();t.bindTexture(J,vt),t.texParameteri(J,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(J,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let Et=0;Et<be;Et++)i&&(J===t.TEXTURE_3D||J===t.TEXTURE_2D_ARRAY)?t.texImage3D(fe,0,t.RGBA,1,1,Oe,0,t.RGBA,t.UNSIGNED_BYTE,qe):t.texImage2D(fe+Et,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,qe);return vt}const G={};G[t.TEXTURE_2D]=re(t.TEXTURE_2D,t.TEXTURE_2D,1),G[t.TEXTURE_CUBE_MAP]=re(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(G[t.TEXTURE_2D_ARRAY]=re(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),G[t.TEXTURE_3D]=re(t.TEXTURE_3D,t.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),K(t.DEPTH_TEST),l.setFunc(aA),Ae(!1),we(fR),K(t.CULL_FACE),me(Wc);function K(J){d[J]!==!0&&(t.enable(J),d[J]=!0)}function oe(J){d[J]!==!1&&(t.disable(J),d[J]=!1)}function ve(J,fe){return f[J]!==fe?(t.bindFramebuffer(J,fe),f[J]=fe,i&&(J===t.DRAW_FRAMEBUFFER&&(f[t.FRAMEBUFFER]=fe),J===t.FRAMEBUFFER&&(f[t.DRAW_FRAMEBUFFER]=fe)),!0):!1}function $(J,fe){let be=v,Oe=!1;if(J)if(be=p.get(fe),be===void 0&&(be=[],p.set(fe,be)),J.isWebGLMultipleRenderTargets){const qe=J.texture;if(be.length!==qe.length||be[0]!==t.COLOR_ATTACHMENT0){for(let vt=0,Et=qe.length;vt<Et;vt++)be[vt]=t.COLOR_ATTACHMENT0+vt;be.length=qe.length,Oe=!0}}else be[0]!==t.COLOR_ATTACHMENT0&&(be[0]=t.COLOR_ATTACHMENT0,Oe=!0);else be[0]!==t.BACK&&(be[0]=t.BACK,Oe=!0);Oe&&(n.isWebGL2?t.drawBuffers(be):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(be))}function se(J){return g!==J?(t.useProgram(J),g=J,!0):!1}const ne={[zd]:t.FUNC_ADD,[rX]:t.FUNC_SUBTRACT,[sX]:t.FUNC_REVERSE_SUBTRACT};if(i)ne[vR]=t.MIN,ne[yR]=t.MAX;else{const J=e.get("EXT_blend_minmax");J!==null&&(ne[vR]=J.MIN_EXT,ne[yR]=J.MAX_EXT)}const ie={[oX]:t.ZERO,[aX]:t.ONE,[lX]:t.SRC_COLOR,[q3]:t.SRC_ALPHA,[pX]:t.SRC_ALPHA_SATURATE,[dX]:t.DST_COLOR,[uX]:t.DST_ALPHA,[cX]:t.ONE_MINUS_SRC_COLOR,[Q3]:t.ONE_MINUS_SRC_ALPHA,[fX]:t.ONE_MINUS_DST_COLOR,[hX]:t.ONE_MINUS_DST_ALPHA};function me(J,fe,be,Oe,qe,vt,Et,un){if(J===Wc){m===!0&&(oe(t.BLEND),m=!1);return}if(m===!1&&(K(t.BLEND),m=!0),J!==iX){if(J!==y||un!==E){if((_!==zd||b!==zd)&&(t.blendEquation(t.FUNC_ADD),_=zd,b=zd),un)switch(J){case af:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case pR:t.blendFunc(t.ONE,t.ONE);break;case mR:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case gR:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",J);break}else switch(J){case af:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case pR:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case mR:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case gR:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",J);break}S=null,A=null,T=null,M=null,y=J,E=un}return}qe=qe||fe,vt=vt||be,Et=Et||Oe,(fe!==_||qe!==b)&&(t.blendEquationSeparate(ne[fe],ne[qe]),_=fe,b=qe),(be!==S||Oe!==A||vt!==T||Et!==M)&&(t.blendFuncSeparate(ie[be],ie[Oe],ie[vt],ie[Et]),S=be,A=Oe,T=vt,M=Et),y=J,E=!1}function xe(J,fe){J.side===$o?oe(t.CULL_FACE):K(t.CULL_FACE);let be=J.side===fs;fe&&(be=!be),Ae(be),J.blending===af&&J.transparent===!1?me(Wc):me(J.blending,J.blendEquation,J.blendSrc,J.blendDst,J.blendEquationAlpha,J.blendSrcAlpha,J.blendDstAlpha,J.premultipliedAlpha),l.setFunc(J.depthFunc),l.setTest(J.depthTest),l.setMask(J.depthWrite),a.setMask(J.colorWrite);const Oe=J.stencilWrite;c.setTest(Oe),Oe&&(c.setMask(J.stencilWriteMask),c.setFunc(J.stencilFunc,J.stencilRef,J.stencilFuncMask),c.setOp(J.stencilFail,J.stencilZFail,J.stencilZPass)),Re(J.polygonOffset,J.polygonOffsetFactor,J.polygonOffsetUnits),J.alphaToCoverage===!0?K(t.SAMPLE_ALPHA_TO_COVERAGE):oe(t.SAMPLE_ALPHA_TO_COVERAGE)}function Ae(J){P!==J&&(J?t.frontFace(t.CW):t.frontFace(t.CCW),P=J)}function we(J){J!==eX?(K(t.CULL_FACE),J!==R&&(J===fR?t.cullFace(t.BACK):J===tX?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):oe(t.CULL_FACE),R=J}function Ee(J){J!==F&&(Z&&t.lineWidth(J),F=J)}function Re(J,fe,be){J?(K(t.POLYGON_OFFSET_FILL),(B!==fe||k!==be)&&(t.polygonOffset(fe,be),B=fe,k=be)):oe(t.POLYGON_OFFSET_FILL)}function Ue(J){J?K(t.SCISSOR_TEST):oe(t.SCISSOR_TEST)}function Ne(J){J===void 0&&(J=t.TEXTURE0+j-1),W!==J&&(t.activeTexture(J),W=J)}function U(J,fe,be){be===void 0&&(W===null?be=t.TEXTURE0+j-1:be=W);let Oe=H[be];Oe===void 0&&(Oe={type:void 0,texture:void 0},H[be]=Oe),(Oe.type!==J||Oe.texture!==fe)&&(W!==be&&(t.activeTexture(be),W=be),t.bindTexture(J,fe||G[J]),Oe.type=J,Oe.texture=fe)}function L(){const J=H[W];J!==void 0&&J.type!==void 0&&(t.bindTexture(J.type,null),J.type=void 0,J.texture=void 0)}function te(){try{t.compressedTexImage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function _e(){try{t.compressedTexImage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Te(){try{t.texSubImage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Ie(){try{t.texSubImage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Qe(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Ge(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function ye(){try{t.texStorage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Ve(){try{t.texStorage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function ue(){try{t.texImage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Me(){try{t.texImage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Be(J){X.equals(J)===!1&&(t.scissor(J.x,J.y,J.z,J.w),X.copy(J))}function ze(J){q.equals(J)===!1&&(t.viewport(J.x,J.y,J.z,J.w),q.copy(J))}function $e(J,fe){let be=u.get(fe);be===void 0&&(be=new WeakMap,u.set(fe,be));let Oe=be.get(J);Oe===void 0&&(Oe=t.getUniformBlockIndex(fe,J.name),be.set(J,Oe))}function dt(J,fe){const Oe=u.get(fe).get(J);h.get(fe)!==Oe&&(t.uniformBlockBinding(fe,Oe,J.__bindingPointIndex),h.set(fe,Oe))}function Bt(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),i===!0&&(t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),d={},W=null,H={},f={},p=new WeakMap,v=[],g=null,m=!1,y=null,_=null,S=null,A=null,b=null,T=null,M=null,E=!1,P=null,R=null,F=null,B=null,k=null,X.set(0,0,t.canvas.width,t.canvas.height),q.set(0,0,t.canvas.width,t.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:K,disable:oe,bindFramebuffer:ve,drawBuffers:$,useProgram:se,setBlending:me,setMaterial:xe,setFlipSided:Ae,setCullFace:we,setLineWidth:Ee,setPolygonOffset:Re,setScissorTest:Ue,activeTexture:Ne,bindTexture:U,unbindTexture:L,compressedTexImage2D:te,compressedTexImage3D:_e,texImage2D:ue,texImage3D:Me,updateUBOMapping:$e,uniformBlockBinding:dt,texStorage2D:ye,texStorage3D:Ve,texSubImage2D:Te,texSubImage3D:Ie,compressedTexSubImage2D:Qe,compressedTexSubImage3D:Ge,scissor:Be,viewport:ze,reset:Bt}}function kce(t,e,n,i,r,s,o){const a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,h=r.maxTextureSize,u=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap;let v;const g=new WeakMap;let m=!1;try{m=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(U,L){return m?new OffscreenCanvas(U,L):ux("canvas")}function _(U,L,te,_e){let Te=1;if((U.width>_e||U.height>_e)&&(Te=_e/Math.max(U.width,U.height)),Te<1||L===!0)if(typeof HTMLImageElement<"u"&&U instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&U instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&U instanceof ImageBitmap){const Ie=L?ZX:Math.floor,Qe=Ie(Te*U.width),Ge=Ie(Te*U.height);v===void 0&&(v=y(Qe,Ge));const ye=te?y(Qe,Ge):v;return ye.width=Qe,ye.height=Ge,ye.getContext("2d").drawImage(U,0,0,Qe,Ge),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+U.width+"x"+U.height+") to ("+Qe+"x"+Ge+")."),ye}else return"data"in U&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+U.width+"x"+U.height+")."),U;return U}function S(U){return VR(U.width)&&VR(U.height)}function A(U){return a?!1:U.wrapS!==Cr||U.wrapT!==Cr||U.minFilter!==vi&&U.minFilter!==oi}function b(U,L){return U.generateMipmaps&&L&&U.minFilter!==vi&&U.minFilter!==oi}function T(U){t.generateMipmap(U)}function M(U,L,te,_e,Te=!1){if(a===!1)return L;if(U!==null){if(t[U]!==void 0)return t[U];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+U+"'")}let Ie=L;return L===t.RED&&(te===t.FLOAT&&(Ie=t.R32F),te===t.HALF_FLOAT&&(Ie=t.R16F),te===t.UNSIGNED_BYTE&&(Ie=t.R8)),L===t.RG&&(te===t.FLOAT&&(Ie=t.RG32F),te===t.HALF_FLOAT&&(Ie=t.RG16F),te===t.UNSIGNED_BYTE&&(Ie=t.RG8)),L===t.RGBA&&(te===t.FLOAT&&(Ie=t.RGBA32F),te===t.HALF_FLOAT&&(Ie=t.RGBA16F),te===t.UNSIGNED_BYTE&&(Ie=_e===Jt&&Te===!1?t.SRGB8_ALPHA8:t.RGBA8),te===t.UNSIGNED_SHORT_4_4_4_4&&(Ie=t.RGBA4),te===t.UNSIGNED_SHORT_5_5_5_1&&(Ie=t.RGB5_A1)),(Ie===t.R16F||Ie===t.R32F||Ie===t.RG16F||Ie===t.RG32F||Ie===t.RGBA16F||Ie===t.RGBA32F)&&e.get("EXT_color_buffer_float"),Ie}function E(U,L,te){return b(U,te)===!0||U.isFramebufferTexture&&U.minFilter!==vi&&U.minFilter!==oi?Math.log2(Math.max(L.width,L.height))+1:U.mipmaps!==void 0&&U.mipmaps.length>0?U.mipmaps.length:U.isCompressedTexture&&Array.isArray(U.image)?L.mipmaps.length:1}function P(U){return U===vi||U===ax||U===eg?t.NEAREST:t.LINEAR}function R(U){const L=U.target;L.removeEventListener("dispose",R),B(L),L.isVideoTexture&&p.delete(L)}function F(U){const L=U.target;L.removeEventListener("dispose",F),j(L)}function B(U){const L=i.get(U);if(L.__webglInit===void 0)return;const te=U.source,_e=g.get(te);if(_e){const Te=_e[L.__cacheKey];Te.usedTimes--,Te.usedTimes===0&&k(U),Object.keys(_e).length===0&&g.delete(te)}i.remove(U)}function k(U){const L=i.get(U);t.deleteTexture(L.__webglTexture);const te=U.source,_e=g.get(te);delete _e[L.__cacheKey],o.memory.textures--}function j(U){const L=U.texture,te=i.get(U),_e=i.get(L);if(_e.__webglTexture!==void 0&&(t.deleteTexture(_e.__webglTexture),o.memory.textures--),U.depthTexture&&U.depthTexture.dispose(),U.isWebGLCubeRenderTarget)for(let Te=0;Te<6;Te++)t.deleteFramebuffer(te.__webglFramebuffer[Te]),te.__webglDepthbuffer&&t.deleteRenderbuffer(te.__webglDepthbuffer[Te]);else{if(t.deleteFramebuffer(te.__webglFramebuffer),te.__webglDepthbuffer&&t.deleteRenderbuffer(te.__webglDepthbuffer),te.__webglMultisampledFramebuffer&&t.deleteFramebuffer(te.__webglMultisampledFramebuffer),te.__webglColorRenderbuffer)for(let Te=0;Te<te.__webglColorRenderbuffer.length;Te++)te.__webglColorRenderbuffer[Te]&&t.deleteRenderbuffer(te.__webglColorRenderbuffer[Te]);te.__webglDepthRenderbuffer&&t.deleteRenderbuffer(te.__webglDepthRenderbuffer)}if(U.isWebGLMultipleRenderTargets)for(let Te=0,Ie=L.length;Te<Ie;Te++){const Qe=i.get(L[Te]);Qe.__webglTexture&&(t.deleteTexture(Qe.__webglTexture),o.memory.textures--),i.remove(L[Te])}i.remove(L),i.remove(U)}let Z=0;function ee(){Z=0}function O(){const U=Z;return U>=l&&console.warn("THREE.WebGLTextures: Trying to use "+U+" texture units while this GPU supports only "+l),Z+=1,U}function W(U){const L=[];return L.push(U.wrapS),L.push(U.wrapT),L.push(U.wrapR||0),L.push(U.magFilter),L.push(U.minFilter),L.push(U.anisotropy),L.push(U.internalFormat),L.push(U.format),L.push(U.type),L.push(U.generateMipmaps),L.push(U.premultiplyAlpha),L.push(U.flipY),L.push(U.unpackAlignment),L.push(U.colorSpace),L.join()}function H(U,L){const te=i.get(U);if(U.isVideoTexture&&Ue(U),U.isRenderTargetTexture===!1&&U.version>0&&te.__version!==U.version){const _e=U.image;if(_e===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(_e.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{oe(te,U,L);return}}n.bindTexture(t.TEXTURE_2D,te.__webglTexture,t.TEXTURE0+L)}function Y(U,L){const te=i.get(U);if(U.version>0&&te.__version!==U.version){oe(te,U,L);return}n.bindTexture(t.TEXTURE_2D_ARRAY,te.__webglTexture,t.TEXTURE0+L)}function z(U,L){const te=i.get(U);if(U.version>0&&te.__version!==U.version){oe(te,U,L);return}n.bindTexture(t.TEXTURE_3D,te.__webglTexture,t.TEXTURE0+L)}function X(U,L){const te=i.get(U);if(U.version>0&&te.__version!==U.version){ve(te,U,L);return}n.bindTexture(t.TEXTURE_CUBE_MAP,te.__webglTexture,t.TEXTURE0+L)}const q={[Uh]:t.REPEAT,[Cr]:t.CLAMP_TO_EDGE,[Mg]:t.MIRRORED_REPEAT},re={[vi]:t.NEAREST,[ax]:t.NEAREST_MIPMAP_NEAREST,[eg]:t.NEAREST_MIPMAP_LINEAR,[oi]:t.LINEAR,[NM]:t.LINEAR_MIPMAP_NEAREST,[Ql]:t.LINEAR_MIPMAP_LINEAR};function G(U,L,te){if(te?(t.texParameteri(U,t.TEXTURE_WRAP_S,q[L.wrapS]),t.texParameteri(U,t.TEXTURE_WRAP_T,q[L.wrapT]),(U===t.TEXTURE_3D||U===t.TEXTURE_2D_ARRAY)&&t.texParameteri(U,t.TEXTURE_WRAP_R,q[L.wrapR]),t.texParameteri(U,t.TEXTURE_MAG_FILTER,re[L.magFilter]),t.texParameteri(U,t.TEXTURE_MIN_FILTER,re[L.minFilter])):(t.texParameteri(U,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(U,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),(U===t.TEXTURE_3D||U===t.TEXTURE_2D_ARRAY)&&t.texParameteri(U,t.TEXTURE_WRAP_R,t.CLAMP_TO_EDGE),(L.wrapS!==Cr||L.wrapT!==Cr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(U,t.TEXTURE_MAG_FILTER,P(L.magFilter)),t.texParameteri(U,t.TEXTURE_MIN_FILTER,P(L.minFilter)),L.minFilter!==vi&&L.minFilter!==oi&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const _e=e.get("EXT_texture_filter_anisotropic");if(L.magFilter===vi||L.minFilter!==eg&&L.minFilter!==Ql||L.type===Uc&&e.has("OES_texture_float_linear")===!1||a===!1&&L.type===Eg&&e.has("OES_texture_half_float_linear")===!1)return;(L.anisotropy>1||i.get(L).__currentAnisotropy)&&(t.texParameterf(U,_e.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(L.anisotropy,r.getMaxAnisotropy())),i.get(L).__currentAnisotropy=L.anisotropy)}}function K(U,L){let te=!1;U.__webglInit===void 0&&(U.__webglInit=!0,L.addEventListener("dispose",R));const _e=L.source;let Te=g.get(_e);Te===void 0&&(Te={},g.set(_e,Te));const Ie=W(L);if(Ie!==U.__cacheKey){Te[Ie]===void 0&&(Te[Ie]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,te=!0),Te[Ie].usedTimes++;const Qe=Te[U.__cacheKey];Qe!==void 0&&(Te[U.__cacheKey].usedTimes--,Qe.usedTimes===0&&k(L)),U.__cacheKey=Ie,U.__webglTexture=Te[Ie].texture}return te}function oe(U,L,te){let _e=t.TEXTURE_2D;(L.isDataArrayTexture||L.isCompressedArrayTexture)&&(_e=t.TEXTURE_2D_ARRAY),L.isData3DTexture&&(_e=t.TEXTURE_3D);const Te=K(U,L),Ie=L.source;n.bindTexture(_e,U.__webglTexture,t.TEXTURE0+te);const Qe=i.get(Ie);if(Ie.version!==Qe.__version||Te===!0){n.activeTexture(t.TEXTURE0+te),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,L.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,L.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,L.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE);const Ge=A(L)&&S(L.image)===!1;let ye=_(L.image,Ge,!1,h);ye=Ne(L,ye);const Ve=S(ye)||a,ue=s.convert(L.format,L.colorSpace);let Me=s.convert(L.type),Be=M(L.internalFormat,ue,Me,L.colorSpace);G(_e,L,Ve);let ze;const $e=L.mipmaps,dt=a&&L.isVideoTexture!==!0,Bt=Qe.__version===void 0||Te===!0,J=E(L,ye,Ve);if(L.isDepthTexture)Be=t.DEPTH_COMPONENT,a?L.type===Uc?Be=t.DEPTH_COMPONENT32F:L.type===ah?Be=t.DEPTH_COMPONENT24:L.type===lf?Be=t.DEPTH24_STENCIL8:Be=t.DEPTH_COMPONENT16:L.type===Uc&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),L.format===Eh&&Be===t.DEPTH_COMPONENT&&L.type!==J3&&L.type!==ah&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),L.type=ah,Me=s.convert(L.type)),L.format===Ef&&Be===t.DEPTH_COMPONENT&&(Be=t.DEPTH_STENCIL,L.type!==lf&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),L.type=lf,Me=s.convert(L.type))),Bt&&(dt?n.texStorage2D(t.TEXTURE_2D,1,Be,ye.width,ye.height):n.texImage2D(t.TEXTURE_2D,0,Be,ye.width,ye.height,0,ue,Me,null));else if(L.isDataTexture)if($e.length>0&&Ve){dt&&Bt&&n.texStorage2D(t.TEXTURE_2D,J,Be,$e[0].width,$e[0].height);for(let fe=0,be=$e.length;fe<be;fe++)ze=$e[fe],dt?n.texSubImage2D(t.TEXTURE_2D,fe,0,0,ze.width,ze.height,ue,Me,ze.data):n.texImage2D(t.TEXTURE_2D,fe,Be,ze.width,ze.height,0,ue,Me,ze.data);L.generateMipmaps=!1}else dt?(Bt&&n.texStorage2D(t.TEXTURE_2D,J,Be,ye.width,ye.height),n.texSubImage2D(t.TEXTURE_2D,0,0,0,ye.width,ye.height,ue,Me,ye.data)):n.texImage2D(t.TEXTURE_2D,0,Be,ye.width,ye.height,0,ue,Me,ye.data);else if(L.isCompressedTexture)if(L.isCompressedArrayTexture){dt&&Bt&&n.texStorage3D(t.TEXTURE_2D_ARRAY,J,Be,$e[0].width,$e[0].height,ye.depth);for(let fe=0,be=$e.length;fe<be;fe++)ze=$e[fe],L.format!==Es?ue!==null?dt?n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,fe,0,0,0,ze.width,ze.height,ye.depth,ue,ze.data,0,0):n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,fe,Be,ze.width,ze.height,ye.depth,0,ze.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):dt?n.texSubImage3D(t.TEXTURE_2D_ARRAY,fe,0,0,0,ze.width,ze.height,ye.depth,ue,Me,ze.data):n.texImage3D(t.TEXTURE_2D_ARRAY,fe,Be,ze.width,ze.height,ye.depth,0,ue,Me,ze.data)}else{dt&&Bt&&n.texStorage2D(t.TEXTURE_2D,J,Be,$e[0].width,$e[0].height);for(let fe=0,be=$e.length;fe<be;fe++)ze=$e[fe],L.format!==Es?ue!==null?dt?n.compressedTexSubImage2D(t.TEXTURE_2D,fe,0,0,ze.width,ze.height,ue,ze.data):n.compressedTexImage2D(t.TEXTURE_2D,fe,Be,ze.width,ze.height,0,ze.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):dt?n.texSubImage2D(t.TEXTURE_2D,fe,0,0,ze.width,ze.height,ue,Me,ze.data):n.texImage2D(t.TEXTURE_2D,fe,Be,ze.width,ze.height,0,ue,Me,ze.data)}else if(L.isDataArrayTexture)dt?(Bt&&n.texStorage3D(t.TEXTURE_2D_ARRAY,J,Be,ye.width,ye.height,ye.depth),n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,ye.width,ye.height,ye.depth,ue,Me,ye.data)):n.texImage3D(t.TEXTURE_2D_ARRAY,0,Be,ye.width,ye.height,ye.depth,0,ue,Me,ye.data);else if(L.isData3DTexture)dt?(Bt&&n.texStorage3D(t.TEXTURE_3D,J,Be,ye.width,ye.height,ye.depth),n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,ye.width,ye.height,ye.depth,ue,Me,ye.data)):n.texImage3D(t.TEXTURE_3D,0,Be,ye.width,ye.height,ye.depth,0,ue,Me,ye.data);else if(L.isFramebufferTexture){if(Bt)if(dt)n.texStorage2D(t.TEXTURE_2D,J,Be,ye.width,ye.height);else{let fe=ye.width,be=ye.height;for(let Oe=0;Oe<J;Oe++)n.texImage2D(t.TEXTURE_2D,Oe,Be,fe,be,0,ue,Me,null),fe>>=1,be>>=1}}else if($e.length>0&&Ve){dt&&Bt&&n.texStorage2D(t.TEXTURE_2D,J,Be,$e[0].width,$e[0].height);for(let fe=0,be=$e.length;fe<be;fe++)ze=$e[fe],dt?n.texSubImage2D(t.TEXTURE_2D,fe,0,0,ue,Me,ze):n.texImage2D(t.TEXTURE_2D,fe,Be,ue,Me,ze);L.generateMipmaps=!1}else dt?(Bt&&n.texStorage2D(t.TEXTURE_2D,J,Be,ye.width,ye.height),n.texSubImage2D(t.TEXTURE_2D,0,0,0,ue,Me,ye)):n.texImage2D(t.TEXTURE_2D,0,Be,ue,Me,ye);b(L,Ve)&&T(_e),Qe.__version=Ie.version,L.onUpdate&&L.onUpdate(L)}U.__version=L.version}function ve(U,L,te){if(L.image.length!==6)return;const _e=K(U,L),Te=L.source;n.bindTexture(t.TEXTURE_CUBE_MAP,U.__webglTexture,t.TEXTURE0+te);const Ie=i.get(Te);if(Te.version!==Ie.__version||_e===!0){n.activeTexture(t.TEXTURE0+te),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,L.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,L.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,L.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE);const Qe=L.isCompressedTexture||L.image[0].isCompressedTexture,Ge=L.image[0]&&L.image[0].isDataTexture,ye=[];for(let fe=0;fe<6;fe++)!Qe&&!Ge?ye[fe]=_(L.image[fe],!1,!0,c):ye[fe]=Ge?L.image[fe].image:L.image[fe],ye[fe]=Ne(L,ye[fe]);const Ve=ye[0],ue=S(Ve)||a,Me=s.convert(L.format,L.colorSpace),Be=s.convert(L.type),ze=M(L.internalFormat,Me,Be,L.colorSpace),$e=a&&L.isVideoTexture!==!0,dt=Ie.__version===void 0||_e===!0;let Bt=E(L,Ve,ue);G(t.TEXTURE_CUBE_MAP,L,ue);let J;if(Qe){$e&&dt&&n.texStorage2D(t.TEXTURE_CUBE_MAP,Bt,ze,Ve.width,Ve.height);for(let fe=0;fe<6;fe++){J=ye[fe].mipmaps;for(let be=0;be<J.length;be++){const Oe=J[be];L.format!==Es?Me!==null?$e?n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,be,0,0,Oe.width,Oe.height,Me,Oe.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,be,ze,Oe.width,Oe.height,0,Oe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):$e?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,be,0,0,Oe.width,Oe.height,Me,Be,Oe.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,be,ze,Oe.width,Oe.height,0,Me,Be,Oe.data)}}}else{J=L.mipmaps,$e&&dt&&(J.length>0&&Bt++,n.texStorage2D(t.TEXTURE_CUBE_MAP,Bt,ze,ye[0].width,ye[0].height));for(let fe=0;fe<6;fe++)if(Ge){$e?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,0,0,0,ye[fe].width,ye[fe].height,Me,Be,ye[fe].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,0,ze,ye[fe].width,ye[fe].height,0,Me,Be,ye[fe].data);for(let be=0;be<J.length;be++){const qe=J[be].image[fe].image;$e?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,be+1,0,0,qe.width,qe.height,Me,Be,qe.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,be+1,ze,qe.width,qe.height,0,Me,Be,qe.data)}}else{$e?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,0,0,0,Me,Be,ye[fe]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,0,ze,Me,Be,ye[fe]);for(let be=0;be<J.length;be++){const Oe=J[be];$e?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,be+1,0,0,Me,Be,Oe.image[fe]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+fe,be+1,ze,Me,Be,Oe.image[fe])}}}b(L,ue)&&T(t.TEXTURE_CUBE_MAP),Ie.__version=Te.version,L.onUpdate&&L.onUpdate(L)}U.__version=L.version}function $(U,L,te,_e,Te){const Ie=s.convert(te.format,te.colorSpace),Qe=s.convert(te.type),Ge=M(te.internalFormat,Ie,Qe,te.colorSpace);i.get(L).__hasExternalTextures||(Te===t.TEXTURE_3D||Te===t.TEXTURE_2D_ARRAY?n.texImage3D(Te,0,Ge,L.width,L.height,L.depth,0,Ie,Qe,null):n.texImage2D(Te,0,Ge,L.width,L.height,0,Ie,Qe,null)),n.bindFramebuffer(t.FRAMEBUFFER,U),Re(L)?d.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,_e,Te,i.get(te).__webglTexture,0,Ee(L)):(Te===t.TEXTURE_2D||Te>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&Te<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,_e,Te,i.get(te).__webglTexture,0),n.bindFramebuffer(t.FRAMEBUFFER,null)}function se(U,L,te){if(t.bindRenderbuffer(t.RENDERBUFFER,U),L.depthBuffer&&!L.stencilBuffer){let _e=t.DEPTH_COMPONENT16;if(te||Re(L)){const Te=L.depthTexture;Te&&Te.isDepthTexture&&(Te.type===Uc?_e=t.DEPTH_COMPONENT32F:Te.type===ah&&(_e=t.DEPTH_COMPONENT24));const Ie=Ee(L);Re(L)?d.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Ie,_e,L.width,L.height):t.renderbufferStorageMultisample(t.RENDERBUFFER,Ie,_e,L.width,L.height)}else t.renderbufferStorage(t.RENDERBUFFER,_e,L.width,L.height);t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,U)}else if(L.depthBuffer&&L.stencilBuffer){const _e=Ee(L);te&&Re(L)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,_e,t.DEPTH24_STENCIL8,L.width,L.height):Re(L)?d.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,_e,t.DEPTH24_STENCIL8,L.width,L.height):t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,L.width,L.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,U)}else{const _e=L.isWebGLMultipleRenderTargets===!0?L.texture:[L.texture];for(let Te=0;Te<_e.length;Te++){const Ie=_e[Te],Qe=s.convert(Ie.format,Ie.colorSpace),Ge=s.convert(Ie.type),ye=M(Ie.internalFormat,Qe,Ge,Ie.colorSpace),Ve=Ee(L);te&&Re(L)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,Ve,ye,L.width,L.height):Re(L)?d.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Ve,ye,L.width,L.height):t.renderbufferStorage(t.RENDERBUFFER,ye,L.width,L.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function ne(U,L){if(L&&L.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,U),!(L.depthTexture&&L.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(L.depthTexture).__webglTexture||L.depthTexture.image.width!==L.width||L.depthTexture.image.height!==L.height)&&(L.depthTexture.image.width=L.width,L.depthTexture.image.height=L.height,L.depthTexture.needsUpdate=!0),H(L.depthTexture,0);const _e=i.get(L.depthTexture).__webglTexture,Te=Ee(L);if(L.depthTexture.format===Eh)Re(L)?d.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,_e,0,Te):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,_e,0);else if(L.depthTexture.format===Ef)Re(L)?d.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,_e,0,Te):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,_e,0);else throw new Error("Unknown depthTexture format")}function ie(U){const L=i.get(U),te=U.isWebGLCubeRenderTarget===!0;if(U.depthTexture&&!L.__autoAllocateDepthBuffer){if(te)throw new Error("target.depthTexture not supported in Cube render targets");ne(L.__webglFramebuffer,U)}else if(te){L.__webglDepthbuffer=[];for(let _e=0;_e<6;_e++)n.bindFramebuffer(t.FRAMEBUFFER,L.__webglFramebuffer[_e]),L.__webglDepthbuffer[_e]=t.createRenderbuffer(),se(L.__webglDepthbuffer[_e],U,!1)}else n.bindFramebuffer(t.FRAMEBUFFER,L.__webglFramebuffer),L.__webglDepthbuffer=t.createRenderbuffer(),se(L.__webglDepthbuffer,U,!1);n.bindFramebuffer(t.FRAMEBUFFER,null)}function me(U,L,te){const _e=i.get(U);L!==void 0&&$(_e.__webglFramebuffer,U,U.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),te!==void 0&&ie(U)}function xe(U){const L=U.texture,te=i.get(U),_e=i.get(L);U.addEventListener("dispose",F),U.isWebGLMultipleRenderTargets!==!0&&(_e.__webglTexture===void 0&&(_e.__webglTexture=t.createTexture()),_e.__version=L.version,o.memory.textures++);const Te=U.isWebGLCubeRenderTarget===!0,Ie=U.isWebGLMultipleRenderTargets===!0,Qe=S(U)||a;if(Te){te.__webglFramebuffer=[];for(let Ge=0;Ge<6;Ge++)te.__webglFramebuffer[Ge]=t.createFramebuffer()}else{if(te.__webglFramebuffer=t.createFramebuffer(),Ie)if(r.drawBuffers){const Ge=U.texture;for(let ye=0,Ve=Ge.length;ye<Ve;ye++){const ue=i.get(Ge[ye]);ue.__webglTexture===void 0&&(ue.__webglTexture=t.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&U.samples>0&&Re(U)===!1){const Ge=Ie?L:[L];te.__webglMultisampledFramebuffer=t.createFramebuffer(),te.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,te.__webglMultisampledFramebuffer);for(let ye=0;ye<Ge.length;ye++){const Ve=Ge[ye];te.__webglColorRenderbuffer[ye]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,te.__webglColorRenderbuffer[ye]);const ue=s.convert(Ve.format,Ve.colorSpace),Me=s.convert(Ve.type),Be=M(Ve.internalFormat,ue,Me,Ve.colorSpace,U.isXRRenderTarget===!0),ze=Ee(U);t.renderbufferStorageMultisample(t.RENDERBUFFER,ze,Be,U.width,U.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+ye,t.RENDERBUFFER,te.__webglColorRenderbuffer[ye])}t.bindRenderbuffer(t.RENDERBUFFER,null),U.depthBuffer&&(te.__webglDepthRenderbuffer=t.createRenderbuffer(),se(te.__webglDepthRenderbuffer,U,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(Te){n.bindTexture(t.TEXTURE_CUBE_MAP,_e.__webglTexture),G(t.TEXTURE_CUBE_MAP,L,Qe);for(let Ge=0;Ge<6;Ge++)$(te.__webglFramebuffer[Ge],U,L,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Ge);b(L,Qe)&&T(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(Ie){const Ge=U.texture;for(let ye=0,Ve=Ge.length;ye<Ve;ye++){const ue=Ge[ye],Me=i.get(ue);n.bindTexture(t.TEXTURE_2D,Me.__webglTexture),G(t.TEXTURE_2D,ue,Qe),$(te.__webglFramebuffer,U,ue,t.COLOR_ATTACHMENT0+ye,t.TEXTURE_2D),b(ue,Qe)&&T(t.TEXTURE_2D)}n.unbindTexture()}else{let Ge=t.TEXTURE_2D;(U.isWebGL3DRenderTarget||U.isWebGLArrayRenderTarget)&&(a?Ge=U.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(Ge,_e.__webglTexture),G(Ge,L,Qe),$(te.__webglFramebuffer,U,L,t.COLOR_ATTACHMENT0,Ge),b(L,Qe)&&T(Ge),n.unbindTexture()}U.depthBuffer&&ie(U)}function Ae(U){const L=S(U)||a,te=U.isWebGLMultipleRenderTargets===!0?U.texture:[U.texture];for(let _e=0,Te=te.length;_e<Te;_e++){const Ie=te[_e];if(b(Ie,L)){const Qe=U.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,Ge=i.get(Ie).__webglTexture;n.bindTexture(Qe,Ge),T(Qe),n.unbindTexture()}}}function we(U){if(a&&U.samples>0&&Re(U)===!1){const L=U.isWebGLMultipleRenderTargets?U.texture:[U.texture],te=U.width,_e=U.height;let Te=t.COLOR_BUFFER_BIT;const Ie=[],Qe=U.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ge=i.get(U),ye=U.isWebGLMultipleRenderTargets===!0;if(ye)for(let Ve=0;Ve<L.length;Ve++)n.bindFramebuffer(t.FRAMEBUFFER,Ge.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ve,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,Ge.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ve,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,Ge.__webglMultisampledFramebuffer),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,Ge.__webglFramebuffer);for(let Ve=0;Ve<L.length;Ve++){Ie.push(t.COLOR_ATTACHMENT0+Ve),U.depthBuffer&&Ie.push(Qe);const ue=Ge.__ignoreDepthValues!==void 0?Ge.__ignoreDepthValues:!1;if(ue===!1&&(U.depthBuffer&&(Te|=t.DEPTH_BUFFER_BIT),U.stencilBuffer&&(Te|=t.STENCIL_BUFFER_BIT)),ye&&t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,Ge.__webglColorRenderbuffer[Ve]),ue===!0&&(t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[Qe]),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[Qe])),ye){const Me=i.get(L[Ve]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,Me,0)}t.blitFramebuffer(0,0,te,_e,0,0,te,_e,Te,t.NEAREST),f&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,Ie)}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),ye)for(let Ve=0;Ve<L.length;Ve++){n.bindFramebuffer(t.FRAMEBUFFER,Ge.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ve,t.RENDERBUFFER,Ge.__webglColorRenderbuffer[Ve]);const ue=i.get(L[Ve]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,Ge.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ve,t.TEXTURE_2D,ue,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,Ge.__webglMultisampledFramebuffer)}}function Ee(U){return Math.min(u,U.samples)}function Re(U){const L=i.get(U);return a&&U.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&L.__useRenderToTexture!==!1}function Ue(U){const L=o.render.frame;p.get(U)!==L&&(p.set(U,L),U.update())}function Ne(U,L){const te=U.colorSpace,_e=U.format,Te=U.type;return U.isCompressedTexture===!0||U.format===cA||te!==Ya&&te!==Ch&&(te===Jt?a===!1?e.has("EXT_sRGB")===!0&&_e===Es?(U.format=cA,U.minFilter=oi,U.generateMipmaps=!1):L=iB.sRGBToLinear(L):(_e!==Es||Te!==tu)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",te)),L}this.allocateTextureUnit=O,this.resetTextureUnits=ee,this.setTexture2D=H,this.setTexture2DArray=Y,this.setTexture3D=z,this.setTextureCube=X,this.rebindTextures=me,this.setupRenderTarget=xe,this.updateRenderTargetMipmap=Ae,this.updateMultisampleRenderTarget=we,this.setupDepthRenderbuffer=ie,this.setupFrameBufferTexture=$,this.useMultisampledRTT=Re}function c7(t,e,n){const i=n.isWebGL2;function r(s,o=Ch){let a;if(s===tu)return t.UNSIGNED_BYTE;if(s===RX)return t.UNSIGNED_SHORT_4_4_4_4;if(s===LX)return t.UNSIGNED_SHORT_5_5_5_1;if(s===TX)return t.BYTE;if(s===PX)return t.SHORT;if(s===J3)return t.UNSIGNED_SHORT;if(s===DX)return t.INT;if(s===ah)return t.UNSIGNED_INT;if(s===Uc)return t.FLOAT;if(s===Eg)return i?t.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===IX)return t.ALPHA;if(s===Es)return t.RGBA;if(s===BX)return t.LUMINANCE;if(s===OX)return t.LUMINANCE_ALPHA;if(s===Eh)return t.DEPTH_COMPONENT;if(s===Ef)return t.DEPTH_STENCIL;if(s===cA)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===FX)return t.RED;if(s===NX)return t.RED_INTEGER;if(s===UX)return t.RG;if(s===kX)return t.RG_INTEGER;if(s===zX)return t.RGBA_INTEGER;if(s===ub||s===hb||s===db||s===fb)if(o===Jt)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===ub)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===hb)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===db)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===fb)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===ub)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===hb)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===db)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===fb)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===xR||s===_R||s===wR||s===SR)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===xR)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===_R)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===wR)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===SR)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===GX)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===bR||s===AR)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===bR)return o===Jt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===AR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===MR||s===ER||s===CR||s===TR||s===PR||s===DR||s===RR||s===LR||s===IR||s===BR||s===OR||s===FR||s===NR||s===UR)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===MR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===ER)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===CR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===TR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===PR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===DR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===RR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===LR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===IR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===BR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===OR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===FR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===NR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===UR)return o===Jt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===pb)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===pb)return o===Jt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===HX||s===kR||s===zR||s===GR)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===pb)return a.COMPRESSED_RED_RGTC1_EXT;if(s===kR)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===zR)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===GR)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===lf?i?t.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):t[s]!==void 0?t[s]:null}return{convert:r}}class u7 extends zn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class kc extends mn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const zce={type:"move"};class zT{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new kc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new kc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ae,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ae),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new kc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ae,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ae),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const i of e.hand.values())this._getHandJoint(n,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,i){let r=null,s=null,o=null;const a=this._targetRay,l=this._grip,c=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(c&&e.hand){o=!0;for(const v of e.hand.values()){const g=n.getJointPose(v,i),m=this._getHandJoint(c,v);g!==null&&(m.matrix.fromArray(g.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,m.jointRadius=g.radius),m.visible=g!==null}const h=c.joints["index-finger-tip"],u=c.joints["thumb-tip"],d=h.position.distanceTo(u.position),f=.02,p=.005;c.inputState.pinching&&d>f+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&d<=f-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=n.getPose(e.gripSpace,i),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));a!==null&&(r=n.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(zce)))}return a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=o!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const i=new kc;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[n.jointName]=i,e.add(i)}return e.joints[n.jointName]}}class h7 extends ni{constructor(e,n,i,r,s,o,a,l,c,h){if(h=h!==void 0?h:Eh,h!==Eh&&h!==Ef)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&h===Eh&&(i=ah),i===void 0&&h===Ef&&(i=lf),super(null,r,s,o,a,l,h,i,c),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=a!==void 0?a:vi,this.minFilter=l!==void 0?l:vi,this.flipY=!1,this.generateMipmaps=!1}}class Gce extends tc{constructor(e,n){super();const i=this;let r=null,s=1,o=null,a="local-floor",l=1,c=null,h=null,u=null,d=null,f=null,p=null;const v=n.getContextAttributes();let g=null,m=null;const y=[],_=[],S=new Set,A=new Map,b=new zn;b.layers.enable(1),b.viewport=new Dn;const T=new zn;T.layers.enable(2),T.viewport=new Dn;const M=[b,T],E=new u7;E.layers.enable(1),E.layers.enable(2);let P=null,R=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(X){let q=y[X];return q===void 0&&(q=new zT,y[X]=q),q.getTargetRaySpace()},this.getControllerGrip=function(X){let q=y[X];return q===void 0&&(q=new zT,y[X]=q),q.getGripSpace()},this.getHand=function(X){let q=y[X];return q===void 0&&(q=new zT,y[X]=q),q.getHandSpace()};function F(X){const q=_.indexOf(X.inputSource);if(q===-1)return;const re=y[q];re!==void 0&&(re.update(X.inputSource,X.frame,c||o),re.dispatchEvent({type:X.type,data:X.inputSource}))}function B(){r.removeEventListener("select",F),r.removeEventListener("selectstart",F),r.removeEventListener("selectend",F),r.removeEventListener("squeeze",F),r.removeEventListener("squeezestart",F),r.removeEventListener("squeezeend",F),r.removeEventListener("end",B),r.removeEventListener("inputsourceschange",k);for(let X=0;X<y.length;X++){const q=_[X];q!==null&&(_[X]=null,y[X].disconnect(q))}P=null,R=null,e.setRenderTarget(g),f=null,d=null,u=null,r=null,m=null,z.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(X){s=X,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(X){a=X,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||o},this.setReferenceSpace=function(X){c=X},this.getBaseLayer=function(){return d!==null?d:f},this.getBinding=function(){return u},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(X){if(r=X,r!==null){if(g=e.getRenderTarget(),r.addEventListener("select",F),r.addEventListener("selectstart",F),r.addEventListener("selectend",F),r.addEventListener("squeeze",F),r.addEventListener("squeezestart",F),r.addEventListener("squeezeend",F),r.addEventListener("end",B),r.addEventListener("inputsourceschange",k),v.xrCompatible!==!0&&await n.makeXRCompatible(),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const q={antialias:r.renderState.layers===void 0?v.antialias:!0,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(r,n,q),r.updateRenderState({baseLayer:f}),m=new qa(f.framebufferWidth,f.framebufferHeight,{format:Es,type:tu,colorSpace:e.outputColorSpace,stencilBuffer:v.stencil})}else{let q=null,re=null,G=null;v.depth&&(G=v.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,q=v.stencil?Ef:Eh,re=v.stencil?lf:ah);const K={colorFormat:n.RGBA8,depthFormat:G,scaleFactor:s};u=new XRWebGLBinding(r,n),d=u.createProjectionLayer(K),r.updateRenderState({layers:[d]}),m=new qa(d.textureWidth,d.textureHeight,{format:Es,type:tu,depthTexture:new h7(d.textureWidth,d.textureHeight,re,void 0,void 0,void 0,void 0,void 0,void 0,q),stencilBuffer:v.stencil,colorSpace:e.outputColorSpace,samples:v.antialias?4:0});const oe=e.properties.get(m);oe.__ignoreDepthValues=d.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(l),c=null,o=await r.requestReferenceSpace(a),z.setContext(r),z.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function k(X){for(let q=0;q<X.removed.length;q++){const re=X.removed[q],G=_.indexOf(re);G>=0&&(_[G]=null,y[G].disconnect(re))}for(let q=0;q<X.added.length;q++){const re=X.added[q];let G=_.indexOf(re);if(G===-1){for(let oe=0;oe<y.length;oe++)if(oe>=_.length){_.push(re),G=oe;break}else if(_[oe]===null){_[oe]=re,G=oe;break}if(G===-1)break}const K=y[G];K&&K.connect(re)}}const j=new ae,Z=new ae;function ee(X,q,re){j.setFromMatrixPosition(q.matrixWorld),Z.setFromMatrixPosition(re.matrixWorld);const G=j.distanceTo(Z),K=q.projectionMatrix.elements,oe=re.projectionMatrix.elements,ve=K[14]/(K[10]-1),$=K[14]/(K[10]+1),se=(K[9]+1)/K[5],ne=(K[9]-1)/K[5],ie=(K[8]-1)/K[0],me=(oe[8]+1)/oe[0],xe=ve*ie,Ae=ve*me,we=G/(-ie+me),Ee=we*-ie;q.matrixWorld.decompose(X.position,X.quaternion,X.scale),X.translateX(Ee),X.translateZ(we),X.matrixWorld.compose(X.position,X.quaternion,X.scale),X.matrixWorldInverse.copy(X.matrixWorld).invert();const Re=ve+we,Ue=$+we,Ne=xe-Ee,U=Ae+(G-Ee),L=se*$/Ue*Re,te=ne*$/Ue*Re;X.projectionMatrix.makePerspective(Ne,U,L,te,Re,Ue),X.projectionMatrixInverse.copy(X.projectionMatrix).invert()}function O(X,q){q===null?X.matrixWorld.copy(X.matrix):X.matrixWorld.multiplyMatrices(q.matrixWorld,X.matrix),X.matrixWorldInverse.copy(X.matrixWorld).invert()}this.updateCamera=function(X){if(r===null)return;E.near=T.near=b.near=X.near,E.far=T.far=b.far=X.far,(P!==E.near||R!==E.far)&&(r.updateRenderState({depthNear:E.near,depthFar:E.far}),P=E.near,R=E.far);const q=X.parent,re=E.cameras;O(E,q);for(let G=0;G<re.length;G++)O(re[G],q);re.length===2?ee(E,b,T):E.projectionMatrix.copy(b.projectionMatrix),W(X,E,q)};function W(X,q,re){re===null?X.matrix.copy(q.matrixWorld):(X.matrix.copy(re.matrixWorld),X.matrix.invert(),X.matrix.multiply(q.matrixWorld)),X.matrix.decompose(X.position,X.quaternion,X.scale),X.updateMatrixWorld(!0);const G=X.children;for(let K=0,oe=G.length;K<oe;K++)G[K].updateMatrixWorld(!0);X.projectionMatrix.copy(q.projectionMatrix),X.projectionMatrixInverse.copy(q.projectionMatrixInverse),X.isPerspectiveCamera&&(X.fov=Tg*2*Math.atan(1/X.projectionMatrix.elements[5]),X.zoom=1)}this.getCamera=function(){return E},this.getFoveation=function(){if(!(d===null&&f===null))return l},this.setFoveation=function(X){l=X,d!==null&&(d.fixedFoveation=X),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=X)},this.getPlanes=function(){return S};let H=null;function Y(X,q){if(h=q.getViewerPose(c||o),p=q,h!==null){const re=h.views;f!==null&&(e.setRenderTargetFramebuffer(m,f.framebuffer),e.setRenderTarget(m));let G=!1;re.length!==E.cameras.length&&(E.cameras.length=0,G=!0);for(let K=0;K<re.length;K++){const oe=re[K];let ve=null;if(f!==null)ve=f.getViewport(oe);else{const se=u.getViewSubImage(d,oe);ve=se.viewport,K===0&&(e.setRenderTargetTextures(m,se.colorTexture,d.ignoreDepthValues?void 0:se.depthStencilTexture),e.setRenderTarget(m))}let $=M[K];$===void 0&&($=new zn,$.layers.enable(K),$.viewport=new Dn,M[K]=$),$.matrix.fromArray(oe.transform.matrix),$.matrix.decompose($.position,$.quaternion,$.scale),$.projectionMatrix.fromArray(oe.projectionMatrix),$.projectionMatrixInverse.copy($.projectionMatrix).invert(),$.viewport.set(ve.x,ve.y,ve.width,ve.height),K===0&&(E.matrix.copy($.matrix),E.matrix.decompose(E.position,E.quaternion,E.scale)),G===!0&&E.cameras.push($)}}for(let re=0;re<y.length;re++){const G=_[re],K=y[re];G!==null&&K!==void 0&&K.update(G,q,c||o)}if(H&&H(X,q),q.detectedPlanes){i.dispatchEvent({type:"planesdetected",data:q.detectedPlanes});let re=null;for(const G of S)q.detectedPlanes.has(G)||(re===null&&(re=[]),re.push(G));if(re!==null)for(const G of re)S.delete(G),A.delete(G),i.dispatchEvent({type:"planeremoved",data:G});for(const G of q.detectedPlanes)if(!S.has(G))S.add(G),A.set(G,q.lastChangedTime),i.dispatchEvent({type:"planeadded",data:G});else{const K=A.get(G);G.lastChangedTime>K&&(A.set(G,G.lastChangedTime),i.dispatchEvent({type:"planechanged",data:G}))}}p=null}const z=new r7;z.setAnimationLoop(Y),this.setAnimationLoop=function(X){H=X},this.dispose=function(){}}}function Hce(t,e){function n(g,m){g.matrixAutoUpdate===!0&&g.updateMatrix(),m.value.copy(g.matrix)}function i(g,m){m.color.getRGB(g.fogColor.value,n7(t)),m.isFog?(g.fogNear.value=m.near,g.fogFar.value=m.far):m.isFogExp2&&(g.fogDensity.value=m.density)}function r(g,m,y,_,S){m.isMeshBasicMaterial||m.isMeshLambertMaterial?s(g,m):m.isMeshToonMaterial?(s(g,m),u(g,m)):m.isMeshPhongMaterial?(s(g,m),h(g,m)):m.isMeshStandardMaterial?(s(g,m),d(g,m),m.isMeshPhysicalMaterial&&f(g,m,S)):m.isMeshMatcapMaterial?(s(g,m),p(g,m)):m.isMeshDepthMaterial?s(g,m):m.isMeshDistanceMaterial?(s(g,m),v(g,m)):m.isMeshNormalMaterial?s(g,m):m.isLineBasicMaterial?(o(g,m),m.isLineDashedMaterial&&a(g,m)):m.isPointsMaterial?l(g,m,y,_):m.isSpriteMaterial?c(g,m):m.isShadowMaterial?(g.color.value.copy(m.color),g.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}function s(g,m){g.opacity.value=m.opacity,m.color&&g.diffuse.value.copy(m.color),m.emissive&&g.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(g.map.value=m.map,n(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,n(m.alphaMap,g.alphaMapTransform)),m.bumpMap&&(g.bumpMap.value=m.bumpMap,n(m.bumpMap,g.bumpMapTransform),g.bumpScale.value=m.bumpScale,m.side===fs&&(g.bumpScale.value*=-1)),m.normalMap&&(g.normalMap.value=m.normalMap,n(m.normalMap,g.normalMapTransform),g.normalScale.value.copy(m.normalScale),m.side===fs&&g.normalScale.value.negate()),m.displacementMap&&(g.displacementMap.value=m.displacementMap,n(m.displacementMap,g.displacementMapTransform),g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias),m.emissiveMap&&(g.emissiveMap.value=m.emissiveMap,n(m.emissiveMap,g.emissiveMapTransform)),m.specularMap&&(g.specularMap.value=m.specularMap,n(m.specularMap,g.specularMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);const y=e.get(m).envMap;if(y&&(g.envMap.value=y,g.flipEnvMap.value=y.isCubeTexture&&y.isRenderTargetTexture===!1?-1:1,g.reflectivity.value=m.reflectivity,g.ior.value=m.ior,g.refractionRatio.value=m.refractionRatio),m.lightMap){g.lightMap.value=m.lightMap;const _=t.useLegacyLights===!0?Math.PI:1;g.lightMapIntensity.value=m.lightMapIntensity*_,n(m.lightMap,g.lightMapTransform)}m.aoMap&&(g.aoMap.value=m.aoMap,g.aoMapIntensity.value=m.aoMapIntensity,n(m.aoMap,g.aoMapTransform))}function o(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,m.map&&(g.map.value=m.map,n(m.map,g.mapTransform))}function a(g,m){g.dashSize.value=m.dashSize,g.totalSize.value=m.dashSize+m.gapSize,g.scale.value=m.scale}function l(g,m,y,_){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.size.value=m.size*y,g.scale.value=_*.5,m.map&&(g.map.value=m.map,n(m.map,g.uvTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}function c(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.rotation.value=m.rotation,m.map&&(g.map.value=m.map,n(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}function h(g,m){g.specular.value.copy(m.specular),g.shininess.value=Math.max(m.shininess,1e-4)}function u(g,m){m.gradientMap&&(g.gradientMap.value=m.gradientMap)}function d(g,m){g.metalness.value=m.metalness,m.metalnessMap&&(g.metalnessMap.value=m.metalnessMap,n(m.metalnessMap,g.metalnessMapTransform)),g.roughness.value=m.roughness,m.roughnessMap&&(g.roughnessMap.value=m.roughnessMap,n(m.roughnessMap,g.roughnessMapTransform)),e.get(m).envMap&&(g.envMapIntensity.value=m.envMapIntensity)}function f(g,m,y){g.ior.value=m.ior,m.sheen>0&&(g.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),g.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(g.sheenColorMap.value=m.sheenColorMap,n(m.sheenColorMap,g.sheenColorMapTransform)),m.sheenRoughnessMap&&(g.sheenRoughnessMap.value=m.sheenRoughnessMap,n(m.sheenRoughnessMap,g.sheenRoughnessMapTransform))),m.clearcoat>0&&(g.clearcoat.value=m.clearcoat,g.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(g.clearcoatMap.value=m.clearcoatMap,n(m.clearcoatMap,g.clearcoatMapTransform)),m.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap,n(m.clearcoatRoughnessMap,g.clearcoatRoughnessMapTransform)),m.clearcoatNormalMap&&(g.clearcoatNormalMap.value=m.clearcoatNormalMap,n(m.clearcoatNormalMap,g.clearcoatNormalMapTransform),g.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),m.side===fs&&g.clearcoatNormalScale.value.negate())),m.iridescence>0&&(g.iridescence.value=m.iridescence,g.iridescenceIOR.value=m.iridescenceIOR,g.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(g.iridescenceMap.value=m.iridescenceMap,n(m.iridescenceMap,g.iridescenceMapTransform)),m.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=m.iridescenceThicknessMap,n(m.iridescenceThicknessMap,g.iridescenceThicknessMapTransform))),m.transmission>0&&(g.transmission.value=m.transmission,g.transmissionSamplerMap.value=y.texture,g.transmissionSamplerSize.value.set(y.width,y.height),m.transmissionMap&&(g.transmissionMap.value=m.transmissionMap,n(m.transmissionMap,g.transmissionMapTransform)),g.thickness.value=m.thickness,m.thicknessMap&&(g.thicknessMap.value=m.thicknessMap,n(m.thicknessMap,g.thicknessMapTransform)),g.attenuationDistance.value=m.attenuationDistance,g.attenuationColor.value.copy(m.attenuationColor)),g.specularIntensity.value=m.specularIntensity,g.specularColor.value.copy(m.specularColor),m.specularColorMap&&(g.specularColorMap.value=m.specularColorMap,n(m.specularColorMap,g.specularColorMapTransform)),m.specularIntensityMap&&(g.specularIntensityMap.value=m.specularIntensityMap,n(m.specularIntensityMap,g.specularIntensityMapTransform))}function p(g,m){m.matcap&&(g.matcap.value=m.matcap)}function v(g,m){const y=e.get(m).light;g.referencePosition.value.setFromMatrixPosition(y.matrixWorld),g.nearDistance.value=y.shadow.camera.near,g.farDistance.value=y.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function Vce(t,e,n,i){let r={},s={},o=[];const a=n.isWebGL2?t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(y,_){const S=_.program;i.uniformBlockBinding(y,S)}function c(y,_){let S=r[y.id];S===void 0&&(p(y),S=h(y),r[y.id]=S,y.addEventListener("dispose",g));const A=_.program;i.updateUBOMapping(y,A);const b=e.render.frame;s[y.id]!==b&&(d(y),s[y.id]=b)}function h(y){const _=u();y.__bindingPointIndex=_;const S=t.createBuffer(),A=y.__size,b=y.usage;return t.bindBuffer(t.UNIFORM_BUFFER,S),t.bufferData(t.UNIFORM_BUFFER,A,b),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,_,S),S}function u(){for(let y=0;y<a;y++)if(o.indexOf(y)===-1)return o.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(y){const _=r[y.id],S=y.uniforms,A=y.__cache;t.bindBuffer(t.UNIFORM_BUFFER,_);for(let b=0,T=S.length;b<T;b++){const M=S[b];if(f(M,b,A)===!0){const E=M.__offset,P=Array.isArray(M.value)?M.value:[M.value];let R=0;for(let F=0;F<P.length;F++){const B=P[F],k=v(B);typeof B=="number"?(M.__data[0]=B,t.bufferSubData(t.UNIFORM_BUFFER,E+R,M.__data)):B.isMatrix3?(M.__data[0]=B.elements[0],M.__data[1]=B.elements[1],M.__data[2]=B.elements[2],M.__data[3]=B.elements[0],M.__data[4]=B.elements[3],M.__data[5]=B.elements[4],M.__data[6]=B.elements[5],M.__data[7]=B.elements[0],M.__data[8]=B.elements[6],M.__data[9]=B.elements[7],M.__data[10]=B.elements[8],M.__data[11]=B.elements[0]):(B.toArray(M.__data,R),R+=k.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,E,M.__data)}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function f(y,_,S){const A=y.value;if(S[_]===void 0){if(typeof A=="number")S[_]=A;else{const b=Array.isArray(A)?A:[A],T=[];for(let M=0;M<b.length;M++)T.push(b[M].clone());S[_]=T}return!0}else if(typeof A=="number"){if(S[_]!==A)return S[_]=A,!0}else{const b=Array.isArray(S[_])?S[_]:[S[_]],T=Array.isArray(A)?A:[A];for(let M=0;M<b.length;M++){const E=b[M];if(E.equals(T[M])===!1)return E.copy(T[M]),!0}}return!1}function p(y){const _=y.uniforms;let S=0;const A=16;let b=0;for(let T=0,M=_.length;T<M;T++){const E=_[T],P={boundary:0,storage:0},R=Array.isArray(E.value)?E.value:[E.value];for(let F=0,B=R.length;F<B;F++){const k=R[F],j=v(k);P.boundary+=j.boundary,P.storage+=j.storage}if(E.__data=new Float32Array(P.storage/Float32Array.BYTES_PER_ELEMENT),E.__offset=S,T>0){b=S%A;const F=A-b;b!==0&&F-P.boundary<0&&(S+=A-b,E.__offset=S)}S+=P.storage}return b=S%A,b>0&&(S+=A-b),y.__size=S,y.__cache={},this}function v(y){const _={boundary:0,storage:0};return typeof y=="number"?(_.boundary=4,_.storage=4):y.isVector2?(_.boundary=8,_.storage=8):y.isVector3||y.isColor?(_.boundary=16,_.storage=12):y.isVector4?(_.boundary=16,_.storage=16):y.isMatrix3?(_.boundary=48,_.storage=48):y.isMatrix4?(_.boundary=64,_.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),_}function g(y){const _=y.target;_.removeEventListener("dispose",g);const S=o.indexOf(_.__bindingPointIndex);o.splice(S,1),t.deleteBuffer(r[_.id]),delete r[_.id],delete s[_.id]}function m(){for(const y in r)t.deleteBuffer(r[y]);o=[],r={},s={}}return{bind:l,update:c,dispose:m}}function jce(){const t=ux("canvas");return t.style.display="block",t}class dB{constructor(e={}){const{canvas:n=jce(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:h="default",failIfMajorPerformanceCaveat:u=!1}=e;this.isWebGLRenderer=!0;let d;i!==null?d=i.getContextAttributes().alpha:d=o;let f=null,p=null;const v=[],g=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=Jt,this.useLegacyLights=!0,this.toneMapping=Va,this.toneMappingExposure=1;const m=this;let y=!1,_=0,S=0,A=null,b=-1,T=null;const M=new Dn,E=new Dn;let P=null,R=n.width,F=n.height,B=1,k=null,j=null;const Z=new Dn(0,0,R,F),ee=new Dn(0,0,R,F);let O=!1;const W=new zM;let H=!1,Y=!1,z=null;const X=new kt,q=new ae,re={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function G(){return A===null?B:1}let K=i;function oe(Q,de){for(let le=0;le<Q.length;le++){const ce=Q[le],De=n.getContext(ce,de);if(De!==null)return De}return null}try{const Q={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:h,failIfMajorPerformanceCaveat:u};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${BM}`),n.addEventListener("webglcontextlost",ze,!1),n.addEventListener("webglcontextrestored",$e,!1),n.addEventListener("webglcontextcreationerror",dt,!1),K===null){const de=["webgl2","webgl","experimental-webgl"];if(m.isWebGL1Renderer===!0&&de.shift(),K=oe(de,Q),K===null)throw oe(de)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}K.getShaderPrecisionFormat===void 0&&(K.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Q){throw console.error("THREE.WebGLRenderer: "+Q.message),Q}let ve,$,se,ne,ie,me,xe,Ae,we,Ee,Re,Ue,Ne,U,L,te,_e,Te,Ie,Qe,Ge,ye,Ve,ue;function Me(){ve=new ole(K),$=new ele(K,ve,e),ve.init($),ye=new c7(K,ve,$),se=new Uce(K,ve,$),ne=new cle(K),ie=new Ece,me=new kce(K,ve,se,ie,$,ye,ne),xe=new nle(m),Ae=new sle(m),we=new wse(K,$),Ve=new Zae(K,ve,we,$),Ee=new ale(K,we,ne,Ve),Re=new fle(K,Ee,we,ne),Ie=new dle(K,$,me),te=new tle(ie),Ue=new Mce(m,xe,Ae,ve,$,Ve,te),Ne=new Hce(m,ie),U=new Tce,L=new Bce(ve,$),Te=new Jae(m,xe,Ae,se,Re,d,l),_e=new Nce(m,Re,$),ue=new Vce(K,ne,$,se),Qe=new $ae(K,ve,ne,$),Ge=new lle(K,ve,ne,$),ne.programs=Ue.programs,m.capabilities=$,m.extensions=ve,m.properties=ie,m.renderLists=U,m.shadowMap=_e,m.state=se,m.info=ne}Me();const Be=new Gce(m,K);this.xr=Be,this.getContext=function(){return K},this.getContextAttributes=function(){return K.getContextAttributes()},this.forceContextLoss=function(){const Q=ve.get("WEBGL_lose_context");Q&&Q.loseContext()},this.forceContextRestore=function(){const Q=ve.get("WEBGL_lose_context");Q&&Q.restoreContext()},this.getPixelRatio=function(){return B},this.setPixelRatio=function(Q){Q!==void 0&&(B=Q,this.setSize(R,F,!1))},this.getSize=function(Q){return Q.set(R,F)},this.setSize=function(Q,de,le=!0){if(Be.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}R=Q,F=de,n.width=Math.floor(Q*B),n.height=Math.floor(de*B),le===!0&&(n.style.width=Q+"px",n.style.height=de+"px"),this.setViewport(0,0,Q,de)},this.getDrawingBufferSize=function(Q){return Q.set(R*B,F*B).floor()},this.setDrawingBufferSize=function(Q,de,le){R=Q,F=de,B=le,n.width=Math.floor(Q*le),n.height=Math.floor(de*le),this.setViewport(0,0,Q,de)},this.getCurrentViewport=function(Q){return Q.copy(M)},this.getViewport=function(Q){return Q.copy(Z)},this.setViewport=function(Q,de,le,ce){Q.isVector4?Z.set(Q.x,Q.y,Q.z,Q.w):Z.set(Q,de,le,ce),se.viewport(M.copy(Z).multiplyScalar(B).floor())},this.getScissor=function(Q){return Q.copy(ee)},this.setScissor=function(Q,de,le,ce){Q.isVector4?ee.set(Q.x,Q.y,Q.z,Q.w):ee.set(Q,de,le,ce),se.scissor(E.copy(ee).multiplyScalar(B).floor())},this.getScissorTest=function(){return O},this.setScissorTest=function(Q){se.setScissorTest(O=Q)},this.setOpaqueSort=function(Q){k=Q},this.setTransparentSort=function(Q){j=Q},this.getClearColor=function(Q){return Q.copy(Te.getClearColor())},this.setClearColor=function(){Te.setClearColor.apply(Te,arguments)},this.getClearAlpha=function(){return Te.getClearAlpha()},this.setClearAlpha=function(){Te.setClearAlpha.apply(Te,arguments)},this.clear=function(Q=!0,de=!0,le=!0){let ce=0;Q&&(ce|=K.COLOR_BUFFER_BIT),de&&(ce|=K.DEPTH_BUFFER_BIT),le&&(ce|=K.STENCIL_BUFFER_BIT),K.clear(ce)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",ze,!1),n.removeEventListener("webglcontextrestored",$e,!1),n.removeEventListener("webglcontextcreationerror",dt,!1),U.dispose(),L.dispose(),ie.dispose(),xe.dispose(),Ae.dispose(),Re.dispose(),Ve.dispose(),ue.dispose(),Ue.dispose(),Be.dispose(),Be.removeEventListener("sessionstart",qe),Be.removeEventListener("sessionend",vt),z&&(z.dispose(),z=null),Et.stop()};function ze(Q){Q.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),y=!0}function $e(){console.log("THREE.WebGLRenderer: Context Restored."),y=!1;const Q=ne.autoReset,de=_e.enabled,le=_e.autoUpdate,ce=_e.needsUpdate,De=_e.type;Me(),ne.autoReset=Q,_e.enabled=de,_e.autoUpdate=le,_e.needsUpdate=ce,_e.type=De}function dt(Q){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Q.statusMessage)}function Bt(Q){const de=Q.target;de.removeEventListener("dispose",Bt),J(de)}function J(Q){fe(Q),ie.remove(Q)}function fe(Q){const de=ie.get(Q).programs;de!==void 0&&(de.forEach(function(le){Ue.releaseProgram(le)}),Q.isShaderMaterial&&Ue.releaseShaderCache(Q))}this.renderBufferDirect=function(Q,de,le,ce,De,Ke){de===null&&(de=re);const Ze=De.isMesh&&De.matrixWorld.determinant()<0,it=Zf(Q,de,le,ce,De);se.setMaterial(ce,Ze);let ht=le.index,lt=1;ce.wireframe===!0&&(ht=Ee.getWireframeAttribute(le),lt=2);const ot=le.drawRange,Mt=le.attributes.position;let Vt=ot.start*lt,Nn=(ot.start+ot.count)*lt;Ke!==null&&(Vt=Math.max(Vt,Ke.start*lt),Nn=Math.min(Nn,(Ke.start+Ke.count)*lt)),ht!==null?(Vt=Math.max(Vt,0),Nn=Math.min(Nn,ht.count)):Mt!=null&&(Vt=Math.max(Vt,0),Nn=Math.min(Nn,Mt.count));const Si=Nn-Vt;if(Si<0||Si===1/0)return;Ve.setup(De,ce,it,le,ht);let vn,yt=Qe;if(ht!==null&&(vn=we.get(ht),yt=Ge,yt.setIndex(vn)),De.isMesh)ce.wireframe===!0?(se.setLineWidth(ce.wireframeLinewidth*G()),yt.setMode(K.LINES)):yt.setMode(K.TRIANGLES);else if(De.isLine){let Qt=ce.linewidth;Qt===void 0&&(Qt=1),se.setLineWidth(Qt*G()),De.isLineSegments?yt.setMode(K.LINES):De.isLineLoop?yt.setMode(K.LINE_LOOP):yt.setMode(K.LINE_STRIP)}else De.isPoints?yt.setMode(K.POINTS):De.isSprite&&yt.setMode(K.TRIANGLES);if(De.isInstancedMesh)yt.renderInstances(Vt,Si,De.count);else if(le.isInstancedBufferGeometry){const Qt=le._maxInstanceCount!==void 0?le._maxInstanceCount:1/0,fa=Math.min(le.instanceCount,Qt);yt.renderInstances(Vt,Si,fa)}else yt.render(Vt,Si)},this.compile=function(Q,de){function le(ce,De,Ke){ce.transparent===!0&&ce.side===$o&&ce.forceSinglePass===!1?(ce.side=fs,ce.needsUpdate=!0,sc(ce,De,Ke),ce.side=ql,ce.needsUpdate=!0,sc(ce,De,Ke),ce.side=$o):sc(ce,De,Ke)}p=L.get(Q),p.init(),g.push(p),Q.traverseVisible(function(ce){ce.isLight&&ce.layers.test(de.layers)&&(p.pushLight(ce),ce.castShadow&&p.pushShadow(ce))}),p.setupLights(m.useLegacyLights),Q.traverse(function(ce){const De=ce.material;if(De)if(Array.isArray(De))for(let Ke=0;Ke<De.length;Ke++){const Ze=De[Ke];le(Ze,Q,ce)}else le(De,Q,ce)}),g.pop(),p=null};let be=null;function Oe(Q){be&&be(Q)}function qe(){Et.stop()}function vt(){Et.start()}const Et=new r7;Et.setAnimationLoop(Oe),typeof self<"u"&&Et.setContext(self),this.setAnimationLoop=function(Q){be=Q,Be.setAnimationLoop(Q),Q===null?Et.stop():Et.start()},Be.addEventListener("sessionstart",qe),Be.addEventListener("sessionend",vt),this.render=function(Q,de){if(de!==void 0&&de.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(y===!0)return;Q.matrixWorldAutoUpdate===!0&&Q.updateMatrixWorld(),de.parent===null&&de.matrixWorldAutoUpdate===!0&&de.updateMatrixWorld(),Be.enabled===!0&&Be.isPresenting===!0&&(Be.cameraAutoUpdate===!0&&Be.updateCamera(de),de=Be.getCamera()),Q.isScene===!0&&Q.onBeforeRender(m,Q,de,A),p=L.get(Q,g.length),p.init(),g.push(p),X.multiplyMatrices(de.projectionMatrix,de.matrixWorldInverse),W.setFromProjectionMatrix(X),Y=this.localClippingEnabled,H=te.init(this.clippingPlanes,Y),f=U.get(Q,v.length),f.init(),v.push(f),un(Q,de,0,m.sortObjects),f.finish(),m.sortObjects===!0&&f.sort(k,j),H===!0&&te.beginShadows();const le=p.state.shadowsArray;if(_e.render(le,Q,de),H===!0&&te.endShadows(),this.info.autoReset===!0&&this.info.reset(),Te.render(f,Q),p.setupLights(m.useLegacyLights),de.isArrayCamera){const ce=de.cameras;for(let De=0,Ke=ce.length;De<Ke;De++){const Ze=ce[De];ji(f,Q,Ze,Ze.viewport)}}else ji(f,Q,de);A!==null&&(me.updateMultisampleRenderTarget(A),me.updateRenderTargetMipmap(A)),Q.isScene===!0&&Q.onAfterRender(m,Q,de),Ve.resetDefaultState(),b=-1,T=null,g.pop(),g.length>0?p=g[g.length-1]:p=null,v.pop(),v.length>0?f=v[v.length-1]:f=null};function un(Q,de,le,ce){if(Q.visible===!1)return;if(Q.layers.test(de.layers)){if(Q.isGroup)le=Q.renderOrder;else if(Q.isLOD)Q.autoUpdate===!0&&Q.update(de);else if(Q.isLight)p.pushLight(Q),Q.castShadow&&p.pushShadow(Q);else if(Q.isSprite){if(!Q.frustumCulled||W.intersectsSprite(Q)){ce&&q.setFromMatrixPosition(Q.matrixWorld).applyMatrix4(X);const Ze=Re.update(Q),it=Q.material;it.visible&&f.push(Q,Ze,it,le,q.z,null)}}else if((Q.isMesh||Q.isLine||Q.isPoints)&&(!Q.frustumCulled||W.intersectsObject(Q))){Q.isSkinnedMesh&&Q.skeleton.frame!==ne.render.frame&&(Q.skeleton.update(),Q.skeleton.frame=ne.render.frame);const Ze=Re.update(Q),it=Q.material;if(ce&&(Ze.boundingSphere===null&&Ze.computeBoundingSphere(),q.copy(Ze.boundingSphere.center).applyMatrix4(Q.matrixWorld).applyMatrix4(X)),Array.isArray(it)){const ht=Ze.groups;for(let lt=0,ot=ht.length;lt<ot;lt++){const Mt=ht[lt],Vt=it[Mt.materialIndex];Vt&&Vt.visible&&f.push(Q,Ze,Vt,le,q.z,Mt)}}else it.visible&&f.push(Q,Ze,it,le,q.z,null)}}const Ke=Q.children;for(let Ze=0,it=Ke.length;Ze<it;Ze++)un(Ke[Ze],de,le,ce)}function ji(Q,de,le,ce){const De=Q.opaque,Ke=Q.transmissive,Ze=Q.transparent;p.setupLightsView(le),H===!0&&te.setGlobalState(m.clippingPlanes,le),Ke.length>0&&Ot(De,Ke,de,le),ce&&se.viewport(M.copy(ce)),De.length>0&&jn(De,de,le),Ke.length>0&&jn(Ke,de,le),Ze.length>0&&jn(Ze,de,le),se.buffers.depth.setTest(!0),se.buffers.depth.setMask(!0),se.buffers.color.setMask(!0),se.setPolygonOffset(!1)}function Ot(Q,de,le,ce){if(z===null){const it=$.isWebGL2;z=new qa(1024,1024,{generateMipmaps:!0,type:ve.has("EXT_color_buffer_half_float")?Eg:tu,minFilter:Ql,samples:it&&a===!0?4:0})}const De=m.getRenderTarget();m.setRenderTarget(z),m.clear();const Ke=m.toneMapping;m.toneMapping=Va,jn(Q,le,ce),me.updateMultisampleRenderTarget(z),me.updateRenderTargetMipmap(z);let Ze=!1;for(let it=0,ht=de.length;it<ht;it++){const lt=de[it],ot=lt.object,Mt=lt.geometry,Vt=lt.material,Nn=lt.group;if(Vt.side===$o&&ot.layers.test(ce.layers)){const Si=Vt.side;Vt.side=fs,Vt.needsUpdate=!0,Wn(ot,le,ce,Mt,Vt,Nn),Vt.side=Si,Vt.needsUpdate=!0,Ze=!0}}Ze===!0&&(me.updateMultisampleRenderTarget(z),me.updateRenderTargetMipmap(z)),m.setRenderTarget(De),m.toneMapping=Ke}function jn(Q,de,le){const ce=de.isScene===!0?de.overrideMaterial:null;for(let De=0,Ke=Q.length;De<Ke;De++){const Ze=Q[De],it=Ze.object,ht=Ze.geometry,lt=ce===null?Ze.material:ce,ot=Ze.group;it.layers.test(le.layers)&&Wn(it,de,le,ht,lt,ot)}}function Wn(Q,de,le,ce,De,Ke){Q.onBeforeRender(m,de,le,ce,De,Ke),Q.modelViewMatrix.multiplyMatrices(le.matrixWorldInverse,Q.matrixWorld),Q.normalMatrix.getNormalMatrix(Q.modelViewMatrix),De.onBeforeRender(m,de,le,ce,Q,Ke),De.transparent===!0&&De.side===$o&&De.forceSinglePass===!1?(De.side=fs,De.needsUpdate=!0,m.renderBufferDirect(le,de,ce,De,Q,Ke),De.side=ql,De.needsUpdate=!0,m.renderBufferDirect(le,de,ce,De,Q,Ke),De.side=$o):m.renderBufferDirect(le,de,ce,De,Q,Ke),Q.onAfterRender(m,de,le,ce,De,Ke)}function sc(Q,de,le){de.isScene!==!0&&(de=re);const ce=ie.get(Q),De=p.state.lights,Ke=p.state.shadowsArray,Ze=De.state.version,it=Ue.getParameters(Q,De.state,Ke,de,le),ht=Ue.getProgramCacheKey(it);let lt=ce.programs;ce.environment=Q.isMeshStandardMaterial?de.environment:null,ce.fog=de.fog,ce.envMap=(Q.isMeshStandardMaterial?Ae:xe).get(Q.envMap||ce.environment),lt===void 0&&(Q.addEventListener("dispose",Bt),lt=new Map,ce.programs=lt);let ot=lt.get(ht);if(ot!==void 0){if(ce.currentProgram===ot&&ce.lightsStateVersion===Ze)return Jf(Q,it),ot}else it.uniforms=Ue.getUniforms(Q),Q.onBuild(le,it,m),Q.onBeforeCompile(it,m),ot=Ue.acquireProgram(it,ht),lt.set(ht,ot),ce.uniforms=it.uniforms;const Mt=ce.uniforms;(!Q.isShaderMaterial&&!Q.isRawShaderMaterial||Q.clipping===!0)&&(Mt.clippingPlanes=te.uniform),Jf(Q,it),ce.needsLights=he(Q),ce.lightsStateVersion=Ze,ce.needsLights&&(Mt.ambientLightColor.value=De.state.ambient,Mt.lightProbe.value=De.state.probe,Mt.directionalLights.value=De.state.directional,Mt.directionalLightShadows.value=De.state.directionalShadow,Mt.spotLights.value=De.state.spot,Mt.spotLightShadows.value=De.state.spotShadow,Mt.rectAreaLights.value=De.state.rectArea,Mt.ltc_1.value=De.state.rectAreaLTC1,Mt.ltc_2.value=De.state.rectAreaLTC2,Mt.pointLights.value=De.state.point,Mt.pointLightShadows.value=De.state.pointShadow,Mt.hemisphereLights.value=De.state.hemi,Mt.directionalShadowMap.value=De.state.directionalShadowMap,Mt.directionalShadowMatrix.value=De.state.directionalShadowMatrix,Mt.spotShadowMap.value=De.state.spotShadowMap,Mt.spotLightMatrix.value=De.state.spotLightMatrix,Mt.spotLightMap.value=De.state.spotLightMap,Mt.pointShadowMap.value=De.state.pointShadowMap,Mt.pointShadowMatrix.value=De.state.pointShadowMatrix);const Vt=ot.getUniforms(),Nn=vb.seqWithValue(Vt.seq,Mt);return ce.currentProgram=ot,ce.uniformsList=Nn,ot}function Jf(Q,de){const le=ie.get(Q);le.outputColorSpace=de.outputColorSpace,le.instancing=de.instancing,le.skinning=de.skinning,le.morphTargets=de.morphTargets,le.morphNormals=de.morphNormals,le.morphColors=de.morphColors,le.morphTargetsCount=de.morphTargetsCount,le.numClippingPlanes=de.numClippingPlanes,le.numIntersection=de.numClipIntersection,le.vertexAlphas=de.vertexAlphas,le.vertexTangents=de.vertexTangents,le.toneMapping=de.toneMapping}function Zf(Q,de,le,ce,De){de.isScene!==!0&&(de=re),me.resetTextureUnits();const Ke=de.fog,Ze=ce.isMeshStandardMaterial?de.environment:null,it=A===null?m.outputColorSpace:A.isXRRenderTarget===!0?A.texture.colorSpace:Ya,ht=(ce.isMeshStandardMaterial?Ae:xe).get(ce.envMap||Ze),lt=ce.vertexColors===!0&&!!le.attributes.color&&le.attributes.color.itemSize===4,ot=!!ce.normalMap&&!!le.attributes.tangent,Mt=!!le.morphAttributes.position,Vt=!!le.morphAttributes.normal,Nn=!!le.morphAttributes.color,Si=ce.toneMapped?m.toneMapping:Va,vn=le.morphAttributes.position||le.morphAttributes.normal||le.morphAttributes.color,yt=vn!==void 0?vn.length:0,Qt=ie.get(ce),fa=p.state.lights;if(H===!0&&(Y===!0||Q!==T)){const yn=Q===T&&ce.id===b;te.setState(ce,Q,yn)}let Bn=!1;ce.version===Qt.__version?(Qt.needsLights&&Qt.lightsStateVersion!==fa.state.version||Qt.outputColorSpace!==it||De.isInstancedMesh&&Qt.instancing===!1||!De.isInstancedMesh&&Qt.instancing===!0||De.isSkinnedMesh&&Qt.skinning===!1||!De.isSkinnedMesh&&Qt.skinning===!0||Qt.envMap!==ht||ce.fog===!0&&Qt.fog!==Ke||Qt.numClippingPlanes!==void 0&&(Qt.numClippingPlanes!==te.numPlanes||Qt.numIntersection!==te.numIntersection)||Qt.vertexAlphas!==lt||Qt.vertexTangents!==ot||Qt.morphTargets!==Mt||Qt.morphNormals!==Vt||Qt.morphColors!==Nn||Qt.toneMapping!==Si||$.isWebGL2===!0&&Qt.morphTargetsCount!==yt)&&(Bn=!0):(Bn=!0,Qt.__version=ce.version);let xs=Qt.currentProgram;Bn===!0&&(xs=sc(ce,de,De));let Zr=!1,or=!1,Gt=!1;const It=xs.getUniforms(),Ri=Qt.uniforms;if(se.useProgram(xs.program)&&(Zr=!0,or=!0,Gt=!0),ce.id!==b&&(b=ce.id,or=!0),Zr||T!==Q){if(It.setValue(K,"projectionMatrix",Q.projectionMatrix),$.logarithmicDepthBuffer&&It.setValue(K,"logDepthBufFC",2/(Math.log(Q.far+1)/Math.LN2)),T!==Q&&(T=Q,or=!0,Gt=!0),ce.isShaderMaterial||ce.isMeshPhongMaterial||ce.isMeshToonMaterial||ce.isMeshStandardMaterial||ce.envMap){const yn=It.map.cameraPosition;yn!==void 0&&yn.setValue(K,q.setFromMatrixPosition(Q.matrixWorld))}(ce.isMeshPhongMaterial||ce.isMeshToonMaterial||ce.isMeshLambertMaterial||ce.isMeshBasicMaterial||ce.isMeshStandardMaterial||ce.isShaderMaterial)&&It.setValue(K,"isOrthographic",Q.isOrthographicCamera===!0),(ce.isMeshPhongMaterial||ce.isMeshToonMaterial||ce.isMeshLambertMaterial||ce.isMeshBasicMaterial||ce.isMeshStandardMaterial||ce.isShaderMaterial||ce.isShadowMaterial||De.isSkinnedMesh)&&It.setValue(K,"viewMatrix",Q.matrixWorldInverse)}if(De.isSkinnedMesh){It.setOptional(K,De,"bindMatrix"),It.setOptional(K,De,"bindMatrixInverse");const yn=De.skeleton;yn&&($.floatVertexTextures?(yn.boneTexture===null&&yn.computeBoneTexture(),It.setValue(K,"boneTexture",yn.boneTexture,me),It.setValue(K,"boneTextureSize",yn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const dn=le.morphAttributes;if((dn.position!==void 0||dn.normal!==void 0||dn.color!==void 0&&$.isWebGL2===!0)&&Ie.update(De,le,xs),(or||Qt.receiveShadow!==De.receiveShadow)&&(Qt.receiveShadow=De.receiveShadow,It.setValue(K,"receiveShadow",De.receiveShadow)),ce.isMeshGouraudMaterial&&ce.envMap!==null&&(Ri.envMap.value=ht,Ri.flipEnvMap.value=ht.isCubeTexture&&ht.isRenderTargetTexture===!1?-1:1),or&&(It.setValue(K,"toneMappingExposure",m.toneMappingExposure),Qt.needsLights&&nd(Ri,Gt),Ke&&ce.fog===!0&&Ne.refreshFogUniforms(Ri,Ke),Ne.refreshMaterialUniforms(Ri,ce,B,F,z),vb.upload(K,Qt.uniformsList,Ri,me)),ce.isShaderMaterial&&ce.uniformsNeedUpdate===!0&&(vb.upload(K,Qt.uniformsList,Ri,me),ce.uniformsNeedUpdate=!1),ce.isSpriteMaterial&&It.setValue(K,"center",De.center),It.setValue(K,"modelViewMatrix",De.modelViewMatrix),It.setValue(K,"normalMatrix",De.normalMatrix),It.setValue(K,"modelMatrix",De.matrixWorld),ce.isShaderMaterial||ce.isRawShaderMaterial){const yn=ce.uniformsGroups;for(let Gs=0,pa=yn.length;Gs<pa;Gs++)if($.isWebGL2){const br=yn[Gs];ue.update(br,xs),ue.bind(br,xs)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return xs}function nd(Q,de){Q.ambientLightColor.needsUpdate=de,Q.lightProbe.needsUpdate=de,Q.directionalLights.needsUpdate=de,Q.directionalLightShadows.needsUpdate=de,Q.pointLights.needsUpdate=de,Q.pointLightShadows.needsUpdate=de,Q.spotLights.needsUpdate=de,Q.spotLightShadows.needsUpdate=de,Q.rectAreaLights.needsUpdate=de,Q.hemisphereLights.needsUpdate=de}function he(Q){return Q.isMeshLambertMaterial||Q.isMeshToonMaterial||Q.isMeshPhongMaterial||Q.isMeshStandardMaterial||Q.isShadowMaterial||Q.isShaderMaterial&&Q.lights===!0}this.getActiveCubeFace=function(){return _},this.getActiveMipmapLevel=function(){return S},this.getRenderTarget=function(){return A},this.setRenderTargetTextures=function(Q,de,le){ie.get(Q.texture).__webglTexture=de,ie.get(Q.depthTexture).__webglTexture=le;const ce=ie.get(Q);ce.__hasExternalTextures=!0,ce.__hasExternalTextures&&(ce.__autoAllocateDepthBuffer=le===void 0,ce.__autoAllocateDepthBuffer||ve.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ce.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Q,de){const le=ie.get(Q);le.__webglFramebuffer=de,le.__useDefaultFramebuffer=de===void 0},this.setRenderTarget=function(Q,de=0,le=0){A=Q,_=de,S=le;let ce=!0,De=null,Ke=!1,Ze=!1;if(Q){const ht=ie.get(Q);ht.__useDefaultFramebuffer!==void 0?(se.bindFramebuffer(K.FRAMEBUFFER,null),ce=!1):ht.__webglFramebuffer===void 0?me.setupRenderTarget(Q):ht.__hasExternalTextures&&me.rebindTextures(Q,ie.get(Q.texture).__webglTexture,ie.get(Q.depthTexture).__webglTexture);const lt=Q.texture;(lt.isData3DTexture||lt.isDataArrayTexture||lt.isCompressedArrayTexture)&&(Ze=!0);const ot=ie.get(Q).__webglFramebuffer;Q.isWebGLCubeRenderTarget?(De=ot[de],Ke=!0):$.isWebGL2&&Q.samples>0&&me.useMultisampledRTT(Q)===!1?De=ie.get(Q).__webglMultisampledFramebuffer:De=ot,M.copy(Q.viewport),E.copy(Q.scissor),P=Q.scissorTest}else M.copy(Z).multiplyScalar(B).floor(),E.copy(ee).multiplyScalar(B).floor(),P=O;if(se.bindFramebuffer(K.FRAMEBUFFER,De)&&$.drawBuffers&&ce&&se.drawBuffers(Q,De),se.viewport(M),se.scissor(E),se.setScissorTest(P),Ke){const ht=ie.get(Q.texture);K.framebufferTexture2D(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0,K.TEXTURE_CUBE_MAP_POSITIVE_X+de,ht.__webglTexture,le)}else if(Ze){const ht=ie.get(Q.texture),lt=de||0;K.framebufferTextureLayer(K.FRAMEBUFFER,K.COLOR_ATTACHMENT0,ht.__webglTexture,le||0,lt)}b=-1},this.readRenderTargetPixels=function(Q,de,le,ce,De,Ke,Ze){if(!(Q&&Q.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let it=ie.get(Q).__webglFramebuffer;if(Q.isWebGLCubeRenderTarget&&Ze!==void 0&&(it=it[Ze]),it){se.bindFramebuffer(K.FRAMEBUFFER,it);try{const ht=Q.texture,lt=ht.format,ot=ht.type;if(lt!==Es&&ye.convert(lt)!==K.getParameter(K.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Mt=ot===Eg&&(ve.has("EXT_color_buffer_half_float")||$.isWebGL2&&ve.has("EXT_color_buffer_float"));if(ot!==tu&&ye.convert(ot)!==K.getParameter(K.IMPLEMENTATION_COLOR_READ_TYPE)&&!(ot===Uc&&($.isWebGL2||ve.has("OES_texture_float")||ve.has("WEBGL_color_buffer_float")))&&!Mt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}de>=0&&de<=Q.width-ce&&le>=0&&le<=Q.height-De&&K.readPixels(de,le,ce,De,ye.convert(lt),ye.convert(ot),Ke)}finally{const ht=A!==null?ie.get(A).__webglFramebuffer:null;se.bindFramebuffer(K.FRAMEBUFFER,ht)}}},this.copyFramebufferToTexture=function(Q,de,le=0){const ce=Math.pow(2,-le),De=Math.floor(de.image.width*ce),Ke=Math.floor(de.image.height*ce);me.setTexture2D(de,0),K.copyTexSubImage2D(K.TEXTURE_2D,le,0,0,Q.x,Q.y,De,Ke),se.unbindTexture()},this.copyTextureToTexture=function(Q,de,le,ce=0){const De=de.image.width,Ke=de.image.height,Ze=ye.convert(le.format),it=ye.convert(le.type);me.setTexture2D(le,0),K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,le.flipY),K.pixelStorei(K.UNPACK_PREMULTIPLY_ALPHA_WEBGL,le.premultiplyAlpha),K.pixelStorei(K.UNPACK_ALIGNMENT,le.unpackAlignment),de.isDataTexture?K.texSubImage2D(K.TEXTURE_2D,ce,Q.x,Q.y,De,Ke,Ze,it,de.image.data):de.isCompressedTexture?K.compressedTexSubImage2D(K.TEXTURE_2D,ce,Q.x,Q.y,de.mipmaps[0].width,de.mipmaps[0].height,Ze,de.mipmaps[0].data):K.texSubImage2D(K.TEXTURE_2D,ce,Q.x,Q.y,Ze,it,de.image),ce===0&&le.generateMipmaps&&K.generateMipmap(K.TEXTURE_2D),se.unbindTexture()},this.copyTextureToTexture3D=function(Q,de,le,ce,De=0){if(m.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Ke=Q.max.x-Q.min.x+1,Ze=Q.max.y-Q.min.y+1,it=Q.max.z-Q.min.z+1,ht=ye.convert(ce.format),lt=ye.convert(ce.type);let ot;if(ce.isData3DTexture)me.setTexture3D(ce,0),ot=K.TEXTURE_3D;else if(ce.isDataArrayTexture)me.setTexture2DArray(ce,0),ot=K.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}K.pixelStorei(K.UNPACK_FLIP_Y_WEBGL,ce.flipY),K.pixelStorei(K.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ce.premultiplyAlpha),K.pixelStorei(K.UNPACK_ALIGNMENT,ce.unpackAlignment);const Mt=K.getParameter(K.UNPACK_ROW_LENGTH),Vt=K.getParameter(K.UNPACK_IMAGE_HEIGHT),Nn=K.getParameter(K.UNPACK_SKIP_PIXELS),Si=K.getParameter(K.UNPACK_SKIP_ROWS),vn=K.getParameter(K.UNPACK_SKIP_IMAGES),yt=le.isCompressedTexture?le.mipmaps[0]:le.image;K.pixelStorei(K.UNPACK_ROW_LENGTH,yt.width),K.pixelStorei(K.UNPACK_IMAGE_HEIGHT,yt.height),K.pixelStorei(K.UNPACK_SKIP_PIXELS,Q.min.x),K.pixelStorei(K.UNPACK_SKIP_ROWS,Q.min.y),K.pixelStorei(K.UNPACK_SKIP_IMAGES,Q.min.z),le.isDataTexture||le.isData3DTexture?K.texSubImage3D(ot,De,de.x,de.y,de.z,Ke,Ze,it,ht,lt,yt.data):le.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),K.compressedTexSubImage3D(ot,De,de.x,de.y,de.z,Ke,Ze,it,ht,yt.data)):K.texSubImage3D(ot,De,de.x,de.y,de.z,Ke,Ze,it,ht,lt,yt),K.pixelStorei(K.UNPACK_ROW_LENGTH,Mt),K.pixelStorei(K.UNPACK_IMAGE_HEIGHT,Vt),K.pixelStorei(K.UNPACK_SKIP_PIXELS,Nn),K.pixelStorei(K.UNPACK_SKIP_ROWS,Si),K.pixelStorei(K.UNPACK_SKIP_IMAGES,vn),De===0&&ce.generateMipmaps&&K.generateMipmap(ot),se.unbindTexture()},this.initTexture=function(Q){Q.isCubeTexture?me.setTextureCube(Q,0):Q.isData3DTexture?me.setTexture3D(Q,0):Q.isDataArrayTexture||Q.isCompressedArrayTexture?me.setTexture2DArray(Q,0):me.setTexture2D(Q,0),se.unbindTexture()},this.resetState=function(){_=0,S=0,A=null,se.reset(),Ve.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: the property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Jt?mo:eB}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===mo?Jt:Ya}}class d7 extends dB{}d7.prototype.isWebGL1Renderer=!0;class HM{constructor(e,n=25e-5){this.isFogExp2=!0,this.name="",this.color=new st(e),this.density=n}clone(){return new HM(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class VM{constructor(e,n=1,i=1e3){this.isFog=!0,this.name="",this.color=new st(e),this.near=n,this.far=i}clone(){return new VM(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class uA extends mn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class $x{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=cx,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=go()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,i){e*=this.stride,i*=n.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=n.array[i+r];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=go()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(n,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=go()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const ts=new ae;class kh{constructor(e,n,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,i=this.data.count;n<i;n++)ts.fromBufferAttribute(this,n),ts.applyMatrix4(e),this.setXYZ(n,ts.x,ts.y,ts.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)ts.fromBufferAttribute(this,n),ts.applyNormalMatrix(e),this.setXYZ(n,ts.x,ts.y,ts.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)ts.fromBufferAttribute(this,n),ts.transformDirection(e),this.setXYZ(n,ts.x,ts.y,ts.z);return this}setX(e,n){return this.normalized&&(n=nn(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=nn(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=nn(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=nn(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=ro(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=ro(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=ro(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=ro(n,this.array)),n}setXY(e,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(n=nn(n,this.array),i=nn(i,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this}setXYZ(e,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(n=nn(n,this.array),i=nn(i,this.array),r=nn(r,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(n=nn(n,this.array),i=nn(i,this.array),r=nn(r,this.array),s=nn(s,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return new bn(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new kh(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class fB extends Hi{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new st(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Tp;const $v=new ae,Pp=new ae,Dp=new ae,Rp=new Ye,e0=new Ye,f7=new kt,fw=new ae,t0=new ae,pw=new ae,Tz=new Ye,GT=new Ye,Pz=new Ye;class p7 extends mn{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",Tp===void 0){Tp=new Kt;const n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new $x(n,5);Tp.setIndex([0,1,2,0,2,3]),Tp.setAttribute("position",new kh(i,3,0,!1)),Tp.setAttribute("uv",new kh(i,2,3,!1))}this.geometry=Tp,this.material=e!==void 0?e:new fB,this.center=new Ye(.5,.5)}raycast(e,n){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Pp.setFromMatrixScale(this.matrixWorld),f7.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Dp.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Pp.multiplyScalar(-Dp.z);const i=this.material.rotation;let r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;mw(fw.set(-.5,-.5,0),Dp,o,Pp,r,s),mw(t0.set(.5,-.5,0),Dp,o,Pp,r,s),mw(pw.set(.5,.5,0),Dp,o,Pp,r,s),Tz.set(0,0),GT.set(1,0),Pz.set(1,1);let a=e.ray.intersectTriangle(fw,t0,pw,!1,$v);if(a===null&&(mw(t0.set(-.5,.5,0),Dp,o,Pp,r,s),GT.set(0,1),a=e.ray.intersectTriangle(fw,pw,t0,!1,$v),a===null))return;const l=e.ray.origin.distanceTo($v);l<e.near||l>e.far||n.push({distance:l,point:$v.clone(),uv:Ms.getInterpolation($v,fw,t0,pw,Tz,GT,Pz,new Ye),face:null,object:this})}copy(e,n){return super.copy(e,n),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function mw(t,e,n,i,r,s){Rp.subVectors(t,n).addScalar(.5).multiply(i),r!==void 0?(e0.x=s*Rp.x-r*Rp.y,e0.y=r*Rp.x+s*Rp.y):e0.copy(Rp),t.copy(e),t.x+=e0.x,t.y+=e0.y,t.applyMatrix4(f7)}const gw=new ae,Dz=new ae;class m7 extends mn{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const n=e.levels;for(let i=0,r=n.length;i<r;i++){const s=n[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,n=0,i=0){n=Math.abs(n);const r=this.levels;let s;for(s=0;s<r.length&&!(n<r[s].distance);s++);return r.splice(s,0,{distance:n,hysteresis:i,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const n=this.levels;if(n.length>0){let i,r;for(i=1,r=n.length;i<r;i++){let s=n[i].distance;if(n[i].object.visible&&(s-=s*n[i].hysteresis),e<s)break}return n[i-1].object}return null}raycast(e,n){if(this.levels.length>0){gw.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(gw);this.getObjectForDistance(r).raycast(e,n)}}update(e){const n=this.levels;if(n.length>1){gw.setFromMatrixPosition(e.matrixWorld),Dz.setFromMatrixPosition(this.matrixWorld);const i=gw.distanceTo(Dz)/e.zoom;n[0].object.visible=!0;let r,s;for(r=1,s=n.length;r<s;r++){let o=n[r].distance;if(n[r].object.visible&&(o-=o*n[r].hysteresis),i>=o)n[r-1].object.visible=!1,n[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)n[r].object.visible=!1}}toJSON(e){const n=super.toJSON(e);this.autoUpdate===!1&&(n.object.autoUpdate=!1),n.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const o=i[r];n.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return n}}const Rz=new ae,Lz=new Dn,Iz=new Dn,Wce=new ae,Bz=new kt,Lp=new ae;class pB extends gr{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new kt,this.bindMatrixInverse=new kt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new $a),this.boundingBox.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)Lp.fromBufferAttribute(n,i),this.applyBoneTransform(i,Lp),this.boundingBox.expandByPoint(Lp)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new el),this.boundingSphere.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)Lp.fromBufferAttribute(n,i),this.applyBoneTransform(i,Lp),this.boundingSphere.expandByPoint(Lp)}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}getVertexPosition(e,n){return super.getVertexPosition(e,n),this.applyBoneTransform(e,n),n}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Dn,n=this.geometry.attributes.skinWeight;for(let i=0,r=n.count;i<r;i++){e.fromBufferAttribute(n,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),n.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,n){const i=this.skeleton,r=this.geometry;Lz.fromBufferAttribute(r.attributes.skinIndex,e),Iz.fromBufferAttribute(r.attributes.skinWeight,e),Rz.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let s=0;s<4;s++){const o=Iz.getComponent(s);if(o!==0){const a=Lz.getComponent(s);Bz.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),n.addScaledVector(Wce.copy(Rz).applyMatrix4(Bz),o)}}return n.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,n){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,n)}}class jM extends mn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class ng extends ni{constructor(e=null,n=1,i=1,r,s,o,a,l,c=vi,h=vi,u,d){super(null,o,a,l,c,h,r,s,u,d),this.isDataTexture=!0,this.image={data:e,width:n,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const Oz=new kt,Xce=new kt;class e1{constructor(e=[],n=[]){this.uuid=go(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new kt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){const i=new kt;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,n=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:Xce;Oz.multiplyMatrices(a,n[s]),Oz.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new e1(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=JX(e),e=Math.max(e,4);const n=new Float32Array(e*e*4);n.set(this.boneMatrices);const i=new ng(n,e,e,Es,Uc);return i.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let n=0,i=this.bones.length;n<i;n++){const r=this.bones[n];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=n[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new jM),this.bones.push(o),this.boneInverses.push(new kt().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const n=this.bones,i=this.boneInverses;for(let r=0,s=n.length;r<s;r++){const o=n[r];e.bones.push(o.uuid);const a=i[r];e.boneInverses.push(a.toArray())}return e}}class Dg extends bn{constructor(e,n,i,r=1){super(e,n,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Ip=new kt,Fz=new kt,vw=[],Nz=new $a,Yce=new kt,n0=new gr,i0=new el;class mB extends gr{constructor(e,n,i){super(e,n),this.isInstancedMesh=!0,this.instanceMatrix=new Dg(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,Yce)}computeBoundingBox(){const e=this.geometry,n=this.count;this.boundingBox===null&&(this.boundingBox=new $a),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,Ip),Nz.copy(e.boundingBox).applyMatrix4(Ip),this.boundingBox.union(Nz)}computeBoundingSphere(){const e=this.geometry,n=this.count;this.boundingSphere===null&&(this.boundingSphere=new el),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,Ip),i0.copy(e.boundingSphere).applyMatrix4(Ip),this.boundingSphere.union(i0)}copy(e,n){return super.copy(e,n),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,n){n.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,n){n.fromArray(this.instanceMatrix.array,e*16)}raycast(e,n){const i=this.matrixWorld,r=this.count;if(n0.geometry=this.geometry,n0.material=this.material,n0.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),i0.copy(this.boundingSphere),i0.applyMatrix4(i),e.ray.intersectsSphere(i0)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,Ip),Fz.multiplyMatrices(i,Ip),n0.matrixWorld=Fz,n0.raycast(e,vw);for(let o=0,a=vw.length;o<a;o++){const l=vw[o];l.instanceId=s,l.object=this,n.push(l)}vw.length=0}}setColorAt(e,n){this.instanceColor===null&&(this.instanceColor=new Dg(new Float32Array(this.instanceMatrix.count*3),3)),n.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,n){n.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class Jr extends Hi{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new st(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Uz=new ae,kz=new ae,zz=new kt,HT=new Qx,yw=new el;class nu extends mn{constructor(e=new Kt,n=new Jr){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[0];for(let r=1,s=n.count;r<s;r++)Uz.fromBufferAttribute(n,r-1),kz.fromBufferAttribute(n,r),i[r]=i[r-1],i[r]+=Uz.distanceTo(kz);e.setAttribute("lineDistance",new xt(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),yw.copy(i.boundingSphere),yw.applyMatrix4(r),yw.radius+=s,e.ray.intersectsSphere(yw)===!1)return;zz.copy(r).invert(),HT.copy(e.ray).applyMatrix4(zz);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=new ae,h=new ae,u=new ae,d=new ae,f=this.isLineSegments?2:1,p=i.index,g=i.attributes.position;if(p!==null){const m=Math.max(0,o.start),y=Math.min(p.count,o.start+o.count);for(let _=m,S=y-1;_<S;_+=f){const A=p.getX(_),b=p.getX(_+1);if(c.fromBufferAttribute(g,A),h.fromBufferAttribute(g,b),HT.distanceSqToSegment(c,h,d,u)>l)continue;d.applyMatrix4(this.matrixWorld);const M=e.ray.origin.distanceTo(d);M<e.near||M>e.far||n.push({distance:M,point:u.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}else{const m=Math.max(0,o.start),y=Math.min(g.count,o.start+o.count);for(let _=m,S=y-1;_<S;_+=f){if(c.fromBufferAttribute(g,_),h.fromBufferAttribute(g,_+1),HT.distanceSqToSegment(c,h,d,u)>l)continue;d.applyMatrix4(this.matrixWorld);const b=e.ray.origin.distanceTo(d);b<e.near||b>e.far||n.push({distance:b,point:u.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const Gz=new ae,Hz=new ae;class tl extends nu{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[];for(let r=0,s=n.count;r<s;r+=2)Gz.fromBufferAttribute(n,r),Hz.fromBufferAttribute(n,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+Gz.distanceTo(Hz);e.setAttribute("lineDistance",new xt(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class gB extends nu{constructor(e,n){super(e,n),this.isLineLoop=!0,this.type="LineLoop"}}class t1 extends Hi{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new st(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const Vz=new kt,XR=new Qx,xw=new el,_w=new ae;let vB=class extends mn{constructor(e=new Kt,n=new t1){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=e.material,this.geometry=e.geometry,this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),xw.copy(i.boundingSphere),xw.applyMatrix4(r),xw.radius+=s,e.ray.intersectsSphere(xw)===!1)return;Vz.copy(r).invert(),XR.copy(e.ray).applyMatrix4(Vz);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=a*a,c=i.index,u=i.attributes.position;if(c!==null){const d=Math.max(0,o.start),f=Math.min(c.count,o.start+o.count);for(let p=d,v=f;p<v;p++){const g=c.getX(p);_w.fromBufferAttribute(u,g),jz(_w,g,l,r,e,n,this)}}else{const d=Math.max(0,o.start),f=Math.min(u.count,o.start+o.count);for(let p=d,v=f;p<v;p++)_w.fromBufferAttribute(u,p),jz(_w,p,l,r,e,n,this)}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}};function jz(t,e,n,i,r,s,o){const a=XR.distanceSqToPoint(t);if(a<n){const l=new ae;XR.closestPointToPoint(t,l),l.applyMatrix4(i);const c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;s.push({distance:c,distanceToRay:Math.sqrt(a),point:l,index:e,face:null,object:o})}}class qce extends ni{constructor(e,n,i,r,s,o,a,l,c){super(e,n,i,r,s,o,a,l,c),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:oi,this.magFilter=s!==void 0?s:oi,this.generateMipmaps=!1;const h=this;function u(){h.needsUpdate=!0,e.requestVideoFrameCallback(u)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(u)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class Qce extends ni{constructor(e,n,i){super({width:e,height:n}),this.isFramebufferTexture=!0,this.format=i,this.magFilter=vi,this.minFilter=vi,this.generateMipmaps=!1,this.needsUpdate=!0}}class yB extends ni{constructor(e,n,i,r,s,o,a,l,c,h,u,d){super(null,o,a,l,c,h,r,s,u,d),this.isCompressedTexture=!0,this.image={width:n,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class Kce extends yB{constructor(e,n,i,r,s,o){super(e,n,i,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=Cr}}class Jce extends ni{constructor(e,n,i,r,s,o,a,l,c){super(e,n,i,r,s,o,a,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class nl{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,n){const i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,r=this.getPoint(0),s=0;n.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),n.push(s),r=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n){const i=this.getLengths();let r=0;const s=i.length;let o;n?o=n:o=e*i[s-1];let a=0,l=s-1,c;for(;a<=l;)if(r=Math.floor(a+(l-a)/2),c=i[r]-o,c<0)a=r+1;else if(c>0)l=r-1;else{l=r;break}if(r=l,i[r]===o)return r/(s-1);const h=i[r],d=i[r+1]-h,f=(o-h)/d;return(r+f)/(s-1)}getTangent(e,n){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),l=n||(o.isVector2?new Ye:new ae);return l.copy(a).sub(o).normalize(),l}getTangentAt(e,n){const i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n){const i=new ae,r=[],s=[],o=[],a=new ae,l=new kt;for(let f=0;f<=e;f++){const p=f/e;r[f]=this.getTangentAt(p,new ae)}s[0]=new ae,o[0]=new ae;let c=Number.MAX_VALUE;const h=Math.abs(r[0].x),u=Math.abs(r[0].y),d=Math.abs(r[0].z);h<=c&&(c=h,i.set(1,0,0)),u<=c&&(c=u,i.set(0,1,0)),d<=c&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),o[f]=o[f-1].clone(),a.crossVectors(r[f-1],r[f]),a.length()>Number.EPSILON){a.normalize();const p=Math.acos(yi(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(l.makeRotationAxis(a,p))}o[f].crossVectors(r[f],s[f])}if(n===!0){let f=Math.acos(yi(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(f=-f);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(r[p],f*p)),o[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class WM extends nl{constructor(e=0,n=0,i=1,r=1,s=0,o=Math.PI*2,a=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=l}getPoint(e,n){const i=n||new Ye,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(a),c=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const h=Math.cos(this.aRotation),u=Math.sin(this.aRotation),d=l-this.aX,f=c-this.aY;l=d*h-f*u+this.aX,c=d*u+f*h+this.aY}return i.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class g7 extends WM{constructor(e,n,i,r,s,o){super(e,n,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function xB(){let t=0,e=0,n=0,i=0;function r(s,o,a,l){t=s,e=a,n=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,h,u){let d=(o-s)/c-(a-s)/(c+h)+(a-o)/h,f=(a-o)/h-(l-o)/(h+u)+(l-a)/u;d*=h,f*=h,r(o,a,d,f)},calc:function(s){const o=s*s,a=o*s;return t+e*s+n*o+i*a}}}const ww=new ae,VT=new xB,jT=new xB,WT=new xB;class v7 extends nl{constructor(e=[],n=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=i,this.tension=r}getPoint(e,n=new ae){const i=n,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),l=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:l===0&&a===s-1&&(a=s-2,l=1);let c,h;this.closed||a>0?c=r[(a-1)%s]:(ww.subVectors(r[0],r[1]).add(r[0]),c=ww);const u=r[a%s],d=r[(a+1)%s];if(this.closed||a+2<s?h=r[(a+2)%s]:(ww.subVectors(r[s-1],r[s-2]).add(r[s-1]),h=ww),this.curveType==="centripetal"||this.curveType==="chordal"){const f=this.curveType==="chordal"?.5:.25;let p=Math.pow(c.distanceToSquared(u),f),v=Math.pow(u.distanceToSquared(d),f),g=Math.pow(d.distanceToSquared(h),f);v<1e-4&&(v=1),p<1e-4&&(p=v),g<1e-4&&(g=v),VT.initNonuniformCatmullRom(c.x,u.x,d.x,h.x,p,v,g),jT.initNonuniformCatmullRom(c.y,u.y,d.y,h.y,p,v,g),WT.initNonuniformCatmullRom(c.z,u.z,d.z,h.z,p,v,g)}else this.curveType==="catmullrom"&&(VT.initCatmullRom(c.x,u.x,d.x,h.x,this.tension),jT.initCatmullRom(c.y,u.y,d.y,h.y,this.tension),WT.initCatmullRom(c.z,u.z,d.z,h.z,this.tension));return i.set(VT.calc(l),jT.calc(l),WT.calc(l)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new ae().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Wz(t,e,n,i,r){const s=(i-e)*.5,o=(r-n)*.5,a=t*t,l=t*a;return(2*n-2*i+s+o)*l+(-3*n+3*i-2*s-o)*a+s*t+n}function Zce(t,e){const n=1-t;return n*n*e}function $ce(t,e){return 2*(1-t)*t*e}function eue(t,e){return t*t*e}function vy(t,e,n,i){return Zce(t,e)+$ce(t,n)+eue(t,i)}function tue(t,e){const n=1-t;return n*n*n*e}function nue(t,e){const n=1-t;return 3*n*n*t*e}function iue(t,e){return 3*(1-t)*t*t*e}function rue(t,e){return t*t*t*e}function yy(t,e,n,i,r){return tue(t,e)+nue(t,n)+iue(t,i)+rue(t,r)}class _B extends nl{constructor(e=new Ye,n=new Ye,i=new Ye,r=new Ye){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new Ye){const i=n,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(yy(e,r.x,s.x,o.x,a.x),yy(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class y7 extends nl{constructor(e=new ae,n=new ae,i=new ae,r=new ae){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new ae){const i=n,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(yy(e,r.x,s.x,o.x,a.x),yy(e,r.y,s.y,o.y,a.y),yy(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class XM extends nl{constructor(e=new Ye,n=new Ye){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new Ye){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new Ye){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class x7 extends nl{constructor(e=new ae,n=new ae){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new ae){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new ae){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class wB extends nl{constructor(e=new Ye,n=new Ye,i=new Ye){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new Ye){const i=n,r=this.v0,s=this.v1,o=this.v2;return i.set(vy(e,r.x,s.x,o.x),vy(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class SB extends nl{constructor(e=new ae,n=new ae,i=new ae){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new ae){const i=n,r=this.v0,s=this.v1,o=this.v2;return i.set(vy(e,r.x,s.x,o.x),vy(e,r.y,s.y,o.y),vy(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class bB extends nl{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new Ye){const i=n,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,l=r[o===0?o:o-1],c=r[o],h=r[o>r.length-2?r.length-1:o+1],u=r[o>r.length-3?r.length-1:o+2];return i.set(Wz(a,l.x,c.x,h.x,u.x),Wz(a,l.y,c.y,h.y,u.y)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new Ye().fromArray(r))}return this}}var AB=Object.freeze({__proto__:null,ArcCurve:g7,CatmullRomCurve3:v7,CubicBezierCurve:_B,CubicBezierCurve3:y7,EllipseCurve:WM,LineCurve:XM,LineCurve3:x7,QuadraticBezierCurve:wB,QuadraticBezierCurve3:SB,SplineCurve:bB});class _7 extends nl{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);e.equals(n)||this.curves.push(new XM(n,e))}getPoint(e,n){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],l=a.getLength(),c=l===0?0:1-o/l;return a.getPointAt(c,n)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let n=0;for(let i=0,r=this.curves.length;i<r;i++)n+=this.curves[i].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){const n=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,l=o.getPoints(a);for(let c=0;c<l.length;c++){const h=l[c];i&&i.equals(h)||(n.push(h),i=h)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,i=this.curves.length;n<i;n++){const r=this.curves[n];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(new AB[r.type]().fromJSON(r))}return this}}class hx extends _7{constructor(e){super(),this.type="Path",this.currentPoint=new Ye,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,i=e.length;n<i;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){const i=new XM(this.currentPoint.clone(),new Ye(e,n));return this.curves.push(i),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,i,r){const s=new wB(this.currentPoint.clone(),new Ye(e,n),new Ye(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,n,i,r,s,o){const a=new _B(this.currentPoint.clone(),new Ye(e,n),new Ye(i,r),new Ye(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const n=[this.currentPoint.clone()].concat(e),i=new bB(n);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,i,r,s,o){const a=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+a,n+l,i,r,s,o),this}absarc(e,n,i,r,s,o){return this.absellipse(e,n,i,i,r,s,o),this}ellipse(e,n,i,r,s,o,a,l){const c=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(e+c,n+h,i,r,s,o,a,l),this}absellipse(e,n,i,r,s,o,a,l){const c=new WM(e,n,i,r,s,o,a,l);if(this.curves.length>0){const u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);const h=c.getPoint(1);return this.currentPoint.copy(h),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class sv extends Kt{constructor(e=[new Ye(0,-.5),new Ye(.5,0),new Ye(0,.5)],n=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:i,phiLength:r},n=Math.floor(n),r=yi(r,0,Math.PI*2);const s=[],o=[],a=[],l=[],c=[],h=1/n,u=new ae,d=new Ye,f=new ae,p=new ae,v=new ae;let g=0,m=0;for(let y=0;y<=e.length-1;y++)switch(y){case 0:g=e[y+1].x-e[y].x,m=e[y+1].y-e[y].y,f.x=m*1,f.y=-g,f.z=m*0,v.copy(f),f.normalize(),l.push(f.x,f.y,f.z);break;case e.length-1:l.push(v.x,v.y,v.z);break;default:g=e[y+1].x-e[y].x,m=e[y+1].y-e[y].y,f.x=m*1,f.y=-g,f.z=m*0,p.copy(f),f.x+=v.x,f.y+=v.y,f.z+=v.z,f.normalize(),l.push(f.x,f.y,f.z),v.copy(p)}for(let y=0;y<=n;y++){const _=i+y*h*r,S=Math.sin(_),A=Math.cos(_);for(let b=0;b<=e.length-1;b++){u.x=e[b].x*S,u.y=e[b].y,u.z=e[b].x*A,o.push(u.x,u.y,u.z),d.x=y/n,d.y=b/(e.length-1),a.push(d.x,d.y);const T=l[3*b+0]*S,M=l[3*b+1],E=l[3*b+0]*A;c.push(T,M,E)}}for(let y=0;y<n;y++)for(let _=0;_<e.length-1;_++){const S=_+y*e.length,A=S,b=S+e.length,T=S+e.length+1,M=S+1;s.push(A,b,M),s.push(T,M,b)}this.setIndex(s),this.setAttribute("position",new xt(o,3)),this.setAttribute("uv",new xt(a,2)),this.setAttribute("normal",new xt(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sv(e.points,e.segments,e.phiStart,e.phiLength)}}class n1 extends sv{constructor(e=1,n=1,i=4,r=8){const s=new hx;s.absarc(0,-n/2,e,Math.PI*1.5,0),s.absarc(0,n/2,e,0,Math.PI*.5),super(s.getPoints(i),r),this.type="CapsuleGeometry",this.parameters={radius:e,height:n,capSegments:i,radialSegments:r}}static fromJSON(e){return new n1(e.radius,e.length,e.capSegments,e.radialSegments)}}class i1 extends Kt{constructor(e=1,n=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:i,thetaLength:r},n=Math.max(3,n);const s=[],o=[],a=[],l=[],c=new ae,h=new Ye;o.push(0,0,0),a.push(0,0,1),l.push(.5,.5);for(let u=0,d=3;u<=n;u++,d+=3){const f=i+u/n*r;c.x=e*Math.cos(f),c.y=e*Math.sin(f),o.push(c.x,c.y,c.z),a.push(0,0,1),h.x=(o[d]/e+1)/2,h.y=(o[d+1]/e+1)/2,l.push(h.x,h.y)}for(let u=1;u<=n;u++)s.push(u,u+1,0);this.setIndex(s),this.setAttribute("position",new xt(o,3)),this.setAttribute("normal",new xt(a,3)),this.setAttribute("uv",new xt(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new i1(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class zf extends Kt{constructor(e=1,n=1,i=1,r=32,s=1,o=!1,a=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l};const c=this;r=Math.floor(r),s=Math.floor(s);const h=[],u=[],d=[],f=[];let p=0;const v=[],g=i/2;let m=0;y(),o===!1&&(e>0&&_(!0),n>0&&_(!1)),this.setIndex(h),this.setAttribute("position",new xt(u,3)),this.setAttribute("normal",new xt(d,3)),this.setAttribute("uv",new xt(f,2));function y(){const S=new ae,A=new ae;let b=0;const T=(n-e)/i;for(let M=0;M<=s;M++){const E=[],P=M/s,R=P*(n-e)+e;for(let F=0;F<=r;F++){const B=F/r,k=B*l+a,j=Math.sin(k),Z=Math.cos(k);A.x=R*j,A.y=-P*i+g,A.z=R*Z,u.push(A.x,A.y,A.z),S.set(j,T,Z).normalize(),d.push(S.x,S.y,S.z),f.push(B,1-P),E.push(p++)}v.push(E)}for(let M=0;M<r;M++)for(let E=0;E<s;E++){const P=v[E][M],R=v[E+1][M],F=v[E+1][M+1],B=v[E][M+1];h.push(P,R,B),h.push(R,F,B),b+=6}c.addGroup(m,b,0),m+=b}function _(S){const A=p,b=new Ye,T=new ae;let M=0;const E=S===!0?e:n,P=S===!0?1:-1;for(let F=1;F<=r;F++)u.push(0,g*P,0),d.push(0,P,0),f.push(.5,.5),p++;const R=p;for(let F=0;F<=r;F++){const k=F/r*l+a,j=Math.cos(k),Z=Math.sin(k);T.x=E*Z,T.y=g*P,T.z=E*j,u.push(T.x,T.y,T.z),d.push(0,P,0),b.x=j*.5+.5,b.y=Z*.5*P+.5,f.push(b.x,b.y),p++}for(let F=0;F<r;F++){const B=A+F,k=R+F;S===!0?h.push(k,k+1,B):h.push(k+1,k,B),M+=3}c.addGroup(m,M,S===!0?1:2),m+=M}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new zf(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class r1 extends zf{constructor(e=1,n=1,i=32,r=1,s=!1,o=0,a=Math.PI*2){super(0,e,n,i,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new r1(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class cu extends Kt{constructor(e=[],n=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:i,detail:r};const s=[],o=[];a(r),c(i),h(),this.setAttribute("position",new xt(s,3)),this.setAttribute("normal",new xt(s.slice(),3)),this.setAttribute("uv",new xt(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(y){const _=new ae,S=new ae,A=new ae;for(let b=0;b<n.length;b+=3)f(n[b+0],_),f(n[b+1],S),f(n[b+2],A),l(_,S,A,y)}function l(y,_,S,A){const b=A+1,T=[];for(let M=0;M<=b;M++){T[M]=[];const E=y.clone().lerp(S,M/b),P=_.clone().lerp(S,M/b),R=b-M;for(let F=0;F<=R;F++)F===0&&M===b?T[M][F]=E:T[M][F]=E.clone().lerp(P,F/R)}for(let M=0;M<b;M++)for(let E=0;E<2*(b-M)-1;E++){const P=Math.floor(E/2);E%2===0?(d(T[M][P+1]),d(T[M+1][P]),d(T[M][P])):(d(T[M][P+1]),d(T[M+1][P+1]),d(T[M+1][P]))}}function c(y){const _=new ae;for(let S=0;S<s.length;S+=3)_.x=s[S+0],_.y=s[S+1],_.z=s[S+2],_.normalize().multiplyScalar(y),s[S+0]=_.x,s[S+1]=_.y,s[S+2]=_.z}function h(){const y=new ae;for(let _=0;_<s.length;_+=3){y.x=s[_+0],y.y=s[_+1],y.z=s[_+2];const S=g(y)/2/Math.PI+.5,A=m(y)/Math.PI+.5;o.push(S,1-A)}p(),u()}function u(){for(let y=0;y<o.length;y+=6){const _=o[y+0],S=o[y+2],A=o[y+4],b=Math.max(_,S,A),T=Math.min(_,S,A);b>.9&&T<.1&&(_<.2&&(o[y+0]+=1),S<.2&&(o[y+2]+=1),A<.2&&(o[y+4]+=1))}}function d(y){s.push(y.x,y.y,y.z)}function f(y,_){const S=y*3;_.x=e[S+0],_.y=e[S+1],_.z=e[S+2]}function p(){const y=new ae,_=new ae,S=new ae,A=new ae,b=new Ye,T=new Ye,M=new Ye;for(let E=0,P=0;E<s.length;E+=9,P+=6){y.set(s[E+0],s[E+1],s[E+2]),_.set(s[E+3],s[E+4],s[E+5]),S.set(s[E+6],s[E+7],s[E+8]),b.set(o[P+0],o[P+1]),T.set(o[P+2],o[P+3]),M.set(o[P+4],o[P+5]),A.copy(y).add(_).add(S).divideScalar(3);const R=g(A);v(b,P+0,y,R),v(T,P+2,_,R),v(M,P+4,S,R)}}function v(y,_,S,A){A<0&&y.x===1&&(o[_]=y.x-1),S.x===0&&S.z===0&&(o[_]=A/2/Math.PI+.5)}function g(y){return Math.atan2(y.z,-y.x)}function m(y){return Math.atan2(-y.y,Math.sqrt(y.x*y.x+y.z*y.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new cu(e.vertices,e.indices,e.radius,e.details)}}class s1 extends cu{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,n),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new s1(e.radius,e.detail)}}const Sw=new ae,bw=new ae,XT=new ae,Aw=new Ms;class w7 extends Kt{constructor(e=null,n=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:n},e!==null){const r=Math.pow(10,4),s=Math.cos(uf*n),o=e.getIndex(),a=e.getAttribute("position"),l=o?o.count:a.count,c=[0,0,0],h=["a","b","c"],u=new Array(3),d={},f=[];for(let p=0;p<l;p+=3){o?(c[0]=o.getX(p),c[1]=o.getX(p+1),c[2]=o.getX(p+2)):(c[0]=p,c[1]=p+1,c[2]=p+2);const{a:v,b:g,c:m}=Aw;if(v.fromBufferAttribute(a,c[0]),g.fromBufferAttribute(a,c[1]),m.fromBufferAttribute(a,c[2]),Aw.getNormal(XT),u[0]=`${Math.round(v.x*r)},${Math.round(v.y*r)},${Math.round(v.z*r)}`,u[1]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,u[2]=`${Math.round(m.x*r)},${Math.round(m.y*r)},${Math.round(m.z*r)}`,!(u[0]===u[1]||u[1]===u[2]||u[2]===u[0]))for(let y=0;y<3;y++){const _=(y+1)%3,S=u[y],A=u[_],b=Aw[h[y]],T=Aw[h[_]],M=`${S}_${A}`,E=`${A}_${S}`;E in d&&d[E]?(XT.dot(d[E].normal)<=s&&(f.push(b.x,b.y,b.z),f.push(T.x,T.y,T.z)),d[E]=null):M in d||(d[M]={index0:c[y],index1:c[_],normal:XT.clone()})}}for(const p in d)if(d[p]){const{index0:v,index1:g}=d[p];Sw.fromBufferAttribute(a,v),bw.fromBufferAttribute(a,g),f.push(Sw.x,Sw.y,Sw.z),f.push(bw.x,bw.y,bw.z)}this.setAttribute("position",new xt(f,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class df extends hx{constructor(e){super(e),this.uuid=go(),this.type="Shape",this.holes=[]}getPointsHoles(e){const n=[];for(let i=0,r=this.holes.length;i<r;i++)n[i]=this.holes[i].getPoints(e);return n}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,i=this.holes.length;n<i;n++){const r=this.holes[n];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(new hx().fromJSON(r))}return this}}const sue={triangulate:function(t,e,n=2){const i=e&&e.length,r=i?e[0]*n:t.length;let s=S7(t,0,r,n,!0);const o=[];if(!s||s.next===s.prev)return o;let a,l,c,h,u,d,f;if(i&&(s=uue(t,e,s,n)),t.length>80*n){a=c=t[0],l=h=t[1];for(let p=n;p<r;p+=n)u=t[p],d=t[p+1],u<a&&(a=u),d<l&&(l=d),u>c&&(c=u),d>h&&(h=d);f=Math.max(c-a,h-l),f=f!==0?32767/f:0}return dx(s,o,n,a,l,f,0),o}};function S7(t,e,n,i,r){let s,o;if(r===wue(t,e,n,i)>0)for(s=e;s<n;s+=i)o=Xz(s,t[s],t[s+1],o);else for(s=n-i;s>=e;s-=i)o=Xz(s,t[s],t[s+1],o);return o&&YM(o,o.next)&&(px(o),o=o.next),o}function Tf(t,e){if(!t)return t;e||(e=t);let n=t,i;do if(i=!1,!n.steiner&&(YM(n,n.next)||ai(n.prev,n,n.next)===0)){if(px(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function dx(t,e,n,i,r,s,o){if(!t)return;!o&&s&&mue(t,i,r,s);let a=t,l,c;for(;t.prev!==t.next;){if(l=t.prev,c=t.next,s?aue(t,i,r,s):oue(t)){e.push(l.i/n|0),e.push(t.i/n|0),e.push(c.i/n|0),px(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=lue(Tf(t),e,n),dx(t,e,n,i,r,s,2)):o===2&&cue(t,e,n,i,r,s):dx(Tf(t),e,n,i,r,s,1);break}}}function oue(t){const e=t.prev,n=t,i=t.next;if(ai(e,n,i)>=0)return!1;const r=e.x,s=n.x,o=i.x,a=e.y,l=n.y,c=i.y,h=r<s?r<o?r:o:s<o?s:o,u=a<l?a<c?a:c:l<c?l:c,d=r>s?r>o?r:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c;let p=i.next;for(;p!==e;){if(p.x>=h&&p.x<=d&&p.y>=u&&p.y<=f&&Lm(r,a,s,l,o,c,p.x,p.y)&&ai(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function aue(t,e,n,i){const r=t.prev,s=t,o=t.next;if(ai(r,s,o)>=0)return!1;const a=r.x,l=s.x,c=o.x,h=r.y,u=s.y,d=o.y,f=a<l?a<c?a:c:l<c?l:c,p=h<u?h<d?h:d:u<d?u:d,v=a>l?a>c?a:c:l>c?l:c,g=h>u?h>d?h:d:u>d?u:d,m=YR(f,p,e,n,i),y=YR(v,g,e,n,i);let _=t.prevZ,S=t.nextZ;for(;_&&_.z>=m&&S&&S.z<=y;){if(_.x>=f&&_.x<=v&&_.y>=p&&_.y<=g&&_!==r&&_!==o&&Lm(a,h,l,u,c,d,_.x,_.y)&&ai(_.prev,_,_.next)>=0||(_=_.prevZ,S.x>=f&&S.x<=v&&S.y>=p&&S.y<=g&&S!==r&&S!==o&&Lm(a,h,l,u,c,d,S.x,S.y)&&ai(S.prev,S,S.next)>=0))return!1;S=S.nextZ}for(;_&&_.z>=m;){if(_.x>=f&&_.x<=v&&_.y>=p&&_.y<=g&&_!==r&&_!==o&&Lm(a,h,l,u,c,d,_.x,_.y)&&ai(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;S&&S.z<=y;){if(S.x>=f&&S.x<=v&&S.y>=p&&S.y<=g&&S!==r&&S!==o&&Lm(a,h,l,u,c,d,S.x,S.y)&&ai(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function lue(t,e,n){let i=t;do{const r=i.prev,s=i.next.next;!YM(r,s)&&b7(r,i,i.next,s)&&fx(r,s)&&fx(s,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(s.i/n|0),px(i),px(i.next),i=t=s),i=i.next}while(i!==t);return Tf(i)}function cue(t,e,n,i,r,s){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&yue(o,a)){let l=A7(o,a);o=Tf(o,o.next),l=Tf(l,l.next),dx(o,e,n,i,r,s,0),dx(l,e,n,i,r,s,0);return}a=a.next}o=o.next}while(o!==t)}function uue(t,e,n,i){const r=[];let s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:t.length,c=S7(t,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(vue(c));for(r.sort(hue),s=0;s<r.length;s++)n=due(r[s],n);return n}function hue(t,e){return t.x-e.x}function due(t,e){const n=fue(t,e);if(!n)return e;const i=A7(n,t);return Tf(i,i.next),Tf(n,n.next)}function fue(t,e){let n=e,i=-1/0,r;const s=t.x,o=t.y;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){const d=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(d<=s&&d>i&&(i=d,r=n.x<n.next.x?n:n.next,d===s))return r}n=n.next}while(n!==e);if(!r)return null;const a=r,l=r.x,c=r.y;let h=1/0,u;n=r;do s>=n.x&&n.x>=l&&s!==n.x&&Lm(o<c?s:i,o,l,c,o<c?i:s,o,n.x,n.y)&&(u=Math.abs(o-n.y)/(s-n.x),fx(n,t)&&(u<h||u===h&&(n.x>r.x||n.x===r.x&&pue(r,n)))&&(r=n,h=u)),n=n.next;while(n!==a);return r}function pue(t,e){return ai(t.prev,t,e.prev)<0&&ai(e.next,t,t.next)<0}function mue(t,e,n,i){let r=t;do r.z===0&&(r.z=YR(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,gue(r)}function gue(t){let e,n,i,r,s,o,a,l,c=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,i=n,a=0,e=0;e<c&&(a++,i=i.nextZ,!!i);e++);for(l=c;a>0||l>0&&i;)a!==0&&(l===0||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,c*=2}while(o>1);return t}function YR(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function vue(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Lm(t,e,n,i,r,s,o,a){return(r-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(i-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(r-o)*(i-a)}function yue(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!xue(t,e)&&(fx(t,e)&&fx(e,t)&&_ue(t,e)&&(ai(t.prev,t,e.prev)||ai(t,e.prev,e))||YM(t,e)&&ai(t.prev,t,t.next)>0&&ai(e.prev,e,e.next)>0)}function ai(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function YM(t,e){return t.x===e.x&&t.y===e.y}function b7(t,e,n,i){const r=Ew(ai(t,e,n)),s=Ew(ai(t,e,i)),o=Ew(ai(n,i,t)),a=Ew(ai(n,i,e));return!!(r!==s&&o!==a||r===0&&Mw(t,n,e)||s===0&&Mw(t,i,e)||o===0&&Mw(n,t,i)||a===0&&Mw(n,e,i))}function Mw(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Ew(t){return t>0?1:t<0?-1:0}function xue(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&b7(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function fx(t,e){return ai(t.prev,t,t.next)<0?ai(t,e,t.next)>=0&&ai(t,t.prev,e)>=0:ai(t,e,t.prev)<0||ai(t,t.next,e)<0}function _ue(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function A7(t,e){const n=new qR(t.i,t.x,t.y),i=new qR(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function Xz(t,e,n,i){const r=new qR(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function px(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function qR(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function wue(t,e,n,i){let r=0;for(let s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}class Hl{static area(e){const n=e.length;let i=0;for(let r=n-1,s=0;s<n;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return Hl.area(e)<0}static triangulateShape(e,n){const i=[],r=[],s=[];Yz(e),qz(i,e);let o=e.length;n.forEach(Yz);for(let l=0;l<n.length;l++)r.push(o),o+=n[l].length,qz(i,n[l]);const a=sue.triangulate(i,r);for(let l=0;l<a.length;l+=3)s.push(a.slice(l,l+3));return s}}function Yz(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function qz(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class o1 extends Kt{constructor(e=new df([new Ye(.5,.5),new Ye(-.5,.5),new Ye(-.5,-.5),new Ye(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,l=e.length;a<l;a++){const c=e[a];o(c)}this.setAttribute("position",new xt(r,3)),this.setAttribute("uv",new xt(s,2)),this.computeVertexNormals();function o(a){const l=[],c=n.curveSegments!==void 0?n.curveSegments:12,h=n.steps!==void 0?n.steps:1,u=n.depth!==void 0?n.depth:1;let d=n.bevelEnabled!==void 0?n.bevelEnabled:!0,f=n.bevelThickness!==void 0?n.bevelThickness:.2,p=n.bevelSize!==void 0?n.bevelSize:f-.1,v=n.bevelOffset!==void 0?n.bevelOffset:0,g=n.bevelSegments!==void 0?n.bevelSegments:3;const m=n.extrudePath,y=n.UVGenerator!==void 0?n.UVGenerator:Sue;let _,S=!1,A,b,T,M;m&&(_=m.getSpacedPoints(h),S=!0,d=!1,A=m.computeFrenetFrames(h,!1),b=new ae,T=new ae,M=new ae),d||(g=0,f=0,p=0,v=0);const E=a.extractPoints(c);let P=E.shape;const R=E.holes;if(!Hl.isClockWise(P)){P=P.reverse();for(let ne=0,ie=R.length;ne<ie;ne++){const me=R[ne];Hl.isClockWise(me)&&(R[ne]=me.reverse())}}const B=Hl.triangulateShape(P,R),k=P;for(let ne=0,ie=R.length;ne<ie;ne++){const me=R[ne];P=P.concat(me)}function j(ne,ie,me){return ie||console.error("THREE.ExtrudeGeometry: vec does not exist"),ne.clone().addScaledVector(ie,me)}const Z=P.length,ee=B.length;function O(ne,ie,me){let xe,Ae,we;const Ee=ne.x-ie.x,Re=ne.y-ie.y,Ue=me.x-ne.x,Ne=me.y-ne.y,U=Ee*Ee+Re*Re,L=Ee*Ne-Re*Ue;if(Math.abs(L)>Number.EPSILON){const te=Math.sqrt(U),_e=Math.sqrt(Ue*Ue+Ne*Ne),Te=ie.x-Re/te,Ie=ie.y+Ee/te,Qe=me.x-Ne/_e,Ge=me.y+Ue/_e,ye=((Qe-Te)*Ne-(Ge-Ie)*Ue)/(Ee*Ne-Re*Ue);xe=Te+Ee*ye-ne.x,Ae=Ie+Re*ye-ne.y;const Ve=xe*xe+Ae*Ae;if(Ve<=2)return new Ye(xe,Ae);we=Math.sqrt(Ve/2)}else{let te=!1;Ee>Number.EPSILON?Ue>Number.EPSILON&&(te=!0):Ee<-Number.EPSILON?Ue<-Number.EPSILON&&(te=!0):Math.sign(Re)===Math.sign(Ne)&&(te=!0),te?(xe=-Re,Ae=Ee,we=Math.sqrt(U)):(xe=Ee,Ae=Re,we=Math.sqrt(U/2))}return new Ye(xe/we,Ae/we)}const W=[];for(let ne=0,ie=k.length,me=ie-1,xe=ne+1;ne<ie;ne++,me++,xe++)me===ie&&(me=0),xe===ie&&(xe=0),W[ne]=O(k[ne],k[me],k[xe]);const H=[];let Y,z=W.concat();for(let ne=0,ie=R.length;ne<ie;ne++){const me=R[ne];Y=[];for(let xe=0,Ae=me.length,we=Ae-1,Ee=xe+1;xe<Ae;xe++,we++,Ee++)we===Ae&&(we=0),Ee===Ae&&(Ee=0),Y[xe]=O(me[xe],me[we],me[Ee]);H.push(Y),z=z.concat(Y)}for(let ne=0;ne<g;ne++){const ie=ne/g,me=f*Math.cos(ie*Math.PI/2),xe=p*Math.sin(ie*Math.PI/2)+v;for(let Ae=0,we=k.length;Ae<we;Ae++){const Ee=j(k[Ae],W[Ae],xe);K(Ee.x,Ee.y,-me)}for(let Ae=0,we=R.length;Ae<we;Ae++){const Ee=R[Ae];Y=H[Ae];for(let Re=0,Ue=Ee.length;Re<Ue;Re++){const Ne=j(Ee[Re],Y[Re],xe);K(Ne.x,Ne.y,-me)}}}const X=p+v;for(let ne=0;ne<Z;ne++){const ie=d?j(P[ne],z[ne],X):P[ne];S?(T.copy(A.normals[0]).multiplyScalar(ie.x),b.copy(A.binormals[0]).multiplyScalar(ie.y),M.copy(_[0]).add(T).add(b),K(M.x,M.y,M.z)):K(ie.x,ie.y,0)}for(let ne=1;ne<=h;ne++)for(let ie=0;ie<Z;ie++){const me=d?j(P[ie],z[ie],X):P[ie];S?(T.copy(A.normals[ne]).multiplyScalar(me.x),b.copy(A.binormals[ne]).multiplyScalar(me.y),M.copy(_[ne]).add(T).add(b),K(M.x,M.y,M.z)):K(me.x,me.y,u/h*ne)}for(let ne=g-1;ne>=0;ne--){const ie=ne/g,me=f*Math.cos(ie*Math.PI/2),xe=p*Math.sin(ie*Math.PI/2)+v;for(let Ae=0,we=k.length;Ae<we;Ae++){const Ee=j(k[Ae],W[Ae],xe);K(Ee.x,Ee.y,u+me)}for(let Ae=0,we=R.length;Ae<we;Ae++){const Ee=R[Ae];Y=H[Ae];for(let Re=0,Ue=Ee.length;Re<Ue;Re++){const Ne=j(Ee[Re],Y[Re],xe);S?K(Ne.x,Ne.y+_[h-1].y,_[h-1].x+me):K(Ne.x,Ne.y,u+me)}}}q(),re();function q(){const ne=r.length/3;if(d){let ie=0,me=Z*ie;for(let xe=0;xe<ee;xe++){const Ae=B[xe];oe(Ae[2]+me,Ae[1]+me,Ae[0]+me)}ie=h+g*2,me=Z*ie;for(let xe=0;xe<ee;xe++){const Ae=B[xe];oe(Ae[0]+me,Ae[1]+me,Ae[2]+me)}}else{for(let ie=0;ie<ee;ie++){const me=B[ie];oe(me[2],me[1],me[0])}for(let ie=0;ie<ee;ie++){const me=B[ie];oe(me[0]+Z*h,me[1]+Z*h,me[2]+Z*h)}}i.addGroup(ne,r.length/3-ne,0)}function re(){const ne=r.length/3;let ie=0;G(k,ie),ie+=k.length;for(let me=0,xe=R.length;me<xe;me++){const Ae=R[me];G(Ae,ie),ie+=Ae.length}i.addGroup(ne,r.length/3-ne,1)}function G(ne,ie){let me=ne.length;for(;--me>=0;){const xe=me;let Ae=me-1;Ae<0&&(Ae=ne.length-1);for(let we=0,Ee=h+g*2;we<Ee;we++){const Re=Z*we,Ue=Z*(we+1),Ne=ie+xe+Re,U=ie+Ae+Re,L=ie+Ae+Ue,te=ie+xe+Ue;ve(Ne,U,L,te)}}}function K(ne,ie,me){l.push(ne),l.push(ie),l.push(me)}function oe(ne,ie,me){$(ne),$(ie),$(me);const xe=r.length/3,Ae=y.generateTopUV(i,r,xe-3,xe-2,xe-1);se(Ae[0]),se(Ae[1]),se(Ae[2])}function ve(ne,ie,me,xe){$(ne),$(ie),$(xe),$(ie),$(me),$(xe);const Ae=r.length/3,we=y.generateSideWallUV(i,r,Ae-6,Ae-3,Ae-2,Ae-1);se(we[0]),se(we[1]),se(we[3]),se(we[1]),se(we[2]),se(we[3])}function $(ne){r.push(l[ne*3+0]),r.push(l[ne*3+1]),r.push(l[ne*3+2])}function se(ne){s.push(ne.x),s.push(ne.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes,i=this.parameters.options;return bue(n,i,e)}static fromJSON(e,n){const i=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=n[e.shapes[s]];i.push(a)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new AB[r.type]().fromJSON(r)),new o1(i,e.options)}}const Sue={generateTopUV:function(t,e,n,i,r){const s=e[n*3],o=e[n*3+1],a=e[i*3],l=e[i*3+1],c=e[r*3],h=e[r*3+1];return[new Ye(s,o),new Ye(a,l),new Ye(c,h)]},generateSideWallUV:function(t,e,n,i,r,s){const o=e[n*3],a=e[n*3+1],l=e[n*3+2],c=e[i*3],h=e[i*3+1],u=e[i*3+2],d=e[r*3],f=e[r*3+1],p=e[r*3+2],v=e[s*3],g=e[s*3+1],m=e[s*3+2];return Math.abs(a-h)<Math.abs(o-c)?[new Ye(o,1-l),new Ye(c,1-u),new Ye(d,1-p),new Ye(v,1-m)]:[new Ye(a,1-l),new Ye(h,1-u),new Ye(f,1-p),new Ye(g,1-m)]}};function bue(t,e,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++){const s=t[i];n.shapes.push(s.uuid)}else n.shapes.push(t.uuid);return n.options=Object.assign({},e),e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class a1 extends cu{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,n),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new a1(e.radius,e.detail)}}class ov extends cu{constructor(e=1,n=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,n),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new ov(e.radius,e.detail)}}class l1 extends Kt{constructor(e=.5,n=1,i=32,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:o},i=Math.max(3,i),r=Math.max(1,r);const a=[],l=[],c=[],h=[];let u=e;const d=(n-e)/r,f=new ae,p=new Ye;for(let v=0;v<=r;v++){for(let g=0;g<=i;g++){const m=s+g/i*o;f.x=u*Math.cos(m),f.y=u*Math.sin(m),l.push(f.x,f.y,f.z),c.push(0,0,1),p.x=(f.x/n+1)/2,p.y=(f.y/n+1)/2,h.push(p.x,p.y)}u+=d}for(let v=0;v<r;v++){const g=v*(i+1);for(let m=0;m<i;m++){const y=m+g,_=y,S=y+i+1,A=y+i+2,b=y+1;a.push(_,S,b),a.push(S,A,b)}}this.setIndex(a),this.setAttribute("position",new xt(l,3)),this.setAttribute("normal",new xt(c,3)),this.setAttribute("uv",new xt(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new l1(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class c1 extends Kt{constructor(e=new df([new Ye(0,.5),new Ye(-.5,-.5),new Ye(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:n};const i=[],r=[],s=[],o=[];let a=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let h=0;h<e.length;h++)c(e[h]),this.addGroup(a,l,h),a+=l,l=0;this.setIndex(i),this.setAttribute("position",new xt(r,3)),this.setAttribute("normal",new xt(s,3)),this.setAttribute("uv",new xt(o,2));function c(h){const u=r.length/3,d=h.extractPoints(n);let f=d.shape;const p=d.holes;Hl.isClockWise(f)===!1&&(f=f.reverse());for(let g=0,m=p.length;g<m;g++){const y=p[g];Hl.isClockWise(y)===!0&&(p[g]=y.reverse())}const v=Hl.triangulateShape(f,p);for(let g=0,m=p.length;g<m;g++){const y=p[g];f=f.concat(y)}for(let g=0,m=f.length;g<m;g++){const y=f[g];r.push(y.x,y.y,0),s.push(0,0,1),o.push(y.x,y.y)}for(let g=0,m=v.length;g<m;g++){const y=v[g],_=y[0]+u,S=y[1]+u,A=y[2]+u;i.push(_,S,A),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes;return Aue(n,e)}static fromJSON(e,n){const i=[];for(let r=0,s=e.shapes.length;r<s;r++){const o=n[e.shapes[r]];i.push(o)}return new c1(i,e.curveSegments)}}function Aue(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){const r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}class av extends Kt{constructor(e=1,n=32,i=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));const l=Math.min(o+a,Math.PI);let c=0;const h=[],u=new ae,d=new ae,f=[],p=[],v=[],g=[];for(let m=0;m<=i;m++){const y=[],_=m/i;let S=0;m===0&&o===0?S=.5/n:m===i&&l===Math.PI&&(S=-.5/n);for(let A=0;A<=n;A++){const b=A/n;u.x=-e*Math.cos(r+b*s)*Math.sin(o+_*a),u.y=e*Math.cos(o+_*a),u.z=e*Math.sin(r+b*s)*Math.sin(o+_*a),p.push(u.x,u.y,u.z),d.copy(u).normalize(),v.push(d.x,d.y,d.z),g.push(b+S,1-_),y.push(c++)}h.push(y)}for(let m=0;m<i;m++)for(let y=0;y<n;y++){const _=h[m][y+1],S=h[m][y],A=h[m+1][y],b=h[m+1][y+1];(m!==0||o>0)&&f.push(_,S,b),(m!==i-1||l<Math.PI)&&f.push(S,A,b)}this.setIndex(f),this.setAttribute("position",new xt(p,3)),this.setAttribute("normal",new xt(v,3)),this.setAttribute("uv",new xt(g,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new av(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class u1 extends cu{constructor(e=1,n=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,n),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new u1(e.radius,e.detail)}}class h1 extends Kt{constructor(e=1,n=.4,i=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],a=[],l=[],c=[],h=new ae,u=new ae,d=new ae;for(let f=0;f<=i;f++)for(let p=0;p<=r;p++){const v=p/r*s,g=f/i*Math.PI*2;u.x=(e+n*Math.cos(g))*Math.cos(v),u.y=(e+n*Math.cos(g))*Math.sin(v),u.z=n*Math.sin(g),a.push(u.x,u.y,u.z),h.x=e*Math.cos(v),h.y=e*Math.sin(v),d.subVectors(u,h).normalize(),l.push(d.x,d.y,d.z),c.push(p/r),c.push(f/i)}for(let f=1;f<=i;f++)for(let p=1;p<=r;p++){const v=(r+1)*f+p-1,g=(r+1)*(f-1)+p-1,m=(r+1)*(f-1)+p,y=(r+1)*f+p;o.push(v,g,y),o.push(g,m,y)}this.setIndex(o),this.setAttribute("position",new xt(a,3)),this.setAttribute("normal",new xt(l,3)),this.setAttribute("uv",new xt(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new h1(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class d1 extends Kt{constructor(e=1,n=.4,i=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:i,radialSegments:r,p:s,q:o},i=Math.floor(i),r=Math.floor(r);const a=[],l=[],c=[],h=[],u=new ae,d=new ae,f=new ae,p=new ae,v=new ae,g=new ae,m=new ae;for(let _=0;_<=i;++_){const S=_/i*s*Math.PI*2;y(S,s,o,e,f),y(S+.01,s,o,e,p),g.subVectors(p,f),m.addVectors(p,f),v.crossVectors(g,m),m.crossVectors(v,g),v.normalize(),m.normalize();for(let A=0;A<=r;++A){const b=A/r*Math.PI*2,T=-n*Math.cos(b),M=n*Math.sin(b);u.x=f.x+(T*m.x+M*v.x),u.y=f.y+(T*m.y+M*v.y),u.z=f.z+(T*m.z+M*v.z),l.push(u.x,u.y,u.z),d.subVectors(u,f).normalize(),c.push(d.x,d.y,d.z),h.push(_/i),h.push(A/r)}}for(let _=1;_<=i;_++)for(let S=1;S<=r;S++){const A=(r+1)*(_-1)+(S-1),b=(r+1)*_+(S-1),T=(r+1)*_+S,M=(r+1)*(_-1)+S;a.push(A,b,M),a.push(b,T,M)}this.setIndex(a),this.setAttribute("position",new xt(l,3)),this.setAttribute("normal",new xt(c,3)),this.setAttribute("uv",new xt(h,2));function y(_,S,A,b,T){const M=Math.cos(_),E=Math.sin(_),P=A/S*_,R=Math.cos(P);T.x=b*(2+R)*.5*M,T.y=b*(2+R)*E*.5,T.z=b*Math.sin(P)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new d1(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class f1 extends Kt{constructor(e=new SB(new ae(-1,-1,0),new ae(-1,1,0),new ae(1,1,0)),n=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:i,radialSegments:r,closed:s};const o=e.computeFrenetFrames(n,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new ae,l=new ae,c=new Ye;let h=new ae;const u=[],d=[],f=[],p=[];v(),this.setIndex(p),this.setAttribute("position",new xt(u,3)),this.setAttribute("normal",new xt(d,3)),this.setAttribute("uv",new xt(f,2));function v(){for(let _=0;_<n;_++)g(_);g(s===!1?n:0),y(),m()}function g(_){h=e.getPointAt(_/n,h);const S=o.normals[_],A=o.binormals[_];for(let b=0;b<=r;b++){const T=b/r*Math.PI*2,M=Math.sin(T),E=-Math.cos(T);l.x=E*S.x+M*A.x,l.y=E*S.y+M*A.y,l.z=E*S.z+M*A.z,l.normalize(),d.push(l.x,l.y,l.z),a.x=h.x+i*l.x,a.y=h.y+i*l.y,a.z=h.z+i*l.z,u.push(a.x,a.y,a.z)}}function m(){for(let _=1;_<=n;_++)for(let S=1;S<=r;S++){const A=(r+1)*(_-1)+(S-1),b=(r+1)*_+(S-1),T=(r+1)*_+S,M=(r+1)*(_-1)+S;p.push(A,b,M),p.push(b,T,M)}}function y(){for(let _=0;_<=n;_++)for(let S=0;S<=r;S++)c.x=_/n,c.y=S/r,f.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new f1(new AB[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class M7 extends Kt{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],i=new Set,r=new ae,s=new ae;if(e.index!==null){const o=e.attributes.position,a=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:a.count,materialIndex:0}]);for(let c=0,h=l.length;c<h;++c){const u=l[c],d=u.start,f=u.count;for(let p=d,v=d+f;p<v;p+=3)for(let g=0;g<3;g++){const m=a.getX(p+g),y=a.getX(p+(g+1)%3);r.fromBufferAttribute(o,m),s.fromBufferAttribute(o,y),Qz(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,l=o.count/3;a<l;a++)for(let c=0;c<3;c++){const h=3*a+c,u=3*a+(c+1)%3;r.fromBufferAttribute(o,h),s.fromBufferAttribute(o,u),Qz(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}this.setAttribute("position",new xt(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function Qz(t,e,n){const i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return n.has(i)===!0||n.has(r)===!0?!1:(n.add(i),n.add(r),!0)}var Kz=Object.freeze({__proto__:null,BoxGeometry:Kh,CapsuleGeometry:n1,CircleGeometry:i1,ConeGeometry:r1,CylinderGeometry:zf,DodecahedronGeometry:s1,EdgesGeometry:w7,ExtrudeGeometry:o1,IcosahedronGeometry:a1,LatheGeometry:sv,OctahedronGeometry:ov,PlaneGeometry:iv,PolyhedronGeometry:cu,RingGeometry:l1,ShapeGeometry:c1,SphereGeometry:av,TetrahedronGeometry:u1,TorusGeometry:h1,TorusKnotGeometry:d1,TubeGeometry:f1,WireframeGeometry:M7});class E7 extends Hi{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new st(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class C7 extends Kl{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class p1 extends Hi{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new st(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new st(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Qh,this.normalScale=new Ye(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class uu extends p1{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ye(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return yi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new st(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new st(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new st(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class T7 extends Hi{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new st(16777215),this.specular=new st(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new st(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Qh,this.normalScale=new Ye(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=qx,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class P7 extends Hi{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new st(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new st(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Qh,this.normalScale=new Ye(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class D7 extends Hi{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Qh,this.normalScale=new Ye(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class R7 extends Hi{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new st(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new st(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Qh,this.normalScale=new Ye(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=qx,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class L7 extends Hi{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new st(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Qh,this.normalScale=new Ye(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class I7 extends Jr{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function jo(t,e,n){return MB(t)?new t.constructor(t.subarray(e,n!==void 0?n:t.length)):t.slice(e,n)}function $d(t,e,n){return!t||!n&&t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function MB(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function B7(t){function e(r,s){return t[r]-t[s]}const n=t.length,i=new Array(n);for(let r=0;r!==n;++r)i[r]=r;return i.sort(e),i}function QR(t,e,n){const i=t.length,r=new t.constructor(i);for(let s=0,o=0;o!==i;++s){const a=n[s]*e;for(let l=0;l!==e;++l)r[o++]=t[a+l]}return r}function EB(t,e,n,i){let r=1,s=t[0];for(;s!==void 0&&s[i]===void 0;)s=t[r++];if(s===void 0)return;let o=s[i];if(o!==void 0)if(Array.isArray(o))do o=s[i],o!==void 0&&(e.push(s.time),n.push.apply(n,o)),s=t[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[i],o!==void 0&&(e.push(s.time),o.toArray(n,n.length)),s=t[r++];while(s!==void 0);else do o=s[i],o!==void 0&&(e.push(s.time),n.push(o)),s=t[r++];while(s!==void 0)}function Mue(t,e,n,i,r=30){const s=t.clone();s.name=e;const o=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],h=c.getValueSize(),u=[],d=[];for(let f=0;f<c.times.length;++f){const p=c.times[f]*r;if(!(p<n||p>=i)){u.push(c.times[f]);for(let v=0;v<h;++v)d.push(c.values[f*h+v])}}u.length!==0&&(c.times=$d(u,c.times.constructor),c.values=$d(d,c.values.constructor),o.push(c))}s.tracks=o;let a=1/0;for(let l=0;l<s.tracks.length;++l)a>s.tracks[l].times[0]&&(a=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*a);return s.resetDuration(),s}function Eue(t,e=0,n=t,i=30){i<=0&&(i=30);const r=n.tracks.length,s=e/i;for(let o=0;o<r;++o){const a=n.tracks[o],l=a.ValueTypeName;if(l==="bool"||l==="string")continue;const c=t.tracks.find(function(m){return m.name===a.name&&m.ValueTypeName===l});if(c===void 0)continue;let h=0;const u=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=u/3);let d=0;const f=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=f/3);const p=a.times.length-1;let v;if(s<=a.times[0]){const m=h,y=u-h;v=jo(a.values,m,y)}else if(s>=a.times[p]){const m=p*u+h,y=m+u-h;v=jo(a.values,m,y)}else{const m=a.createInterpolant(),y=h,_=u-h;m.evaluate(s),v=jo(m.resultBuffer,y,_)}l==="quaternion"&&new xr().fromArray(v).normalize().conjugate().toArray(v);const g=c.times.length;for(let m=0;m<g;++m){const y=m*f+d;if(l==="quaternion")xr.multiplyQuaternionsFlat(c.values,y,v,0,c.values,y);else{const _=f-d*2;for(let S=0;S<_;++S)c.values[y+S]-=v[S]}}}return t.blendMode=Z3,t}const Cue={arraySlice:jo,convertArray:$d,isTypedArray:MB,getKeyframeOrder:B7,sortedArray:QR,flattenJSON:EB,subclip:Mue,makeClipAdditive:Eue};class lv{constructor(e,n,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let i=this._cachedIndex,r=n[i],s=n[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<s)break i;return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=n[++i],e<r)break t}o=n.length;break n}if(!(e>=s)){const a=n[1];e<a&&(i=2,s=a);for(let l=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===l)break;if(r=s,s=n[--i-1],e>=s)break t}o=i,i=0;break n}break e}for(;i<o;){const a=i+o>>>1;e<n[a]?o=a:i=a+1}if(r=n[i],s=n[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)n[o]=i[s+o];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class O7 extends lv{constructor(e,n,i,r){super(e,n,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Kd,endingEnd:Kd}}intervalChanged_(e,n,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],l=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case Jd:s=e,a=2*n-i;break;case lx:s=r.length-2,a=n+r[s]-r[s+1];break;default:s=e,a=i}if(l===void 0)switch(this.getSettings_().endingEnd){case Jd:o=e,l=2*i-n;break;case lx:o=1,l=i+r[1]-r[0];break;default:o=e-1,l=n}const c=(i-n)*.5,h=this.valueSize;this._weightPrev=c/(n-a),this._weightNext=c/(l-i),this._offsetPrev=s*h,this._offsetNext=o*h}interpolate_(e,n,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,h=this._offsetPrev,u=this._offsetNext,d=this._weightPrev,f=this._weightNext,p=(i-n)/(r-n),v=p*p,g=v*p,m=-d*g+2*d*v-d*p,y=(1+d)*g+(-1.5-2*d)*v+(-.5+d)*p+1,_=(-1-f)*g+(1.5+f)*v+.5*p,S=f*g-f*v;for(let A=0;A!==a;++A)s[A]=m*o[h+A]+y*o[c+A]+_*o[l+A]+S*o[u+A];return s}}class CB extends lv{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=e*a,c=l-a,h=(i-n)/(r-n),u=1-h;for(let d=0;d!==a;++d)s[d]=o[c+d]*u+o[l+d]*h;return s}}class F7 extends lv{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class il{constructor(e,n,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=$d(n,this.TimeBufferType),this.values=$d(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let i;if(n.toJSON!==this.toJSON)i=n.toJSON(e);else{i={name:e.name,times:$d(e.times,Array),values:$d(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new F7(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new CB(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new O7(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case Cg:n=this.InterpolantFactoryMethodDiscrete;break;case Cf:n=this.InterpolantFactoryMethodLinear;break;case mb:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Cg;case this.InterpolantFactoryMethodLinear:return Cf;case this.InterpolantFactoryMethodSmooth:return mb}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]*=e}return this}trim(e,n){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;o!==-1&&i[o]>n;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=jo(i,s,o),this.values=jo(this.values,s*a,o*a)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const l=i[a];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,l),e=!1;break}if(o!==null&&o>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,l,o),e=!1;break}o=l}if(r!==void 0&&MB(r))for(let a=0,l=r.length;a!==l;++a){const c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),e=!1;break}}return e}optimize(){const e=jo(this.times),n=jo(this.values),i=this.getValueSize(),r=this.getInterpolation()===mb,s=e.length-1;let o=1;for(let a=1;a<s;++a){let l=!1;const c=e[a],h=e[a+1];if(c!==h&&(a!==1||c!==e[0]))if(r)l=!0;else{const u=a*i,d=u-i,f=u+i;for(let p=0;p!==i;++p){const v=n[u+p];if(v!==n[d+p]||v!==n[f+p]){l=!0;break}}}if(l){if(a!==o){e[o]=e[a];const u=a*i,d=o*i;for(let f=0;f!==i;++f)n[d+f]=n[u+f]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,l=o*i,c=0;c!==i;++c)n[l+c]=n[a+c];++o}return o!==e.length?(this.times=jo(e,0,o),this.values=jo(n,0,o*i)):(this.times=e,this.values=n),this}clone(){const e=jo(this.times,0),n=jo(this.values,0),i=this.constructor,r=new i(this.name,e,n);return r.createInterpolant=this.createInterpolant,r}}il.prototype.TimeBufferType=Float32Array;il.prototype.ValueBufferType=Float32Array;il.prototype.DefaultInterpolation=Cf;class Gf extends il{}Gf.prototype.ValueTypeName="bool";Gf.prototype.ValueBufferType=Array;Gf.prototype.DefaultInterpolation=Cg;Gf.prototype.InterpolantFactoryMethodLinear=void 0;Gf.prototype.InterpolantFactoryMethodSmooth=void 0;class TB extends il{}TB.prototype.ValueTypeName="color";class Rg extends il{}Rg.prototype.ValueTypeName="number";class N7 extends lv{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=(i-n)/(r-n);let c=e*a;for(let h=c+a;c!==h;c+=4)xr.slerpFlat(s,0,o,c-a,o,c,l);return s}}class zh extends il{InterpolantFactoryMethodLinear(e){return new N7(this.times,this.values,this.getValueSize(),e)}}zh.prototype.ValueTypeName="quaternion";zh.prototype.DefaultInterpolation=Cf;zh.prototype.InterpolantFactoryMethodSmooth=void 0;class Hf extends il{}Hf.prototype.ValueTypeName="string";Hf.prototype.ValueBufferType=Array;Hf.prototype.DefaultInterpolation=Cg;Hf.prototype.InterpolantFactoryMethodLinear=void 0;Hf.prototype.InterpolantFactoryMethodSmooth=void 0;class Lg extends il{}Lg.prototype.ValueTypeName="vector";class Ig{constructor(e,n=-1,i,r=UM){this.name=e,this.tracks=i,this.duration=n,this.blendMode=r,this.uuid=go(),this.duration<0&&this.resetDuration()}static parse(e){const n=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)n.push(Pue(i[o]).scale(r));const s=new this(e.name,e.duration,n,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const n=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)n.push(il.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,n,i,r){const s=n.length,o=[];for(let a=0;a<s;a++){let l=[],c=[];l.push((a+s-1)%s,a,(a+1)%s),c.push(0,1,0);const h=B7(l);l=QR(l,1,h),c=QR(c,1,h),!r&&l[0]===0&&(l.push(s),c.push(c[0])),o.push(new Rg(".morphTargetInfluences["+n[a].name+"]",l,c).scale(1/i))}return new this(e,-1,o)}static findByName(e,n){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===n)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,n,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,l=e.length;a<l;a++){const c=e[a],h=c.name.match(s);if(h&&h.length>1){const u=h[1];let d=r[u];d||(r[u]=d=[]),d.push(c)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],n,i));return o}static parseAnimation(e,n){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(u,d,f,p,v){if(f.length!==0){const g=[],m=[];EB(f,g,m,p),g.length!==0&&v.push(new u(d,g,m))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let u=0;u<c.length;u++){const d=c[u].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const f={};let p;for(p=0;p<d.length;p++)if(d[p].morphTargets)for(let v=0;v<d[p].morphTargets.length;v++)f[d[p].morphTargets[v]]=-1;for(const v in f){const g=[],m=[];for(let y=0;y!==d[p].morphTargets.length;++y){const _=d[p];g.push(_.time),m.push(_.morphTarget===v?1:0)}r.push(new Rg(".morphTargetInfluence["+v+"]",g,m))}l=f.length*o}else{const f=".bones["+n[u].name+"]";i(Lg,f+".position",d,"pos",r),i(zh,f+".quaternion",d,"rot",r),i(Lg,f+".scale",d,"scl",r)}}return r.length===0?null:new this(s,l,r,a)}resetDuration(){const e=this.tracks;let n=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];n=Math.max(n,s.times[s.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Tue(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Rg;case"vector":case"vector2":case"vector3":case"vector4":return Lg;case"color":return TB;case"quaternion":return zh;case"bool":case"boolean":return Gf;case"string":return Hf}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function Pue(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=Tue(t.type);if(t.times===void 0){const n=[],i=[];EB(t.keys,n,i,"value"),t.times=n,t.values=i}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const Pf={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class PB{constructor(e,n,i){const r=this;let s=!1,o=0,a=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this.itemStart=function(h){a++,s===!1&&r.onStart!==void 0&&r.onStart(h,o,a),s=!0},this.itemEnd=function(h){o++,r.onProgress!==void 0&&r.onProgress(h,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(h){r.onError!==void 0&&r.onError(h)},this.resolveURL=function(h){return l?l(h):h},this.setURLModifier=function(h){return l=h,this},this.addHandler=function(h,u){return c.push(h,u),this},this.removeHandler=function(h){const u=c.indexOf(h);return u!==-1&&c.splice(u,2),this},this.getHandler=function(h){for(let u=0,d=c.length;u<d;u+=2){const f=c[u],p=c[u+1];if(f.global&&(f.lastIndex=0),f.test(h))return p}return null}}}const Im=new PB;class vs{constructor(e){this.manager=e!==void 0?e:Im,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const i=this;return new Promise(function(r,s){i.load(e,r,n,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const yc={};class Due extends Error{constructor(e,n){super(e),this.response=n}}class xo extends vs{constructor(e){super(e)}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Pf.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(s),this.manager.itemEnd(e)},0),s;if(yc[e]!==void 0){yc[e].push({onLoad:n,onProgress:i,onError:r});return}yc[e]=[],yc[e].push({onLoad:n,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,l=this.responseType;fetch(o).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const h=yc[e],u=c.body.getReader(),d=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),f=d?parseInt(d):0,p=f!==0;let v=0;const g=new ReadableStream({start(m){y();function y(){u.read().then(({done:_,value:S})=>{if(_)m.close();else{v+=S.byteLength;const A=new ProgressEvent("progress",{lengthComputable:p,loaded:v,total:f});for(let b=0,T=h.length;b<T;b++){const M=h[b];M.onProgress&&M.onProgress(A)}m.enqueue(S),y()}})}}});return new Response(g)}else throw new Due(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(h=>new DOMParser().parseFromString(h,a));case"json":return c.json();default:if(a===void 0)return c.text();{const u=/charset="?([^;"\s]*)"?/i.exec(a),d=u&&u[1]?u[1].toLowerCase():void 0,f=new TextDecoder(d);return c.arrayBuffer().then(p=>f.decode(p))}}}).then(c=>{Pf.add(e,c);const h=yc[e];delete yc[e];for(let u=0,d=h.length;u<d;u++){const f=h[u];f.onLoad&&f.onLoad(c)}}).catch(c=>{const h=yc[e];if(h===void 0)throw this.manager.itemError(e),c;delete yc[e];for(let u=0,d=h.length;u<d;u++){const f=h[u];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Rue extends vs{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new xo(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const n=[];for(let i=0;i<e.length;i++){const r=Ig.parse(e[i]);n.push(r)}return n}}class Lue extends vs{constructor(e){super(e)}load(e,n,i,r){const s=this,o=[],a=new yB,l=new xo(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function h(u){l.load(e[u],function(d){const f=s.parse(d,!0);o[u]={width:f.width,height:f.height,format:f.format,mipmaps:f.mipmaps},c+=1,c===6&&(f.mipmapCount===1&&(a.minFilter=oi),a.image=o,a.format=f.format,a.needsUpdate=!0,n&&n(a))},i,r)}if(Array.isArray(e))for(let u=0,d=e.length;u<d;++u)h(u);else l.load(e,function(u){const d=s.parse(u,!0);if(d.isCubemap){const f=d.mipmaps.length/d.mipmapCount;for(let p=0;p<f;p++){o[p]={mipmaps:[]};for(let v=0;v<d.mipmapCount;v++)o[p].mipmaps.push(d.mipmaps[p*d.mipmapCount+v]),o[p].format=d.format,o[p].width=d.width,o[p].height=d.height}a.image=o}else a.image.width=d.width,a.image.height=d.height,a.mipmaps=d.mipmaps;d.mipmapCount===1&&(a.minFilter=oi),a.format=d.format,a.needsUpdate=!0,n&&n(a)},i,r);return a}}class mx extends vs{constructor(e){super(e)}load(e,n,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Pf.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){n&&n(o),s.manager.itemEnd(e)},0),o;const a=ux("img");function l(){h(),Pf.add(e,this),n&&n(this),s.manager.itemEnd(e)}function c(u){h(),r&&r(u),s.manager.itemError(e),s.manager.itemEnd(e)}function h(){a.removeEventListener("load",l,!1),a.removeEventListener("error",c,!1)}return a.addEventListener("load",l,!1),a.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class Iue extends vs{constructor(e){super(e)}load(e,n,i,r){const s=new Zx,o=new mx(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function l(c){o.load(e[c],function(h){s.images[c]=h,a++,a===6&&(s.needsUpdate=!0,n&&n(s))},void 0,r)}for(let c=0;c<e.length;++c)l(c);return s}}class Bue extends vs{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new ng,a=new xo(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(l){const c=s.parse(l);c&&(c.image!==void 0?o.image=c.image:c.data!==void 0&&(o.image.width=c.width,o.image.height=c.height,o.image.data=c.data),o.wrapS=c.wrapS!==void 0?c.wrapS:Cr,o.wrapT=c.wrapT!==void 0?c.wrapT:Cr,o.magFilter=c.magFilter!==void 0?c.magFilter:oi,o.minFilter=c.minFilter!==void 0?c.minFilter:oi,o.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0?o.colorSpace=c.colorSpace:c.encoding!==void 0&&(o.encoding=c.encoding),c.flipY!==void 0&&(o.flipY=c.flipY),c.format!==void 0&&(o.format=c.format),c.type!==void 0&&(o.type=c.type),c.mipmaps!==void 0&&(o.mipmaps=c.mipmaps,o.minFilter=Ql),c.mipmapCount===1&&(o.minFilter=oi),c.generateMipmaps!==void 0&&(o.generateMipmaps=c.generateMipmaps),o.needsUpdate=!0,n&&n(o,c))},i,r),o}}class U7 extends vs{constructor(e){super(e)}load(e,n,i,r){const s=new ni,o=new mx(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,n!==void 0&&n(s)},i,r),s}}class Jh extends mn{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new st(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),n}}class k7 extends Jh{constructor(e,n,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(mn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new st(n)}copy(e,n){return super.copy(e,n),this.groundColor.copy(e.groundColor),this}}const YT=new kt,Jz=new ae,Zz=new ae;class DB{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ye(512,512),this.map=null,this.mapPass=null,this.matrix=new kt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new zM,this._frameExtents=new Ye(1,1),this._viewportCount=1,this._viewports=[new Dn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,i=this.matrix;Jz.setFromMatrixPosition(e.matrixWorld),n.position.copy(Jz),Zz.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(Zz),n.updateMatrixWorld(),YT.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(YT),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(YT)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Oue extends DB{constructor(){super(new zn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,i=Tg*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||n.far;(i!==n.fov||r!==n.aspect||s!==n.far)&&(n.fov=i,n.aspect=r,n.far=s,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class RB extends Jh{constructor(e,n,i=0,r=Math.PI/3,s=0,o=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(mn.DEFAULT_UP),this.updateMatrix(),this.target=new mn,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new Oue}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const $z=new kt,r0=new ae,qT=new ae;class Fue extends DB{constructor(){super(new zn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ye(4,2),this._viewportCount=6,this._viewports=[new Dn(2,1,1,1),new Dn(0,1,1,1),new Dn(3,1,1,1),new Dn(1,1,1,1),new Dn(3,0,1,1),new Dn(1,0,1,1)],this._cubeDirections=[new ae(1,0,0),new ae(-1,0,0),new ae(0,0,1),new ae(0,0,-1),new ae(0,1,0),new ae(0,-1,0)],this._cubeUps=[new ae(0,1,0),new ae(0,1,0),new ae(0,1,0),new ae(0,1,0),new ae(0,0,1),new ae(0,0,-1)]}updateMatrices(e,n=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),r0.setFromMatrixPosition(e.matrixWorld),i.position.copy(r0),qT.copy(i.position),qT.add(this._cubeDirections[n]),i.up.copy(this._cubeUps[n]),i.lookAt(qT),i.updateMatrixWorld(),r.makeTranslation(-r0.x,-r0.y,-r0.z),$z.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix($z)}}class LB extends Jh{constructor(e,n,i=0,r=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new Fue}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class Nue extends DB{constructor(){super(new ja(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class IB extends Jh{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(mn.DEFAULT_UP),this.updateMatrix(),this.target=new mn,this.shadow=new Nue}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class z7 extends Jh{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class G7 extends Jh{constructor(e,n,i=10,r=10){super(e,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}}class H7{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ae)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return n.copy(o[0]).multiplyScalar(.282095),n.addScaledVector(o[1],.488603*r),n.addScaledVector(o[2],.488603*s),n.addScaledVector(o[3],.488603*i),n.addScaledVector(o[4],1.092548*(i*r)),n.addScaledVector(o[5],1.092548*(r*s)),n.addScaledVector(o[6],.315392*(3*s*s-1)),n.addScaledVector(o[7],1.092548*(i*s)),n.addScaledVector(o[8],.546274*(i*i-r*r)),n}getIrradianceAt(e,n){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return n.copy(o[0]).multiplyScalar(.886227),n.addScaledVector(o[1],2*.511664*r),n.addScaledVector(o[2],2*.511664*s),n.addScaledVector(o[3],2*.511664*i),n.addScaledVector(o[4],2*.429043*i*r),n.addScaledVector(o[5],2*.429043*r*s),n.addScaledVector(o[6],.743125*s*s-.247708),n.addScaledVector(o[7],2*.429043*i*s),n.addScaledVector(o[8],.429043*(i*i-r*r)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,n+r*3);return this}toArray(e=[],n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,n+r*3);return e}static getBasisAt(e,n){const i=e.x,r=e.y,s=e.z;n[0]=.282095,n[1]=.488603*r,n[2]=.488603*s,n[3]=.488603*i,n[4]=1.092548*i*r,n[5]=1.092548*r*s,n[6]=.315392*(3*s*s-1),n[7]=1.092548*i*s,n[8]=.546274*(i*i-r*r)}}class qM extends Jh{constructor(e=new H7,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}}class QM extends vs{constructor(e){super(e),this.textures={}}load(e,n,i,r){const s=this,o=new xo(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const n=this.textures;function i(s){return n[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),n[s]}const r=QM.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new st().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==1&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=i(o.value);break;case"c":r.uniforms[s].value=new st().setHex(o.value);break;case"v2":r.uniforms[s].value=new Ye().fromArray(o.value);break;case"v3":r.uniforms[s].value=new ae().fromArray(o.value);break;case"v4":r.uniforms[s].value=new Dn().fromArray(o.value);break;case"m3":r.uniforms[s].value=new ln().fromArray(o.value);break;case"m4":r.uniforms[s].value=new kt().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=i(e.map)),e.matcap!==void 0&&(r.matcap=i(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new Ye().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=i(e.envMap)),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new Ye().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=i(e.thicknessMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const n={ShadowMaterial:E7,SpriteMaterial:fB,RawShaderMaterial:C7,ShaderMaterial:Kl,PointsMaterial:t1,MeshPhysicalMaterial:uu,MeshStandardMaterial:p1,MeshPhongMaterial:T7,MeshToonMaterial:P7,MeshNormalMaterial:D7,MeshLambertMaterial:R7,MeshDepthMaterial:uB,MeshDistanceMaterial:hB,MeshBasicMaterial:so,MeshMatcapMaterial:L7,LineDashedMaterial:I7,LineBasicMaterial:Jr,Material:Hi};return new n[e]}}class Bg{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let n="";for(let i=0,r=e.length;i<r;i++)n+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(n))}catch{return n}}static extractUrlBase(e){const n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}class V7 extends Kt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class j7 extends vs{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new xo(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{n(s.parse(JSON.parse(a)))}catch(l){r?r(l):console.error(l),s.manager.itemError(e)}},i,r)}parse(e){const n={},i={};function r(f,p){if(n[p]!==void 0)return n[p];const g=f.interleavedBuffers[p],m=s(f,g.buffer),y=Dm(g.type,m),_=new $x(y,g.stride);return _.uuid=g.uuid,n[p]=_,_}function s(f,p){if(i[p]!==void 0)return i[p];const g=f.arrayBuffers[p],m=new Uint32Array(g).buffer;return i[p]=m,m}const o=e.isInstancedBufferGeometry?new V7:new Kt,a=e.data.index;if(a!==void 0){const f=Dm(a.type,a.array);o.setIndex(new bn(f,1))}const l=e.data.attributes;for(const f in l){const p=l[f];let v;if(p.isInterleavedBufferAttribute){const g=r(e.data,p.data);v=new kh(g,p.itemSize,p.offset,p.normalized)}else{const g=Dm(p.type,p.array),m=p.isInstancedBufferAttribute?Dg:bn;v=new m(g,p.itemSize,p.normalized)}p.name!==void 0&&(v.name=p.name),p.usage!==void 0&&v.setUsage(p.usage),p.updateRange!==void 0&&(v.updateRange.offset=p.updateRange.offset,v.updateRange.count=p.updateRange.count),o.setAttribute(f,v)}const c=e.data.morphAttributes;if(c)for(const f in c){const p=c[f],v=[];for(let g=0,m=p.length;g<m;g++){const y=p[g];let _;if(y.isInterleavedBufferAttribute){const S=r(e.data,y.data);_=new kh(S,y.itemSize,y.offset,y.normalized)}else{const S=Dm(y.type,y.array);_=new bn(S,y.itemSize,y.normalized)}y.name!==void 0&&(_.name=y.name),v.push(_)}o.morphAttributes[f]=v}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const u=e.data.groups||e.data.drawcalls||e.data.offsets;if(u!==void 0)for(let f=0,p=u.length;f!==p;++f){const v=u[f];o.addGroup(v.start,v.count,v.materialIndex)}const d=e.data.boundingSphere;if(d!==void 0){const f=new ae;d.center!==void 0&&f.fromArray(d.center),o.boundingSphere=new el(f,d.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class Uue extends vs{constructor(e){super(e)}load(e,n,i,r){const s=this,o=this.path===""?Bg.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new xo(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(u){r!==void 0&&r(u),console.error("THREE:ObjectLoader: Can't parse "+e+".",u.message);return}const h=c.metadata;if(h===void 0||h.type===void 0||h.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(c,n)},i,r)}async loadAsync(e,n){const i=this,r=this.path===""?Bg.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new xo(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,n),a=JSON.parse(o),l=a.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(a)}parse(e,n){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){n!==void 0&&n(c)}),a=this.parseTextures(e.textures,o),l=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,s,l,a,i),h=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,h),n!==void 0){let u=!1;for(const d in o)if(o[d].data instanceof HTMLImageElement){u=!0;break}u===!1&&n(c)}return c}async parseAsync(e){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,r,a,o,n),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),l}parseShapes(e){const n={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){const s=new df().fromJSON(e[i]);n[s.uuid]=s}return n}parseSkeletons(e,n){const i={},r={};if(n.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new e1().fromJSON(e[s],r);i[a.uuid]=a}return i}parseGeometries(e,n){const i={};if(e!==void 0){const r=new j7;for(let s=0,o=e.length;s<o;s++){let a;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(l);break;default:l.type in Kz?a=Kz[l.type].fromJSON(l,n):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}a.uuid=l.uuid,l.name!==void 0&&(a.name=l.name),l.userData!==void 0&&(a.userData=l.userData),i[l.uuid]=a}}return i}parseMaterials(e,n){const i={},r={};if(e!==void 0){const s=new QM;s.setTextures(n);for(let o=0,a=e.length;o<a;o++){const l=e[o];i[l.uuid]===void 0&&(i[l.uuid]=s.parse(l)),r[l.uuid]=i[l.uuid]}}return r}parseAnimations(e){const n={};if(e!==void 0)for(let i=0;i<e.length;i++){const r=e[i],s=Ig.parse(r);n[s.uuid]=s}return n}parseImages(e,n){const i=this,r={};let s;function o(l){return i.manager.itemStart(l),s.load(l,function(){i.manager.itemEnd(l)},void 0,function(){i.manager.itemError(l),i.manager.itemEnd(l)})}function a(l){if(typeof l=="string"){const c=l,h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:i.resourcePath+c;return o(h)}else return l.data?{data:Dm(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new PB(n);s=new mx(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,h=e.length;c<h;c++){const u=e[c],d=u.url;if(Array.isArray(d)){const f=[];for(let p=0,v=d.length;p<v;p++){const g=d[p],m=a(g);m!==null&&(m instanceof HTMLImageElement?f.push(m):f.push(new ng(m.data,m.width,m.height)))}r[u.uuid]=new Zd(f)}else{const f=a(u.url);r[u.uuid]=new Zd(f)}}}return r}async parseImagesAsync(e){const n=this,i={};let r;async function s(o){if(typeof o=="string"){const a=o,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:n.resourcePath+a;return await r.loadAsync(l)}else return o.data?{data:Dm(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){r=new mx(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const l=e[o],c=l.url;if(Array.isArray(c)){const h=[];for(let u=0,d=c.length;u<d;u++){const f=c[u],p=await s(f);p!==null&&(p instanceof HTMLImageElement?h.push(p):h.push(new ng(p.data,p.width,p.height)))}i[l.uuid]=new Zd(h)}else{const h=await s(l.url);i[l.uuid]=new Zd(h)}}}return i}parseTextures(e,n){function i(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),n[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const l=n[a.image],c=l.data;let h;Array.isArray(c)?(h=new Zx,c.length===6&&(h.needsUpdate=!0)):(c&&c.data?h=new ng:h=new ni,c&&(h.needsUpdate=!0)),h.source=l,h.uuid=a.uuid,a.name!==void 0&&(h.name=a.name),a.mapping!==void 0&&(h.mapping=i(a.mapping,kue)),a.channel!==void 0&&(h.channel=a.channel),a.offset!==void 0&&h.offset.fromArray(a.offset),a.repeat!==void 0&&h.repeat.fromArray(a.repeat),a.center!==void 0&&h.center.fromArray(a.center),a.rotation!==void 0&&(h.rotation=a.rotation),a.wrap!==void 0&&(h.wrapS=i(a.wrap[0],e4),h.wrapT=i(a.wrap[1],e4)),a.format!==void 0&&(h.format=a.format),a.internalFormat!==void 0&&(h.internalFormat=a.internalFormat),a.type!==void 0&&(h.type=a.type),a.colorSpace!==void 0&&(h.colorSpace=a.colorSpace),a.encoding!==void 0&&(h.encoding=a.encoding),a.minFilter!==void 0&&(h.minFilter=i(a.minFilter,t4)),a.magFilter!==void 0&&(h.magFilter=i(a.magFilter,t4)),a.anisotropy!==void 0&&(h.anisotropy=a.anisotropy),a.flipY!==void 0&&(h.flipY=a.flipY),a.generateMipmaps!==void 0&&(h.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(h.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(h.unpackAlignment=a.unpackAlignment),a.userData!==void 0&&(h.userData=a.userData),r[a.uuid]=h}return r}parseObject(e,n,i,r,s){let o;function a(d){return n[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",d),n[d]}function l(d){if(d!==void 0){if(Array.isArray(d)){const f=[];for(let p=0,v=d.length;p<v;p++){const g=d[p];i[g]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",g),f.push(i[g])}return f}return i[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",d),i[d]}}function c(d){return r[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",d),r[d]}let h,u;switch(e.type){case"Scene":o=new uA,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new st(e.background):o.background=c(e.background)),e.environment!==void 0&&(o.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new VM(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new HM(e.fog.color,e.fog.density))),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":o=new zn(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new ja(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new z7(e.color,e.intensity);break;case"DirectionalLight":o=new IB(e.color,e.intensity);break;case"PointLight":o=new LB(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new G7(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new RB(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new k7(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new qM().fromJSON(e);break;case"SkinnedMesh":h=a(e.geometry),u=l(e.material),o=new pB(h,u),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":h=a(e.geometry),u=l(e.material),o=new gr(h,u);break;case"InstancedMesh":h=a(e.geometry),u=l(e.material);const d=e.count,f=e.instanceMatrix,p=e.instanceColor;o=new mB(h,u,d),o.instanceMatrix=new Dg(new Float32Array(f.array),16),p!==void 0&&(o.instanceColor=new Dg(new Float32Array(p.array),p.itemSize));break;case"LOD":o=new m7;break;case"Line":o=new nu(a(e.geometry),l(e.material));break;case"LineLoop":o=new gB(a(e.geometry),l(e.material));break;case"LineSegments":o=new tl(a(e.geometry),l(e.material));break;case"PointCloud":case"Points":o=new vB(a(e.geometry),l(e.material));break;case"Sprite":o=new p7(l(e.material));break;case"Group":o=new kc;break;case"Bone":o=new jM;break;default:o=new mn}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const d=e.children;for(let f=0;f<d.length;f++)o.add(this.parseObject(d[f],n,i,r,s))}if(e.animations!==void 0){const d=e.animations;for(let f=0;f<d.length;f++){const p=d[f];o.animations.push(s[p])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const d=e.levels;for(let f=0;f<d.length;f++){const p=d[f],v=o.getObjectByProperty("uuid",p.object);v!==void 0&&o.addLevel(v,p.distance,p.hysteresis)}}return o}bindSkeletons(e,n){Object.keys(n).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const r=n[i.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}}const kue={UVMapping:FM,CubeReflectionMapping:Fh,CubeRefractionMapping:Nh,EquirectangularReflectionMapping:sx,EquirectangularRefractionMapping:ox,CubeUVReflectionMapping:nv},e4={RepeatWrapping:Uh,ClampToEdgeWrapping:Cr,MirroredRepeatWrapping:Mg},t4={NearestFilter:vi,NearestMipmapNearestFilter:ax,NearestMipmapLinearFilter:eg,LinearFilter:oi,LinearMipmapNearestFilter:NM,LinearMipmapLinearFilter:Ql};class W7 extends vs{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=Pf.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){n&&n(o),s.manager.itemEnd(e)},0),o;const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader,fetch(e,a).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){Pf.add(e,l),n&&n(l),s.manager.itemEnd(e)}).catch(function(l){r&&r(l),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}let Cw,BB=class{static getContext(){return Cw===void 0&&(Cw=new(window.AudioContext||window.webkitAudioContext)),Cw}static setContext(e){Cw=e}};class zue extends vs{constructor(e){super(e)}load(e,n,i,r){const s=this,o=new xo(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){try{const c=l.slice(0);BB.getContext().decodeAudioData(c,function(u){n(u)},a)}catch(c){a(c)}},i,r);function a(l){r?r(l):console.error(l),s.manager.itemError(e)}}}class Gue extends qM{constructor(e,n,i=1){super(void 0,i),this.isHemisphereLightProbe=!0;const r=new st().set(e),s=new st().set(n),o=new ae(r.r,r.g,r.b),a=new ae(s.r,s.g,s.b),l=Math.sqrt(Math.PI),c=l*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(a).multiplyScalar(l),this.sh.coefficients[1].copy(o).sub(a).multiplyScalar(c)}}class Hue extends qM{constructor(e,n=1){super(void 0,n),this.isAmbientLightProbe=!0;const i=new st().set(e);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const n4=new kt,i4=new kt,md=new kt;class Vue{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new zn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new zn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const n=this._cache;if(n.focus!==e.focus||n.fov!==e.fov||n.aspect!==e.aspect*this.aspect||n.near!==e.near||n.far!==e.far||n.zoom!==e.zoom||n.eyeSep!==this.eyeSep){n.focus=e.focus,n.fov=e.fov,n.aspect=e.aspect*this.aspect,n.near=e.near,n.far=e.far,n.zoom=e.zoom,n.eyeSep=this.eyeSep,md.copy(e.projectionMatrix);const r=n.eyeSep/2,s=r*n.near/n.focus,o=n.near*Math.tan(uf*n.fov*.5)/n.zoom;let a,l;i4.elements[12]=-r,n4.elements[12]=r,a=-o*n.aspect+s,l=o*n.aspect+s,md.elements[0]=2*n.near/(l-a),md.elements[8]=(l+a)/(l-a),this.cameraL.projectionMatrix.copy(md),a=-o*n.aspect-s,l=o*n.aspect-s,md.elements[0]=2*n.near/(l-a),md.elements[8]=(l+a)/(l-a),this.cameraR.projectionMatrix.copy(md)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(i4),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(n4)}}class OB{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=r4(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=r4();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}function r4(){return(typeof performance>"u"?Date:performance).now()}const gd=new ae,s4=new xr,jue=new ae,vd=new ae;class Wue extends mn{constructor(){super(),this.type="AudioListener",this.context=BB.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new OB}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const n=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(gd,s4,jue),vd.set(0,0,-1).applyQuaternion(s4),n.positionX){const r=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(gd.x,r),n.positionY.linearRampToValueAtTime(gd.y,r),n.positionZ.linearRampToValueAtTime(gd.z,r),n.forwardX.linearRampToValueAtTime(vd.x,r),n.forwardY.linearRampToValueAtTime(vd.y,r),n.forwardZ.linearRampToValueAtTime(vd.z,r),n.upX.linearRampToValueAtTime(i.x,r),n.upY.linearRampToValueAtTime(i.y,r),n.upZ.linearRampToValueAtTime(i.z,r)}else n.setPosition(gd.x,gd.y,gd.z),n.setOrientation(vd.x,vd.y,vd.z,i.x,i.y,i.z)}}let X7=class extends mn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}};const yd=new ae,o4=new xr,Xue=new ae,xd=new ae;class Yue extends X7{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,n,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(yd,o4,Xue),xd.set(0,0,1).applyQuaternion(o4);const n=this.panner;if(n.positionX){const i=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(yd.x,i),n.positionY.linearRampToValueAtTime(yd.y,i),n.positionZ.linearRampToValueAtTime(yd.z,i),n.orientationX.linearRampToValueAtTime(xd.x,i),n.orientationY.linearRampToValueAtTime(xd.y,i),n.orientationZ.linearRampToValueAtTime(xd.z,i)}else n.setPosition(yd.x,yd.y,yd.z),n.setOrientation(xd.x,xd.y,xd.z)}}class que{constructor(e,n=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const n=this.getFrequencyData();for(let i=0;i<n.length;i++)e+=n[i];return e/n.length}}class Y7{constructor(e,n,i){this.binding=e,this.valueSize=i;let r,s,o;switch(n){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,n){const i=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)i[s+a]=i[a];o=n}else{o+=n;const a=n/o;this._mixBufferRegion(i,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(e){const n=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const n=this.valueSize,i=this.buffer,r=e*n+n,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=n*this._origIndex;this._mixBufferRegion(i,r,l,1-s,n)}o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*n,1,n);for(let l=n,c=n+n;l!==c;++l)if(i[l]!==i[l+n]){a.setValue(i,r);break}}saveOriginalState(){const e=this.binding,n=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(n,r);for(let s=i,o=r;s!==o;++s)n[s]=n[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,n=e+this.valueSize;for(let i=e;i<n;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[n+i]=this.buffer[e+i]}_select(e,n,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[n+o]=e[i+o]}_slerp(e,n,i,r){xr.slerpFlat(e,n,e,n,e,i,r)}_slerpAdditive(e,n,i,r,s){const o=this._workIndex*s;xr.multiplyQuaternionsFlat(e,o,e,n,e,i),xr.slerpFlat(e,n,e,n,e,o,r)}_lerp(e,n,i,r,s){const o=1-r;for(let a=0;a!==s;++a){const l=n+a;e[l]=e[l]*o+e[i+a]*r}}_lerpAdditive(e,n,i,r,s){for(let o=0;o!==s;++o){const a=n+o;e[a]=e[a]+e[i+o]*r}}}const FB="\\[\\]\\.:\\/",Que=new RegExp("["+FB+"]","g"),NB="[^"+FB+"]",Kue="[^"+FB.replace("\\.","")+"]",Jue=/((?:WC+[\/:])*)/.source.replace("WC",NB),Zue=/(WCOD+)?/.source.replace("WCOD",Kue),$ue=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",NB),ehe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",NB),the=new RegExp("^"+Jue+Zue+$ue+ehe+"$"),nhe=["material","materials","bones","map"];class ihe{constructor(e,n,i){const r=i||fn.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,r)}getValue(e,n){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,n)}setValue(e,n){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].unbind()}}class fn{constructor(e,n,i){this.path=n,this.parsedPath=i||fn.parseTrackName(n),this.node=fn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,i){return e&&e.isAnimationObjectGroup?new fn.Composite(e,n,i):new fn(e,n,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Que,"")}static parseTrackName(e){const n=the.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);nhe.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(n);if(i!==void 0)return i}if(e.children){const i=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===n||a.uuid===n)return a;const l=i(a.children);if(l)return l}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[n++]=i[r]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,i=n.objectName,r=n.propertyName;let s=n.propertyIndex;if(e||(e=fn.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(i){let c=n.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let h=0;h<e.length;h++)if(e[h].name===c){c=h;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const o=e[r];if(o===void 0){const c=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(l=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}fn.Composite=ihe;fn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};fn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};fn.prototype.GetterByBindingType=[fn.prototype._getValue_direct,fn.prototype._getValue_array,fn.prototype._getValue_arrayElement,fn.prototype._getValue_toArray];fn.prototype.SetterByBindingTypeAndVersioning=[[fn.prototype._setValue_direct,fn.prototype._setValue_direct_setNeedsUpdate,fn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[fn.prototype._setValue_array,fn.prototype._setValue_array_setNeedsUpdate,fn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[fn.prototype._setValue_arrayElement,fn.prototype._setValue_arrayElement_setNeedsUpdate,fn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[fn.prototype._setValue_fromArray,fn.prototype._setValue_fromArray_setNeedsUpdate,fn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class rhe{constructor(){this.isAnimationObjectGroup=!0,this.uuid=go(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}add(){const e=this._objects,n=this._indicesByUUID,i=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,l=e.length,c=this.nCachedObjects_;for(let h=0,u=arguments.length;h!==u;++h){const d=arguments[h],f=d.uuid;let p=n[f];if(p===void 0){p=l++,n[f]=p,e.push(d);for(let v=0,g=o;v!==g;++v)s[v].push(new fn(d,i[v],r[v]))}else if(p<c){a=e[p];const v=--c,g=e[v];n[g.uuid]=p,e[p]=g,n[f]=v,e[v]=d;for(let m=0,y=o;m!==y;++m){const _=s[m],S=_[v];let A=_[p];_[p]=S,A===void 0&&(A=new fn(d,i[m],r[m])),_[v]=A}}else e[p]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const l=arguments[o],c=l.uuid,h=n[c];if(h!==void 0&&h>=s){const u=s++,d=e[u];n[d.uuid]=h,e[h]=d,n[c]=u,e[u]=l;for(let f=0,p=r;f!==p;++f){const v=i[f],g=v[u],m=v[h];v[h]=g,v[u]=m}}}this.nCachedObjects_=s}uncache(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,l=arguments.length;a!==l;++a){const c=arguments[a],h=c.uuid,u=n[h];if(u!==void 0)if(delete n[h],u<s){const d=--s,f=e[d],p=--o,v=e[p];n[f.uuid]=u,e[u]=f,n[v.uuid]=d,e[d]=v,e.pop();for(let g=0,m=r;g!==m;++g){const y=i[g],_=y[d],S=y[p];y[u]=_,y[d]=S,y.pop()}}else{const d=--o,f=e[d];d>0&&(n[f.uuid]=u),e[u]=f,e.pop();for(let p=0,v=r;p!==v;++p){const g=i[p];g[u]=g[d],g.pop()}}}this.nCachedObjects_=s}subscribe_(e,n){const i=this._bindingsIndicesByPath;let r=i[e];const s=this._bindings;if(r!==void 0)return s[r];const o=this._paths,a=this._parsedPaths,l=this._objects,c=l.length,h=this.nCachedObjects_,u=new Array(c);r=s.length,i[e]=r,o.push(e),a.push(n),s.push(u);for(let d=h,f=l.length;d!==f;++d){const p=l[d];u[d]=new fn(p,e,n)}return u}unsubscribe_(e){const n=this._bindingsIndicesByPath,i=n[e];if(i!==void 0){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,l=o[a],c=e[a];n[c]=i,o[i]=l,o.pop(),s[i]=s[a],s.pop(),r[i]=r[a],r.pop()}}}class q7{constructor(e,n,i=null,r=n.blendMode){this._mixer=e,this._clip=n,this._localRoot=i,this.blendMode=r;const s=n.tracks,o=s.length,a=new Array(o),l={endingStart:Kd,endingEnd:Kd};for(let c=0;c!==o;++c){const h=s[c].createInterpolant(null);a[c]=h,h.settings=l}this._interpolantSettings=l,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=jX,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,i){if(e.fadeOut(n),this.fadeIn(n),i){const r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,n),this.warp(a,1,n)}return this}crossFadeTo(e,n,i){return e.crossFadeFrom(this,n,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const l=a.parameterPositions,c=a.sampleValues;return l[0]=s,l[1]=s+i,c[0]=e/o,c[1]=n/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,i,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*i;l<0||i===0?n=0:(this._startTime=null,n=i*l)}n*=this._updateTimeScale(e);const o=this._updateTime(n),a=this._updateWeight(e);if(a>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case Z3:for(let h=0,u=l.length;h!==u;++h)l[h].evaluate(o),c[h].accumulateAdditive(a);break;case UM:default:for(let h=0,u=l.length;h!==u;++h)l[h].evaluate(o),c[h].accumulate(r,a)}}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n}_updateTime(e){const n=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=i===WX;if(e===0)return s===-1?r:o&&(s&1)===1?n-r:r;if(i===VX){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=n)r=n;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=n||r<0){const a=Math.floor(r/n);r-=n*a,s+=Math.abs(a);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?n:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return n-r}return r}_setEndings(e,n,i){const r=this._interpolantSettings;i?(r.endingStart=Jd,r.endingEnd=Jd):(e?r.endingStart=this.zeroSlopeAtStart?Jd:Kd:r.endingStart=lx,n?r.endingEnd=this.zeroSlopeAtEnd?Jd:Kd:r.endingEnd=lx)}_scheduleFading(e,n,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,l=o.sampleValues;return a[0]=s,l[0]=n,a[1]=s+e,l[1]=i,this}}const she=new Float32Array(1);class ohe extends tc{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,n){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,l=i.uuid,c=this._bindingsByRootAndName;let h=c[l];h===void 0&&(h={},c[l]=h);for(let u=0;u!==s;++u){const d=r[u],f=d.name;let p=h[f];if(p!==void 0)++p.referenceCount,o[u]=p;else{if(p=o[u],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,l,f));continue}const v=n&&n._propertyBindings[u].binding.parsedPath;p=new Y7(fn.create(i,f,v),d.ValueTypeName,d.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,f),o[u]=p}a[u].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const n=e._cacheIndex;return n!==null&&n<this._nActiveActions}_addInactiveAction(e,n,i){const r=this._actions,s=this._actionsByClip;let o=s[n];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[n]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const n=this._actions,i=n[n.length-1],r=e._cacheIndex;i._cacheIndex=r,n[r]=i,n.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],l=a.knownActions,c=l[l.length-1],h=e._byClipCacheIndex;c._byClipCacheIndex=h,l[h]=c,l.pop(),e._byClipCacheIndex=null;const u=a.actionByRoot,d=(e._localRoot||this._root).uuid;delete u[d],l.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const n=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackAction(e){const n=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_addInactiveBinding(e,n,i){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[n];o===void 0&&(o={},r[n]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const n=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],l=n[n.length-1],c=e._cacheIndex;l._cacheIndex=c,n[c]=l,n.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(e){const n=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackBinding(e){const n=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,n=this._nActiveControlInterpolants++;let i=e[n];return i===void 0&&(i=new CB(new Float32Array(2),new Float32Array(2),1,she),i.__cacheIndex=n,e[n]=i),i}_takeBackControlInterpolant(e){const n=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=n[r];e.__cacheIndex=r,n[r]=e,s.__cacheIndex=i,n[i]=s}clipAction(e,n,i){const r=n||this._root,s=r.uuid;let o=typeof e=="string"?Ig.findByName(r,e):e;const a=o!==null?o.uuid:e,l=this._actionsByClip[a];let c=null;if(i===void 0&&(o!==null?i=o.blendMode:i=UM),l!==void 0){const u=l.actionByRoot[s];if(u!==void 0&&u.blendMode===i)return u;c=l.knownActions[0],o===null&&(o=c._clip)}if(o===null)return null;const h=new q7(this,o,n,i);return this._bindAction(h,c),this._addInactiveAction(h,a,s),h}existingAction(e,n){const i=n||this._root,r=i.uuid,s=typeof e=="string"?Ig.findByName(i,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions,n=this._nActiveActions;for(let i=n-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const n=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let c=0;c!==i;++c)n[c]._update(r,e,s,o);const a=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)a[c].apply(o);return this}setTime(e){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const n=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){const o=s.knownActions;for(let a=0,l=o.length;a!==l;++a){const c=o[a];this._deactivateAction(c);const h=c._cacheIndex,u=n[n.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,u._cacheIndex=h,n[h]=u,n.pop(),this._removeInactiveBindingsForAction(c)}delete r[i]}}uncacheRoot(e){const n=e.uuid,i=this._actionsByClip;for(const o in i){const a=i[o].actionByRoot,l=a[n];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const r=this._bindingsByRootAndName,s=r[n];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,n){const i=this.existingAction(e,n);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class UB{constructor(e){this.value=e}clone(){return new UB(this.value.clone===void 0?this.value:this.value.clone())}}let ahe=0;class lhe extends tc{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:ahe++}),this.name="",this.usage=cx,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const n=e.uniforms;this.uniforms.length=0;for(let i=0,r=n.length;i<r;i++)this.uniforms.push(n[i].clone());return this}clone(){return new this.constructor().copy(this)}}class che extends $x{constructor(e,n,i=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}class uhe{constructor(e,n,i,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=n,this.itemSize=i,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,n){return this.type=e,this.elementSize=n,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class Q7{constructor(e,n,i=0,r=1/0){this.ray=new Qx(e,n),this.near=i,this.far=r,this.camera=null,this.layers=new hf,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}intersectObject(e,n=!0,i=[]){return KR(e,this,i,n),i.sort(a4),i}intersectObjects(e,n=!0,i=[]){for(let r=0,s=e.length;r<s;r++)KR(e[r],this,i,n);return i.sort(a4),i}}function a4(t,e){return t.distance-e.distance}function KR(t,e,n,i){if(t.layers.test(e.layers)&&t.raycast(e,n),i===!0){const r=t.children;for(let s=0,o=r.length;s<o;s++)KR(r[s],e,n,!0)}}class JR{constructor(e=1,n=0,i=0){return this.radius=e,this.phi=n,this.theta=i,this}set(e,n,i){return this.radius=e,this.phi=n,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+n*n+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(yi(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class hhe{constructor(e=1,n=0,i=0){return this.radius=e,this.theta=n,this.y=i,this}set(e,n,i){return this.radius=e,this.theta=n,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=n,this}clone(){return new this.constructor().copy(this)}}const l4=new Ye;class dhe{constructor(e=new Ye(1/0,1/0),n=new Ye(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=l4.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,l4).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const c4=new ae,Tw=new ae;class fhe{constructor(e=new ae,n=new ae){this.start=e,this.end=n}set(e,n){return this.start.copy(e),this.end.copy(n),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,n){return this.delta(n).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,n){c4.subVectors(e,this.start),Tw.subVectors(this.end,this.start);const i=Tw.dot(Tw);let s=Tw.dot(c4)/i;return n&&(s=yi(s,0,1)),s}closestPointToPoint(e,n,i){const r=this.closestPointToPointParameter(e,n);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const u4=new ae;class phe extends mn{constructor(e,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="SpotLightHelper";const i=new Kt,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,l=32;o<l;o++,a++){const c=o/l*Math.PI*2,h=a/l*Math.PI*2;r.push(Math.cos(c),Math.sin(c),1,Math.cos(h),Math.sin(h),1)}i.setAttribute("position",new xt(r,3));const s=new Jr({fog:!1,toneMapped:!1});this.cone=new tl(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),u4.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(u4),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Cu=new ae,Pw=new kt,QT=new kt;class mhe extends tl{constructor(e){const n=K7(e),i=new Kt,r=[],s=[],o=new st(0,0,1),a=new st(0,1,0);for(let c=0;c<n.length;c++){const h=n[c];h.parent&&h.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}i.setAttribute("position",new xt(r,3)),i.setAttribute("color",new xt(s,3));const l=new Jr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const n=this.bones,i=this.geometry,r=i.getAttribute("position");QT.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<n.length;s++){const a=n[s];a.parent&&a.parent.isBone&&(Pw.multiplyMatrices(QT,a.matrixWorld),Cu.setFromMatrixPosition(Pw),r.setXYZ(o,Cu.x,Cu.y,Cu.z),Pw.multiplyMatrices(QT,a.parent.matrixWorld),Cu.setFromMatrixPosition(Pw),r.setXYZ(o+1,Cu.x,Cu.y,Cu.z),o+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function K7(t){const e=[];t.isBone===!0&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,K7(t.children[n]));return e}class ghe extends gr{constructor(e,n,i){const r=new av(n,4,2),s=new so({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const vhe=new ae,h4=new st,d4=new st;class yhe extends mn{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const r=new ov(n);r.rotateY(Math.PI*.5),this.material=new so({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new bn(o,3)),this.add(new gr(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const n=e.geometry.getAttribute("color");h4.copy(this.light.color),d4.copy(this.light.groundColor);for(let i=0,r=n.count;i<r;i++){const s=i<r/2?h4:d4;n.setXYZ(i,s.r,s.g,s.b)}n.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(vhe.setFromMatrixPosition(this.light.matrixWorld).negate())}}class xhe extends tl{constructor(e=10,n=10,i=4473924,r=8947848){i=new st(i),r=new st(r);const s=n/2,o=e/n,a=e/2,l=[],c=[];for(let d=0,f=0,p=-a;d<=n;d++,p+=o){l.push(-a,0,p,a,0,p),l.push(p,0,-a,p,0,a);const v=d===s?i:r;v.toArray(c,f),f+=3,v.toArray(c,f),f+=3,v.toArray(c,f),f+=3,v.toArray(c,f),f+=3}const h=new Kt;h.setAttribute("position",new xt(l,3)),h.setAttribute("color",new xt(c,3));const u=new Jr({vertexColors:!0,toneMapped:!1});super(h,u),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class _he extends tl{constructor(e=10,n=16,i=8,r=64,s=4473924,o=8947848){s=new st(s),o=new st(o);const a=[],l=[];if(n>1)for(let u=0;u<n;u++){const d=u/n*(Math.PI*2),f=Math.sin(d)*e,p=Math.cos(d)*e;a.push(0,0,0),a.push(f,0,p);const v=u&1?s:o;l.push(v.r,v.g,v.b),l.push(v.r,v.g,v.b)}for(let u=0;u<i;u++){const d=u&1?s:o,f=e-e/i*u;for(let p=0;p<r;p++){let v=p/r*(Math.PI*2),g=Math.sin(v)*f,m=Math.cos(v)*f;a.push(g,0,m),l.push(d.r,d.g,d.b),v=(p+1)/r*(Math.PI*2),g=Math.sin(v)*f,m=Math.cos(v)*f,a.push(g,0,m),l.push(d.r,d.g,d.b)}}const c=new Kt;c.setAttribute("position",new xt(a,3)),c.setAttribute("color",new xt(l,3));const h=new Jr({vertexColors:!0,toneMapped:!1});super(c,h),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const f4=new ae,Dw=new ae,p4=new ae;class whe extends mn{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",n===void 0&&(n=1);let r=new Kt;r.setAttribute("position",new xt([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));const s=new Jr({fog:!1,toneMapped:!1});this.lightPlane=new nu(r,s),this.add(this.lightPlane),r=new Kt,r.setAttribute("position",new xt([0,0,0,0,0,1],3)),this.targetLine=new nu(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),f4.setFromMatrixPosition(this.light.matrixWorld),Dw.setFromMatrixPosition(this.light.target.matrixWorld),p4.subVectors(Dw,f4),this.lightPlane.lookAt(Dw),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Dw),this.targetLine.scale.z=p4.length()}}const Rw=new ae,pi=new Jx;class She extends tl{constructor(e){const n=new Kt,i=new Jr({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(p,v){l(p),l(v)}function l(p){r.push(0,0,0),s.push(0,0,0),o[p]===void 0&&(o[p]=[]),o[p].push(r.length/3-1)}n.setAttribute("position",new xt(r,3)),n.setAttribute("color",new xt(s,3)),super(n,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const c=new st(16755200),h=new st(16711680),u=new st(43775),d=new st(16777215),f=new st(3355443);this.setColors(c,h,u,d,f)}setColors(e,n,i,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,n.r,n.g,n.b),a.setXYZ(25,n.r,n.g,n.b),a.setXYZ(26,n.r,n.g,n.b),a.setXYZ(27,n.r,n.g,n.b),a.setXYZ(28,n.r,n.g,n.b),a.setXYZ(29,n.r,n.g,n.b),a.setXYZ(30,n.r,n.g,n.b),a.setXYZ(31,n.r,n.g,n.b),a.setXYZ(32,i.r,i.g,i.b),a.setXYZ(33,i.r,i.g,i.b),a.setXYZ(34,i.r,i.g,i.b),a.setXYZ(35,i.r,i.g,i.b),a.setXYZ(36,i.r,i.g,i.b),a.setXYZ(37,i.r,i.g,i.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,n=this.pointMap,i=1,r=1;pi.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ai("c",n,e,pi,0,0,-1),Ai("t",n,e,pi,0,0,1),Ai("n1",n,e,pi,-i,-r,-1),Ai("n2",n,e,pi,i,-r,-1),Ai("n3",n,e,pi,-i,r,-1),Ai("n4",n,e,pi,i,r,-1),Ai("f1",n,e,pi,-i,-r,1),Ai("f2",n,e,pi,i,-r,1),Ai("f3",n,e,pi,-i,r,1),Ai("f4",n,e,pi,i,r,1),Ai("u1",n,e,pi,i*.7,r*1.1,-1),Ai("u2",n,e,pi,-i*.7,r*1.1,-1),Ai("u3",n,e,pi,0,r*2,-1),Ai("cf1",n,e,pi,-i,0,1),Ai("cf2",n,e,pi,i,0,1),Ai("cf3",n,e,pi,0,-r,1),Ai("cf4",n,e,pi,0,r,1),Ai("cn1",n,e,pi,-i,0,-1),Ai("cn2",n,e,pi,i,0,-1),Ai("cn3",n,e,pi,0,-r,-1),Ai("cn4",n,e,pi,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Ai(t,e,n,i,r,s,o){Rw.set(r,s,o).unproject(i);const a=e[t];if(a!==void 0){const l=n.getAttribute("position");for(let c=0,h=a.length;c<h;c++)l.setXYZ(a[c],Rw.x,Rw.y,Rw.z)}}const Lw=new $a;class bhe extends tl{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new Kt;s.setIndex(new bn(i,1)),s.setAttribute("position",new bn(r,3)),super(s,new Jr({color:n,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Lw.setFromObject(this.object),Lw.isEmpty())return;const n=Lw.min,i=Lw.max,r=this.geometry.attributes.position,s=r.array;s[0]=i.x,s[1]=i.y,s[2]=i.z,s[3]=n.x,s[4]=i.y,s[5]=i.z,s[6]=n.x,s[7]=n.y,s[8]=i.z,s[9]=i.x,s[10]=n.y,s[11]=i.z,s[12]=i.x,s[13]=i.y,s[14]=n.z,s[15]=n.x,s[16]=i.y,s[17]=n.z,s[18]=n.x,s[19]=n.y,s[20]=n.z,s[21]=i.x,s[22]=n.y,s[23]=n.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,n){return super.copy(e,n),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class Ahe extends tl{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Kt;s.setIndex(new bn(i,1)),s.setAttribute("position",new xt(r,3)),super(s,new Jr({color:n,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class Mhe extends nu{constructor(e,n=1,i=16776960){const r=i,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new Kt;o.setAttribute("position",new xt(s,3)),o.computeBoundingSphere(),super(o,new Jr({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=n;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new Kt;l.setAttribute("position",new xt(a,3)),l.computeBoundingSphere(),this.add(new gr(l,new so({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const m4=new ae;let Iw,KT;class Ehe extends mn{constructor(e=new ae(0,0,1),n=new ae(0,0,0),i=1,r=16776960,s=i*.2,o=s*.2){super(),this.type="ArrowHelper",Iw===void 0&&(Iw=new Kt,Iw.setAttribute("position",new xt([0,0,0,0,1,0],3)),KT=new zf(0,.5,1,5,1),KT.translate(0,-.5,0)),this.position.copy(n),this.line=new nu(Iw,new Jr({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new gr(KT,new so({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{m4.set(e.z,0,-e.x).normalize();const n=Math.acos(e.y);this.quaternion.setFromAxisAngle(m4,n)}}setLength(e,n=e*.2,i=n*.2){this.line.scale.set(1,Math.max(1e-4,e-n),1),this.line.updateMatrix(),this.cone.scale.set(i,n,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class Che extends tl{constructor(e=1){const n=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Kt;r.setAttribute("position",new xt(n,3)),r.setAttribute("color",new xt(i,3));const s=new Jr({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,n,i){const r=new st,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(n),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class The{constructor(){this.type="ShapePath",this.color=new st,this.subPaths=[],this.currentPath=null}moveTo(e,n){return this.currentPath=new hx,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n),this}lineTo(e,n){return this.currentPath.lineTo(e,n),this}quadraticCurveTo(e,n,i,r){return this.currentPath.quadraticCurveTo(e,n,i,r),this}bezierCurveTo(e,n,i,r,s,o){return this.currentPath.bezierCurveTo(e,n,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(m){const y=[];for(let _=0,S=m.length;_<S;_++){const A=m[_],b=new df;b.curves=A.curves,y.push(b)}return y}function i(m,y){const _=y.length;let S=!1;for(let A=_-1,b=0;b<_;A=b++){let T=y[A],M=y[b],E=M.x-T.x,P=M.y-T.y;if(Math.abs(P)>Number.EPSILON){if(P<0&&(T=y[b],E=-E,M=y[A],P=-P),m.y<T.y||m.y>M.y)continue;if(m.y===T.y){if(m.x===T.x)return!0}else{const R=P*(m.x-T.x)-E*(m.y-T.y);if(R===0)return!0;if(R<0)continue;S=!S}}else{if(m.y!==T.y)continue;if(M.x<=m.x&&m.x<=T.x||T.x<=m.x&&m.x<=M.x)return!0}}return S}const r=Hl.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,l;const c=[];if(s.length===1)return a=s[0],l=new df,l.curves=a.curves,c.push(l),c;let h=!r(s[0].getPoints());h=e?!h:h;const u=[],d=[];let f=[],p=0,v;d[p]=void 0,f[p]=[];for(let m=0,y=s.length;m<y;m++)a=s[m],v=a.getPoints(),o=r(v),o=e?!o:o,o?(!h&&d[p]&&p++,d[p]={s:new df,p:v},d[p].s.curves=a.curves,h&&p++,f[p]=[]):f[p].push({h:a,p:v[0]});if(!d[0])return n(s);if(d.length>1){let m=!1,y=0;for(let _=0,S=d.length;_<S;_++)u[_]=[];for(let _=0,S=d.length;_<S;_++){const A=f[_];for(let b=0;b<A.length;b++){const T=A[b];let M=!0;for(let E=0;E<d.length;E++)i(T.p,d[E].p)&&(_!==E&&y++,M?(M=!1,u[E].push(T)):m=!0);M&&u[_].push(T)}}y>0&&m===!1&&(f=u)}let g;for(let m=0,y=d.length;m<y;m++){l=d[m].s,c.push(l),g=f[m];for(let _=0,S=g.length;_<S;_++)l.holes.push(g[_].h)}return c}}class Phe extends Kh{constructor(e,n,i,r,s,o){console.warn("THREE.BoxBufferGeometry has been renamed to THREE.BoxGeometry."),super(e,n,i,r,s,o)}}class Dhe extends n1{constructor(e,n,i,r){console.warn("THREE.CapsuleBufferGeometry has been renamed to THREE.CapsuleGeometry."),super(e,n,i,r)}}class Rhe extends i1{constructor(e,n,i,r){console.warn("THREE.CircleBufferGeometry has been renamed to THREE.CircleGeometry."),super(e,n,i,r)}}class Lhe extends r1{constructor(e,n,i,r,s,o,a){console.warn("THREE.ConeBufferGeometry has been renamed to THREE.ConeGeometry."),super(e,n,i,r,s,o,a)}}class Ihe extends zf{constructor(e,n,i,r,s,o,a,l){console.warn("THREE.CylinderBufferGeometry has been renamed to THREE.CylinderGeometry."),super(e,n,i,r,s,o,a,l)}}class Bhe extends s1{constructor(e,n){console.warn("THREE.DodecahedronBufferGeometry has been renamed to THREE.DodecahedronGeometry."),super(e,n)}}class Ohe extends o1{constructor(e,n){console.warn("THREE.ExtrudeBufferGeometry has been renamed to THREE.ExtrudeGeometry."),super(e,n)}}class Fhe extends a1{constructor(e,n){console.warn("THREE.IcosahedronBufferGeometry has been renamed to THREE.IcosahedronGeometry."),super(e,n)}}class Nhe extends sv{constructor(e,n,i,r){console.warn("THREE.LatheBufferGeometry has been renamed to THREE.LatheGeometry."),super(e,n,i,r)}}class Uhe extends ov{constructor(e,n){console.warn("THREE.OctahedronBufferGeometry has been renamed to THREE.OctahedronGeometry."),super(e,n)}}class khe extends iv{constructor(e,n,i,r){console.warn("THREE.PlaneBufferGeometry has been renamed to THREE.PlaneGeometry."),super(e,n,i,r)}}class zhe extends cu{constructor(e,n,i,r){console.warn("THREE.PolyhedronBufferGeometry has been renamed to THREE.PolyhedronGeometry."),super(e,n,i,r)}}class Ghe extends l1{constructor(e,n,i,r,s,o){console.warn("THREE.RingBufferGeometry has been renamed to THREE.RingGeometry."),super(e,n,i,r,s,o)}}class Hhe extends c1{constructor(e,n){console.warn("THREE.ShapeBufferGeometry has been renamed to THREE.ShapeGeometry."),super(e,n)}}class Vhe extends av{constructor(e,n,i,r,s,o,a){console.warn("THREE.SphereBufferGeometry has been renamed to THREE.SphereGeometry."),super(e,n,i,r,s,o,a)}}class jhe extends u1{constructor(e,n){console.warn("THREE.TetrahedronBufferGeometry has been renamed to THREE.TetrahedronGeometry."),super(e,n)}}class Whe extends h1{constructor(e,n,i,r,s){console.warn("THREE.TorusBufferGeometry has been renamed to THREE.TorusGeometry."),super(e,n,i,r,s)}}class Xhe extends d1{constructor(e,n,i,r,s,o){console.warn("THREE.TorusKnotBufferGeometry has been renamed to THREE.TorusKnotGeometry."),super(e,n,i,r,s,o)}}class Yhe extends f1{constructor(e,n,i,r,s){console.warn("THREE.TubeBufferGeometry has been renamed to THREE.TubeGeometry."),super(e,n,i,r,s)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:BM}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=BM);const qhe=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:K3,AddEquation:zd,AddOperation:bX,AdditiveAnimationBlendMode:Z3,AdditiveBlending:pR,AlphaFormat:IX,AlwaysDepth:gX,AlwaysStencilFunc:KX,AmbientLight:z7,AmbientLightProbe:Hue,AnimationAction:q7,AnimationClip:Ig,AnimationLoader:Rue,AnimationMixer:ohe,AnimationObjectGroup:rhe,AnimationUtils:Cue,ArcCurve:g7,ArrayCamera:u7,ArrowHelper:Ehe,Audio:X7,AudioAnalyser:que,AudioContext:BB,AudioListener:Wue,AudioLoader:zue,AxesHelper:Che,BackSide:fs,BasicDepthPacking:YX,BasicShadowMap:nX,Bone:jM,BooleanKeyframeTrack:Gf,Box2:dhe,Box3:$a,Box3Helper:Ahe,BoxBufferGeometry:Phe,BoxGeometry:Kh,BoxHelper:bhe,BufferAttribute:bn,BufferGeometry:Kt,BufferGeometryLoader:j7,ByteType:TX,Cache:Pf,Camera:Jx,CameraHelper:She,CanvasTexture:Jce,CapsuleBufferGeometry:Dhe,CapsuleGeometry:n1,CatmullRomCurve3:v7,CineonToneMapping:EX,CircleBufferGeometry:Rhe,CircleGeometry:i1,ClampToEdgeWrapping:Cr,Clock:OB,Color:st,ColorKeyframeTrack:TB,ColorManagement:Go,CompressedArrayTexture:Kce,CompressedTexture:yB,CompressedTextureLoader:Lue,ConeBufferGeometry:Lhe,ConeGeometry:r1,CubeCamera:aB,CubeReflectionMapping:Fh,CubeRefractionMapping:Nh,CubeTexture:Zx,CubeTextureLoader:Iue,CubeUVReflectionMapping:nv,CubicBezierCurve:_B,CubicBezierCurve3:y7,CubicInterpolant:O7,CullFaceBack:fR,CullFaceFront:tX,CullFaceFrontBack:$ie,CullFaceNone:eX,Curve:nl,CurvePath:_7,CustomBlending:iX,CustomToneMapping:CX,CylinderBufferGeometry:Ihe,CylinderGeometry:zf,Cylindrical:hhe,Data3DTexture:rB,DataArrayTexture:kM,DataTexture:ng,DataTextureLoader:Bue,DataUtils:ose,DecrementStencilOp:lre,DecrementWrapStencilOp:ure,DefaultLoadingManager:Im,DepthFormat:Eh,DepthStencilFormat:Ef,DepthTexture:h7,DirectionalLight:IB,DirectionalLightHelper:whe,DiscreteInterpolant:F7,DisplayP3ColorSpace:tB,DodecahedronBufferGeometry:Bhe,DodecahedronGeometry:s1,DoubleSide:$o,DstAlphaFactor:uX,DstColorFactor:dX,DynamicCopyUsage:Are,DynamicDrawUsage:cf,DynamicReadUsage:wre,EdgesGeometry:w7,EllipseCurve:WM,EqualDepth:yX,EqualStencilFunc:pre,EquirectangularReflectionMapping:sx,EquirectangularRefractionMapping:ox,Euler:Kx,EventDispatcher:tc,ExtrudeBufferGeometry:Ohe,ExtrudeGeometry:o1,FileLoader:xo,Float16BufferAttribute:dse,Float32BufferAttribute:xt,Float64BufferAttribute:fse,FloatType:Uc,Fog:VM,FogExp2:HM,FramebufferTexture:Qce,FrontSide:ql,Frustum:zM,GLBufferAttribute:uhe,GLSL1:Ere,GLSL3:HR,GreaterDepth:_X,GreaterEqualDepth:xX,GreaterEqualStencilFunc:yre,GreaterStencilFunc:gre,GridHelper:xhe,Group:kc,HalfFloatType:Eg,HemisphereLight:k7,HemisphereLightHelper:yhe,HemisphereLightProbe:Gue,IcosahedronBufferGeometry:Fhe,IcosahedronGeometry:a1,ImageBitmapLoader:W7,ImageLoader:mx,ImageUtils:iB,IncrementStencilOp:are,IncrementWrapStencilOp:cre,InstancedBufferAttribute:Dg,InstancedBufferGeometry:V7,InstancedInterleavedBuffer:che,InstancedMesh:mB,Int16BufferAttribute:use,Int32BufferAttribute:hse,Int8BufferAttribute:ase,IntType:DX,InterleavedBuffer:$x,InterleavedBufferAttribute:kh,Interpolant:lv,InterpolateDiscrete:Cg,InterpolateLinear:Cf,InterpolateSmooth:mb,InvertStencilOp:hre,KeepStencilOp:gb,KeyframeTrack:il,LOD:m7,LatheBufferGeometry:Nhe,LatheGeometry:sv,Layers:hf,LessDepth:vX,LessEqualDepth:aA,LessEqualStencilFunc:mre,LessStencilFunc:fre,Light:Jh,LightProbe:qM,Line:nu,Line3:fhe,LineBasicMaterial:Jr,LineCurve:XM,LineCurve3:x7,LineDashedMaterial:I7,LineLoop:gB,LineSegments:tl,LinearEncoding:eB,LinearFilter:oi,LinearInterpolant:CB,LinearMipMapLinearFilter:rre,LinearMipMapNearestFilter:ire,LinearMipmapLinearFilter:Ql,LinearMipmapNearestFilter:NM,LinearSRGBColorSpace:Ya,LinearToneMapping:AX,Loader:vs,LoaderUtils:Bg,LoadingManager:PB,LoopOnce:VX,LoopPingPong:WX,LoopRepeat:jX,LuminanceAlphaFormat:OX,LuminanceFormat:BX,MOUSE:Rd,Material:Hi,MaterialLoader:QM,MathUtils:$X,Matrix3:ln,Matrix4:kt,MaxEquation:yR,Mesh:gr,MeshBasicMaterial:so,MeshDepthMaterial:uB,MeshDistanceMaterial:hB,MeshLambertMaterial:R7,MeshMatcapMaterial:L7,MeshNormalMaterial:D7,MeshPhongMaterial:T7,MeshPhysicalMaterial:uu,MeshStandardMaterial:p1,MeshToonMaterial:P7,MinEquation:vR,MirroredRepeatWrapping:Mg,MixOperation:SX,MultiplyBlending:gR,MultiplyOperation:qx,NearestFilter:vi,NearestMipMapLinearFilter:nre,NearestMipMapNearestFilter:tre,NearestMipmapLinearFilter:eg,NearestMipmapNearestFilter:ax,NeverDepth:mX,NeverStencilFunc:dre,NoBlending:Wc,NoColorSpace:Ch,NoToneMapping:Va,NormalAnimationBlendMode:UM,NormalBlending:af,NotEqualDepth:wX,NotEqualStencilFunc:vre,NumberKeyframeTrack:Rg,Object3D:mn,ObjectLoader:Uue,ObjectSpaceNormalMap:QX,OctahedronBufferGeometry:Uhe,OctahedronGeometry:ov,OneFactor:aX,OneMinusDstAlphaFactor:hX,OneMinusDstColorFactor:fX,OneMinusSrcAlphaFactor:Q3,OneMinusSrcColorFactor:cX,OrthographicCamera:ja,PCFShadowMap:OM,PCFSoftShadowMap:py,PMREMGenerator:jR,Path:hx,PerspectiveCamera:zn,Plane:qu,PlaneBufferGeometry:khe,PlaneGeometry:iv,PlaneHelper:Mhe,PointLight:LB,PointLightHelper:ghe,Points:vB,PointsMaterial:t1,PolarGridHelper:_he,PolyhedronBufferGeometry:zhe,PolyhedronGeometry:cu,PositionalAudio:Yue,PropertyBinding:fn,PropertyMixer:Y7,QuadraticBezierCurve:wB,QuadraticBezierCurve3:SB,Quaternion:xr,QuaternionKeyframeTrack:zh,QuaternionLinearInterpolant:N7,RED_GREEN_RGTC2_Format:zR,RED_RGTC1_Format:HX,REVISION:BM,RGBADepthPacking:qX,RGBAFormat:Es,RGBAIntegerFormat:zX,RGBA_ASTC_10x10_Format:FR,RGBA_ASTC_10x5_Format:IR,RGBA_ASTC_10x6_Format:BR,RGBA_ASTC_10x8_Format:OR,RGBA_ASTC_12x10_Format:NR,RGBA_ASTC_12x12_Format:UR,RGBA_ASTC_4x4_Format:MR,RGBA_ASTC_5x4_Format:ER,RGBA_ASTC_5x5_Format:CR,RGBA_ASTC_6x5_Format:TR,RGBA_ASTC_6x6_Format:PR,RGBA_ASTC_8x5_Format:DR,RGBA_ASTC_8x6_Format:RR,RGBA_ASTC_8x8_Format:LR,RGBA_BPTC_Format:pb,RGBA_ETC2_EAC_Format:AR,RGBA_PVRTC_2BPPV1_Format:SR,RGBA_PVRTC_4BPPV1_Format:wR,RGBA_S3TC_DXT1_Format:hb,RGBA_S3TC_DXT3_Format:db,RGBA_S3TC_DXT5_Format:fb,RGB_ETC1_Format:GX,RGB_ETC2_Format:bR,RGB_PVRTC_2BPPV1_Format:_R,RGB_PVRTC_4BPPV1_Format:xR,RGB_S3TC_DXT1_Format:ub,RGFormat:UX,RGIntegerFormat:kX,RawShaderMaterial:C7,Ray:Qx,Raycaster:Q7,RectAreaLight:G7,RedFormat:FX,RedIntegerFormat:NX,ReinhardToneMapping:MX,RepeatWrapping:Uh,ReplaceStencilOp:ore,ReverseSubtractEquation:sX,RingBufferGeometry:Ghe,RingGeometry:l1,SIGNED_RED_GREEN_RGTC2_Format:GR,SIGNED_RED_RGTC1_Format:kR,SRGBColorSpace:Jt,Scene:uA,ShaderChunk:tn,ShaderLib:Oa,ShaderMaterial:Kl,ShadowMaterial:E7,Shape:df,ShapeBufferGeometry:Hhe,ShapeGeometry:c1,ShapePath:The,ShapeUtils:Hl,ShortType:PX,Skeleton:e1,SkeletonHelper:mhe,SkinnedMesh:pB,Source:Zd,Sphere:el,SphereBufferGeometry:Vhe,SphereGeometry:av,Spherical:JR,SphericalHarmonics3:H7,SplineCurve:bB,SpotLight:RB,SpotLightHelper:phe,Sprite:p7,SpriteMaterial:fB,SrcAlphaFactor:q3,SrcAlphaSaturateFactor:pX,SrcColorFactor:lX,StaticCopyUsage:bre,StaticDrawUsage:cx,StaticReadUsage:_re,StereoCamera:Vue,StreamCopyUsage:Mre,StreamDrawUsage:xre,StreamReadUsage:Sre,StringKeyframeTrack:Hf,SubtractEquation:rX,SubtractiveBlending:mR,TOUCH:Ld,TangentSpaceNormalMap:Qh,TetrahedronBufferGeometry:jhe,TetrahedronGeometry:u1,Texture:ni,TextureLoader:U7,TorusBufferGeometry:Whe,TorusGeometry:h1,TorusKnotBufferGeometry:Xhe,TorusKnotGeometry:d1,Triangle:Ms,TriangleFanDrawMode:lA,TriangleStripDrawMode:$3,TrianglesDrawMode:XX,TubeBufferGeometry:Yhe,TubeGeometry:f1,TwoPassDoubleSide:ere,UVMapping:FM,Uint16BufferAttribute:sB,Uint32BufferAttribute:oB,Uint8BufferAttribute:lse,Uint8ClampedBufferAttribute:cse,Uniform:UB,UniformsGroup:lhe,UniformsLib:rt,UniformsUtils:i7,UnsignedByteType:tu,UnsignedInt248Type:lf,UnsignedIntType:ah,UnsignedShort4444Type:RX,UnsignedShort5551Type:LX,UnsignedShortType:J3,VSMShadowMap:La,Vector2:Ye,Vector3:ae,Vector4:Dn,VectorKeyframeTrack:Lg,VideoTexture:qce,WebGL1Renderer:d7,WebGL3DRenderTarget:Qre,WebGLArrayRenderTarget:qre,WebGLCubeRenderTarget:lB,WebGLMultipleRenderTargets:Kre,WebGLRenderTarget:qa,WebGLRenderer:dB,WebGLUtils:c7,WireframeGeometry:M7,WrapAroundEnding:lx,ZeroCurvatureEnding:Kd,ZeroFactor:oX,ZeroSlopeEnding:Jd,ZeroStencilOp:sre,_SRGBAFormat:cA,sRGBEncoding:mo},Symbol.toStringTag,{value:"Module"}));var J7={exports:{}},Vf={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Vf.ConcurrentRoot=1;Vf.ContinuousEventPriority=4;Vf.DefaultEventPriority=16;Vf.DiscreteEventPriority=1;Vf.IdleEventPriority=536870912;Vf.LegacyRoot=0;J7.exports=Vf;var Bm=J7.exports;function Qhe(t){let e;const n=new Set,i=(c,h)=>{const u=typeof c=="function"?c(e):c;if(u!==e){const d=e;e=h?u:Object.assign({},e,u),n.forEach(f=>f(e,d))}},r=()=>e,s=(c,h=r,u=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let d=h(e);function f(){const p=h(e);if(!u(d,p)){const v=d;c(d=p,v)}}return n.add(f),()=>n.delete(f)},l={setState:i,getState:r,subscribe:(c,h,u)=>h||u?s(c,h,u):(n.add(c),()=>n.delete(c)),destroy:()=>n.clear()};return e=t(i,r,l),l}const Khe=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),g4=Khe?ge.useEffect:ge.useLayoutEffect;function Z7(t){const e=typeof t=="function"?Qhe(t):t,n=(i=e.getState,r=Object.is)=>{const[,s]=ge.useReducer(g=>g+1,0),o=e.getState(),a=ge.useRef(o),l=ge.useRef(i),c=ge.useRef(r),h=ge.useRef(!1),u=ge.useRef();u.current===void 0&&(u.current=i(o));let d,f=!1;(a.current!==o||l.current!==i||c.current!==r||h.current)&&(d=i(o),f=!r(u.current,d)),g4(()=>{f&&(u.current=d),a.current=o,l.current=i,c.current=r,h.current=!1});const p=ge.useRef(o);g4(()=>{const g=()=>{try{const y=e.getState(),_=l.current(y);c.current(u.current,_)||(a.current=y,u.current=_,s())}catch{h.current=!0,s()}},m=e.subscribe(g);return e.getState()!==p.current&&g(),m},[]);const v=f?d:u.current;return ge.useDebugValue(v),v};return Object.assign(n,e),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const i=[n,e];return{next(){const r=i.length<=0;return{value:i.shift(),done:r}}}},n}var $7={exports:{}},JT={exports:{}},ZT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v4;function Jhe(){return v4||(v4=1,function(t){function e(O,W){var H=O.length;O.push(W);e:for(;0<H;){var Y=H-1>>>1,z=O[Y];if(0<r(z,W))O[Y]=W,O[H]=z,H=Y;else break e}}function n(O){return O.length===0?null:O[0]}function i(O){if(O.length===0)return null;var W=O[0],H=O.pop();if(H!==W){O[0]=H;e:for(var Y=0,z=O.length,X=z>>>1;Y<X;){var q=2*(Y+1)-1,re=O[q],G=q+1,K=O[G];if(0>r(re,H))G<z&&0>r(K,re)?(O[Y]=K,O[G]=H,Y=G):(O[Y]=re,O[q]=H,Y=q);else if(G<z&&0>r(K,H))O[Y]=K,O[G]=H,Y=G;else break e}}return W}function r(O,W){var H=O.sortIndex-W.sortIndex;return H!==0?H:O.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,u=null,d=3,f=!1,p=!1,v=!1,g=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(O){for(var W=n(c);W!==null;){if(W.callback===null)i(c);else if(W.startTime<=O)i(c),W.sortIndex=W.expirationTime,e(l,W);else break;W=n(c)}}function S(O){if(v=!1,_(O),!p)if(n(l)!==null)p=!0,Z(A);else{var W=n(c);W!==null&&ee(S,W.startTime-O)}}function A(O,W){p=!1,v&&(v=!1,m(M),M=-1),f=!0;var H=d;try{for(_(W),u=n(l);u!==null&&(!(u.expirationTime>W)||O&&!R());){var Y=u.callback;if(typeof Y=="function"){u.callback=null,d=u.priorityLevel;var z=Y(u.expirationTime<=W);W=t.unstable_now(),typeof z=="function"?u.callback=z:u===n(l)&&i(l),_(W)}else i(l);u=n(l)}if(u!==null)var X=!0;else{var q=n(c);q!==null&&ee(S,q.startTime-W),X=!1}return X}finally{u=null,d=H,f=!1}}var b=!1,T=null,M=-1,E=5,P=-1;function R(){return!(t.unstable_now()-P<E)}function F(){if(T!==null){var O=t.unstable_now();P=O;var W=!0;try{W=T(!0,O)}finally{W?B():(b=!1,T=null)}}else b=!1}var B;if(typeof y=="function")B=function(){y(F)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,j=k.port2;k.port1.onmessage=F,B=function(){j.postMessage(null)}}else B=function(){g(F,0)};function Z(O){T=O,b||(b=!0,B())}function ee(O,W){M=g(function(){O(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,Z(A))},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(O){switch(d){case 1:case 2:case 3:var W=3;break;default:W=d}var H=d;d=W;try{return O()}finally{d=H}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(O,W){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var H=d;d=O;try{return W()}finally{d=H}},t.unstable_scheduleCallback=function(O,W,H){var Y=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?Y+H:Y):H=Y,O){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=H+z,O={id:h++,callback:W,priorityLevel:O,startTime:H,expirationTime:z,sortIndex:-1},H>Y?(O.sortIndex=H,e(c,O),n(l)===null&&O===n(c)&&(v?(m(M),M=-1):v=!0,ee(S,H-Y))):(O.sortIndex=z,e(l,O),p||f||(p=!0,Z(A))),O},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(O){var W=d;return function(){var H=d;d=W;try{return O.apply(this,arguments)}finally{d=H}}}}(ZT)),ZT}var y4;function Zhe(){return y4||(y4=1,JT.exports=Jhe()),JT.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $he=function(e){var n={},i=ge,r=Zhe(),s=Object.assign;function o(x){for(var w="https://reactjs.org/docs/error-decoder.html?invariant="+x,C=1;C<arguments.length;C++)w+="&args[]="+encodeURIComponent(arguments[C]);return"Minified React error #"+x+"; visit "+w+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),u=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),f=Symbol.for("react.provider"),p=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),m=Symbol.for("react.suspense_list"),y=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),S=Symbol.for("react.offscreen"),A=Symbol.iterator;function b(x){return x===null||typeof x!="object"?null:(x=A&&x[A]||x["@@iterator"],typeof x=="function"?x:null)}function T(x){if(x==null)return null;if(typeof x=="function")return x.displayName||x.name||null;if(typeof x=="string")return x;switch(x){case h:return"Fragment";case c:return"Portal";case d:return"Profiler";case u:return"StrictMode";case g:return"Suspense";case m:return"SuspenseList"}if(typeof x=="object")switch(x.$$typeof){case p:return(x.displayName||"Context")+".Consumer";case f:return(x._context.displayName||"Context")+".Provider";case v:var w=x.render;return x=x.displayName,x||(x=w.displayName||w.name||"",x=x!==""?"ForwardRef("+x+")":"ForwardRef"),x;case y:return w=x.displayName||null,w!==null?w:T(x.type)||"Memo";case _:w=x._payload,x=x._init;try{return T(x(w))}catch{}}return null}function M(x){var w=x.type;switch(x.tag){case 24:return"Cache";case 9:return(w.displayName||"Context")+".Consumer";case 10:return(w._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return x=w.render,x=x.displayName||x.name||"",w.displayName||(x!==""?"ForwardRef("+x+")":"ForwardRef");case 7:return"Fragment";case 5:return w;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return T(w);case 8:return w===u?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof w=="function")return w.displayName||w.name||null;if(typeof w=="string")return w}return null}function E(x){var w=x,C=x;if(x.alternate)for(;w.return;)w=w.return;else{x=w;do w=x,w.flags&4098&&(C=w.return),x=w.return;while(x)}return w.tag===3?C:null}function P(x){if(E(x)!==x)throw Error(o(188))}function R(x){var w=x.alternate;if(!w){if(w=E(x),w===null)throw Error(o(188));return w!==x?null:x}for(var C=x,D=w;;){var I=C.return;if(I===null)break;var V=I.alternate;if(V===null){if(D=I.return,D!==null){C=D;continue}break}if(I.child===V.child){for(V=I.child;V;){if(V===C)return P(I),x;if(V===D)return P(I),w;V=V.sibling}throw Error(o(188))}if(C.return!==D.return)C=I,D=V;else{for(var pe=!1,Ce=I.child;Ce;){if(Ce===C){pe=!0,C=I,D=V;break}if(Ce===D){pe=!0,D=I,C=V;break}Ce=Ce.sibling}if(!pe){for(Ce=V.child;Ce;){if(Ce===C){pe=!0,C=V,D=I;break}if(Ce===D){pe=!0,D=V,C=I;break}Ce=Ce.sibling}if(!pe)throw Error(o(189))}}if(C.alternate!==D)throw Error(o(190))}if(C.tag!==3)throw Error(o(188));return C.stateNode.current===C?x:w}function F(x){return x=R(x),x!==null?B(x):null}function B(x){if(x.tag===5||x.tag===6)return x;for(x=x.child;x!==null;){var w=B(x);if(w!==null)return w;x=x.sibling}return null}function k(x){if(x.tag===5||x.tag===6)return x;for(x=x.child;x!==null;){if(x.tag!==4){var w=k(x);if(w!==null)return w}x=x.sibling}return null}var j=Array.isArray,Z=e.getPublicInstance,ee=e.getRootHostContext,O=e.getChildHostContext,W=e.prepareForCommit,H=e.resetAfterCommit,Y=e.createInstance,z=e.appendInitialChild,X=e.finalizeInitialChildren,q=e.prepareUpdate,re=e.shouldSetTextContent,G=e.createTextInstance,K=e.scheduleTimeout,oe=e.cancelTimeout,ve=e.noTimeout,$=e.isPrimaryRenderer,se=e.supportsMutation,ne=e.supportsPersistence,ie=e.supportsHydration,me=e.getInstanceFromNode,xe=e.preparePortalMount,Ae=e.getCurrentEventPriority,we=e.detachDeletedInstance,Ee=e.supportsMicrotasks,Re=e.scheduleMicrotask,Ue=e.supportsTestSelectors,Ne=e.findFiberRoot,U=e.getBoundingRect,L=e.getTextContent,te=e.isHiddenSubtree,_e=e.matchAccessibilityRole,Te=e.setFocusIfFocusable,Ie=e.setupIntersectionObserver,Qe=e.appendChild,Ge=e.appendChildToContainer,ye=e.commitTextUpdate,Ve=e.commitMount,ue=e.commitUpdate,Me=e.insertBefore,Be=e.insertInContainerBefore,ze=e.removeChild,$e=e.removeChildFromContainer,dt=e.resetTextContent,Bt=e.hideInstance,J=e.hideTextInstance,fe=e.unhideInstance,be=e.unhideTextInstance,Oe=e.clearContainer,qe=e.cloneInstance,vt=e.createContainerChildSet,Et=e.appendChildToContainerChildSet,un=e.finalizeContainerChildren,ji=e.replaceContainerChildren,Ot=e.cloneHiddenInstance,jn=e.cloneHiddenTextInstance,Wn=e.canHydrateInstance,sc=e.canHydrateTextInstance,Jf=e.canHydrateSuspenseInstance,Zf=e.isSuspenseInstancePending,nd=e.isSuspenseInstanceFallback,he=e.registerSuspenseInstanceRetry,Q=e.getNextHydratableSibling,de=e.getFirstHydratableChild,le=e.getFirstHydratableChildWithinContainer,ce=e.getFirstHydratableChildWithinSuspenseInstance,De=e.hydrateInstance,Ke=e.hydrateTextInstance,Ze=e.hydrateSuspenseInstance,it=e.getNextHydratableInstanceAfterSuspenseInstance,ht=e.commitHydratedContainer,lt=e.commitHydratedSuspenseInstance,ot=e.clearSuspenseBoundary,Mt=e.clearSuspenseBoundaryFromContainer,Vt=e.shouldDeleteUnhydratedTailInstances,Nn=e.didNotMatchHydratedContainerTextInstance,Si=e.didNotMatchHydratedTextInstance,vn;function yt(x){if(vn===void 0)try{throw Error()}catch(C){var w=C.stack.trim().match(/\n( *(at )?)/);vn=w&&w[1]||""}return`
`+vn+x}var Qt=!1;function fa(x,w){if(!x||Qt)return"";Qt=!0;var C=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(w)if(w=function(){throw Error()},Object.defineProperty(w.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(w,[])}catch(et){var D=et}Reflect.construct(x,[],w)}else{try{w.call()}catch(et){D=et}x.call(w.prototype)}else{try{throw Error()}catch(et){D=et}x()}}catch(et){if(et&&D&&typeof et.stack=="string"){for(var I=et.stack.split(`
`),V=D.stack.split(`
`),pe=I.length-1,Ce=V.length-1;1<=pe&&0<=Ce&&I[pe]!==V[Ce];)Ce--;for(;1<=pe&&0<=Ce;pe--,Ce--)if(I[pe]!==V[Ce]){if(pe!==1||Ce!==1)do if(pe--,Ce--,0>Ce||I[pe]!==V[Ce]){var je=`
`+I[pe].replace(" at new "," at ");return x.displayName&&je.includes("<anonymous>")&&(je=je.replace("<anonymous>",x.displayName)),je}while(1<=pe&&0<=Ce);break}}}finally{Qt=!1,Error.prepareStackTrace=C}return(x=x?x.displayName||x.name:"")?yt(x):""}var Bn=Object.prototype.hasOwnProperty,xs=[],Zr=-1;function or(x){return{current:x}}function Gt(x){0>Zr||(x.current=xs[Zr],xs[Zr]=null,Zr--)}function It(x,w){Zr++,xs[Zr]=x.current,x.current=w}var Ri={},dn=or(Ri),yn=or(!1),Gs=Ri;function pa(x,w){var C=x.type.contextTypes;if(!C)return Ri;var D=x.stateNode;if(D&&D.__reactInternalMemoizedUnmaskedChildContext===w)return D.__reactInternalMemoizedMaskedChildContext;var I={},V;for(V in C)I[V]=w[V];return D&&(x=x.stateNode,x.__reactInternalMemoizedUnmaskedChildContext=w,x.__reactInternalMemoizedMaskedChildContext=I),I}function br(x){return x=x.childContextTypes,x!=null}function F1(){Gt(yn),Gt(dn)}function QF(x,w,C){if(dn.current!==Ri)throw Error(o(168));It(dn,w),It(yn,C)}function KF(x,w,C){var D=x.stateNode;if(w=w.childContextTypes,typeof D.getChildContext!="function")return C;D=D.getChildContext();for(var I in D)if(!(I in w))throw Error(o(108,M(x)||"Unknown",I));return s({},C,D)}function N1(x){return x=(x=x.stateNode)&&x.__reactInternalMemoizedMergedChildContext||Ri,Gs=dn.current,It(dn,x),It(yn,yn.current),!0}function JF(x,w,C){var D=x.stateNode;if(!D)throw Error(o(169));C?(x=KF(x,w,Gs),D.__reactInternalMemoizedMergedChildContext=x,Gt(yn),Gt(dn),It(dn,x)):Gt(yn),It(yn,C)}var ma=Math.clz32?Math.clz32:U$,F$=Math.log,N$=Math.LN2;function U$(x){return x>>>=0,x===0?32:31-(F$(x)/N$|0)|0}var U1=64,k1=4194304;function Sv(x){switch(x&-x){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return x&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return x&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return x}}function z1(x,w){var C=x.pendingLanes;if(C===0)return 0;var D=0,I=x.suspendedLanes,V=x.pingedLanes,pe=C&268435455;if(pe!==0){var Ce=pe&~I;Ce!==0?D=Sv(Ce):(V&=pe,V!==0&&(D=Sv(V)))}else pe=C&~I,pe!==0?D=Sv(pe):V!==0&&(D=Sv(V));if(D===0)return 0;if(w!==0&&w!==D&&!(w&I)&&(I=D&-D,V=w&-w,I>=V||I===16&&(V&4194240)!==0))return w;if(D&4&&(D|=C&16),w=x.entangledLanes,w!==0)for(x=x.entanglements,w&=D;0<w;)C=31-ma(w),I=1<<C,D|=x[C],w&=~I;return D}function k$(x,w){switch(x){case 1:case 2:case 4:return w+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return w+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function z$(x,w){for(var C=x.suspendedLanes,D=x.pingedLanes,I=x.expirationTimes,V=x.pendingLanes;0<V;){var pe=31-ma(V),Ce=1<<pe,je=I[pe];je===-1?(!(Ce&C)||Ce&D)&&(I[pe]=k$(Ce,w)):je<=w&&(x.expiredLanes|=Ce),V&=~Ce}}function VE(x){return x=x.pendingLanes&-1073741825,x!==0?x:x&1073741824?1073741824:0}function jE(x){for(var w=[],C=0;31>C;C++)w.push(x);return w}function bv(x,w,C){x.pendingLanes|=w,w!==536870912&&(x.suspendedLanes=0,x.pingedLanes=0),x=x.eventTimes,w=31-ma(w),x[w]=C}function G$(x,w){var C=x.pendingLanes&~w;x.pendingLanes=w,x.suspendedLanes=0,x.pingedLanes=0,x.expiredLanes&=w,x.mutableReadLanes&=w,x.entangledLanes&=w,w=x.entanglements;var D=x.eventTimes;for(x=x.expirationTimes;0<C;){var I=31-ma(C),V=1<<I;w[I]=0,D[I]=-1,x[I]=-1,C&=~V}}function WE(x,w){var C=x.entangledLanes|=w;for(x=x.entanglements;C;){var D=31-ma(C),I=1<<D;I&w|x[D]&w&&(x[D]|=w),C&=~I}}var xn=0;function ZF(x){return x&=-x,1<x?4<x?x&268435455?16:536870912:4:1}var XE=r.unstable_scheduleCallback,$F=r.unstable_cancelCallback,H$=r.unstable_shouldYield,V$=r.unstable_requestPaint,ar=r.unstable_now,YE=r.unstable_ImmediatePriority,j$=r.unstable_UserBlockingPriority,qE=r.unstable_NormalPriority,W$=r.unstable_IdlePriority,G1=null,sl=null;function X$(x){if(sl&&typeof sl.onCommitFiberRoot=="function")try{sl.onCommitFiberRoot(G1,x,void 0,(x.current.flags&128)===128)}catch{}}function Y$(x,w){return x===w&&(x!==0||1/x===1/w)||x!==x&&w!==w}var ol=typeof Object.is=="function"?Object.is:Y$,oc=null,H1=!1,QE=!1;function eN(x){oc===null?oc=[x]:oc.push(x)}function q$(x){H1=!0,eN(x)}function al(){if(!QE&&oc!==null){QE=!0;var x=0,w=xn;try{var C=oc;for(xn=1;x<C.length;x++){var D=C[x];do D=D(!0);while(D!==null)}oc=null,H1=!1}catch(I){throw oc!==null&&(oc=oc.slice(x+1)),XE(YE,al),I}finally{xn=w,QE=!1}}return null}var Q$=a.ReactCurrentBatchConfig;function V1(x,w){if(ol(x,w))return!0;if(typeof x!="object"||x===null||typeof w!="object"||w===null)return!1;var C=Object.keys(x),D=Object.keys(w);if(C.length!==D.length)return!1;for(D=0;D<C.length;D++){var I=C[D];if(!Bn.call(w,I)||!ol(x[I],w[I]))return!1}return!0}function K$(x){switch(x.tag){case 5:return yt(x.type);case 16:return yt("Lazy");case 13:return yt("Suspense");case 19:return yt("SuspenseList");case 0:case 2:case 15:return x=fa(x.type,!1),x;case 11:return x=fa(x.type.render,!1),x;case 1:return x=fa(x.type,!0),x;default:return""}}function ga(x,w){if(x&&x.defaultProps){w=s({},w),x=x.defaultProps;for(var C in x)w[C]===void 0&&(w[C]=x[C]);return w}return w}var j1=or(null),W1=null,$f=null,KE=null;function JE(){KE=$f=W1=null}function tN(x,w,C){$?(It(j1,w._currentValue),w._currentValue=C):(It(j1,w._currentValue2),w._currentValue2=C)}function ZE(x){var w=j1.current;Gt(j1),$?x._currentValue=w:x._currentValue2=w}function $E(x,w,C){for(;x!==null;){var D=x.alternate;if((x.childLanes&w)!==w?(x.childLanes|=w,D!==null&&(D.childLanes|=w)):D!==null&&(D.childLanes&w)!==w&&(D.childLanes|=w),x===C)break;x=x.return}}function ep(x,w){W1=x,KE=$f=null,x=x.dependencies,x!==null&&x.firstContext!==null&&(x.lanes&w&&(js=!0),x.firstContext=null)}function Mo(x){var w=$?x._currentValue:x._currentValue2;if(KE!==x)if(x={context:x,memoizedValue:w,next:null},$f===null){if(W1===null)throw Error(o(308));$f=x,W1.dependencies={lanes:0,firstContext:x}}else $f=$f.next=x;return w}var ll=null,pu=!1;function eC(x){x.updateQueue={baseState:x.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function nN(x,w){x=x.updateQueue,w.updateQueue===x&&(w.updateQueue={baseState:x.baseState,firstBaseUpdate:x.firstBaseUpdate,lastBaseUpdate:x.lastBaseUpdate,shared:x.shared,effects:x.effects})}function ac(x,w){return{eventTime:x,lane:w,tag:0,payload:null,callback:null,next:null}}function mu(x,w){var C=x.updateQueue;C!==null&&(C=C.shared,Li!==null&&x.mode&1&&!(rn&2)?(x=C.interleaved,x===null?(w.next=w,ll===null?ll=[C]:ll.push(C)):(w.next=x.next,x.next=w),C.interleaved=w):(x=C.pending,x===null?w.next=w:(w.next=x.next,x.next=w),C.pending=w))}function X1(x,w,C){if(w=w.updateQueue,w!==null&&(w=w.shared,(C&4194240)!==0)){var D=w.lanes;D&=x.pendingLanes,C|=D,w.lanes=C,WE(x,C)}}function iN(x,w){var C=x.updateQueue,D=x.alternate;if(D!==null&&(D=D.updateQueue,C===D)){var I=null,V=null;if(C=C.firstBaseUpdate,C!==null){do{var pe={eventTime:C.eventTime,lane:C.lane,tag:C.tag,payload:C.payload,callback:C.callback,next:null};V===null?I=V=pe:V=V.next=pe,C=C.next}while(C!==null);V===null?I=V=w:V=V.next=w}else I=V=w;C={baseState:D.baseState,firstBaseUpdate:I,lastBaseUpdate:V,shared:D.shared,effects:D.effects},x.updateQueue=C;return}x=C.lastBaseUpdate,x===null?C.firstBaseUpdate=w:x.next=w,C.lastBaseUpdate=w}function Y1(x,w,C,D){var I=x.updateQueue;pu=!1;var V=I.firstBaseUpdate,pe=I.lastBaseUpdate,Ce=I.shared.pending;if(Ce!==null){I.shared.pending=null;var je=Ce,et=je.next;je.next=null,pe===null?V=et:pe.next=et,pe=je;var mt=x.alternate;mt!==null&&(mt=mt.updateQueue,Ce=mt.lastBaseUpdate,Ce!==pe&&(Ce===null?mt.firstBaseUpdate=et:Ce.next=et,mt.lastBaseUpdate=je))}if(V!==null){var Xt=I.baseState;pe=0,mt=et=je=null,Ce=V;do{var Tt=Ce.lane,Un=Ce.eventTime;if((D&Tt)===Tt){mt!==null&&(mt=mt.next={eventTime:Un,lane:0,tag:Ce.tag,payload:Ce.payload,callback:Ce.callback,next:null});e:{var bt=x,Ur=Ce;switch(Tt=w,Un=C,Ur.tag){case 1:if(bt=Ur.payload,typeof bt=="function"){Xt=bt.call(Un,Xt,Tt);break e}Xt=bt;break e;case 3:bt.flags=bt.flags&-65537|128;case 0:if(bt=Ur.payload,Tt=typeof bt=="function"?bt.call(Un,Xt,Tt):bt,Tt==null)break e;Xt=s({},Xt,Tt);break e;case 2:pu=!0}}Ce.callback!==null&&Ce.lane!==0&&(x.flags|=64,Tt=I.effects,Tt===null?I.effects=[Ce]:Tt.push(Ce))}else Un={eventTime:Un,lane:Tt,tag:Ce.tag,payload:Ce.payload,callback:Ce.callback,next:null},mt===null?(et=mt=Un,je=Xt):mt=mt.next=Un,pe|=Tt;if(Ce=Ce.next,Ce===null){if(Ce=I.shared.pending,Ce===null)break;Tt=Ce,Ce=Tt.next,Tt.next=null,I.lastBaseUpdate=Tt,I.shared.pending=null}}while(1);if(mt===null&&(je=Xt),I.baseState=je,I.firstBaseUpdate=et,I.lastBaseUpdate=mt,w=I.shared.interleaved,w!==null){I=w;do pe|=I.lane,I=I.next;while(I!==w)}else V===null&&(I.shared.lanes=0);cp|=pe,x.lanes=pe,x.memoizedState=Xt}}function rN(x,w,C){if(x=w.effects,w.effects=null,x!==null)for(w=0;w<x.length;w++){var D=x[w],I=D.callback;if(I!==null){if(D.callback=null,D=C,typeof I!="function")throw Error(o(191,I));I.call(D)}}}var sN=new i.Component().refs;function tC(x,w,C,D){w=x.memoizedState,C=C(D,w),C=C==null?w:s({},w,C),x.memoizedState=C,x.lanes===0&&(x.updateQueue.baseState=C)}var q1={isMounted:function(x){return(x=x._reactInternals)?E(x)===x:!1},enqueueSetState:function(x,w,C){x=x._reactInternals;var D=es(),I=yu(x),V=ac(D,I);V.payload=w,C!=null&&(V.callback=C),mu(x,V),w=Do(x,I,D),w!==null&&X1(w,x,I)},enqueueReplaceState:function(x,w,C){x=x._reactInternals;var D=es(),I=yu(x),V=ac(D,I);V.tag=1,V.payload=w,C!=null&&(V.callback=C),mu(x,V),w=Do(x,I,D),w!==null&&X1(w,x,I)},enqueueForceUpdate:function(x,w){x=x._reactInternals;var C=es(),D=yu(x),I=ac(C,D);I.tag=2,w!=null&&(I.callback=w),mu(x,I),w=Do(x,D,C),w!==null&&X1(w,x,D)}};function oN(x,w,C,D,I,V,pe){return x=x.stateNode,typeof x.shouldComponentUpdate=="function"?x.shouldComponentUpdate(D,V,pe):w.prototype&&w.prototype.isPureReactComponent?!V1(C,D)||!V1(I,V):!0}function aN(x,w,C){var D=!1,I=Ri,V=w.contextType;return typeof V=="object"&&V!==null?V=Mo(V):(I=br(w)?Gs:dn.current,D=w.contextTypes,V=(D=D!=null)?pa(x,I):Ri),w=new w(C,V),x.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=q1,x.stateNode=w,w._reactInternals=x,D&&(x=x.stateNode,x.__reactInternalMemoizedUnmaskedChildContext=I,x.__reactInternalMemoizedMaskedChildContext=V),w}function lN(x,w,C,D){x=w.state,typeof w.componentWillReceiveProps=="function"&&w.componentWillReceiveProps(C,D),typeof w.UNSAFE_componentWillReceiveProps=="function"&&w.UNSAFE_componentWillReceiveProps(C,D),w.state!==x&&q1.enqueueReplaceState(w,w.state,null)}function nC(x,w,C,D){var I=x.stateNode;I.props=C,I.state=x.memoizedState,I.refs=sN,eC(x);var V=w.contextType;typeof V=="object"&&V!==null?I.context=Mo(V):(V=br(w)?Gs:dn.current,I.context=pa(x,V)),I.state=x.memoizedState,V=w.getDerivedStateFromProps,typeof V=="function"&&(tC(x,w,V,C),I.state=x.memoizedState),typeof w.getDerivedStateFromProps=="function"||typeof I.getSnapshotBeforeUpdate=="function"||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(w=I.state,typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount(),w!==I.state&&q1.enqueueReplaceState(I,I.state,null),Y1(x,C,I,D),I.state=x.memoizedState),typeof I.componentDidMount=="function"&&(x.flags|=4194308)}var tp=[],np=0,Q1=null,K1=0,Eo=[],Co=0,id=null,lc=1,cc="";function rd(x,w){tp[np++]=K1,tp[np++]=Q1,Q1=x,K1=w}function cN(x,w,C){Eo[Co++]=lc,Eo[Co++]=cc,Eo[Co++]=id,id=x;var D=lc;x=cc;var I=32-ma(D)-1;D&=~(1<<I),C+=1;var V=32-ma(w)+I;if(30<V){var pe=I-I%5;V=(D&(1<<pe)-1).toString(32),D>>=pe,I-=pe,lc=1<<32-ma(w)+I|C<<I|D,cc=V+x}else lc=1<<V|C<<I|D,cc=x}function iC(x){x.return!==null&&(rd(x,1),cN(x,1,0))}function rC(x){for(;x===Q1;)Q1=tp[--np],tp[np]=null,K1=tp[--np],tp[np]=null;for(;x===id;)id=Eo[--Co],Eo[Co]=null,cc=Eo[--Co],Eo[Co]=null,lc=Eo[--Co],Eo[Co]=null}var Hs=null,Vs=null,Jn=!1,Av=!1,va=null;function uN(x,w){var C=Ro(5,null,null,0);C.elementType="DELETED",C.stateNode=w,C.return=x,w=x.deletions,w===null?(x.deletions=[C],x.flags|=16):w.push(C)}function hN(x,w){switch(x.tag){case 5:return w=Wn(w,x.type,x.pendingProps),w!==null?(x.stateNode=w,Hs=x,Vs=de(w),!0):!1;case 6:return w=sc(w,x.pendingProps),w!==null?(x.stateNode=w,Hs=x,Vs=null,!0):!1;case 13:if(w=Jf(w),w!==null){var C=id!==null?{id:lc,overflow:cc}:null;return x.memoizedState={dehydrated:w,treeContext:C,retryLane:1073741824},C=Ro(18,null,null,0),C.stateNode=w,C.return=x,x.child=C,Hs=x,Vs=null,!0}return!1;default:return!1}}function sC(x){return(x.mode&1)!==0&&(x.flags&128)===0}function oC(x){if(Jn){var w=Vs;if(w){var C=w;if(!hN(x,w)){if(sC(x))throw Error(o(418));w=Q(C);var D=Hs;w&&hN(x,w)?uN(D,C):(x.flags=x.flags&-4097|2,Jn=!1,Hs=x)}}else{if(sC(x))throw Error(o(418));x.flags=x.flags&-4097|2,Jn=!1,Hs=x}}}function dN(x){for(x=x.return;x!==null&&x.tag!==5&&x.tag!==3&&x.tag!==13;)x=x.return;Hs=x}function Mv(x){if(!ie||x!==Hs)return!1;if(!Jn)return dN(x),Jn=!0,!1;if(x.tag!==3&&(x.tag!==5||Vt(x.type)&&!re(x.type,x.memoizedProps))){var w=Vs;if(w){if(sC(x)){for(x=Vs;x;)x=Q(x);throw Error(o(418))}for(;w;)uN(x,w),w=Q(w)}}if(dN(x),x.tag===13){if(!ie)throw Error(o(316));if(x=x.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(o(317));Vs=it(x)}else Vs=Hs?Q(x.stateNode):null;return!0}function ip(){ie&&(Vs=Hs=null,Av=Jn=!1)}function aC(x){va===null?va=[x]:va.push(x)}function Ev(x,w,C){if(x=C.ref,x!==null&&typeof x!="function"&&typeof x!="object"){if(C._owner){if(C=C._owner,C){if(C.tag!==1)throw Error(o(309));var D=C.stateNode}if(!D)throw Error(o(147,x));var I=D,V=""+x;return w!==null&&w.ref!==null&&typeof w.ref=="function"&&w.ref._stringRef===V?w.ref:(w=function(pe){var Ce=I.refs;Ce===sN&&(Ce=I.refs={}),pe===null?delete Ce[V]:Ce[V]=pe},w._stringRef=V,w)}if(typeof x!="string")throw Error(o(284));if(!C._owner)throw Error(o(290,x))}return x}function J1(x,w){throw x=Object.prototype.toString.call(w),Error(o(31,x==="[object Object]"?"object with keys {"+Object.keys(w).join(", ")+"}":x))}function fN(x){var w=x._init;return w(x._payload)}function pN(x){function w(Fe,Pe){if(x){var He=Fe.deletions;He===null?(Fe.deletions=[Pe],Fe.flags|=16):He.push(Pe)}}function C(Fe,Pe){if(!x)return null;for(;Pe!==null;)w(Fe,Pe),Pe=Pe.sibling;return null}function D(Fe,Pe){for(Fe=new Map;Pe!==null;)Pe.key!==null?Fe.set(Pe.key,Pe):Fe.set(Pe.index,Pe),Pe=Pe.sibling;return Fe}function I(Fe,Pe){return Fe=_u(Fe,Pe),Fe.index=0,Fe.sibling=null,Fe}function V(Fe,Pe,He){return Fe.index=He,x?(He=Fe.alternate,He!==null?(He=He.index,He<Pe?(Fe.flags|=2,Pe):He):(Fe.flags|=2,Pe)):(Fe.flags|=1048576,Pe)}function pe(Fe){return x&&Fe.alternate===null&&(Fe.flags|=2),Fe}function Ce(Fe,Pe,He,ct){return Pe===null||Pe.tag!==6?(Pe=jC(He,Fe.mode,ct),Pe.return=Fe,Pe):(Pe=I(Pe,He),Pe.return=Fe,Pe)}function je(Fe,Pe,He,ct){var St=He.type;return St===h?mt(Fe,Pe,He.props.children,ct,He.key):Pe!==null&&(Pe.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===_&&fN(St)===Pe.type)?(ct=I(Pe,He.props),ct.ref=Ev(Fe,Pe,He),ct.return=Fe,ct):(ct=T_(He.type,He.key,He.props,null,Fe.mode,ct),ct.ref=Ev(Fe,Pe,He),ct.return=Fe,ct)}function et(Fe,Pe,He,ct){return Pe===null||Pe.tag!==4||Pe.stateNode.containerInfo!==He.containerInfo||Pe.stateNode.implementation!==He.implementation?(Pe=WC(He,Fe.mode,ct),Pe.return=Fe,Pe):(Pe=I(Pe,He.children||[]),Pe.return=Fe,Pe)}function mt(Fe,Pe,He,ct,St){return Pe===null||Pe.tag!==7?(Pe=hd(He,Fe.mode,ct,St),Pe.return=Fe,Pe):(Pe=I(Pe,He),Pe.return=Fe,Pe)}function Xt(Fe,Pe,He){if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number")return Pe=jC(""+Pe,Fe.mode,He),Pe.return=Fe,Pe;if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case l:return He=T_(Pe.type,Pe.key,Pe.props,null,Fe.mode,He),He.ref=Ev(Fe,null,Pe),He.return=Fe,He;case c:return Pe=WC(Pe,Fe.mode,He),Pe.return=Fe,Pe;case _:var ct=Pe._init;return Xt(Fe,ct(Pe._payload),He)}if(j(Pe)||b(Pe))return Pe=hd(Pe,Fe.mode,He,null),Pe.return=Fe,Pe;J1(Fe,Pe)}return null}function Tt(Fe,Pe,He,ct){var St=Pe!==null?Pe.key:null;if(typeof He=="string"&&He!==""||typeof He=="number")return St!==null?null:Ce(Fe,Pe,""+He,ct);if(typeof He=="object"&&He!==null){switch(He.$$typeof){case l:return He.key===St?je(Fe,Pe,He,ct):null;case c:return He.key===St?et(Fe,Pe,He,ct):null;case _:return St=He._init,Tt(Fe,Pe,St(He._payload),ct)}if(j(He)||b(He))return St!==null?null:mt(Fe,Pe,He,ct,null);J1(Fe,He)}return null}function Un(Fe,Pe,He,ct,St){if(typeof ct=="string"&&ct!==""||typeof ct=="number")return Fe=Fe.get(He)||null,Ce(Pe,Fe,""+ct,St);if(typeof ct=="object"&&ct!==null){switch(ct.$$typeof){case l:return Fe=Fe.get(ct.key===null?He:ct.key)||null,je(Pe,Fe,ct,St);case c:return Fe=Fe.get(ct.key===null?He:ct.key)||null,et(Pe,Fe,ct,St);case _:var en=ct._init;return Un(Fe,Pe,He,en(ct._payload),St)}if(j(ct)||b(ct))return Fe=Fe.get(He)||null,mt(Pe,Fe,ct,St,null);J1(Pe,ct)}return null}function bt(Fe,Pe,He,ct){for(var St=null,en=null,Yt=Pe,_n=Pe=0,cr=null;Yt!==null&&_n<He.length;_n++){Yt.index>_n?(cr=Yt,Yt=null):cr=Yt.sibling;var wn=Tt(Fe,Yt,He[_n],ct);if(wn===null){Yt===null&&(Yt=cr);break}x&&Yt&&wn.alternate===null&&w(Fe,Yt),Pe=V(wn,Pe,_n),en===null?St=wn:en.sibling=wn,en=wn,Yt=cr}if(_n===He.length)return C(Fe,Yt),Jn&&rd(Fe,_n),St;if(Yt===null){for(;_n<He.length;_n++)Yt=Xt(Fe,He[_n],ct),Yt!==null&&(Pe=V(Yt,Pe,_n),en===null?St=Yt:en.sibling=Yt,en=Yt);return Jn&&rd(Fe,_n),St}for(Yt=D(Fe,Yt);_n<He.length;_n++)cr=Un(Yt,Fe,_n,He[_n],ct),cr!==null&&(x&&cr.alternate!==null&&Yt.delete(cr.key===null?_n:cr.key),Pe=V(cr,Pe,_n),en===null?St=cr:en.sibling=cr,en=cr);return x&&Yt.forEach(function(wu){return w(Fe,wu)}),Jn&&rd(Fe,_n),St}function Ur(Fe,Pe,He,ct){var St=b(He);if(typeof St!="function")throw Error(o(150));if(He=St.call(He),He==null)throw Error(o(151));for(var en=St=null,Yt=Pe,_n=Pe=0,cr=null,wn=He.next();Yt!==null&&!wn.done;_n++,wn=He.next()){Yt.index>_n?(cr=Yt,Yt=null):cr=Yt.sibling;var wu=Tt(Fe,Yt,wn.value,ct);if(wu===null){Yt===null&&(Yt=cr);break}x&&Yt&&wu.alternate===null&&w(Fe,Yt),Pe=V(wu,Pe,_n),en===null?St=wu:en.sibling=wu,en=wu,Yt=cr}if(wn.done)return C(Fe,Yt),Jn&&rd(Fe,_n),St;if(Yt===null){for(;!wn.done;_n++,wn=He.next())wn=Xt(Fe,wn.value,ct),wn!==null&&(Pe=V(wn,Pe,_n),en===null?St=wn:en.sibling=wn,en=wn);return Jn&&rd(Fe,_n),St}for(Yt=D(Fe,Yt);!wn.done;_n++,wn=He.next())wn=Un(Yt,Fe,_n,wn.value,ct),wn!==null&&(x&&wn.alternate!==null&&Yt.delete(wn.key===null?_n:wn.key),Pe=V(wn,Pe,_n),en===null?St=wn:en.sibling=wn,en=wn);return x&&Yt.forEach(function(Eee){return w(Fe,Eee)}),Jn&&rd(Fe,_n),St}function Lo(Fe,Pe,He,ct){if(typeof He=="object"&&He!==null&&He.type===h&&He.key===null&&(He=He.props.children),typeof He=="object"&&He!==null){switch(He.$$typeof){case l:e:{for(var St=He.key,en=Pe;en!==null;){if(en.key===St){if(St=He.type,St===h){if(en.tag===7){C(Fe,en.sibling),Pe=I(en,He.props.children),Pe.return=Fe,Fe=Pe;break e}}else if(en.elementType===St||typeof St=="object"&&St!==null&&St.$$typeof===_&&fN(St)===en.type){C(Fe,en.sibling),Pe=I(en,He.props),Pe.ref=Ev(Fe,en,He),Pe.return=Fe,Fe=Pe;break e}C(Fe,en);break}else w(Fe,en);en=en.sibling}He.type===h?(Pe=hd(He.props.children,Fe.mode,ct,He.key),Pe.return=Fe,Fe=Pe):(ct=T_(He.type,He.key,He.props,null,Fe.mode,ct),ct.ref=Ev(Fe,Pe,He),ct.return=Fe,Fe=ct)}return pe(Fe);case c:e:{for(en=He.key;Pe!==null;){if(Pe.key===en)if(Pe.tag===4&&Pe.stateNode.containerInfo===He.containerInfo&&Pe.stateNode.implementation===He.implementation){C(Fe,Pe.sibling),Pe=I(Pe,He.children||[]),Pe.return=Fe,Fe=Pe;break e}else{C(Fe,Pe);break}else w(Fe,Pe);Pe=Pe.sibling}Pe=WC(He,Fe.mode,ct),Pe.return=Fe,Fe=Pe}return pe(Fe);case _:return en=He._init,Lo(Fe,Pe,en(He._payload),ct)}if(j(He))return bt(Fe,Pe,He,ct);if(b(He))return Ur(Fe,Pe,He,ct);J1(Fe,He)}return typeof He=="string"&&He!==""||typeof He=="number"?(He=""+He,Pe!==null&&Pe.tag===6?(C(Fe,Pe.sibling),Pe=I(Pe,He),Pe.return=Fe,Fe=Pe):(C(Fe,Pe),Pe=jC(He,Fe.mode,ct),Pe.return=Fe,Fe=Pe),pe(Fe)):C(Fe,Pe)}return Lo}var rp=pN(!0),mN=pN(!1),Cv={},To=or(Cv),Tv=or(Cv),sp=or(Cv);function cl(x){if(x===Cv)throw Error(o(174));return x}function lC(x,w){It(sp,w),It(Tv,x),It(To,Cv),x=ee(w),Gt(To),It(To,x)}function op(){Gt(To),Gt(Tv),Gt(sp)}function gN(x){var w=cl(sp.current),C=cl(To.current);w=O(C,x.type,w),C!==w&&(It(Tv,x),It(To,w))}function cC(x){Tv.current===x&&(Gt(To),Gt(Tv))}var ii=or(0);function Z1(x){for(var w=x;w!==null;){if(w.tag===13){var C=w.memoizedState;if(C!==null&&(C=C.dehydrated,C===null||Zf(C)||nd(C)))return w}else if(w.tag===19&&w.memoizedProps.revealOrder!==void 0){if(w.flags&128)return w}else if(w.child!==null){w.child.return=w,w=w.child;continue}if(w===x)break;for(;w.sibling===null;){if(w.return===null||w.return===x)return null;w=w.return}w.sibling.return=w.return,w=w.sibling}return null}var uC=[];function hC(){for(var x=0;x<uC.length;x++){var w=uC[x];$?w._workInProgressVersionPrimary=null:w._workInProgressVersionSecondary=null}uC.length=0}var $1=a.ReactCurrentDispatcher,Po=a.ReactCurrentBatchConfig,ap=0,fi=null,Or=null,lr=null,e_=!1,Pv=!1,Dv=0,J$=0;function Fr(){throw Error(o(321))}function dC(x,w){if(w===null)return!1;for(var C=0;C<w.length&&C<x.length;C++)if(!ol(x[C],w[C]))return!1;return!0}function fC(x,w,C,D,I,V){if(ap=V,fi=w,w.memoizedState=null,w.updateQueue=null,w.lanes=0,$1.current=x===null||x.memoizedState===null?tee:nee,x=C(D,I),Pv){V=0;do{if(Pv=!1,Dv=0,25<=V)throw Error(o(301));V+=1,lr=Or=null,w.updateQueue=null,$1.current=iee,x=C(D,I)}while(Pv)}if($1.current=s_,w=Or!==null&&Or.next!==null,ap=0,lr=Or=fi=null,e_=!1,w)throw Error(o(300));return x}function pC(){var x=Dv!==0;return Dv=0,x}function uc(){var x={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return lr===null?fi.memoizedState=lr=x:lr=lr.next=x,lr}function ul(){if(Or===null){var x=fi.alternate;x=x!==null?x.memoizedState:null}else x=Or.next;var w=lr===null?fi.memoizedState:lr.next;if(w!==null)lr=w,Or=x;else{if(x===null)throw Error(o(310));Or=x,x={memoizedState:Or.memoizedState,baseState:Or.baseState,baseQueue:Or.baseQueue,queue:Or.queue,next:null},lr===null?fi.memoizedState=lr=x:lr=lr.next=x}return lr}function sd(x,w){return typeof w=="function"?w(x):w}function t_(x){var w=ul(),C=w.queue;if(C===null)throw Error(o(311));C.lastRenderedReducer=x;var D=Or,I=D.baseQueue,V=C.pending;if(V!==null){if(I!==null){var pe=I.next;I.next=V.next,V.next=pe}D.baseQueue=I=V,C.pending=null}if(I!==null){V=I.next,D=D.baseState;var Ce=pe=null,je=null,et=V;do{var mt=et.lane;if((ap&mt)===mt)je!==null&&(je=je.next={lane:0,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null}),D=et.hasEagerState?et.eagerState:x(D,et.action);else{var Xt={lane:mt,action:et.action,hasEagerState:et.hasEagerState,eagerState:et.eagerState,next:null};je===null?(Ce=je=Xt,pe=D):je=je.next=Xt,fi.lanes|=mt,cp|=mt}et=et.next}while(et!==null&&et!==V);je===null?pe=D:je.next=Ce,ol(D,w.memoizedState)||(js=!0),w.memoizedState=D,w.baseState=pe,w.baseQueue=je,C.lastRenderedState=D}if(x=C.interleaved,x!==null){I=x;do V=I.lane,fi.lanes|=V,cp|=V,I=I.next;while(I!==x)}else I===null&&(C.lanes=0);return[w.memoizedState,C.dispatch]}function n_(x){var w=ul(),C=w.queue;if(C===null)throw Error(o(311));C.lastRenderedReducer=x;var D=C.dispatch,I=C.pending,V=w.memoizedState;if(I!==null){C.pending=null;var pe=I=I.next;do V=x(V,pe.action),pe=pe.next;while(pe!==I);ol(V,w.memoizedState)||(js=!0),w.memoizedState=V,w.baseQueue===null&&(w.baseState=V),C.lastRenderedState=V}return[V,D]}function vN(){}function yN(x,w){var C=fi,D=ul(),I=w(),V=!ol(D.memoizedState,I);if(V&&(D.memoizedState=I,js=!0),D=D.queue,Lv(wN.bind(null,C,D,x),[x]),D.getSnapshot!==w||V||lr!==null&&lr.memoizedState.tag&1){if(C.flags|=2048,Rv(9,_N.bind(null,C,D,I,w),void 0,null),Li===null)throw Error(o(349));ap&30||xN(C,w,I)}return I}function xN(x,w,C){x.flags|=16384,x={getSnapshot:w,value:C},w=fi.updateQueue,w===null?(w={lastEffect:null,stores:null},fi.updateQueue=w,w.stores=[x]):(C=w.stores,C===null?w.stores=[x]:C.push(x))}function _N(x,w,C,D){w.value=C,w.getSnapshot=D,SN(w)&&Do(x,1,-1)}function wN(x,w,C){return C(function(){SN(w)&&Do(x,1,-1)})}function SN(x){var w=x.getSnapshot;x=x.value;try{var C=w();return!ol(x,C)}catch{return!0}}function mC(x){var w=uc();return typeof x=="function"&&(x=x()),w.memoizedState=w.baseState=x,x={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sd,lastRenderedState:x},w.queue=x,x=x.dispatch=eee.bind(null,fi,x),[w.memoizedState,x]}function Rv(x,w,C,D){return x={tag:x,create:w,destroy:C,deps:D,next:null},w=fi.updateQueue,w===null?(w={lastEffect:null,stores:null},fi.updateQueue=w,w.lastEffect=x.next=x):(C=w.lastEffect,C===null?w.lastEffect=x.next=x:(D=C.next,C.next=x,x.next=D,w.lastEffect=x)),x}function bN(){return ul().memoizedState}function i_(x,w,C,D){var I=uc();fi.flags|=x,I.memoizedState=Rv(1|w,C,void 0,D===void 0?null:D)}function r_(x,w,C,D){var I=ul();D=D===void 0?null:D;var V=void 0;if(Or!==null){var pe=Or.memoizedState;if(V=pe.destroy,D!==null&&dC(D,pe.deps)){I.memoizedState=Rv(w,C,V,D);return}}fi.flags|=x,I.memoizedState=Rv(1|w,C,V,D)}function gC(x,w){return i_(8390656,8,x,w)}function Lv(x,w){return r_(2048,8,x,w)}function AN(x,w){return r_(4,2,x,w)}function MN(x,w){return r_(4,4,x,w)}function EN(x,w){if(typeof w=="function")return x=x(),w(x),function(){w(null)};if(w!=null)return x=x(),w.current=x,function(){w.current=null}}function CN(x,w,C){return C=C!=null?C.concat([x]):null,r_(4,4,EN.bind(null,w,x),C)}function vC(){}function TN(x,w){var C=ul();w=w===void 0?null:w;var D=C.memoizedState;return D!==null&&w!==null&&dC(w,D[1])?D[0]:(C.memoizedState=[x,w],x)}function PN(x,w){var C=ul();w=w===void 0?null:w;var D=C.memoizedState;return D!==null&&w!==null&&dC(w,D[1])?D[0]:(x=x(),C.memoizedState=[x,w],x)}function Z$(x,w){var C=xn;xn=C!==0&&4>C?C:4,x(!0);var D=Po.transition;Po.transition={};try{x(!1),w()}finally{xn=C,Po.transition=D}}function DN(){return ul().memoizedState}function $$(x,w,C){var D=yu(x);C={lane:D,action:C,hasEagerState:!1,eagerState:null,next:null},RN(x)?LN(w,C):(IN(x,w,C),C=es(),x=Do(x,D,C),x!==null&&BN(x,w,D))}function eee(x,w,C){var D=yu(x),I={lane:D,action:C,hasEagerState:!1,eagerState:null,next:null};if(RN(x))LN(w,I);else{IN(x,w,I);var V=x.alternate;if(x.lanes===0&&(V===null||V.lanes===0)&&(V=w.lastRenderedReducer,V!==null))try{var pe=w.lastRenderedState,Ce=V(pe,C);if(I.hasEagerState=!0,I.eagerState=Ce,ol(Ce,pe))return}catch{}finally{}C=es(),x=Do(x,D,C),x!==null&&BN(x,w,D)}}function RN(x){var w=x.alternate;return x===fi||w!==null&&w===fi}function LN(x,w){Pv=e_=!0;var C=x.pending;C===null?w.next=w:(w.next=C.next,C.next=w),x.pending=w}function IN(x,w,C){Li!==null&&x.mode&1&&!(rn&2)?(x=w.interleaved,x===null?(C.next=C,ll===null?ll=[w]:ll.push(w)):(C.next=x.next,x.next=C),w.interleaved=C):(x=w.pending,x===null?C.next=C:(C.next=x.next,x.next=C),w.pending=C)}function BN(x,w,C){if(C&4194240){var D=w.lanes;D&=x.pendingLanes,C|=D,w.lanes=C,WE(x,C)}}var s_={readContext:Mo,useCallback:Fr,useContext:Fr,useEffect:Fr,useImperativeHandle:Fr,useInsertionEffect:Fr,useLayoutEffect:Fr,useMemo:Fr,useReducer:Fr,useRef:Fr,useState:Fr,useDebugValue:Fr,useDeferredValue:Fr,useTransition:Fr,useMutableSource:Fr,useSyncExternalStore:Fr,useId:Fr,unstable_isNewReconciler:!1},tee={readContext:Mo,useCallback:function(x,w){return uc().memoizedState=[x,w===void 0?null:w],x},useContext:Mo,useEffect:gC,useImperativeHandle:function(x,w,C){return C=C!=null?C.concat([x]):null,i_(4194308,4,EN.bind(null,w,x),C)},useLayoutEffect:function(x,w){return i_(4194308,4,x,w)},useInsertionEffect:function(x,w){return i_(4,2,x,w)},useMemo:function(x,w){var C=uc();return w=w===void 0?null:w,x=x(),C.memoizedState=[x,w],x},useReducer:function(x,w,C){var D=uc();return w=C!==void 0?C(w):w,D.memoizedState=D.baseState=w,x={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:x,lastRenderedState:w},D.queue=x,x=x.dispatch=$$.bind(null,fi,x),[D.memoizedState,x]},useRef:function(x){var w=uc();return x={current:x},w.memoizedState=x},useState:mC,useDebugValue:vC,useDeferredValue:function(x){var w=mC(x),C=w[0],D=w[1];return gC(function(){var I=Po.transition;Po.transition={};try{D(x)}finally{Po.transition=I}},[x]),C},useTransition:function(){var x=mC(!1),w=x[0];return x=Z$.bind(null,x[1]),uc().memoizedState=x,[w,x]},useMutableSource:function(){},useSyncExternalStore:function(x,w,C){var D=fi,I=uc();if(Jn){if(C===void 0)throw Error(o(407));C=C()}else{if(C=w(),Li===null)throw Error(o(349));ap&30||xN(D,w,C)}I.memoizedState=C;var V={value:C,getSnapshot:w};return I.queue=V,gC(wN.bind(null,D,V,x),[x]),D.flags|=2048,Rv(9,_N.bind(null,D,V,C,w),void 0,null),C},useId:function(){var x=uc(),w=Li.identifierPrefix;if(Jn){var C=cc,D=lc;C=(D&~(1<<32-ma(D)-1)).toString(32)+C,w=":"+w+"R"+C,C=Dv++,0<C&&(w+="H"+C.toString(32)),w+=":"}else C=J$++,w=":"+w+"r"+C.toString(32)+":";return x.memoizedState=w},unstable_isNewReconciler:!1},nee={readContext:Mo,useCallback:TN,useContext:Mo,useEffect:Lv,useImperativeHandle:CN,useInsertionEffect:AN,useLayoutEffect:MN,useMemo:PN,useReducer:t_,useRef:bN,useState:function(){return t_(sd)},useDebugValue:vC,useDeferredValue:function(x){var w=t_(sd),C=w[0],D=w[1];return Lv(function(){var I=Po.transition;Po.transition={};try{D(x)}finally{Po.transition=I}},[x]),C},useTransition:function(){var x=t_(sd)[0],w=ul().memoizedState;return[x,w]},useMutableSource:vN,useSyncExternalStore:yN,useId:DN,unstable_isNewReconciler:!1},iee={readContext:Mo,useCallback:TN,useContext:Mo,useEffect:Lv,useImperativeHandle:CN,useInsertionEffect:AN,useLayoutEffect:MN,useMemo:PN,useReducer:n_,useRef:bN,useState:function(){return n_(sd)},useDebugValue:vC,useDeferredValue:function(x){var w=n_(sd),C=w[0],D=w[1];return Lv(function(){var I=Po.transition;Po.transition={};try{D(x)}finally{Po.transition=I}},[x]),C},useTransition:function(){var x=n_(sd)[0],w=ul().memoizedState;return[x,w]},useMutableSource:vN,useSyncExternalStore:yN,useId:DN,unstable_isNewReconciler:!1};function yC(x,w){try{var C="",D=w;do C+=K$(D),D=D.return;while(D);var I=C}catch(V){I=`
Error generating stack: `+V.message+`
`+V.stack}return{value:x,source:w,stack:I}}function xC(x,w){try{console.error(w.value)}catch(C){setTimeout(function(){throw C})}}var ree=typeof WeakMap=="function"?WeakMap:Map;function ON(x,w,C){C=ac(-1,C),C.tag=3,C.payload={element:null};var D=w.value;return C.callback=function(){w_||(w_=!0,NC=D),xC(x,w)},C}function FN(x,w,C){C=ac(-1,C),C.tag=3;var D=x.type.getDerivedStateFromError;if(typeof D=="function"){var I=w.value;C.payload=function(){return D(I)},C.callback=function(){xC(x,w)}}var V=x.stateNode;return V!==null&&typeof V.componentDidCatch=="function"&&(C.callback=function(){xC(x,w),typeof D!="function"&&(gu===null?gu=new Set([this]):gu.add(this));var pe=w.stack;this.componentDidCatch(w.value,{componentStack:pe!==null?pe:""})}),C}function NN(x,w,C){var D=x.pingCache;if(D===null){D=x.pingCache=new ree;var I=new Set;D.set(w,I)}else I=D.get(w),I===void 0&&(I=new Set,D.set(w,I));I.has(C)||(I.add(C),x=yee.bind(null,x,w,C),w.then(x,x))}function UN(x){do{var w;if((w=x.tag===13)&&(w=x.memoizedState,w=w!==null?w.dehydrated!==null:!0),w)return x;x=x.return}while(x!==null);return null}function kN(x,w,C,D,I){return x.mode&1?(x.flags|=65536,x.lanes=I,x):(x===w?x.flags|=65536:(x.flags|=128,C.flags|=131072,C.flags&=-52805,C.tag===1&&(C.alternate===null?C.tag=17:(w=ac(-1,1),w.tag=2,mu(C,w))),C.lanes|=1),x)}function hl(x){x.flags|=4}function zN(x,w){if(x!==null&&x.child===w.child)return!0;if(w.flags&16)return!1;for(x=w.child;x!==null;){if(x.flags&12854||x.subtreeFlags&12854)return!1;x=x.sibling}return!0}var Iv,Bv,o_,a_;if(se)Iv=function(x,w){for(var C=w.child;C!==null;){if(C.tag===5||C.tag===6)z(x,C.stateNode);else if(C.tag!==4&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===w)break;for(;C.sibling===null;){if(C.return===null||C.return===w)return;C=C.return}C.sibling.return=C.return,C=C.sibling}},Bv=function(){},o_=function(x,w,C,D,I){if(x=x.memoizedProps,x!==D){var V=w.stateNode,pe=cl(To.current);C=q(V,C,x,D,I,pe),(w.updateQueue=C)&&hl(w)}},a_=function(x,w,C,D){C!==D&&hl(w)};else if(ne){Iv=function(x,w,C,D){for(var I=w.child;I!==null;){if(I.tag===5){var V=I.stateNode;C&&D&&(V=Ot(V,I.type,I.memoizedProps,I)),z(x,V)}else if(I.tag===6)V=I.stateNode,C&&D&&(V=jn(V,I.memoizedProps,I)),z(x,V);else if(I.tag!==4){if(I.tag===22&&I.memoizedState!==null)V=I.child,V!==null&&(V.return=I),Iv(x,I,!0,!0);else if(I.child!==null){I.child.return=I,I=I.child;continue}}if(I===w)break;for(;I.sibling===null;){if(I.return===null||I.return===w)return;I=I.return}I.sibling.return=I.return,I=I.sibling}};var GN=function(x,w,C,D){for(var I=w.child;I!==null;){if(I.tag===5){var V=I.stateNode;C&&D&&(V=Ot(V,I.type,I.memoizedProps,I)),Et(x,V)}else if(I.tag===6)V=I.stateNode,C&&D&&(V=jn(V,I.memoizedProps,I)),Et(x,V);else if(I.tag!==4){if(I.tag===22&&I.memoizedState!==null)V=I.child,V!==null&&(V.return=I),GN(x,I,!0,!0);else if(I.child!==null){I.child.return=I,I=I.child;continue}}if(I===w)break;for(;I.sibling===null;){if(I.return===null||I.return===w)return;I=I.return}I.sibling.return=I.return,I=I.sibling}};Bv=function(x,w){var C=w.stateNode;if(!zN(x,w)){x=C.containerInfo;var D=vt(x);GN(D,w,!1,!1),C.pendingChildren=D,hl(w),un(x,D)}},o_=function(x,w,C,D,I){var V=x.stateNode,pe=x.memoizedProps;if((x=zN(x,w))&&pe===D)w.stateNode=V;else{var Ce=w.stateNode,je=cl(To.current),et=null;pe!==D&&(et=q(Ce,C,pe,D,I,je)),x&&et===null?w.stateNode=V:(V=qe(V,et,C,pe,D,w,x,Ce),X(V,C,D,I,je)&&hl(w),w.stateNode=V,x?hl(w):Iv(V,w,!1,!1))}},a_=function(x,w,C,D){C!==D?(x=cl(sp.current),C=cl(To.current),w.stateNode=G(D,x,C,w),hl(w)):w.stateNode=x.stateNode}}else Bv=function(){},o_=function(){},a_=function(){};function Ov(x,w){if(!Jn)switch(x.tailMode){case"hidden":w=x.tail;for(var C=null;w!==null;)w.alternate!==null&&(C=w),w=w.sibling;C===null?x.tail=null:C.sibling=null;break;case"collapsed":C=x.tail;for(var D=null;C!==null;)C.alternate!==null&&(D=C),C=C.sibling;D===null?w||x.tail===null?x.tail=null:x.tail.sibling=null:D.sibling=null}}function Nr(x){var w=x.alternate!==null&&x.alternate.child===x.child,C=0,D=0;if(w)for(var I=x.child;I!==null;)C|=I.lanes|I.childLanes,D|=I.subtreeFlags&14680064,D|=I.flags&14680064,I.return=x,I=I.sibling;else for(I=x.child;I!==null;)C|=I.lanes|I.childLanes,D|=I.subtreeFlags,D|=I.flags,I.return=x,I=I.sibling;return x.subtreeFlags|=D,x.childLanes=C,w}function see(x,w,C){var D=w.pendingProps;switch(rC(w),w.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nr(w),null;case 1:return br(w.type)&&F1(),Nr(w),null;case 3:return D=w.stateNode,op(),Gt(yn),Gt(dn),hC(),D.pendingContext&&(D.context=D.pendingContext,D.pendingContext=null),(x===null||x.child===null)&&(Mv(w)?hl(w):x===null||x.memoizedState.isDehydrated&&!(w.flags&256)||(w.flags|=1024,va!==null&&(zC(va),va=null))),Bv(x,w),Nr(w),null;case 5:cC(w),C=cl(sp.current);var I=w.type;if(x!==null&&w.stateNode!=null)o_(x,w,I,D,C),x.ref!==w.ref&&(w.flags|=512,w.flags|=2097152);else{if(!D){if(w.stateNode===null)throw Error(o(166));return Nr(w),null}if(x=cl(To.current),Mv(w)){if(!ie)throw Error(o(175));x=De(w.stateNode,w.type,w.memoizedProps,C,x,w,!Av),w.updateQueue=x,x!==null&&hl(w)}else{var V=Y(I,D,C,x,w);Iv(V,w,!1,!1),w.stateNode=V,X(V,I,D,C,x)&&hl(w)}w.ref!==null&&(w.flags|=512,w.flags|=2097152)}return Nr(w),null;case 6:if(x&&w.stateNode!=null)a_(x,w,x.memoizedProps,D);else{if(typeof D!="string"&&w.stateNode===null)throw Error(o(166));if(x=cl(sp.current),C=cl(To.current),Mv(w)){if(!ie)throw Error(o(176));if(x=w.stateNode,D=w.memoizedProps,(C=Ke(x,D,w,!Av))&&(I=Hs,I!==null))switch(V=(I.mode&1)!==0,I.tag){case 3:Nn(I.stateNode.containerInfo,x,D,V);break;case 5:Si(I.type,I.memoizedProps,I.stateNode,x,D,V)}C&&hl(w)}else w.stateNode=G(D,x,C,w)}return Nr(w),null;case 13:if(Gt(ii),D=w.memoizedState,Jn&&Vs!==null&&w.mode&1&&!(w.flags&128)){for(x=Vs;x;)x=Q(x);return ip(),w.flags|=98560,w}if(D!==null&&D.dehydrated!==null){if(D=Mv(w),x===null){if(!D)throw Error(o(318));if(!ie)throw Error(o(344));if(x=w.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(o(317));Ze(x,w)}else ip(),!(w.flags&128)&&(w.memoizedState=null),w.flags|=4;return Nr(w),null}return va!==null&&(zC(va),va=null),w.flags&128?(w.lanes=C,w):(D=D!==null,C=!1,x===null?Mv(w):C=x.memoizedState!==null,D&&!C&&(w.child.flags|=8192,w.mode&1&&(x===null||ii.current&1?Wi===0&&(Wi=3):HC())),w.updateQueue!==null&&(w.flags|=4),Nr(w),null);case 4:return op(),Bv(x,w),x===null&&xe(w.stateNode.containerInfo),Nr(w),null;case 10:return ZE(w.type._context),Nr(w),null;case 17:return br(w.type)&&F1(),Nr(w),null;case 19:if(Gt(ii),I=w.memoizedState,I===null)return Nr(w),null;if(D=(w.flags&128)!==0,V=I.rendering,V===null)if(D)Ov(I,!1);else{if(Wi!==0||x!==null&&x.flags&128)for(x=w.child;x!==null;){if(V=Z1(x),V!==null){for(w.flags|=128,Ov(I,!1),x=V.updateQueue,x!==null&&(w.updateQueue=x,w.flags|=4),w.subtreeFlags=0,x=C,D=w.child;D!==null;)C=D,I=x,C.flags&=14680066,V=C.alternate,V===null?(C.childLanes=0,C.lanes=I,C.child=null,C.subtreeFlags=0,C.memoizedProps=null,C.memoizedState=null,C.updateQueue=null,C.dependencies=null,C.stateNode=null):(C.childLanes=V.childLanes,C.lanes=V.lanes,C.child=V.child,C.subtreeFlags=0,C.deletions=null,C.memoizedProps=V.memoizedProps,C.memoizedState=V.memoizedState,C.updateQueue=V.updateQueue,C.type=V.type,I=V.dependencies,C.dependencies=I===null?null:{lanes:I.lanes,firstContext:I.firstContext}),D=D.sibling;return It(ii,ii.current&1|2),w.child}x=x.sibling}I.tail!==null&&ar()>FC&&(w.flags|=128,D=!0,Ov(I,!1),w.lanes=4194304)}else{if(!D)if(x=Z1(V),x!==null){if(w.flags|=128,D=!0,x=x.updateQueue,x!==null&&(w.updateQueue=x,w.flags|=4),Ov(I,!0),I.tail===null&&I.tailMode==="hidden"&&!V.alternate&&!Jn)return Nr(w),null}else 2*ar()-I.renderingStartTime>FC&&C!==1073741824&&(w.flags|=128,D=!0,Ov(I,!1),w.lanes=4194304);I.isBackwards?(V.sibling=w.child,w.child=V):(x=I.last,x!==null?x.sibling=V:w.child=V,I.last=V)}return I.tail!==null?(w=I.tail,I.rendering=w,I.tail=w.sibling,I.renderingStartTime=ar(),w.sibling=null,x=ii.current,It(ii,D?x&1|2:x&1),w):(Nr(w),null);case 22:case 23:return GC(),D=w.memoizedState!==null,x!==null&&x.memoizedState!==null!==D&&(w.flags|=8192),D&&w.mode&1?Ws&1073741824&&(Nr(w),se&&w.subtreeFlags&6&&(w.flags|=8192)):Nr(w),null;case 24:return null;case 25:return null}throw Error(o(156,w.tag))}var oee=a.ReactCurrentOwner,js=!1;function $r(x,w,C,D){w.child=x===null?mN(w,null,C,D):rp(w,x.child,C,D)}function HN(x,w,C,D,I){C=C.render;var V=w.ref;return ep(w,I),D=fC(x,w,C,D,V,I),C=pC(),x!==null&&!js?(w.updateQueue=x.updateQueue,w.flags&=-2053,x.lanes&=~I,hc(x,w,I)):(Jn&&C&&iC(w),w.flags|=1,$r(x,w,D,I),w.child)}function VN(x,w,C,D,I){if(x===null){var V=C.type;return typeof V=="function"&&!VC(V)&&V.defaultProps===void 0&&C.compare===null&&C.defaultProps===void 0?(w.tag=15,w.type=V,jN(x,w,V,D,I)):(x=T_(C.type,null,D,w,w.mode,I),x.ref=w.ref,x.return=w,w.child=x)}if(V=x.child,!(x.lanes&I)){var pe=V.memoizedProps;if(C=C.compare,C=C!==null?C:V1,C(pe,D)&&x.ref===w.ref)return hc(x,w,I)}return w.flags|=1,x=_u(V,D),x.ref=w.ref,x.return=w,w.child=x}function jN(x,w,C,D,I){if(x!==null&&V1(x.memoizedProps,D)&&x.ref===w.ref)if(js=!1,(x.lanes&I)!==0)x.flags&131072&&(js=!0);else return w.lanes=x.lanes,hc(x,w,I);return _C(x,w,C,D,I)}function WN(x,w,C){var D=w.pendingProps,I=D.children,V=x!==null?x.memoizedState:null;if(D.mode==="hidden")if(!(w.mode&1))w.memoizedState={baseLanes:0,cachePool:null},It(lp,Ws),Ws|=C;else if(C&1073741824)w.memoizedState={baseLanes:0,cachePool:null},D=V!==null?V.baseLanes:C,It(lp,Ws),Ws|=D;else return x=V!==null?V.baseLanes|C:C,w.lanes=w.childLanes=1073741824,w.memoizedState={baseLanes:x,cachePool:null},w.updateQueue=null,It(lp,Ws),Ws|=x,null;else V!==null?(D=V.baseLanes|C,w.memoizedState=null):D=C,It(lp,Ws),Ws|=D;return $r(x,w,I,C),w.child}function XN(x,w){var C=w.ref;(x===null&&C!==null||x!==null&&x.ref!==C)&&(w.flags|=512,w.flags|=2097152)}function _C(x,w,C,D,I){var V=br(C)?Gs:dn.current;return V=pa(w,V),ep(w,I),C=fC(x,w,C,D,V,I),D=pC(),x!==null&&!js?(w.updateQueue=x.updateQueue,w.flags&=-2053,x.lanes&=~I,hc(x,w,I)):(Jn&&D&&iC(w),w.flags|=1,$r(x,w,C,I),w.child)}function YN(x,w,C,D,I){if(br(C)){var V=!0;N1(w)}else V=!1;if(ep(w,I),w.stateNode===null)x!==null&&(x.alternate=null,w.alternate=null,w.flags|=2),aN(w,C,D),nC(w,C,D,I),D=!0;else if(x===null){var pe=w.stateNode,Ce=w.memoizedProps;pe.props=Ce;var je=pe.context,et=C.contextType;typeof et=="object"&&et!==null?et=Mo(et):(et=br(C)?Gs:dn.current,et=pa(w,et));var mt=C.getDerivedStateFromProps,Xt=typeof mt=="function"||typeof pe.getSnapshotBeforeUpdate=="function";Xt||typeof pe.UNSAFE_componentWillReceiveProps!="function"&&typeof pe.componentWillReceiveProps!="function"||(Ce!==D||je!==et)&&lN(w,pe,D,et),pu=!1;var Tt=w.memoizedState;pe.state=Tt,Y1(w,D,pe,I),je=w.memoizedState,Ce!==D||Tt!==je||yn.current||pu?(typeof mt=="function"&&(tC(w,C,mt,D),je=w.memoizedState),(Ce=pu||oN(w,C,Ce,D,Tt,je,et))?(Xt||typeof pe.UNSAFE_componentWillMount!="function"&&typeof pe.componentWillMount!="function"||(typeof pe.componentWillMount=="function"&&pe.componentWillMount(),typeof pe.UNSAFE_componentWillMount=="function"&&pe.UNSAFE_componentWillMount()),typeof pe.componentDidMount=="function"&&(w.flags|=4194308)):(typeof pe.componentDidMount=="function"&&(w.flags|=4194308),w.memoizedProps=D,w.memoizedState=je),pe.props=D,pe.state=je,pe.context=et,D=Ce):(typeof pe.componentDidMount=="function"&&(w.flags|=4194308),D=!1)}else{pe=w.stateNode,nN(x,w),Ce=w.memoizedProps,et=w.type===w.elementType?Ce:ga(w.type,Ce),pe.props=et,Xt=w.pendingProps,Tt=pe.context,je=C.contextType,typeof je=="object"&&je!==null?je=Mo(je):(je=br(C)?Gs:dn.current,je=pa(w,je));var Un=C.getDerivedStateFromProps;(mt=typeof Un=="function"||typeof pe.getSnapshotBeforeUpdate=="function")||typeof pe.UNSAFE_componentWillReceiveProps!="function"&&typeof pe.componentWillReceiveProps!="function"||(Ce!==Xt||Tt!==je)&&lN(w,pe,D,je),pu=!1,Tt=w.memoizedState,pe.state=Tt,Y1(w,D,pe,I);var bt=w.memoizedState;Ce!==Xt||Tt!==bt||yn.current||pu?(typeof Un=="function"&&(tC(w,C,Un,D),bt=w.memoizedState),(et=pu||oN(w,C,et,D,Tt,bt,je)||!1)?(mt||typeof pe.UNSAFE_componentWillUpdate!="function"&&typeof pe.componentWillUpdate!="function"||(typeof pe.componentWillUpdate=="function"&&pe.componentWillUpdate(D,bt,je),typeof pe.UNSAFE_componentWillUpdate=="function"&&pe.UNSAFE_componentWillUpdate(D,bt,je)),typeof pe.componentDidUpdate=="function"&&(w.flags|=4),typeof pe.getSnapshotBeforeUpdate=="function"&&(w.flags|=1024)):(typeof pe.componentDidUpdate!="function"||Ce===x.memoizedProps&&Tt===x.memoizedState||(w.flags|=4),typeof pe.getSnapshotBeforeUpdate!="function"||Ce===x.memoizedProps&&Tt===x.memoizedState||(w.flags|=1024),w.memoizedProps=D,w.memoizedState=bt),pe.props=D,pe.state=bt,pe.context=je,D=et):(typeof pe.componentDidUpdate!="function"||Ce===x.memoizedProps&&Tt===x.memoizedState||(w.flags|=4),typeof pe.getSnapshotBeforeUpdate!="function"||Ce===x.memoizedProps&&Tt===x.memoizedState||(w.flags|=1024),D=!1)}return wC(x,w,C,D,V,I)}function wC(x,w,C,D,I,V){XN(x,w);var pe=(w.flags&128)!==0;if(!D&&!pe)return I&&JF(w,C,!1),hc(x,w,V);D=w.stateNode,oee.current=w;var Ce=pe&&typeof C.getDerivedStateFromError!="function"?null:D.render();return w.flags|=1,x!==null&&pe?(w.child=rp(w,x.child,null,V),w.child=rp(w,null,Ce,V)):$r(x,w,Ce,V),w.memoizedState=D.state,I&&JF(w,C,!0),w.child}function qN(x){var w=x.stateNode;w.pendingContext?QF(x,w.pendingContext,w.pendingContext!==w.context):w.context&&QF(x,w.context,!1),lC(x,w.containerInfo)}function QN(x,w,C,D,I){return ip(),aC(I),w.flags|=256,$r(x,w,C,D),w.child}var l_={dehydrated:null,treeContext:null,retryLane:0};function c_(x){return{baseLanes:x,cachePool:null}}function KN(x,w,C){var D=w.pendingProps,I=ii.current,V=!1,pe=(w.flags&128)!==0,Ce;if((Ce=pe)||(Ce=x!==null&&x.memoizedState===null?!1:(I&2)!==0),Ce?(V=!0,w.flags&=-129):(x===null||x.memoizedState!==null)&&(I|=1),It(ii,I&1),x===null)return oC(w),x=w.memoizedState,x!==null&&(x=x.dehydrated,x!==null)?(w.mode&1?nd(x)?w.lanes=8:w.lanes=1073741824:w.lanes=1,null):(I=D.children,x=D.fallback,V?(D=w.mode,V=w.child,I={mode:"hidden",children:I},!(D&1)&&V!==null?(V.childLanes=0,V.pendingProps=I):V=P_(I,D,0,null),x=hd(x,D,C,null),V.return=w,x.return=w,V.sibling=x,w.child=V,w.child.memoizedState=c_(C),w.memoizedState=l_,x):SC(w,I));if(I=x.memoizedState,I!==null){if(Ce=I.dehydrated,Ce!==null){if(pe)return w.flags&256?(w.flags&=-257,u_(x,w,C,Error(o(422)))):w.memoizedState!==null?(w.child=x.child,w.flags|=128,null):(V=D.fallback,I=w.mode,D=P_({mode:"visible",children:D.children},I,0,null),V=hd(V,I,C,null),V.flags|=2,D.return=w,V.return=w,D.sibling=V,w.child=D,w.mode&1&&rp(w,x.child,null,C),w.child.memoizedState=c_(C),w.memoizedState=l_,V);if(!(w.mode&1))w=u_(x,w,C,null);else if(nd(Ce))w=u_(x,w,C,Error(o(419)));else if(D=(C&x.childLanes)!==0,js||D){if(D=Li,D!==null){switch(C&-C){case 4:V=2;break;case 16:V=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:V=32;break;case 536870912:V=268435456;break;default:V=0}D=V&(D.suspendedLanes|C)?0:V,D!==0&&D!==I.retryLane&&(I.retryLane=D,Do(x,D,-1))}HC(),w=u_(x,w,C,Error(o(421)))}else Zf(Ce)?(w.flags|=128,w.child=x.child,w=xee.bind(null,x),he(Ce,w),w=null):(C=I.treeContext,ie&&(Vs=ce(Ce),Hs=w,Jn=!0,va=null,Av=!1,C!==null&&(Eo[Co++]=lc,Eo[Co++]=cc,Eo[Co++]=id,lc=C.id,cc=C.overflow,id=w)),w=SC(w,w.pendingProps.children),w.flags|=4096);return w}return V?(D=ZN(x,w,D.children,D.fallback,C),V=w.child,I=x.child.memoizedState,V.memoizedState=I===null?c_(C):{baseLanes:I.baseLanes|C,cachePool:null},V.childLanes=x.childLanes&~C,w.memoizedState=l_,D):(C=JN(x,w,D.children,C),w.memoizedState=null,C)}return V?(D=ZN(x,w,D.children,D.fallback,C),V=w.child,I=x.child.memoizedState,V.memoizedState=I===null?c_(C):{baseLanes:I.baseLanes|C,cachePool:null},V.childLanes=x.childLanes&~C,w.memoizedState=l_,D):(C=JN(x,w,D.children,C),w.memoizedState=null,C)}function SC(x,w){return w=P_({mode:"visible",children:w},x.mode,0,null),w.return=x,x.child=w}function JN(x,w,C,D){var I=x.child;return x=I.sibling,C=_u(I,{mode:"visible",children:C}),!(w.mode&1)&&(C.lanes=D),C.return=w,C.sibling=null,x!==null&&(D=w.deletions,D===null?(w.deletions=[x],w.flags|=16):D.push(x)),w.child=C}function ZN(x,w,C,D,I){var V=w.mode;x=x.child;var pe=x.sibling,Ce={mode:"hidden",children:C};return!(V&1)&&w.child!==x?(C=w.child,C.childLanes=0,C.pendingProps=Ce,w.deletions=null):(C=_u(x,Ce),C.subtreeFlags=x.subtreeFlags&14680064),pe!==null?D=_u(pe,D):(D=hd(D,V,I,null),D.flags|=2),D.return=w,C.return=w,C.sibling=D,w.child=C,D}function u_(x,w,C,D){return D!==null&&aC(D),rp(w,x.child,null,C),x=SC(w,w.pendingProps.children),x.flags|=2,w.memoizedState=null,x}function $N(x,w,C){x.lanes|=w;var D=x.alternate;D!==null&&(D.lanes|=w),$E(x.return,w,C)}function bC(x,w,C,D,I){var V=x.memoizedState;V===null?x.memoizedState={isBackwards:w,rendering:null,renderingStartTime:0,last:D,tail:C,tailMode:I}:(V.isBackwards=w,V.rendering=null,V.renderingStartTime=0,V.last=D,V.tail=C,V.tailMode=I)}function eU(x,w,C){var D=w.pendingProps,I=D.revealOrder,V=D.tail;if($r(x,w,D.children,C),D=ii.current,D&2)D=D&1|2,w.flags|=128;else{if(x!==null&&x.flags&128)e:for(x=w.child;x!==null;){if(x.tag===13)x.memoizedState!==null&&$N(x,C,w);else if(x.tag===19)$N(x,C,w);else if(x.child!==null){x.child.return=x,x=x.child;continue}if(x===w)break e;for(;x.sibling===null;){if(x.return===null||x.return===w)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}D&=1}if(It(ii,D),!(w.mode&1))w.memoizedState=null;else switch(I){case"forwards":for(C=w.child,I=null;C!==null;)x=C.alternate,x!==null&&Z1(x)===null&&(I=C),C=C.sibling;C=I,C===null?(I=w.child,w.child=null):(I=C.sibling,C.sibling=null),bC(w,!1,I,C,V);break;case"backwards":for(C=null,I=w.child,w.child=null;I!==null;){if(x=I.alternate,x!==null&&Z1(x)===null){w.child=I;break}x=I.sibling,I.sibling=C,C=I,I=x}bC(w,!0,C,null,V);break;case"together":bC(w,!1,null,null,void 0);break;default:w.memoizedState=null}return w.child}function hc(x,w,C){if(x!==null&&(w.dependencies=x.dependencies),cp|=w.lanes,!(C&w.childLanes))return null;if(x!==null&&w.child!==x.child)throw Error(o(153));if(w.child!==null){for(x=w.child,C=_u(x,x.pendingProps),w.child=C,C.return=w;x.sibling!==null;)x=x.sibling,C=C.sibling=_u(x,x.pendingProps),C.return=w;C.sibling=null}return w.child}function aee(x,w,C){switch(w.tag){case 3:qN(w),ip();break;case 5:gN(w);break;case 1:br(w.type)&&N1(w);break;case 4:lC(w,w.stateNode.containerInfo);break;case 10:tN(w,w.type._context,w.memoizedProps.value);break;case 13:var D=w.memoizedState;if(D!==null)return D.dehydrated!==null?(It(ii,ii.current&1),w.flags|=128,null):C&w.child.childLanes?KN(x,w,C):(It(ii,ii.current&1),x=hc(x,w,C),x!==null?x.sibling:null);It(ii,ii.current&1);break;case 19:if(D=(C&w.childLanes)!==0,x.flags&128){if(D)return eU(x,w,C);w.flags|=128}var I=w.memoizedState;if(I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),It(ii,ii.current),D)break;return null;case 22:case 23:return w.lanes=0,WN(x,w,C)}return hc(x,w,C)}function lee(x,w){switch(rC(w),w.tag){case 1:return br(w.type)&&F1(),x=w.flags,x&65536?(w.flags=x&-65537|128,w):null;case 3:return op(),Gt(yn),Gt(dn),hC(),x=w.flags,x&65536&&!(x&128)?(w.flags=x&-65537|128,w):null;case 5:return cC(w),null;case 13:if(Gt(ii),x=w.memoizedState,x!==null&&x.dehydrated!==null){if(w.alternate===null)throw Error(o(340));ip()}return x=w.flags,x&65536?(w.flags=x&-65537|128,w):null;case 19:return Gt(ii),null;case 4:return op(),null;case 10:return ZE(w.type._context),null;case 22:case 23:return GC(),null;case 24:return null;default:return null}}var h_=!1,od=!1,cee=typeof WeakSet=="function"?WeakSet:Set,at=null;function d_(x,w){var C=x.ref;if(C!==null)if(typeof C=="function")try{C(null)}catch(D){Ss(x,w,D)}else C.current=null}function AC(x,w,C){try{C()}catch(D){Ss(x,w,D)}}var tU=!1;function uee(x,w){for(W(x.containerInfo),at=w;at!==null;)if(x=at,w=x.child,(x.subtreeFlags&1028)!==0&&w!==null)w.return=x,at=w;else for(;at!==null;){x=at;try{var C=x.alternate;if(x.flags&1024)switch(x.tag){case 0:case 11:case 15:break;case 1:if(C!==null){var D=C.memoizedProps,I=C.memoizedState,V=x.stateNode,pe=V.getSnapshotBeforeUpdate(x.elementType===x.type?D:ga(x.type,D),I);V.__reactInternalSnapshotBeforeUpdate=pe}break;case 3:se&&Oe(x.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(Ce){Ss(x,x.return,Ce)}if(w=x.sibling,w!==null){w.return=x.return,at=w;break}at=x.return}return C=tU,tU=!1,C}function ad(x,w,C){var D=w.updateQueue;if(D=D!==null?D.lastEffect:null,D!==null){var I=D=D.next;do{if((I.tag&x)===x){var V=I.destroy;I.destroy=void 0,V!==void 0&&AC(w,C,V)}I=I.next}while(I!==D)}}function Fv(x,w){if(w=w.updateQueue,w=w!==null?w.lastEffect:null,w!==null){var C=w=w.next;do{if((C.tag&x)===x){var D=C.create;C.destroy=D()}C=C.next}while(C!==w)}}function MC(x){var w=x.ref;if(w!==null){var C=x.stateNode;switch(x.tag){case 5:x=Z(C);break;default:x=C}typeof w=="function"?w(x):w.current=x}}function nU(x,w,C){if(sl&&typeof sl.onCommitFiberUnmount=="function")try{sl.onCommitFiberUnmount(G1,w)}catch{}switch(w.tag){case 0:case 11:case 14:case 15:if(x=w.updateQueue,x!==null&&(x=x.lastEffect,x!==null)){var D=x=x.next;do{var I=D,V=I.destroy;I=I.tag,V!==void 0&&(I&2||I&4)&&AC(w,C,V),D=D.next}while(D!==x)}break;case 1:if(d_(w,C),x=w.stateNode,typeof x.componentWillUnmount=="function")try{x.props=w.memoizedProps,x.state=w.memoizedState,x.componentWillUnmount()}catch(pe){Ss(w,C,pe)}break;case 5:d_(w,C);break;case 4:se?lU(x,w,C):ne&&ne&&(w=w.stateNode.containerInfo,C=vt(w),ji(w,C))}}function iU(x,w,C){for(var D=w;;)if(nU(x,D,C),D.child===null||se&&D.tag===4){if(D===w)break;for(;D.sibling===null;){if(D.return===null||D.return===w)return;D=D.return}D.sibling.return=D.return,D=D.sibling}else D.child.return=D,D=D.child}function rU(x){var w=x.alternate;w!==null&&(x.alternate=null,rU(w)),x.child=null,x.deletions=null,x.sibling=null,x.tag===5&&(w=x.stateNode,w!==null&&we(w)),x.stateNode=null,x.return=null,x.dependencies=null,x.memoizedProps=null,x.memoizedState=null,x.pendingProps=null,x.stateNode=null,x.updateQueue=null}function sU(x){return x.tag===5||x.tag===3||x.tag===4}function oU(x){e:for(;;){for(;x.sibling===null;){if(x.return===null||sU(x.return))return null;x=x.return}for(x.sibling.return=x.return,x=x.sibling;x.tag!==5&&x.tag!==6&&x.tag!==18;){if(x.flags&2||x.child===null||x.tag===4)continue e;x.child.return=x,x=x.child}if(!(x.flags&2))return x.stateNode}}function aU(x){if(se){e:{for(var w=x.return;w!==null;){if(sU(w))break e;w=w.return}throw Error(o(160))}var C=w;switch(C.tag){case 5:w=C.stateNode,C.flags&32&&(dt(w),C.flags&=-33),C=oU(x),CC(x,C,w);break;case 3:case 4:w=C.stateNode.containerInfo,C=oU(x),EC(x,C,w);break;default:throw Error(o(161))}}}function EC(x,w,C){var D=x.tag;if(D===5||D===6)x=x.stateNode,w?Be(C,x,w):Ge(C,x);else if(D!==4&&(x=x.child,x!==null))for(EC(x,w,C),x=x.sibling;x!==null;)EC(x,w,C),x=x.sibling}function CC(x,w,C){var D=x.tag;if(D===5||D===6)x=x.stateNode,w?Me(C,x,w):Qe(C,x);else if(D!==4&&(x=x.child,x!==null))for(CC(x,w,C),x=x.sibling;x!==null;)CC(x,w,C),x=x.sibling}function lU(x,w,C){for(var D=w,I=!1,V,pe;;){if(!I){I=D.return;e:for(;;){if(I===null)throw Error(o(160));switch(V=I.stateNode,I.tag){case 5:pe=!1;break e;case 3:V=V.containerInfo,pe=!0;break e;case 4:V=V.containerInfo,pe=!0;break e}I=I.return}I=!0}if(D.tag===5||D.tag===6)iU(x,D,C),pe?$e(V,D.stateNode):ze(V,D.stateNode);else if(D.tag===18)pe?Mt(V,D.stateNode):ot(V,D.stateNode);else if(D.tag===4){if(D.child!==null){V=D.stateNode.containerInfo,pe=!0,D.child.return=D,D=D.child;continue}}else if(nU(x,D,C),D.child!==null){D.child.return=D,D=D.child;continue}if(D===w)break;for(;D.sibling===null;){if(D.return===null||D.return===w)return;D=D.return,D.tag===4&&(I=!1)}D.sibling.return=D.return,D=D.sibling}}function TC(x,w){if(se){switch(w.tag){case 0:case 11:case 14:case 15:ad(3,w,w.return),Fv(3,w),ad(5,w,w.return);return;case 1:return;case 5:var C=w.stateNode;if(C!=null){var D=w.memoizedProps;x=x!==null?x.memoizedProps:D;var I=w.type,V=w.updateQueue;w.updateQueue=null,V!==null&&ue(C,V,I,x,D,w)}return;case 6:if(w.stateNode===null)throw Error(o(162));C=w.memoizedProps,ye(w.stateNode,x!==null?x.memoizedProps:C,C);return;case 3:ie&&x!==null&&x.memoizedState.isDehydrated&&ht(w.stateNode.containerInfo);return;case 12:return;case 13:f_(w);return;case 19:f_(w);return;case 17:return}throw Error(o(163))}switch(w.tag){case 0:case 11:case 14:case 15:ad(3,w,w.return),Fv(3,w),ad(5,w,w.return);return;case 12:return;case 13:f_(w);return;case 19:f_(w);return;case 3:ie&&x!==null&&x.memoizedState.isDehydrated&&ht(w.stateNode.containerInfo);break;case 22:case 23:return}e:if(ne){switch(w.tag){case 1:case 5:case 6:break e;case 3:case 4:w=w.stateNode,ji(w.containerInfo,w.pendingChildren);break e}throw Error(o(163))}}function f_(x){var w=x.updateQueue;if(w!==null){x.updateQueue=null;var C=x.stateNode;C===null&&(C=x.stateNode=new cee),w.forEach(function(D){var I=_ee.bind(null,x,D);C.has(D)||(C.add(D),D.then(I,I))})}}function hee(x,w){for(at=w;at!==null;){w=at;var C=w.deletions;if(C!==null)for(var D=0;D<C.length;D++){var I=C[D];try{var V=x;se?lU(V,I,w):iU(V,I,w);var pe=I.alternate;pe!==null&&(pe.return=null),I.return=null}catch(St){Ss(I,w,St)}}if(C=w.child,w.subtreeFlags&12854&&C!==null)C.return=w,at=C;else for(;at!==null;){w=at;try{var Ce=w.flags;if(Ce&32&&se&&dt(w.stateNode),Ce&512){var je=w.alternate;if(je!==null){var et=je.ref;et!==null&&(typeof et=="function"?et(null):et.current=null)}}if(Ce&8192)switch(w.tag){case 13:if(w.memoizedState!==null){var mt=w.alternate;(mt===null||mt.memoizedState===null)&&(OC=ar())}break;case 22:var Xt=w.memoizedState!==null,Tt=w.alternate,Un=Tt!==null&&Tt.memoizedState!==null;if(C=w,se){e:if(D=C,I=Xt,V=null,se)for(var bt=D;;){if(bt.tag===5){if(V===null){V=bt;var Ur=bt.stateNode;I?Bt(Ur):fe(bt.stateNode,bt.memoizedProps)}}else if(bt.tag===6){if(V===null){var Lo=bt.stateNode;I?J(Lo):be(Lo,bt.memoizedProps)}}else if((bt.tag!==22&&bt.tag!==23||bt.memoizedState===null||bt===D)&&bt.child!==null){bt.child.return=bt,bt=bt.child;continue}if(bt===D)break;for(;bt.sibling===null;){if(bt.return===null||bt.return===D)break e;V===bt&&(V=null),bt=bt.return}V===bt&&(V=null),bt.sibling.return=bt.return,bt=bt.sibling}}if(Xt&&!Un&&C.mode&1){at=C;for(var Fe=C.child;Fe!==null;){for(C=at=Fe;at!==null;){D=at;var Pe=D.child;switch(D.tag){case 0:case 11:case 14:case 15:ad(4,D,D.return);break;case 1:d_(D,D.return);var He=D.stateNode;if(typeof He.componentWillUnmount=="function"){var ct=D.return;try{He.props=D.memoizedProps,He.state=D.memoizedState,He.componentWillUnmount()}catch(St){Ss(D,ct,St)}}break;case 5:d_(D,D.return);break;case 22:if(D.memoizedState!==null){hU(C);continue}}Pe!==null?(Pe.return=D,at=Pe):hU(C)}Fe=Fe.sibling}}}switch(Ce&4102){case 2:aU(w),w.flags&=-3;break;case 6:aU(w),w.flags&=-3,TC(w.alternate,w);break;case 4096:w.flags&=-4097;break;case 4100:w.flags&=-4097,TC(w.alternate,w);break;case 4:TC(w.alternate,w)}}catch(St){Ss(w,w.return,St)}if(C=w.sibling,C!==null){C.return=w.return,at=C;break}at=w.return}}}function dee(x,w,C){at=x,cU(x)}function cU(x,w,C){for(var D=(x.mode&1)!==0;at!==null;){var I=at,V=I.child;if(I.tag===22&&D){var pe=I.memoizedState!==null||h_;if(!pe){var Ce=I.alternate,je=Ce!==null&&Ce.memoizedState!==null||od;Ce=h_;var et=od;if(h_=pe,(od=je)&&!et)for(at=I;at!==null;)pe=at,je=pe.child,pe.tag===22&&pe.memoizedState!==null?dU(I):je!==null?(je.return=pe,at=je):dU(I);for(;V!==null;)at=V,cU(V),V=V.sibling;at=I,h_=Ce,od=et}uU(x)}else I.subtreeFlags&8772&&V!==null?(V.return=I,at=V):uU(x)}}function uU(x){for(;at!==null;){var w=at;if(w.flags&8772){var C=w.alternate;try{if(w.flags&8772)switch(w.tag){case 0:case 11:case 15:od||Fv(5,w);break;case 1:var D=w.stateNode;if(w.flags&4&&!od)if(C===null)D.componentDidMount();else{var I=w.elementType===w.type?C.memoizedProps:ga(w.type,C.memoizedProps);D.componentDidUpdate(I,C.memoizedState,D.__reactInternalSnapshotBeforeUpdate)}var V=w.updateQueue;V!==null&&rN(w,V,D);break;case 3:var pe=w.updateQueue;if(pe!==null){if(C=null,w.child!==null)switch(w.child.tag){case 5:C=Z(w.child.stateNode);break;case 1:C=w.child.stateNode}rN(w,pe,C)}break;case 5:var Ce=w.stateNode;C===null&&w.flags&4&&Ve(Ce,w.type,w.memoizedProps,w);break;case 6:break;case 4:break;case 12:break;case 13:if(ie&&w.memoizedState===null){var je=w.alternate;if(je!==null){var et=je.memoizedState;if(et!==null){var mt=et.dehydrated;mt!==null&&lt(mt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}od||w.flags&512&&MC(w)}catch(Xt){Ss(w,w.return,Xt)}}if(w===x){at=null;break}if(C=w.sibling,C!==null){C.return=w.return,at=C;break}at=w.return}}function hU(x){for(;at!==null;){var w=at;if(w===x){at=null;break}var C=w.sibling;if(C!==null){C.return=w.return,at=C;break}at=w.return}}function dU(x){for(;at!==null;){var w=at;try{switch(w.tag){case 0:case 11:case 15:var C=w.return;try{Fv(4,w)}catch(je){Ss(w,C,je)}break;case 1:var D=w.stateNode;if(typeof D.componentDidMount=="function"){var I=w.return;try{D.componentDidMount()}catch(je){Ss(w,I,je)}}var V=w.return;try{MC(w)}catch(je){Ss(w,V,je)}break;case 5:var pe=w.return;try{MC(w)}catch(je){Ss(w,pe,je)}}}catch(je){Ss(w,w.return,je)}if(w===x){at=null;break}var Ce=w.sibling;if(Ce!==null){Ce.return=w.return,at=Ce;break}at=w.return}}var p_=0,m_=1,g_=2,v_=3,y_=4;if(typeof Symbol=="function"&&Symbol.for){var Nv=Symbol.for;p_=Nv("selector.component"),m_=Nv("selector.has_pseudo_class"),g_=Nv("selector.role"),v_=Nv("selector.test_id"),y_=Nv("selector.text")}function PC(x){var w=me(x);if(w!=null){if(typeof w.memoizedProps["data-testname"]!="string")throw Error(o(364));return w}if(x=Ne(x),x===null)throw Error(o(362));return x.stateNode.current}function DC(x,w){switch(w.$$typeof){case p_:if(x.type===w.value)return!0;break;case m_:e:{w=w.value,x=[x,0];for(var C=0;C<x.length;){var D=x[C++],I=x[C++],V=w[I];if(D.tag!==5||!te(D)){for(;V!=null&&DC(D,V);)I++,V=w[I];if(I===w.length){w=!0;break e}else for(D=D.child;D!==null;)x.push(D,I),D=D.sibling}}w=!1}return w;case g_:if(x.tag===5&&_e(x.stateNode,w.value))return!0;break;case y_:if((x.tag===5||x.tag===6)&&(x=L(x),x!==null&&0<=x.indexOf(w.value)))return!0;break;case v_:if(x.tag===5&&(x=x.memoizedProps["data-testname"],typeof x=="string"&&x.toLowerCase()===w.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function RC(x){switch(x.$$typeof){case p_:return"<"+(T(x.value)||"Unknown")+">";case m_:return":has("+(RC(x)||"")+")";case g_:return'[role="'+x.value+'"]';case y_:return'"'+x.value+'"';case v_:return'[data-testname="'+x.value+'"]';default:throw Error(o(365))}}function fU(x,w){var C=[];x=[x,0];for(var D=0;D<x.length;){var I=x[D++],V=x[D++],pe=w[V];if(I.tag!==5||!te(I)){for(;pe!=null&&DC(I,pe);)V++,pe=w[V];if(V===w.length)C.push(I);else for(I=I.child;I!==null;)x.push(I,V),I=I.sibling}}return C}function LC(x,w){if(!Ue)throw Error(o(363));x=PC(x),x=fU(x,w),w=[],x=Array.from(x);for(var C=0;C<x.length;){var D=x[C++];if(D.tag===5)te(D)||w.push(D.stateNode);else for(D=D.child;D!==null;)x.push(D),D=D.sibling}return w}var fee=Math.ceil,x_=a.ReactCurrentDispatcher,IC=a.ReactCurrentOwner,bi=a.ReactCurrentBatchConfig,rn=0,Li=null,Ii=null,Ar=0,Ws=0,lp=or(0),Wi=0,Uv=null,cp=0,__=0,BC=0,kv=null,_s=null,OC=0,FC=1/0;function up(){FC=ar()+500}var w_=!1,NC=null,gu=null,S_=!1,vu=null,b_=0,zv=0,UC=null,A_=-1,M_=0;function es(){return rn&6?ar():A_!==-1?A_:A_=ar()}function yu(x){return x.mode&1?rn&2&&Ar!==0?Ar&-Ar:Q$.transition!==null?(M_===0&&(x=U1,U1<<=1,!(U1&4194240)&&(U1=64),M_=x),M_):(x=xn,x!==0?x:Ae()):1}function Do(x,w,C){if(50<zv)throw zv=0,UC=null,Error(o(185));var D=E_(x,w);return D===null?null:(bv(D,w,C),(!(rn&2)||D!==Li)&&(D===Li&&(!(rn&2)&&(__|=w),Wi===4&&xu(D,Ar)),ws(D,C),w===1&&rn===0&&!(x.mode&1)&&(up(),H1&&al())),D)}function E_(x,w){x.lanes|=w;var C=x.alternate;for(C!==null&&(C.lanes|=w),C=x,x=x.return;x!==null;)x.childLanes|=w,C=x.alternate,C!==null&&(C.childLanes|=w),C=x,x=x.return;return C.tag===3?C.stateNode:null}function ws(x,w){var C=x.callbackNode;z$(x,w);var D=z1(x,x===Li?Ar:0);if(D===0)C!==null&&$F(C),x.callbackNode=null,x.callbackPriority=0;else if(w=D&-D,x.callbackPriority!==w){if(C!=null&&$F(C),w===1)x.tag===0?q$(mU.bind(null,x)):eN(mU.bind(null,x)),Ee?Re(function(){rn===0&&al()}):XE(YE,al),C=null;else{switch(ZF(D)){case 1:C=YE;break;case 4:C=j$;break;case 16:C=qE;break;case 536870912:C=W$;break;default:C=qE}C=AU(C,pU.bind(null,x))}x.callbackPriority=w,x.callbackNode=C}}function pU(x,w){if(A_=-1,M_=0,rn&6)throw Error(o(327));var C=x.callbackNode;if(ud()&&x.callbackNode!==C)return null;var D=z1(x,x===Li?Ar:0);if(D===0)return null;if(D&30||D&x.expiredLanes||w)w=C_(x,D);else{w=D;var I=rn;rn|=2;var V=yU();(Li!==x||Ar!==w)&&(up(),ld(x,w));do try{gee();break}catch(Ce){vU(x,Ce)}while(1);JE(),x_.current=V,rn=I,Ii!==null?w=0:(Li=null,Ar=0,w=Wi)}if(w!==0){if(w===2&&(I=VE(x),I!==0&&(D=I,w=kC(x,I))),w===1)throw C=Uv,ld(x,0),xu(x,D),ws(x,ar()),C;if(w===6)xu(x,D);else{if(I=x.current.alternate,!(D&30)&&!pee(I)&&(w=C_(x,D),w===2&&(V=VE(x),V!==0&&(D=V,w=kC(x,V))),w===1))throw C=Uv,ld(x,0),xu(x,D),ws(x,ar()),C;switch(x.finishedWork=I,x.finishedLanes=D,w){case 0:case 1:throw Error(o(345));case 2:cd(x,_s);break;case 3:if(xu(x,D),(D&130023424)===D&&(w=OC+500-ar(),10<w)){if(z1(x,0)!==0)break;if(I=x.suspendedLanes,(I&D)!==D){es(),x.pingedLanes|=x.suspendedLanes&I;break}x.timeoutHandle=K(cd.bind(null,x,_s),w);break}cd(x,_s);break;case 4:if(xu(x,D),(D&4194240)===D)break;for(w=x.eventTimes,I=-1;0<D;){var pe=31-ma(D);V=1<<pe,pe=w[pe],pe>I&&(I=pe),D&=~V}if(D=I,D=ar()-D,D=(120>D?120:480>D?480:1080>D?1080:1920>D?1920:3e3>D?3e3:4320>D?4320:1960*fee(D/1960))-D,10<D){x.timeoutHandle=K(cd.bind(null,x,_s),D);break}cd(x,_s);break;case 5:cd(x,_s);break;default:throw Error(o(329))}}}return ws(x,ar()),x.callbackNode===C?pU.bind(null,x):null}function kC(x,w){var C=kv;return x.current.memoizedState.isDehydrated&&(ld(x,w).flags|=256),x=C_(x,w),x!==2&&(w=_s,_s=C,w!==null&&zC(w)),x}function zC(x){_s===null?_s=x:_s.push.apply(_s,x)}function pee(x){for(var w=x;;){if(w.flags&16384){var C=w.updateQueue;if(C!==null&&(C=C.stores,C!==null))for(var D=0;D<C.length;D++){var I=C[D],V=I.getSnapshot;I=I.value;try{if(!ol(V(),I))return!1}catch{return!1}}}if(C=w.child,w.subtreeFlags&16384&&C!==null)C.return=w,w=C;else{if(w===x)break;for(;w.sibling===null;){if(w.return===null||w.return===x)return!0;w=w.return}w.sibling.return=w.return,w=w.sibling}}return!0}function xu(x,w){for(w&=~BC,w&=~__,x.suspendedLanes|=w,x.pingedLanes&=~w,x=x.expirationTimes;0<w;){var C=31-ma(w),D=1<<C;x[C]=-1,w&=~D}}function mU(x){if(rn&6)throw Error(o(327));ud();var w=z1(x,0);if(!(w&1))return ws(x,ar()),null;var C=C_(x,w);if(x.tag!==0&&C===2){var D=VE(x);D!==0&&(w=D,C=kC(x,D))}if(C===1)throw C=Uv,ld(x,0),xu(x,w),ws(x,ar()),C;if(C===6)throw Error(o(345));return x.finishedWork=x.current.alternate,x.finishedLanes=w,cd(x,_s),ws(x,ar()),null}function gU(x){vu!==null&&vu.tag===0&&!(rn&6)&&ud();var w=rn;rn|=1;var C=bi.transition,D=xn;try{if(bi.transition=null,xn=1,x)return x()}finally{xn=D,bi.transition=C,rn=w,!(rn&6)&&al()}}function GC(){Ws=lp.current,Gt(lp)}function ld(x,w){x.finishedWork=null,x.finishedLanes=0;var C=x.timeoutHandle;if(C!==ve&&(x.timeoutHandle=ve,oe(C)),Ii!==null)for(C=Ii.return;C!==null;){var D=C;switch(rC(D),D.tag){case 1:D=D.type.childContextTypes,D!=null&&F1();break;case 3:op(),Gt(yn),Gt(dn),hC();break;case 5:cC(D);break;case 4:op();break;case 13:Gt(ii);break;case 19:Gt(ii);break;case 10:ZE(D.type._context);break;case 22:case 23:GC()}C=C.return}if(Li=x,Ii=x=_u(x.current,null),Ar=Ws=w,Wi=0,Uv=null,BC=__=cp=0,_s=kv=null,ll!==null){for(w=0;w<ll.length;w++)if(C=ll[w],D=C.interleaved,D!==null){C.interleaved=null;var I=D.next,V=C.pending;if(V!==null){var pe=V.next;V.next=I,D.next=pe}C.pending=D}ll=null}return x}function vU(x,w){do{var C=Ii;try{if(JE(),$1.current=s_,e_){for(var D=fi.memoizedState;D!==null;){var I=D.queue;I!==null&&(I.pending=null),D=D.next}e_=!1}if(ap=0,lr=Or=fi=null,Pv=!1,Dv=0,IC.current=null,C===null||C.return===null){Wi=1,Uv=w,Ii=null;break}e:{var V=x,pe=C.return,Ce=C,je=w;if(w=Ar,Ce.flags|=32768,je!==null&&typeof je=="object"&&typeof je.then=="function"){var et=je,mt=Ce,Xt=mt.tag;if(!(mt.mode&1)&&(Xt===0||Xt===11||Xt===15)){var Tt=mt.alternate;Tt?(mt.updateQueue=Tt.updateQueue,mt.memoizedState=Tt.memoizedState,mt.lanes=Tt.lanes):(mt.updateQueue=null,mt.memoizedState=null)}var Un=UN(pe);if(Un!==null){Un.flags&=-257,kN(Un,pe,Ce,V,w),Un.mode&1&&NN(V,et,w),w=Un,je=et;var bt=w.updateQueue;if(bt===null){var Ur=new Set;Ur.add(je),w.updateQueue=Ur}else bt.add(je);break e}else{if(!(w&1)){NN(V,et,w),HC();break e}je=Error(o(426))}}else if(Jn&&Ce.mode&1){var Lo=UN(pe);if(Lo!==null){!(Lo.flags&65536)&&(Lo.flags|=256),kN(Lo,pe,Ce,V,w),aC(je);break e}}V=je,Wi!==4&&(Wi=2),kv===null?kv=[V]:kv.push(V),je=yC(je,Ce),Ce=pe;do{switch(Ce.tag){case 3:Ce.flags|=65536,w&=-w,Ce.lanes|=w;var Fe=ON(Ce,je,w);iN(Ce,Fe);break e;case 1:V=je;var Pe=Ce.type,He=Ce.stateNode;if(!(Ce.flags&128)&&(typeof Pe.getDerivedStateFromError=="function"||He!==null&&typeof He.componentDidCatch=="function"&&(gu===null||!gu.has(He)))){Ce.flags|=65536,w&=-w,Ce.lanes|=w;var ct=FN(Ce,V,w);iN(Ce,ct);break e}}Ce=Ce.return}while(Ce!==null)}_U(C)}catch(St){w=St,Ii===C&&C!==null&&(Ii=C=C.return);continue}break}while(1)}function yU(){var x=x_.current;return x_.current=s_,x===null?s_:x}function HC(){(Wi===0||Wi===3||Wi===2)&&(Wi=4),Li===null||!(cp&268435455)&&!(__&268435455)||xu(Li,Ar)}function C_(x,w){var C=rn;rn|=2;var D=yU();Li===x&&Ar===w||ld(x,w);do try{mee();break}catch(I){vU(x,I)}while(1);if(JE(),rn=C,x_.current=D,Ii!==null)throw Error(o(261));return Li=null,Ar=0,Wi}function mee(){for(;Ii!==null;)xU(Ii)}function gee(){for(;Ii!==null&&!H$();)xU(Ii)}function xU(x){var w=bU(x.alternate,x,Ws);x.memoizedProps=x.pendingProps,w===null?_U(x):Ii=w,IC.current=null}function _U(x){var w=x;do{var C=w.alternate;if(x=w.return,w.flags&32768){if(C=lee(C,w),C!==null){C.flags&=32767,Ii=C;return}if(x!==null)x.flags|=32768,x.subtreeFlags=0,x.deletions=null;else{Wi=6,Ii=null;return}}else if(C=see(C,w,Ws),C!==null){Ii=C;return}if(w=w.sibling,w!==null){Ii=w;return}Ii=w=x}while(w!==null);Wi===0&&(Wi=5)}function cd(x,w){var C=xn,D=bi.transition;try{bi.transition=null,xn=1,vee(x,w,C)}finally{bi.transition=D,xn=C}return null}function vee(x,w,C){do ud();while(vu!==null);if(rn&6)throw Error(o(327));var D=x.finishedWork,I=x.finishedLanes;if(D===null)return null;if(x.finishedWork=null,x.finishedLanes=0,D===x.current)throw Error(o(177));x.callbackNode=null,x.callbackPriority=0;var V=D.lanes|D.childLanes;if(G$(x,V),x===Li&&(Ii=Li=null,Ar=0),!(D.subtreeFlags&2064)&&!(D.flags&2064)||S_||(S_=!0,AU(qE,function(){return ud(),null})),V=(D.flags&15990)!==0,D.subtreeFlags&15990||V){V=bi.transition,bi.transition=null;var pe=xn;xn=1;var Ce=rn;rn|=4,IC.current=null,uee(x,D),hee(x,D),H(x.containerInfo),x.current=D,dee(D),V$(),rn=Ce,xn=pe,bi.transition=V}else x.current=D;if(S_&&(S_=!1,vu=x,b_=I),V=x.pendingLanes,V===0&&(gu=null),X$(D.stateNode),ws(x,ar()),w!==null)for(C=x.onRecoverableError,D=0;D<w.length;D++)C(w[D]);if(w_)throw w_=!1,x=NC,NC=null,x;return b_&1&&x.tag!==0&&ud(),V=x.pendingLanes,V&1?x===UC?zv++:(zv=0,UC=x):zv=0,al(),null}function ud(){if(vu!==null){var x=ZF(b_),w=bi.transition,C=xn;try{if(bi.transition=null,xn=16>x?16:x,vu===null)var D=!1;else{if(x=vu,vu=null,b_=0,rn&6)throw Error(o(331));var I=rn;for(rn|=4,at=x.current;at!==null;){var V=at,pe=V.child;if(at.flags&16){var Ce=V.deletions;if(Ce!==null){for(var je=0;je<Ce.length;je++){var et=Ce[je];for(at=et;at!==null;){var mt=at;switch(mt.tag){case 0:case 11:case 15:ad(8,mt,V)}var Xt=mt.child;if(Xt!==null)Xt.return=mt,at=Xt;else for(;at!==null;){mt=at;var Tt=mt.sibling,Un=mt.return;if(rU(mt),mt===et){at=null;break}if(Tt!==null){Tt.return=Un,at=Tt;break}at=Un}}}var bt=V.alternate;if(bt!==null){var Ur=bt.child;if(Ur!==null){bt.child=null;do{var Lo=Ur.sibling;Ur.sibling=null,Ur=Lo}while(Ur!==null)}}at=V}}if(V.subtreeFlags&2064&&pe!==null)pe.return=V,at=pe;else e:for(;at!==null;){if(V=at,V.flags&2048)switch(V.tag){case 0:case 11:case 15:ad(9,V,V.return)}var Fe=V.sibling;if(Fe!==null){Fe.return=V.return,at=Fe;break e}at=V.return}}var Pe=x.current;for(at=Pe;at!==null;){pe=at;var He=pe.child;if(pe.subtreeFlags&2064&&He!==null)He.return=pe,at=He;else e:for(pe=Pe;at!==null;){if(Ce=at,Ce.flags&2048)try{switch(Ce.tag){case 0:case 11:case 15:Fv(9,Ce)}}catch(St){Ss(Ce,Ce.return,St)}if(Ce===pe){at=null;break e}var ct=Ce.sibling;if(ct!==null){ct.return=Ce.return,at=ct;break e}at=Ce.return}}if(rn=I,al(),sl&&typeof sl.onPostCommitFiberRoot=="function")try{sl.onPostCommitFiberRoot(G1,x)}catch{}D=!0}return D}finally{xn=C,bi.transition=w}}return!1}function wU(x,w,C){w=yC(C,w),w=ON(x,w,1),mu(x,w),w=es(),x=E_(x,1),x!==null&&(bv(x,1,w),ws(x,w))}function Ss(x,w,C){if(x.tag===3)wU(x,x,C);else for(;w!==null;){if(w.tag===3){wU(w,x,C);break}else if(w.tag===1){var D=w.stateNode;if(typeof w.type.getDerivedStateFromError=="function"||typeof D.componentDidCatch=="function"&&(gu===null||!gu.has(D))){x=yC(C,x),x=FN(w,x,1),mu(w,x),x=es(),w=E_(w,1),w!==null&&(bv(w,1,x),ws(w,x));break}}w=w.return}}function yee(x,w,C){var D=x.pingCache;D!==null&&D.delete(w),w=es(),x.pingedLanes|=x.suspendedLanes&C,Li===x&&(Ar&C)===C&&(Wi===4||Wi===3&&(Ar&130023424)===Ar&&500>ar()-OC?ld(x,0):BC|=C),ws(x,w)}function SU(x,w){w===0&&(x.mode&1?(w=k1,k1<<=1,!(k1&130023424)&&(k1=4194304)):w=1);var C=es();x=E_(x,w),x!==null&&(bv(x,w,C),ws(x,C))}function xee(x){var w=x.memoizedState,C=0;w!==null&&(C=w.retryLane),SU(x,C)}function _ee(x,w){var C=0;switch(x.tag){case 13:var D=x.stateNode,I=x.memoizedState;I!==null&&(C=I.retryLane);break;case 19:D=x.stateNode;break;default:throw Error(o(314))}D!==null&&D.delete(w),SU(x,C)}var bU;bU=function(x,w,C){if(x!==null)if(x.memoizedProps!==w.pendingProps||yn.current)js=!0;else{if(!(x.lanes&C)&&!(w.flags&128))return js=!1,aee(x,w,C);js=!!(x.flags&131072)}else js=!1,Jn&&w.flags&1048576&&cN(w,K1,w.index);switch(w.lanes=0,w.tag){case 2:var D=w.type;x!==null&&(x.alternate=null,w.alternate=null,w.flags|=2),x=w.pendingProps;var I=pa(w,dn.current);ep(w,C),I=fC(null,w,D,x,I,C);var V=pC();return w.flags|=1,typeof I=="object"&&I!==null&&typeof I.render=="function"&&I.$$typeof===void 0?(w.tag=1,w.memoizedState=null,w.updateQueue=null,br(D)?(V=!0,N1(w)):V=!1,w.memoizedState=I.state!==null&&I.state!==void 0?I.state:null,eC(w),I.updater=q1,w.stateNode=I,I._reactInternals=w,nC(w,D,x,C),w=wC(null,w,D,!0,V,C)):(w.tag=0,Jn&&V&&iC(w),$r(null,w,I,C),w=w.child),w;case 16:D=w.elementType;e:{switch(x!==null&&(x.alternate=null,w.alternate=null,w.flags|=2),x=w.pendingProps,I=D._init,D=I(D._payload),w.type=D,I=w.tag=See(D),x=ga(D,x),I){case 0:w=_C(null,w,D,x,C);break e;case 1:w=YN(null,w,D,x,C);break e;case 11:w=HN(null,w,D,x,C);break e;case 14:w=VN(null,w,D,ga(D.type,x),C);break e}throw Error(o(306,D,""))}return w;case 0:return D=w.type,I=w.pendingProps,I=w.elementType===D?I:ga(D,I),_C(x,w,D,I,C);case 1:return D=w.type,I=w.pendingProps,I=w.elementType===D?I:ga(D,I),YN(x,w,D,I,C);case 3:e:{if(qN(w),x===null)throw Error(o(387));D=w.pendingProps,V=w.memoizedState,I=V.element,nN(x,w),Y1(w,D,null,C);var pe=w.memoizedState;if(D=pe.element,ie&&V.isDehydrated)if(V={element:D,isDehydrated:!1,cache:pe.cache,transitions:pe.transitions},w.updateQueue.baseState=V,w.memoizedState=V,w.flags&256){I=Error(o(423)),w=QN(x,w,D,C,I);break e}else if(D!==I){I=Error(o(424)),w=QN(x,w,D,C,I);break e}else for(ie&&(Vs=le(w.stateNode.containerInfo),Hs=w,Jn=!0,va=null,Av=!1),C=mN(w,null,D,C),w.child=C;C;)C.flags=C.flags&-3|4096,C=C.sibling;else{if(ip(),D===I){w=hc(x,w,C);break e}$r(x,w,D,C)}w=w.child}return w;case 5:return gN(w),x===null&&oC(w),D=w.type,I=w.pendingProps,V=x!==null?x.memoizedProps:null,pe=I.children,re(D,I)?pe=null:V!==null&&re(D,V)&&(w.flags|=32),XN(x,w),$r(x,w,pe,C),w.child;case 6:return x===null&&oC(w),null;case 13:return KN(x,w,C);case 4:return lC(w,w.stateNode.containerInfo),D=w.pendingProps,x===null?w.child=rp(w,null,D,C):$r(x,w,D,C),w.child;case 11:return D=w.type,I=w.pendingProps,I=w.elementType===D?I:ga(D,I),HN(x,w,D,I,C);case 7:return $r(x,w,w.pendingProps,C),w.child;case 8:return $r(x,w,w.pendingProps.children,C),w.child;case 12:return $r(x,w,w.pendingProps.children,C),w.child;case 10:e:{if(D=w.type._context,I=w.pendingProps,V=w.memoizedProps,pe=I.value,tN(w,D,pe),V!==null)if(ol(V.value,pe)){if(V.children===I.children&&!yn.current){w=hc(x,w,C);break e}}else for(V=w.child,V!==null&&(V.return=w);V!==null;){var Ce=V.dependencies;if(Ce!==null){pe=V.child;for(var je=Ce.firstContext;je!==null;){if(je.context===D){if(V.tag===1){je=ac(-1,C&-C),je.tag=2;var et=V.updateQueue;if(et!==null){et=et.shared;var mt=et.pending;mt===null?je.next=je:(je.next=mt.next,mt.next=je),et.pending=je}}V.lanes|=C,je=V.alternate,je!==null&&(je.lanes|=C),$E(V.return,C,w),Ce.lanes|=C;break}je=je.next}}else if(V.tag===10)pe=V.type===w.type?null:V.child;else if(V.tag===18){if(pe=V.return,pe===null)throw Error(o(341));pe.lanes|=C,Ce=pe.alternate,Ce!==null&&(Ce.lanes|=C),$E(pe,C,w),pe=V.sibling}else pe=V.child;if(pe!==null)pe.return=V;else for(pe=V;pe!==null;){if(pe===w){pe=null;break}if(V=pe.sibling,V!==null){V.return=pe.return,pe=V;break}pe=pe.return}V=pe}$r(x,w,I.children,C),w=w.child}return w;case 9:return I=w.type,D=w.pendingProps.children,ep(w,C),I=Mo(I),D=D(I),w.flags|=1,$r(x,w,D,C),w.child;case 14:return D=w.type,I=ga(D,w.pendingProps),I=ga(D.type,I),VN(x,w,D,I,C);case 15:return jN(x,w,w.type,w.pendingProps,C);case 17:return D=w.type,I=w.pendingProps,I=w.elementType===D?I:ga(D,I),x!==null&&(x.alternate=null,w.alternate=null,w.flags|=2),w.tag=1,br(D)?(x=!0,N1(w)):x=!1,ep(w,C),aN(w,D,I),nC(w,D,I,C),wC(null,w,D,!0,x,C);case 19:return eU(x,w,C);case 22:return WN(x,w,C)}throw Error(o(156,w.tag))};function AU(x,w){return XE(x,w)}function wee(x,w,C,D){this.tag=x,this.key=C,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=w,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=D,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ro(x,w,C,D){return new wee(x,w,C,D)}function VC(x){return x=x.prototype,!(!x||!x.isReactComponent)}function See(x){if(typeof x=="function")return VC(x)?1:0;if(x!=null){if(x=x.$$typeof,x===v)return 11;if(x===y)return 14}return 2}function _u(x,w){var C=x.alternate;return C===null?(C=Ro(x.tag,w,x.key,x.mode),C.elementType=x.elementType,C.type=x.type,C.stateNode=x.stateNode,C.alternate=x,x.alternate=C):(C.pendingProps=w,C.type=x.type,C.flags=0,C.subtreeFlags=0,C.deletions=null),C.flags=x.flags&14680064,C.childLanes=x.childLanes,C.lanes=x.lanes,C.child=x.child,C.memoizedProps=x.memoizedProps,C.memoizedState=x.memoizedState,C.updateQueue=x.updateQueue,w=x.dependencies,C.dependencies=w===null?null:{lanes:w.lanes,firstContext:w.firstContext},C.sibling=x.sibling,C.index=x.index,C.ref=x.ref,C}function T_(x,w,C,D,I,V){var pe=2;if(D=x,typeof x=="function")VC(x)&&(pe=1);else if(typeof x=="string")pe=5;else e:switch(x){case h:return hd(C.children,I,V,w);case u:pe=8,I|=8;break;case d:return x=Ro(12,C,w,I|2),x.elementType=d,x.lanes=V,x;case g:return x=Ro(13,C,w,I),x.elementType=g,x.lanes=V,x;case m:return x=Ro(19,C,w,I),x.elementType=m,x.lanes=V,x;case S:return P_(C,I,V,w);default:if(typeof x=="object"&&x!==null)switch(x.$$typeof){case f:pe=10;break e;case p:pe=9;break e;case v:pe=11;break e;case y:pe=14;break e;case _:pe=16,D=null;break e}throw Error(o(130,x==null?x:typeof x,""))}return w=Ro(pe,C,w,I),w.elementType=x,w.type=D,w.lanes=V,w}function hd(x,w,C,D){return x=Ro(7,x,D,w),x.lanes=C,x}function P_(x,w,C,D){return x=Ro(22,x,D,w),x.elementType=S,x.lanes=C,x.stateNode={},x}function jC(x,w,C){return x=Ro(6,x,null,w),x.lanes=C,x}function WC(x,w,C){return w=Ro(4,x.children!==null?x.children:[],x.key,w),w.lanes=C,w.stateNode={containerInfo:x.containerInfo,pendingChildren:null,implementation:x.implementation},w}function bee(x,w,C,D,I){this.tag=w,this.containerInfo=x,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ve,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=jE(0),this.expirationTimes=jE(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=jE(0),this.identifierPrefix=D,this.onRecoverableError=I,ie&&(this.mutableSourceEagerHydrationData=null)}function MU(x,w,C,D,I,V,pe,Ce,je){return x=new bee(x,w,C,Ce,je),w===1?(w=1,V===!0&&(w|=8)):w=0,V=Ro(3,null,null,w),x.current=V,V.stateNode=x,V.memoizedState={element:D,isDehydrated:C,cache:null,transitions:null},eC(V),x}function EU(x){if(!x)return Ri;x=x._reactInternals;e:{if(E(x)!==x||x.tag!==1)throw Error(o(170));var w=x;do{switch(w.tag){case 3:w=w.stateNode.context;break e;case 1:if(br(w.type)){w=w.stateNode.__reactInternalMemoizedMergedChildContext;break e}}w=w.return}while(w!==null);throw Error(o(171))}if(x.tag===1){var C=x.type;if(br(C))return KF(x,C,w)}return w}function CU(x){var w=x._reactInternals;if(w===void 0)throw typeof x.render=="function"?Error(o(188)):(x=Object.keys(x).join(","),Error(o(268,x)));return x=F(w),x===null?null:x.stateNode}function TU(x,w){if(x=x.memoizedState,x!==null&&x.dehydrated!==null){var C=x.retryLane;x.retryLane=C!==0&&C<w?C:w}}function XC(x,w){TU(x,w),(x=x.alternate)&&TU(x,w)}function Aee(x){return x=F(x),x===null?null:x.stateNode}function Mee(){return null}return n.attemptContinuousHydration=function(x){if(x.tag===13){var w=es();Do(x,134217728,w),XC(x,134217728)}},n.attemptHydrationAtCurrentPriority=function(x){if(x.tag===13){var w=es(),C=yu(x);Do(x,C,w),XC(x,C)}},n.attemptSynchronousHydration=function(x){switch(x.tag){case 3:var w=x.stateNode;if(w.current.memoizedState.isDehydrated){var C=Sv(w.pendingLanes);C!==0&&(WE(w,C|1),ws(w,ar()),!(rn&6)&&(up(),al()))}break;case 13:var D=es();gU(function(){return Do(x,1,D)}),XC(x,1)}},n.batchedUpdates=function(x,w){var C=rn;rn|=1;try{return x(w)}finally{rn=C,rn===0&&(up(),H1&&al())}},n.createComponentSelector=function(x){return{$$typeof:p_,value:x}},n.createContainer=function(x,w,C,D,I,V,pe){return MU(x,w,!1,null,C,D,I,V,pe)},n.createHasPseudoClassSelector=function(x){return{$$typeof:m_,value:x}},n.createHydrationContainer=function(x,w,C,D,I,V,pe,Ce,je){return x=MU(C,D,!0,x,I,V,pe,Ce,je),x.context=EU(null),C=x.current,D=es(),I=yu(C),V=ac(D,I),V.callback=w??null,mu(C,V),x.current.lanes=I,bv(x,I,D),ws(x,D),x},n.createPortal=function(x,w,C){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:D==null?null:""+D,children:x,containerInfo:w,implementation:C}},n.createRoleSelector=function(x){return{$$typeof:g_,value:x}},n.createTestNameSelector=function(x){return{$$typeof:v_,value:x}},n.createTextSelector=function(x){return{$$typeof:y_,value:x}},n.deferredUpdates=function(x){var w=xn,C=bi.transition;try{return bi.transition=null,xn=16,x()}finally{xn=w,bi.transition=C}},n.discreteUpdates=function(x,w,C,D,I){var V=xn,pe=bi.transition;try{return bi.transition=null,xn=1,x(w,C,D,I)}finally{xn=V,bi.transition=pe,rn===0&&up()}},n.findAllNodes=LC,n.findBoundingRects=function(x,w){if(!Ue)throw Error(o(363));w=LC(x,w),x=[];for(var C=0;C<w.length;C++)x.push(U(w[C]));for(w=x.length-1;0<w;w--){C=x[w];for(var D=C.x,I=D+C.width,V=C.y,pe=V+C.height,Ce=w-1;0<=Ce;Ce--)if(w!==Ce){var je=x[Ce],et=je.x,mt=et+je.width,Xt=je.y,Tt=Xt+je.height;if(D>=et&&V>=Xt&&I<=mt&&pe<=Tt){x.splice(w,1);break}else if(D!==et||C.width!==je.width||Tt<V||Xt>pe){if(!(V!==Xt||C.height!==je.height||mt<D||et>I)){et>D&&(je.width+=et-D,je.x=D),mt<I&&(je.width=I-et),x.splice(w,1);break}}else{Xt>V&&(je.height+=Xt-V,je.y=V),Tt<pe&&(je.height=pe-Xt),x.splice(w,1);break}}}return x},n.findHostInstance=CU,n.findHostInstanceWithNoPortals=function(x){return x=R(x),x=x!==null?k(x):null,x===null?null:x.stateNode},n.findHostInstanceWithWarning=function(x){return CU(x)},n.flushControlled=function(x){var w=rn;rn|=1;var C=bi.transition,D=xn;try{bi.transition=null,xn=1,x()}finally{xn=D,bi.transition=C,rn=w,rn===0&&(up(),al())}},n.flushPassiveEffects=ud,n.flushSync=gU,n.focusWithin=function(x,w){if(!Ue)throw Error(o(363));for(x=PC(x),w=fU(x,w),w=Array.from(w),x=0;x<w.length;){var C=w[x++];if(!te(C)){if(C.tag===5&&Te(C.stateNode))return!0;for(C=C.child;C!==null;)w.push(C),C=C.sibling}}return!1},n.getCurrentUpdatePriority=function(){return xn},n.getFindAllNodesFailureDescription=function(x,w){if(!Ue)throw Error(o(363));var C=0,D=[];x=[PC(x),0];for(var I=0;I<x.length;){var V=x[I++],pe=x[I++],Ce=w[pe];if((V.tag!==5||!te(V))&&(DC(V,Ce)&&(D.push(RC(Ce)),pe++,pe>C&&(C=pe)),pe<w.length))for(V=V.child;V!==null;)x.push(V,pe),V=V.sibling}if(C<w.length){for(x=[];C<w.length;C++)x.push(RC(w[C]));return`findAllNodes was able to match part of the selector:
  `+(D.join(" > ")+`

No matching component was found for:
  `)+x.join(" > ")}return null},n.getPublicRootInstance=function(x){if(x=x.current,!x.child)return null;switch(x.child.tag){case 5:return Z(x.child.stateNode);default:return x.child.stateNode}},n.injectIntoDevTools=function(x){if(x={bundleType:x.bundleType,version:x.version,rendererPackageName:x.rendererPackageName,rendererConfig:x.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:Aee,findFiberByHostInstance:x.findFiberByHostInstance||Mee,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")x=!1;else{var w=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(w.isDisabled||!w.supportsFiber)x=!0;else{try{G1=w.inject(x),sl=w}catch{}x=!!w.checkDCE}}return x},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(x,w,C,D){if(!Ue)throw Error(o(363));x=LC(x,w);var I=Ie(x,C,D).disconnect;return{disconnect:function(){I()}}},n.registerMutableSourceForHydration=function(x,w){var C=w._getVersion;C=C(w._source),x.mutableSourceEagerHydrationData==null?x.mutableSourceEagerHydrationData=[w,C]:x.mutableSourceEagerHydrationData.push(w,C)},n.runWithPriority=function(x,w){var C=xn;try{return xn=x,w()}finally{xn=C}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(x,w,C,D){var I=w.current,V=es(),pe=yu(I);return C=EU(C),w.context===null?w.context=C:w.pendingContext=C,w=ac(V,pe),w.payload={element:x},D=D===void 0?null:D,D!==null&&(w.callback=D),mu(I,w),x=Do(I,pe,V),x!==null&&X1(x,I,pe),pe},n};$7.exports=$he;var ede=$7.exports;const tde=mM(ede);var eY={exports:{}},tY={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(O,W){var H=O.length;O.push(W);e:for(;0<H;){var Y=H-1>>>1,z=O[Y];if(0<r(z,W))O[Y]=W,O[H]=z,H=Y;else break e}}function n(O){return O.length===0?null:O[0]}function i(O){if(O.length===0)return null;var W=O[0],H=O.pop();if(H!==W){O[0]=H;e:for(var Y=0,z=O.length,X=z>>>1;Y<X;){var q=2*(Y+1)-1,re=O[q],G=q+1,K=O[G];if(0>r(re,H))G<z&&0>r(K,re)?(O[Y]=K,O[G]=H,Y=G):(O[Y]=re,O[q]=H,Y=q);else if(G<z&&0>r(K,H))O[Y]=K,O[G]=H,Y=G;else break e}}return W}function r(O,W){var H=O.sortIndex-W.sortIndex;return H!==0?H:O.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],h=1,u=null,d=3,f=!1,p=!1,v=!1,g=typeof setTimeout=="function"?setTimeout:null,m=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(O){for(var W=n(c);W!==null;){if(W.callback===null)i(c);else if(W.startTime<=O)i(c),W.sortIndex=W.expirationTime,e(l,W);else break;W=n(c)}}function S(O){if(v=!1,_(O),!p)if(n(l)!==null)p=!0,Z(A);else{var W=n(c);W!==null&&ee(S,W.startTime-O)}}function A(O,W){p=!1,v&&(v=!1,m(M),M=-1),f=!0;var H=d;try{for(_(W),u=n(l);u!==null&&(!(u.expirationTime>W)||O&&!R());){var Y=u.callback;if(typeof Y=="function"){u.callback=null,d=u.priorityLevel;var z=Y(u.expirationTime<=W);W=t.unstable_now(),typeof z=="function"?u.callback=z:u===n(l)&&i(l),_(W)}else i(l);u=n(l)}if(u!==null)var X=!0;else{var q=n(c);q!==null&&ee(S,q.startTime-W),X=!1}return X}finally{u=null,d=H,f=!1}}var b=!1,T=null,M=-1,E=5,P=-1;function R(){return!(t.unstable_now()-P<E)}function F(){if(T!==null){var O=t.unstable_now();P=O;var W=!0;try{W=T(!0,O)}finally{W?B():(b=!1,T=null)}}else b=!1}var B;if(typeof y=="function")B=function(){y(F)};else if(typeof MessageChannel<"u"){var k=new MessageChannel,j=k.port2;k.port1.onmessage=F,B=function(){j.postMessage(null)}}else B=function(){g(F,0)};function Z(O){T=O,b||(b=!0,B())}function ee(O,W){M=g(function(){O(t.unstable_now())},W)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,Z(A))},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(O){switch(d){case 1:case 2:case 3:var W=3;break;default:W=d}var H=d;d=W;try{return O()}finally{d=H}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(O,W){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var H=d;d=O;try{return W()}finally{d=H}},t.unstable_scheduleCallback=function(O,W,H){var Y=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?Y+H:Y):H=Y,O){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=H+z,O={id:h++,callback:W,priorityLevel:O,startTime:H,expirationTime:z,sortIndex:-1},H>Y?(O.sortIndex=H,e(c,O),n(l)===null&&O===n(c)&&(v?(m(M),M=-1):v=!0,ee(S,H-Y))):(O.sortIndex=z,e(l,O),p||f||(p=!0,Z(A))),O},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(O){var W=d;return function(){var H=d;d=W;try{return O.apply(this,arguments)}finally{d=H}}}})(tY);eY.exports=tY;var x4=eY.exports;function nY(t,e,n=(i,r)=>i===r){if(t===e)return!0;if(!t||!e)return!1;const i=t.length;if(e.length!==i)return!1;for(let r=0;r<i;r++)if(!n(t[r],e[r]))return!1;return!0}const Oc=[];function iY(t,e,n=!1,i={}){for(const s of Oc)if(nY(e,s.keys,s.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return s.response;if(!n)throw s.promise}const r={keys:e,equal:i.equal,promise:t(...e).then(s=>r.response=s).then(()=>{i.lifespan&&i.lifespan>0&&setTimeout(()=>{const s=Oc.indexOf(r);s!==-1&&Oc.splice(s,1)},i.lifespan)}).catch(s=>r.error=s)};if(Oc.push(r),!n)throw r.promise}const nde=(t,e,n)=>iY(t,e,!1,n),ide=(t,e,n)=>void iY(t,e,!0,n),rde=t=>{if(t===void 0||t.length===0)Oc.splice(0,Oc.length);else{const e=Oc.find(n=>nY(t,n.keys,n.equal));if(e){const n=Oc.indexOf(e);n!==-1&&Oc.splice(n,1)}}},kB={},sde=t=>void Object.assign(kB,t);function ode(t,e){function n(h,{args:u=[],attach:d,...f},p){let v=`${h[0].toUpperCase()}${h.slice(1)}`,g;if(h==="primitive"){if(f.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const m=f.object;g=um(m,{type:h,root:p,attach:d,primitive:!0})}else{const m=kB[v];if(!m)throw new Error(`R3F: ${v} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(u))throw new Error("R3F: The args prop must be an array!");g=um(new m(...u),{type:h,root:p,attach:d,memoizedProps:{args:u}})}return g.__r3f.attach===void 0&&(g instanceof Kt?g.__r3f.attach="geometry":g instanceof Hi&&(g.__r3f.attach="material")),v!=="inject"&&tP(g,f),g}function i(h,u){let d=!1;if(u){var f,p;(f=u.__r3f)!=null&&f.attach?eP(h,u,u.__r3f.attach):u.isObject3D&&h.isObject3D&&(h.add(u),d=!0),d||(p=h.__r3f)==null||p.objects.push(u),u.__r3f||um(u,{}),u.__r3f.parent=h,$R(u),hm(u)}}function r(h,u,d){let f=!1;if(u){var p,v;if((p=u.__r3f)!=null&&p.attach)eP(h,u,u.__r3f.attach);else if(u.isObject3D&&h.isObject3D){u.parent=h,u.dispatchEvent({type:"added"});const g=h.children.filter(y=>y!==u),m=g.indexOf(d);h.children=[...g.slice(0,m),u,...g.slice(m)],f=!0}f||(v=h.__r3f)==null||v.objects.push(u),u.__r3f||um(u,{}),u.__r3f.parent=h,$R(u),hm(u)}}function s(h,u,d=!1){h&&[...h].forEach(f=>o(u,f,d))}function o(h,u,d){if(u){var f,p,v;if(u.__r3f&&(u.__r3f.parent=null),(f=h.__r3f)!=null&&f.objects&&(h.__r3f.objects=h.__r3f.objects.filter(S=>S!==u)),(p=u.__r3f)!=null&&p.attach)A4(h,u,u.__r3f.attach);else if(u.isObject3D&&h.isObject3D){var g;h.remove(u),(g=u.__r3f)!=null&&g.root&&pde(u.__r3f.root,u)}const y=(v=u.__r3f)==null?void 0:v.primitive,_=d===void 0?u.dispose!==null&&!y:d;if(!y){var m;s((m=u.__r3f)==null?void 0:m.objects,u,_),s(u.children,u,_)}u.__r3f&&(delete u.__r3f.root,delete u.__r3f.objects,delete u.__r3f.handlers,delete u.__r3f.memoizedProps,y||delete u.__r3f),_&&u.dispose&&u.type!=="Scene"&&x4.unstable_scheduleCallback(x4.unstable_IdlePriority,()=>{try{u.dispose()}catch{}}),hm(h)}}function a(h,u,d,f){var p;const v=(p=h.__r3f)==null?void 0:p.parent;if(!v)return;const g=n(u,d,h.__r3f.root);if(h.children){for(const m of h.children)m.__r3f&&i(g,m);h.children=h.children.filter(m=>!m.__r3f)}h.__r3f.objects.forEach(m=>i(g,m)),h.__r3f.objects=[],h.__r3f.autoRemovedBeforeAppend||o(v,h),g.parent&&(g.__r3f.autoRemovedBeforeAppend=!0),i(v,g),g.raycast&&g.__r3f.eventCount&&g.__r3f.root.getState().internal.interaction.push(g),[f,f.alternate].forEach(m=>{m!==null&&(m.stateNode=g,m.ref&&(typeof m.ref=="function"?m.ref(g):m.ref.current=g))})}const l=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters.");return{reconciler:tde({createInstance:n,removeChild:o,appendChild:i,appendInitialChild:i,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(h,u)=>{if(!u)return;const d=h.getState().scene;d.__r3f&&(d.__r3f.root=h,i(d,u))},removeChildFromContainer:(h,u)=>{u&&o(h.getState().scene,u)},insertInContainerBefore:(h,u,d)=>{if(!u||!d)return;const f=h.getState().scene;f.__r3f&&r(f,u,d)},getRootHostContext:()=>null,getChildHostContext:h=>h,finalizeInitialChildren(h){var u;return!!((u=h==null?void 0:h.__r3f)!=null?u:{}).handlers},prepareUpdate(h,u,d,f){if(h.__r3f.primitive&&f.object&&f.object!==h)return[!0];{const{args:p=[],children:v,...g}=f,{args:m=[],children:y,..._}=d;if(!Array.isArray(p))throw new Error("R3F: the args prop must be an array!");if(p.some((A,b)=>A!==m[b]))return[!0];const S=uY(h,g,_,!0);return S.changes.length?[!1,S]:null}},commitUpdate(h,[u,d],f,p,v,g){u?a(h,f,v,g):tP(h,d)},commitMount(h,u,d,f){var p;const v=(p=h.__r3f)!=null?p:{};h.raycast&&v.handlers&&v.eventCount&&h.__r3f.root.getState().internal.interaction.push(h)},getPublicInstance:h=>h,prepareForCommit:()=>null,preparePortalMount:h=>um(h.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(h){var u;const{attach:d,parent:f}=(u=h.__r3f)!=null?u:{};d&&f&&A4(f,h,d),h.isObject3D&&(h.visible=!1),hm(h)},unhideInstance(h,u){var d;const{attach:f,parent:p}=(d=h.__r3f)!=null?d:{};f&&p&&eP(p,h,f),(h.isObject3D&&u.visible==null||u.visible)&&(h.visible=!0),hm(h)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():Bm.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&Qn.fun(performance.now)?performance.now:Qn.fun(Date.now)?Date.now:()=>0,scheduleTimeout:Qn.fun(setTimeout)?setTimeout:void 0,cancelTimeout:Qn.fun(clearTimeout)?clearTimeout:void 0}),applyProps:tP}}var _4,w4;const $T=t=>"colorSpace"in t||"outputColorSpace"in t,rY=()=>{var t;return(t=kB.ColorManagement)!=null?t:null},sY=t=>t&&t.isOrthographicCamera,ade=t=>t&&t.hasOwnProperty("current"),m1=typeof window<"u"&&((_4=window.document)!=null&&_4.createElement||((w4=window.navigator)==null?void 0:w4.product)==="ReactNative")?ge.useLayoutEffect:ge.useEffect;function oY(t){const e=ge.useRef(t);return m1(()=>void(e.current=t),[t]),e}function lde({set:t}){return m1(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}class aY extends ge.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}aY.getDerivedStateFromError=()=>({error:!0});const lY="__default",S4=new Map,cde=t=>t&&!!t.memoized&&!!t.changes;function cY(t){var e;const n=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(t)?Math.min(Math.max(t[0],n),t[1]):t}const s0=t=>{var e;return(e=t.__r3f)==null?void 0:e.root.getState()},Qn={obj:t=>t===Object(t)&&!Qn.arr(t)&&typeof t!="function",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",boo:t=>typeof t=="boolean",und:t=>t===void 0,arr:t=>Array.isArray(t),equ(t,e,{arrays:n="shallow",objects:i="reference",strict:r=!0}={}){if(typeof t!=typeof e||!!t!=!!e)return!1;if(Qn.str(t)||Qn.num(t))return t===e;const s=Qn.obj(t);if(s&&i==="reference")return t===e;const o=Qn.arr(t);if(o&&n==="reference")return t===e;if((o||s)&&t===e)return!0;let a;for(a in t)if(!(a in e))return!1;if(s&&n==="shallow"&&i==="shallow"){for(a in r?e:t)if(!Qn.equ(t[a],e[a],{strict:r,objects:"reference"}))return!1}else for(a in r?e:t)if(t[a]!==e[a])return!1;if(Qn.und(a)){if(o&&t.length===0&&e.length===0||s&&Object.keys(t).length===0&&Object.keys(e).length===0)return!0;if(t!==e)return!1}return!0}};function ude(t){const e={nodes:{},materials:{}};return t&&t.traverse(n=>{n.name&&(e.nodes[n.name]=n),n.material&&!e.materials[n.material.name]&&(e.materials[n.material.name]=n.material)}),e}function hde(t){t.dispose&&t.type!=="Scene"&&t.dispose();for(const e in t)e.dispose==null||e.dispose(),delete t[e]}function um(t,e){const n=t;return(e!=null&&e.primitive||!n.__r3f)&&(n.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e}),t}function ZR(t,e){let n=t;if(e.includes("-")){const i=e.split("-"),r=i.pop();return n=i.reduce((s,o)=>s[o],t),{target:n,key:r}}else return{target:n,key:e}}const b4=/-\d+$/;function eP(t,e,n){if(Qn.str(n)){if(b4.test(n)){const s=n.replace(b4,""),{target:o,key:a}=ZR(t,s);Array.isArray(o[a])||(o[a]=[])}const{target:i,key:r}=ZR(t,n);e.__r3f.previousAttach=i[r],i[r]=e}else e.__r3f.previousAttach=n(t,e)}function A4(t,e,n){var i,r;if(Qn.str(n)){const{target:s,key:o}=ZR(t,n),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(i=e.__r3f)==null||i.previousAttach==null||i.previousAttach(t,e);(r=e.__r3f)==null||delete r.previousAttach}function uY(t,{children:e,key:n,ref:i,...r},{children:s,key:o,ref:a,...l}={},c=!1){var h;const u=(h=t==null?void 0:t.__r3f)!=null?h:{},d=Object.entries(r),f=[];if(c){const v=Object.keys(l);for(let g=0;g<v.length;g++)r.hasOwnProperty(v[g])||d.unshift([v[g],lY+"remove"])}d.forEach(([v,g])=>{var m;if((m=t.__r3f)!=null&&m.primitive&&v==="object"||Qn.equ(g,l[v]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(v))return f.push([v,g,!0,[]]);let y=[];v.includes("-")&&(y=v.split("-")),f.push([v,g,!1,y]);for(const _ in r){const S=r[_];_.startsWith(`${v}-`)&&f.push([_,S,!1,_.split("-")])}});const p={...r};return u.memoizedProps&&u.memoizedProps.args&&(p.args=u.memoizedProps.args),u.memoizedProps&&u.memoizedProps.attach&&(p.attach=u.memoizedProps.attach),{memoized:p,changes:f}}function tP(t,e){var n,i,r;const s=(n=t.__r3f)!=null?n:{},o=s.root,a=(i=o==null||o.getState==null?void 0:o.getState())!=null?i:{},{memoized:l,changes:c}=cde(e)?e:uY(t,e),h=s.eventCount;t.__r3f&&(t.__r3f.memoizedProps=l);for(let d=0;d<c.length;d++){let[f,p,v,g]=c[d];if($T(t)){const S="srgb",A="srgb-linear";f==="encoding"?(f="colorSpace",p=p===3001?S:A):f==="outputEncoding"&&(f="outputColorSpace",p=p===3001?S:A)}let m=t,y=m[f];if(g.length&&(y=g.reduce((_,S)=>_[S],t),!(y&&y.set))){const[_,...S]=g.reverse();m=S.reverse().reduce((A,b)=>A[b],t),f=_}if(p===lY+"remove")if(m.constructor){let _=S4.get(m.constructor);_||(_=new m.constructor,S4.set(m.constructor,_)),p=_[f]}else p=0;if(v)p?s.handlers[f]=p:delete s.handlers[f],s.eventCount=Object.keys(s.handlers).length;else if(y&&y.set&&(y.copy||y instanceof hf)){if(Array.isArray(p))y.fromArray?y.fromArray(p):y.set(...p);else if(y.copy&&p&&p.constructor&&y.constructor===p.constructor)y.copy(p);else if(p!==void 0){const _=y instanceof st;!_&&y.setScalar?y.setScalar(p):y instanceof hf&&p instanceof hf?y.mask=p.mask:y.set(p),!rY()&&!a.linear&&_&&y.convertSRGBToLinear()}}else if(m[f]=p,m[f]instanceof ni&&m[f].format===Es&&m[f].type===tu){const _=m[f];$T(_)&&$T(a.gl)?_.colorSpace=a.gl.outputColorSpace:_.encoding=a.gl.outputEncoding}hm(t)}if(s.parent&&a.internal&&t.raycast&&h!==s.eventCount){const d=a.internal.interaction.indexOf(t);d>-1&&a.internal.interaction.splice(d,1),s.eventCount&&a.internal.interaction.push(t)}return!(c.length===1&&c[0][0]==="onUpdate")&&c.length&&(r=t.__r3f)!=null&&r.parent&&$R(t),t}function hm(t){var e,n;const i=(e=t.__r3f)==null||(n=e.root)==null||n.getState==null?void 0:n.getState();i&&i.internal.frames===0&&i.invalidate()}function $R(t){t.onUpdate==null||t.onUpdate(t)}function dde(t,e){t.manual||(sY(t)?(t.left=e.width/-2,t.right=e.width/2,t.top=e.height/2,t.bottom=e.height/-2):t.aspect=e.width/e.height,t.updateProjectionMatrix(),t.updateMatrixWorld())}function Bw(t){return(t.eventObject||t.object).uuid+"/"+t.index+t.instanceId}function fde(){var t;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return Bm.DefaultEventPriority;switch((t=e.event)==null?void 0:t.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Bm.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Bm.ContinuousEventPriority;default:return Bm.DefaultEventPriority}}function hY(t,e,n,i){const r=n.get(e);r&&(n.delete(e),n.size===0&&(t.delete(i),r.target.releasePointerCapture(i)))}function pde(t,e){const{internal:n}=t.getState();n.interaction=n.interaction.filter(i=>i!==e),n.initialHits=n.initialHits.filter(i=>i!==e),n.hovered.forEach((i,r)=>{(i.eventObject===e||i.object===e)&&n.hovered.delete(r)}),n.capturedMap.forEach((i,r)=>{hY(n.capturedMap,e,i,r)})}function mde(t){function e(l){const{internal:c}=t.getState(),h=l.offsetX-c.initialClick[0],u=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(h*h+u*u))}function n(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(h=>{var u;return(u=c.__r3f)==null?void 0:u.handlers["onPointer"+h]}))}function i(l,c){const h=t.getState(),u=new Set,d=[],f=c?c(h.internal.interaction):h.internal.interaction;for(let m=0;m<f.length;m++){const y=s0(f[m]);y&&(y.raycaster.camera=void 0)}h.previousRoot||h.events.compute==null||h.events.compute(l,h);function p(m){const y=s0(m);if(!y||!y.events.enabled||y.raycaster.camera===null)return[];if(y.raycaster.camera===void 0){var _;y.events.compute==null||y.events.compute(l,y,(_=y.previousRoot)==null?void 0:_.getState()),y.raycaster.camera===void 0&&(y.raycaster.camera=null)}return y.raycaster.camera?y.raycaster.intersectObject(m,!0):[]}let v=f.flatMap(p).sort((m,y)=>{const _=s0(m.object),S=s0(y.object);return!_||!S?m.distance-y.distance:S.events.priority-_.events.priority||m.distance-y.distance}).filter(m=>{const y=Bw(m);return u.has(y)?!1:(u.add(y),!0)});h.events.filter&&(v=h.events.filter(v,h));for(const m of v){let y=m.object;for(;y;){var g;(g=y.__r3f)!=null&&g.eventCount&&d.push({...m,eventObject:y}),y=y.parent}}if("pointerId"in l&&h.internal.capturedMap.has(l.pointerId))for(let m of h.internal.capturedMap.get(l.pointerId).values())u.has(Bw(m.intersection))||d.push(m.intersection);return d}function r(l,c,h,u){const d=t.getState();if(l.length){const f={stopped:!1};for(const p of l){const v=s0(p.object)||d,{raycaster:g,pointer:m,camera:y,internal:_}=v,S=new ae(m.x,m.y,0).unproject(y),A=P=>{var R,F;return(R=(F=_.capturedMap.get(P))==null?void 0:F.has(p.eventObject))!=null?R:!1},b=P=>{const R={intersection:p,target:c.target};_.capturedMap.has(P)?_.capturedMap.get(P).set(p.eventObject,R):_.capturedMap.set(P,new Map([[p.eventObject,R]])),c.target.setPointerCapture(P)},T=P=>{const R=_.capturedMap.get(P);R&&hY(_.capturedMap,p.eventObject,R,P)};let M={};for(let P in c){let R=c[P];typeof R!="function"&&(M[P]=R)}let E={...p,...M,pointer:m,intersections:l,stopped:f.stopped,delta:h,unprojectedPoint:S,ray:g.ray,camera:y,stopPropagation(){const P="pointerId"in c&&_.capturedMap.get(c.pointerId);if((!P||P.has(p.eventObject))&&(E.stopped=f.stopped=!0,_.hovered.size&&Array.from(_.hovered.values()).find(R=>R.eventObject===p.eventObject))){const R=l.slice(0,l.indexOf(p));s([...R,p])}},target:{hasPointerCapture:A,setPointerCapture:b,releasePointerCapture:T},currentTarget:{hasPointerCapture:A,setPointerCapture:b,releasePointerCapture:T},nativeEvent:c};if(u(E),f.stopped===!0)break}}return l}function s(l){const{internal:c}=t.getState();for(const h of c.hovered.values())if(!l.length||!l.find(u=>u.object===h.object&&u.index===h.index&&u.instanceId===h.instanceId)){const d=h.eventObject.__r3f,f=d==null?void 0:d.handlers;if(c.hovered.delete(Bw(h)),d!=null&&d.eventCount){const p={...h,intersections:l};f.onPointerOut==null||f.onPointerOut(p),f.onPointerLeave==null||f.onPointerLeave(p)}}}function o(l,c){for(let h=0;h<c.length;h++){const u=c[h].__r3f;u==null||u.handlers.onPointerMissed==null||u.handlers.onPointerMissed(l)}}function a(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return c=>{const{internal:h}=t.getState();"pointerId"in c&&h.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{h.capturedMap.has(c.pointerId)&&(h.capturedMap.delete(c.pointerId),s([]))})}}return function(h){const{onPointerMissed:u,internal:d}=t.getState();d.lastEvent.current=h;const f=l==="onPointerMove",p=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",g=i(h,f?n:void 0),m=p?e(h):0;l==="onPointerDown"&&(d.initialClick=[h.offsetX,h.offsetY],d.initialHits=g.map(_=>_.eventObject)),p&&!g.length&&m<=2&&(o(h,d.interaction),u&&u(h)),f&&s(g);function y(_){const S=_.eventObject,A=S.__r3f,b=A==null?void 0:A.handlers;if(A!=null&&A.eventCount)if(f){if(b.onPointerOver||b.onPointerEnter||b.onPointerOut||b.onPointerLeave){const T=Bw(_),M=d.hovered.get(T);M?M.stopped&&_.stopPropagation():(d.hovered.set(T,_),b.onPointerOver==null||b.onPointerOver(_),b.onPointerEnter==null||b.onPointerEnter(_))}b.onPointerMove==null||b.onPointerMove(_)}else{const T=b[l];T?(!p||d.initialHits.includes(S))&&(o(h,d.interaction.filter(M=>!d.initialHits.includes(M))),T(_)):p&&d.initialHits.includes(S)&&o(h,d.interaction.filter(M=>!d.initialHits.includes(M)))}}r(g,h,m,y)}}return{handlePointer:a}}const dY=t=>!!(t!=null&&t.render),fY=ge.createContext(null),gde=(t,e)=>{const n=Z7((a,l)=>{const c=new ae,h=new ae,u=new ae;function d(m=l().camera,y=h,_=l().size){const{width:S,height:A,top:b,left:T}=_,M=S/A;y instanceof ae?u.copy(y):u.set(...y);const E=m.getWorldPosition(c).distanceTo(u);if(sY(m))return{width:S/m.zoom,height:A/m.zoom,top:b,left:T,factor:1,distance:E,aspect:M};{const P=m.fov*Math.PI/180,R=2*Math.tan(P/2)*E,F=R*(S/A);return{width:F,height:R,top:b,left:T,factor:S/F,distance:E,aspect:M}}}let f;const p=m=>a(y=>({performance:{...y.performance,current:m}})),v=new Ye;return{set:a,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(m=1)=>t(l(),m),advance:(m,y)=>e(m,y,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new OB,pointer:v,mouse:v,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const m=l();f&&clearTimeout(f),m.performance.current!==m.performance.min&&p(m.performance.min),f=setTimeout(()=>p(l().performance.max),m.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:d},setEvents:m=>a(y=>({...y,events:{...y.events,...m}})),setSize:(m,y,_,S,A)=>{const b=l().camera,T={width:m,height:y,top:S||0,left:A||0,updateStyle:_};a(M=>({size:T,viewport:{...M.viewport,...d(b,h,T)}}))},setDpr:m=>a(y=>{const _=cY(m);return{viewport:{...y.viewport,dpr:_,initialDpr:y.viewport.initialDpr||_}}}),setFrameloop:(m="always")=>{const y=l().clock;y.stop(),y.elapsedTime=0,m!=="never"&&(y.start(),y.elapsedTime=0),a(()=>({frameloop:m}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:ge.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(m,y,_)=>{const S=l().internal;return S.priority=S.priority+(y>0?1:0),S.subscribers.push({ref:m,priority:y,store:_}),S.subscribers=S.subscribers.sort((A,b)=>A.priority-b.priority),()=>{const A=l().internal;A!=null&&A.subscribers&&(A.priority=A.priority-(y>0?1:0),A.subscribers=A.subscribers.filter(b=>b.ref!==m))}}}}}),i=n.getState();let r=i.size,s=i.viewport.dpr,o=i.camera;return n.subscribe(()=>{const{camera:a,size:l,viewport:c,gl:h,set:u}=n.getState();if(l!==r||c.dpr!==s){var d;r=l,s=c.dpr,dde(a,l),h.setPixelRatio(c.dpr);const f=(d=l.updateStyle)!=null?d:typeof HTMLCanvasElement<"u"&&h.domElement instanceof HTMLCanvasElement;h.setSize(l.width,l.height,f)}a!==o&&(o=a,u(f=>({viewport:{...f.viewport,...f.viewport.getCurrentViewport(a)}})))}),n.subscribe(a=>t(a)),n};let Ow,vde=new Set,yde=new Set,xde=new Set;function nP(t,e){if(t.size)for(const{callback:n}of t.values())n(e)}function o0(t,e){switch(t){case"before":return nP(vde,e);case"after":return nP(yde,e);case"tail":return nP(xde,e)}}let iP,rP;function sP(t,e,n){let i=e.clock.getDelta();for(e.frameloop==="never"&&typeof t=="number"&&(i=t-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=t),iP=e.internal.subscribers,Ow=0;Ow<iP.length;Ow++)rP=iP[Ow],rP.ref.current(rP.store.getState(),i,n);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function _de(t){let e=!1,n,i,r;function s(l){i=requestAnimationFrame(s),e=!0,n=0,o0("before",l);for(const h of t.values()){var c;r=h.store.getState(),r.internal.active&&(r.frameloop==="always"||r.internal.frames>0)&&!((c=r.gl.xr)!=null&&c.isPresenting)&&(n+=sP(l,r))}if(o0("after",l),n===0)return o0("tail",l),e=!1,cancelAnimationFrame(i)}function o(l,c=1){var h;if(!l)return t.forEach(u=>o(u.store.getState()),c);(h=l.gl.xr)!=null&&h.isPresenting||!l.internal.active||l.frameloop==="never"||(l.internal.frames=Math.min(60,l.internal.frames+c),e||(e=!0,requestAnimationFrame(s)))}function a(l,c=!0,h,u){if(c&&o0("before",l),h)sP(l,h,u);else for(const d of t.values())sP(l,d.store.getState());c&&o0("after",l)}return{loop:s,invalidate:o,advance:a}}function pY(){const t=ge.useContext(fY);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function Wo(t=n=>n,e){return pY()(t,e)}function g1(t,e=0){const n=pY(),i=n.getState().internal.subscribe,r=oY(t);return m1(()=>i(r,e,n),[e,i,n]),null}function mY(t,e){return function(n,...i){const r=new n;return t&&t(r),Promise.all(i.map(s=>new Promise((o,a)=>r.load(s,l=>{l.scene&&Object.assign(l,ude(l.scene)),o(l)},e,l=>a(new Error(`Could not load ${s}: ${l.message})`))))))}}function v1(t,e,n,i){const r=Array.isArray(e)?e:[e],s=nde(mY(n,i),[t,...r],{equal:Qn.equ});return Array.isArray(e)?s:s[0]}v1.preload=function(t,e,n){const i=Array.isArray(e)?e:[e];return ide(mY(n),[t,...i])};v1.clear=function(t,e){const n=Array.isArray(e)?e:[e];return rde([t,...n])};const Og=new Map,{invalidate:M4,advance:E4}=_de(Og),{reconciler:hA,applyProps:Bp}=ode(Og,fde),Op={objects:"shallow",strict:!1},wde=(t,e)=>{const n=typeof t=="function"?t(e):t;return dY(n)?n:new dB({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...t})};function Sde(t,e){if(e)return e;if(typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&t.parentElement){const{width:n,height:i,top:r,left:s}=t.parentElement.getBoundingClientRect();return{width:n,height:i,top:r,left:s}}else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height,top:0,left:0};return{width:0,height:0,top:0,left:0}}function bde(t){const e=Og.get(t),n=e==null?void 0:e.fiber,i=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=i||gde(M4,E4),o=n||hA.createContainer(s,Bm.ConcurrentRoot,null,!1,null,"",r,null);e||Og.set(t,{fiber:o,store:s});let a,l=!1,c;return{configure(h={}){let{gl:u,size:d,scene:f,events:p,onCreated:v,shadows:g=!1,linear:m=!1,flat:y=!1,legacy:_=!1,orthographic:S=!1,frameloop:A="always",dpr:b=[1,2],performance:T,raycaster:M,camera:E,onPointerMissed:P}=h,R=s.getState(),F=R.gl;R.gl||R.set({gl:F=wde(u,t)});let B=R.raycaster;B||R.set({raycaster:B=new Q7});const{params:k,...j}=M||{};if(Qn.equ(j,B,Op)||Bp(B,{...j}),Qn.equ(k,B.params,Op)||Bp(B,{params:{...B.params,...k}}),!R.camera||R.camera===c&&!Qn.equ(c,E,Op)){c=E;const Y=E instanceof Jx,z=Y?E:S?new ja(0,0,0,0,.1,1e3):new zn(75,0,.1,1e3);Y||(z.position.z=5,E&&Bp(z,E),!R.camera&&!(E!=null&&E.rotation)&&z.lookAt(0,0,0)),R.set({camera:z})}if(!R.scene){let Y;f instanceof uA?Y=f:(Y=new uA,f&&Bp(Y,f)),R.set({scene:um(Y)})}if(!R.xr){const Y=(q,re)=>{const G=s.getState();G.frameloop!=="never"&&E4(q,!0,G,re)},z=()=>{const q=s.getState();q.gl.xr.enabled=q.gl.xr.isPresenting,q.gl.xr.setAnimationLoop(q.gl.xr.isPresenting?Y:null),q.gl.xr.isPresenting||M4(q)},X={connect(){const q=s.getState().gl;q.xr.addEventListener("sessionstart",z),q.xr.addEventListener("sessionend",z)},disconnect(){const q=s.getState().gl;q.xr.removeEventListener("sessionstart",z),q.xr.removeEventListener("sessionend",z)}};F.xr&&X.connect(),R.set({xr:X})}if(F.shadowMap){const Y=F.shadowMap.enabled,z=F.shadowMap.type;if(F.shadowMap.enabled=!!g,Qn.boo(g))F.shadowMap.type=py;else if(Qn.str(g)){var Z;const X={basic:nX,percentage:OM,soft:py,variance:La};F.shadowMap.type=(Z=X[g])!=null?Z:py}else Qn.obj(g)&&Object.assign(F.shadowMap,g);(Y!==F.shadowMap.enabled||z!==F.shadowMap.type)&&(F.shadowMap.needsUpdate=!0)}const ee=rY();ee&&("enabled"in ee?ee.enabled=!_:"legacyMode"in ee&&(ee.legacyMode=_)),Bp(F,{outputEncoding:m?3e3:3001,toneMapping:y?Va:K3}),R.legacy!==_&&R.set(()=>({legacy:_})),R.linear!==m&&R.set(()=>({linear:m})),R.flat!==y&&R.set(()=>({flat:y})),u&&!Qn.fun(u)&&!dY(u)&&!Qn.equ(u,F,Op)&&Bp(F,u),p&&!R.events.handlers&&R.set({events:p(s)});const H=Sde(t,d);return Qn.equ(H,R.size,Op)||R.setSize(H.width,H.height,H.updateStyle,H.top,H.left),b&&R.viewport.dpr!==cY(b)&&R.setDpr(b),R.frameloop!==A&&R.setFrameloop(A),R.onPointerMissed||R.set({onPointerMissed:P}),T&&!Qn.equ(T,R.performance,Op)&&R.set(Y=>({performance:{...Y.performance,...T}})),a=v,l=!0,this},render(h){return l||this.configure(),hA.updateContainer(ge.createElement(Ade,{store:s,children:h,onCreated:a,rootElement:t}),o,null,()=>{}),s},unmount(){gY(t)}}}function Ade({store:t,children:e,onCreated:n,rootElement:i}){return m1(()=>{const r=t.getState();r.set(s=>({internal:{...s.internal,active:!0}})),n&&n(r),t.getState().events.connected||r.events.connect==null||r.events.connect(i)},[]),ge.createElement(fY.Provider,{value:t},e)}function gY(t,e){const n=Og.get(t),i=n==null?void 0:n.fiber;if(i){const r=n==null?void 0:n.store.getState();r&&(r.internal.active=!1),hA.updateContainer(null,i,null,()=>{r&&setTimeout(()=>{try{var s,o,a,l;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=r.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(l=r.gl)!=null&&l.xr&&r.xr.disconnect(),hde(r),Og.delete(t),e&&e(t)}catch{}},500)})}}hA.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:ge.version});function Qa(){return Qa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Qa.apply(this,arguments)}function eL(t,e,n){var i,r,s,o,a;e==null&&(e=100);function l(){var h=Date.now()-o;h<e&&h>=0?i=setTimeout(l,e-h):(i=null,n||(a=t.apply(s,r),s=r=null))}var c=function(){s=this,r=arguments,o=Date.now();var h=n&&!i;return i||(i=setTimeout(l,e)),h&&(a=t.apply(s,r),s=r=null),a};return c.clear=function(){i&&(clearTimeout(i),i=null)},c.flush=function(){i&&(a=t.apply(s,r),s=r=null,clearTimeout(i),i=null)},c}eL.debounce=eL;var Mde=eL;const C4=mM(Mde);function Ede(t){let{debounce:e,scroll:n,polyfill:i,offsetSize:r}=t===void 0?{debounce:0,scroll:!1,offsetSize:!1}:t;const s=i||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[o,a]=ge.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),l=ge.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:o}),c=e?typeof e=="number"?e:e.scroll:null,h=e?typeof e=="number"?e:e.resize:null,u=ge.useRef(!1);ge.useEffect(()=>(u.current=!0,()=>void(u.current=!1)));const[d,f,p]=ge.useMemo(()=>{const y=()=>{if(!l.current.element)return;const{left:_,top:S,width:A,height:b,bottom:T,right:M,x:E,y:P}=l.current.element.getBoundingClientRect(),R={left:_,top:S,width:A,height:b,bottom:T,right:M,x:E,y:P};l.current.element instanceof HTMLElement&&r&&(R.height=l.current.element.offsetHeight,R.width=l.current.element.offsetWidth),Object.freeze(R),u.current&&!Dde(l.current.lastBounds,R)&&a(l.current.lastBounds=R)};return[y,h?C4(y,h):y,c?C4(y,c):y]},[a,r,c,h]);function v(){l.current.scrollContainers&&(l.current.scrollContainers.forEach(y=>y.removeEventListener("scroll",p,!0)),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null)}function g(){l.current.element&&(l.current.resizeObserver=new s(p),l.current.resizeObserver.observe(l.current.element),n&&l.current.scrollContainers&&l.current.scrollContainers.forEach(y=>y.addEventListener("scroll",p,{capture:!0,passive:!0})))}const m=y=>{!y||y===l.current.element||(v(),l.current.element=y,l.current.scrollContainers=vY(y),g())};return Tde(p,!!n),Cde(f),ge.useEffect(()=>{v(),g()},[n,p,f]),ge.useEffect(()=>v,[]),[m,o,d]}function Cde(t){ge.useEffect(()=>{const e=t;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[t])}function Tde(t,e){ge.useEffect(()=>{if(e){const n=t;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[t,e])}function vY(t){const e=[];if(!t||t===document.body)return e;const{overflow:n,overflowX:i,overflowY:r}=window.getComputedStyle(t);return[n,i,r].some(s=>s==="auto"||s==="scroll")&&e.push(t),[...e,...vY(t.parentElement)]}const Pde=["x","y","top","bottom","left","right","width","height"],Dde=(t,e)=>Pde.every(n=>t[n]===e[n]);var Rde=Object.defineProperty,Lde=Object.defineProperties,Ide=Object.getOwnPropertyDescriptors,T4=Object.getOwnPropertySymbols,Bde=Object.prototype.hasOwnProperty,Ode=Object.prototype.propertyIsEnumerable,P4=(t,e,n)=>e in t?Rde(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,D4=(t,e)=>{for(var n in e||(e={}))Bde.call(e,n)&&P4(t,n,e[n]);if(T4)for(var n of T4(e))Ode.call(e,n)&&P4(t,n,e[n]);return t},Fde=(t,e)=>Lde(t,Ide(e));function yY(t,e,n){if(!t)return;if(n(t)===!0)return t;let i=e?t.return:t.child;for(;i;){const r=yY(i,e,n);if(r)return r;i=e?null:i.sibling}}function xY(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const zB=xY(ge.createContext(null));class _Y extends ge.Component{render(){return ge.createElement(zB.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:R4,ReactCurrentDispatcher:L4}=ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function Nde(){const t=ge.useContext(zB);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=ge.useId();return ge.useMemo(()=>{for(const i of[R4==null?void 0:R4.current,t,t==null?void 0:t.alternate]){if(!i)continue;const r=yY(i,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(r)return r}},[t,e])}function Ude(){var t,e;const n=Nde(),[i]=ge.useState(()=>new Map);i.clear();let r=n;for(;r;){const s=(t=r.type)==null?void 0:t._context;s&&s!==zB&&!i.has(s)&&i.set(s,(e=L4==null?void 0:L4.current)==null?void 0:e.readContext(xY(s))),r=r.return}return i}function kde(){const t=Ude();return ge.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>i=>ge.createElement(e,null,ge.createElement(n.Provider,Fde(D4({},i),{value:t.get(n)}))),e=>ge.createElement(_Y,D4({},e))),[t])}const oP={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function zde(t){const{handlePointer:e}=mde(t);return{priority:1,enabled:!0,compute(n,i,r){i.pointer.set(n.offsetX/i.size.width*2-1,-(n.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(oP).reduce((n,i)=>({...n,[i]:e(i)}),{}),update:()=>{var n;const{events:i,internal:r}=t.getState();(n=r.lastEvent)!=null&&n.current&&i.handlers&&i.handlers.onPointerMove(r.lastEvent.current)},connect:n=>{var i;const{set:r,events:s}=t.getState();s.disconnect==null||s.disconnect(),r(o=>({events:{...o.events,connected:n}})),Object.entries((i=s.handlers)!=null?i:[]).forEach(([o,a])=>{const[l,c]=oP[o];n.addEventListener(l,a,{passive:c})})},disconnect:()=>{const{set:n,events:i}=t.getState();if(i.connected){var r;Object.entries((r=i.handlers)!=null?r:[]).forEach(([s,o])=>{if(i&&i.connected instanceof HTMLElement){const[a]=oP[s];i.connected.removeEventListener(a,o)}}),n(s=>({events:{...s.events,connected:void 0}}))}}}}const Gde=ge.forwardRef(function({children:e,fallback:n,resize:i,style:r,gl:s,events:o=zde,eventSource:a,eventPrefix:l,shadows:c,linear:h,flat:u,legacy:d,orthographic:f,frameloop:p,dpr:v,performance:g,raycaster:m,camera:y,onPointerMissed:_,onCreated:S,...A},b){ge.useMemo(()=>sde(qhe),[]);const T=kde(),[M,E]=Ede({scroll:!0,debounce:{scroll:50,resize:0},...i}),P=ge.useRef(null),R=ge.useRef(null);ge.useImperativeHandle(b,()=>P.current);const F=oY(_),[B,k]=ge.useState(!1),[j,Z]=ge.useState(!1);if(B)throw B;if(j)throw j;const ee=ge.useRef(null);m1(()=>{const W=P.current;E.width>0&&E.height>0&&W&&(ee.current||(ee.current=bde(W)),ee.current.configure({gl:s,events:o,shadows:c,linear:h,flat:u,legacy:d,orthographic:f,frameloop:p,dpr:v,performance:g,raycaster:m,camera:y,size:E,onPointerMissed:(...H)=>F.current==null?void 0:F.current(...H),onCreated:H=>{H.events.connect==null||H.events.connect(a?ade(a)?a.current:a:R.current),l&&H.setEvents({compute:(Y,z)=>{const X=Y[l+"X"],q=Y[l+"Y"];z.pointer.set(X/z.size.width*2-1,-(q/z.size.height)*2+1),z.raycaster.setFromCamera(z.pointer,z.camera)}}),S==null||S(H)}}),ee.current.render(ge.createElement(T,null,ge.createElement(aY,{set:Z},ge.createElement(ge.Suspense,{fallback:ge.createElement(lde,{set:k})},e)))))}),ge.useEffect(()=>{const W=P.current;if(W)return()=>gY(W)},[]);const O=a?"none":"auto";return ge.createElement("div",Qa({ref:R,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:O,...r}},A),ge.createElement("div",{ref:M,style:{width:"100%",height:"100%"}},ge.createElement("canvas",{ref:P,style:{display:"block"}},n)))}),wY=ge.forwardRef(function(e,n){return ge.createElement(_Y,null,ge.createElement(Gde,Qa({},e,{ref:n})))}),y1=new ae,GB=new ae,Hde=new ae;function Vde(t,e,n){const i=y1.setFromMatrixPosition(t.matrixWorld);i.project(e);const r=n.width/2,s=n.height/2;return[i.x*r+r,-(i.y*s)+s]}function jde(t,e){const n=y1.setFromMatrixPosition(t.matrixWorld),i=GB.setFromMatrixPosition(e.matrixWorld),r=n.sub(i),s=e.getWorldDirection(Hde);return r.angleTo(s)>Math.PI/2}function Wde(t,e,n,i){const r=y1.setFromMatrixPosition(t.matrixWorld),s=r.clone();s.project(e),n.setFromCamera(s,e);const o=n.intersectObjects(i,!0);if(o.length){const a=o[0].distance;return r.distanceTo(n.ray.origin)<a}return!0}function Xde(t,e){if(e instanceof ja)return e.zoom;if(e instanceof zn){const n=y1.setFromMatrixPosition(t.matrixWorld),i=GB.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,s=n.distanceTo(i);return 1/(2*Math.tan(r/2)*s)}else return 1}function Yde(t,e,n){if(e instanceof zn||e instanceof ja){const i=y1.setFromMatrixPosition(t.matrixWorld),r=GB.setFromMatrixPosition(e.matrixWorld),s=i.distanceTo(r),o=(n[1]-n[0])/(e.far-e.near),a=n[1]-o*e.far;return Math.round(o*s+a)}}const tL=t=>Math.abs(t)<1e-10?0:t;function SY(t,e,n=""){let i="matrix3d(";for(let r=0;r!==16;r++)i+=tL(e[r]*t.elements[r])+(r!==15?",":")");return n+i}const qde=(t=>e=>SY(e,t))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),Qde=(t=>(e,n)=>SY(e,t(n),"translate(-50%,-50%)"))(t=>[1/t,1/t,1/t,1,-1/t,-1/t,-1/t,-1,1/t,1/t,1/t,1,1,1,1,1]);function Kde(t){return t&&typeof t=="object"&&"current"in t}const Jde=ge.forwardRef(({children:t,eps:e=.001,style:n,className:i,prepend:r,center:s,fullscreen:o,portal:a,distanceFactor:l,sprite:c=!1,transform:h=!1,occlude:u,onOcclude:d,castShadow:f,receiveShadow:p,material:v,geometry:g,zIndexRange:m=[16777271,0],calculatePosition:y=Vde,as:_="div",wrapperClass:S,pointerEvents:A="auto",...b},T)=>{const{gl:M,camera:E,scene:P,size:R,raycaster:F,events:B,viewport:k}=Wo(),[j]=ge.useState(()=>document.createElement(_)),Z=ge.useRef(),ee=ge.useRef(null),O=ge.useRef(0),W=ge.useRef([0,0]),H=ge.useRef(null),Y=ge.useRef(null),z=(a==null?void 0:a.current)||B.connected||M.domElement.parentNode,X=ge.useRef(null),q=ge.useRef(!1),re=ge.useMemo(()=>u&&u!=="blending"||Array.isArray(u)&&u.length&&Kde(u[0]),[u]);ge.useLayoutEffect(()=>{const $=M.domElement;u&&u==="blending"?($.style.zIndex=`${Math.floor(m[0]/2)}`,$.style.position="absolute",$.style.pointerEvents="none"):($.style.zIndex=null,$.style.position=null,$.style.pointerEvents=null)},[u]),ge.useLayoutEffect(()=>{if(ee.current){const $=Z.current=j9(j);if(P.updateMatrixWorld(),h)j.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const se=y(ee.current,E,R);j.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${se[0]}px,${se[1]}px,0);transform-origin:0 0;`}return z&&(r?z.prepend(j):z.appendChild(j)),()=>{z&&z.removeChild(j),$.unmount()}}},[z,h]),ge.useLayoutEffect(()=>{S&&(j.className=S)},[S]);const G=ge.useMemo(()=>h?{position:"absolute",top:0,left:0,width:R.width,height:R.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...o&&{top:-R.height/2,left:-R.width/2,width:R.width,height:R.height},...n},[n,s,o,R,h]),K=ge.useMemo(()=>({position:"absolute",pointerEvents:A}),[A]);ge.useLayoutEffect(()=>{if(q.current=!1,h){var $;($=Z.current)==null||$.render(ge.createElement("div",{ref:H,style:G},ge.createElement("div",{ref:Y,style:K},ge.createElement("div",{ref:T,className:i,style:n,children:t}))))}else{var se;(se=Z.current)==null||se.render(ge.createElement("div",{ref:T,style:G,className:i,children:t}))}});const oe=ge.useRef(!0);g1($=>{if(ee.current){E.updateMatrixWorld(),ee.current.updateWorldMatrix(!0,!1);const se=h?W.current:y(ee.current,E,R);if(h||Math.abs(O.current-E.zoom)>e||Math.abs(W.current[0]-se[0])>e||Math.abs(W.current[1]-se[1])>e){const ne=jde(ee.current,E);let ie=!1;re&&(u!=="blending"?ie=[P]:Array.isArray(u)&&(ie=u.map(we=>we.current)));const me=oe.current;if(ie){const we=Wde(ee.current,E,F,ie);oe.current=we&&!ne}else oe.current=!ne;me!==oe.current&&(d?d(!oe.current):j.style.display=oe.current?"block":"none");const xe=Math.floor(m[0]/2),Ae=u?re?[m[0],xe]:[xe-1,0]:m;if(j.style.zIndex=`${Yde(ee.current,E,Ae)}`,h){const[we,Ee]=[R.width/2,R.height/2],Re=E.projectionMatrix.elements[5]*Ee,{isOrthographicCamera:Ue,top:Ne,left:U,bottom:L,right:te}=E,_e=qde(E.matrixWorldInverse),Te=Ue?`scale(${Re})translate(${tL(-(te+U)/2)}px,${tL((Ne+L)/2)}px)`:`translateZ(${Re}px)`;let Ie=ee.current.matrixWorld;c&&(Ie=E.matrixWorldInverse.clone().transpose().copyPosition(Ie).scale(ee.current.scale),Ie.elements[3]=Ie.elements[7]=Ie.elements[11]=0,Ie.elements[15]=1),j.style.width=R.width+"px",j.style.height=R.height+"px",j.style.perspective=Ue?"":`${Re}px`,H.current&&Y.current&&(H.current.style.transform=`${Te}${_e}translate(${we}px,${Ee}px)`,Y.current.style.transform=Qde(Ie,1/((l||10)/400)))}else{const we=l===void 0?1:Xde(ee.current,E)*l;j.style.transform=`translate3d(${se[0]}px,${se[1]}px,0) scale(${we})`}W.current=se,O.current=E.zoom}}if(!re&&X.current&&!q.current)if(h){if(H.current){const se=H.current.children[0];if(se!=null&&se.clientWidth&&se!=null&&se.clientHeight){const{isOrthographicCamera:ne}=E;if(ne||g)b.scale&&(Array.isArray(b.scale)?b.scale instanceof ae?X.current.scale.copy(b.scale.clone().divideScalar(1)):X.current.scale.set(1/b.scale[0],1/b.scale[1],1/b.scale[2]):X.current.scale.setScalar(1/b.scale));else{const ie=(l||10)/400,me=se.clientWidth*ie,xe=se.clientHeight*ie;X.current.scale.set(me,xe,1)}q.current=!0}}}else{const se=j.children[0];if(se!=null&&se.clientWidth&&se!=null&&se.clientHeight){const ne=1/k.factor,ie=se.clientWidth*ne,me=se.clientHeight*ne;X.current.scale.set(ie,me,1),q.current=!0}X.current.lookAt($.camera.position)}});const ve=ge.useMemo(()=>({vertexShader:h?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom" 
            is false. 
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;
            
            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[h]);return ge.createElement("group",Qa({},b,{ref:ee}),u&&!re&&ge.createElement("mesh",{castShadow:f,receiveShadow:p,ref:X},g||ge.createElement("planeGeometry",null),v||ge.createElement("shaderMaterial",{side:$o,vertexShader:ve.vertexShader,fragmentShader:ve.fragmentShader})))});let a0=0;const Zde=Z7(t=>(Im.onStart=(e,n,i)=>{t({active:!0,item:e,loaded:n,total:i,progress:(n-a0)/(i-a0)*100})},Im.onLoad=()=>{t({active:!1})},Im.onError=e=>t(n=>({errors:[...n.errors,e]})),Im.onProgress=(e,n,i)=>{n===i&&(a0=i),t({active:!0,item:e,loaded:n,total:i,progress:(n-a0)/(i-a0)*100||100})},{errors:[],active:!1,progress:0,item:"",loaded:0,total:0}));function bY(t){return function(e){t.forEach(function(n){typeof n=="function"?n(e):n!=null&&(n.current=e)})}}function ig(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I4(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function B4(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?I4(Object(n),!0).forEach(function(i){ig(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):I4(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}new Ye;new Ye;function AY(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Bo=function t(e,n,i){var r=this;AY(this,t),ig(this,"dot2",function(s,o){return r.x*s+r.y*o}),ig(this,"dot3",function(s,o,a){return r.x*s+r.y*o+r.z*a}),this.x=e,this.y=n,this.z=i},$de=[new Bo(1,1,0),new Bo(-1,1,0),new Bo(1,-1,0),new Bo(-1,-1,0),new Bo(1,0,1),new Bo(-1,0,1),new Bo(1,0,-1),new Bo(-1,0,-1),new Bo(0,1,1),new Bo(0,-1,1),new Bo(0,1,-1),new Bo(0,-1,-1)],O4=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],F4=new Array(512),N4=new Array(512),efe=function(e){e>0&&e<1&&(e*=65536),e=Math.floor(e),e<256&&(e|=e<<8);for(var n=0;n<256;n++){var i;n&1?i=O4[n]^e&255:i=O4[n]^e>>8&255,F4[n]=F4[n+256]=i,N4[n]=N4[n+256]=$de[i%12]}};efe(0);function tfe(t){if(typeof t=="number")t=Math.abs(t);else if(typeof t=="string"){var e=t;t=0;for(var n=0;n<e.length;n++)t=(t+(n+1)*(e.charCodeAt(n)%96))%2147483647}return t===0&&(t=311),t}function U4(t){var e=tfe(t);return function(){var n=e*48271%2147483647;return e=n,n/2147483647}}var nfe=function t(e){var n=this;AY(this,t),ig(this,"seed",0),ig(this,"init",function(i){n.seed=i,n.value=U4(i)}),ig(this,"value",U4(this.seed)),this.init(e)},ife=new nfe(Math.random()),rfe={radius:1,center:[0,0,0]};function sfe(t,e){for(var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ife,i=B4(B4({},rfe),e),r=i.radius,s=i.center,o=0;o<t.length;o+=3){var a=Math.pow(n.value(),.3333333333333333),l=n.value()*2-1,c=n.value()*2-1,h=n.value()*2-1,u=Math.sqrt(l*l+c*c+h*h);l=a*l/u,c=a*c/u,h=a*h/u,t[o]=l*r+s[0],t[o+1]=c*r+s[1],t[o+2]=h*r+s[2]}return t}function gx(t){return gx=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gx(t)}function ofe(t,e){if(gx(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(gx(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function afe(t){var e=ofe(t,"string");return gx(e)==="symbol"?e:String(e)}function qt(t,e,n){return e=afe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k4(t,e){if(e===XX)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(e===lA||e===$3){let n=t.getIndex();if(n===null){const o=[],a=t.getAttribute("position");if(a!==void 0){for(let l=0;l<a.count;l++)o.push(l);t.setIndex(o),n=t.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t}const i=n.count-2,r=[];if(n)if(e===lA)for(let o=1;o<=i;o++)r.push(n.getX(0)),r.push(n.getX(o)),r.push(n.getX(o+1));else for(let o=0;o<i;o++)o%2===0?(r.push(n.getX(o)),r.push(n.getX(o+1)),r.push(n.getX(o+2))):(r.push(n.getX(o+2)),r.push(n.getX(o+1)),r.push(n.getX(o)));r.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=t.clone();return s.setIndex(r),s.clearGroups(),s}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",e),t}const z4=(t,e)=>(t%e+e)%e;let lfe=class extends tc{constructor(e,n){super(),qt(this,"object",void 0),qt(this,"domElement",void 0),qt(this,"enabled",!0),qt(this,"target",new ae),qt(this,"minDistance",0),qt(this,"maxDistance",1/0),qt(this,"minZoom",0),qt(this,"maxZoom",1/0),qt(this,"minPolarAngle",0),qt(this,"maxPolarAngle",Math.PI),qt(this,"minAzimuthAngle",-1/0),qt(this,"maxAzimuthAngle",1/0),qt(this,"enableDamping",!1),qt(this,"dampingFactor",.05),qt(this,"enableZoom",!0),qt(this,"zoomSpeed",1),qt(this,"enableRotate",!0),qt(this,"rotateSpeed",1),qt(this,"enablePan",!0),qt(this,"panSpeed",1),qt(this,"screenSpacePanning",!0),qt(this,"keyPanSpeed",7),qt(this,"autoRotate",!1),qt(this,"autoRotateSpeed",2),qt(this,"reverseOrbit",!1),qt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),qt(this,"mouseButtons",{LEFT:Rd.ROTATE,MIDDLE:Rd.DOLLY,RIGHT:Rd.PAN}),qt(this,"touches",{ONE:Ld.ROTATE,TWO:Ld.DOLLY_PAN}),qt(this,"target0",void 0),qt(this,"position0",void 0),qt(this,"zoom0",void 0),qt(this,"_domElementKeyEvents",null),qt(this,"getPolarAngle",void 0),qt(this,"getAzimuthalAngle",void 0),qt(this,"setPolarAngle",void 0),qt(this,"setAzimuthalAngle",void 0),qt(this,"getDistance",void 0),qt(this,"listenToKeyEvents",void 0),qt(this,"saveState",void 0),qt(this,"reset",void 0),qt(this,"update",void 0),qt(this,"connect",void 0),qt(this,"dispose",void 0),this.object=e,this.domElement=n,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object instanceof zn?this.object.zoom:1,this.getPolarAngle=()=>h.phi,this.getAzimuthalAngle=()=>h.theta,this.setPolarAngle=ue=>{let Me=z4(ue,2*Math.PI),Be=h.phi;Be<0&&(Be+=2*Math.PI),Me<0&&(Me+=2*Math.PI);let ze=Math.abs(Me-Be);2*Math.PI-ze<ze&&(Me<Be?Me+=2*Math.PI:Be+=2*Math.PI),u.phi=Me-Be,i.update()},this.setAzimuthalAngle=ue=>{let Me=z4(ue,2*Math.PI),Be=h.theta;Be<0&&(Be+=2*Math.PI),Me<0&&(Me+=2*Math.PI);let ze=Math.abs(Me-Be);2*Math.PI-ze<ze&&(Me<Be?Me+=2*Math.PI:Be+=2*Math.PI),u.theta=Me-Be,i.update()},this.getDistance=()=>i.object.position.distanceTo(i.target),this.listenToKeyEvents=ue=>{ue.addEventListener("keydown",te),this._domElementKeyEvents=ue},this.saveState=()=>{i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object instanceof zn?i.object.zoom:1},this.reset=()=>{i.target.copy(i.target0),i.object.position.copy(i.position0),i.object instanceof zn&&(i.object.zoom=i.zoom0,i.object.updateProjectionMatrix()),i.dispatchEvent(r),i.update(),l=a.NONE},this.update=(()=>{const ue=new ae,Me=new xr().setFromUnitVectors(e.up,new ae(0,1,0)),Be=Me.clone().invert(),ze=new ae,$e=new xr,dt=2*Math.PI;return function(){const J=i.object.position;ue.copy(J).sub(i.target),ue.applyQuaternion(Me),h.setFromVector3(ue),i.autoRotate&&l===a.NONE&&F(P()),i.enableDamping?(h.theta+=u.theta*i.dampingFactor,h.phi+=u.phi*i.dampingFactor):(h.theta+=u.theta,h.phi+=u.phi);let fe=i.minAzimuthAngle,be=i.maxAzimuthAngle;return isFinite(fe)&&isFinite(be)&&(fe<-Math.PI?fe+=dt:fe>Math.PI&&(fe-=dt),be<-Math.PI?be+=dt:be>Math.PI&&(be-=dt),fe<=be?h.theta=Math.max(fe,Math.min(be,h.theta)):h.theta=h.theta>(fe+be)/2?Math.max(fe,h.theta):Math.min(be,h.theta)),h.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,h.phi)),h.makeSafe(),h.radius*=d,h.radius=Math.max(i.minDistance,Math.min(i.maxDistance,h.radius)),i.enableDamping===!0?i.target.addScaledVector(f,i.dampingFactor):i.target.add(f),ue.setFromSpherical(h),ue.applyQuaternion(Be),J.copy(i.target).add(ue),i.object.lookAt(i.target),i.enableDamping===!0?(u.theta*=1-i.dampingFactor,u.phi*=1-i.dampingFactor,f.multiplyScalar(1-i.dampingFactor)):(u.set(0,0,0),f.set(0,0,0)),d=1,p||ze.distanceToSquared(i.object.position)>c||8*(1-$e.dot(i.object.quaternion))>c?(i.dispatchEvent(r),ze.copy(i.object.position),$e.copy(i.object.quaternion),p=!1,!0):!1}})(),this.connect=ue=>{ue===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),i.domElement=ue,i.domElement.style.touchAction="none",i.domElement.addEventListener("contextmenu",Ie),i.domElement.addEventListener("pointerdown",we),i.domElement.addEventListener("pointercancel",Ue),i.domElement.addEventListener("wheel",L)},this.dispose=()=>{var ue,Me,Be,ze,$e,dt;(ue=i.domElement)===null||ue===void 0||ue.removeEventListener("contextmenu",Ie),(Me=i.domElement)===null||Me===void 0||Me.removeEventListener("pointerdown",we),(Be=i.domElement)===null||Be===void 0||Be.removeEventListener("pointercancel",Ue),(ze=i.domElement)===null||ze===void 0||ze.removeEventListener("wheel",L),($e=i.domElement)===null||$e===void 0||$e.ownerDocument.removeEventListener("pointermove",Ee),(dt=i.domElement)===null||dt===void 0||dt.ownerDocument.removeEventListener("pointerup",Re),i._domElementKeyEvents!==null&&i._domElementKeyEvents.removeEventListener("keydown",te)};const i=this,r={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const c=1e-6,h=new JR,u=new JR;let d=1;const f=new ae;let p=!1;const v=new Ye,g=new Ye,m=new Ye,y=new Ye,_=new Ye,S=new Ye,A=new Ye,b=new Ye,T=new Ye,M=[],E={};function P(){return 2*Math.PI/60/60*i.autoRotateSpeed}function R(){return Math.pow(.95,i.zoomSpeed)}function F(ue){i.reverseOrbit?u.theta+=ue:u.theta-=ue}function B(ue){i.reverseOrbit?u.phi+=ue:u.phi-=ue}const k=(()=>{const ue=new ae;return function(Be,ze){ue.setFromMatrixColumn(ze,0),ue.multiplyScalar(-Be),f.add(ue)}})(),j=(()=>{const ue=new ae;return function(Be,ze){i.screenSpacePanning===!0?ue.setFromMatrixColumn(ze,1):(ue.setFromMatrixColumn(ze,0),ue.crossVectors(i.object.up,ue)),ue.multiplyScalar(Be),f.add(ue)}})(),Z=(()=>{const ue=new ae;return function(Be,ze){const $e=i.domElement;if($e&&i.object instanceof zn&&i.object.isPerspectiveCamera){const dt=i.object.position;ue.copy(dt).sub(i.target);let Bt=ue.length();Bt*=Math.tan(i.object.fov/2*Math.PI/180),k(2*Be*Bt/$e.clientHeight,i.object.matrix),j(2*ze*Bt/$e.clientHeight,i.object.matrix)}else $e&&i.object instanceof ja&&i.object.isOrthographicCamera?(k(Be*(i.object.right-i.object.left)/i.object.zoom/$e.clientWidth,i.object.matrix),j(ze*(i.object.top-i.object.bottom)/i.object.zoom/$e.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}})();function ee(ue){i.object instanceof zn&&i.object.isPerspectiveCamera?d/=ue:i.object instanceof ja&&i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*ue)),i.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function O(ue){i.object instanceof zn&&i.object.isPerspectiveCamera?d*=ue:i.object instanceof ja&&i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/ue)),i.object.updateProjectionMatrix(),p=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function W(ue){v.set(ue.clientX,ue.clientY)}function H(ue){A.set(ue.clientX,ue.clientY)}function Y(ue){y.set(ue.clientX,ue.clientY)}function z(ue){g.set(ue.clientX,ue.clientY),m.subVectors(g,v).multiplyScalar(i.rotateSpeed);const Me=i.domElement;Me&&(F(2*Math.PI*m.x/Me.clientHeight),B(2*Math.PI*m.y/Me.clientHeight)),v.copy(g),i.update()}function X(ue){b.set(ue.clientX,ue.clientY),T.subVectors(b,A),T.y>0?ee(R()):T.y<0&&O(R()),A.copy(b),i.update()}function q(ue){_.set(ue.clientX,ue.clientY),S.subVectors(_,y).multiplyScalar(i.panSpeed),Z(S.x,S.y),y.copy(_),i.update()}function re(ue){ue.deltaY<0?O(R()):ue.deltaY>0&&ee(R()),i.update()}function G(ue){let Me=!1;switch(ue.code){case i.keys.UP:Z(0,i.keyPanSpeed),Me=!0;break;case i.keys.BOTTOM:Z(0,-i.keyPanSpeed),Me=!0;break;case i.keys.LEFT:Z(i.keyPanSpeed,0),Me=!0;break;case i.keys.RIGHT:Z(-i.keyPanSpeed,0),Me=!0;break}Me&&(ue.preventDefault(),i.update())}function K(){if(M.length==1)v.set(M[0].pageX,M[0].pageY);else{const ue=.5*(M[0].pageX+M[1].pageX),Me=.5*(M[0].pageY+M[1].pageY);v.set(ue,Me)}}function oe(){if(M.length==1)y.set(M[0].pageX,M[0].pageY);else{const ue=.5*(M[0].pageX+M[1].pageX),Me=.5*(M[0].pageY+M[1].pageY);y.set(ue,Me)}}function ve(){const ue=M[0].pageX-M[1].pageX,Me=M[0].pageY-M[1].pageY,Be=Math.sqrt(ue*ue+Me*Me);A.set(0,Be)}function $(){i.enableZoom&&ve(),i.enablePan&&oe()}function se(){i.enableZoom&&ve(),i.enableRotate&&K()}function ne(ue){if(M.length==1)g.set(ue.pageX,ue.pageY);else{const Be=Ve(ue),ze=.5*(ue.pageX+Be.x),$e=.5*(ue.pageY+Be.y);g.set(ze,$e)}m.subVectors(g,v).multiplyScalar(i.rotateSpeed);const Me=i.domElement;Me&&(F(2*Math.PI*m.x/Me.clientHeight),B(2*Math.PI*m.y/Me.clientHeight)),v.copy(g)}function ie(ue){if(M.length==1)_.set(ue.pageX,ue.pageY);else{const Me=Ve(ue),Be=.5*(ue.pageX+Me.x),ze=.5*(ue.pageY+Me.y);_.set(Be,ze)}S.subVectors(_,y).multiplyScalar(i.panSpeed),Z(S.x,S.y),y.copy(_)}function me(ue){const Me=Ve(ue),Be=ue.pageX-Me.x,ze=ue.pageY-Me.y,$e=Math.sqrt(Be*Be+ze*ze);b.set(0,$e),T.set(0,Math.pow(b.y/A.y,i.zoomSpeed)),ee(T.y),A.copy(b)}function xe(ue){i.enableZoom&&me(ue),i.enablePan&&ie(ue)}function Ae(ue){i.enableZoom&&me(ue),i.enableRotate&&ne(ue)}function we(ue){if(i.enabled!==!1){if(M.length===0){var Me,Be;(Me=i.domElement)===null||Me===void 0||Me.ownerDocument.addEventListener("pointermove",Ee),(Be=i.domElement)===null||Be===void 0||Be.ownerDocument.addEventListener("pointerup",Re)}Qe(ue),ue.pointerType==="touch"?_e(ue):Ne(ue)}}function Ee(ue){i.enabled!==!1&&(ue.pointerType==="touch"?Te(ue):U(ue))}function Re(ue){if(Ge(ue),M.length===0){var Me,Be,ze;(Me=i.domElement)===null||Me===void 0||Me.releasePointerCapture(ue.pointerId),(Be=i.domElement)===null||Be===void 0||Be.ownerDocument.removeEventListener("pointermove",Ee),(ze=i.domElement)===null||ze===void 0||ze.ownerDocument.removeEventListener("pointerup",Re)}i.dispatchEvent(o),l=a.NONE}function Ue(ue){Ge(ue)}function Ne(ue){let Me;switch(ue.button){case 0:Me=i.mouseButtons.LEFT;break;case 1:Me=i.mouseButtons.MIDDLE;break;case 2:Me=i.mouseButtons.RIGHT;break;default:Me=-1}switch(Me){case Rd.DOLLY:if(i.enableZoom===!1)return;H(ue),l=a.DOLLY;break;case Rd.ROTATE:if(ue.ctrlKey||ue.metaKey||ue.shiftKey){if(i.enablePan===!1)return;Y(ue),l=a.PAN}else{if(i.enableRotate===!1)return;W(ue),l=a.ROTATE}break;case Rd.PAN:if(ue.ctrlKey||ue.metaKey||ue.shiftKey){if(i.enableRotate===!1)return;W(ue),l=a.ROTATE}else{if(i.enablePan===!1)return;Y(ue),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&i.dispatchEvent(s)}function U(ue){if(i.enabled!==!1)switch(l){case a.ROTATE:if(i.enableRotate===!1)return;z(ue);break;case a.DOLLY:if(i.enableZoom===!1)return;X(ue);break;case a.PAN:if(i.enablePan===!1)return;q(ue);break}}function L(ue){i.enabled===!1||i.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||(ue.preventDefault(),i.dispatchEvent(s),re(ue),i.dispatchEvent(o))}function te(ue){i.enabled===!1||i.enablePan===!1||G(ue)}function _e(ue){switch(ye(ue),M.length){case 1:switch(i.touches.ONE){case Ld.ROTATE:if(i.enableRotate===!1)return;K(),l=a.TOUCH_ROTATE;break;case Ld.PAN:if(i.enablePan===!1)return;oe(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(i.touches.TWO){case Ld.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;$(),l=a.TOUCH_DOLLY_PAN;break;case Ld.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;se(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&i.dispatchEvent(s)}function Te(ue){switch(ye(ue),l){case a.TOUCH_ROTATE:if(i.enableRotate===!1)return;ne(ue),i.update();break;case a.TOUCH_PAN:if(i.enablePan===!1)return;ie(ue),i.update();break;case a.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;xe(ue),i.update();break;case a.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;Ae(ue),i.update();break;default:l=a.NONE}}function Ie(ue){i.enabled!==!1&&ue.preventDefault()}function Qe(ue){M.push(ue)}function Ge(ue){delete E[ue.pointerId];for(let Me=0;Me<M.length;Me++)if(M[Me].pointerId==ue.pointerId){M.splice(Me,1);return}}function ye(ue){let Me=E[ue.pointerId];Me===void 0&&(Me=new Ye,E[ue.pointerId]=Me),Me.set(ue.pageX,ue.pageY)}function Ve(ue){const Me=ue.pointerId===M[0].pointerId?M[1]:M[0];return E[Me.pointerId]}n!==void 0&&this.connect(n),this.update()}};class HB extends vs{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(n){return new ffe(n)}),this.register(function(n){return new _fe(n)}),this.register(function(n){return new wfe(n)}),this.register(function(n){return new Sfe(n)}),this.register(function(n){return new mfe(n)}),this.register(function(n){return new gfe(n)}),this.register(function(n){return new vfe(n)}),this.register(function(n){return new yfe(n)}),this.register(function(n){return new dfe(n)}),this.register(function(n){return new xfe(n)}),this.register(function(n){return new pfe(n)}),this.register(function(n){return new ufe(n)}),this.register(function(n){return new bfe(n)}),this.register(function(n){return new Afe(n)})}load(e,n,i,r){const s=this;let o;this.resourcePath!==""?o=this.resourcePath:this.path!==""?o=this.path:o=Bg.extractUrlBase(e),this.manager.itemStart(e);const a=function(c){r?r(c):console.error(c),s.manager.itemError(e),s.manager.itemEnd(e)},l=new xo(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(c){try{s.parse(c,o,function(h){n(h),s.manager.itemEnd(e)},a)}catch(h){a(h)}},i,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,n,i,r){let s;const o={},a={},l=new TextDecoder;if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(l.decode(new Uint8Array(e,0,4))===MY){try{o[pn.KHR_BINARY_GLTF]=new Mfe(e)}catch(u){r&&r(u);return}s=JSON.parse(o[pn.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e));else s=e;if(s.asset===void 0||s.asset.version[0]<2){r&&r(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const c=new Ufe(s,{path:n||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const u=this.pluginCallbacks[h](c);a[u.name]=u,o[u.name]=!0}if(s.extensionsUsed)for(let h=0;h<s.extensionsUsed.length;++h){const u=s.extensionsUsed[h],d=s.extensionsRequired||[];switch(u){case pn.KHR_MATERIALS_UNLIT:o[u]=new hfe;break;case pn.KHR_DRACO_MESH_COMPRESSION:o[u]=new Efe(s,this.dracoLoader);break;case pn.KHR_TEXTURE_TRANSFORM:o[u]=new Cfe;break;case pn.KHR_MESH_QUANTIZATION:o[u]=new Tfe;break;default:d.indexOf(u)>=0&&a[u]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+u+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(i,r)}parseAsync(e,n){const i=this;return new Promise(function(r,s){i.parse(e,n,r,s)})}}function cfe(){let t={};return{get:function(e){return t[e]},add:function(e,n){t[e]=n},remove:function(e){delete t[e]},removeAll:function(){t={}}}}const pn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class ufe{constructor(e){this.parser=e,this.name=pn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,n=this.parser.json.nodes||[];for(let i=0,r=n.length;i<r;i++){const s=n[i];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const n=this.parser,i="light:"+e;let r=n.cache.get(i);if(r)return r;const s=n.json,l=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let c;const h=new st(16777215);l.color!==void 0&&h.fromArray(l.color);const u=l.range!==void 0?l.range:0;switch(l.type){case"directional":c=new IB(h),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new LB(h),c.distance=u;break;case"spot":c=new RB(h),c.distance=u,l.spot=l.spot||{},l.spot.innerConeAngle=l.spot.innerConeAngle!==void 0?l.spot.innerConeAngle:0,l.spot.outerConeAngle=l.spot.outerConeAngle!==void 0?l.spot.outerConeAngle:Math.PI/4,c.angle=l.spot.outerConeAngle,c.penumbra=1-l.spot.innerConeAngle/l.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+l.type)}return c.position.set(0,0,0),c.decay=2,Qu(c,l),l.intensity!==void 0&&(c.intensity=l.intensity),c.name=n.createUniqueName(l.name||"light_"+e),r=Promise.resolve(c),n.cache.add(i,r),r}getDependency(e,n){if(e==="light")return this._loadLight(n)}createNodeAttachment(e){const n=this,i=this.parser,s=i.json.nodes[e],a=(s.extensions&&s.extensions[this.name]||{}).light;return a===void 0?null:this._loadLight(a).then(function(l){return i._getNodeRef(n.cache,a,l)})}}class hfe{constructor(){this.name=pn.KHR_MATERIALS_UNLIT}getMaterialType(){return so}extendParams(e,n,i){const r=[];e.color=new st(1,1,1),e.opacity=1;const s=n.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}s.baseColorTexture!==void 0&&r.push(i.assignTexture(e,"map",s.baseColorTexture,mo))}return Promise.all(r)}}class dfe{constructor(e){this.parser=e,this.name=pn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,n){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name].emissiveStrength;return s!==void 0&&(n.emissiveIntensity=s),Promise.resolve()}}class ffe{constructor(e){this.parser=e,this.name=pn.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:uu}extendMaterialParams(e,n){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];if(o.clearcoatFactor!==void 0&&(n.clearcoat=o.clearcoatFactor),o.clearcoatTexture!==void 0&&s.push(i.assignTexture(n,"clearcoatMap",o.clearcoatTexture)),o.clearcoatRoughnessFactor!==void 0&&(n.clearcoatRoughness=o.clearcoatRoughnessFactor),o.clearcoatRoughnessTexture!==void 0&&s.push(i.assignTexture(n,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),o.clearcoatNormalTexture!==void 0&&(s.push(i.assignTexture(n,"clearcoatNormalMap",o.clearcoatNormalTexture)),o.clearcoatNormalTexture.scale!==void 0)){const a=o.clearcoatNormalTexture.scale;n.clearcoatNormalScale=new Ye(a,a)}return Promise.all(s)}}class pfe{constructor(e){this.parser=e,this.name=pn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:uu}extendMaterialParams(e,n){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.iridescenceFactor!==void 0&&(n.iridescence=o.iridescenceFactor),o.iridescenceTexture!==void 0&&s.push(i.assignTexture(n,"iridescenceMap",o.iridescenceTexture)),o.iridescenceIor!==void 0&&(n.iridescenceIOR=o.iridescenceIor),n.iridescenceThicknessRange===void 0&&(n.iridescenceThicknessRange=[100,400]),o.iridescenceThicknessMinimum!==void 0&&(n.iridescenceThicknessRange[0]=o.iridescenceThicknessMinimum),o.iridescenceThicknessMaximum!==void 0&&(n.iridescenceThicknessRange[1]=o.iridescenceThicknessMaximum),o.iridescenceThicknessTexture!==void 0&&s.push(i.assignTexture(n,"iridescenceThicknessMap",o.iridescenceThicknessTexture)),Promise.all(s)}}class mfe{constructor(e){this.parser=e,this.name=pn.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:uu}extendMaterialParams(e,n){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[];n.sheenColor=new st(0,0,0),n.sheenRoughness=0,n.sheen=1;const o=r.extensions[this.name];return o.sheenColorFactor!==void 0&&n.sheenColor.fromArray(o.sheenColorFactor),o.sheenRoughnessFactor!==void 0&&(n.sheenRoughness=o.sheenRoughnessFactor),o.sheenColorTexture!==void 0&&s.push(i.assignTexture(n,"sheenColorMap",o.sheenColorTexture,mo)),o.sheenRoughnessTexture!==void 0&&s.push(i.assignTexture(n,"sheenRoughnessMap",o.sheenRoughnessTexture)),Promise.all(s)}}class gfe{constructor(e){this.parser=e,this.name=pn.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:uu}extendMaterialParams(e,n){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];return o.transmissionFactor!==void 0&&(n.transmission=o.transmissionFactor),o.transmissionTexture!==void 0&&s.push(i.assignTexture(n,"transmissionMap",o.transmissionTexture)),Promise.all(s)}}class vfe{constructor(e){this.parser=e,this.name=pn.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:uu}extendMaterialParams(e,n){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];n.thickness=o.thicknessFactor!==void 0?o.thicknessFactor:0,o.thicknessTexture!==void 0&&s.push(i.assignTexture(n,"thicknessMap",o.thicknessTexture)),n.attenuationDistance=o.attenuationDistance||1/0;const a=o.attenuationColor||[1,1,1];return n.attenuationColor=new st(a[0],a[1],a[2]),Promise.all(s)}}class yfe{constructor(e){this.parser=e,this.name=pn.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:uu}extendMaterialParams(e,n){const r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=r.extensions[this.name];return n.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class xfe{constructor(e){this.parser=e,this.name=pn.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:uu}extendMaterialParams(e,n){const i=this.parser,r=i.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const s=[],o=r.extensions[this.name];n.specularIntensity=o.specularFactor!==void 0?o.specularFactor:1,o.specularTexture!==void 0&&s.push(i.assignTexture(n,"specularIntensityMap",o.specularTexture));const a=o.specularColorFactor||[1,1,1];return n.specularColor=new st(a[0],a[1],a[2]),o.specularColorTexture!==void 0&&s.push(i.assignTexture(n,"specularColorMap",o.specularColorTexture,mo)),Promise.all(s)}}class _fe{constructor(e){this.parser=e,this.name=pn.KHR_TEXTURE_BASISU}loadTexture(e){const n=this.parser,i=n.json,r=i.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const s=r.extensions[this.name],o=n.options.ktx2Loader;if(!o){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return n.loadTextureImage(e,s.source,o)}}class wfe{constructor(e){this.parser=e,this.name=pn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const n=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[n])return null;const o=s.extensions[n],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class Sfe{constructor(e){this.parser=e,this.name=pn.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){const n=this.name,i=this.parser,r=i.json,s=r.textures[e];if(!s.extensions||!s.extensions[n])return null;const o=s.extensions[n],a=r.images[o.source];let l=i.textureLoader;if(a.uri){const c=i.options.manager.getHandler(a.uri);c!==null&&(l=c)}return this.detectSupport().then(function(c){if(c)return i.loadTextureImage(e,o.source,l);if(r.extensionsRequired&&r.extensionsRequired.indexOf(n)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const n=new Image;n.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",n.onload=n.onerror=function(){e(n.height===1)}})),this.isSupported}}class bfe{constructor(e){this.name=pn.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const n=this.parser.json,i=n.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const r=i.extensions[this.name],s=this.parser.getDependency("buffer",r.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(a){const l=r.byteOffset||0,c=r.byteLength||0,h=r.count,u=r.byteStride,d=new Uint8Array(a,l,c);return o.decodeGltfBufferAsync?o.decodeGltfBufferAsync(h,u,d,r.mode,r.filter).then(function(f){return f.buffer}):o.ready.then(function(){const f=new ArrayBuffer(h*u);return o.decodeGltfBuffer(new Uint8Array(f),h,u,d,r.mode,r.filter),f})})}else return null}}class Afe{constructor(e){this.name=pn.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const n=this.parser.json,i=n.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const r=n.meshes[i.mesh];for(const c of r.primitives)if(c.mode!==Ho.TRIANGLES&&c.mode!==Ho.TRIANGLE_STRIP&&c.mode!==Ho.TRIANGLE_FAN&&c.mode!==void 0)return null;const o=i.extensions[this.name].attributes,a=[],l={};for(const c in o)a.push(this.parser.getDependency("accessor",o[c]).then(h=>(l[c]=h,l[c])));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then(c=>{const h=c.pop(),u=h.isGroup?h.children:[h],d=c[0].count,f=[];for(const p of u){const v=new kt,g=new ae,m=new xr,y=new ae(1,1,1),_=new mB(p.geometry,p.material,d);for(let S=0;S<d;S++)l.TRANSLATION&&g.fromBufferAttribute(l.TRANSLATION,S),l.ROTATION&&m.fromBufferAttribute(l.ROTATION,S),l.SCALE&&y.fromBufferAttribute(l.SCALE,S),_.setMatrixAt(S,v.compose(g,m,y));for(const S in l)S!=="TRANSLATION"&&S!=="ROTATION"&&S!=="SCALE"&&p.geometry.setAttribute(S,l[S]);mn.prototype.copy.call(_,p),this.parser.assignFinalMaterial(_),f.push(_)}return h.isGroup?(h.clear(),h.add(...f),h):f[0]}))}}const MY="glTF",l0=12,G4={JSON:1313821514,BIN:5130562};class Mfe{constructor(e){this.name=pn.KHR_BINARY_GLTF,this.content=null,this.body=null;const n=new DataView(e,0,l0),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(e.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==MY)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-l0,s=new DataView(e,l0);let o=0;for(;o<r;){const a=s.getUint32(o,!0);o+=4;const l=s.getUint32(o,!0);if(o+=4,l===G4.JSON){const c=new Uint8Array(e,l0+o,a);this.content=i.decode(c)}else if(l===G4.BIN){const c=l0+o;this.body=e.slice(c,c+a)}o+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Efe{constructor(e,n){if(!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=pn.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=n,this.dracoLoader.preload()}decodePrimitive(e,n){const i=this.json,r=this.dracoLoader,s=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,a={},l={},c={};for(const h in o){const u=nL[h]||h.toLowerCase();a[u]=o[h]}for(const h in e.attributes){const u=nL[h]||h.toLowerCase();if(o[h]!==void 0){const d=i.accessors[e.attributes[h]],f=rg[d.componentType];c[u]=f.name,l[u]=d.normalized===!0}}return n.getDependency("bufferView",s).then(function(h){return new Promise(function(u){r.decodeDracoFile(h,function(d){for(const f in d.attributes){const p=d.attributes[f],v=l[f];v!==void 0&&(p.normalized=v)}u(d)},a,c)})})}}class Cfe{constructor(){this.name=pn.KHR_TEXTURE_TRANSFORM}extendTexture(e,n){return(n.texCoord===void 0||n.texCoord===e.channel)&&n.offset===void 0&&n.rotation===void 0&&n.scale===void 0||(e=e.clone(),n.texCoord!==void 0&&(e.channel=n.texCoord),n.offset!==void 0&&e.offset.fromArray(n.offset),n.rotation!==void 0&&(e.rotation=n.rotation),n.scale!==void 0&&e.repeat.fromArray(n.scale),e.needsUpdate=!0),e}}class Tfe{constructor(){this.name=pn.KHR_MESH_QUANTIZATION}}class EY extends lv{constructor(e,n,i,r){super(e,n,i,r)}copySampleValue_(e){const n=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r*3+r;for(let o=0;o!==r;o++)n[o]=i[s+o];return n}interpolate_(e,n,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,l=a*2,c=a*3,h=r-n,u=(i-n)/h,d=u*u,f=d*u,p=e*c,v=p-c,g=-2*f+3*d,m=f-d,y=1-g,_=m-d+u;for(let S=0;S!==a;S++){const A=o[v+S+a],b=o[v+S+l]*h,T=o[p+S+a],M=o[p+S]*h;s[S]=y*A+_*b+g*T+m*M}return s}}const Pfe=new xr;class Dfe extends EY{interpolate_(e,n,i,r){const s=super.interpolate_(e,n,i,r);return Pfe.fromArray(s).normalize().toArray(s),s}}const Ho={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},rg={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},H4={9728:vi,9729:oi,9984:ax,9985:NM,9986:eg,9987:Ql},V4={33071:Cr,33648:Mg,10497:Uh},aP={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},nL={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Tu={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Rfe={CUBICSPLINE:void 0,LINEAR:Cf,STEP:Cg},lP={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Lfe(t){return t.DefaultMaterial===void 0&&(t.DefaultMaterial=new p1({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:ql})),t.DefaultMaterial}function c0(t,e,n){for(const i in n.extensions)t[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=n.extensions[i])}function Qu(t,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(t.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function Ife(t,e,n){let i=!1,r=!1,s=!1;for(let c=0,h=e.length;c<h;c++){const u=e[c];if(u.POSITION!==void 0&&(i=!0),u.NORMAL!==void 0&&(r=!0),u.COLOR_0!==void 0&&(s=!0),i&&r&&s)break}if(!i&&!r&&!s)return Promise.resolve(t);const o=[],a=[],l=[];for(let c=0,h=e.length;c<h;c++){const u=e[c];if(i){const d=u.POSITION!==void 0?n.getDependency("accessor",u.POSITION):t.attributes.position;o.push(d)}if(r){const d=u.NORMAL!==void 0?n.getDependency("accessor",u.NORMAL):t.attributes.normal;a.push(d)}if(s){const d=u.COLOR_0!==void 0?n.getDependency("accessor",u.COLOR_0):t.attributes.color;l.push(d)}}return Promise.all([Promise.all(o),Promise.all(a),Promise.all(l)]).then(function(c){const h=c[0],u=c[1],d=c[2];return i&&(t.morphAttributes.position=h),r&&(t.morphAttributes.normal=u),s&&(t.morphAttributes.color=d),t.morphTargetsRelative=!0,t})}function Bfe(t,e){if(t.updateMorphTargets(),e.weights!==void 0)for(let n=0,i=e.weights.length;n<i;n++)t.morphTargetInfluences[n]=e.weights[n];if(e.extras&&Array.isArray(e.extras.targetNames)){const n=e.extras.targetNames;if(t.morphTargetInfluences.length===n.length){t.morphTargetDictionary={};for(let i=0,r=n.length;i<r;i++)t.morphTargetDictionary[n[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Ofe(t){const e=t.extensions&&t.extensions[pn.KHR_DRACO_MESH_COMPRESSION];let n;return e?n="draco:"+e.bufferView+":"+e.indices+":"+j4(e.attributes):n=t.indices+":"+j4(t.attributes)+":"+t.mode,n}function j4(t){let e="";const n=Object.keys(t).sort();for(let i=0,r=n.length;i<r;i++)e+=n[i]+":"+t[n[i]]+";";return e}function iL(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Ffe(t){return t.search(/\.jpe?g($|\?)/i)>0||t.search(/^data\:image\/jpeg/)===0?"image/jpeg":t.search(/\.webp($|\?)/i)>0||t.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const Nfe=new kt;class Ufe{constructor(e={},n={}){this.json=e,this.extensions={},this.plugins={},this.options=n,this.cache=new cfe,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,r=!1,s=-1;typeof navigator<"u"&&(i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,r=navigator.userAgent.indexOf("Firefox")>-1,s=r?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||i||r&&s<98?this.textureLoader=new U7(this.options.manager):this.textureLoader=new W7(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new xo(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,n){const i=this,r=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(o){return o._markDefs&&o._markDefs()}),Promise.all(this._invokeAll(function(o){return o.beforeRoot&&o.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(o){const a={scene:o[0][r.scene||0],scenes:o[0],animations:o[1],cameras:o[2],asset:r.asset,parser:i,userData:{}};c0(s,a,r),Qu(a,r),Promise.all(i._invokeAll(function(l){return l.afterRoot&&l.afterRoot(a)})).then(function(){e(a)})}).catch(n)}_markDefs(){const e=this.json.nodes||[],n=this.json.skins||[],i=this.json.meshes||[];for(let r=0,s=n.length;r<s;r++){const o=n[r].joints;for(let a=0,l=o.length;a<l;a++)e[o[a]].isBone=!0}for(let r=0,s=e.length;r<s;r++){const o=e[r];o.mesh!==void 0&&(this._addNodeRef(this.meshCache,o.mesh),o.skin!==void 0&&(i[o.mesh].isSkinnedMesh=!0)),o.camera!==void 0&&this._addNodeRef(this.cameraCache,o.camera)}}_addNodeRef(e,n){n!==void 0&&(e.refs[n]===void 0&&(e.refs[n]=e.uses[n]=0),e.refs[n]++)}_getNodeRef(e,n,i){if(e.refs[n]<=1)return i;const r=i.clone(),s=(o,a)=>{const l=this.associations.get(o);l!=null&&this.associations.set(a,l);for(const[c,h]of o.children.entries())s(h,a.children[c])};return s(i,r),r.name+="_instance_"+e.uses[n]++,r}_invokeOne(e){const n=Object.values(this.plugins);n.push(this);for(let i=0;i<n.length;i++){const r=e(n[i]);if(r)return r}return null}_invokeAll(e){const n=Object.values(this.plugins);n.unshift(this);const i=[];for(let r=0;r<n.length;r++){const s=e(n[r]);s&&i.push(s)}return i}getDependency(e,n){const i=e+":"+n;let r=this.cache.get(i);if(!r){switch(e){case"scene":r=this.loadScene(n);break;case"node":r=this._invokeOne(function(s){return s.loadNode&&s.loadNode(n)});break;case"mesh":r=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(n)});break;case"accessor":r=this.loadAccessor(n);break;case"bufferView":r=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(n)});break;case"buffer":r=this.loadBuffer(n);break;case"material":r=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(n)});break;case"texture":r=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(n)});break;case"skin":r=this.loadSkin(n);break;case"animation":r=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(n)});break;case"camera":r=this.loadCamera(n);break;default:if(r=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,n)}),!r)throw new Error("Unknown type: "+e);break}this.cache.add(i,r)}return r}getDependencies(e){let n=this.cache.get(e);if(!n){const i=this,r=this.json[e+(e==="mesh"?"es":"s")]||[];n=Promise.all(r.map(function(s,o){return i.getDependency(e,o)})),this.cache.add(e,n)}return n}loadBuffer(e){const n=this.json.buffers[e],i=this.fileLoader;if(n.type&&n.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(n.uri===void 0&&e===0)return Promise.resolve(this.extensions[pn.KHR_BINARY_GLTF].body);const r=this.options;return new Promise(function(s,o){i.load(Bg.resolveURL(n.uri,r.path),s,void 0,function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})}loadBufferView(e){const n=this.json.bufferViews[e];return this.getDependency("buffer",n.buffer).then(function(i){const r=n.byteLength||0,s=n.byteOffset||0;return i.slice(s,s+r)})}loadAccessor(e){const n=this,i=this.json,r=this.json.accessors[e];if(r.bufferView===void 0&&r.sparse===void 0){const o=aP[r.type],a=rg[r.componentType],l=r.normalized===!0,c=new a(r.count*o);return Promise.resolve(new bn(c,o,l))}const s=[];return r.bufferView!==void 0?s.push(this.getDependency("bufferView",r.bufferView)):s.push(null),r.sparse!==void 0&&(s.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(s).then(function(o){const a=o[0],l=aP[r.type],c=rg[r.componentType],h=c.BYTES_PER_ELEMENT,u=h*l,d=r.byteOffset||0,f=r.bufferView!==void 0?i.bufferViews[r.bufferView].byteStride:void 0,p=r.normalized===!0;let v,g;if(f&&f!==u){const m=Math.floor(d/f),y="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+m+":"+r.count;let _=n.cache.get(y);_||(v=new c(a,m*f,r.count*f/h),_=new $x(v,f/h),n.cache.add(y,_)),g=new kh(_,l,d%f/h,p)}else a===null?v=new c(r.count*l):v=new c(a,d,r.count*l),g=new bn(v,l,p);if(r.sparse!==void 0){const m=aP.SCALAR,y=rg[r.sparse.indices.componentType],_=r.sparse.indices.byteOffset||0,S=r.sparse.values.byteOffset||0,A=new y(o[1],_,r.sparse.count*m),b=new c(o[2],S,r.sparse.count*l);a!==null&&(g=new bn(g.array.slice(),g.itemSize,g.normalized));for(let T=0,M=A.length;T<M;T++){const E=A[T];if(g.setX(E,b[T*l]),l>=2&&g.setY(E,b[T*l+1]),l>=3&&g.setZ(E,b[T*l+2]),l>=4&&g.setW(E,b[T*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return g})}loadTexture(e){const n=this.json,i=this.options,s=n.textures[e].source,o=n.images[s];let a=this.textureLoader;if(o.uri){const l=i.manager.getHandler(o.uri);l!==null&&(a=l)}return this.loadTextureImage(e,s,a)}loadTextureImage(e,n,i){const r=this,s=this.json,o=s.textures[e],a=s.images[n],l=(a.uri||a.bufferView)+":"+o.sampler;if(this.textureCache[l])return this.textureCache[l];const c=this.loadImageSource(n,i).then(function(h){h.flipY=!1,h.name=o.name||a.name||"",h.name===""&&typeof a.uri=="string"&&a.uri.startsWith("data:image/")===!1&&(h.name=a.uri);const d=(s.samplers||{})[o.sampler]||{};return h.magFilter=H4[d.magFilter]||oi,h.minFilter=H4[d.minFilter]||Ql,h.wrapS=V4[d.wrapS]||Uh,h.wrapT=V4[d.wrapT]||Uh,r.associations.set(h,{textures:e}),h}).catch(function(){return null});return this.textureCache[l]=c,c}loadImageSource(e,n){const i=this,r=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(u=>u.clone());const o=r.images[e],a=self.URL||self.webkitURL;let l=o.uri||"",c=!1;if(o.bufferView!==void 0)l=i.getDependency("bufferView",o.bufferView).then(function(u){c=!0;const d=new Blob([u],{type:o.mimeType});return l=a.createObjectURL(d),l});else if(o.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const h=Promise.resolve(l).then(function(u){return new Promise(function(d,f){let p=d;n.isImageBitmapLoader===!0&&(p=function(v){const g=new ni(v);g.needsUpdate=!0,d(g)}),n.load(Bg.resolveURL(u,s.path),p,void 0,f)})}).then(function(u){return c===!0&&a.revokeObjectURL(l),u.userData.mimeType=o.mimeType||Ffe(o.uri),u}).catch(function(u){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),u});return this.sourceCache[e]=h,h}assignTexture(e,n,i,r){const s=this;return this.getDependency("texture",i.index).then(function(o){if(!o)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(o=o.clone(),o.channel=i.texCoord),s.extensions[pn.KHR_TEXTURE_TRANSFORM]){const a=i.extensions!==void 0?i.extensions[pn.KHR_TEXTURE_TRANSFORM]:void 0;if(a){const l=s.associations.get(o);o=s.extensions[pn.KHR_TEXTURE_TRANSFORM].extendTexture(o,a),s.associations.set(o,l)}}return r!==void 0&&(o.encoding=r),e[n]=o,o})}assignFinalMaterial(e){const n=e.geometry;let i=e.material;const r=n.attributes.tangent===void 0,s=n.attributes.color!==void 0,o=n.attributes.normal===void 0;if(e.isPoints){const a="PointsMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new t1,Hi.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,l.sizeAttenuation=!1,this.cache.add(a,l)),i=l}else if(e.isLine){const a="LineBasicMaterial:"+i.uuid;let l=this.cache.get(a);l||(l=new Jr,Hi.prototype.copy.call(l,i),l.color.copy(i.color),l.map=i.map,this.cache.add(a,l)),i=l}if(r||s||o){let a="ClonedMaterial:"+i.uuid+":";r&&(a+="derivative-tangents:"),s&&(a+="vertex-colors:"),o&&(a+="flat-shading:");let l=this.cache.get(a);l||(l=i.clone(),s&&(l.vertexColors=!0),o&&(l.flatShading=!0),r&&(l.normalScale&&(l.normalScale.y*=-1),l.clearcoatNormalScale&&(l.clearcoatNormalScale.y*=-1)),this.cache.add(a,l),this.associations.set(l,this.associations.get(i))),i=l}e.material=i}getMaterialType(){return p1}loadMaterial(e){const n=this,i=this.json,r=this.extensions,s=i.materials[e];let o;const a={},l=s.extensions||{},c=[];if(l[pn.KHR_MATERIALS_UNLIT]){const u=r[pn.KHR_MATERIALS_UNLIT];o=u.getMaterialType(),c.push(u.extendParams(a,s,n))}else{const u=s.pbrMetallicRoughness||{};if(a.color=new st(1,1,1),a.opacity=1,Array.isArray(u.baseColorFactor)){const d=u.baseColorFactor;a.color.fromArray(d),a.opacity=d[3]}u.baseColorTexture!==void 0&&c.push(n.assignTexture(a,"map",u.baseColorTexture,mo)),a.metalness=u.metallicFactor!==void 0?u.metallicFactor:1,a.roughness=u.roughnessFactor!==void 0?u.roughnessFactor:1,u.metallicRoughnessTexture!==void 0&&(c.push(n.assignTexture(a,"metalnessMap",u.metallicRoughnessTexture)),c.push(n.assignTexture(a,"roughnessMap",u.metallicRoughnessTexture))),o=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),c.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,a)})))}s.doubleSided===!0&&(a.side=$o);const h=s.alphaMode||lP.OPAQUE;if(h===lP.BLEND?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,h===lP.MASK&&(a.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&o!==so&&(c.push(n.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new Ye(1,1),s.normalTexture.scale!==void 0)){const u=s.normalTexture.scale;a.normalScale.set(u,u)}return s.occlusionTexture!==void 0&&o!==so&&(c.push(n.assignTexture(a,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(a.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&o!==so&&(a.emissive=new st().fromArray(s.emissiveFactor)),s.emissiveTexture!==void 0&&o!==so&&c.push(n.assignTexture(a,"emissiveMap",s.emissiveTexture,mo)),Promise.all(c).then(function(){const u=new o(a);return s.name&&(u.name=s.name),Qu(u,s),n.associations.set(u,{materials:e}),s.extensions&&c0(r,u,s),u})}createUniqueName(e){const n=fn.sanitizeNodeName(e||"");let i=n;for(let r=1;this.nodeNamesUsed[i];++r)i=n+"_"+r;return this.nodeNamesUsed[i]=!0,i}loadGeometries(e){const n=this,i=this.extensions,r=this.primitiveCache;function s(a){return i[pn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(a,n).then(function(l){return W4(l,a,n)})}const o=[];for(let a=0,l=e.length;a<l;a++){const c=e[a],h=Ofe(c),u=r[h];if(u)o.push(u.promise);else{let d;c.extensions&&c.extensions[pn.KHR_DRACO_MESH_COMPRESSION]?d=s(c):d=W4(new Kt,c,n),r[h]={primitive:c,promise:d},o.push(d)}}return Promise.all(o)}loadMesh(e){const n=this,i=this.json,r=this.extensions,s=i.meshes[e],o=s.primitives,a=[];for(let l=0,c=o.length;l<c;l++){const h=o[l].material===void 0?Lfe(this.cache):this.getDependency("material",o[l].material);a.push(h)}return a.push(n.loadGeometries(o)),Promise.all(a).then(function(l){const c=l.slice(0,l.length-1),h=l[l.length-1],u=[];for(let f=0,p=h.length;f<p;f++){const v=h[f],g=o[f];let m;const y=c[f];if(g.mode===Ho.TRIANGLES||g.mode===Ho.TRIANGLE_STRIP||g.mode===Ho.TRIANGLE_FAN||g.mode===void 0)m=s.isSkinnedMesh===!0?new pB(v,y):new gr(v,y),m.isSkinnedMesh===!0&&m.normalizeSkinWeights(),g.mode===Ho.TRIANGLE_STRIP?m.geometry=k4(m.geometry,$3):g.mode===Ho.TRIANGLE_FAN&&(m.geometry=k4(m.geometry,lA));else if(g.mode===Ho.LINES)m=new tl(v,y);else if(g.mode===Ho.LINE_STRIP)m=new nu(v,y);else if(g.mode===Ho.LINE_LOOP)m=new gB(v,y);else if(g.mode===Ho.POINTS)m=new vB(v,y);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);Object.keys(m.geometry.morphAttributes).length>0&&Bfe(m,s),m.name=n.createUniqueName(s.name||"mesh_"+e),Qu(m,s),g.extensions&&c0(r,m,g),n.assignFinalMaterial(m),u.push(m)}for(let f=0,p=u.length;f<p;f++)n.associations.set(u[f],{meshes:e,primitives:f});if(u.length===1)return u[0];const d=new kc;n.associations.set(d,{meshes:e});for(let f=0,p=u.length;f<p;f++)d.add(u[f]);return d})}loadCamera(e){let n;const i=this.json.cameras[e],r=i[i.type];if(!r){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?n=new zn($X.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):i.type==="orthographic"&&(n=new ja(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),i.name&&(n.name=this.createUniqueName(i.name)),Qu(n,i),Promise.resolve(n)}loadSkin(e){const n=this.json.skins[e],i=[];for(let r=0,s=n.joints.length;r<s;r++)i.push(this._loadNodeShallow(n.joints[r]));return n.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",n.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(r){const s=r.pop(),o=r,a=[],l=[];for(let c=0,h=o.length;c<h;c++){const u=o[c];if(u){a.push(u);const d=new kt;s!==null&&d.fromArray(s.array,c*16),l.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',n.joints[c])}return new e1(a,l)})}loadAnimation(e){const i=this.json.animations[e],r=i.name?i.name:"animation_"+e,s=[],o=[],a=[],l=[],c=[];for(let h=0,u=i.channels.length;h<u;h++){const d=i.channels[h],f=i.samplers[d.sampler],p=d.target,v=p.node,g=i.parameters!==void 0?i.parameters[f.input]:f.input,m=i.parameters!==void 0?i.parameters[f.output]:f.output;p.node!==void 0&&(s.push(this.getDependency("node",v)),o.push(this.getDependency("accessor",g)),a.push(this.getDependency("accessor",m)),l.push(f),c.push(p))}return Promise.all([Promise.all(s),Promise.all(o),Promise.all(a),Promise.all(l),Promise.all(c)]).then(function(h){const u=h[0],d=h[1],f=h[2],p=h[3],v=h[4],g=[];for(let m=0,y=u.length;m<y;m++){const _=u[m],S=d[m],A=f[m],b=p[m],T=v[m];if(_===void 0)continue;_.updateMatrix();let M;switch(Tu[T.path]){case Tu.weights:M=Rg;break;case Tu.rotation:M=zh;break;case Tu.position:case Tu.scale:default:M=Lg;break}const E=_.name?_.name:_.uuid,P=b.interpolation!==void 0?Rfe[b.interpolation]:Cf,R=[];Tu[T.path]===Tu.weights?_.traverse(function(B){B.morphTargetInfluences&&R.push(B.name?B.name:B.uuid)}):R.push(E);let F=A.array;if(A.normalized){const B=iL(F.constructor),k=new Float32Array(F.length);for(let j=0,Z=F.length;j<Z;j++)k[j]=F[j]*B;F=k}for(let B=0,k=R.length;B<k;B++){const j=new M(R[B]+"."+Tu[T.path],S.array,F,P);b.interpolation==="CUBICSPLINE"&&(j.createInterpolant=function(ee){const O=this instanceof zh?Dfe:EY;return new O(this.times,this.values,this.getValueSize()/3,ee)},j.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),g.push(j)}}return new Ig(r,void 0,g)})}createNodeMesh(e){const n=this.json,i=this,r=n.nodes[e];return r.mesh===void 0?null:i.getDependency("mesh",r.mesh).then(function(s){const o=i._getNodeRef(i.meshCache,r.mesh,s);return r.weights!==void 0&&o.traverse(function(a){if(a.isMesh)for(let l=0,c=r.weights.length;l<c;l++)a.morphTargetInfluences[l]=r.weights[l]}),o})}loadNode(e){const n=this.json,i=this,r=n.nodes[e],s=i._loadNodeShallow(e),o=[],a=r.children||[];for(let c=0,h=a.length;c<h;c++)o.push(i.getDependency("node",a[c]));const l=r.skin===void 0?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([s,Promise.all(o),l]).then(function(c){const h=c[0],u=c[1],d=c[2];d!==null&&h.traverse(function(f){f.isSkinnedMesh&&f.bind(d,Nfe)});for(let f=0,p=u.length;f<p;f++)h.add(u[f]);return h})}_loadNodeShallow(e){const n=this.json,i=this.extensions,r=this;if(this.nodeCache[e]!==void 0)return this.nodeCache[e];const s=n.nodes[e],o=s.name?r.createUniqueName(s.name):"",a=[],l=r._invokeOne(function(c){return c.createNodeMesh&&c.createNodeMesh(e)});return l&&a.push(l),s.camera!==void 0&&a.push(r.getDependency("camera",s.camera).then(function(c){return r._getNodeRef(r.cameraCache,s.camera,c)})),r._invokeAll(function(c){return c.createNodeAttachment&&c.createNodeAttachment(e)}).forEach(function(c){a.push(c)}),this.nodeCache[e]=Promise.all(a).then(function(c){let h;if(s.isBone===!0?h=new jM:c.length>1?h=new kc:c.length===1?h=c[0]:h=new mn,h!==c[0])for(let u=0,d=c.length;u<d;u++)h.add(c[u]);if(s.name&&(h.userData.name=s.name,h.name=o),Qu(h,s),s.extensions&&c0(i,h,s),s.matrix!==void 0){const u=new kt;u.fromArray(s.matrix),h.applyMatrix4(u)}else s.translation!==void 0&&h.position.fromArray(s.translation),s.rotation!==void 0&&h.quaternion.fromArray(s.rotation),s.scale!==void 0&&h.scale.fromArray(s.scale);return r.associations.has(h)||r.associations.set(h,{}),r.associations.get(h).nodes=e,h}),this.nodeCache[e]}loadScene(e){const n=this.extensions,i=this.json.scenes[e],r=this,s=new kc;i.name&&(s.name=r.createUniqueName(i.name)),Qu(s,i),i.extensions&&c0(n,s,i);const o=i.nodes||[],a=[];for(let l=0,c=o.length;l<c;l++)a.push(r.getDependency("node",o[l]));return Promise.all(a).then(function(l){for(let h=0,u=l.length;h<u;h++)s.add(l[h]);const c=h=>{const u=new Map;for(const[d,f]of r.associations)(d instanceof Hi||d instanceof ni)&&u.set(d,f);return h.traverse(d=>{const f=r.associations.get(d);f!=null&&u.set(d,f)}),u};return r.associations=c(s),s})}}function kfe(t,e,n){const i=e.attributes,r=new $a;if(i.POSITION!==void 0){const a=n.json.accessors[i.POSITION],l=a.min,c=a.max;if(l!==void 0&&c!==void 0){if(r.set(new ae(l[0],l[1],l[2]),new ae(c[0],c[1],c[2])),a.normalized){const h=iL(rg[a.componentType]);r.min.multiplyScalar(h),r.max.multiplyScalar(h)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const a=new ae,l=new ae;for(let c=0,h=s.length;c<h;c++){const u=s[c];if(u.POSITION!==void 0){const d=n.json.accessors[u.POSITION],f=d.min,p=d.max;if(f!==void 0&&p!==void 0){if(l.setX(Math.max(Math.abs(f[0]),Math.abs(p[0]))),l.setY(Math.max(Math.abs(f[1]),Math.abs(p[1]))),l.setZ(Math.max(Math.abs(f[2]),Math.abs(p[2]))),d.normalized){const v=iL(rg[d.componentType]);l.multiplyScalar(v)}a.max(l)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}r.expandByVector(a)}t.boundingBox=r;const o=new el;r.getCenter(o.center),o.radius=r.min.distanceTo(r.max)/2,t.boundingSphere=o}function W4(t,e,n){const i=e.attributes,r=[];function s(o,a){return n.getDependency("accessor",o).then(function(l){t.setAttribute(a,l)})}for(const o in i){const a=nL[o]||o.toLowerCase();a in t.attributes||r.push(s(i[o],a))}if(e.indices!==void 0&&!t.index){const o=n.getDependency("accessor",e.indices).then(function(a){t.setIndex(a)});r.push(o)}return Qu(t,e),kfe(t,e,n),Promise.all(r).then(function(){return e.targets!==void 0?Ife(t,e.targets,n):t})}const cP=new WeakMap;class zfe extends vs{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,n,i,r){const s=new xo(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,o=>{const a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(o,a).then(n).catch(r)},i,r)}decodeDracoFile(e,n,i,r){const s={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!i};this.decodeGeometry(e,s).then(n)}decodeGeometry(e,n){for(const l in n.attributeTypes){const c=n.attributeTypes[l];c.BYTES_PER_ELEMENT!==void 0&&(n.attributeTypes[l]=c.name)}const i=JSON.stringify(n);if(cP.has(e)){const l=cP.get(e);if(l.key===i)return l.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let r;const s=this.workerNextTaskID++,o=e.byteLength,a=this._getWorker(s,o).then(l=>(r=l,new Promise((c,h)=>{r._callbacks[s]={resolve:c,reject:h},r.postMessage({type:"decode",id:s,taskConfig:n,buffer:e},[e])}))).then(l=>this._createGeometry(l.geometry));return a.catch(()=>!0).then(()=>{r&&s&&this._releaseTask(r,s)}),cP.set(e,{key:i,promise:a}),a}_createGeometry(e){const n=new Kt;e.index&&n.setIndex(new bn(e.index.array,1));for(let i=0;i<e.attributes.length;i++){const r=e.attributes[i],s=r.name,o=r.array,a=r.itemSize;n.setAttribute(s,new bn(o,a))}return n}_loadLibrary(e,n){const i=new xo(this.manager);return i.setPath(this.decoderPath),i.setResponseType(n),i.setWithCredentials(this.withCredentials),new Promise((r,s)=>{i.load(e,r,void 0,s)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",n=[];return e?n.push(this._loadLibrary("draco_decoder.js","text")):(n.push(this._loadLibrary("draco_wasm_wrapper.js","text")),n.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(n).then(i=>{const r=i[0];e||(this.decoderConfig.wasmBinary=i[1]);const s=Gfe.toString(),o=["/* draco decoder */",r,"","/* worker */",s.substring(s.indexOf("{")+1,s.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([o]))}),this.decoderPending}_getWorker(e,n){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const r=new Worker(this.workerSourceURL);r._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:this.decoderConfig}),r.onmessage=function(s){const o=s.data;switch(o.type){case"decode":r._callbacks[o.id].resolve(o);break;case"error":r._callbacks[o.id].reject(o);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+o.type+'"')}},this.workerPool.push(r)}else this.workerPool.sort(function(r,s){return r._taskLoad>s._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=n,i._taskLoad+=n,i})}_releaseTask(e,n){e._taskLoad-=e._taskCosts[n],delete e._callbacks[n],delete e._taskCosts[n]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}function Gfe(){let t,e;onmessage=function(o){const a=o.data;switch(a.type){case"init":t=a.decoderConfig,e=new Promise(function(h){t.onModuleLoaded=function(u){h({draco:u})},DracoDecoderModule(t)});break;case"decode":const l=a.buffer,c=a.taskConfig;e.then(h=>{const u=h.draco,d=new u.Decoder,f=new u.DecoderBuffer;f.Init(new Int8Array(l),l.byteLength);try{const p=n(u,d,f,c),v=p.attributes.map(g=>g.array.buffer);p.index&&v.push(p.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:p},v)}catch(p){console.error(p),self.postMessage({type:"error",id:a.id,error:p.message})}finally{u.destroy(f),u.destroy(d)}});break}};function n(o,a,l,c){const h=c.attributeIDs,u=c.attributeTypes;let d,f;const p=a.GetEncodedGeometryType(l);if(p===o.TRIANGULAR_MESH)d=new o.Mesh,f=a.DecodeBufferToMesh(l,d);else if(p===o.POINT_CLOUD)d=new o.PointCloud,f=a.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!f.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());const v={index:null,attributes:[]};for(const g in h){const m=self[u[g]];let y,_;if(c.useUniqueIDs)_=h[g],y=a.GetAttributeByUniqueId(d,_);else{if(_=a.GetAttributeId(d,o[h[g]]),_===-1)continue;y=a.GetAttribute(d,_)}v.attributes.push(r(o,a,d,g,m,y))}return p===o.TRIANGULAR_MESH&&(v.index=i(o,a,d)),o.destroy(d),v}function i(o,a,l){const h=l.num_faces()*3,u=h*4,d=o._malloc(u);a.GetTrianglesUInt32Array(l,u,d);const f=new Uint32Array(o.HEAPF32.buffer,d,h).slice();return o._free(d),{array:f,itemSize:1}}function r(o,a,l,c,h,u){const d=u.num_components(),p=l.num_points()*d,v=p*h.BYTES_PER_ELEMENT,g=s(o,h),m=o._malloc(v);a.GetAttributeDataArrayForAllPoints(l,u,g,v,m);const y=new h(o.HEAPF32.buffer,m,p).slice();return o._free(m),{name:c,array:y,itemSize:d}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}let Fw;const uP=()=>{if(Fw)return Fw;const t="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",e="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",n=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),i=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if(typeof WebAssembly!="object")return{supported:!1};let r=t;WebAssembly.validate(n)&&(r=e);let s;const o=WebAssembly.instantiate(a(r),{}).then(u=>{s=u.instance,s.exports.__wasm_call_ctors()});function a(u){const d=new Uint8Array(u.length);for(let p=0;p<u.length;++p){const v=u.charCodeAt(p);d[p]=v>96?v-71:v>64?v-65:v>47?v+4:v>46?63:62}let f=0;for(let p=0;p<u.length;++p)d[f++]=d[p]<60?i[d[p]]:(d[p]-60)*64+d[++p];return d.buffer.slice(0,f)}function l(u,d,f,p,v,g){const m=s.exports.sbrk,y=f+3&-4,_=m(y*p),S=m(v.length),A=new Uint8Array(s.exports.memory.buffer);A.set(v,S);const b=u(_,f,p,S,v.length);if(b===0&&g&&g(_,y,p),d.set(A.subarray(_,_+f*p)),m(_-m(0)),b!==0)throw new Error(`Malformed buffer data: ${b}`)}const c={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},h={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return Fw={ready:o,supported:!0,decodeVertexBuffer(u,d,f,p,v){l(s.exports.meshopt_decodeVertexBuffer,u,d,f,p,s.exports[c[v]])},decodeIndexBuffer(u,d,f,p){l(s.exports.meshopt_decodeIndexBuffer,u,d,f,p)},decodeIndexSequence(u,d,f,p){l(s.exports.meshopt_decodeIndexSequence,u,d,f,p)},decodeGltfBuffer(u,d,f,p,v,g){l(s.exports[h[v]],u,d,f,p,s.exports[c[g]])}},Fw};let Nw=null;function CY(t,e,n){return i=>{n&&n(i),t&&(Nw||(Nw=new zfe),Nw.setDecoderPath(typeof t=="string"?t:"https://www.gstatic.com/draco/versioned/decoders/1.5.5/"),i.setDRACOLoader(Nw)),e&&i.setMeshoptDecoder(typeof uP=="function"?uP():uP)}}function VB(t,e=!0,n=!0,i){return v1(HB,t,CY(e,n,i))}VB.preload=(t,e=!0,n=!0,i)=>v1.preload(HB,t,CY(e,n,i));VB.clear=t=>v1.clear(HB,t);const Hfe=ge.forwardRef(({makeDefault:t,camera:e,regress:n,domElement:i,enableDamping:r=!0,onChange:s,onStart:o,onEnd:a,...l},c)=>{const h=Wo(A=>A.invalidate),u=Wo(A=>A.camera),d=Wo(A=>A.gl),f=Wo(A=>A.events),p=Wo(A=>A.setEvents),v=Wo(A=>A.set),g=Wo(A=>A.get),m=Wo(A=>A.performance),y=e||u,_=i||f.connected||d.domElement,S=ge.useMemo(()=>new lfe(y),[y]);return g1(()=>{S.enabled&&S.update()},-1),ge.useEffect(()=>(S.connect(_),()=>void S.dispose()),[_,n,S,h]),ge.useEffect(()=>{const A=M=>{h(),n&&m.regress(),s&&s(M)},b=M=>{o&&o(M)},T=M=>{a&&a(M)};return S.addEventListener("change",A),S.addEventListener("start",b),S.addEventListener("end",T),()=>{S.removeEventListener("start",b),S.removeEventListener("end",T),S.removeEventListener("change",A)}},[s,o,a,S,h,p]),ge.useEffect(()=>{if(t){const A=g().controls;return v({controls:S}),()=>v({controls:A})}},[t,S]),ge.createElement("primitive",Qa({ref:c,object:S,enableDamping:r},l))});class Vfe extends t1{constructor(e){super(e),this.onBeforeCompile=(n,i)=>{const{isWebGL2:r}=i.capabilities;n.fragmentShader=n.fragmentShader.replace("#include <output_fragment>",`
        ${r?"#include <output_fragment>":`#extension GL_OES_standard_derivatives : enable
#include <output_fragment>`}
      vec2 cxy = 2.0 * gl_PointCoord - 1.0;
      float r = dot(cxy, cxy);
      float delta = fwidth(r);     
      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);
      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );
      #include <tonemapping_fragment>
      #include <encodings_fragment>
      `)}}}const jfe=ge.forwardRef((t,e)=>{const[n]=ge.useState(()=>new Vfe(null));return ge.createElement("primitive",Qa({},t,{object:n,ref:e,attach:"material"}))});let _d,u0;const Wfe=ge.createContext(null),X4=new kt,Y4=new ae,Xfe=ge.forwardRef(({children:t,range:e,limit:n=1e3,...i},r)=>{const s=ge.useRef(null),[o,a]=ge.useState([]),[[l,c,h]]=ge.useState(()=>[new Float32Array(n*3),Float32Array.from({length:n*3},()=>1),Float32Array.from({length:n},()=>1)]);ge.useEffect(()=>{s.current.geometry.attributes.position.needsUpdate=!0}),g1(()=>{for(s.current.updateMatrix(),s.current.updateMatrixWorld(),X4.copy(s.current.matrixWorld).invert(),s.current.geometry.drawRange.count=Math.min(n,e!==void 0?e:n,o.length),_d=0;_d<o.length;_d++)u0=o[_d].current,u0.getWorldPosition(Y4).applyMatrix4(X4),Y4.toArray(l,_d*3),s.current.geometry.attributes.position.needsUpdate=!0,u0.matrixWorldNeedsUpdate=!0,u0.color.toArray(c,_d*3),s.current.geometry.attributes.color.needsUpdate=!0,h.set([u0.size],_d),s.current.geometry.attributes.size.needsUpdate=!0});const u=ge.useMemo(()=>({getParent:()=>s,subscribe:d=>(a(f=>[...f,d]),()=>a(f=>f.filter(p=>p.current!==d.current)))}),[]);return ge.createElement("points",Qa({userData:{instances:o},matrixAutoUpdate:!1,ref:bY([r,s]),raycast:()=>null},i),ge.createElement("bufferGeometry",null,ge.createElement("bufferAttribute",{attach:"attributes-position",count:l.length/3,array:l,itemSize:3,usage:cf}),ge.createElement("bufferAttribute",{attach:"attributes-color",count:c.length/3,array:c,itemSize:3,usage:cf}),ge.createElement("bufferAttribute",{attach:"attributes-size",count:h.length,array:h,itemSize:1,usage:cf})),ge.createElement(Wfe.Provider,{value:u},t))}),Yfe=ge.forwardRef(({children:t,positions:e,colors:n,sizes:i,stride:r=3,...s},o)=>{const a=ge.useRef(null);return g1(()=>{const l=a.current.geometry.attributes;l.position.needsUpdate=!0,n&&(l.color.needsUpdate=!0),i&&(l.size.needsUpdate=!0)}),ge.createElement("points",Qa({ref:bY([o,a])},s),ge.createElement("bufferGeometry",null,ge.createElement("bufferAttribute",{attach:"attributes-position",count:e.length/r,array:e,itemSize:r,usage:cf}),n&&ge.createElement("bufferAttribute",{attach:"attributes-color",count:n.length/r,array:n,itemSize:3,usage:cf}),i&&ge.createElement("bufferAttribute",{attach:"attributes-size",count:i.length/r,array:i,itemSize:1,usage:cf})),t)}),qfe=ge.forwardRef((t,e)=>t.positions instanceof Float32Array?ge.createElement(Yfe,Qa({},t,{ref:e})):ge.createElement(Xfe,Qa({},t,{ref:e})));var TY={exports:{}},Qfe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Kfe=Qfe,Jfe=Kfe;function PY(){}function DY(){}DY.resetWarningCache=PY;var Zfe=function(){function t(i,r,s,o,a,l){if(l!==Jfe){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:DY,resetWarningCache:PY};return n.PropTypes=n,n};TY.exports=Zfe();var RY=TY.exports;function LY({all:t,scene:e,camera:n}){const i=Wo(({gl:o})=>o),r=Wo(({camera:o})=>o),s=Wo(({scene:o})=>o);return ge.useLayoutEffect(()=>{const o=[];t&&(e||s).traverse(c=>{c.visible===!1&&(o.push(c),c.visible=!0)}),i.compile(e||s,n||r);const a=new lB(128);new aB(.01,1e5,a).update(i,e||s),a.dispose(),o.forEach(c=>c.visible=!1)},[]),null}const $fe=()=>{const{progress:t}=Zde();return We.jsxs(Jde,{as:"div",center:!0,style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[We.jsx("span",{className:"canvas-loader"}),We.jsxs("p",{style:{fontSize:14,color:"#F1F1F1",fontWeight:800,marginTop:40},children:[t.toFixed(2),"%"]})]})},epe=()=>{const t=VB("./public/signs/scene.gltf");return We.jsx("primitive",{object:t.scene,scale:1.5,"position-y":0,"position-x":3,"rotation-y":0})},tpe=()=>We.jsx(wY,{shadows:!0,frameloop:"demand",dpr:[1,2],gl:{preserveDrawingBuffer:!0},camera:{fov:45,near:.1,far:200,position:[-4,3,6]},children:We.jsxs(ge.Suspense,{fallback:We.jsx($fe,{}),children:[We.jsx(Hfe,{autoRotate:!0,enableZoom:!1,maxPolarAngle:Math.PI/2,minPolarAngle:Math.PI/2}),We.jsx(epe,{}),We.jsx(LY,{all:!0})]})}),npe=t=>{const e=ge.useRef(),[n]=ge.useState(()=>sfe(new Float32Array(1500),{radius:1.1}));return g1((i,r)=>{e.current.rotation.x-=r/15,e.current.rotation.y-=r/20}),We.jsx("group",{rotation:[0,0,Math.PI/4],children:We.jsx(qfe,{ref:e,positions:n,frustumCulled:!0,children:We.jsx(jfe,{transparent:!0,color:"#46B5FE",size:.002,sizeAttenuation:!0,depthWrite:!1,opacity:.3})})})},ipe=()=>We.jsx("div",{className:"w-auto h-auto absolute inset-0 z-[-1]",children:We.jsxs(wY,{camera:{position:[0,0,1]},children:[We.jsx(ge.Suspense,{fallback:null,children:We.jsx(npe,{})}),We.jsx(LY,{all:!0})]})}),iu={paddingX:"sm:px-16 px-6",paddingY:"sm:py-16 py-6",padding:"sm:px-16 px-6 sm:py-16 py-10",heroHeadText:"font-black text-white lg:text-[80px] sm:text-[60px] xs:text-[50px] text-[40px] lg:leading-[98px] mt-2",heroSubText:"text-[#dfd9ff] font-medium lg:text-[30px] sm:text-[26px] xs:text-[20px] text-[16px] lg:leading-[40px]",sectionHeadText:"text-[#08B6F9] font-black md:text-[60px] sm:text-[50px] xs:text-[40px] text-[30px]",sectionSubText:"sm:text-[18px] text-[14px] text-secondary uppercase tracking-wider"},rpe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEbElEQVR4nO2a3WscVRiHz7+huQoUsk1i1nSt1qrBr2IxqcVKNZFKpa3bxAqpqG1ihQaapFoRLELk2EhShESyWZtsstk22WSz5oNe2KtCyY2CKRb0TuOFgZZH3nEnTnYiJTkDMyvzwHNx3nnP4TfvzrKwjFIhISEhISEhIfehvIV95S3kylv4s/xtCKT/ZJspP0GD8pJtzXRva4GSsplOT26+Is6+yHGoOM7q9uOcqjjBgyqgSLZInNOSVTJHmj14EirfIlcVh8o4p1WJUBmnTTJXxZk2PqzmKCs1xyAW5wFZd87S25nnblceHHaoACFZJXPNMf4wPqz2KIj2um+Ku/1TYNs3Fayb/6/cW2bnERDtdTYNa45zVgWU4txbZtebINrrpe+gYGBvfqPcW+aJwyDa6zsJuDMU7JvfKPeWqXsDRHv9SyKY3/n75d4yzx4C0eSM1gWaWhdYPbkIrQvca13kfHHPyUU+lmuFntV3F2j0O7fFntdBVAa8P4/+YAEc/lDcIzVnj+zxO7fF3iYQlQFn5tFn5sH2w3n3AKTm7JE9fue2qG8EURnQMYfumAPbs3PuAUjN2SN7/M5tsf9VEJUBXXl0dx5su2bdA5Daup682QC8yG1x4CCIyoALOfSns2B7YYMBSG1dT85sAF7ktjj4CojKgIs59MUcOHQNQGpFPdrv3BZNB0BUBvRk0T3TsGbWPQCpFfVov3NbHHoZRGVAbxbdmwWHty7NEHMqtaIe7Xdui8P7QVQGXJ5EX56CTTlpNgAvclsceQlEZcDAJHpwEjaj7PE7t0W8AURlQCKDHr4Km1H2+J3boqUeRGVAKoNOZWCTar9zW7zzIojKgEwanZkAh7eujRNzKrV1PWmzAXiR26J1L4jKgGwaPZ0G22za/TMotaIe7Xdui/deAFEZkE+hvx8D23zKPQCpFfVov3NbnNoDojLgegp9PQVrjroHILV1PYYD8CK3RfvzICoDboygb4yCQ9cApLauZ8RsAF7ktvjoORCVATevoG9eAYeuAUitqEf7ndui4xkQlQFLSbTj32SWku4BSK2oR/ud2+Lc0yAqA35Mon9KwprD7gFIzdkje/zObdFdB6IyYHmIxtsJ/ro9DMvD3FtO0O3qSXBerkmP9P48zGt+57b45CkQVYnhWe7PngRRlRie5f58N4iqxPAs9xePg6hKDM9y9zwGoioxPMv91aMg9u4O7qsxxXy5izI7t/FhX++Egm2qRLj0CO12buPD+mMg9sVY7YvR1lsb3CehP0pZ/w7aJaud2/jQb3ZAKWs8gMGHQfy2lrqBKBMDUX6zawH018Eoaclq14wHMBQFUZUYnuVO1rCSrIGRAH/3ixmKUiaZkw/xu/Fho9XMjFbDSLX7V0DqYlDWjnp7IbP5i5LpKhrGq2C8itXxStpGKv59Egp1grIei1I2Vkm7lVWuVVOvvCAToTOzHUrJiQjnlJdcjdAwGWH6WgUrkxEIooVs01MRjz75kJCQkJCQEPV/5m+L1LKWlm8XNwAAAABJRU5ErkJggg==",spe="/assets/menu-242d80a8.svg",ope="/assets/close-ad0e0ca6.svg",q4="/assets/meta-e386841a.png",ape="/assets/shopify-c0fdbc80.png",lpe="/assets/starbucks-af2a76fc.png",cpe="/assets/tesla-4c857950.png",Q4=[{id:"about",title:"About"},{id:"project",title:"Project"},{id:"contact",title:"Contact"}],upe=[{title:"Personal Site",tech:"React, Three.js, framer, Render, Spline",icon:q4,iconBg:"#46B5FE",textBgColor:"#0A1835",date:"May 2023",points:["Implemented an interactive and visually stunning personal website using React, leveraging its component-based architecture to create reusable UI elements and manage the website's state effectively.","Employed spline-based animations, providing a visually engaging and intuitive user interface.","Leveraged the Render platform to deploy and host the website, ensuring high performance, scalability, and reliable uptime, allowing visitors to access the website seamlessly.","Utilized Three.js, a powerful JavaScript library for creating 3D graphics in the browser, to incorporate captivating and immersive 3D elements, enhancing the overall visual experience of the website."]},{title:"Queuing System | OuterEdge LA Hackathon",tech:"PostgreSQL, React, Express, NodeJS, Prisma, Render, REST, JWT Auth",icon:lpe,iconBg:"#6666ff",textBgColor:"#000033",date:"March 2023",points:["Collaborated with a team to design and integrate database schemas for a queuing system","Developed frontend logic to ensure secure access control and redirect unauthorized and authorized users to appropriate page","Implemented a user-friendly purchase page with concurrent user limits and a timer, optimizing system performance and user experience","Developed frontend functionality to redirect users based on real-time backend data, enabling efficient and secure access to web application resources"]},{title:"Interactive Game",tech:"PostgreSQL, Express, React, NodeJS, OpenAI, REST, JWT Auth",icon:cpe,iconBg:"#8071DF",textBgColor:"#241C31",date:"November 2022",points:["Developed a text-based web game using the P.E.R.N. stack","Implemented AI to ensure unique adventures","Set up JWT with PostgreSQL to allow for multiple separate users","Utilized PostgreSQL for temporary data to keep story coherent"]},{title:"Discord Monitor",tech:"Node Js, Forever, PM2, Discord.js",icon:ape,iconBg:"#5C3EF0",textBgColor:"#13042A",date:"June 2022 - July 2022",points:["Aggregated data from websites and discord servers through API and processed data to specification","Implement PM2 and Forever","Maintained code as incoming data changes","Utilized open source dependencies to aggregated data in real time"]},{title:"Traffic Light Controller",tech:"C,  Assembly, MPLA",icon:q4,iconBg:"#DE3EF0",textBgColor:"#1B0220",date:"Mar 2022 - April 2022",points:["Developing and maintaining web applications using React.js and other related technologies.","Collaborating with cross-functional teams including designers, product managers, and other developers to create high-quality products.","Implementing responsive design and ensuring cross-browser compatibility.","Participating in code reviews and providing constructive feedback to other developers."]}],hpe="/assets/bubble_sound-a40c07be.mp3",dpe=()=>{const[t,e]=ge.useState(""),[n,i]=ge.useState(!1),[r,s]=ge.useState(!1);function o(){new Audio(hpe).play()}return We.jsx("nav",{className:`
        ${iu.paddingX} w-full flex items-center py-5 fixed top-0 z-20 
        ${n?"bg-primary":"bg-transparent"}
        `,children:We.jsxs("div",{className:"w-full flex justify-between items-center max-w-8x1 mx-auto",children:[We.jsxs(Jie,{to:"/",className:"flex items-center gap-2",onClick:()=>{e(""),o(),window.scrollTo(0,0)},children:[We.jsx("img",{src:rpe,alt:"logo",className:"w-9 h-9 object-contain"}),We.jsxs("p",{className:"text-white text-[18px] font-bold cursor-pointer flex ",children:["Steven ",We.jsx("span",{className:"sm:block hidden",children:" | Computer Engineer"})]})]}),We.jsx("ul",{className:"list-none hidden sm:flex flex-row gap-10",children:Q4.map(a=>We.jsx("li",{className:`${t===a.title?"text-white":"text-secondary"} hover:text-white text-[19px] font-medium`,onClick:()=>{e(a.title)},children:We.jsxs("a",{href:`#${a.id}`,children:[" ",a.title," "]})},a.id))}),We.jsxs("div",{className:"sm:hidden flex flex-1 justify-end items-center",children:[We.jsx("img",{src:r?ope:spe,alt:"menu",className:"w-[28px] h-[28px] object-contain cursor-pointer",onClick:()=>s(!r)}),We.jsx("div",{className:`${r?"flex":"hidden"} p-6 black-gradient absolute top-20 right-0 mx-4 my-2 min-w[140px] z-10 rounded-xl`,children:We.jsx("ul",{className:"list-none flex justify-end items-start flex-col gap-4",children:Q4.map(a=>We.jsx("li",{className:`${t===a.title?"text-whie":"text-secondary"} text-[16px] font-medium font-poppins`,onClick:()=>{e(a.title),s(!r)},children:We.jsxs("a",{href:`#${a.id}`,children:[" ",a.title]})},a.id))})})]})]})})},IY=ge.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),KM=ge.createContext({}),jB=ge.createContext(null),JM=typeof document<"u",K4=JM?ge.useLayoutEffect:ge.useEffect,BY=ge.createContext({strict:!1});function fpe(t,e,n,i){const{visualElement:r}=ge.useContext(KM),s=ge.useContext(BY),o=ge.useContext(jB),a=ge.useContext(IY).reducedMotion,l=ge.useRef();i=i||s.renderer,!l.current&&i&&(l.current=i(t,{visualState:e,parent:r,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:a}));const c=l.current;return ge.useInsertionEffect(()=>{c&&c.update(n,o)}),K4(()=>{c&&c.render()}),ge.useEffect(()=>{c&&c.updateFeatures()}),(window.HandoffAppearAnimations?K4:ge.useEffect)(()=>{c&&c.animationState&&c.animationState.animateChanges()}),c}function Om(t){return typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function ppe(t,e,n){return ge.useCallback(i=>{i&&t.mount&&t.mount(i),e&&(i?e.mount(i):e.unmount()),n&&(typeof n=="function"?n(i):Om(n)&&(n.current=i))},[e])}function vx(t){return typeof t=="string"||Array.isArray(t)}function ZM(t){return typeof t=="object"&&typeof t.start=="function"}const WB=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],XB=["initial",...WB];function $M(t){return ZM(t.animate)||XB.some(e=>vx(t[e]))}function OY(t){return!!($M(t)||t.variants)}function mpe(t,e){if($M(t)){const{initial:n,animate:i}=t;return{initial:n===!1||vx(n)?n:void 0,animate:vx(i)?i:void 0}}return t.inherit!==!1?e:{}}function gpe(t){const{initial:e,animate:n}=mpe(t,ge.useContext(KM));return ge.useMemo(()=>({initial:e,animate:n}),[J4(e),J4(n)])}function J4(t){return Array.isArray(t)?t.join(" "):t}const Z4={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},yx={};for(const t in Z4)yx[t]={isEnabled:e=>Z4[t].some(n=>!!e[n])};function vpe(t){for(const e in t)yx[e]={...yx[e],...t[e]}}const FY=ge.createContext({}),NY=ge.createContext({}),ype=Symbol.for("motionComponentSymbol");function xpe({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:i,Component:r}){t&&vpe(t);function s(a,l){let c;const h={...ge.useContext(IY),...a,layoutId:_pe(a)},{isStatic:u}=h,d=gpe(a),f=i(a,u);if(!u&&JM){d.visualElement=fpe(r,f,h,e);const p=ge.useContext(NY),v=ge.useContext(BY).strict;d.visualElement&&(c=d.visualElement.loadFeatures(h,v,t,p))}return ge.createElement(KM.Provider,{value:d},c&&d.visualElement?ge.createElement(c,{visualElement:d.visualElement,...h}):null,n(r,a,ppe(f,d.visualElement,l),f,u,d.visualElement))}const o=ge.forwardRef(s);return o[ype]=r,o}function _pe({layoutId:t}){const e=ge.useContext(FY).id;return e&&t!==void 0?e+"-"+t:t}function wpe(t){function e(i,r={}){return xpe(t(i,r))}if(typeof Proxy>"u")return e;const n=new Map;return new Proxy(e,{get:(i,r)=>(n.has(r)||n.set(r,e(r)),n.get(r))})}const Spe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function YB(t){return typeof t!="string"||t.includes("-")?!1:!!(Spe.indexOf(t)>-1||/[A-Z]/.test(t))}const dA={};function bpe(t){Object.assign(dA,t)}const x1=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],jf=new Set(x1);function UY(t,{layout:e,layoutId:n}){return jf.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!dA[t]||t==="opacity")}const ks=t=>!!(t&&t.getVelocity),Ape={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Mpe=x1.length;function Epe(t,{enableHardwareAcceleration:e=!0,allowTransformNone:n=!0},i,r){let s="";for(let o=0;o<Mpe;o++){const a=x1[o];if(t[a]!==void 0){const l=Ape[a]||a;s+=`${l}(${t[a]}) `}}return e&&!t.z&&(s+="translateZ(0)"),s=s.trim(),r?s=r(t,i?"":s):n&&i&&(s="none"),s}const kY=t=>e=>typeof e=="string"&&e.startsWith(t),zY=kY("--"),rL=kY("var(--"),Cpe=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,Tpe=(t,e)=>e&&typeof t=="number"?e.transform(t):t,Df=(t,e,n)=>Math.min(Math.max(n,t),e),Wf={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},xy={...Wf,transform:t=>Df(0,1,t)},Uw={...Wf,default:1},_y=t=>Math.round(t*1e5)/1e5,eE=/(-)?([\d]*\.?[\d])+/g,GY=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,Ppe=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function _1(t){return typeof t=="string"}const w1=t=>({test:e=>_1(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Wu=w1("deg"),Vl=w1("%"),Ft=w1("px"),Dpe=w1("vh"),Rpe=w1("vw"),$4={...Vl,parse:t=>Vl.parse(t)/100,transform:t=>Vl.transform(t*100)},eG={...Wf,transform:Math.round},HY={borderWidth:Ft,borderTopWidth:Ft,borderRightWidth:Ft,borderBottomWidth:Ft,borderLeftWidth:Ft,borderRadius:Ft,radius:Ft,borderTopLeftRadius:Ft,borderTopRightRadius:Ft,borderBottomRightRadius:Ft,borderBottomLeftRadius:Ft,width:Ft,maxWidth:Ft,height:Ft,maxHeight:Ft,size:Ft,top:Ft,right:Ft,bottom:Ft,left:Ft,padding:Ft,paddingTop:Ft,paddingRight:Ft,paddingBottom:Ft,paddingLeft:Ft,margin:Ft,marginTop:Ft,marginRight:Ft,marginBottom:Ft,marginLeft:Ft,rotate:Wu,rotateX:Wu,rotateY:Wu,rotateZ:Wu,scale:Uw,scaleX:Uw,scaleY:Uw,scaleZ:Uw,skew:Wu,skewX:Wu,skewY:Wu,distance:Ft,translateX:Ft,translateY:Ft,translateZ:Ft,x:Ft,y:Ft,z:Ft,perspective:Ft,transformPerspective:Ft,opacity:xy,originX:$4,originY:$4,originZ:Ft,zIndex:eG,fillOpacity:xy,strokeOpacity:xy,numOctaves:eG};function qB(t,e,n,i){const{style:r,vars:s,transform:o,transformOrigin:a}=t;let l=!1,c=!1,h=!0;for(const u in e){const d=e[u];if(zY(u)){s[u]=d;continue}const f=HY[u],p=Tpe(d,f);if(jf.has(u)){if(l=!0,o[u]=p,!h)continue;d!==(f.default||0)&&(h=!1)}else u.startsWith("origin")?(c=!0,a[u]=p):r[u]=p}if(e.transform||(l||i?r.transform=Epe(t.transform,n,h,i):r.transform&&(r.transform="none")),c){const{originX:u="50%",originY:d="50%",originZ:f=0}=a;r.transformOrigin=`${u} ${d} ${f}`}}const QB=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function VY(t,e,n){for(const i in e)!ks(e[i])&&!UY(i,n)&&(t[i]=e[i])}function Lpe({transformTemplate:t},e,n){return ge.useMemo(()=>{const i=QB();return qB(i,e,{enableHardwareAcceleration:!n},t),Object.assign({},i.vars,i.style)},[e])}function Ipe(t,e,n){const i=t.style||{},r={};return VY(r,i,t),Object.assign(r,Lpe(t,e,n)),t.transformValues?t.transformValues(r):r}function Bpe(t,e,n){const i={},r=Ipe(t,e,n);return t.drag&&t.dragListener!==!1&&(i.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(i.tabIndex=0),i.style=r,i}const Ope=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onLayoutAnimationStart","onLayoutAnimationComplete","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","ignoreStrict","viewport"]);function fA(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||Ope.has(t)}let jY=t=>!fA(t);function Fpe(t){t&&(jY=e=>e.startsWith("on")?!fA(e):t(e))}try{Fpe(require("@emotion/is-prop-valid").default)}catch{}function Npe(t,e,n){const i={};for(const r in t)r==="values"&&typeof t.values=="object"||(jY(r)||n===!0&&fA(r)||!e&&!fA(r)||t.draggable&&r.startsWith("onDrag"))&&(i[r]=t[r]);return i}function tG(t,e,n){return typeof t=="string"?t:Ft.transform(e+n*t)}function Upe(t,e,n){const i=tG(e,t.x,t.width),r=tG(n,t.y,t.height);return`${i} ${r}`}const kpe={offset:"stroke-dashoffset",array:"stroke-dasharray"},zpe={offset:"strokeDashoffset",array:"strokeDasharray"};function Gpe(t,e,n=1,i=0,r=!0){t.pathLength=1;const s=r?kpe:zpe;t[s.offset]=Ft.transform(-i);const o=Ft.transform(e),a=Ft.transform(n);t[s.array]=`${o} ${a}`}function KB(t,{attrX:e,attrY:n,attrScale:i,originX:r,originY:s,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},h,u,d){if(qB(t,c,h,d),u){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:f,style:p,dimensions:v}=t;f.transform&&(v&&(p.transform=f.transform),delete f.transform),v&&(r!==void 0||s!==void 0||p.transform)&&(p.transformOrigin=Upe(v,r!==void 0?r:.5,s!==void 0?s:.5)),e!==void 0&&(f.x=e),n!==void 0&&(f.y=n),i!==void 0&&(f.scale=i),o!==void 0&&Gpe(f,o,a,l,!1)}const WY=()=>({...QB(),attrs:{}}),JB=t=>typeof t=="string"&&t.toLowerCase()==="svg";function Hpe(t,e,n,i){const r=ge.useMemo(()=>{const s=WY();return KB(s,e,{enableHardwareAcceleration:!1},JB(i),t.transformTemplate),{...s.attrs,style:{...s.style}}},[e]);if(t.style){const s={};VY(s,t.style,t),r.style={...s,...r.style}}return r}function Vpe(t=!1){return(n,i,r,{latestValues:s},o)=>{const l=(YB(n)?Hpe:Bpe)(i,s,o,n),h={...Npe(i,typeof n=="string",t),...l,ref:r},{children:u}=i,d=ge.useMemo(()=>ks(u)?u.get():u,[u]);return ge.createElement(n,{...h,children:d})}}const ZB=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();function XY(t,{style:e,vars:n},i,r){Object.assign(t.style,e,r&&r.getProjectionStyles(i));for(const s in n)t.style.setProperty(s,n[s])}const YY=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function qY(t,e,n,i){XY(t,e,void 0,i);for(const r in e.attrs)t.setAttribute(YY.has(r)?r:ZB(r),e.attrs[r])}function $B(t,e){const{style:n}=t,i={};for(const r in n)(ks(n[r])||e.style&&ks(e.style[r])||UY(r,t))&&(i[r]=n[r]);return i}function QY(t,e){const n=$B(t,e);for(const i in t)if(ks(t[i])||ks(e[i])){const r=x1.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;n[r]=t[i]}return n}function eO(t,e,n,i={},r={}){return typeof e=="function"&&(e=e(n!==void 0?n:t.custom,i,r)),typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"&&(e=e(n!==void 0?n:t.custom,i,r)),e}function jpe(t){const e=ge.useRef(null);return e.current===null&&(e.current=t()),e.current}const pA=t=>Array.isArray(t),Wpe=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),Xpe=t=>pA(t)?t[t.length-1]||0:t;function yb(t){const e=ks(t)?t.get():t;return Wpe(e)?e.toValue():e}function Ype({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:n},i,r,s){const o={latestValues:qpe(i,r,s,t),renderState:e()};return n&&(o.mount=a=>n(i,a,o)),o}const KY=t=>(e,n)=>{const i=ge.useContext(KM),r=ge.useContext(jB),s=()=>Ype(t,e,i,r);return n?s():jpe(s)};function qpe(t,e,n,i){const r={},s=i(t,{});for(const d in s)r[d]=yb(s[d]);let{initial:o,animate:a}=t;const l=$M(t),c=OY(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let h=n?n.initial===!1:!1;h=h||o===!1;const u=h?a:o;return u&&typeof u!="boolean"&&!ZM(u)&&(Array.isArray(u)?u:[u]).forEach(f=>{const p=eO(t,f);if(!p)return;const{transitionEnd:v,transition:g,...m}=p;for(const y in m){let _=m[y];if(Array.isArray(_)){const S=h?_.length-1:0;_=_[S]}_!==null&&(r[y]=_)}for(const y in v)r[y]=v[y]}),r}const Qpe={useVisualState:KY({scrapeMotionValuesFromProps:QY,createRenderState:WY,onMount:(t,e,{renderState:n,latestValues:i})=>{try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}KB(n,i,{enableHardwareAcceleration:!1},JB(e.tagName),t.transformTemplate),qY(e,n)}})},Kpe={useVisualState:KY({scrapeMotionValuesFromProps:$B,createRenderState:QB})};function Jpe(t,{forwardMotionProps:e=!1},n,i){return{...YB(t)?Qpe:Kpe,preloadedFeatures:n,useRender:Vpe(e),createVisualElement:i,Component:t}}function zc(t,e,n,i={passive:!0}){return t.addEventListener(e,n,i),()=>t.removeEventListener(e,n)}const JY=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function tE(t,e="page"){return{point:{x:t[e+"X"],y:t[e+"Y"]}}}const Zpe=t=>e=>JY(e)&&t(e,tE(e));function Xc(t,e,n,i){return zc(t,e,Zpe(n),i)}const $pe=(t,e)=>n=>e(t(n)),Th=(...t)=>t.reduce($pe);function ZY(t){let e=null;return()=>{const n=()=>{e=null};return e===null?(e=t,n):!1}}const nG=ZY("dragHorizontal"),iG=ZY("dragVertical");function $Y(t){let e=!1;if(t==="y")e=iG();else if(t==="x")e=nG();else{const n=nG(),i=iG();n&&i?e=()=>{n(),i()}:(n&&n(),i&&i())}return e}function eq(){const t=$Y(!0);return t?(t(),!1):!0}class Zh{constructor(e){this.isMounted=!1,this.node=e}update(){}}function eme(t){let e=[],n=[],i=0,r=!1,s=!1;const o=new WeakSet,a={schedule:(l,c=!1,h=!1)=>{const u=h&&r,d=u?e:n;return c&&o.add(l),d.indexOf(l)===-1&&(d.push(l),u&&r&&(i=e.length)),l},cancel:l=>{const c=n.indexOf(l);c!==-1&&n.splice(c,1),o.delete(l)},process:l=>{if(r){s=!0;return}if(r=!0,[e,n]=[n,e],n.length=0,i=e.length,i)for(let c=0;c<i;c++){const h=e[c];h(l),o.has(h)&&(a.schedule(h),t())}r=!1,s&&(s=!1,a.process(l))}};return a}const mr={delta:0,timestamp:0,isProcessing:!1},tme=40;let sL=!0,xx=!1;const nE=["read","update","preRender","render","postRender"],sg=nE.reduce((t,e)=>(t[e]=eme(()=>xx=!0),t),{}),nme=t=>sg[t].process(mr),tq=t=>{xx=!1,mr.delta=sL?1e3/60:Math.max(Math.min(t-mr.timestamp,tme),1),mr.timestamp=t,mr.isProcessing=!0,nE.forEach(nme),mr.isProcessing=!1,xx&&(sL=!1,requestAnimationFrame(tq))},ime=()=>{xx=!0,sL=!0,mr.isProcessing||requestAnimationFrame(tq)},ui=nE.reduce((t,e)=>{const n=sg[e];return t[e]=(i,r=!1,s=!1)=>(xx||ime(),n.schedule(i,r,s)),t},{});function ru(t){nE.forEach(e=>sg[e].cancel(t))}function rG(t,e){const n="pointer"+(e?"enter":"leave"),i="onHover"+(e?"Start":"End"),r=(s,o)=>{if(s.type==="touch"||eq())return;const a=t.getProps();t.animationState&&a.whileHover&&t.animationState.setActive("whileHover",e),a[i]&&ui.update(()=>a[i](s,o))};return Xc(t.current,n,r,{passive:!t.getProps()[i]})}class rme extends Zh{mount(){this.unmount=Th(rG(this.node,!0),rG(this.node,!1))}unmount(){}}class sme extends Zh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Th(zc(this.node.current,"focus",()=>this.onFocus()),zc(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const nq=(t,e)=>e?t===e?!0:nq(t,e.parentElement):!1,Ji=t=>t;function hP(t,e){if(!e)return;const n=new PointerEvent("pointer"+t);e(n,tE(n))}class ome extends Zh{constructor(){super(...arguments),this.removeStartListeners=Ji,this.removeEndListeners=Ji,this.removeAccessibleListeners=Ji,this.startPointerPress=(e,n)=>{if(this.removeEndListeners(),this.isPressing)return;const i=this.node.getProps(),s=Xc(window,"pointerup",(a,l)=>{if(!this.checkPressEnd())return;const{onTap:c,onTapCancel:h}=this.node.getProps();ui.update(()=>{nq(this.node.current,a.target)?c&&c(a,l):h&&h(a,l)})},{passive:!(i.onTap||i.onPointerUp)}),o=Xc(window,"pointercancel",(a,l)=>this.cancelPress(a,l),{passive:!(i.onTapCancel||i.onPointerCancel)});this.removeEndListeners=Th(s,o),this.startPress(e,n)},this.startAccessiblePress=()=>{const e=s=>{if(s.key!=="Enter"||this.isPressing)return;const o=a=>{a.key!=="Enter"||!this.checkPressEnd()||hP("up",(l,c)=>{const{onTap:h}=this.node.getProps();h&&ui.update(()=>h(l,c))})};this.removeEndListeners(),this.removeEndListeners=zc(this.node.current,"keyup",o),hP("down",(a,l)=>{this.startPress(a,l)})},n=zc(this.node.current,"keydown",e),i=()=>{this.isPressing&&hP("cancel",(s,o)=>this.cancelPress(s,o))},r=zc(this.node.current,"blur",i);this.removeAccessibleListeners=Th(n,r)}}startPress(e,n){this.isPressing=!0;const{onTapStart:i,whileTap:r}=this.node.getProps();r&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),i&&ui.update(()=>i(e,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!eq()}cancelPress(e,n){if(!this.checkPressEnd())return;const{onTapCancel:i}=this.node.getProps();i&&ui.update(()=>i(e,n))}mount(){const e=this.node.getProps(),n=Xc(this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),i=zc(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=Th(n,i)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const oL=new WeakMap,dP=new WeakMap,ame=t=>{const e=oL.get(t.target);e&&e(t)},lme=t=>{t.forEach(ame)};function cme({root:t,...e}){const n=t||document;dP.has(n)||dP.set(n,{});const i=dP.get(n),r=JSON.stringify(e);return i[r]||(i[r]=new IntersectionObserver(lme,{root:t,...e})),i[r]}function ume(t,e,n){const i=cme(e);return oL.set(t,n),i.observe(t),()=>{oL.delete(t),i.unobserve(t)}}const hme={some:0,all:1};class dme extends Zh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:i,amount:r="some",once:s}=e,o={root:n?n.current:void 0,rootMargin:i,threshold:typeof r=="number"?r:hme[r]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:h,onViewportLeave:u}=this.node.getProps(),d=c?h:u;d&&d(l)};return ume(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(fme(e,n))&&this.startObserver()}unmount(){}}function fme({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const pme={inView:{Feature:dme},tap:{Feature:ome},focus:{Feature:sme},hover:{Feature:rme}};function iq(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let i=0;i<n;i++)if(e[i]!==t[i])return!1;return!0}function mme(t){const e={};return t.values.forEach((n,i)=>e[i]=n.get()),e}function gme(t){const e={};return t.values.forEach((n,i)=>e[i]=n.getVelocity()),e}function iE(t,e,n){const i=t.getProps();return eO(i,e,n!==void 0?n:i.custom,mme(t),gme(t))}const vme="framerAppearId",yme="data-"+ZB(vme);let xme=Ji,tO=Ji;const Ph=t=>t*1e3,Yc=t=>t/1e3,_me={current:!1},rq=t=>Array.isArray(t)&&typeof t[0]=="number";function sq(t){return!!(!t||typeof t=="string"&&oq[t]||rq(t)||Array.isArray(t)&&t.every(sq))}const K0=([t,e,n,i])=>`cubic-bezier(${t}, ${e}, ${n}, ${i})`,oq={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:K0([0,.65,.55,1]),circOut:K0([.55,0,1,.45]),backIn:K0([.31,.01,.66,-.59]),backOut:K0([.33,1.53,.69,.99])};function aq(t){if(t)return rq(t)?K0(t):Array.isArray(t)?t.map(aq):oq[t]}function wme(t,e,n,{delay:i=0,duration:r,repeat:s=0,repeatType:o="loop",ease:a,times:l}={}){const c={[e]:n};l&&(c.offset=l);const h=aq(a);return Array.isArray(h)&&(c.easing=h),t.animate(c,{delay:i,duration:r,easing:Array.isArray(h)?"linear":h,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal"})}const sG={waapi:()=>Object.hasOwnProperty.call(Element.prototype,"animate")},fP={},lq={};for(const t in sG)lq[t]=()=>(fP[t]===void 0&&(fP[t]=sG[t]()),fP[t]);function Sme(t,{repeat:e,repeatType:n="loop"}){const i=e&&n!=="loop"&&e%2===1?0:t.length-1;return t[i]}const cq=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,bme=1e-7,Ame=12;function Mme(t,e,n,i,r){let s,o,a=0;do o=e+(n-e)/2,s=cq(o,i,r)-t,s>0?n=o:e=o;while(Math.abs(s)>bme&&++a<Ame);return o}function S1(t,e,n,i){if(t===e&&n===i)return Ji;const r=s=>Mme(s,0,1,t,n);return s=>s===0||s===1?s:cq(r(s),e,i)}const Eme=S1(.42,0,1,1),Cme=S1(0,0,.58,1),uq=S1(.42,0,.58,1),Tme=t=>Array.isArray(t)&&typeof t[0]!="number",hq=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,dq=t=>e=>1-t(1-e),fq=t=>1-Math.sin(Math.acos(t)),nO=dq(fq),Pme=hq(nO),pq=S1(.33,1.53,.69,.99),iO=dq(pq),Dme=hq(iO),Rme=t=>(t*=2)<1?.5*iO(t):.5*(2-Math.pow(2,-10*(t-1))),Lme={linear:Ji,easeIn:Eme,easeInOut:uq,easeOut:Cme,circIn:fq,circInOut:Pme,circOut:nO,backIn:iO,backInOut:Dme,backOut:pq,anticipate:Rme},oG=t=>{if(Array.isArray(t)){tO(t.length===4);const[e,n,i,r]=t;return S1(e,n,i,r)}else if(typeof t=="string")return Lme[t];return t},rO=(t,e)=>n=>!!(_1(n)&&Ppe.test(n)&&n.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(n,e)),mq=(t,e,n)=>i=>{if(!_1(i))return i;const[r,s,o,a]=i.match(eE);return{[t]:parseFloat(r),[e]:parseFloat(s),[n]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},Ime=t=>Df(0,255,t),pP={...Wf,transform:t=>Math.round(Ime(t))},ef={test:rO("rgb","red"),parse:mq("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:i=1})=>"rgba("+pP.transform(t)+", "+pP.transform(e)+", "+pP.transform(n)+", "+_y(xy.transform(i))+")"};function Bme(t){let e="",n="",i="",r="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),i=t.substring(5,7),r=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),i=t.substring(3,4),r=t.substring(4,5),e+=e,n+=n,i+=i,r+=r),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(i,16),alpha:r?parseInt(r,16)/255:1}}const aL={test:rO("#"),parse:Bme,transform:ef.transform},Fm={test:rO("hsl","hue"),parse:mq("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:i=1})=>"hsla("+Math.round(t)+", "+Vl.transform(_y(e))+", "+Vl.transform(_y(n))+", "+_y(xy.transform(i))+")"},cs={test:t=>ef.test(t)||aL.test(t)||Fm.test(t),parse:t=>ef.test(t)?ef.parse(t):Fm.test(t)?Fm.parse(t):aL.parse(t),transform:t=>_1(t)?t:t.hasOwnProperty("red")?ef.transform(t):Fm.transform(t)},li=(t,e,n)=>-n*t+n*e+t;function mP(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Ome({hue:t,saturation:e,lightness:n,alpha:i}){t/=360,e/=100,n/=100;let r=0,s=0,o=0;if(!e)r=s=o=n;else{const a=n<.5?n*(1+e):n+e-n*e,l=2*n-a;r=mP(l,a,t+1/3),s=mP(l,a,t),o=mP(l,a,t-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:i}}const gP=(t,e,n)=>{const i=t*t;return Math.sqrt(Math.max(0,n*(e*e-i)+i))},Fme=[aL,ef,Fm],Nme=t=>Fme.find(e=>e.test(t));function aG(t){const e=Nme(t);let n=e.parse(t);return e===Fm&&(n=Ome(n)),n}const gq=(t,e)=>{const n=aG(t),i=aG(e),r={...n};return s=>(r.red=gP(n.red,i.red,s),r.green=gP(n.green,i.green,s),r.blue=gP(n.blue,i.blue,s),r.alpha=li(n.alpha,i.alpha,s),ef.transform(r))};function Ume(t){var e,n;return isNaN(t)&&_1(t)&&(((e=t.match(eE))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(GY))===null||n===void 0?void 0:n.length)||0)>0}const vq={regex:Cpe,countKey:"Vars",token:"${v}",parse:Ji},yq={regex:GY,countKey:"Colors",token:"${c}",parse:cs.parse},xq={regex:eE,countKey:"Numbers",token:"${n}",parse:Wf.parse};function vP(t,{regex:e,countKey:n,token:i,parse:r}){const s=t.tokenised.match(e);s&&(t["num"+n]=s.length,t.tokenised=t.tokenised.replace(e,i),t.values.push(...s.map(r)))}function mA(t){const e=t.toString(),n={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return n.value.includes("var(--")&&vP(n,vq),vP(n,yq),vP(n,xq),n}function _q(t){return mA(t).values}function wq(t){const{values:e,numColors:n,numVars:i,tokenised:r}=mA(t),s=e.length;return o=>{let a=r;for(let l=0;l<s;l++)l<i?a=a.replace(vq.token,o[l]):l<i+n?a=a.replace(yq.token,cs.transform(o[l])):a=a.replace(xq.token,_y(o[l]));return a}}const kme=t=>typeof t=="number"?0:t;function zme(t){const e=_q(t);return wq(t)(e.map(kme))}const Gh={test:Ume,parse:_q,createTransformer:wq,getAnimatableNone:zme},Sq=(t,e)=>n=>`${n>0?e:t}`;function bq(t,e){return typeof t=="number"?n=>li(t,e,n):cs.test(t)?gq(t,e):t.startsWith("var(")?Sq(t,e):Mq(t,e)}const Aq=(t,e)=>{const n=[...t],i=n.length,r=t.map((s,o)=>bq(s,e[o]));return s=>{for(let o=0;o<i;o++)n[o]=r[o](s);return n}},Gme=(t,e)=>{const n={...t,...e},i={};for(const r in n)t[r]!==void 0&&e[r]!==void 0&&(i[r]=bq(t[r],e[r]));return r=>{for(const s in i)n[s]=i[s](r);return n}},Mq=(t,e)=>{const n=Gh.createTransformer(e),i=mA(t),r=mA(e);return i.numVars===r.numVars&&i.numColors===r.numColors&&i.numNumbers>=r.numNumbers?Th(Aq(i.values,r.values),n):Sq(t,e)},_x=(t,e,n)=>{const i=e-t;return i===0?1:(n-t)/i},lG=(t,e)=>n=>li(t,e,n);function Hme(t){return typeof t=="number"?lG:typeof t=="string"?cs.test(t)?gq:Mq:Array.isArray(t)?Aq:typeof t=="object"?Gme:lG}function Vme(t,e,n){const i=[],r=n||Hme(t[0]),s=t.length-1;for(let o=0;o<s;o++){let a=r(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||Ji:e;a=Th(l,a)}i.push(a)}return i}function Eq(t,e,{clamp:n=!0,ease:i,mixer:r}={}){const s=t.length;if(tO(s===e.length),s===1)return()=>e[0];t[0]>t[s-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=Vme(e,i,r),a=o.length,l=c=>{let h=0;if(a>1)for(;h<t.length-2&&!(c<t[h+1]);h++);const u=_x(t[h],t[h+1],c);return o[h](u)};return n?c=>l(Df(t[0],t[s-1],c)):l}function jme(t,e){const n=t[t.length-1];for(let i=1;i<=e;i++){const r=_x(0,e,i);t.push(li(n,1,r))}}function Wme(t){const e=[0];return jme(e,t.length-1),e}function Xme(t,e){return t.map(n=>n*e)}function Yme(t,e){return t.map(()=>e||uq).splice(0,t.length-1)}function gA({duration:t=300,keyframes:e,times:n,ease:i="easeInOut"}){const r=Tme(i)?i.map(oG):oG(i),s={done:!1,value:e[0]},o=Xme(n&&n.length===e.length?n:Wme(e),t),a=Eq(o,e,{ease:Array.isArray(r)?r:Yme(e,r)});return{calculatedDuration:t,next:l=>(s.value=a(l),s.done=l>=t,s)}}function Cq(t,e){return e?t*(1e3/e):0}const qme=5;function Tq(t,e,n){const i=Math.max(e-qme,0);return Cq(n-t(i),e-i)}const yP=.001,Qme=.01,cG=10,Kme=.05,Jme=1;function Zme({duration:t=800,bounce:e=.25,velocity:n=0,mass:i=1}){let r,s;xme(t<=Ph(cG));let o=1-e;o=Df(Kme,Jme,o),t=Df(Qme,cG,Yc(t)),o<1?(r=c=>{const h=c*o,u=h*t,d=h-n,f=lL(c,o),p=Math.exp(-u);return yP-d/f*p},s=c=>{const u=c*o*t,d=u*n+n,f=Math.pow(o,2)*Math.pow(c,2)*t,p=Math.exp(-u),v=lL(Math.pow(c,2),o);return(-r(c)+yP>0?-1:1)*((d-f)*p)/v}):(r=c=>{const h=Math.exp(-c*t),u=(c-n)*t+1;return-yP+h*u},s=c=>{const h=Math.exp(-c*t),u=(n-c)*(t*t);return h*u});const a=5/t,l=ege(r,s,a);if(t=Ph(t),isNaN(l))return{stiffness:100,damping:10,duration:t};{const c=Math.pow(l,2)*i;return{stiffness:c,damping:o*2*Math.sqrt(i*c),duration:t}}}const $me=12;function ege(t,e,n){let i=n;for(let r=1;r<$me;r++)i=i-t(i)/e(i);return i}function lL(t,e){return t*Math.sqrt(1-e*e)}const tge=["duration","bounce"],nge=["stiffness","damping","mass"];function uG(t,e){return e.some(n=>t[n]!==void 0)}function ige(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!uG(t,nge)&&uG(t,tge)){const n=Zme(t);e={...e,...n,velocity:0,mass:1},e.isResolvedFromDuration=!0}return e}function Pq({keyframes:t,restDelta:e,restSpeed:n,...i}){const r=t[0],s=t[t.length-1],o={done:!1,value:r},{stiffness:a,damping:l,mass:c,velocity:h,duration:u,isResolvedFromDuration:d}=ige(i),f=h?-Yc(h):0,p=l/(2*Math.sqrt(a*c)),v=s-r,g=Yc(Math.sqrt(a/c)),m=Math.abs(v)<5;n||(n=m?.01:2),e||(e=m?.005:.5);let y;if(p<1){const _=lL(g,p);y=S=>{const A=Math.exp(-p*g*S);return s-A*((f+p*g*v)/_*Math.sin(_*S)+v*Math.cos(_*S))}}else if(p===1)y=_=>s-Math.exp(-g*_)*(v+(f+g*v)*_);else{const _=g*Math.sqrt(p*p-1);y=S=>{const A=Math.exp(-p*g*S),b=Math.min(_*S,300);return s-A*((f+p*g*v)*Math.sinh(b)+_*v*Math.cosh(b))/_}}return{calculatedDuration:d&&u||null,next:_=>{const S=y(_);if(d)o.done=_>=u;else{let A=f;_!==0&&(p<1?A=Tq(y,_,S):A=0);const b=Math.abs(A)<=n,T=Math.abs(s-S)<=e;o.done=b&&T}return o.value=o.done?s:S,o}}}function hG({keyframes:t,velocity:e=0,power:n=.8,timeConstant:i=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:h}){const u=t[0],d={done:!1,value:u},f=M=>a!==void 0&&M<a||l!==void 0&&M>l,p=M=>a===void 0?l:l===void 0||Math.abs(a-M)<Math.abs(l-M)?a:l;let v=n*e;const g=u+v,m=o===void 0?g:o(g);m!==g&&(v=m-u);const y=M=>-v*Math.exp(-M/i),_=M=>m+y(M),S=M=>{const E=y(M),P=_(M);d.done=Math.abs(E)<=c,d.value=d.done?m:P};let A,b;const T=M=>{f(d.value)&&(A=M,b=Pq({keyframes:[d.value,p(d.value)],velocity:Tq(_,M,d.value),damping:r,stiffness:s,restDelta:c,restSpeed:h}))};return T(0),{calculatedDuration:null,next:M=>{let E=!1;return!b&&A===void 0&&(E=!0,S(M),T(M)),A!==void 0&&M>A?b.next(M-A):(!E&&S(M),d)}}}const rge=t=>{const e=({timestamp:n})=>t(n);return{start:()=>ui.update(e,!0),stop:()=>ru(e),now:()=>mr.isProcessing?mr.timestamp:performance.now()}},dG=2e4;function fG(t){let e=0;const n=50;let i=t.next(e);for(;!i.done&&e<dG;)e+=n,i=t.next(e);return e>=dG?1/0:e}const sge={decay:hG,inertia:hG,tween:gA,keyframes:gA,spring:Pq};function vA({autoplay:t=!0,delay:e=0,driver:n=rge,keyframes:i,type:r="keyframes",repeat:s=0,repeatDelay:o=0,repeatType:a="loop",onPlay:l,onStop:c,onComplete:h,onUpdate:u,...d}){let f=1,p=!1,v,g;const m=()=>{v&&v(),g=new Promise(Y=>{v=Y})};m();let y;const _=sge[r]||gA;let S;_!==gA&&typeof i[0]!="number"&&(S=Eq([0,100],i,{clamp:!1}),i=[0,100]);const A=_({...d,keyframes:i});let b;a==="mirror"&&(b=_({...d,keyframes:[...i].reverse(),velocity:-(d.velocity||0)}));let T="idle",M=null,E=null,P=null;A.calculatedDuration===null&&s&&(A.calculatedDuration=fG(A));const{calculatedDuration:R}=A;let F=1/0,B=1/0;R!==null&&(F=R+o,B=F*(s+1)-o);let k=0;const j=Y=>{if(E===null)return;f>0&&(E=Math.min(E,Y)),M!==null?k=M:k=(Y-E)*f;const z=k-e,X=z<0;k=Math.max(z,0),T==="finished"&&M===null&&(k=B);let q=k,re=A;if(s){const ve=k/F;let $=Math.floor(ve),se=ve%1;!se&&ve>=1&&(se=1),se===1&&$--,$=Math.min($,s+1);const ne=!!($%2);ne&&(a==="reverse"?(se=1-se,o&&(se-=o/F)):a==="mirror"&&(re=b));let ie=Df(0,1,se);k>B&&(ie=a==="reverse"&&ne?1:0),q=ie*F}const G=X?{done:!1,value:i[0]}:re.next(q);S&&(G.value=S(G.value));let{done:K}=G;!X&&R!==null&&(K=k>=B);const oe=M===null&&(T==="finished"||T==="running"&&K||f<0&&k<=0);return u&&u(G.value),oe&&O(),G},Z=()=>{y&&y.stop(),y=void 0},ee=()=>{T="idle",Z(),m(),E=P=null},O=()=>{T="finished",h&&h(),Z(),m()},W=()=>{if(p)return;y||(y=n(j));const Y=y.now();l&&l(),M!==null?E=Y-M:(!E||T==="finished")&&(E=Y),P=E,M=null,T="running",y.start()};t&&W();const H={then(Y,z){return g.then(Y,z)},get time(){return Yc(k)},set time(Y){Y=Ph(Y),k=Y,M!==null||!y||f===0?M=Y:E=y.now()-Y/f},get duration(){const Y=A.calculatedDuration===null?fG(A):A.calculatedDuration;return Yc(Y)},get speed(){return f},set speed(Y){Y===f||!y||(f=Y,H.time=Yc(k))},get state(){return T},play:W,pause:()=>{T="paused",M=k},stop:()=>{p=!0,T!=="idle"&&(T="idle",c&&c(),ee())},cancel:()=>{P!==null&&j(P),ee()},complete:()=>{T="finished"},sample:Y=>(E=0,j(Y))};return H}const oge=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),kw=10,age=2e4,lge=(t,e)=>e.type==="spring"||t==="backgroundColor"||!sq(e.ease);function cge(t,e,{onUpdate:n,onComplete:i,...r}){if(!(lq.waapi()&&oge.has(e)&&!r.repeatDelay&&r.repeatType!=="mirror"&&r.damping!==0&&r.type!=="inertia"))return!1;let o=!1,a,l;const c=()=>{l=new Promise(m=>{a=m})};c();let{keyframes:h,duration:u=300,ease:d,times:f}=r;if(lge(e,r)){const m=vA({...r,repeat:0,delay:0});let y={done:!1,value:h[0]};const _=[];let S=0;for(;!y.done&&S<age;)y=m.sample(S),_.push(y.value),S+=kw;f=void 0,h=_,u=S-kw,d="linear"}const p=wme(t.owner.current,e,h,{...r,duration:u,ease:d,times:f}),v=()=>p.cancel(),g=()=>{ui.update(v),a(),c()};return p.onfinish=()=>{t.set(Sme(h,r)),i&&i(),g()},{then(m,y){return l.then(m,y)},get time(){return Yc(p.currentTime||0)},set time(m){p.currentTime=Ph(m)},get speed(){return p.playbackRate},set speed(m){p.playbackRate=m},get duration(){return Yc(u)},play:()=>{o||(p.play(),ru(v))},pause:()=>p.pause(),stop:()=>{if(o=!0,p.playState==="idle")return;const{currentTime:m}=p;if(m){const y=vA({...r,autoplay:!1});t.setWithVelocity(y.sample(m-kw).value,y.sample(m).value,kw)}g()},complete:()=>p.finish(),cancel:g}}function uge({keyframes:t,delay:e,onUpdate:n,onComplete:i}){const r=()=>(n&&n(t[t.length-1]),i&&i(),{time:0,speed:1,duration:0,play:Ji,pause:Ji,stop:Ji,then:s=>(s(),Promise.resolve()),cancel:Ji,complete:Ji});return e?vA({keyframes:[0,1],duration:0,delay:e,onComplete:r}):r()}const hge={type:"spring",stiffness:500,damping:25,restSpeed:10},dge=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),fge={type:"keyframes",duration:.8},pge={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},mge=(t,{keyframes:e})=>e.length>2?fge:jf.has(t)?t.startsWith("scale")?dge(e[1]):hge:pge,cL=(t,e)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Gh.test(e)||e==="0")&&!e.startsWith("url(")),gge=new Set(["brightness","contrast","saturate","opacity"]);function vge(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[i]=n.match(eE)||[];if(!i)return t;const r=n.replace(i,"");let s=gge.has(e)?1:0;return i!==n&&(s*=100),e+"("+s+r+")"}const yge=/([a-z-]*)\(.*?\)/g,uL={...Gh,getAnimatableNone:t=>{const e=t.match(yge);return e?e.map(vge).join(" "):t}},xge={...HY,color:cs,backgroundColor:cs,outlineColor:cs,fill:cs,stroke:cs,borderColor:cs,borderTopColor:cs,borderRightColor:cs,borderBottomColor:cs,borderLeftColor:cs,filter:uL,WebkitFilter:uL},sO=t=>xge[t];function Dq(t,e){let n=sO(t);return n!==uL&&(n=Gh),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const Rq=t=>/^0[^.\s]+$/.test(t);function _ge(t){if(typeof t=="number")return t===0;if(t!==null)return t==="none"||t==="0"||Rq(t)}function wge(t,e,n,i){const r=cL(e,n);let s;Array.isArray(n)?s=[...n]:s=[null,n];const o=i.from!==void 0?i.from:t.get();let a;const l=[];for(let c=0;c<s.length;c++)s[c]===null&&(s[c]=c===0?o:s[c-1]),_ge(s[c])?l.push(c):typeof s[c]=="string"&&(a=s[c]);if(r&&l.length&&a)for(let c=0;c<l.length;c++){const h=l[c];s[h]=Dq(e,a)}return s}function Sge({when:t,delay:e,delayChildren:n,staggerChildren:i,staggerDirection:r,repeat:s,repeatType:o,repeatDelay:a,from:l,elapsed:c,...h}){return!!Object.keys(h).length}function Lq(t,e){return t[e]||t.default||t}const oO=(t,e,n,i={})=>r=>{const s=Lq(i,t)||{},o=s.delay||i.delay||0;let{elapsed:a=0}=i;a=a-Ph(o);const l=wge(e,t,n,s),c=l[0],h=l[l.length-1],u=cL(t,c),d=cL(t,h);let f={keyframes:l,velocity:e.getVelocity(),ease:"easeOut",...s,delay:-a,onUpdate:p=>{e.set(p),s.onUpdate&&s.onUpdate(p)},onComplete:()=>{r(),s.onComplete&&s.onComplete()}};if(Sge(s)||(f={...f,...mge(t,f)}),f.duration&&(f.duration=Ph(f.duration)),f.repeatDelay&&(f.repeatDelay=Ph(f.repeatDelay)),!u||!d||_me.current||s.type===!1)return uge(f);if(e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const p=cge(e,t,f);if(p)return p}return vA(f)};function yA(t){return!!(ks(t)&&t.add)}const bge=t=>/^\-?\d*\.?\d+$/.test(t);function aO(t,e){t.indexOf(e)===-1&&t.push(e)}function lO(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class cO{constructor(){this.subscriptions=[]}add(e){return aO(this.subscriptions,e),()=>lO(this.subscriptions,e)}notify(e,n,i){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,n,i);else for(let s=0;s<r;s++){const o=this.subscriptions[s];o&&o(e,n,i)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Age=t=>!isNaN(parseFloat(t));class Mge{constructor(e,n={}){this.version="10.12.8",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(i,r=!0)=>{this.prev=this.current,this.current=i;const{delta:s,timestamp:o}=mr;this.lastUpdated!==o&&(this.timeDelta=s,this.lastUpdated=o,ui.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>ui.postRender(this.velocityCheck),this.velocityCheck=({timestamp:i})=>{i!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=Age(this.current),this.owner=n.owner}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new cO);const i=this.events[e].add(n);return e==="change"?()=>{i(),ui.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,i){this.set(n),this.prev=e,this.timeDelta=i}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?Cq(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Fg(t,e){return new Mge(t,e)}const Iq=t=>e=>e.test(t),Ege={test:t=>t==="auto",parse:t=>t},Bq=[Wf,Ft,Vl,Wu,Rpe,Dpe,Ege],h0=t=>Bq.find(Iq(t)),Cge=[...Bq,cs,Gh],Tge=t=>Cge.find(Iq(t));function Pge(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Fg(n))}function Dge(t,e){const n=iE(t,e);let{transitionEnd:i={},transition:r={},...s}=n?t.makeTargetAnimatable(n,!1):{};s={...s,...i};for(const o in s){const a=Xpe(s[o]);Pge(t,o,a)}}function Rge(t,e,n){var i,r;const s=Object.keys(e).filter(a=>!t.hasValue(a)),o=s.length;if(o)for(let a=0;a<o;a++){const l=s[a],c=e[l];let h=null;Array.isArray(c)&&(h=c[0]),h===null&&(h=(r=(i=n[l])!==null&&i!==void 0?i:t.readValue(l))!==null&&r!==void 0?r:e[l]),h!=null&&(typeof h=="string"&&(bge(h)||Rq(h))?h=parseFloat(h):!Tge(h)&&Gh.test(c)&&(h=Dq(l,c)),t.addValue(l,Fg(h,{owner:t})),n[l]===void 0&&(n[l]=h),h!==null&&t.setBaseTarget(l,h))}}function Lge(t,e){return e?(e[t]||e.default||e).from:void 0}function Ige(t,e,n){const i={};for(const r in t){const s=Lge(r,e);if(s!==void 0)i[r]=s;else{const o=n.getValue(r);o&&(i[r]=o.get())}}return i}function Bge({protectedKeys:t,needsAnimating:e},n){const i=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,i}function Oq(t,e,{delay:n=0,transitionOverride:i,type:r}={}){let{transition:s=t.getDefaultTransition(),transitionEnd:o,...a}=t.makeTargetAnimatable(e);const l=t.getValue("willChange");i&&(s=i);const c=[],h=r&&t.animationState&&t.animationState.getState()[r];for(const u in a){const d=t.getValue(u),f=a[u];if(!d||f===void 0||h&&Bge(h,u))continue;const p={delay:n,elapsed:0,...s};if(window.HandoffAppearAnimations&&!d.hasAnimated){const g=t.getProps()[yme];g&&(p.elapsed=window.HandoffAppearAnimations(g,u,d,ui))}d.start(oO(u,d,f,t.shouldReduceMotion&&jf.has(u)?{type:!1}:p));const v=d.animation;yA(l)&&(l.add(u),v.then(()=>l.remove(u))),c.push(v)}return o&&Promise.all(c).then(()=>{o&&Dge(t,o)}),c}function hL(t,e,n={}){const i=iE(t,e,n.custom);let{transition:r=t.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(r=n.transitionOverride);const s=i?()=>Promise.all(Oq(t,i,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(l=0)=>{const{delayChildren:c=0,staggerChildren:h,staggerDirection:u}=r;return Oge(t,e,c+l,h,u,n)}:()=>Promise.resolve(),{when:a}=r;if(a){const[l,c]=a==="beforeChildren"?[s,o]:[o,s];return l().then(()=>c())}else return Promise.all([s(),o(n.delay)])}function Oge(t,e,n=0,i=0,r=1,s){const o=[],a=(t.variantChildren.size-1)*i,l=r===1?(c=0)=>c*i:(c=0)=>a-c*i;return Array.from(t.variantChildren).sort(Fge).forEach((c,h)=>{c.notify("AnimationStart",e),o.push(hL(c,e,{...s,delay:n+l(h)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(o)}function Fge(t,e){return t.sortNodePosition(e)}function Nge(t,e,n={}){t.notify("AnimationStart",e);let i;if(Array.isArray(e)){const r=e.map(s=>hL(t,s,n));i=Promise.all(r)}else if(typeof e=="string")i=hL(t,e,n);else{const r=typeof e=="function"?iE(t,e,n.custom):e;i=Promise.all(Oq(t,r,n))}return i.then(()=>t.notify("AnimationComplete",e))}const Uge=[...WB].reverse(),kge=WB.length;function zge(t){return e=>Promise.all(e.map(({animation:n,options:i})=>Nge(t,n,i)))}function Gge(t){let e=zge(t);const n=Vge();let i=!0;const r=(l,c)=>{const h=iE(t,c);if(h){const{transition:u,transitionEnd:d,...f}=h;l={...l,...f,...d}}return l};function s(l){e=l(t)}function o(l,c){const h=t.getProps(),u=t.getVariantContext(!0)||{},d=[],f=new Set;let p={},v=1/0;for(let m=0;m<kge;m++){const y=Uge[m],_=n[y],S=h[y]!==void 0?h[y]:u[y],A=vx(S),b=y===c?_.isActive:null;b===!1&&(v=m);let T=S===u[y]&&S!==h[y]&&A;if(T&&i&&t.manuallyAnimateOnMount&&(T=!1),_.protectedKeys={...p},!_.isActive&&b===null||!S&&!_.prevProp||ZM(S)||typeof S=="boolean")continue;const M=Hge(_.prevProp,S);let E=M||y===c&&_.isActive&&!T&&A||m>v&&A;const P=Array.isArray(S)?S:[S];let R=P.reduce(r,{});b===!1&&(R={});const{prevResolvedValues:F={}}=_,B={...F,...R},k=j=>{E=!0,f.delete(j),_.needsAnimating[j]=!0};for(const j in B){const Z=R[j],ee=F[j];p.hasOwnProperty(j)||(Z!==ee?pA(Z)&&pA(ee)?!iq(Z,ee)||M?k(j):_.protectedKeys[j]=!0:Z!==void 0?k(j):f.add(j):Z!==void 0&&f.has(j)?k(j):_.protectedKeys[j]=!0)}_.prevProp=S,_.prevResolvedValues=R,_.isActive&&(p={...p,...R}),i&&t.blockInitialAnimation&&(E=!1),E&&!T&&d.push(...P.map(j=>({animation:j,options:{type:y,...l}})))}if(f.size){const m={};f.forEach(y=>{const _=t.getBaseTarget(y);_!==void 0&&(m[y]=_)}),d.push({animation:m})}let g=!!d.length;return i&&h.initial===!1&&!t.manuallyAnimateOnMount&&(g=!1),i=!1,g?e(d):Promise.resolve()}function a(l,c,h){var u;if(n[l].isActive===c)return Promise.resolve();(u=t.variantChildren)===null||u===void 0||u.forEach(f=>{var p;return(p=f.animationState)===null||p===void 0?void 0:p.setActive(l,c)}),n[l].isActive=c;const d=o(h,l);for(const f in n)n[f].protectedKeys={};return d}return{animateChanges:o,setActive:a,setAnimateFunction:s,getState:()=>n}}function Hge(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!iq(e,t):!1}function wd(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Vge(){return{animate:wd(!0),whileInView:wd(),whileHover:wd(),whileTap:wd(),whileDrag:wd(),whileFocus:wd(),exit:wd()}}class jge extends Zh{constructor(e){super(e),e.animationState||(e.animationState=Gge(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),ZM(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){}}let Wge=0;class Xge extends Zh{constructor(){super(...arguments),this.id=Wge++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n,custom:i}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const s=this.node.animationState.setActive("exit",!e,{custom:i??this.node.getProps().custom});n&&!e&&s.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Yge={animation:{Feature:jge},exit:{Feature:Xge}},pG=(t,e)=>Math.abs(t-e);function qge(t,e){const n=pG(t.x,e.x),i=pG(t.y,e.y);return Math.sqrt(n**2+i**2)}class Fq{constructor(e,n,{transformPagePoint:i}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const c=_P(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,u=qge(c.offset,{x:0,y:0})>=3;if(!h&&!u)return;const{point:d}=c,{timestamp:f}=mr;this.history.push({...d,timestamp:f});const{onStart:p,onMove:v}=this.handlers;h||(p&&p(this.lastMoveEvent,c),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,c)},this.handlePointerMove=(c,h)=>{this.lastMoveEvent=c,this.lastMoveEventInfo=xP(h,this.transformPagePoint),ui.update(this.updatePoint,!0)},this.handlePointerUp=(c,h)=>{if(this.end(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const{onEnd:u,onSessionEnd:d}=this.handlers,f=_P(c.type==="pointercancel"?this.lastMoveEventInfo:xP(h,this.transformPagePoint),this.history);this.startEvent&&u&&u(c,f),d&&d(c,f)},!JY(e))return;this.handlers=n,this.transformPagePoint=i;const r=tE(e),s=xP(r,this.transformPagePoint),{point:o}=s,{timestamp:a}=mr;this.history=[{...o,timestamp:a}];const{onSessionStart:l}=n;l&&l(e,_P(s,this.history)),this.removeListeners=Th(Xc(window,"pointermove",this.handlePointerMove),Xc(window,"pointerup",this.handlePointerUp),Xc(window,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),ru(this.updatePoint)}}function xP(t,e){return e?{point:e(t.point)}:t}function mG(t,e){return{x:t.x-e.x,y:t.y-e.y}}function _P({point:t},e){return{point:t,delta:mG(t,Nq(e)),offset:mG(t,Qge(e)),velocity:Kge(e,.1)}}function Qge(t){return t[0]}function Nq(t){return t[t.length-1]}function Kge(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,i=null;const r=Nq(t);for(;n>=0&&(i=t[n],!(r.timestamp-i.timestamp>Ph(e)));)n--;if(!i)return{x:0,y:0};const s=Yc(r.timestamp-i.timestamp);if(s===0)return{x:0,y:0};const o={x:(r.x-i.x)/s,y:(r.y-i.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function _o(t){return t.max-t.min}function dL(t,e=0,n=.01){return Math.abs(t-e)<=n}function gG(t,e,n,i=.5){t.origin=i,t.originPoint=li(e.min,e.max,t.origin),t.scale=_o(n)/_o(e),(dL(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=li(n.min,n.max,t.origin)-t.originPoint,(dL(t.translate)||isNaN(t.translate))&&(t.translate=0)}function wy(t,e,n,i){gG(t.x,e.x,n.x,i?i.originX:void 0),gG(t.y,e.y,n.y,i?i.originY:void 0)}function vG(t,e,n){t.min=n.min+e.min,t.max=t.min+_o(e)}function Jge(t,e,n){vG(t.x,e.x,n.x),vG(t.y,e.y,n.y)}function yG(t,e,n){t.min=e.min-n.min,t.max=t.min+_o(e)}function Sy(t,e,n){yG(t.x,e.x,n.x),yG(t.y,e.y,n.y)}function Zge(t,{min:e,max:n},i){return e!==void 0&&t<e?t=i?li(e,t,i.min):Math.max(t,e):n!==void 0&&t>n&&(t=i?li(n,t,i.max):Math.min(t,n)),t}function xG(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function $ge(t,{top:e,left:n,bottom:i,right:r}){return{x:xG(t.x,n,r),y:xG(t.y,e,i)}}function _G(t,e){let n=e.min-t.min,i=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,i]=[i,n]),{min:n,max:i}}function eve(t,e){return{x:_G(t.x,e.x),y:_G(t.y,e.y)}}function tve(t,e){let n=.5;const i=_o(t),r=_o(e);return r>i?n=_x(e.min,e.max-i,t.min):i>r&&(n=_x(t.min,t.max-r,e.min)),Df(0,1,n)}function nve(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const fL=.35;function ive(t=fL){return t===!1?t=0:t===!0&&(t=fL),{x:wG(t,"left","right"),y:wG(t,"top","bottom")}}function wG(t,e,n){return{min:SG(t,e),max:SG(t,n)}}function SG(t,e){return typeof t=="number"?t:t[e]||0}const bG=()=>({translate:0,scale:1,origin:0,originPoint:0}),by=()=>({x:bG(),y:bG()}),AG=()=>({min:0,max:0}),Ni=()=>({x:AG(),y:AG()});function Cl(t){return[t("x"),t("y")]}function Uq({top:t,left:e,right:n,bottom:i}){return{x:{min:e,max:n},y:{min:t,max:i}}}function rve({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function sve(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),i=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:i.y,right:i.x}}function wP(t){return t===void 0||t===1}function pL({scale:t,scaleX:e,scaleY:n}){return!wP(t)||!wP(e)||!wP(n)}function Bd(t){return pL(t)||kq(t)||t.z||t.rotate||t.rotateX||t.rotateY}function kq(t){return MG(t.x)||MG(t.y)}function MG(t){return t&&t!=="0%"}function xA(t,e,n){const i=t-n,r=e*i;return n+r}function EG(t,e,n,i,r){return r!==void 0&&(t=xA(t,r,i)),xA(t,n,i)+e}function mL(t,e=0,n=1,i,r){t.min=EG(t.min,e,n,i,r),t.max=EG(t.max,e,n,i,r)}function zq(t,{x:e,y:n}){mL(t.x,e.translate,e.scale,e.originPoint),mL(t.y,n.translate,n.scale,n.originPoint)}function ove(t,e,n,i=!1){const r=n.length;if(!r)return;e.x=e.y=1;let s,o;for(let a=0;a<r;a++){s=n[a],o=s.projectionDelta;const l=s.instance;l&&l.style&&l.style.display==="contents"||(i&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Nm(t,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,zq(t,o)),i&&Bd(s.latestValues)&&Nm(t,s.latestValues))}e.x=CG(e.x),e.y=CG(e.y)}function CG(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function Ku(t,e){t.min=t.min+e,t.max=t.max+e}function TG(t,e,[n,i,r]){const s=e[r]!==void 0?e[r]:.5,o=li(t.min,t.max,s);mL(t,e[n],e[i],o,e.scale)}const ave=["x","scaleX","originX"],lve=["y","scaleY","originY"];function Nm(t,e){TG(t.x,e,ave),TG(t.y,e,lve)}function Gq(t,e){return Uq(sve(t.getBoundingClientRect(),e))}function cve(t,e,n){const i=Gq(t,n),{scroll:r}=e;return r&&(Ku(i.x,r.offset.x),Ku(i.y,r.offset.y)),i}const uve=new WeakMap;class hve{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ni(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:i}=this.visualElement;if(i&&i.isPresent===!1)return;const r=l=>{this.stopAnimation(),n&&this.snapToCursor(tE(l,"page").point)},s=(l,c)=>{const{drag:h,dragPropagation:u,onDragStart:d}=this.getProps();if(h&&!u&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=$Y(h),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Cl(p=>{let v=this.getAxisMotionValue(p).get()||0;if(Vl.test(v)){const{projection:g}=this.visualElement;if(g&&g.layout){const m=g.layout.layoutBox[p];m&&(v=_o(m)*(parseFloat(v)/100))}}this.originPoint[p]=v}),d&&ui.update(()=>d(l,c),!1,!0);const{animationState:f}=this.visualElement;f&&f.setActive("whileDrag",!0)},o=(l,c)=>{const{dragPropagation:h,dragDirectionLock:u,onDirectionLock:d,onDrag:f}=this.getProps();if(!h&&!this.openGlobalLock)return;const{offset:p}=c;if(u&&this.currentDirection===null){this.currentDirection=dve(p),this.currentDirection!==null&&d&&d(this.currentDirection);return}this.updateAxis("x",c.point,p),this.updateAxis("y",c.point,p),this.visualElement.render(),f&&f(l,c)},a=(l,c)=>this.stop(l,c);this.panSession=new Fq(e,{onSessionStart:r,onStart:s,onMove:o,onSessionEnd:a},{transformPagePoint:this.visualElement.getTransformPagePoint()})}stop(e,n){const i=this.isDragging;if(this.cancel(),!i)return;const{velocity:r}=n;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&ui.update(()=>s(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:i}=this.getProps();!i&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,i){const{drag:r}=this.getProps();if(!i||!zw(e,r,this.currentDirection))return;const s=this.getAxisMotionValue(e);let o=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(o=Zge(o,this.constraints[e],this.elastic[e])),s.set(o)}resolveConstraints(){const{dragConstraints:e,dragElastic:n}=this.getProps(),{layout:i}=this.visualElement.projection||{},r=this.constraints;e&&Om(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&i?this.constraints=$ge(i.layoutBox,e):this.constraints=!1,this.elastic=ive(n),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&Cl(s=>{this.getAxisMotionValue(s)&&(this.constraints[s]=nve(i.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Om(e))return!1;const i=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=cve(i,r.root,this.visualElement.getTransformPagePoint());let o=eve(r.layout.layoutBox,s);if(n){const a=n(rve(o));this.hasMutatedConstraints=!!a,a&&(o=Uq(a))}return o}startAnimation(e){const{drag:n,dragMomentum:i,dragElastic:r,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=Cl(h=>{if(!zw(h,n,this.currentDirection))return;let u=l&&l[h]||{};o&&(u={min:0,max:0});const d=r?200:1e6,f=r?40:1e7,p={type:"inertia",velocity:i?e[h]:0,bounceStiffness:d,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...s,...u};return this.startAxisValueAnimation(h,p)});return Promise.all(c).then(a)}startAxisValueAnimation(e,n){const i=this.getAxisMotionValue(e);return i.start(oO(e,i,0,n))}stopAnimation(){Cl(e=>this.getAxisMotionValue(e).stop())}getAxisMotionValue(e){const n="_drag"+e.toUpperCase(),i=this.visualElement.getProps(),r=i[n];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){Cl(n=>{const{drag:i}=this.getProps();if(!zw(n,i,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(n);if(r&&r.layout){const{min:o,max:a}=r.layout.layoutBox[n];s.set(e[n]-li(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:i}=this.visualElement;if(!Om(n)||!i||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Cl(o=>{const a=this.getAxisMotionValue(o);if(a){const l=a.get();r[o]=tve({min:l,max:l},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),Cl(o=>{if(!zw(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(li(l,c,r[o]))})}addListeners(){if(!this.visualElement.current)return;uve.set(this.visualElement,this);const e=this.visualElement.current,n=Xc(e,"pointerdown",l=>{const{drag:c,dragListener:h=!0}=this.getProps();c&&h&&this.start(l)}),i=()=>{const{dragConstraints:l}=this.getProps();Om(l)&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),i();const o=zc(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Cl(h=>{const u=this.getAxisMotionValue(h);u&&(this.originPoint[h]+=l[h].translate,u.set(u.get()+l[h].translate))}),this.visualElement.render())});return()=>{o(),n(),s(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:o=fL,dragMomentum:a=!0}=e;return{...e,drag:n,dragDirectionLock:i,dragPropagation:r,dragConstraints:s,dragElastic:o,dragMomentum:a}}}function zw(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function dve(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class fve extends Zh{constructor(e){super(e),this.removeGroupControls=Ji,this.removeListeners=Ji,this.controls=new hve(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ji}unmount(){this.removeGroupControls(),this.removeListeners()}}const PG=t=>(e,n)=>{t&&ui.update(()=>t(e,n))};class pve extends Zh{constructor(){super(...arguments),this.removePointerDownListener=Ji}onPointerDown(e){this.session=new Fq(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint()})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:PG(e),onStart:PG(n),onMove:i,onEnd:(s,o)=>{delete this.session,r&&ui.update(()=>r(s,o))}}}mount(){this.removePointerDownListener=Xc(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function mve(){const t=ge.useContext(jB);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:n,register:i}=t,r=ge.useId();return ge.useEffect(()=>i(r),[]),!e&&n?[!1,()=>n&&n(r)]:[!0]}const xb={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function DG(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const d0={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Ft.test(t))t=parseFloat(t);else return t;const n=DG(t,e.target.x),i=DG(t,e.target.y);return`${n}% ${i}%`}},gve={correct:(t,{treeScale:e,projectionDelta:n})=>{const i=t,r=Gh.parse(t);if(r.length>5)return i;const s=Gh.createTransformer(t),o=typeof r[0]!="number"?1:0,a=n.x.scale*e.x,l=n.y.scale*e.y;r[0+o]/=a,r[1+o]/=l;const c=li(a,l,.5);return typeof r[2+o]=="number"&&(r[2+o]/=c),typeof r[3+o]=="number"&&(r[3+o]/=c),s(r)}};class vve extends Wh.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:i,layoutId:r}=this.props,{projection:s}=e;bpe(yve),s&&(n.group&&n.group.add(s),i&&i.register&&r&&i.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),xb.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:i,drag:r,isPresent:s}=this.props,o=i.projection;return o&&(o.isPresent=s,r||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==s&&(s?o.promote():o.relegate()||ui.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function Hq(t){const[e,n]=mve(),i=ge.useContext(FY);return Wh.createElement(vve,{...t,layoutGroup:i,switchLayoutGroup:ge.useContext(NY),isPresent:e,safeToRemove:n})}const yve={borderRadius:{...d0,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:d0,borderTopRightRadius:d0,borderBottomLeftRadius:d0,borderBottomRightRadius:d0,boxShadow:gve},Vq=["TopLeft","TopRight","BottomLeft","BottomRight"],xve=Vq.length,RG=t=>typeof t=="string"?parseFloat(t):t,LG=t=>typeof t=="number"||Ft.test(t);function _ve(t,e,n,i,r,s){r?(t.opacity=li(0,n.opacity!==void 0?n.opacity:1,wve(i)),t.opacityExit=li(e.opacity!==void 0?e.opacity:1,0,Sve(i))):s&&(t.opacity=li(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,i));for(let o=0;o<xve;o++){const a=`border${Vq[o]}Radius`;let l=IG(e,a),c=IG(n,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||LG(l)===LG(c)?(t[a]=Math.max(li(RG(l),RG(c),i),0),(Vl.test(c)||Vl.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||n.rotate)&&(t.rotate=li(e.rotate||0,n.rotate||0,i))}function IG(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const wve=jq(0,.5,nO),Sve=jq(.5,.95,Ji);function jq(t,e,n){return i=>i<t?0:i>e?1:n(_x(t,e,i))}function BG(t,e){t.min=e.min,t.max=e.max}function Oo(t,e){BG(t.x,e.x),BG(t.y,e.y)}function OG(t,e,n,i,r){return t-=e,t=xA(t,1/n,i),r!==void 0&&(t=xA(t,1/r,i)),t}function bve(t,e=0,n=1,i=.5,r,s=t,o=t){if(Vl.test(e)&&(e=parseFloat(e),e=li(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=li(s.min,s.max,i);t===s&&(a-=e),t.min=OG(t.min,e,n,a,r),t.max=OG(t.max,e,n,a,r)}function FG(t,e,[n,i,r],s,o){bve(t,e[n],e[i],e[r],e.scale,s,o)}const Ave=["x","scaleX","originX"],Mve=["y","scaleY","originY"];function NG(t,e,n,i){FG(t.x,e,Ave,n?n.x:void 0,i?i.x:void 0),FG(t.y,e,Mve,n?n.y:void 0,i?i.y:void 0)}function UG(t){return t.translate===0&&t.scale===1}function Wq(t){return UG(t.x)&&UG(t.y)}function gL(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function kG(t){return _o(t.x)/_o(t.y)}class Eve{constructor(){this.members=[]}add(e){aO(this.members,e),e.scheduleRender()}remove(e){if(lO(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(r=>e===r);if(n===0)return!1;let i;for(let r=n;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){i=s;break}}return i?(this.promote(i),!0):!1}promote(e,n){const i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,n&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:i}=e;n.onExitComplete&&n.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function zG(t,e,n){let i="";const r=t.x.translate/e.x,s=t.y.translate/e.y;if((r||s)&&(i=`translate3d(${r}px, ${s}px, 0) `),(e.x!==1||e.y!==1)&&(i+=`scale(${1/e.x}, ${1/e.y}) `),n){const{rotate:l,rotateX:c,rotateY:h}=n;l&&(i+=`rotate(${l}deg) `),c&&(i+=`rotateX(${c}deg) `),h&&(i+=`rotateY(${h}deg) `)}const o=t.x.scale*e.x,a=t.y.scale*e.y;return(o!==1||a!==1)&&(i+=`scale(${o}, ${a})`),i||"none"}const Cve=(t,e)=>t.depth-e.depth;class Tve{constructor(){this.children=[],this.isDirty=!1}add(e){aO(this.children,e),this.isDirty=!0}remove(e){lO(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Cve),this.isDirty=!1,this.children.forEach(e)}}function Pve(t,e){const n=performance.now(),i=({timestamp:r})=>{const s=r-n;s>=e&&(ru(i),t(s-e))};return ui.read(i,!0),()=>ru(i)}function Dve(t){window.MotionDebug&&window.MotionDebug.record(t)}function Rve(t){return t instanceof SVGElement&&t.tagName!=="svg"}function Lve(t,e,n){const i=ks(t)?t:Fg(t);return i.start(oO("",i,e,n)),i.animation}const GG=["","X","Y","Z"],HG=1e3;let Ive=0;const Od={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function Xq({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:i,resetTransform:r}){return class{constructor(o={},a=e==null?void 0:e()){this.id=Ive++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{Od.totalNodes=Od.resolvedTargetDeltas=Od.recalculatedProjection=0,this.nodes.forEach(Fve),this.nodes.forEach(zve),this.nodes.forEach(Gve),this.nodes.forEach(Nve),Dve(Od)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new Tve)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new cO),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Rve(o),this.instance=o;const{layoutId:l,layout:c,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(c||l)&&(this.isLayoutDirty=!0),t){let u;const d=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,u&&u(),u=Pve(d,250),xb.hasAnimatedSinceResize&&(xb.hasAnimatedSinceResize=!1,this.nodes.forEach(jG))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&h&&(l||c)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeTargetChanged:f,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||h.getDefaultTransition()||Xve,{onLayoutAnimationStart:g,onLayoutAnimationComplete:m}=h.getProps(),y=!this.targetLayout||!gL(this.targetLayout,p)||f,_=!d&&f;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||_||d&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(u,_);const S={...Lq(v,"layout"),onPlay:g,onComplete:m};(h.shouldReduceMotion||this.options.layoutRoot)&&(S.delay=0,S.type=!1),this.startAnimation(S)}else!d&&this.animationProgress===0&&jG(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,ru(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Hve),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const u=this.path[h];u.shouldResetTransform=!0,u.updateScroll("snapshot"),u.options.layoutRoot&&u.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(VG);return}this.isUpdating&&(this.isUpdating=!1,this.nodes.forEach(kve),this.nodes.forEach(Bve),this.nodes.forEach(Ove),this.clearAllSnapshots(),sg.update.process(mr),sg.preRender.process(mr),sg.render.process(mr))}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(Uve),this.sharedNodes.forEach(Vve)}scheduleUpdateProjection(){ui.preRender(this.updateProjection,!1,!0)}scheduleCheckAfterUnmount(){ui.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ni(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:i(this.instance),offset:n(this.instance)})}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform,a=this.projectionDelta&&!Wq(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,h=c!==this.prevTransformTemplateValue;o&&(a||Bd(this.latestValues)||h)&&(r(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),Yve(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return Ni();const a=o.measureViewportBox(),{scroll:l}=this.root;return l&&(Ku(a.x,l.offset.x),Ku(a.y,l.offset.y)),a}removeElementScroll(o){const a=Ni();Oo(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l],{scroll:h,options:u}=c;if(c!==this.root&&h&&u.layoutScroll){if(h.isRoot){Oo(a,o);const{scroll:d}=this.root;d&&(Ku(a.x,-d.offset.x),Ku(a.y,-d.offset.y))}Ku(a.x,h.offset.x),Ku(a.y,h.offset.y)}}return a}applyTransform(o,a=!1){const l=Ni();Oo(l,o);for(let c=0;c<this.path.length;c++){const h=this.path[c];!a&&h.options.layoutScroll&&h.scroll&&h!==h.root&&Nm(l,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),Bd(h.latestValues)&&Nm(l,h.latestValues)}return Bd(this.latestValues)&&Nm(l,this.latestValues),l}removeTransform(o){const a=Ni();Oo(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Bd(c.latestValues))continue;pL(c.latestValues)&&c.updateSnapshot();const h=Ni(),u=c.measurePageBox();Oo(h,u),NG(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,h)}return Bd(this.latestValues)&&NG(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==mr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:u,layoutId:d}=this.options;if(!(!this.layout||!(u||d))){if(this.resolvedRelativeTargetAt=mr.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ni(),this.relativeTargetOrigin=Ni(),Sy(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),Oo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Ni(),this.targetWithTransforms=Ni()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Jge(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Oo(this.target,this.layout.layoutBox),zq(this.target,this.targetDelta)):Oo(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ni(),this.relativeTargetOrigin=Ni(),Sy(this.relativeTargetOrigin,this.target,f.target),Oo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Od.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||pL(this.parent.latestValues)||kq(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===mr.timestamp&&(c=!1),c)return;const{layout:h,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||u))return;Oo(this.layoutCorrected,this.layout.layoutBox),ove(this.layoutCorrected,this.treeScale,this.path,l);const{target:d}=a;if(!d)return;this.projectionDelta||(this.projectionDelta=by(),this.projectionDeltaWithTransform=by());const f=this.treeScale.x,p=this.treeScale.y,v=this.projectionTransform;wy(this.projectionDelta,this.layoutCorrected,d,this.latestValues),this.projectionTransform=zG(this.projectionDelta,this.treeScale),(this.projectionTransform!==v||this.treeScale.x!==f||this.treeScale.y!==p)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",d)),Od.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const a=this.getStack();a&&a.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},h={...this.latestValues},u=by();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const d=Ni(),f=l?l.source:void 0,p=this.layout?this.layout.source:void 0,v=f!==p,g=this.getStack(),m=!g||g.members.length<=1,y=!!(v&&!m&&this.options.crossfade===!0&&!this.path.some(Wve));this.animationProgress=0;let _;this.mixTargetDelta=S=>{const A=S/1e3;WG(u.x,o.x,A),WG(u.y,o.y,A),this.setTargetDelta(u),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Sy(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),jve(this.relativeTarget,this.relativeTargetOrigin,d,A),_&&gL(this.relativeTarget,_)&&(this.isProjectionDirty=!1),_||(_=Ni()),Oo(_,this.relativeTarget)),v&&(this.animationValues=h,_ve(h,c,this.latestValues,A,y,m)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=A},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(ru(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ui.update(()=>{xb.hasAnimatedSinceResize=!0,this.currentAnimation=Lve(0,HG,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(HG),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:h}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&Yq(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||Ni();const u=_o(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+u;const d=_o(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+d}Oo(a,l),Nm(a,h),wy(this.projectionDeltaWithTransform,this.layoutCorrected,a,h)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Eve),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.rotate||l.rotateX||l.rotateY||l.rotateZ)&&(a=!0),!a)return;const c={};for(let h=0;h<GG.length;h++){const u="rotate"+GG[h];l[u]&&(c[u]=l[u],o.setStaticValue(u,0))}o.render();for(const h in c)o.setStaticValue(h,c[h]);o.scheduleRender()}getProjectionStyles(o={}){var a,l;const c={};if(!this.instance||this.isSVG)return c;if(this.isVisible)c.visibility="";else return{visibility:"hidden"};const h=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=yb(o.pointerEvents)||"",c.transform=h?h(this.latestValues,""):"none",c;const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){const v={};return this.options.layoutId&&(v.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,v.pointerEvents=yb(o.pointerEvents)||""),this.hasProjected&&!Bd(this.latestValues)&&(v.transform=h?h({},""):"none",this.hasProjected=!1),v}const d=u.animationValues||u.latestValues;this.applyTransformsToTarget(),c.transform=zG(this.projectionDeltaWithTransform,this.treeScale,d),h&&(c.transform=h(d,c.transform));const{x:f,y:p}=this.projectionDelta;c.transformOrigin=`${f.origin*100}% ${p.origin*100}% 0`,u.animationValues?c.opacity=u===this?(l=(a=d.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:c.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const v in dA){if(d[v]===void 0)continue;const{correct:g,applyTo:m}=dA[v],y=c.transform==="none"?d[v]:g(d[v],u);if(m){const _=m.length;for(let S=0;S<_;S++)c[m[S]]=y}else c[v]=y}return this.options.layoutId&&(c.pointerEvents=u===this?yb(o.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(VG),this.root.sharedNodes.clear()}}}function Bve(t){t.updateLayout()}function Ove(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:i,measuredBox:r}=t.layout,{animationType:s}=t.options,o=n.source!==t.layout.source;s==="size"?Cl(u=>{const d=o?n.measuredBox[u]:n.layoutBox[u],f=_o(d);d.min=i[u].min,d.max=d.min+f}):Yq(s,n.layoutBox,i)&&Cl(u=>{const d=o?n.measuredBox[u]:n.layoutBox[u],f=_o(i[u]);d.max=d.min+f,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[u].max=t.relativeTarget[u].min+f)});const a=by();wy(a,i,n.layoutBox);const l=by();o?wy(l,t.applyTransform(r,!0),n.measuredBox):wy(l,i,n.layoutBox);const c=!Wq(a);let h=!1;if(!t.resumeFrom){const u=t.getClosestProjectingParent();if(u&&!u.resumeFrom){const{snapshot:d,layout:f}=u;if(d&&f){const p=Ni();Sy(p,n.layoutBox,d.layoutBox);const v=Ni();Sy(v,i,f.layoutBox),gL(p,v)||(h=!0),u.options.layoutRoot&&(t.relativeTarget=v,t.relativeTargetOrigin=p,t.relativeParent=u)}}}t.notifyListeners("didUpdate",{layout:i,snapshot:n,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeTargetChanged:h})}else if(t.isLead()){const{onExitComplete:i}=t.options;i&&i()}t.options.transition=void 0}function Fve(t){Od.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Nve(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Uve(t){t.clearSnapshot()}function VG(t){t.clearMeasurements()}function kve(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function jG(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0}function zve(t){t.resolveTargetDelta()}function Gve(t){t.calcProjection()}function Hve(t){t.resetRotation()}function Vve(t){t.removeLeadSnapshot()}function WG(t,e,n){t.translate=li(e.translate,0,n),t.scale=li(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function XG(t,e,n,i){t.min=li(e.min,n.min,i),t.max=li(e.max,n.max,i)}function jve(t,e,n,i){XG(t.x,e.x,n.x,i),XG(t.y,e.y,n.y,i)}function Wve(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Xve={duration:.45,ease:[.4,0,.1,1]};function YG(t){t.min=Math.round(t.min),t.max=Math.round(t.max)}function Yve(t){YG(t.x),YG(t.y)}function Yq(t,e,n){return t==="position"||t==="preserve-aspect"&&!dL(kG(e),kG(n),.2)}const qve=Xq({attachResizeListener:(t,e)=>zc(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),SP={current:void 0},qq=Xq({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!SP.current){const t=new qve({});t.mount(window),t.setOptions({layoutScroll:!0}),SP.current=t}return SP.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Qve={pan:{Feature:pve},drag:{Feature:fve,ProjectionNode:qq,MeasureLayout:Hq}},Kve=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Jve(t){const e=Kve.exec(t);if(!e)return[,];const[,n,i]=e;return[n,i]}function vL(t,e,n=1){const[i,r]=Jve(t);if(!i)return;const s=window.getComputedStyle(e).getPropertyValue(i);return s?s.trim():rL(r)?vL(r,e,n+1):r}function Zve(t,{...e},n){const i=t.current;if(!(i instanceof Element))return{target:e,transitionEnd:n};n&&(n={...n}),t.values.forEach(r=>{const s=r.get();if(!rL(s))return;const o=vL(s,i);o&&r.set(o)});for(const r in e){const s=e[r];if(!rL(s))continue;const o=vL(s,i);o&&(e[r]=o,n||(n={}),n[r]===void 0&&(n[r]=s))}return{target:e,transitionEnd:n}}const $ve=new Set(["width","height","top","left","right","bottom","x","y"]),Qq=t=>$ve.has(t),e0e=t=>Object.keys(t).some(Qq),qG=t=>t===Wf||t===Ft,QG=(t,e)=>parseFloat(t.split(", ")[e]),KG=(t,e)=>(n,{transform:i})=>{if(i==="none"||!i)return 0;const r=i.match(/^matrix3d\((.+)\)$/);if(r)return QG(r[1],e);{const s=i.match(/^matrix\((.+)\)$/);return s?QG(s[1],t):0}},t0e=new Set(["x","y","z"]),n0e=x1.filter(t=>!t0e.has(t));function i0e(t){const e=[];return n0e.forEach(n=>{const i=t.getValue(n);i!==void 0&&(e.push([n,i.get()]),i.set(n.startsWith("scale")?1:0))}),e.length&&t.render(),e}const JG={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:KG(4,13),y:KG(5,14)},r0e=(t,e,n)=>{const i=e.measureViewportBox(),r=e.current,s=getComputedStyle(r),{display:o}=s,a={};o==="none"&&e.setStaticValue("display",t.display||"block"),n.forEach(c=>{a[c]=JG[c](i,s)}),e.render();const l=e.measureViewportBox();return n.forEach(c=>{const h=e.getValue(c);h&&h.jump(a[c]),t[c]=JG[c](l,s)}),t},s0e=(t,e,n={},i={})=>{e={...e},i={...i};const r=Object.keys(e).filter(Qq);let s=[],o=!1;const a=[];if(r.forEach(l=>{const c=t.getValue(l);if(!t.hasValue(l))return;let h=n[l],u=h0(h);const d=e[l];let f;if(pA(d)){const p=d.length,v=d[0]===null?1:0;h=d[v],u=h0(h);for(let g=v;g<p&&d[g]!==null;g++)f?tO(h0(d[g])===f):f=h0(d[g])}else f=h0(d);if(u!==f)if(qG(u)&&qG(f)){const p=c.get();typeof p=="string"&&c.set(parseFloat(p)),typeof d=="string"?e[l]=parseFloat(d):Array.isArray(d)&&f===Ft&&(e[l]=d.map(parseFloat))}else u!=null&&u.transform&&(f!=null&&f.transform)&&(h===0||d===0)?h===0?c.set(f.transform(h)):e[l]=u.transform(d):(o||(s=i0e(t),o=!0),a.push(l),i[l]=i[l]!==void 0?i[l]:e[l],c.jump(d))}),a.length){const l=a.indexOf("height")>=0?window.pageYOffset:null,c=r0e(e,t,a);return s.length&&s.forEach(([h,u])=>{t.getValue(h).set(u)}),t.render(),JM&&l!==null&&window.scrollTo({top:l}),{target:c,transitionEnd:i}}else return{target:e,transitionEnd:i}};function o0e(t,e,n,i){return e0e(e)?s0e(t,e,n,i):{target:e,transitionEnd:i}}const a0e=(t,e,n,i)=>{const r=Zve(t,e,i);return e=r.target,i=r.transitionEnd,o0e(t,e,n,i)},yL={current:null},Kq={current:!1};function l0e(){if(Kq.current=!0,!!JM)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>yL.current=t.matches;t.addListener(e),e()}else yL.current=!1}function c0e(t,e,n){const{willChange:i}=e;for(const r in e){const s=e[r],o=n[r];if(ks(s))t.addValue(r,s),yA(i)&&i.add(r);else if(ks(o))t.addValue(r,Fg(s,{owner:t})),yA(i)&&i.remove(r);else if(o!==s)if(t.hasValue(r)){const a=t.getValue(r);!a.hasAnimated&&a.set(s)}else{const a=t.getStaticValue(r);t.addValue(r,Fg(a!==void 0?a:s,{owner:t}))}}for(const r in n)e[r]===void 0&&t.removeValue(r);return e}const ZG=new WeakMap,Jq=Object.keys(yx),u0e=Jq.length,$G=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],h0e=XB.length;class d0e{constructor({parent:e,props:n,presenceContext:i,reducedMotionConfig:r,visualState:s},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>ui.render(this.render,!1,!0);const{latestValues:a,renderState:l}=s;this.latestValues=a,this.baseTarget={...a},this.initialValues=n.initial?{...a}:{},this.renderState=l,this.parent=e,this.props=n,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=o,this.isControllingVariants=$M(n),this.isVariantNode=OY(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:c,...h}=this.scrapeMotionValuesFromProps(n,{});for(const u in h){const d=h[u];a[u]!==void 0&&ks(d)&&(d.set(a[u],!1),yA(c)&&c.add(u))}}scrapeMotionValuesFromProps(e,n){return{}}mount(e){this.current=e,ZG.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,i)=>this.bindToMotionValue(i,n)),Kq.current||l0e(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:yL.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){ZG.delete(this.current),this.projection&&this.projection.unmount(),ru(this.notifyUpdate),ru(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,n){const i=jf.has(e),r=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&ui.update(this.notifyUpdate,!1,!0),i&&this.projection&&(this.projection.isTransformDirty=!0)}),s=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{r(),s()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...n},i,r,s){let o,a;for(let l=0;l<u0e;l++){const c=Jq[l],{isEnabled:h,Feature:u,ProjectionNode:d,MeasureLayout:f}=yx[c];d&&(o=d),h(n)&&(!this.features[c]&&u&&(this.features[c]=new u(this)),f&&(a=f))}if(!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:l,layout:c,drag:h,dragConstraints:u,layoutScroll:d,layoutRoot:f}=n;this.projection.setOptions({layoutId:l,layout:c,alwaysMeasureLayout:!!h||u&&Om(u),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof c=="string"?c:"both",initialPromotionConfig:s,layoutScroll:d,layoutRoot:f})}return a}updateFeatures(){for(const e in this.features){const n=this.features[e];n.isMounted?n.update(this.props,this.prevProps):(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ni()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}makeTargetAnimatable(e,n=!0){return this.makeTargetAnimatableFromInstance(e,this.props,n)}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let i=0;i<$G.length;i++){const r=$G[i];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s=e["on"+r];s&&(this.propEventSubscriptions[r]=this.on(r,s))}this.prevMotionValues=c0e(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const i=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(i.initial=this.props.initial),i}const n={};for(let i=0;i<h0e;i++){const r=XB[i],s=this.props[r];(vx(s)||s===!1)&&(n[r]=s)}return n}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){n!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,n)),this.values.set(e,n),this.latestValues[e]=n.get()}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return i===void 0&&n!==void 0&&(i=Fg(n,{owner:this}),this.addValue(e,i)),i}readValue(e){return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:i}=this.props,r=typeof i=="string"||typeof i=="object"?(n=eO(this.props,i))===null||n===void 0?void 0:n[e]:void 0;if(i&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!ks(s)?s:this.initialValues[e]!==void 0&&r===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new cO),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class Zq extends d0e{sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:i}){delete n[e],delete i[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:n,...i},{transformValues:r},s){let o=Ige(i,e||{},this);if(r&&(n&&(n=r(n)),i&&(i=r(i)),o&&(o=r(o))),s){Rge(this,i,o);const a=a0e(this,i,o,n);n=a.transitionEnd,i=a.target}return{transition:e,transitionEnd:n,...i}}}function f0e(t){return window.getComputedStyle(t)}class p0e extends Zq{readValueFromInstance(e,n){if(jf.has(n)){const i=sO(n);return i&&i.default||0}else{const i=f0e(e),r=(zY(n)?i.getPropertyValue(n):i[n])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:n}){return Gq(e,n)}build(e,n,i,r){qB(e,n,i,r.transformTemplate)}scrapeMotionValuesFromProps(e,n){return $B(e,n)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;ks(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}renderInstance(e,n,i,r){XY(e,n,i,r)}}class m0e extends Zq{constructor(){super(...arguments),this.isSVGTag=!1}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(jf.has(n)){const i=sO(n);return i&&i.default||0}return n=YY.has(n)?n:ZB(n),e.getAttribute(n)}measureInstanceViewportBox(){return Ni()}scrapeMotionValuesFromProps(e,n){return QY(e,n)}build(e,n,i,r){KB(e,n,i,this.isSVGTag,r.transformTemplate)}renderInstance(e,n,i,r){qY(e,n,i,r)}mount(e){this.isSVGTag=JB(e.tagName),super.mount(e)}}const g0e=(t,e)=>YB(t)?new m0e(e,{enableHardwareAcceleration:!1}):new p0e(e,{enableHardwareAcceleration:!0}),v0e={layout:{ProjectionNode:qq,MeasureLayout:Hq}},y0e={...Yge,...pme,...Qve,...v0e},Ng=wpe((t,e)=>Jpe(t,e,y0e,g0e)),$q=t=>({hidden:{y:-50,opacity:0},show:{y:0,opacity:1,transition:{type:"spring",duration:1.25,delay:t}}}),x0e=(t,e,n,i)=>({hidden:{x:t==="left"?100:t==="right"?-100:0,y:t==="up"?100:t==="down"?-100:0,opacity:0},show:{x:0,y:0,opacity:1,transition:{type:e,delay:n,duration:i,ease:"easeOut"}}}),eH=(t,e,n,i)=>({hidden:{x:t==="left"?"-100%":t==="right"?"100%":0,y:t==="up"||t==="down"?"100%":0},show:{x:0,y:0,transition:{type:e,delay:n,duration:i,ease:"easeOut"}}}),_0e=(t,e)=>({hidden:{},show:{transition:{staggerChildren:t,delayChildren:e||0}}}),uO=(t,e)=>function(){return We.jsx(Ng.section,{variants:_0e(),initial:"hidden",whileInView:"show",viewport:{once:!0,amount:.3},className:`${iu.padding} max-w-7xl mx-auto relative z-0`,children:We.jsx(t,{})})},w0e=()=>We.jsxs(We.Fragment,{children:[We.jsxs(Ng.div,{variants:$q(),children:[We.jsx("p",{className:iu.sectionSubText,children:"Introduction"}),We.jsx("h2",{className:iu.sectionHeadText,children:"Overview"})]}),We.jsx(Ng.p,{variants:x0e("","",.1,1),className:"mt-4 text-secondary text-[17px] max-w-3xl leading-[30px]",children:"As a senior Computer Engineering student at California State Polytechnic University, Pomona, I embody a hands-on approach to learning, with a strong emphasis on practical program development and hands-on experimentation with electronic components. Through actively building real-world applications and exploring the intricacies of hardware, I have cultivated my skills in creating innovative solutions and adeptly problem-solving within the dynamic field of computer engineering."})]}),eQ=uO(w0e),S0e=()=>We.jsx(We.Fragment,{children:We.jsx("div",{children:We.jsx("h1",{children:"Software: Python / C++ / C# / C / Node Js / PostgreSQL / Express / React / OpenAIPspice / Arduino / MATLAB / MPLAB / PSpice (OrCAD) / VScode / Assembly Language / yolov7 / Forever / Linux / PM2 / REST API Hardware: : PIC18 Microcontroller / Oscilloscope / Digital Multimeter / FPGA / Arduino / AC PSU / DC PSU"})})});var rE={},tQ={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var i=[],r=0;r<arguments.length;r++){var s=arguments[r];if(s){var o=typeof s;if(o==="string"||o==="number")i.push(s);else if(Array.isArray(s)){if(s.length){var a=n.apply(null,s);a&&i.push(a)}}else if(o==="object"){if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]")){i.push(s.toString());continue}for(var l in s)e.call(s,l)&&s[l]&&i.push(l)}}}return i.join(" ")}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(tQ);var nQ=tQ.exports;rE.__esModule=!0;rE.default=void 0;var b0e=hO(ge),Pu=hO(RY),A0e=hO(nQ);function hO(t){return t&&t.__esModule?t:{default:t}}const iQ=({animate:t=!0,className:e="",layout:n="2-columns",lineColor:i="#FFF",children:r})=>(typeof window=="object"&&document.documentElement.style.setProperty("--line-color",i),b0e.default.createElement("div",{className:(0,A0e.default)(e,"vertical-timeline",{"vertical-timeline--animate":t,"vertical-timeline--two-columns":n==="2-columns","vertical-timeline--one-column-left":n==="1-column"||n==="1-column-left","vertical-timeline--one-column-right":n==="1-column-right"})},r));iQ.propTypes={children:Pu.default.oneOfType([Pu.default.arrayOf(Pu.default.node),Pu.default.node]).isRequired,className:Pu.default.string,animate:Pu.default.bool,layout:Pu.default.oneOf(["1-column-left","1-column","2-columns","1-column-right"]),lineColor:Pu.default.string};var M0e=iQ;rE.default=M0e;var sE={};function xL(){return xL=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},xL.apply(this,arguments)}function E0e(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,_L(t,e)}function _L(t,e){return _L=Object.setPrototypeOf||function(i,r){return i.__proto__=r,i},_L(t,e)}function C0e(t,e){if(t==null)return{};var n={},i=Object.keys(t),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}var wL=new Map,Gw=new WeakMap,tH=0,rQ=void 0;function T0e(t){rQ=t}function P0e(t){return t?(Gw.has(t)||(tH+=1,Gw.set(t,tH.toString())),Gw.get(t)):"0"}function D0e(t){return Object.keys(t).sort().filter(function(e){return t[e]!==void 0}).map(function(e){return e+"_"+(e==="root"?P0e(t.root):t[e])}).toString()}function R0e(t){var e=D0e(t),n=wL.get(e);if(!n){var i=new Map,r,s=new IntersectionObserver(function(o){o.forEach(function(a){var l,c=a.isIntersecting&&r.some(function(h){return a.intersectionRatio>=h});t.trackVisibility&&typeof a.isVisible>"u"&&(a.isVisible=c),(l=i.get(a.target))==null||l.forEach(function(h){h(c,a)})})},t);r=s.thresholds||(Array.isArray(t.threshold)?t.threshold:[t.threshold||0]),n={id:e,observer:s,elements:i},wL.set(e,n)}return n}function dO(t,e,n,i){if(n===void 0&&(n={}),i===void 0&&(i=rQ),typeof window.IntersectionObserver>"u"&&i!==void 0){var r=t.getBoundingClientRect();return e(i,{isIntersecting:i,target:t,intersectionRatio:typeof n.threshold=="number"?n.threshold:0,time:0,boundingClientRect:r,intersectionRect:r,rootBounds:r}),function(){}}var s=R0e(n),o=s.id,a=s.observer,l=s.elements,c=l.get(t)||[];return l.has(t)||l.set(t,c),c.push(e),a.observe(t),function(){c.splice(c.indexOf(e),1),c.length===0&&(l.delete(t),a.unobserve(t)),l.size===0&&(a.disconnect(),wL.delete(o))}}var L0e=["children","as","triggerOnce","threshold","root","rootMargin","onChange","skip","trackVisibility","delay","initialInView","fallbackInView"];function nH(t){return typeof t.children!="function"}var _A=function(t){E0e(e,t);function e(i){var r;return r=t.call(this,i)||this,r.node=null,r._unobserveCb=null,r.handleNode=function(s){r.node&&(r.unobserve(),!s&&!r.props.triggerOnce&&!r.props.skip&&r.setState({inView:!!r.props.initialInView,entry:void 0})),r.node=s||null,r.observeNode()},r.handleChange=function(s,o){s&&r.props.triggerOnce&&r.unobserve(),nH(r.props)||r.setState({inView:s,entry:o}),r.props.onChange&&r.props.onChange(s,o)},r.state={inView:!!i.initialInView,entry:void 0},r}var n=e.prototype;return n.componentDidUpdate=function(r){(r.rootMargin!==this.props.rootMargin||r.root!==this.props.root||r.threshold!==this.props.threshold||r.skip!==this.props.skip||r.trackVisibility!==this.props.trackVisibility||r.delay!==this.props.delay)&&(this.unobserve(),this.observeNode())},n.componentWillUnmount=function(){this.unobserve(),this.node=null},n.observeNode=function(){if(!(!this.node||this.props.skip)){var r=this.props,s=r.threshold,o=r.root,a=r.rootMargin,l=r.trackVisibility,c=r.delay,h=r.fallbackInView;this._unobserveCb=dO(this.node,this.handleChange,{threshold:s,root:o,rootMargin:a,trackVisibility:l,delay:c},h)}},n.unobserve=function(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)},n.render=function(){if(!nH(this.props)){var r=this.state,s=r.inView,o=r.entry;return this.props.children({inView:s,entry:o,ref:this.handleNode})}var a=this.props,l=a.children,c=a.as,h=C0e(a,L0e);return ge.createElement(c||"div",xL({ref:this.handleNode},h),l)},e}(ge.Component);_A.displayName="InView";_A.defaultProps={threshold:0,triggerOnce:!1,initialInView:!1};function I0e(t){var e=t===void 0?{}:t,n=e.threshold,i=e.delay,r=e.trackVisibility,s=e.rootMargin,o=e.root,a=e.triggerOnce,l=e.skip,c=e.initialInView,h=e.fallbackInView,u=ge.useRef(),d=ge.useState({inView:!!c}),f=d[0],p=d[1],v=ge.useCallback(function(m){u.current!==void 0&&(u.current(),u.current=void 0),!l&&m&&(u.current=dO(m,function(y,_){p({inView:y,entry:_}),_.isIntersecting&&a&&u.current&&(u.current(),u.current=void 0)},{root:o,rootMargin:s,threshold:n,trackVisibility:r,delay:i},h))},[Array.isArray(n)?n.toString():n,o,s,a,l,r,h,i]);ge.useEffect(function(){!u.current&&f.entry&&!a&&!l&&p({inView:!!c})});var g=[v,f.inView,f.entry];return g.ref=g[0],g.inView=g[1],g.entry=g[2],g}const B0e=Object.freeze(Object.defineProperty({__proto__:null,InView:_A,default:_A,defaultFallbackInView:T0e,observe:dO,useInView:I0e},Symbol.toStringTag,{value:"Module"})),O0e=Pee(B0e);sE.__esModule=!0;sE.default=void 0;var Du=fO(ge),Zn=fO(RY),Hw=fO(nQ),F0e=O0e;function fO(t){return t&&t.__esModule?t:{default:t}}const sQ=({children:t="",className:e="",contentArrowStyle:n=null,contentStyle:i=null,date:r="",dateClassName:s="",icon:o=null,iconClassName:a="",iconOnClick:l=null,onTimelineElementClick:c=null,iconStyle:h=null,id:u="",position:d="",style:f=null,textClassName:p="",intersectionObserverProps:v={rootMargin:"0px 0px -40px 0px",triggerOnce:!0},visible:g=!1})=>Du.default.createElement(F0e.InView,v,({inView:m,ref:y})=>Du.default.createElement("div",{ref:y,id:u,className:(0,Hw.default)(e,"vertical-timeline-element",{"vertical-timeline-element--left":d==="left","vertical-timeline-element--right":d==="right","vertical-timeline-element--no-children":t===""}),style:f},Du.default.createElement(Du.default.Fragment,null,Du.default.createElement("span",{style:h,onClick:l,className:(0,Hw.default)(a,"vertical-timeline-element-icon",{"bounce-in":m||g,"is-hidden":!(m||g)})},o),Du.default.createElement("div",{style:i,onClick:c,className:(0,Hw.default)(p,"vertical-timeline-element-content",{"bounce-in":m||g,"is-hidden":!(m||g)})},Du.default.createElement("div",{style:n,className:"vertical-timeline-element-content-arrow"}),t,Du.default.createElement("span",{className:(0,Hw.default)(s,"vertical-timeline-element-date")},r)))));sQ.propTypes={children:Zn.default.oneOfType([Zn.default.arrayOf(Zn.default.node),Zn.default.node]),className:Zn.default.string,contentArrowStyle:Zn.default.shape({}),contentStyle:Zn.default.shape({}),date:Zn.default.node,dateClassName:Zn.default.string,icon:Zn.default.element,iconClassName:Zn.default.string,iconStyle:Zn.default.shape({}),iconOnClick:Zn.default.func,onTimelineElementClick:Zn.default.func,id:Zn.default.string,position:Zn.default.string,style:Zn.default.shape({}),textClassName:Zn.default.string,visible:Zn.default.bool,intersectionObserverProps:Zn.default.shape({root:Zn.default.object,rootMargin:Zn.default.string,threshold:Zn.default.number,triggerOnce:Zn.default.bool})};var N0e=sQ;sE.default=N0e;var oQ={VerticalTimeline:rE.default,VerticalTimelineElement:sE.default};const U0e=({projects:t})=>We.jsxs(oQ.VerticalTimelineElement,{contentStyle:{background:t.textBgColor,color:"#fff"},contentArrowStyle:{borderRight:"7px solid #FEFEFE"},date:t.date,iconStyle:{background:t.iconBg},children:[We.jsxs("div",{children:[We.jsx("h3",{className:"text-white text-[24px] font-bold",children:t.title}),We.jsx("p",{className:"text-secondary text-[24px] font-semibold",style:{margin:0},children:t.tech})]}),We.jsx("ul",{className:"mt-5 list-disc ml-5 space-y-2",children:t.points.map((e,n)=>We.jsx("li",{className:"text-white-100 text-[14px] pl-1 tracking-wider",children:e},`projects-points-${n}`))})]}),k0e=()=>We.jsxs(We.Fragment,{children:[We.jsx(Ng.div,{variants:$q(),children:We.jsx("h2",{className:iu.sectionHeadText,children:"Projects"})}),We.jsx("div",{className:"mt-20 flex flex-col",children:We.jsx(oQ.VerticalTimeline,{children:upe.map((t,e)=>We.jsx(U0e,{projects:t},e))})})]}),z0e=uO(k0e),wx={_origin:"https://api.emailjs.com"},G0e=(t,e="https://api.emailjs.com")=>{wx._userID=t,wx._origin=e},aQ=(t,e,n)=>{if(!t)throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!e)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!n)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0};class iH{constructor(e){this.status=e?e.status:0,this.text=e?e.responseText:"Network Error"}}const lQ=(t,e,n={})=>new Promise((i,r)=>{const s=new XMLHttpRequest;s.addEventListener("load",({target:o})=>{const a=new iH(o);a.status===200||a.text==="OK"?i(a):r(a)}),s.addEventListener("error",({target:o})=>{r(new iH(o))}),s.open("POST",wx._origin+t,!0),Object.keys(n).forEach(o=>{s.setRequestHeader(o,n[o])}),s.send(e)}),H0e=(t,e,n,i)=>{const r=i||wx._userID;return aQ(r,t,e),lQ("/api/v1.0/email/send",JSON.stringify({lib_version:"3.11.0",user_id:r,service_id:t,template_id:e,template_params:n}),{"Content-type":"application/json"})},V0e=t=>{let e;if(typeof t=="string"?e=document.querySelector(t):e=t,!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of form";return e},j0e=(t,e,n,i)=>{const r=i||wx._userID,s=V0e(n);aQ(r,t,e);const o=new FormData(s);return o.append("lib_version","3.11.0"),o.append("service_id",t),o.append("template_id",e),o.append("user_id",r),lQ("/api/v1.0/email/send-form",o)},W0e={init:G0e,send:H0e,sendForm:j0e},X0e=()=>{const t=ge.useRef(),[e,n]=ge.useState({name:"",email:"",message:""}),[i,r]=ge.useState(!1),s=a=>{const{name:l,value:c}=a.target;n({...e,[l]:c})},o=a=>{a.preventDefault(),r(!0),W0e.send("service_osuqsmg","template_1pppkh4",{from_name:e.name,to_name:"Steven",from_email:e.email,to_email:"tubbymop@gmail.com",message:e.message},"gwlyMV424JnVX_Bky").then(()=>{r(!1),alert("Thank You. I will get back to you as soon as possible."),n({name:"",email:"",message:""})},l=>{r(!1),console.log(l),alert("Something went wrong.")})};return We.jsxs("div",{className:"xl:mt-12 xl:flex-row flex-col-reverse flex gap-10 overflow-hidden",children:[We.jsxs(Ng.div,{variants:eH("left","tween",.2,1),className:"flex-[0.75] bg-black-100 p-8 rounded-2xl",children:[We.jsx("p",{className:iu.sectionS,children:"Get in Touch"}),We.jsx("h3",{className:iu.sectionHeadText,children:"Contact."}),We.jsxs("form",{ref:t,onSubmit:o,className:"mt-12 flex flex-col gap-8",children:[We.jsxs("label",{className:"flex flex-col",children:[We.jsx("span",{className:"text-white font-medium mb-4",children:" Your Name "}),We.jsx("input",{type:"text",name:"name",value:e.name,onChange:s,placeholder:"Your Name",className:"bg-tertiary py-4 px-6 placeholder:text-secondary text-white rounded-1g outlined-none border-none font-medium"})]}),We.jsxs("label",{className:"flex flex-col",children:[We.jsx("span",{className:"text-white font-medium mb-4",children:" Your Email "}),We.jsx("input",{type:"email",name:"email",value:e.email,onChange:s,placeholder:"Your Email",className:"bg-tertiary py-4 px-6 placeholder:text-secondary text-white rounded-1g outlined-none border-none font-medium"})]}),We.jsxs("label",{className:"flex flex-col",children:[We.jsx("span",{className:"text-white font-medium mb-4",children:" Your Message "}),We.jsx("textarea",{name:"message",value:e.message,onChange:s,placeholder:"Your Message",className:"bg-tertiary py-4 px-6 placeholder:text-secondary text-white rounded-1g outlined-none border-none font-medium"})]}),We.jsx("button",{type:"submit",className:"bg-tertiary py-3 px-8 outline-none w-fit text-white font-bold shadow-md shadow-primary primary-xl",children:i?"Sending...":"Send"})]})]}),We.jsx(Ng.div,{variants:eH("right","tween",.2,1),className:"xl:flex-1 xl:h-auto md:h-[550px] h-[350px]",children:We.jsx(tpe,{})})]})},cQ=uO(X0e),Y0e="modulepreload",q0e=function(t){return"/"+t},rH={},oE=function(e,n,i){if(!n||n.length===0)return e();const r=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=q0e(s),s in rH)return;rH[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!i)for(let h=r.length-1;h>=0;h--){const u=r[h];if(u.href===s&&(!o||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":Y0e,o||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),o)return new Promise((h,u)=>{c.addEventListener("load",h),c.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e())};var Q0e=Object.create,pO=Object.defineProperty,K0e=Object.getOwnPropertyDescriptor,J0e=Object.getOwnPropertyNames,Z0e=Object.getPrototypeOf,$0e=Object.prototype.hasOwnProperty,aE=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),eye=(t,e)=>{for(var n in e)pO(t,n,{get:e[n],enumerable:!0})},tye=(t,e,n,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of J0e(e))!$0e.call(t,r)&&r!==n&&pO(t,r,{get:()=>e[r],enumerable:!(i=K0e(e,r))||i.enumerable});return t},b1=(t,e,n)=>(n=t!=null?Q0e(Z0e(t)):{},tye(e||!t||!t.__esModule?pO(n,"default",{value:t,enumerable:!0}):n,t)),nye=aE((t,e)=>{(function(n,i){typeof t=="object"?e.exports=i():typeof define=="function"&&define.amd?define(i):n.Alea=i()})(t,function(){return n.importState=function(r){var s=new n;return s.importState(r),s},n;function n(){return function(r){var s=0,o=0,a=0,l=1;r.length==0&&(r=[+new Date]);var c=i();s=c(" "),o=c(" "),a=c(" ");for(var h=0;h<r.length;h++)s-=c(r[h]),s<0&&(s+=1),o-=c(r[h]),o<0&&(o+=1),a-=c(r[h]),a<0&&(a+=1);c=null;var u=function(){var d=2091639*s+l*23283064365386963e-26;return s=o,o=a,a=d-(l=d|0)};return u.next=u,u.uint32=function(){return u()*4294967296},u.fract53=function(){return u()+(u()*2097152|0)*11102230246251565e-32},u.version="Alea 0.9",u.args=r,u.exportState=function(){return[s,o,a,l]},u.importState=function(d){s=+d[0]||0,o=+d[1]||0,a=+d[2]||0,l=+d[3]||0},u}(Array.prototype.slice.call(arguments))}function i(){var r=4022871197,s=function(o){o=o.toString();for(var a=0;a<o.length;a++){r+=o.charCodeAt(a);var l=.02519603282416938*r;r=l>>>0,l-=r,l*=r,r=l>>>0,l-=r,r+=l*4294967296}return(r>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})}),uQ=aE((t,e)=>{(function(n,i){typeof t=="object"&&typeof e<"u"?i(t):typeof define=="function"&&define.amd?define(["exports"],i):i((n=typeof globalThis<"u"?globalThis:n||self).SVDJS={})})(t,function(n){n.SVD=function(i,r,s,o,a){if(r=r===void 0||r,s=s===void 0||s,a=1e-64/(o=o||Math.pow(2,-52)),!i)throw new TypeError("Matrix a is not defined");var l,c,h,u,d,f,p,v,g,m,y,_,S=i[0].length,A=i.length;if(A<S)throw new TypeError("Invalid matrix: m < n");for(var b=[],T=[],M=[],E=r==="f"?A:S,P=m=p=0;P<A;P++)T[P]=new Array(E).fill(0);for(P=0;P<S;P++)M[P]=new Array(S).fill(0);var R,F=new Array(S).fill(0);for(P=0;P<A;P++)for(l=0;l<S;l++)T[P][l]=i[P][l];for(P=0;P<S;P++){for(b[P]=p,g=0,h=P+1,l=P;l<A;l++)g+=Math.pow(T[l][P],2);if(g<a)p=0;else for(v=(f=T[P][P])*(p=f<0?Math.sqrt(g):-Math.sqrt(g))-g,T[P][P]=f-p,l=h;l<S;l++){for(g=0,c=P;c<A;c++)g+=T[c][P]*T[c][l];for(f=g/v,c=P;c<A;c++)T[c][l]=T[c][l]+f*T[c][P]}for(F[P]=p,g=0,l=h;l<S;l++)g+=Math.pow(T[P][l],2);if(g<a)p=0;else{for(v=(f=T[P][P+1])*(p=f<0?Math.sqrt(g):-Math.sqrt(g))-g,T[P][P+1]=f-p,l=h;l<S;l++)b[l]=T[P][l]/v;for(l=h;l<A;l++){for(g=0,c=h;c<S;c++)g+=T[l][c]*T[P][c];for(c=h;c<S;c++)T[l][c]=T[l][c]+g*b[c]}}m<(y=Math.abs(F[P])+Math.abs(b[P]))&&(m=y)}if(s)for(P=S-1;0<=P;P--){if(p!==0){for(v=T[P][P+1]*p,l=h;l<S;l++)M[l][P]=T[P][l]/v;for(l=h;l<S;l++){for(g=0,c=h;c<S;c++)g+=T[P][c]*M[c][l];for(c=h;c<S;c++)M[c][l]=M[c][l]+g*M[c][P]}}for(l=h;l<S;l++)M[P][l]=0,M[l][P]=0;M[P][P]=1,p=b[P],h=P}if(r){if(r==="f")for(P=S;P<A;P++){for(l=S;l<A;l++)T[P][l]=0;T[P][P]=1}for(P=S-1;0<=P;P--){for(h=P+1,p=F[P],l=h;l<E;l++)T[P][l]=0;if(p!==0){for(v=T[P][P]*p,l=h;l<E;l++){for(g=0,c=h;c<A;c++)g+=T[c][P]*T[c][l];for(f=g/v,c=P;c<A;c++)T[c][l]=T[c][l]+f*T[c][P]}for(l=P;l<A;l++)T[l][P]=T[l][P]/p}else for(l=P;l<A;l++)T[l][P]=0;T[P][P]=T[P][P]+1}}for(o*=m,c=S-1;0<=c;c--)for(var B=0;B<50;B++){for(R=!1,h=c;0<=h;h--){if(Math.abs(b[h])<=o){R=!0;break}if(Math.abs(F[h-1])<=o)break}if(!R){for(d=0,u=h-(g=1),P=h;P<c+1&&(f=g*b[P],b[P]=d*b[P],!(Math.abs(f)<=o));P++)if(p=F[P],F[P]=Math.sqrt(f*f+p*p),d=p/(v=F[P]),g=-f/v,r)for(l=0;l<A;l++)y=T[l][u],_=T[l][P],T[l][u]=y*d+_*g,T[l][P]=-y*g+_*d}if(_=F[c],h===c){if(_<0&&(F[c]=-_,s))for(l=0;l<S;l++)M[l][c]=-M[l][c];break}for(m=F[h],f=(((y=F[c-1])-_)*(y+_)+((p=b[c-1])-(v=b[c]))*(p+v))/(2*v*y),p=Math.sqrt(f*f+1),f=((m-_)*(m+_)+v*(y/(f<0?f-p:f+p)-v))/m,P=h+(g=d=1);P<c+1;P++){if(p=b[P],y=F[P],v=g*p,p*=d,_=Math.sqrt(f*f+v*v),f=m*(d=f/(b[P-1]=_))+p*(g=v/_),p=-m*g+p*d,v=y*g,y*=d,s)for(l=0;l<S;l++)m=M[l][P-1],_=M[l][P],M[l][P-1]=m*d+_*g,M[l][P]=-m*g+_*d;if(_=Math.sqrt(f*f+v*v),f=(d=f/(F[P-1]=_))*p+(g=v/_)*y,m=-g*p+d*y,r)for(l=0;l<A;l++)y=T[l][P-1],_=T[l][P],T[l][P-1]=y*d+_*g,T[l][P]=-y*g+_*d}b[h]=0,b[c]=f,F[c]=m}for(P=0;P<S;P++)F[P]<o&&(F[P]=0);return{u:T,q:F,v:M}},n.VERSION="1.1.1",Object.defineProperty(n,"__esModule",{value:!0})})}),iye=aE(t=>{(function(){var e=function(){this.init()};e.prototype={init:function(){var u=this||n;return u._counter=1e3,u._html5AudioPool=[],u.html5PoolSize=10,u._codecs={},u._howls=[],u._muted=!1,u._volume=1,u._canPlayEvent="canplaythrough",u._navigator=typeof window<"u"&&window.navigator?window.navigator:null,u.masterGain=null,u.noAudio=!1,u.usingWebAudio=!0,u.autoSuspend=!0,u.ctx=null,u.autoUnlock=!0,u._setup(),u},volume:function(u){var d=this||n;if(u=parseFloat(u),d.ctx||h(),typeof u<"u"&&u>=0&&u<=1){if(d._volume=u,d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(u,n.ctx.currentTime);for(var f=0;f<d._howls.length;f++)if(!d._howls[f]._webAudio)for(var p=d._howls[f]._getSoundIds(),v=0;v<p.length;v++){var g=d._howls[f]._soundById(p[v]);g&&g._node&&(g._node.volume=g._volume*u)}return d}return d._volume},mute:function(u){var d=this||n;d.ctx||h(),d._muted=u,d.usingWebAudio&&d.masterGain.gain.setValueAtTime(u?0:d._volume,n.ctx.currentTime);for(var f=0;f<d._howls.length;f++)if(!d._howls[f]._webAudio)for(var p=d._howls[f]._getSoundIds(),v=0;v<p.length;v++){var g=d._howls[f]._soundById(p[v]);g&&g._node&&(g._node.muted=u?!0:g._muted)}return d},stop:function(){for(var u=this||n,d=0;d<u._howls.length;d++)u._howls[d].stop();return u},unload:function(){for(var u=this||n,d=u._howls.length-1;d>=0;d--)u._howls[d].unload();return u.usingWebAudio&&u.ctx&&typeof u.ctx.close<"u"&&(u.ctx.close(),u.ctx=null,h()),u},codecs:function(u){return(this||n)._codecs[u.replace(/^x-/,"")]},_setup:function(){var u=this||n;if(u.state=u.ctx&&u.ctx.state||"suspended",u._autoSuspend(),!u.usingWebAudio)if(typeof Audio<"u")try{var d=new Audio;typeof d.oncanplaythrough>"u"&&(u._canPlayEvent="canplay")}catch{u.noAudio=!0}else u.noAudio=!0;try{var d=new Audio;d.muted&&(u.noAudio=!0)}catch{}return u.noAudio||u._setupCodecs(),u},_setupCodecs:function(){var u=this||n,d=null;try{d=typeof Audio<"u"?new Audio:null}catch{return u}if(!d||typeof d.canPlayType!="function")return u;var f=d.canPlayType("audio/mpeg;").replace(/^no$/,""),p=u._navigator?u._navigator.userAgent:"",v=p.match(/OPR\/([0-6].)/g),g=v&&parseInt(v[0].split("/")[1],10)<33,m=p.indexOf("Safari")!==-1&&p.indexOf("Chrome")===-1,y=p.match(/Version\/(.*?) /),_=m&&y&&parseInt(y[1],10)<15;return u._codecs={mp3:!!(!g&&(f||d.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!f,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(d.canPlayType('audio/wav; codecs="1"')||d.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(d.canPlayType("audio/x-m4b;")||d.canPlayType("audio/m4b;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!_&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!_&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")},u},_unlockAudio:function(){var u=this||n;if(!(u._audioUnlocked||!u.ctx)){u._audioUnlocked=!1,u.autoUnlock=!1,!u._mobileUnloaded&&u.ctx.sampleRate!==44100&&(u._mobileUnloaded=!0,u.unload()),u._scratchBuffer=u.ctx.createBuffer(1,1,22050);var d=function(f){for(;u._html5AudioPool.length<u.html5PoolSize;)try{var p=new Audio;p._unlocked=!0,u._releaseHtml5Audio(p)}catch{u.noAudio=!0;break}for(var v=0;v<u._howls.length;v++)if(!u._howls[v]._webAudio)for(var g=u._howls[v]._getSoundIds(),m=0;m<g.length;m++){var y=u._howls[v]._soundById(g[m]);y&&y._node&&!y._node._unlocked&&(y._node._unlocked=!0,y._node.load())}u._autoResume();var _=u.ctx.createBufferSource();_.buffer=u._scratchBuffer,_.connect(u.ctx.destination),typeof _.start>"u"?_.noteOn(0):_.start(0),typeof u.ctx.resume=="function"&&u.ctx.resume(),_.onended=function(){_.disconnect(0),u._audioUnlocked=!0,document.removeEventListener("touchstart",d,!0),document.removeEventListener("touchend",d,!0),document.removeEventListener("click",d,!0),document.removeEventListener("keydown",d,!0);for(var S=0;S<u._howls.length;S++)u._howls[S]._emit("unlock")}};return document.addEventListener("touchstart",d,!0),document.addEventListener("touchend",d,!0),document.addEventListener("click",d,!0),document.addEventListener("keydown",d,!0),u}},_obtainHtml5Audio:function(){var u=this||n;if(u._html5AudioPool.length)return u._html5AudioPool.pop();var d=new Audio().play();return d&&typeof Promise<"u"&&(d instanceof Promise||typeof d.then=="function")&&d.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(u){var d=this||n;return u._unlocked&&d._html5AudioPool.push(u),d},_autoSuspend:function(){var u=this;if(!(!u.autoSuspend||!u.ctx||typeof u.ctx.suspend>"u"||!n.usingWebAudio)){for(var d=0;d<u._howls.length;d++)if(u._howls[d]._webAudio){for(var f=0;f<u._howls[d]._sounds.length;f++)if(!u._howls[d]._sounds[f]._paused)return u}return u._suspendTimer&&clearTimeout(u._suspendTimer),u._suspendTimer=setTimeout(function(){if(u.autoSuspend){u._suspendTimer=null,u.state="suspending";var p=function(){u.state="suspended",u._resumeAfterSuspend&&(delete u._resumeAfterSuspend,u._autoResume())};u.ctx.suspend().then(p,p)}},3e4),u}},_autoResume:function(){var u=this;if(!(!u.ctx||typeof u.ctx.resume>"u"||!n.usingWebAudio))return u.state==="running"&&u.ctx.state!=="interrupted"&&u._suspendTimer?(clearTimeout(u._suspendTimer),u._suspendTimer=null):u.state==="suspended"||u.state==="running"&&u.ctx.state==="interrupted"?(u.ctx.resume().then(function(){u.state="running";for(var d=0;d<u._howls.length;d++)u._howls[d]._emit("resume")}),u._suspendTimer&&(clearTimeout(u._suspendTimer),u._suspendTimer=null)):u.state==="suspending"&&(u._resumeAfterSuspend=!0),u}};var n=new e,i=function(u){var d=this;if(!u.src||u.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}d.init(u)};i.prototype={init:function(u){var d=this;return n.ctx||h(),d._autoplay=u.autoplay||!1,d._format=typeof u.format!="string"?u.format:[u.format],d._html5=u.html5||!1,d._muted=u.mute||!1,d._loop=u.loop||!1,d._pool=u.pool||5,d._preload=typeof u.preload=="boolean"||u.preload==="metadata"?u.preload:!0,d._rate=u.rate||1,d._sprite=u.sprite||{},d._src=typeof u.src!="string"?u.src:[u.src],d._volume=u.volume!==void 0?u.volume:1,d._xhr={method:u.xhr&&u.xhr.method?u.xhr.method:"GET",headers:u.xhr&&u.xhr.headers?u.xhr.headers:null,withCredentials:u.xhr&&u.xhr.withCredentials?u.xhr.withCredentials:!1},d._duration=0,d._state="unloaded",d._sounds=[],d._endTimers={},d._queue=[],d._playLock=!1,d._onend=u.onend?[{fn:u.onend}]:[],d._onfade=u.onfade?[{fn:u.onfade}]:[],d._onload=u.onload?[{fn:u.onload}]:[],d._onloaderror=u.onloaderror?[{fn:u.onloaderror}]:[],d._onplayerror=u.onplayerror?[{fn:u.onplayerror}]:[],d._onpause=u.onpause?[{fn:u.onpause}]:[],d._onplay=u.onplay?[{fn:u.onplay}]:[],d._onstop=u.onstop?[{fn:u.onstop}]:[],d._onmute=u.onmute?[{fn:u.onmute}]:[],d._onvolume=u.onvolume?[{fn:u.onvolume}]:[],d._onrate=u.onrate?[{fn:u.onrate}]:[],d._onseek=u.onseek?[{fn:u.onseek}]:[],d._onunlock=u.onunlock?[{fn:u.onunlock}]:[],d._onresume=[],d._webAudio=n.usingWebAudio&&!d._html5,typeof n.ctx<"u"&&n.ctx&&n.autoUnlock&&n._unlockAudio(),n._howls.push(d),d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}}),d._preload&&d._preload!=="none"&&d.load(),d},load:function(){var u=this,d=null;if(n.noAudio){u._emit("loaderror",null,"No audio support.");return}typeof u._src=="string"&&(u._src=[u._src]);for(var f=0;f<u._src.length;f++){var p,v;if(u._format&&u._format[f])p=u._format[f];else{if(v=u._src[f],typeof v!="string"){u._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}p=/^data:audio\/([^;,]+);/i.exec(v),p||(p=/\.([^.]+)$/.exec(v.split("?",1)[0])),p&&(p=p[1].toLowerCase())}if(p||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),p&&n.codecs(p)){d=u._src[f];break}}if(!d){u._emit("loaderror",null,"No codec support for selected audio sources.");return}return u._src=d,u._state="loading",window.location.protocol==="https:"&&d.slice(0,5)==="http:"&&(u._html5=!0,u._webAudio=!1),new r(u),u._webAudio&&o(u),u},play:function(u,d){var f=this,p=null;if(typeof u=="number")p=u,u=null;else{if(typeof u=="string"&&f._state==="loaded"&&!f._sprite[u])return null;if(typeof u>"u"&&(u="__default",!f._playLock)){for(var v=0,g=0;g<f._sounds.length;g++)f._sounds[g]._paused&&!f._sounds[g]._ended&&(v++,p=f._sounds[g]._id);v===1?u=null:p=null}}var m=p?f._soundById(p):f._inactiveSound();if(!m)return null;if(p&&!u&&(u=m._sprite||"__default"),f._state!=="loaded"){m._sprite=u,m._ended=!1;var y=m._id;return f._queue.push({event:"play",action:function(){f.play(y)}}),y}if(p&&!m._paused)return d||f._loadQueue("play"),m._id;f._webAudio&&n._autoResume();var _=Math.max(0,m._seek>0?m._seek:f._sprite[u][0]/1e3),S=Math.max(0,(f._sprite[u][0]+f._sprite[u][1])/1e3-_),A=S*1e3/Math.abs(m._rate),b=f._sprite[u][0]/1e3,T=(f._sprite[u][0]+f._sprite[u][1])/1e3;m._sprite=u,m._ended=!1;var M=function(){m._paused=!1,m._seek=_,m._start=b,m._stop=T,m._loop=!!(m._loop||f._sprite[u][2])};if(_>=T){f._ended(m);return}var E=m._node;if(f._webAudio){var P=function(){f._playLock=!1,M(),f._refreshBuffer(m);var k=m._muted||f._muted?0:m._volume;E.gain.setValueAtTime(k,n.ctx.currentTime),m._playStart=n.ctx.currentTime,typeof E.bufferSource.start>"u"?m._loop?E.bufferSource.noteGrainOn(0,_,86400):E.bufferSource.noteGrainOn(0,_,S):m._loop?E.bufferSource.start(0,_,86400):E.bufferSource.start(0,_,S),A!==1/0&&(f._endTimers[m._id]=setTimeout(f._ended.bind(f,m),A)),d||setTimeout(function(){f._emit("play",m._id),f._loadQueue()},0)};n.state==="running"&&n.ctx.state!=="interrupted"?P():(f._playLock=!0,f.once("resume",P),f._clearTimer(m._id))}else{var R=function(){E.currentTime=_,E.muted=m._muted||f._muted||n._muted||E.muted,E.volume=m._volume*n.volume(),E.playbackRate=m._rate;try{var k=E.play();if(k&&typeof Promise<"u"&&(k instanceof Promise||typeof k.then=="function")?(f._playLock=!0,M(),k.then(function(){f._playLock=!1,E._unlocked=!0,d?f._loadQueue():f._emit("play",m._id)}).catch(function(){f._playLock=!1,f._emit("playerror",m._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),m._ended=!0,m._paused=!0})):d||(f._playLock=!1,M(),f._emit("play",m._id)),E.playbackRate=m._rate,E.paused){f._emit("playerror",m._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}u!=="__default"||m._loop?f._endTimers[m._id]=setTimeout(f._ended.bind(f,m),A):(f._endTimers[m._id]=function(){f._ended(m),E.removeEventListener("ended",f._endTimers[m._id],!1)},E.addEventListener("ended",f._endTimers[m._id],!1))}catch(j){f._emit("playerror",m._id,j)}};E.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(E.src=f._src,E.load());var F=window&&window.ejecta||!E.readyState&&n._navigator.isCocoonJS;if(E.readyState>=3||F)R();else{f._playLock=!0,f._state="loading";var B=function(){f._state="loaded",R(),E.removeEventListener(n._canPlayEvent,B,!1)};E.addEventListener(n._canPlayEvent,B,!1),f._clearTimer(m._id)}}return m._id},pause:function(u){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"pause",action:function(){d.pause(u)}}),d;for(var f=d._getSoundIds(u),p=0;p<f.length;p++){d._clearTimer(f[p]);var v=d._soundById(f[p]);if(v&&!v._paused&&(v._seek=d.seek(f[p]),v._rateSeek=0,v._paused=!0,d._stopFade(f[p]),v._node))if(d._webAudio){if(!v._node.bufferSource)continue;typeof v._node.bufferSource.stop>"u"?v._node.bufferSource.noteOff(0):v._node.bufferSource.stop(0),d._cleanBuffer(v._node)}else(!isNaN(v._node.duration)||v._node.duration===1/0)&&v._node.pause();arguments[1]||d._emit("pause",v?v._id:null)}return d},stop:function(u,d){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"stop",action:function(){f.stop(u)}}),f;for(var p=f._getSoundIds(u),v=0;v<p.length;v++){f._clearTimer(p[v]);var g=f._soundById(p[v]);g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,f._stopFade(p[v]),g._node&&(f._webAudio?g._node.bufferSource&&(typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),f._cleanBuffer(g._node)):(!isNaN(g._node.duration)||g._node.duration===1/0)&&(g._node.currentTime=g._start||0,g._node.pause(),g._node.duration===1/0&&f._clearSound(g._node))),d||f._emit("stop",g._id))}return f},mute:function(u,d){var f=this;if(f._state!=="loaded"||f._playLock)return f._queue.push({event:"mute",action:function(){f.mute(u,d)}}),f;if(typeof d>"u")if(typeof u=="boolean")f._muted=u;else return f._muted;for(var p=f._getSoundIds(d),v=0;v<p.length;v++){var g=f._soundById(p[v]);g&&(g._muted=u,g._interval&&f._stopFade(g._id),f._webAudio&&g._node?g._node.gain.setValueAtTime(u?0:g._volume,n.ctx.currentTime):g._node&&(g._node.muted=n._muted?!0:u),f._emit("mute",g._id))}return f},volume:function(){var u=this,d=arguments,f,p;if(d.length===0)return u._volume;if(d.length===1||d.length===2&&typeof d[1]>"u"){var v=u._getSoundIds(),g=v.indexOf(d[0]);g>=0?p=parseInt(d[0],10):f=parseFloat(d[0])}else d.length>=2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));var m;if(typeof f<"u"&&f>=0&&f<=1){if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"volume",action:function(){u.volume.apply(u,d)}}),u;typeof p>"u"&&(u._volume=f),p=u._getSoundIds(p);for(var y=0;y<p.length;y++)m=u._soundById(p[y]),m&&(m._volume=f,d[2]||u._stopFade(p[y]),u._webAudio&&m._node&&!m._muted?m._node.gain.setValueAtTime(f,n.ctx.currentTime):m._node&&!m._muted&&(m._node.volume=f*n.volume()),u._emit("volume",m._id))}else return m=p?u._soundById(p):u._sounds[0],m?m._volume:0;return u},fade:function(u,d,f,p){var v=this;if(v._state!=="loaded"||v._playLock)return v._queue.push({event:"fade",action:function(){v.fade(u,d,f,p)}}),v;u=Math.min(Math.max(0,parseFloat(u)),1),d=Math.min(Math.max(0,parseFloat(d)),1),f=parseFloat(f),v.volume(u,p);for(var g=v._getSoundIds(p),m=0;m<g.length;m++){var y=v._soundById(g[m]);if(y){if(p||v._stopFade(g[m]),v._webAudio&&!y._muted){var _=n.ctx.currentTime,S=_+f/1e3;y._volume=u,y._node.gain.setValueAtTime(u,_),y._node.gain.linearRampToValueAtTime(d,S)}v._startFadeInterval(y,u,d,f,g[m],typeof p>"u")}}return v},_startFadeInterval:function(u,d,f,p,v,g){var m=this,y=d,_=f-d,S=Math.abs(_/.01),A=Math.max(4,S>0?p/S:p),b=Date.now();u._fadeTo=f,u._interval=setInterval(function(){var T=(Date.now()-b)/p;b=Date.now(),y+=_*T,y=Math.round(y*100)/100,_<0?y=Math.max(f,y):y=Math.min(f,y),m._webAudio?u._volume=y:m.volume(y,u._id,!0),g&&(m._volume=y),(f<d&&y<=f||f>d&&y>=f)&&(clearInterval(u._interval),u._interval=null,u._fadeTo=null,m.volume(f,u._id),m._emit("fade",u._id))},A)},_stopFade:function(u){var d=this,f=d._soundById(u);return f&&f._interval&&(d._webAudio&&f._node.gain.cancelScheduledValues(n.ctx.currentTime),clearInterval(f._interval),f._interval=null,d.volume(f._fadeTo,u),f._fadeTo=null,d._emit("fade",u)),d},loop:function(){var u=this,d=arguments,f,p,v;if(d.length===0)return u._loop;if(d.length===1)if(typeof d[0]=="boolean")f=d[0],u._loop=f;else return v=u._soundById(parseInt(d[0],10)),v?v._loop:!1;else d.length===2&&(f=d[0],p=parseInt(d[1],10));for(var g=u._getSoundIds(p),m=0;m<g.length;m++)v=u._soundById(g[m]),v&&(v._loop=f,u._webAudio&&v._node&&v._node.bufferSource&&(v._node.bufferSource.loop=f,f&&(v._node.bufferSource.loopStart=v._start||0,v._node.bufferSource.loopEnd=v._stop,u.playing(g[m])&&(u.pause(g[m],!0),u.play(g[m],!0)))));return u},rate:function(){var u=this,d=arguments,f,p;if(d.length===0)p=u._sounds[0]._id;else if(d.length===1){var v=u._getSoundIds(),g=v.indexOf(d[0]);g>=0?p=parseInt(d[0],10):f=parseFloat(d[0])}else d.length===2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));var m;if(typeof f=="number"){if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"rate",action:function(){u.rate.apply(u,d)}}),u;typeof p>"u"&&(u._rate=f),p=u._getSoundIds(p);for(var y=0;y<p.length;y++)if(m=u._soundById(p[y]),m){u.playing(p[y])&&(m._rateSeek=u.seek(p[y]),m._playStart=u._webAudio?n.ctx.currentTime:m._playStart),m._rate=f,u._webAudio&&m._node&&m._node.bufferSource?m._node.bufferSource.playbackRate.setValueAtTime(f,n.ctx.currentTime):m._node&&(m._node.playbackRate=f);var _=u.seek(p[y]),S=(u._sprite[m._sprite][0]+u._sprite[m._sprite][1])/1e3-_,A=S*1e3/Math.abs(m._rate);(u._endTimers[p[y]]||!m._paused)&&(u._clearTimer(p[y]),u._endTimers[p[y]]=setTimeout(u._ended.bind(u,m),A)),u._emit("rate",m._id)}}else return m=u._soundById(p),m?m._rate:u._rate;return u},seek:function(){var u=this,d=arguments,f,p;if(d.length===0)u._sounds.length&&(p=u._sounds[0]._id);else if(d.length===1){var v=u._getSoundIds(),g=v.indexOf(d[0]);g>=0?p=parseInt(d[0],10):u._sounds.length&&(p=u._sounds[0]._id,f=parseFloat(d[0]))}else d.length===2&&(f=parseFloat(d[0]),p=parseInt(d[1],10));if(typeof p>"u")return 0;if(typeof f=="number"&&(u._state!=="loaded"||u._playLock))return u._queue.push({event:"seek",action:function(){u.seek.apply(u,d)}}),u;var m=u._soundById(p);if(m)if(typeof f=="number"&&f>=0){var y=u.playing(p);y&&u.pause(p,!0),m._seek=f,m._ended=!1,u._clearTimer(p),!u._webAudio&&m._node&&!isNaN(m._node.duration)&&(m._node.currentTime=f);var _=function(){y&&u.play(p,!0),u._emit("seek",p)};if(y&&!u._webAudio){var S=function(){u._playLock?setTimeout(S,0):_()};setTimeout(S,0)}else _()}else if(u._webAudio){var A=u.playing(p)?n.ctx.currentTime-m._playStart:0,b=m._rateSeek?m._rateSeek-m._seek:0;return m._seek+(b+A*Math.abs(m._rate))}else return m._node.currentTime;return u},playing:function(u){var d=this;if(typeof u=="number"){var f=d._soundById(u);return f?!f._paused:!1}for(var p=0;p<d._sounds.length;p++)if(!d._sounds[p]._paused)return!0;return!1},duration:function(u){var d=this,f=d._duration,p=d._soundById(u);return p&&(f=d._sprite[p._sprite][1]/1e3),f},state:function(){return this._state},unload:function(){for(var u=this,d=u._sounds,f=0;f<d.length;f++)d[f]._paused||u.stop(d[f]._id),u._webAudio||(u._clearSound(d[f]._node),d[f]._node.removeEventListener("error",d[f]._errorFn,!1),d[f]._node.removeEventListener(n._canPlayEvent,d[f]._loadFn,!1),d[f]._node.removeEventListener("ended",d[f]._endFn,!1),n._releaseHtml5Audio(d[f]._node)),delete d[f]._node,u._clearTimer(d[f]._id);var p=n._howls.indexOf(u);p>=0&&n._howls.splice(p,1);var v=!0;for(f=0;f<n._howls.length;f++)if(n._howls[f]._src===u._src||u._src.indexOf(n._howls[f]._src)>=0){v=!1;break}return s&&v&&delete s[u._src],n.noAudio=!1,u._state="unloaded",u._sounds=[],u=null,null},on:function(u,d,f,p){var v=this,g=v["_on"+u];return typeof d=="function"&&g.push(p?{id:f,fn:d,once:p}:{id:f,fn:d}),v},off:function(u,d,f){var p=this,v=p["_on"+u],g=0;if(typeof d=="number"&&(f=d,d=null),d||f)for(g=0;g<v.length;g++){var m=f===v[g].id;if(d===v[g].fn&&m||!d&&m){v.splice(g,1);break}}else if(u)p["_on"+u]=[];else{var y=Object.keys(p);for(g=0;g<y.length;g++)y[g].indexOf("_on")===0&&Array.isArray(p[y[g]])&&(p[y[g]]=[])}return p},once:function(u,d,f){var p=this;return p.on(u,d,f,1),p},_emit:function(u,d,f){for(var p=this,v=p["_on"+u],g=v.length-1;g>=0;g--)(!v[g].id||v[g].id===d||u==="load")&&(setTimeout(function(m){m.call(this,d,f)}.bind(p,v[g].fn),0),v[g].once&&p.off(u,v[g].fn,v[g].id));return p._loadQueue(u),p},_loadQueue:function(u){var d=this;if(d._queue.length>0){var f=d._queue[0];f.event===u&&(d._queue.shift(),d._loadQueue()),u||f.action()}return d},_ended:function(u){var d=this,f=u._sprite;if(!d._webAudio&&u._node&&!u._node.paused&&!u._node.ended&&u._node.currentTime<u._stop)return setTimeout(d._ended.bind(d,u),100),d;var p=!!(u._loop||d._sprite[f][2]);if(d._emit("end",u._id),!d._webAudio&&p&&d.stop(u._id,!0).play(u._id),d._webAudio&&p){d._emit("play",u._id),u._seek=u._start||0,u._rateSeek=0,u._playStart=n.ctx.currentTime;var v=(u._stop-u._start)*1e3/Math.abs(u._rate);d._endTimers[u._id]=setTimeout(d._ended.bind(d,u),v)}return d._webAudio&&!p&&(u._paused=!0,u._ended=!0,u._seek=u._start||0,u._rateSeek=0,d._clearTimer(u._id),d._cleanBuffer(u._node),n._autoSuspend()),!d._webAudio&&!p&&d.stop(u._id,!0),d},_clearTimer:function(u){var d=this;if(d._endTimers[u]){if(typeof d._endTimers[u]!="function")clearTimeout(d._endTimers[u]);else{var f=d._soundById(u);f&&f._node&&f._node.removeEventListener("ended",d._endTimers[u],!1)}delete d._endTimers[u]}return d},_soundById:function(u){for(var d=this,f=0;f<d._sounds.length;f++)if(u===d._sounds[f]._id)return d._sounds[f];return null},_inactiveSound:function(){var u=this;u._drain();for(var d=0;d<u._sounds.length;d++)if(u._sounds[d]._ended)return u._sounds[d].reset();return new r(u)},_drain:function(){var u=this,d=u._pool,f=0,p=0;if(!(u._sounds.length<d)){for(p=0;p<u._sounds.length;p++)u._sounds[p]._ended&&f++;for(p=u._sounds.length-1;p>=0;p--){if(f<=d)return;u._sounds[p]._ended&&(u._webAudio&&u._sounds[p]._node&&u._sounds[p]._node.disconnect(0),u._sounds.splice(p,1),f--)}}},_getSoundIds:function(u){var d=this;if(typeof u>"u"){for(var f=[],p=0;p<d._sounds.length;p++)f.push(d._sounds[p]._id);return f}else return[u]},_refreshBuffer:function(u){var d=this;return u._node.bufferSource=n.ctx.createBufferSource(),u._node.bufferSource.buffer=s[d._src],u._panner?u._node.bufferSource.connect(u._panner):u._node.bufferSource.connect(u._node),u._node.bufferSource.loop=u._loop,u._loop&&(u._node.bufferSource.loopStart=u._start||0,u._node.bufferSource.loopEnd=u._stop||0),u._node.bufferSource.playbackRate.setValueAtTime(u._rate,n.ctx.currentTime),d},_cleanBuffer:function(u){var d=this,f=n._navigator&&n._navigator.vendor.indexOf("Apple")>=0;if(n._scratchBuffer&&u.bufferSource&&(u.bufferSource.onended=null,u.bufferSource.disconnect(0),f))try{u.bufferSource.buffer=n._scratchBuffer}catch{}return u.bufferSource=null,d},_clearSound:function(u){var d=/MSIE |Trident\//.test(n._navigator&&n._navigator.userAgent);d||(u.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(u){this._parent=u,this.init()};r.prototype={init:function(){var u=this,d=u._parent;return u._muted=d._muted,u._loop=d._loop,u._volume=d._volume,u._rate=d._rate,u._seek=0,u._paused=!0,u._ended=!0,u._sprite="__default",u._id=++n._counter,d._sounds.push(u),u.create(),u},create:function(){var u=this,d=u._parent,f=n._muted||u._muted||u._parent._muted?0:u._volume;return d._webAudio?(u._node=typeof n.ctx.createGain>"u"?n.ctx.createGainNode():n.ctx.createGain(),u._node.gain.setValueAtTime(f,n.ctx.currentTime),u._node.paused=!0,u._node.connect(n.masterGain)):n.noAudio||(u._node=n._obtainHtml5Audio(),u._errorFn=u._errorListener.bind(u),u._node.addEventListener("error",u._errorFn,!1),u._loadFn=u._loadListener.bind(u),u._node.addEventListener(n._canPlayEvent,u._loadFn,!1),u._endFn=u._endListener.bind(u),u._node.addEventListener("ended",u._endFn,!1),u._node.src=d._src,u._node.preload=d._preload===!0?"auto":d._preload,u._node.volume=f*n.volume(),u._node.load()),u},reset:function(){var u=this,d=u._parent;return u._muted=d._muted,u._loop=d._loop,u._volume=d._volume,u._rate=d._rate,u._seek=0,u._rateSeek=0,u._paused=!0,u._ended=!0,u._sprite="__default",u._id=++n._counter,u},_errorListener:function(){var u=this;u._parent._emit("loaderror",u._id,u._node.error?u._node.error.code:0),u._node.removeEventListener("error",u._errorFn,!1)},_loadListener:function(){var u=this,d=u._parent;d._duration=Math.ceil(u._node.duration*10)/10,Object.keys(d._sprite).length===0&&(d._sprite={__default:[0,d._duration*1e3]}),d._state!=="loaded"&&(d._state="loaded",d._emit("load"),d._loadQueue()),u._node.removeEventListener(n._canPlayEvent,u._loadFn,!1)},_endListener:function(){var u=this,d=u._parent;d._duration===1/0&&(d._duration=Math.ceil(u._node.duration*10)/10,d._sprite.__default[1]===1/0&&(d._sprite.__default[1]=d._duration*1e3),d._ended(u)),u._node.removeEventListener("ended",u._endFn,!1)}};var s={},o=function(u){var d=u._src;if(s[d]){u._duration=s[d].duration,c(u);return}if(/^data:[^;]+;base64,/.test(d)){for(var f=atob(d.split(",")[1]),p=new Uint8Array(f.length),v=0;v<f.length;++v)p[v]=f.charCodeAt(v);l(p.buffer,u)}else{var g=new XMLHttpRequest;g.open(u._xhr.method,d,!0),g.withCredentials=u._xhr.withCredentials,g.responseType="arraybuffer",u._xhr.headers&&Object.keys(u._xhr.headers).forEach(function(m){g.setRequestHeader(m,u._xhr.headers[m])}),g.onload=function(){var m=(g.status+"")[0];if(m!=="0"&&m!=="2"&&m!=="3"){u._emit("loaderror",null,"Failed loading audio file with status: "+g.status+".");return}l(g.response,u)},g.onerror=function(){u._webAudio&&(u._html5=!0,u._webAudio=!1,u._sounds=[],delete s[d],u.load())},a(g)}},a=function(u){try{u.send()}catch{u.onerror()}},l=function(u,d){var f=function(){d._emit("loaderror",null,"Decoding audio data failed.")},p=function(v){v&&d._sounds.length>0?(s[d._src]=v,c(d,v)):f()};typeof Promise<"u"&&n.ctx.decodeAudioData.length===1?n.ctx.decodeAudioData(u).then(p).catch(f):n.ctx.decodeAudioData(u,p,f)},c=function(u,d){d&&!u._duration&&(u._duration=d.duration),Object.keys(u._sprite).length===0&&(u._sprite={__default:[0,u._duration*1e3]}),u._state!=="loaded"&&(u._state="loaded",u._emit("load"),u._loadQueue())},h=function(){if(n.usingWebAudio){try{typeof AudioContext<"u"?n.ctx=new AudioContext:typeof webkitAudioContext<"u"?n.ctx=new webkitAudioContext:n.usingWebAudio=!1}catch{n.usingWebAudio=!1}n.ctx||(n.usingWebAudio=!1);var u=/iP(hone|od|ad)/.test(n._navigator&&n._navigator.platform),d=n._navigator&&n._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),f=d?parseInt(d[1],10):null;if(u&&f&&f<9){var p=/safari/.test(n._navigator&&n._navigator.userAgent.toLowerCase());n._navigator&&!p&&(n.usingWebAudio=!1)}n.usingWebAudio&&(n.masterGain=typeof n.ctx.createGain>"u"?n.ctx.createGainNode():n.ctx.createGain(),n.masterGain.gain.setValueAtTime(n._muted?0:n._volume,n.ctx.currentTime),n.masterGain.connect(n.ctx.destination)),n._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:n,Howl:i}}),typeof t<"u"&&(t.Howler=n,t.Howl=i),typeof global<"u"?(global.HowlerGlobal=e,global.Howler=n,global.Howl=i,global.Sound=r):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=n,window.Howl=i,window.Sound=r)})(),function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(n){var i=this;if(!i.ctx||!i.ctx.listener)return i;for(var r=i._howls.length-1;r>=0;r--)i._howls[r].stereo(n);return i},HowlerGlobal.prototype.pos=function(n,i,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(i=typeof i!="number"?s._pos[1]:i,r=typeof r!="number"?s._pos[2]:r,typeof n=="number")s._pos=[n,i,r],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(n,i,r,s,o,a){var l=this;if(!l.ctx||!l.ctx.listener)return l;var c=l._orientation;if(i=typeof i!="number"?c[1]:i,r=typeof r!="number"?c[2]:r,s=typeof s!="number"?c[3]:s,o=typeof o!="number"?c[4]:o,a=typeof a!="number"?c[5]:a,typeof n=="number")l._orientation=[n,i,r,s,o,a],typeof l.ctx.listener.forwardX<"u"?(l.ctx.listener.forwardX.setTargetAtTime(n,Howler.ctx.currentTime,.1),l.ctx.listener.forwardY.setTargetAtTime(i,Howler.ctx.currentTime,.1),l.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),l.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),l.ctx.listener.upY.setTargetAtTime(o,Howler.ctx.currentTime,.1),l.ctx.listener.upZ.setTargetAtTime(a,Howler.ctx.currentTime,.1)):l.ctx.listener.setOrientation(n,i,r,s,o,a);else return c;return l},Howl.prototype.init=function(n){return function(i){var r=this;return r._orientation=i.orientation||[1,0,0],r._stereo=i.stereo||null,r._pos=i.pos||null,r._pannerAttr={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:360,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:360,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:0,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:"inverse",maxDistance:typeof i.maxDistance<"u"?i.maxDistance:1e4,panningModel:typeof i.panningModel<"u"?i.panningModel:"HRTF",refDistance:typeof i.refDistance<"u"?i.refDistance:1,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:1},r._onstereo=i.onstereo?[{fn:i.onstereo}]:[],r._onpos=i.onpos?[{fn:i.onpos}]:[],r._onorientation=i.onorientation?[{fn:i.onorientation}]:[],n.call(this,i)}}(Howl.prototype.init),Howl.prototype.stereo=function(n,i){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"stereo",action:function(){r.stereo(n,i)}}),r;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof i>"u")if(typeof n=="number")r._stereo=n,r._pos=[n,0,0];else return r._stereo;for(var o=r._getSoundIds(i),a=0;a<o.length;a++){var l=r._soundById(o[a]);if(l)if(typeof n=="number")l._stereo=n,l._pos=[n,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&e(l,s),s==="spatial"?typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(n,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(n,0,0):l._panner.pan.setValueAtTime(n,Howler.ctx.currentTime)),r._emit("stereo",l._id);else return l._stereo}return r},Howl.prototype.pos=function(n,i,r,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"pos",action:function(){o.pos(n,i,r,s)}}),o;if(i=typeof i!="number"?0:i,r=typeof r!="number"?-.5:r,typeof s>"u")if(typeof n=="number")o._pos=[n,i,r];else return o._pos;for(var a=o._getSoundIds(s),l=0;l<a.length;l++){var c=o._soundById(a[l]);if(c)if(typeof n=="number")c._pos=[n,i,r],c._node&&((!c._panner||c._panner.pan)&&e(c,"spatial"),typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(n,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):c._panner.setPosition(n,i,r)),o._emit("pos",c._id);else return c._pos}return o},Howl.prototype.orientation=function(n,i,r,s){var o=this;if(!o._webAudio)return o;if(o._state!=="loaded")return o._queue.push({event:"orientation",action:function(){o.orientation(n,i,r,s)}}),o;if(i=typeof i!="number"?o._orientation[1]:i,r=typeof r!="number"?o._orientation[2]:r,typeof s>"u")if(typeof n=="number")o._orientation=[n,i,r];else return o._orientation;for(var a=o._getSoundIds(s),l=0;l<a.length;l++){var c=o._soundById(a[l]);if(c)if(typeof n=="number")c._orientation=[n,i,r],c._node&&(c._panner||(c._pos||(c._pos=o._pos||[0,0,-.5]),e(c,"spatial")),typeof c._panner.orientationX<"u"?(c._panner.orientationX.setValueAtTime(n,Howler.ctx.currentTime),c._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),c._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):c._panner.setOrientation(n,i,r)),o._emit("orientation",c._id);else return c._orientation}return o},Howl.prototype.pannerAttr=function(){var n=this,i=arguments,r,s,o;if(!n._webAudio)return n;if(i.length===0)return n._pannerAttr;if(i.length===1)if(typeof i[0]=="object")r=i[0],typeof s>"u"&&(r.pannerAttr||(r.pannerAttr={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel}),n._pannerAttr={coneInnerAngle:typeof r.pannerAttr.coneInnerAngle<"u"?r.pannerAttr.coneInnerAngle:n._coneInnerAngle,coneOuterAngle:typeof r.pannerAttr.coneOuterAngle<"u"?r.pannerAttr.coneOuterAngle:n._coneOuterAngle,coneOuterGain:typeof r.pannerAttr.coneOuterGain<"u"?r.pannerAttr.coneOuterGain:n._coneOuterGain,distanceModel:typeof r.pannerAttr.distanceModel<"u"?r.pannerAttr.distanceModel:n._distanceModel,maxDistance:typeof r.pannerAttr.maxDistance<"u"?r.pannerAttr.maxDistance:n._maxDistance,refDistance:typeof r.pannerAttr.refDistance<"u"?r.pannerAttr.refDistance:n._refDistance,rolloffFactor:typeof r.pannerAttr.rolloffFactor<"u"?r.pannerAttr.rolloffFactor:n._rolloffFactor,panningModel:typeof r.pannerAttr.panningModel<"u"?r.pannerAttr.panningModel:n._panningModel});else return o=n._soundById(parseInt(i[0],10)),o?o._pannerAttr:n._pannerAttr;else i.length===2&&(r=i[0],s=parseInt(i[1],10));for(var a=n._getSoundIds(s),l=0;l<a.length;l++)if(o=n._soundById(a[l]),o){var c=o._pannerAttr;c={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:c.coneInnerAngle,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:c.coneOuterAngle,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:c.coneOuterGain,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:c.distanceModel,maxDistance:typeof r.maxDistance<"u"?r.maxDistance:c.maxDistance,refDistance:typeof r.refDistance<"u"?r.refDistance:c.refDistance,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:c.rolloffFactor,panningModel:typeof r.panningModel<"u"?r.panningModel:c.panningModel};var h=o._panner;h?(h.coneInnerAngle=c.coneInnerAngle,h.coneOuterAngle=c.coneOuterAngle,h.coneOuterGain=c.coneOuterGain,h.distanceModel=c.distanceModel,h.maxDistance=c.maxDistance,h.refDistance=c.refDistance,h.rolloffFactor=c.rolloffFactor,h.panningModel=c.panningModel):(o._pos||(o._pos=n._pos||[0,0,-.5]),e(o,"spatial"))}return n},Sound.prototype.init=function(n){return function(){var i=this,r=i._parent;i._orientation=r._orientation,i._stereo=r._stereo,i._pos=r._pos,i._pannerAttr=r._pannerAttr,n.call(this),i._stereo?r.stereo(i._stereo):i._pos&&r.pos(i._pos[0],i._pos[1],i._pos[2],i._id)}}(Sound.prototype.init),Sound.prototype.reset=function(n){return function(){var i=this,r=i._parent;return i._orientation=r._orientation,i._stereo=r._stereo,i._pos=r._pos,i._pannerAttr=r._pannerAttr,i._stereo?r.stereo(i._stereo):i._pos?r.pos(i._pos[0],i._pos[1],i._pos[2],i._id):i._panner&&(i._panner.disconnect(0),i._panner=void 0,r._refreshBuffer(i)),n.call(this)}}(Sound.prototype.reset);var e=function(n,i){i=i||"spatial",i==="spatial"?(n._panner=Howler.ctx.createPanner(),n._panner.coneInnerAngle=n._pannerAttr.coneInnerAngle,n._panner.coneOuterAngle=n._pannerAttr.coneOuterAngle,n._panner.coneOuterGain=n._pannerAttr.coneOuterGain,n._panner.distanceModel=n._pannerAttr.distanceModel,n._panner.maxDistance=n._pannerAttr.maxDistance,n._panner.refDistance=n._pannerAttr.refDistance,n._panner.rolloffFactor=n._pannerAttr.rolloffFactor,n._panner.panningModel=n._pannerAttr.panningModel,typeof n._panner.positionX<"u"?(n._panner.positionX.setValueAtTime(n._pos[0],Howler.ctx.currentTime),n._panner.positionY.setValueAtTime(n._pos[1],Howler.ctx.currentTime),n._panner.positionZ.setValueAtTime(n._pos[2],Howler.ctx.currentTime)):n._panner.setPosition(n._pos[0],n._pos[1],n._pos[2]),typeof n._panner.orientationX<"u"?(n._panner.orientationX.setValueAtTime(n._orientation[0],Howler.ctx.currentTime),n._panner.orientationY.setValueAtTime(n._orientation[1],Howler.ctx.currentTime),n._panner.orientationZ.setValueAtTime(n._orientation[2],Howler.ctx.currentTime)):n._panner.setOrientation(n._orientation[0],n._orientation[1],n._orientation[2])):(n._panner=Howler.ctx.createStereoPanner(),n._panner.pan.setValueAtTime(n._stereo,Howler.ctx.currentTime)),n._panner.connect(n._node),n._paused||n._parent.pause(n._id,!0).play(n._id,!0)}}()}),rye=aE((t,e)=>{e.exports=function(n,i){for(var r=n.split("."),s=i.split("."),o=0;o<3;o++){var a=Number(r[o]),l=Number(s[o]);if(a>l)return 1;if(l>a)return-1;if(!isNaN(a)&&isNaN(l))return 1;if(isNaN(a)&&!isNaN(l))return-1}return 0}}),cv="149",Fo={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},sye=0,sH=1,oye=2,mO=1,hQ=2,J0=3,Ka=0,vr=1,oo=2,Rr=0,og=1,oH=2,aH=3,lH=4,aye=5,dm=100,lye=101,cye=102,cH=103,uH=104,uye=200,hye=201,dye=202,fye=203,dQ=204,fQ=205,pye=206,mye=207,gye=208,vye=209,yye=210,xye=0,_ye=1,wye=2,SL=3,Sye=4,bye=5,Aye=6,Mye=7,pQ=0,Eye=1,Cye=2,qc=0,Tye=1,Pye=2,Dye=3,Rye=4,Lye=5,mQ=300,Rf=301,Lf=302,bL=303,AL=304,A1=306,Sx=1e3,to=1001,ML=1002,si=1003,hH=1004,bP=1005,En=1006,Iye=1007,Ug=1008,Kr=1009,Bye=1010,Oye=1011,gQ=1012,Fye=1013,lh=1014,ch=1015,bx=1016,Nye=1017,Uye=1018,ff=1020,kye=1021,Fa=1023,zye=1024,Gye=1025,pf=1026,If=1027,Hye=1028,Vye=1029,jye=1030,Wye=1031,Xye=1033,AP=33776,MP=33777,EP=33778,CP=33779,dH=35840,fH=35841,pH=35842,mH=35843,Yye=36196,gH=37492,vH=37496,yH=37808,xH=37809,_H=37810,wH=37811,SH=37812,bH=37813,AH=37814,MH=37815,EH=37816,CH=37817,TH=37818,PH=37819,DH=37820,RH=37821,TP=36492,qye=36283,LH=36284,IH=36285,BH=36286,Jl=3e3,Wt=3001,hu=3200,vQ=3201,Qye=0,Kye=1,Tl="srgb",wA="srgb-linear",PP=7680,Jye=519,EL=35044,OH="300 es",CL=1035,ys=class{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});let n=this._listeners;n[t]===void 0&&(n[t]=[]),n[t].indexOf(e)===-1&&n[t].push(e)}hasEventListener(t,e){if(this._listeners===void 0)return!1;let n=this._listeners;return n[t]!==void 0&&n[t].indexOf(e)!==-1}removeEventListener(t,e){if(this._listeners===void 0)return;let n=this._listeners[t];if(n!==void 0){let i=n.indexOf(e);i!==-1&&n.splice(i,1)}}dispatchEvent(t){if(this._listeners===void 0)return;let e=this._listeners[t.type];if(e!==void 0){t.target=this;let n=e.slice(0);for(let i=0,r=n.length;i<r;i++)n[i].call(this,t);t.target=null}}},Vr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],FH=1234567,Ay=Math.PI/180,Ax=180/Math.PI;function jl(){let t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Vr[t&255]+Vr[t>>8&255]+Vr[t>>16&255]+Vr[t>>24&255]+"-"+Vr[e&255]+Vr[e>>8&255]+"-"+Vr[e>>16&15|64]+Vr[e>>24&255]+"-"+Vr[n&63|128]+Vr[n>>8&255]+"-"+Vr[n>>16&255]+Vr[n>>24&255]+Vr[i&255]+Vr[i>>8&255]+Vr[i>>16&255]+Vr[i>>24&255]).toLowerCase()}function Ki(t,e,n){return Math.max(e,Math.min(n,t))}function gO(t,e){return(t%e+e)%e}function Zye(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)}function $ye(t,e,n){return t!==e?(n-t)/(e-t):0}function My(t,e,n){return(1-n)*t+n*e}function exe(t,e,n,i){return My(t,e,1-Math.exp(-n*i))}function txe(t,e=1){return e-Math.abs(gO(t,e*2)-e)}function nxe(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function ixe(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function rxe(t,e){return t+Math.floor(Math.random()*(e-t+1))}function sxe(t,e){return t+Math.random()*(e-t)}function oxe(t){return t*(.5-Math.random())}function axe(t){t!==void 0&&(FH=t);let e=FH+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function lxe(t){return t*Ay}function cxe(t){return t*Ax}function TL(t){return(t&t-1)===0&&t!==0}function uxe(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function SA(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function hxe(t,e,n,i,r){let s=Math.cos,o=Math.sin,a=s(n/2),l=o(n/2),c=s((e+i)/2),h=o((e+i)/2),u=s((e-i)/2),d=o((e-i)/2),f=s((i-e)/2),p=o((i-e)/2);switch(r){case"XYX":t.set(a*h,l*u,l*d,a*c);break;case"YZY":t.set(l*d,a*h,l*u,a*c);break;case"ZXZ":t.set(l*u,l*d,a*h,a*c);break;case"XZX":t.set(a*h,l*p,l*f,a*c);break;case"YXY":t.set(l*f,a*h,l*p,a*c);break;case"ZYZ":t.set(l*p,l*f,a*h,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Gc(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function kn(t,e){switch(e.constructor){case Float32Array:return t;case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}var sn=Object.freeze({__proto__:null,DEG2RAD:Ay,RAD2DEG:Ax,ceilPowerOfTwo:uxe,clamp:Ki,damp:exe,degToRad:lxe,denormalize:Gc,euclideanModulo:gO,floorPowerOfTwo:SA,generateUUID:jl,inverseLerp:$ye,isPowerOfTwo:TL,lerp:My,mapLinear:Zye,normalize:kn,pingpong:txe,radToDeg:cxe,randFloat:sxe,randFloatSpread:oxe,randInt:rxe,seededRandom:axe,setQuaternionFromProperEuler:hxe,smootherstep:ixe,smoothstep:nxe}),Se=class{constructor(e=0,n=0){Se.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let n=this.x,i=this.y,r=e.elements;return this.x=r[0]*n+r[3]*i+r[6],this.y=r[1]*n+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){let i=Math.cos(n),r=Math.sin(n),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Pr=class{constructor(){Pr.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(t,e,n,i,r,s,o,a,l){let c=this.elements;return c[0]=t,c[1]=i,c[2]=o,c[3]=e,c[4]=r,c[5]=a,c[6]=n,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){let e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this}extractBasis(t,e,n){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){let e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){let n=t.elements,i=e.elements,r=this.elements,s=n[0],o=n[3],a=n[6],l=n[1],c=n[4],h=n[7],u=n[2],d=n[5],f=n[8],p=i[0],v=i[3],g=i[6],m=i[1],y=i[4],_=i[7],S=i[2],A=i[5],b=i[8];return r[0]=s*p+o*m+a*S,r[3]=s*v+o*y+a*A,r[6]=s*g+o*_+a*b,r[1]=l*p+c*m+h*S,r[4]=l*v+c*y+h*A,r[7]=l*g+c*_+h*b,r[2]=u*p+d*m+f*S,r[5]=u*v+d*y+f*A,r[8]=u*g+d*_+f*b,this}multiplyScalar(t){let e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){let t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8];return e*s*c-e*o*l-n*r*c+n*o*a+i*r*l-i*s*a}invert(){let t=this.elements,e=t[0],n=t[1],i=t[2],r=t[3],s=t[4],o=t[5],a=t[6],l=t[7],c=t[8],h=c*s-o*l,u=o*a-c*r,d=l*r-s*a,f=e*h+n*u+i*d;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);let p=1/f;return t[0]=h*p,t[1]=(i*l-c*n)*p,t[2]=(o*n-i*s)*p,t[3]=u*p,t[4]=(c*e-i*a)*p,t[5]=(i*r-o*e)*p,t[6]=d*p,t[7]=(n*a-l*e)*p,t[8]=(s*e-n*r)*p,this}transpose(){let t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){let e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,n,i,r,s,o){let a=Math.cos(r),l=Math.sin(r);return this.set(n*a,n*l,-n*(a*s+l*o)+s+t,-i*l,i*a,-i*(-l*s+a*o)+o+e,0,0,1),this}scale(t,e){return this.premultiply(DP.makeScale(t,e)),this}rotate(t){return this.premultiply(DP.makeRotation(-t)),this}translate(t,e){return this.premultiply(DP.makeTranslation(t,e)),this}makeTranslation(t,e){return this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){let e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,n,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){let e=this.elements,n=t.elements;for(let i=0;i<9;i++)if(e[i]!==n[i])return!1;return!0}fromArray(t,e=0){for(let n=0;n<9;n++)this.elements[n]=t[n+e];return this}toArray(t=[],e=0){let n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}clone(){return new this.constructor().fromArray(this.elements)}},DP=new Pr;function yQ(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}var dxe={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Vw(t,e){return new dxe[t](e)}function bA(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function mf(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function _b(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}var RP={[Tl]:{[wA]:mf},[wA]:{[Tl]:_b}},ns={legacyMode:!0,get workingColorSpace(){return wA},set workingColorSpace(t){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(t,e,n){if(this.legacyMode||e===n||!e||!n)return t;if(RP[e]&&RP[e][n]!==void 0){let i=RP[e][n];return t.r=i(t.r),t.g=i(t.g),t.b=i(t.b),t}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(t,e){return this.convert(t,this.workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this.workingColorSpace)}},xQ={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Xi={r:0,g:0,b:0},Sa={h:0,s:0,l:0},jw={h:0,s:0,l:0};function LP(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}function Ww(t,e){return e.r=t.r,e.g=t.g,e.b=t.b,e}var Rt=class{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,n===void 0&&i===void 0?this.set(e):this.setRGB(e,n,i)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=Tl){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,ns.toWorkingColorSpace(this,n),this}setRGB(e,n,i,r=ns.workingColorSpace){return this.r=e,this.g=n,this.b=i,ns.toWorkingColorSpace(this,r),this}setHSL(e,n,i,r=ns.workingColorSpace){if(e=gO(e,1),n=Ki(n,0,1),i=Ki(i,0,1),n===0)this.r=this.g=this.b=i;else{let s=i<=.5?i*(1+n):i+n-i*n,o=2*i-s;this.r=LP(o,s,e+1/3),this.g=LP(o,s,e),this.b=LP(o,s,e-1/3)}return ns.toWorkingColorSpace(this,r),this}setStyle(e,n=Tl){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let s,o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,ns.toWorkingColorSpace(this,n),i(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,ns.toWorkingColorSpace(this,n),i(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){let l=parseFloat(s[1])/360,c=parseFloat(s[2])/100,h=parseFloat(s[3])/100;return i(s[4]),this.setHSL(l,c,h,n)}break}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){let s=r[1],o=s.length;if(o===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,ns.toWorkingColorSpace(this,n),this;if(o===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,ns.toWorkingColorSpace(this,n),this}return e&&e.length>0?this.setColorName(e,n):this}setColorName(e,n=Tl){let i=xQ[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=mf(e.r),this.g=mf(e.g),this.b=mf(e.b),this}copyLinearToSRGB(e){return this.r=_b(e.r),this.g=_b(e.g),this.b=_b(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Tl){return ns.fromWorkingColorSpace(Ww(this,Xi),e),Ki(Xi.r*255,0,255)<<16^Ki(Xi.g*255,0,255)<<8^Ki(Xi.b*255,0,255)<<0}getHexString(e=Tl){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=ns.workingColorSpace){ns.fromWorkingColorSpace(Ww(this,Xi),n);let i=Xi.r,r=Xi.g,s=Xi.b,o=Math.max(i,r,s),a=Math.min(i,r,s),l,c,h=(a+o)/2;if(a===o)l=0,c=0;else{let u=o-a;switch(c=h<=.5?u/(o+a):u/(2-o-a),o){case i:l=(r-s)/u+(r<s?6:0);break;case r:l=(s-i)/u+2;break;case s:l=(i-r)/u+4;break}l/=6}return e.h=l,e.s=c,e.l=h,e}getRGB(e,n=ns.workingColorSpace){return ns.fromWorkingColorSpace(Ww(this,Xi),n),e.r=Xi.r,e.g=Xi.g,e.b=Xi.b,e}getStyle(e=Tl){return ns.fromWorkingColorSpace(Ww(this,Xi),e),e!==Tl?`color(${e} ${Xi.r} ${Xi.g} ${Xi.b})`:`rgb(${Xi.r*255|0},${Xi.g*255|0},${Xi.b*255|0})`}offsetHSL(e,n,i){return this.getHSL(Sa),Sa.h+=e,Sa.s+=n,Sa.l+=i,this.setHSL(Sa.h,Sa.s,Sa.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(Sa),e.getHSL(jw);let i=My(Sa.h,jw.h,n),r=My(Sa.s,jw.s,n),s=My(Sa.l,jw.l,n);return this.setHSL(i,r,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};Rt.NAMES=xQ;var Fp,_Q=class{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{Fp===void 0&&(Fp=bA("canvas")),Fp.width=t.width,Fp.height=t.height;let n=Fp.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),e=Fp}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){let e=bA("canvas");e.width=t.width,e.height=t.height;let n=e.getContext("2d");n.drawImage(t,0,0,t.width,t.height);let i=n.getImageData(0,0,t.width,t.height),r=i.data;for(let s=0;s<r.length;s++)r[s]=mf(r[s]/255)*255;return n.putImageData(i,0,0),e}else if(t.data){let e=t.data.slice(0);for(let n=0;n<e.length;n++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[n]=Math.floor(mf(e[n]/255)*255):e[n]=mf(e[n]);return{data:e,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}},wQ=class{constructor(t=null){this.isSource=!0,this.uuid=jl(),this.data=t,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){let e=t===void 0||typeof t=="string";if(!e&&t.images[this.uuid]!==void 0)return t.images[this.uuid];let n={uuid:this.uuid,url:""},i=this.data;if(i!==null){let r;if(Array.isArray(i)){r=[];for(let s=0,o=i.length;s<o;s++)i[s].isDataTexture?r.push(IP(i[s].image)):r.push(IP(i[s]))}else r=IP(i);n.url=r}return e||(t.images[this.uuid]=n),n}};function IP(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?_Q.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var fxe=0,_r=class extends ys{constructor(t=_r.DEFAULT_IMAGE,e=_r.DEFAULT_MAPPING,n=to,i=to,r=En,s=Ug,o=Fa,a=Kr,l=_r.DEFAULT_ANISOTROPY,c=Jl){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:fxe++}),this.uuid=jl(),this.name="",this.source=new wQ(t),this.mipmaps=[],this.mapping=e,this.wrapS=n,this.wrapT=i,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=a,this.offset=new Se(0,0),this.repeat=new Se(1,1),this.center=new Se(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Pr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){let e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];let n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),e||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==mQ)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Sx:t.x=t.x-Math.floor(t.x);break;case to:t.x=t.x<0?0:1;break;case ML:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case Sx:t.y=t.y-Math.floor(t.y);break;case to:t.y=t.y<0?0:1;break;case ML:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}};_r.DEFAULT_IMAGE=null;_r.DEFAULT_MAPPING=mQ;_r.DEFAULT_ANISOTROPY=1;var Zt=class{constructor(e=0,n=0,i=0,r=1){Zt.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let n=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*n+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*n+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*n+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*n+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,r,s,o=e.elements,a=o[0],l=o[4],c=o[8],h=o[1],u=o[5],d=o[9],f=o[2],p=o[6],v=o[10];if(Math.abs(l-h)<.01&&Math.abs(c-f)<.01&&Math.abs(d-p)<.01){if(Math.abs(l+h)<.1&&Math.abs(c+f)<.1&&Math.abs(d+p)<.1&&Math.abs(a+u+v-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;let m=(a+1)/2,y=(u+1)/2,_=(v+1)/2,S=(l+h)/4,A=(c+f)/4,b=(d+p)/4;return m>y&&m>_?m<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(m),r=S/i,s=A/i):y>_?y<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(y),i=S/r,s=b/r):_<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(_),i=A/s,r=b/s),this.set(i,r,s,n),this}let g=Math.sqrt((p-d)*(p-d)+(c-f)*(c-f)+(h-l)*(h-l));return Math.abs(g)<.001&&(g=1),this.x=(p-d)/g,this.y=(c-f)/g,this.z=(h-l)/g,this.w=Math.acos((a+u+v-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},$i=class extends ys{constructor(t=1,e=1,n={}){super(),this.isWebGLRenderTarget=!0,this.width=t,this.height=e,this.depth=1,this.scissor=new Zt(0,0,t,e),this.scissorTest=!1,this.viewport=new Zt(0,0,t,e);let i={width:t,height:e,depth:1};this.texture=new _r(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.internalFormat=n.internalFormat!==void 0?n.internalFormat:null,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:En,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!1,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null,this.samples=n.samples!==void 0?n.samples:0}setSize(t,e,n=1){(this.width!==t||this.height!==e||this.depth!==n)&&(this.width=t,this.height=e,this.depth=n,this.texture.image.width=t,this.texture.image.height=e,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return new this.constructor().copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;let e=Object.assign({},t.texture.image);return this.texture.source=new wQ(e),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},SQ=class extends _r{constructor(t=null,e=1,n=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:n,depth:i},this.magFilter=si,this.minFilter=si,this.wrapR=to,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},pxe=class extends _r{constructor(t=null,e=1,n=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:n,depth:i},this.magFilter=si,this.minFilter=si,this.wrapR=to,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},on=class{constructor(t=0,e=0,n=0,i=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=n,this._w=i}static slerpFlat(t,e,n,i,r,s,o){let a=n[i+0],l=n[i+1],c=n[i+2],h=n[i+3],u=r[s+0],d=r[s+1],f=r[s+2],p=r[s+3];if(o===0){t[e+0]=a,t[e+1]=l,t[e+2]=c,t[e+3]=h;return}if(o===1){t[e+0]=u,t[e+1]=d,t[e+2]=f,t[e+3]=p;return}if(h!==p||a!==u||l!==d||c!==f){let v=1-o,g=a*u+l*d+c*f+h*p,m=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){let S=Math.sqrt(y),A=Math.atan2(S,g*m);v=Math.sin(v*A)/S,o=Math.sin(o*A)/S}let _=o*m;if(a=a*v+u*_,l=l*v+d*_,c=c*v+f*_,h=h*v+p*_,v===1-o){let S=1/Math.sqrt(a*a+l*l+c*c+h*h);a*=S,l*=S,c*=S,h*=S}}t[e]=a,t[e+1]=l,t[e+2]=c,t[e+3]=h}static multiplyQuaternionsFlat(t,e,n,i,r,s){let o=n[i],a=n[i+1],l=n[i+2],c=n[i+3],h=r[s],u=r[s+1],d=r[s+2],f=r[s+3];return t[e]=o*f+c*h+a*d-l*u,t[e+1]=a*f+c*u+l*h-o*d,t[e+2]=l*f+c*d+o*u-a*h,t[e+3]=c*f-o*h-a*u-l*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,n,i){return this._x=t,this._y=e,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){let n=t._x,i=t._y,r=t._z,s=t._order,o=Math.cos,a=Math.sin,l=o(n/2),c=o(i/2),h=o(r/2),u=a(n/2),d=a(i/2),f=a(r/2);switch(s){case"XYZ":this._x=u*c*h+l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h-u*d*f;break;case"YXZ":this._x=u*c*h+l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h+u*d*f;break;case"ZXY":this._x=u*c*h-l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h-u*d*f;break;case"ZYX":this._x=u*c*h-l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h+u*d*f;break;case"YZX":this._x=u*c*h+l*d*f,this._y=l*d*h+u*c*f,this._z=l*c*f-u*d*h,this._w=l*c*h-u*d*f;break;case"XZY":this._x=u*c*h-l*d*f,this._y=l*d*h-u*c*f,this._z=l*c*f+u*d*h,this._w=l*c*h+u*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,e){let n=e/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){let e=t.elements,n=e[0],i=e[4],r=e[8],s=e[1],o=e[5],a=e[9],l=e[2],c=e[6],h=e[10],u=n+o+h;if(u>0){let d=.5/Math.sqrt(u+1);this._w=.25/d,this._x=(c-a)*d,this._y=(r-l)*d,this._z=(s-i)*d}else if(n>o&&n>h){let d=2*Math.sqrt(1+n-o-h);this._w=(c-a)/d,this._x=.25*d,this._y=(i+s)/d,this._z=(r+l)/d}else if(o>h){let d=2*Math.sqrt(1+o-n-h);this._w=(r-l)/d,this._x=(i+s)/d,this._y=.25*d,this._z=(a+c)/d}else{let d=2*Math.sqrt(1+h-n-o);this._w=(s-i)/d,this._x=(r+l)/d,this._y=(a+c)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let n=t.dot(e)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Ki(this.dot(t),-1,1)))}rotateTowards(t,e){let n=this.angleTo(t);if(n===0)return this;let i=Math.min(1,e/n);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){let n=t._x,i=t._y,r=t._z,s=t._w,o=e._x,a=e._y,l=e._z,c=e._w;return this._x=n*c+s*o+i*l-r*a,this._y=i*c+s*a+r*o-n*l,this._z=r*c+s*l+n*a-i*o,this._w=s*c-n*o-i*a-r*l,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);let n=this._x,i=this._y,r=this._z,s=this._w,o=s*t._w+n*t._x+i*t._y+r*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=s,this._x=n,this._y=i,this._z=r,this;let a=1-o*o;if(a<=Number.EPSILON){let d=1-e;return this._w=d*s+e*this._w,this._x=d*n+e*this._x,this._y=d*i+e*this._y,this._z=d*r+e*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(a),c=Math.atan2(l,o),h=Math.sin((1-e)*c)/l,u=Math.sin(e*c)/l;return this._w=s*h+this._w*u,this._x=n*h+this._x*u,this._y=i*h+this._y*u,this._z=r*h+this._z*u,this._onChangeCallback(),this}slerpQuaternions(t,e,n){return this.copy(t).slerp(e,n)}random(){let t=Math.random(),e=Math.sqrt(1-t),n=Math.sqrt(t),i=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(e*Math.cos(i),n*Math.sin(r),n*Math.cos(r),e*Math.sin(i))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},N=class{constructor(e=0,n=0,i=0){N.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(NH.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(NH.setFromAxisAngle(e,n))}applyMatrix3(e){let n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6]*r,this.y=s[1]*n+s[4]*i+s[7]*r,this.z=s[2]*n+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let n=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*n+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*n+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*n+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*n+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){let n=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,l=e.w,c=l*n+o*r-a*i,h=l*i+a*n-s*r,u=l*r+s*i-o*n,d=-s*n-o*i-a*r;return this.x=c*l+d*-s+h*-a-u*-o,this.y=h*l+d*-o+u*-s-c*-a,this.z=u*l+d*-a+c*-o-h*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[4]*i+s[8]*r,this.y=s[1]*n+s[5]*i+s[9]*r,this.z=s[2]*n+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){let i=e.x,r=e.y,s=e.z,o=n.x,a=n.y,l=n.z;return this.x=r*l-s*a,this.y=s*o-i*l,this.z=i*a-r*o,this}projectOnVector(e){let n=e.lengthSq();if(n===0)return this.set(0,0,0);let i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return BP.copy(this).projectOnVector(e),this.sub(BP)}reflect(e){return this.sub(BP.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;let i=this.dot(e)/n;return Math.acos(Ki(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let n=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return n*n+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){let r=Math.sin(n)*e;return this.x=r*Math.sin(i),this.y=Math.cos(n)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){let n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){let n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=r,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,n=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(n),this.y=i*Math.sin(n),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},BP=new N,NH=new on,Vi=class{constructor(t=new N(1/0,1/0,1/0),e=new N(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,l=t.length;a<l;a+=3){let c=t[a],h=t[a+1],u=t[a+2];c<e&&(e=c),h<n&&(n=h),u<i&&(i=u),c>r&&(r=c),h>s&&(s=h),u>o&&(o=u)}return this.min.set(e,n,i),this.max.set(r,s,o),this}setFromBufferAttribute(t){let e=1/0,n=1/0,i=1/0,r=-1/0,s=-1/0,o=-1/0;for(let a=0,l=t.count;a<l;a++){let c=t.getX(a),h=t.getY(a),u=t.getZ(a);c<e&&(e=c),h<n&&(n=h),u<i&&(i=u),c>r&&(r=c),h>s&&(s=h),u>o&&(o=u)}return this.min.set(e,n,i),this.max.set(r,s,o),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){let n=Sd.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);let n=t.geometry;if(n!==void 0)if(e&&n.attributes!=null&&n.attributes.position!==void 0){let r=n.attributes.position;for(let s=0,o=r.count;s<o;s++)Sd.fromBufferAttribute(r,s).applyMatrix4(t.matrixWorld),this.expandByPoint(Sd)}else n.boundingBox===null&&n.computeBoundingBox(),OP.copy(n.boundingBox),OP.applyMatrix4(t.matrixWorld),this.union(OP);let i=t.children;for(let r=0,s=i.length;r<s;r++)this.expandByObject(i[r],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,Sd),Sd.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(f0),Xw.subVectors(this.max,f0),Np.subVectors(t.a,f0),Up.subVectors(t.b,f0),kp.subVectors(t.c,f0),Ru.subVectors(Up,Np),Lu.subVectors(kp,Up),bd.subVectors(Np,kp);let e=[0,-Ru.z,Ru.y,0,-Lu.z,Lu.y,0,-bd.z,bd.y,Ru.z,0,-Ru.x,Lu.z,0,-Lu.x,bd.z,0,-bd.x,-Ru.y,Ru.x,0,-Lu.y,Lu.x,0,-bd.y,bd.x,0];return!FP(e,Np,Up,kp,Xw)||(e=[1,0,0,0,1,0,0,0,1],!FP(e,Np,Up,kp,Xw))?!1:(Yw.crossVectors(Ru,Lu),e=[Yw.x,Yw.y,Yw.z],FP(e,Np,Up,kp,Xw))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return Sd.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=this.getSize(Sd).length()*.5,t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(xc[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),xc[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),xc[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),xc[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),xc[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),xc[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),xc[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),xc[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(xc),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},xc=[new N,new N,new N,new N,new N,new N,new N,new N],Sd=new N,OP=new Vi,Np=new N,Up=new N,kp=new N,Ru=new N,Lu=new N,bd=new N,f0=new N,Xw=new N,Yw=new N,Ad=new N;function FP(t,e,n,i,r){for(let s=0,o=t.length-3;s<=o;s+=3){Ad.fromArray(t,s);let a=r.x*Math.abs(Ad.x)+r.y*Math.abs(Ad.y)+r.z*Math.abs(Ad.z),l=e.dot(Ad),c=n.dot(Ad),h=i.dot(Ad);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>a)return!1}return!0}var mxe=new Vi,p0=new N,NP=new N,la=class{constructor(t=new N,e=-1){this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){let n=this.center;e!==void 0?n.copy(e):mxe.setFromPoints(t).getCenter(n);let i=0;for(let r=0,s=t.length;r<s;r++)i=Math.max(i,n.distanceToSquared(t[r]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){let e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){let n=this.center.distanceToSquared(t);return e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;p0.subVectors(t,this.center);let e=p0.lengthSq();if(e>this.radius*this.radius){let n=Math.sqrt(e),i=(n-this.radius)*.5;this.center.addScaledVector(p0,i/n),this.radius+=i}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(NP.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(p0.copy(t.center).add(NP)),this.expandByPoint(p0.copy(t.center).sub(NP))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}},_c=new N,UP=new N,qw=new N,Iu=new N,kP=new N,Qw=new N,zP=new N,uv=class{constructor(t=new N,e=new N(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,_c)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);let n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){let e=_c.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(_c.copy(this.direction).multiplyScalar(e).add(this.origin),_c.distanceToSquared(t))}distanceSqToSegment(t,e,n,i){UP.copy(t).add(e).multiplyScalar(.5),qw.copy(e).sub(t).normalize(),Iu.copy(this.origin).sub(UP);let r=t.distanceTo(e)*.5,s=-this.direction.dot(qw),o=Iu.dot(this.direction),a=-Iu.dot(qw),l=Iu.lengthSq(),c=Math.abs(1-s*s),h,u,d,f;if(c>0)if(h=s*a-o,u=s*o-a,f=r*c,h>=0)if(u>=-f)if(u<=f){let p=1/c;h*=p,u*=p,d=h*(h+s*u+2*o)+u*(s*h+u+2*a)+l}else u=r,h=Math.max(0,-(s*u+o)),d=-h*h+u*(u+2*a)+l;else u=-r,h=Math.max(0,-(s*u+o)),d=-h*h+u*(u+2*a)+l;else u<=-f?(h=Math.max(0,-(-s*r+o)),u=h>0?-r:Math.min(Math.max(-r,-a),r),d=-h*h+u*(u+2*a)+l):u<=f?(h=0,u=Math.min(Math.max(-r,-a),r),d=u*(u+2*a)+l):(h=Math.max(0,-(s*r+o)),u=h>0?r:Math.min(Math.max(-r,-a),r),d=-h*h+u*(u+2*a)+l);else u=s>0?-r:r,h=Math.max(0,-(s*u+o)),d=-h*h+u*(u+2*a)+l;return n&&n.copy(this.direction).multiplyScalar(h).add(this.origin),i&&i.copy(qw).multiplyScalar(u).add(UP),d}intersectSphere(t,e){_c.subVectors(t.center,this.origin);let n=_c.dot(this.direction),i=_c.dot(_c)-n*n,r=t.radius*t.radius;if(i>r)return null;let s=Math.sqrt(r-i),o=n-s,a=n+s;return o<0&&a<0?null:o<0?this.at(a,e):this.at(o,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){let e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;let n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null}intersectPlane(t,e){let n=this.distanceToPlane(t);return n===null?null:this.at(n,e)}intersectsPlane(t){let e=t.distanceToPoint(this.origin);return e===0||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let n,i,r,s,o,a,l=1/this.direction.x,c=1/this.direction.y,h=1/this.direction.z,u=this.origin;return l>=0?(n=(t.min.x-u.x)*l,i=(t.max.x-u.x)*l):(n=(t.max.x-u.x)*l,i=(t.min.x-u.x)*l),c>=0?(r=(t.min.y-u.y)*c,s=(t.max.y-u.y)*c):(r=(t.max.y-u.y)*c,s=(t.min.y-u.y)*c),n>s||r>i||((r>n||isNaN(n))&&(n=r),(s<i||isNaN(i))&&(i=s),h>=0?(o=(t.min.z-u.z)*h,a=(t.max.z-u.z)*h):(o=(t.max.z-u.z)*h,a=(t.min.z-u.z)*h),n>a||o>i)||((o>n||n!==n)&&(n=o),(a<i||i!==i)&&(i=a),i<0)?null:this.at(n>=0?n:i,e)}intersectsBox(t){return this.intersectBox(t,_c)!==null}intersectTriangle(t,e,n,i,r){kP.subVectors(e,t),Qw.subVectors(n,t),zP.crossVectors(kP,Qw);let s=this.direction.dot(zP),o;if(s>0){if(i)return null;o=1}else if(s<0)o=-1,s=-s;else return null;Iu.subVectors(this.origin,t);let a=o*this.direction.dot(Qw.crossVectors(Iu,Qw));if(a<0)return null;let l=o*this.direction.dot(kP.cross(Iu));if(l<0||a+l>s)return null;let c=-o*Iu.dot(zP);return c<0?null:this.at(c/s,r)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},nt=class{constructor(){nt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,n,i,r,s,o,a,l,c,h,u,d,f,p,v,g){let m=this.elements;return m[0]=e,m[4]=n,m[8]=i,m[12]=r,m[1]=s,m[5]=o,m[9]=a,m[13]=l,m[2]=c,m[6]=h,m[10]=u,m[14]=d,m[3]=f,m[7]=p,m[11]=v,m[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new nt().fromArray(this.elements)}copy(e){let n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){let n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){let n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){let n=this.elements,i=e.elements,r=1/zp.setFromMatrixColumn(e,0).length(),s=1/zp.setFromMatrixColumn(e,1).length(),o=1/zp.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[3]=0,n[4]=i[4]*s,n[5]=i[5]*s,n[6]=i[6]*s,n[7]=0,n[8]=i[8]*o,n[9]=i[9]*o,n[10]=i[10]*o,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){let n=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),l=Math.cos(r),c=Math.sin(r),h=Math.cos(s),u=Math.sin(s);if(e.order==="XYZ"){let d=o*h,f=o*u,p=a*h,v=a*u;n[0]=l*h,n[4]=-l*u,n[8]=c,n[1]=f+p*c,n[5]=d-v*c,n[9]=-a*l,n[2]=v-d*c,n[6]=p+f*c,n[10]=o*l}else if(e.order==="YXZ"){let d=l*h,f=l*u,p=c*h,v=c*u;n[0]=d+v*a,n[4]=p*a-f,n[8]=o*c,n[1]=o*u,n[5]=o*h,n[9]=-a,n[2]=f*a-p,n[6]=v+d*a,n[10]=o*l}else if(e.order==="ZXY"){let d=l*h,f=l*u,p=c*h,v=c*u;n[0]=d-v*a,n[4]=-o*u,n[8]=p+f*a,n[1]=f+p*a,n[5]=o*h,n[9]=v-d*a,n[2]=-o*c,n[6]=a,n[10]=o*l}else if(e.order==="ZYX"){let d=o*h,f=o*u,p=a*h,v=a*u;n[0]=l*h,n[4]=p*c-f,n[8]=d*c+v,n[1]=l*u,n[5]=v*c+d,n[9]=f*c-p,n[2]=-c,n[6]=a*l,n[10]=o*l}else if(e.order==="YZX"){let d=o*l,f=o*c,p=a*l,v=a*c;n[0]=l*h,n[4]=v-d*u,n[8]=p*u+f,n[1]=u,n[5]=o*h,n[9]=-a*h,n[2]=-c*h,n[6]=f*u+p,n[10]=d-v*u}else if(e.order==="XZY"){let d=o*l,f=o*c,p=a*l,v=a*c;n[0]=l*h,n[4]=-u,n[8]=c*h,n[1]=d*u+v,n[5]=o*h,n[9]=f*u-p,n[2]=p*u-f,n[6]=a*h,n[10]=v*u+d}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(gxe,e,vxe)}lookAt(e,n,i){let r=this.elements;return qs.subVectors(e,n),qs.lengthSq()===0&&(qs.z=1),qs.normalize(),Bu.crossVectors(i,qs),Bu.lengthSq()===0&&(Math.abs(i.z)===1?qs.x+=1e-4:qs.z+=1e-4,qs.normalize(),Bu.crossVectors(i,qs)),Bu.normalize(),Kw.crossVectors(qs,Bu),r[0]=Bu.x,r[4]=Kw.x,r[8]=qs.x,r[1]=Bu.y,r[5]=Kw.y,r[9]=qs.y,r[2]=Bu.z,r[6]=Kw.z,r[10]=qs.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){let i=e.elements,r=n.elements,s=this.elements,o=i[0],a=i[4],l=i[8],c=i[12],h=i[1],u=i[5],d=i[9],f=i[13],p=i[2],v=i[6],g=i[10],m=i[14],y=i[3],_=i[7],S=i[11],A=i[15],b=r[0],T=r[4],M=r[8],E=r[12],P=r[1],R=r[5],F=r[9],B=r[13],k=r[2],j=r[6],Z=r[10],ee=r[14],O=r[3],W=r[7],H=r[11],Y=r[15];return s[0]=o*b+a*P+l*k+c*O,s[4]=o*T+a*R+l*j+c*W,s[8]=o*M+a*F+l*Z+c*H,s[12]=o*E+a*B+l*ee+c*Y,s[1]=h*b+u*P+d*k+f*O,s[5]=h*T+u*R+d*j+f*W,s[9]=h*M+u*F+d*Z+f*H,s[13]=h*E+u*B+d*ee+f*Y,s[2]=p*b+v*P+g*k+m*O,s[6]=p*T+v*R+g*j+m*W,s[10]=p*M+v*F+g*Z+m*H,s[14]=p*E+v*B+g*ee+m*Y,s[3]=y*b+_*P+S*k+A*O,s[7]=y*T+_*R+S*j+A*W,s[11]=y*M+_*F+S*Z+A*H,s[15]=y*E+_*B+S*ee+A*Y,this}multiplyScalar(e){let n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){let e=this.elements,n=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],l=e[9],c=e[13],h=e[2],u=e[6],d=e[10],f=e[14],p=e[3],v=e[7],g=e[11],m=e[15];return p*(+s*l*u-r*c*u-s*a*d+i*c*d+r*a*f-i*l*f)+v*(+n*l*f-n*c*d+s*o*d-r*o*f+r*c*h-s*l*h)+g*(+n*c*u-n*a*f-s*o*u+i*o*f+s*a*h-i*c*h)+m*(-r*a*h-n*l*u+n*a*d+r*o*u-i*o*d+i*l*h)}transpose(){let e=this.elements,n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){let r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=n,r[14]=i),this}invert(){let e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],l=e[6],c=e[7],h=e[8],u=e[9],d=e[10],f=e[11],p=e[12],v=e[13],g=e[14],m=e[15],y=u*g*c-v*d*c+v*l*f-a*g*f-u*l*m+a*d*m,_=p*d*c-h*g*c-p*l*f+o*g*f+h*l*m-o*d*m,S=h*v*c-p*u*c+p*a*f-o*v*f-h*a*m+o*u*m,A=p*u*l-h*v*l-p*a*d+o*v*d+h*a*g-o*u*g,b=n*y+i*_+r*S+s*A;if(b===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let T=1/b;return e[0]=y*T,e[1]=(v*d*s-u*g*s-v*r*f+i*g*f+u*r*m-i*d*m)*T,e[2]=(a*g*s-v*l*s+v*r*c-i*g*c-a*r*m+i*l*m)*T,e[3]=(u*l*s-a*d*s-u*r*c+i*d*c+a*r*f-i*l*f)*T,e[4]=_*T,e[5]=(h*g*s-p*d*s+p*r*f-n*g*f-h*r*m+n*d*m)*T,e[6]=(p*l*s-o*g*s-p*r*c+n*g*c+o*r*m-n*l*m)*T,e[7]=(o*d*s-h*l*s+h*r*c-n*d*c-o*r*f+n*l*f)*T,e[8]=S*T,e[9]=(p*u*s-h*v*s-p*i*f+n*v*f+h*i*m-n*u*m)*T,e[10]=(o*v*s-p*a*s+p*i*c-n*v*c-o*i*m+n*a*m)*T,e[11]=(h*a*s-o*u*s-h*i*c+n*u*c+o*i*f-n*a*f)*T,e[12]=A*T,e[13]=(h*v*r-p*u*r+p*i*d-n*v*d-h*i*g+n*u*g)*T,e[14]=(p*a*r-o*v*r-p*i*l+n*v*l+o*i*g-n*a*g)*T,e[15]=(o*u*r-h*a*r+h*i*l-n*u*l-o*i*d+n*a*d)*T,this}scale(e){let n=this.elements,i=e.x,r=e.y,s=e.z;return n[0]*=i,n[4]*=r,n[8]*=s,n[1]*=i,n[5]*=r,n[9]*=s,n[2]*=i,n[6]*=r,n[10]*=s,n[3]*=i,n[7]*=r,n[11]*=s,this}getMaxScaleOnAxis(){let e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,r))}makeTranslation(e,n,i){return this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){let n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){let n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){let n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){let i=Math.cos(n),r=Math.sin(n),s=1-i,o=e.x,a=e.y,l=e.z,c=s*o,h=s*a;return this.set(c*o+i,c*a-r*l,c*l+r*a,0,c*a+r*l,h*a+i,h*l-r*o,0,c*l-r*a,h*l+r*o,s*l*l+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,n,r,1,0,0,0,0,1),this}compose(e,n,i){let r=this.elements,s=n._x,o=n._y,a=n._z,l=n._w,c=s+s,h=o+o,u=a+a,d=s*c,f=s*h,p=s*u,v=o*h,g=o*u,m=a*u,y=l*c,_=l*h,S=l*u,A=i.x,b=i.y,T=i.z;return r[0]=(1-(v+m))*A,r[1]=(f+S)*A,r[2]=(p-_)*A,r[3]=0,r[4]=(f-S)*b,r[5]=(1-(d+m))*b,r[6]=(g+y)*b,r[7]=0,r[8]=(p+_)*T,r[9]=(g-y)*T,r[10]=(1-(d+v))*T,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,n,i){let r=this.elements,s=zp.set(r[0],r[1],r[2]).length(),o=zp.set(r[4],r[5],r[6]).length(),a=zp.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],ba.copy(this);let l=1/s,c=1/o,h=1/a;return ba.elements[0]*=l,ba.elements[1]*=l,ba.elements[2]*=l,ba.elements[4]*=c,ba.elements[5]*=c,ba.elements[6]*=c,ba.elements[8]*=h,ba.elements[9]*=h,ba.elements[10]*=h,n.setFromRotationMatrix(ba),i.x=s,i.y=o,i.z=a,this}makePerspective(e,n,i,r,s,o){let a=this.elements,l=2*s/(n-e),c=2*s/(i-r),h=(n+e)/(n-e),u=(i+r)/(i-r),d=-(o+s)/(o-s),f=-2*o*s/(o-s);return a[0]=l,a[4]=0,a[8]=h,a[12]=0,a[1]=0,a[5]=c,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=d,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,n,i,r,s,o){let a=this.elements,l=1/(n-e),c=1/(i-r),h=1/(o-s),u=(n+e)*l,d=(i+r)*c,f=(o+s)*h;return a[0]=2*l,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-d,a[2]=0,a[6]=0,a[10]=-2*h,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){let n=this.elements,i=e.elements;for(let r=0;r<16;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){let i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}},zp=new N,ba=new nt,gxe=new N(0,0,0),vxe=new N(1,1,1),Bu=new N,Kw=new N,qs=new N,UH=new nt,kH=new on,Tr=class{constructor(t=0,e=0,n=0,i=Tr.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=n,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,n,i=this._order){return this._x=t,this._y=e,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,n=!0){let i=t.elements,r=i[0],s=i[4],o=i[8],a=i[1],l=i[5],c=i[9],h=i[2],u=i[6],d=i[10];switch(e){case"XYZ":this._y=Math.asin(Ki(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(u,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Ki(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,d),this._z=Math.atan2(a,l)):(this._y=Math.atan2(-h,r),this._z=0);break;case"ZXY":this._x=Math.asin(Ki(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(a,r));break;case"ZYX":this._y=Math.asin(-Ki(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(u,d),this._z=Math.atan2(a,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(Ki(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-h,r)):(this._x=0,this._y=Math.atan2(o,d));break;case"XZY":this._z=Math.asin(-Ki(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(u,l),this._y=Math.atan2(o,r)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,n===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,n){return UH.makeRotationFromQuaternion(t),this.setFromRotationMatrix(UH,e,n)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return kH.setFromEuler(this),this.setFromQuaternion(kH,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};Tr.DEFAULT_ORDER="XYZ";var vO=class{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}},yxe=0,zH=new N,Gp=new on,wc=new nt,Jw=new N,m0=new N,xxe=new N,_xe=new on,GH=new N(1,0,0),HH=new N(0,1,0),VH=new N(0,0,1),wxe={type:"added"},jH={type:"removed"},Fn=class extends ys{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:yxe++}),this.uuid=jl(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Fn.DEFAULT_UP.clone();let t=new N,e=new Tr,n=new on,i=new N(1,1,1);function r(){n.setFromEuler(e,!1)}function s(){e.setFromQuaternion(n,void 0,!1)}e._onChange(r),n._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new nt},normalMatrix:{value:new Pr}}),this.matrix=new nt,this.matrixWorld=new nt,this.matrixAutoUpdate=Fn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=Fn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new vO,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Gp.setFromAxisAngle(t,e),this.quaternion.multiply(Gp),this}rotateOnWorldAxis(t,e){return Gp.setFromAxisAngle(t,e),this.quaternion.premultiply(Gp),this}rotateX(t){return this.rotateOnAxis(GH,t)}rotateY(t){return this.rotateOnAxis(HH,t)}rotateZ(t){return this.rotateOnAxis(VH,t)}translateOnAxis(t,e){return zH.copy(t).applyQuaternion(this.quaternion),this.position.add(zH.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(GH,t)}translateY(t){return this.translateOnAxis(HH,t)}translateZ(t){return this.translateOnAxis(VH,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(wc.copy(this.matrixWorld).invert())}lookAt(t,e,n){t.isVector3?Jw.copy(t):Jw.set(t,e,n);let i=this.parent;this.updateWorldMatrix(!0,!1),m0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?wc.lookAt(m0,Jw,this.up):wc.lookAt(Jw,m0,this.up),this.quaternion.setFromRotationMatrix(wc),i&&(wc.extractRotation(i.matrixWorld),Gp.setFromRotationMatrix(wc),this.quaternion.premultiply(Gp.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(wxe)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}let e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(jH)),this}removeFromParent(){let t=this.parent;return t!==null&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){let e=this.children[t];e.parent=null,e.dispatchEvent(jH)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),wc.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),wc.multiply(t.parent.matrixWorld)),t.applyMatrix4(wc),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let n=0,i=this.children.length;n<i;n++){let r=this.children[n].getObjectByProperty(t,e);if(r!==void 0)return r}}getObjectsByProperty(t,e){let n=[];this[t]===e&&n.push(this);for(let i=0,r=this.children.length;i<r;i++){let s=this.children[i].getObjectsByProperty(t,e);s.length>0&&(n=n.concat(s))}return n}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(m0,t,xxe),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(m0,_xe,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);let e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);let e=this.children;for(let n=0,i=e.length;n<i;n++)e[n].traverseVisible(t)}traverseAncestors(t){let e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);let e=this.children;for(let n=0,i=e.length;n<i;n++){let r=e[n];(r.matrixWorldAutoUpdate===!0||t===!0)&&r.updateMatrixWorld(t)}}updateWorldMatrix(t,e){let n=this.parent;if(t===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e===!0){let i=this.children;for(let r=0,s=i.length;r<s;r++){let o=i[r];o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!1,!0)}}}toJSON(t){let e=t===void 0||typeof t=="string",n={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function r(o,a){return o[a.uuid]===void 0&&(o[a.uuid]=a.toJSON(t)),a.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(t.geometries,this.geometry);let o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){let a=o.shapes;if(Array.isArray(a))for(let l=0,c=a.length;l<c;l++){let h=a[l];r(t.shapes,h)}else r(t.shapes,a)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let o=[];for(let a=0,l=this.material.length;a<l;a++)o.push(r(t.materials,this.material[a]));i.material=o}else i.material=r(t.materials,this.material);if(this.children.length>0){i.children=[];for(let o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let o=0;o<this.animations.length;o++){let a=this.animations[o];i.animations.push(r(t.animations,a))}}if(e){let o=s(t.geometries),a=s(t.materials),l=s(t.textures),c=s(t.images),h=s(t.shapes),u=s(t.skeletons),d=s(t.animations),f=s(t.nodes);o.length>0&&(n.geometries=o),a.length>0&&(n.materials=a),l.length>0&&(n.textures=l),c.length>0&&(n.images=c),h.length>0&&(n.shapes=h),u.length>0&&(n.skeletons=u),d.length>0&&(n.animations=d),f.length>0&&(n.nodes=f)}return n.object=i,n;function s(o){let a=[];for(let l in o){let c=o[l];delete c.metadata,a.push(c)}return a}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let n=0;n<t.children.length;n++){let i=t.children[n];this.add(i.clone())}return this}};Fn.DEFAULT_UP=new N(0,1,0);Fn.DEFAULT_MATRIX_AUTO_UPDATE=!0;Fn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var Aa=new N,Sc=new N,GP=new N,bc=new N,Hp=new N,Vp=new N,WH=new N,HP=new N,VP=new N,jP=new N,Cs=class{constructor(t=new N,e=new N,n=new N){this.a=t,this.b=e,this.c=n}static getNormal(t,e,n,i){i.subVectors(n,e),Aa.subVectors(t,e),i.cross(Aa);let r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)}static getBarycoord(t,e,n,i,r){Aa.subVectors(i,e),Sc.subVectors(n,e),GP.subVectors(t,e);let s=Aa.dot(Aa),o=Aa.dot(Sc),a=Aa.dot(GP),l=Sc.dot(Sc),c=Sc.dot(GP),h=s*l-o*o;if(h===0)return r.set(-2,-1,-1);let u=1/h,d=(l*a-o*c)*u,f=(s*c-o*a)*u;return r.set(1-d-f,f,d)}static containsPoint(t,e,n,i){return this.getBarycoord(t,e,n,i,bc),bc.x>=0&&bc.y>=0&&bc.x+bc.y<=1}static getUV(t,e,n,i,r,s,o,a){return this.getBarycoord(t,e,n,i,bc),a.set(0,0),a.addScaledVector(r,bc.x),a.addScaledVector(s,bc.y),a.addScaledVector(o,bc.z),a}static isFrontFacing(t,e,n,i){return Aa.subVectors(n,e),Sc.subVectors(t,e),Aa.cross(Sc).dot(i)<0}set(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this}setFromPointsAndIndices(t,e,n,i){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,e,n,i){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,i),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return Aa.subVectors(this.c,this.b),Sc.subVectors(this.a,this.b),Aa.cross(Sc).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Cs.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return Cs.getBarycoord(t,this.a,this.b,this.c,e)}getUV(t,e,n,i,r){return Cs.getUV(t,this.a,this.b,this.c,e,n,i,r)}containsPoint(t){return Cs.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Cs.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){let n=this.a,i=this.b,r=this.c,s,o;Hp.subVectors(i,n),Vp.subVectors(r,n),HP.subVectors(t,n);let a=Hp.dot(HP),l=Vp.dot(HP);if(a<=0&&l<=0)return e.copy(n);VP.subVectors(t,i);let c=Hp.dot(VP),h=Vp.dot(VP);if(c>=0&&h<=c)return e.copy(i);let u=a*h-c*l;if(u<=0&&a>=0&&c<=0)return s=a/(a-c),e.copy(n).addScaledVector(Hp,s);jP.subVectors(t,r);let d=Hp.dot(jP),f=Vp.dot(jP);if(f>=0&&d<=f)return e.copy(r);let p=d*l-a*f;if(p<=0&&l>=0&&f<=0)return o=l/(l-f),e.copy(n).addScaledVector(Vp,o);let v=c*f-d*h;if(v<=0&&h-c>=0&&d-f>=0)return WH.subVectors(r,i),o=(h-c)/(h-c+(d-f)),e.copy(i).addScaledVector(WH,o);let g=1/(v+p+u);return s=p*g,o=u*g,e.copy(n).addScaledVector(Hp,s).addScaledVector(Vp,o)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},Sxe=0,M1=class extends ys{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Sxe++}),this.uuid=jl(),this.name="",this.type="Material",this.blending=og,this.side=Ka,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=dQ,this.blendDst=fQ,this.blendEquation=dm,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=SL,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Jye,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=PP,this.stencilZFail=PP,this.stencilZPass=PP,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(let e in t){let n=t[e];if(n===void 0){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}let i=this[e];if(i===void 0){console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.");continue}i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[e]=n}}toJSON(t){let e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});let n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==og&&(n.blending=this.blending),this.side!==Ka&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(n.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function i(r){let s=[];for(let o in r){let a=r[o];delete a.metadata,s.push(a)}return s}if(e){let r=i(t.textures),s=i(t.images);r.length>0&&(n.textures=r),s.length>0&&(n.images=s)}return n}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;let e=t.clippingPlanes,n=null;if(e!==null){let i=e.length;n=new Array(i);for(let r=0;r!==i;++r)n[r]=e[r].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}},E1=class extends M1{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Rt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=pQ,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}},Oi=new N,Zw=new Se,Ut=class{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=EL,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=n.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)Zw.fromBufferAttribute(this,n),Zw.applyMatrix3(e),this.setXY(n,Zw.x,Zw.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)Oi.fromBufferAttribute(this,n),Oi.applyMatrix3(e),this.setXYZ(n,Oi.x,Oi.y,Oi.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)Oi.fromBufferAttribute(this,n),Oi.applyMatrix4(e),this.setXYZ(n,Oi.x,Oi.y,Oi.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)Oi.fromBufferAttribute(this,n),Oi.applyNormalMatrix(e),this.setXYZ(n,Oi.x,Oi.y,Oi.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)Oi.fromBufferAttribute(this,n),Oi.transformDirection(e),this.setXYZ(n,Oi.x,Oi.y,Oi.z);return this}set(e,n=0){return this.array.set(e,n),this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=Gc(n,this.array)),n}setX(e,n){return this.normalized&&(n=kn(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=Gc(n,this.array)),n}setY(e,n){return this.normalized&&(n=kn(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=Gc(n,this.array)),n}setZ(e,n){return this.normalized&&(n=kn(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=Gc(n,this.array)),n}setW(e,n){return this.normalized&&(n=kn(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=kn(n,this.array),i=kn(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=kn(n,this.array),i=kn(i,this.array),r=kn(r,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=kn(n,this.array),i=kn(i,this.array),r=kn(r,this.array),s=kn(s,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==EL&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},bQ=class extends Ut{constructor(t,e,n){super(new Uint16Array(t),e,n)}},Ey=class extends Ut{constructor(t,e,n){super(new Uint32Array(t),e,n)}},bxe=class extends Ut{constructor(t,e,n){super(new Uint16Array(t),e,n),this.isFloat16BufferAttribute=!0}},ft=class extends Ut{constructor(e,n,i){super(new Float32Array(e),n,i)}},Axe=0,No=new nt,WP=new Fn,jp=new N,Qs=new Vi,g0=new Vi,hr=new N,Lt=class extends ys{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Axe++}),this.uuid=jl(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(yQ(e)?Ey:bQ)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){let n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let s=new Pr().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}let r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return No.makeRotationFromQuaternion(e),this.applyMatrix4(No),this}rotateX(e){return No.makeRotationX(e),this.applyMatrix4(No),this}rotateY(e){return No.makeRotationY(e),this.applyMatrix4(No),this}rotateZ(e){return No.makeRotationZ(e),this.applyMatrix4(No),this}translate(e,n,i){return No.makeTranslation(e,n,i),this.applyMatrix4(No),this}scale(e,n,i){return No.makeScale(e,n,i),this.applyMatrix4(No),this}lookAt(e){return WP.lookAt(e),WP.updateMatrix(),this.applyMatrix4(WP.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(jp).negate(),this.translate(jp.x,jp.y,jp.z),this}setFromPoints(e){let n=[];for(let i=0,r=e.length;i<r;i++){let s=e[i];n.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new ft(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Vi);let e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new N(-1/0,-1/0,-1/0),new N(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,r=n.length;i<r;i++){let s=n[i];Qs.setFromBufferAttribute(s),this.morphTargetsRelative?(hr.addVectors(this.boundingBox.min,Qs.min),this.boundingBox.expandByPoint(hr),hr.addVectors(this.boundingBox.max,Qs.max),this.boundingBox.expandByPoint(hr)):(this.boundingBox.expandByPoint(Qs.min),this.boundingBox.expandByPoint(Qs.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new la);let e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new N,1/0);return}if(e){let i=this.boundingSphere.center;if(Qs.setFromBufferAttribute(e),n)for(let s=0,o=n.length;s<o;s++){let a=n[s];g0.setFromBufferAttribute(a),this.morphTargetsRelative?(hr.addVectors(Qs.min,g0.min),Qs.expandByPoint(hr),hr.addVectors(Qs.max,g0.max),Qs.expandByPoint(hr)):(Qs.expandByPoint(g0.min),Qs.expandByPoint(g0.max))}Qs.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)hr.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(hr));if(n)for(let s=0,o=n.length;s<o;s++){let a=n[s],l=this.morphTargetsRelative;for(let c=0,h=a.count;c<h;c++)hr.fromBufferAttribute(a,c),l&&(jp.fromBufferAttribute(e,c),hr.add(jp)),r=Math.max(r,i.distanceToSquared(hr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=e.array,r=n.position.array,s=n.normal.array,o=n.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ut(new Float32Array(4*a),4));let l=this.getAttribute("tangent").array,c=[],h=[];for(let P=0;P<a;P++)c[P]=new N,h[P]=new N;let u=new N,d=new N,f=new N,p=new Se,v=new Se,g=new Se,m=new N,y=new N;function _(P,R,F){u.fromArray(r,P*3),d.fromArray(r,R*3),f.fromArray(r,F*3),p.fromArray(o,P*2),v.fromArray(o,R*2),g.fromArray(o,F*2),d.sub(u),f.sub(u),v.sub(p),g.sub(p);let B=1/(v.x*g.y-g.x*v.y);!isFinite(B)||(m.copy(d).multiplyScalar(g.y).addScaledVector(f,-v.y).multiplyScalar(B),y.copy(f).multiplyScalar(v.x).addScaledVector(d,-g.x).multiplyScalar(B),c[P].add(m),c[R].add(m),c[F].add(m),h[P].add(y),h[R].add(y),h[F].add(y))}let S=this.groups;S.length===0&&(S=[{start:0,count:i.length}]);for(let P=0,R=S.length;P<R;++P){let F=S[P],B=F.start,k=F.count;for(let j=B,Z=B+k;j<Z;j+=3)_(i[j+0],i[j+1],i[j+2])}let A=new N,b=new N,T=new N,M=new N;function E(P){T.fromArray(s,P*3),M.copy(T);let R=c[P];A.copy(R),A.sub(T.multiplyScalar(T.dot(R))).normalize(),b.crossVectors(M,R);let F=b.dot(h[P])<0?-1:1;l[P*4]=A.x,l[P*4+1]=A.y,l[P*4+2]=A.z,l[P*4+3]=F}for(let P=0,R=S.length;P<R;++P){let F=S[P],B=F.start,k=F.count;for(let j=B,Z=B+k;j<Z;j+=3)E(i[j+0]),E(i[j+1]),E(i[j+2])}}computeVertexNormals(){let e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Ut(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let d=0,f=i.count;d<f;d++)i.setXYZ(d,0,0,0);let r=new N,s=new N,o=new N,a=new N,l=new N,c=new N,h=new N,u=new N;if(e)for(let d=0,f=e.count;d<f;d+=3){let p=e.getX(d+0),v=e.getX(d+1),g=e.getX(d+2);r.fromBufferAttribute(n,p),s.fromBufferAttribute(n,v),o.fromBufferAttribute(n,g),h.subVectors(o,s),u.subVectors(r,s),h.cross(u),a.fromBufferAttribute(i,p),l.fromBufferAttribute(i,v),c.fromBufferAttribute(i,g),a.add(h),l.add(h),c.add(h),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(v,l.x,l.y,l.z),i.setXYZ(g,c.x,c.y,c.z)}else for(let d=0,f=n.count;d<f;d+=3)r.fromBufferAttribute(n,d+0),s.fromBufferAttribute(n,d+1),o.fromBufferAttribute(n,d+2),h.subVectors(o,s),u.subVectors(r,s),h.cross(u),i.setXYZ(d+0,h.x,h.y,h.z),i.setXYZ(d+1,h.x,h.y,h.z),i.setXYZ(d+2,h.x,h.y,h.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)hr.fromBufferAttribute(e,n),hr.normalize(),e.setXYZ(n,hr.x,hr.y,hr.z)}toNonIndexed(){function e(a,l){let c=a.array,h=a.itemSize,u=a.normalized,d=new c.constructor(l.length*h),f=0,p=0;for(let v=0,g=l.length;v<g;v++){a.isInterleavedBufferAttribute?f=l[v]*a.data.stride+a.offset:f=l[v]*h;for(let m=0;m<h;m++)d[p++]=c[f++]}return new Ut(d,h,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let n=new Lt,i=this.index.array,r=this.attributes;for(let a in r){let l=r[a],c=e(l,i);n.setAttribute(a,c)}let s=this.morphAttributes;for(let a in s){let l=[],c=s[a];for(let h=0,u=c.length;h<u;h++){let d=c[h],f=e(d,i);l.push(f)}n.morphAttributes[a]=l}n.morphTargetsRelative=this.morphTargetsRelative;let o=this.groups;for(let a=0,l=o.length;a<l;a++){let c=o[a];n.addGroup(c.start,c.count,c.materialIndex)}return n}toJSON(){let e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let l=this.parameters;for(let c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};let n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});let i=this.attributes;for(let l in i){let c=i[l];e.data.attributes[l]=c.toJSON(e.data)}let r={},s=!1;for(let l in this.morphAttributes){let c=this.morphAttributes[l],h=[];for(let u=0,d=c.length;u<d;u++){let f=c[u];h.push(f.toJSON(e.data))}h.length>0&&(r[l]=h,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);let o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));let a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let n={};this.name=e.name;let i=e.index;i!==null&&this.setIndex(i.clone(n));let r=e.attributes;for(let c in r){let h=r[c];this.setAttribute(c,h.clone(n))}let s=e.morphAttributes;for(let c in s){let h=[],u=s[c];for(let d=0,f=u.length;d<f;d++)h.push(u[d].clone(n));this.morphAttributes[c]=h}this.morphTargetsRelative=e.morphTargetsRelative;let o=e.groups;for(let c=0,h=o.length;c<h;c++){let u=o[c];this.addGroup(u.start,u.count,u.materialIndex)}let a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());let l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},XH=new nt,Wp=new uv,XP=new la,v0=new N,y0=new N,x0=new N,YP=new N,$w=new N,eS=new Se,tS=new Se,nS=new Se,qP=new N,iS=new N,ao=class extends Fn{constructor(t=new Lt,e=new E1){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){let t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){let n=t[e[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,r=n.length;i<r;i++){let s=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=i}}}}getVertexPosition(t,e){let n=this.geometry,i=n.attributes.position,r=n.morphAttributes.position,s=n.morphTargetsRelative;e.fromBufferAttribute(i,t);let o=this.morphTargetInfluences;if(r&&o){$w.set(0,0,0);for(let a=0,l=r.length;a<l;a++){let c=o[a],h=r[a];c!==0&&(YP.fromBufferAttribute(h,t),s?$w.addScaledVector(YP,c):$w.addScaledVector(YP.sub(e),c))}e.add($w)}return this.isSkinnedMesh&&this.boneTransform(t,e),e}raycast(t,e){let n=this.geometry,i=this.material,r=this.matrixWorld;if(i===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),XP.copy(n.boundingSphere),XP.applyMatrix4(r),t.ray.intersectsSphere(XP)===!1)||(XH.copy(r).invert(),Wp.copy(t.ray).applyMatrix4(XH),n.boundingBox!==null&&Wp.intersectsBox(n.boundingBox)===!1))return;let s,o=n.index,a=n.attributes.position,l=n.attributes.uv,c=n.attributes.uv2,h=n.groups,u=n.drawRange;if(o!==null)if(Array.isArray(i))for(let d=0,f=h.length;d<f;d++){let p=h[d],v=i[p.materialIndex],g=Math.max(p.start,u.start),m=Math.min(o.count,Math.min(p.start+p.count,u.start+u.count));for(let y=g,_=m;y<_;y+=3){let S=o.getX(y),A=o.getX(y+1),b=o.getX(y+2);s=rS(this,v,t,Wp,l,c,S,A,b),s&&(s.faceIndex=Math.floor(y/3),s.face.materialIndex=p.materialIndex,e.push(s))}}else{let d=Math.max(0,u.start),f=Math.min(o.count,u.start+u.count);for(let p=d,v=f;p<v;p+=3){let g=o.getX(p),m=o.getX(p+1),y=o.getX(p+2);s=rS(this,i,t,Wp,l,c,g,m,y),s&&(s.faceIndex=Math.floor(p/3),e.push(s))}}else if(a!==void 0)if(Array.isArray(i))for(let d=0,f=h.length;d<f;d++){let p=h[d],v=i[p.materialIndex],g=Math.max(p.start,u.start),m=Math.min(a.count,Math.min(p.start+p.count,u.start+u.count));for(let y=g,_=m;y<_;y+=3){let S=y,A=y+1,b=y+2;s=rS(this,v,t,Wp,l,c,S,A,b),s&&(s.faceIndex=Math.floor(y/3),s.face.materialIndex=p.materialIndex,e.push(s))}}else{let d=Math.max(0,u.start),f=Math.min(a.count,u.start+u.count);for(let p=d,v=f;p<v;p+=3){let g=p,m=p+1,y=p+2;s=rS(this,i,t,Wp,l,c,g,m,y),s&&(s.faceIndex=Math.floor(p/3),e.push(s))}}}};function Mxe(t,e,n,i,r,s,o,a){let l;if(e.side===vr?l=i.intersectTriangle(o,s,r,!0,a):l=i.intersectTriangle(r,s,o,e.side===Ka,a),l===null)return null;iS.copy(a),iS.applyMatrix4(t.matrixWorld);let c=n.ray.origin.distanceTo(iS);return c<n.near||c>n.far?null:{distance:c,point:iS.clone(),object:t}}function rS(t,e,n,i,r,s,o,a,l){t.getVertexPosition(o,v0),t.getVertexPosition(a,y0),t.getVertexPosition(l,x0);let c=Mxe(t,e,n,i,v0,y0,x0,qP);if(c){r&&(eS.fromBufferAttribute(r,o),tS.fromBufferAttribute(r,a),nS.fromBufferAttribute(r,l),c.uv=Cs.getUV(qP,v0,y0,x0,eS,tS,nS,new Se)),s&&(eS.fromBufferAttribute(s,o),tS.fromBufferAttribute(s,a),nS.fromBufferAttribute(s,l),c.uv2=Cs.getUV(qP,v0,y0,x0,eS,tS,nS,new Se));let h={a:o,b:a,c:l,normal:new N,materialIndex:0};Cs.getNormal(v0,y0,x0,h.normal),c.face=h}return c}var Zl=class extends Lt{constructor(t=1,e=1,n=1,i=1,r=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:i,heightSegments:r,depthSegments:s};let o=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s);let a=[],l=[],c=[],h=[],u=0,d=0;f("z","y","x",-1,-1,n,e,t,s,r,0),f("z","y","x",1,-1,n,e,-t,s,r,1),f("x","z","y",1,1,t,n,e,i,s,2),f("x","z","y",1,-1,t,n,-e,i,s,3),f("x","y","z",1,-1,t,e,n,i,r,4),f("x","y","z",-1,-1,t,e,-n,i,r,5),this.setIndex(a),this.setAttribute("position",new ft(l,3)),this.setAttribute("normal",new ft(c,3)),this.setAttribute("uv",new ft(h,2));function f(p,v,g,m,y,_,S,A,b,T,M){let E=_/b,P=S/T,R=_/2,F=S/2,B=A/2,k=b+1,j=T+1,Z=0,ee=0,O=new N;for(let W=0;W<j;W++){let H=W*P-F;for(let Y=0;Y<k;Y++){let z=Y*E-R;O[p]=z*m,O[v]=H*y,O[g]=B,l.push(O.x,O.y,O.z),O[p]=0,O[v]=0,O[g]=A>0?1:-1,c.push(O.x,O.y,O.z),h.push(Y/b),h.push(1-W/T),Z+=1}}for(let W=0;W<T;W++)for(let H=0;H<b;H++){let Y=u+H+k*W,z=u+H+k*(W+1),X=u+(H+1)+k*(W+1),q=u+(H+1)+k*W;a.push(Y,z,q),a.push(z,X,q),ee+=6}o.addGroup(d,ee,M),d+=ee,u+=Z}}static fromJSON(t){return new Zl(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}};function kg(t){let e={};for(let n in t){e[n]={};for(let i in t[n]){let r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function ls(t){let e={};for(let n=0;n<t.length;n++){let i=kg(t[n]);for(let r in i)e[r]=i[r]}return e}function Exe(t){let e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function AQ(t){return t.getRenderTarget()===null&&t.outputEncoding===Wt?Tl:wA}var hv={clone:kg,merge:ls},Cxe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Txe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,nr=class extends M1{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=Cxe,this.fragmentShader=Txe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=kg(t.uniforms),this.uniformsGroups=Exe(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){let e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(let i in this.uniforms){let r=this.uniforms[i].value;r&&r.isTexture?e.uniforms[i]={type:"t",value:r.toJSON(t).uuid}:r&&r.isColor?e.uniforms[i]={type:"c",value:r.getHex()}:r&&r.isVector2?e.uniforms[i]={type:"v2",value:r.toArray()}:r&&r.isVector3?e.uniforms[i]={type:"v3",value:r.toArray()}:r&&r.isVector4?e.uniforms[i]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?e.uniforms[i]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?e.uniforms[i]={type:"m4",value:r.toArray()}:e.uniforms[i]={value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;let n={};for(let i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(e.extensions=n),e}},dv=class extends Fn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new nt,this.projectionMatrix=new nt,this.projectionMatrixInverse=new nt}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);let e=this.matrixWorld.elements;return t.set(-e[8],-e[9],-e[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},Yr=class extends dv{constructor(t=50,e=1,n=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){let e=.5*this.getFilmHeight()/t;this.fov=Ax*2*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){let t=Math.tan(Ay*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return Ax*2*Math.atan(Math.tan(Ay*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,e,n,i,r,s){this.aspect=t/e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let t=this.near,e=t*Math.tan(Ay*.5*this.fov)/this.zoom,n=2*e,i=this.aspect*n,r=-.5*i,s=this.view;if(this.view!==null&&this.view.enabled){let a=s.fullWidth,l=s.fullHeight;r+=s.offsetX*i/a,e-=s.offsetY*n/l,i*=s.width/a,n*=s.height/l}let o=this.filmOffset;o!==0&&(r+=t*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,e,e-n,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){let e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}},Xp=-90,Yp=1,Pxe=class extends Fn{constructor(t,e,n){super(),this.type="CubeCamera",this.renderTarget=n;let i=new Yr(Xp,Yp,t,e);i.layers=this.layers,i.up.set(0,1,0),i.lookAt(1,0,0),this.add(i);let r=new Yr(Xp,Yp,t,e);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(-1,0,0),this.add(r);let s=new Yr(Xp,Yp,t,e);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);let o=new Yr(Xp,Yp,t,e);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(0,-1,0),this.add(o);let a=new Yr(Xp,Yp,t,e);a.layers=this.layers,a.up.set(0,1,0),a.lookAt(0,0,1),this.add(a);let l=new Yr(Xp,Yp,t,e);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(t,e){this.parent===null&&this.updateMatrixWorld();let n=this.renderTarget,[i,r,s,o,a,l]=this.children,c=t.getRenderTarget(),h=t.toneMapping,u=t.xr.enabled;t.toneMapping=qc,t.xr.enabled=!1;let d=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(e,i),t.setRenderTarget(n,1),t.render(e,r),t.setRenderTarget(n,2),t.render(e,s),t.setRenderTarget(n,3),t.render(e,o),t.setRenderTarget(n,4),t.render(e,a),n.texture.generateMipmaps=d,t.setRenderTarget(n,5),t.render(e,l),t.setRenderTarget(c),t.toneMapping=h,t.xr.enabled=u,n.texture.needsPMREMUpdate=!0}},yO=class extends _r{constructor(t,e,n,i,r,s,o,a,l,c){t=t!==void 0?t:[],e=e!==void 0?e:Rf,super(t,e,n,i,r,s,o,a,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}},Dxe=class extends $i{constructor(t=1,e={}){super(t,t,e),this.isWebGLCubeRenderTarget=!0;let n={width:t,height:t,depth:1},i=[n,n,n,n,n,n];this.texture=new yO(i,e.mapping,e.wrapS,e.wrapT,e.magFilter,e.minFilter,e.format,e.type,e.anisotropy,e.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=e.generateMipmaps!==void 0?e.generateMipmaps:!1,this.texture.minFilter=e.minFilter!==void 0?e.minFilter:En}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.encoding=e.encoding,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;let n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new Zl(5,5,5),r=new nr({name:"CubemapFromEquirect",uniforms:kg(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:vr,blending:Rr});r.uniforms.tEquirect.value=e;let s=new ao(i,r),o=e.minFilter;return e.minFilter===Ug&&(e.minFilter=En),new Pxe(1,10,this).update(t,s),e.minFilter=o,s.geometry.dispose(),s.material.dispose(),this}clear(t,e,n,i){let r=t.getRenderTarget();for(let s=0;s<6;s++)t.setRenderTarget(this,s),t.clear(e,n,i);t.setRenderTarget(r)}},QP=new N,Rxe=new N,Lxe=new Pr,$s=class{constructor(t=new N(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,n,i){return this.normal.set(t,e,n),this.constant=i,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,n){let i=QP.subVectors(n,e).cross(Rxe.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){let t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,e){let n=t.delta(QP),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(t.start)===0?e.copy(t.start):null;let r=-(t.start.dot(this.normal)+this.constant)/i;return r<0||r>1?null:e.copy(n).multiplyScalar(r).add(t.start)}intersectsLine(t){let e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){let n=e||Lxe.getNormalMatrix(t),i=this.coplanarPoint(QP).applyMatrix4(t),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}},qp=new la,sS=new N,xO=class{constructor(t=new $s,e=new $s,n=new $s,i=new $s,r=new $s,s=new $s){this.planes=[t,e,n,i,r,s]}set(t,e,n,i,r,s){let o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(n),o[3].copy(i),o[4].copy(r),o[5].copy(s),this}copy(t){let e=this.planes;for(let n=0;n<6;n++)e[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t){let e=this.planes,n=t.elements,i=n[0],r=n[1],s=n[2],o=n[3],a=n[4],l=n[5],c=n[6],h=n[7],u=n[8],d=n[9],f=n[10],p=n[11],v=n[12],g=n[13],m=n[14],y=n[15];return e[0].setComponents(o-i,h-a,p-u,y-v).normalize(),e[1].setComponents(o+i,h+a,p+u,y+v).normalize(),e[2].setComponents(o+r,h+l,p+d,y+g).normalize(),e[3].setComponents(o-r,h-l,p-d,y-g).normalize(),e[4].setComponents(o-s,h-c,p-f,y-m).normalize(),e[5].setComponents(o+s,h+c,p+f,y+m).normalize(),this}intersectsObject(t){let e=t.geometry;return e.boundingSphere===null&&e.computeBoundingSphere(),qp.copy(e.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(qp)}intersectsSprite(t){return qp.center.set(0,0,0),qp.radius=.7071067811865476,qp.applyMatrix4(t.matrixWorld),this.intersectsSphere(qp)}intersectsSphere(t){let e=this.planes,n=t.center,i=-t.radius;for(let r=0;r<6;r++)if(e[r].distanceToPoint(n)<i)return!1;return!0}intersectsBox(t){let e=this.planes;for(let n=0;n<6;n++){let i=e[n];if(sS.x=i.normal.x>0?t.max.x:t.min.x,sS.y=i.normal.y>0?t.max.y:t.min.y,sS.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(sS)<0)return!1}return!0}containsPoint(t){let e=this.planes;for(let n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function MQ(){let t=null,e=!1,n=null,i=null;function r(s,o){n(s,o),i=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&n!==null&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){n=s},setContext:function(s){t=s}}}function Ixe(t,e){let n=e.isWebGL2,i=new WeakMap;function r(c,h){let u=c.array,d=c.usage,f=t.createBuffer();t.bindBuffer(h,f),t.bufferData(h,u,d),c.onUploadCallback();let p;if(u instanceof Float32Array)p=5126;else if(u instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(n)p=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else p=5123;else if(u instanceof Int16Array)p=5122;else if(u instanceof Uint32Array)p=5125;else if(u instanceof Int32Array)p=5124;else if(u instanceof Int8Array)p=5120;else if(u instanceof Uint8Array)p=5121;else if(u instanceof Uint8ClampedArray)p=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:f,type:p,bytesPerElement:u.BYTES_PER_ELEMENT,version:c.version}}function s(c,h,u){let d=h.array,f=h.updateRange;t.bindBuffer(u,c),f.count===-1?t.bufferSubData(u,0,d):(n?t.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):t.bufferSubData(u,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1),h.onUploadCallback()}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)}function a(c){c.isInterleavedBufferAttribute&&(c=c.data);let h=i.get(c);h&&(t.deleteBuffer(h.buffer),i.delete(c))}function l(c,h){if(c.isGLBufferAttribute){let d=i.get(c);(!d||d.version<c.version)&&i.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);let u=i.get(c);u===void 0?i.set(c,r(c,h)):u.version<c.version&&(s(u.buffer,c,h),u.version=c.version)}return{get:o,remove:a,update:l}}var lE=class extends Lt{constructor(t=1,e=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:i};let r=t/2,s=e/2,o=Math.floor(n),a=Math.floor(i),l=o+1,c=a+1,h=t/o,u=e/a,d=[],f=[],p=[],v=[];for(let g=0;g<c;g++){let m=g*u-s;for(let y=0;y<l;y++){let _=y*h-r;f.push(_,-m,0),p.push(0,0,1),v.push(y/o),v.push(1-g/a)}}for(let g=0;g<a;g++)for(let m=0;m<o;m++){let y=m+l*g,_=m+l*(g+1),S=m+1+l*(g+1),A=m+1+l*g;d.push(y,_,A),d.push(_,S,A)}this.setIndex(d),this.setAttribute("position",new ft(f,3)),this.setAttribute("normal",new ft(p,3)),this.setAttribute("uv",new ft(v,2))}static fromJSON(t){return new lE(t.width,t.height,t.widthSegments,t.heightSegments)}},Bxe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,Oxe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Fxe=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,Nxe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Uxe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,kxe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,zxe="vec3 transformed = vec3( position );",Gxe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Hxe=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,Vxe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,jxe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Wxe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Xxe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Yxe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,qxe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Qxe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Kxe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Jxe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Zxe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,$xe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,e1e=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,t1e=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,n1e=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,i1e=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,r1e=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,s1e=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,o1e="gl_FragColor = linearToOutputTexel( gl_FragColor );",a1e=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,l1e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,c1e=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,u1e=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,h1e=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,d1e=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,f1e=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,p1e=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,m1e=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,g1e=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,v1e=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,y1e=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,x1e=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,_1e=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,w1e=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,S1e=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,b1e=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,A1e=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,M1e=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,E1e=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,C1e=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,T1e=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,P1e=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,D1e=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,R1e=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,L1e=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,I1e=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,B1e=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,O1e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,F1e=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,N1e=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,U1e=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,k1e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,z1e=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,G1e=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,H1e=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,V1e=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,j1e=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,W1e=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,X1e=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Y1e=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,q1e=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Q1e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,K1e=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,J1e=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Z1e=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,$1e=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,e_e=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,t_e=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,n_e=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,i_e=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,r_e=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,s_e=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,o_e=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,a_e=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,l_e=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,c_e=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,u_e=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,h_e=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,d_e=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,f_e=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,p_e=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,m_e=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,g_e=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,v_e=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,y_e=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,x_e=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,__e=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,w_e=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,S_e=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,b_e=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,A_e=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,M_e=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,E_e=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,C_e=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,T_e=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,P_e=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,D_e=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,R_e=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,L_e=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,I_e=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,B_e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,O_e=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,F_e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,N_e=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,U_e=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,k_e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,z_e=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,G_e=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,H_e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,V_e=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,j_e=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,W_e=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,X_e=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Y_e=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,q_e=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Q_e=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,K_e=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,J_e=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Z_e=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,$_e=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,ewe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,twe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,nwe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,iwe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rwe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,swe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,owe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,awe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,lwe=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,cwe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,uwe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,hwe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,jt={alphamap_fragment:Bxe,alphamap_pars_fragment:Oxe,alphatest_fragment:Fxe,alphatest_pars_fragment:Nxe,aomap_fragment:Uxe,aomap_pars_fragment:kxe,begin_vertex:zxe,beginnormal_vertex:Gxe,bsdfs:Hxe,iridescence_fragment:Vxe,bumpmap_pars_fragment:jxe,clipping_planes_fragment:Wxe,clipping_planes_pars_fragment:Xxe,clipping_planes_pars_vertex:Yxe,clipping_planes_vertex:qxe,color_fragment:Qxe,color_pars_fragment:Kxe,color_pars_vertex:Jxe,color_vertex:Zxe,common:$xe,cube_uv_reflection_fragment:e1e,defaultnormal_vertex:t1e,displacementmap_pars_vertex:n1e,displacementmap_vertex:i1e,emissivemap_fragment:r1e,emissivemap_pars_fragment:s1e,encodings_fragment:o1e,encodings_pars_fragment:a1e,envmap_fragment:l1e,envmap_common_pars_fragment:c1e,envmap_pars_fragment:u1e,envmap_pars_vertex:h1e,envmap_physical_pars_fragment:b1e,envmap_vertex:d1e,fog_vertex:f1e,fog_pars_vertex:p1e,fog_fragment:m1e,fog_pars_fragment:g1e,gradientmap_pars_fragment:v1e,lightmap_fragment:y1e,lightmap_pars_fragment:x1e,lights_lambert_fragment:_1e,lights_lambert_pars_fragment:w1e,lights_pars_begin:S1e,lights_toon_fragment:A1e,lights_toon_pars_fragment:M1e,lights_phong_fragment:E1e,lights_phong_pars_fragment:C1e,lights_physical_fragment:T1e,lights_physical_pars_fragment:P1e,lights_fragment_begin:D1e,lights_fragment_maps:R1e,lights_fragment_end:L1e,logdepthbuf_fragment:I1e,logdepthbuf_pars_fragment:B1e,logdepthbuf_pars_vertex:O1e,logdepthbuf_vertex:F1e,map_fragment:N1e,map_pars_fragment:U1e,map_particle_fragment:k1e,map_particle_pars_fragment:z1e,metalnessmap_fragment:G1e,metalnessmap_pars_fragment:H1e,morphcolor_vertex:V1e,morphnormal_vertex:j1e,morphtarget_pars_vertex:W1e,morphtarget_vertex:X1e,normal_fragment_begin:Y1e,normal_fragment_maps:q1e,normal_pars_fragment:Q1e,normal_pars_vertex:K1e,normal_vertex:J1e,normalmap_pars_fragment:Z1e,clearcoat_normal_fragment_begin:$1e,clearcoat_normal_fragment_maps:e_e,clearcoat_pars_fragment:t_e,iridescence_pars_fragment:n_e,output_fragment:i_e,packing:r_e,premultiplied_alpha_fragment:s_e,project_vertex:o_e,dithering_fragment:a_e,dithering_pars_fragment:l_e,roughnessmap_fragment:c_e,roughnessmap_pars_fragment:u_e,shadowmap_pars_fragment:h_e,shadowmap_pars_vertex:d_e,shadowmap_vertex:f_e,shadowmask_pars_fragment:p_e,skinbase_vertex:m_e,skinning_pars_vertex:g_e,skinning_vertex:v_e,skinnormal_vertex:y_e,specularmap_fragment:x_e,specularmap_pars_fragment:__e,tonemapping_fragment:w_e,tonemapping_pars_fragment:S_e,transmission_fragment:b_e,transmission_pars_fragment:A_e,uv_pars_fragment:M_e,uv_pars_vertex:E_e,uv_vertex:C_e,uv2_pars_fragment:T_e,uv2_pars_vertex:P_e,uv2_vertex:D_e,worldpos_vertex:R_e,background_vert:L_e,background_frag:I_e,backgroundCube_vert:B_e,backgroundCube_frag:O_e,cube_vert:F_e,cube_frag:N_e,depth_vert:U_e,depth_frag:k_e,distanceRGBA_vert:z_e,distanceRGBA_frag:G_e,equirect_vert:H_e,equirect_frag:V_e,linedashed_vert:j_e,linedashed_frag:W_e,meshbasic_vert:X_e,meshbasic_frag:Y_e,meshlambert_vert:q_e,meshlambert_frag:Q_e,meshmatcap_vert:K_e,meshmatcap_frag:J_e,meshnormal_vert:Z_e,meshnormal_frag:$_e,meshphong_vert:ewe,meshphong_frag:twe,meshphysical_vert:nwe,meshphysical_frag:iwe,meshtoon_vert:rwe,meshtoon_frag:swe,points_vert:owe,points_frag:awe,shadow_vert:lwe,shadow_frag:cwe,sprite_vert:uwe,sprite_frag:hwe},tt={common:{diffuse:{value:new Rt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Pr},uv2Transform:{value:new Pr},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Se(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Rt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Rt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Pr}},sprite:{diffuse:{value:new Rt(16777215)},opacity:{value:1},center:{value:new Se(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Pr}}},Pl={basic:{uniforms:ls([tt.common,tt.specularmap,tt.envmap,tt.aomap,tt.lightmap,tt.fog]),vertexShader:jt.meshbasic_vert,fragmentShader:jt.meshbasic_frag},lambert:{uniforms:ls([tt.common,tt.specularmap,tt.envmap,tt.aomap,tt.lightmap,tt.emissivemap,tt.bumpmap,tt.normalmap,tt.displacementmap,tt.fog,tt.lights,{emissive:{value:new Rt(0)}}]),vertexShader:jt.meshlambert_vert,fragmentShader:jt.meshlambert_frag},phong:{uniforms:ls([tt.common,tt.specularmap,tt.envmap,tt.aomap,tt.lightmap,tt.emissivemap,tt.bumpmap,tt.normalmap,tt.displacementmap,tt.fog,tt.lights,{emissive:{value:new Rt(0)},specular:{value:new Rt(1118481)},shininess:{value:30}}]),vertexShader:jt.meshphong_vert,fragmentShader:jt.meshphong_frag},standard:{uniforms:ls([tt.common,tt.envmap,tt.aomap,tt.lightmap,tt.emissivemap,tt.bumpmap,tt.normalmap,tt.displacementmap,tt.roughnessmap,tt.metalnessmap,tt.fog,tt.lights,{emissive:{value:new Rt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:jt.meshphysical_vert,fragmentShader:jt.meshphysical_frag},toon:{uniforms:ls([tt.common,tt.aomap,tt.lightmap,tt.emissivemap,tt.bumpmap,tt.normalmap,tt.displacementmap,tt.gradientmap,tt.fog,tt.lights,{emissive:{value:new Rt(0)}}]),vertexShader:jt.meshtoon_vert,fragmentShader:jt.meshtoon_frag},matcap:{uniforms:ls([tt.common,tt.bumpmap,tt.normalmap,tt.displacementmap,tt.fog,{matcap:{value:null}}]),vertexShader:jt.meshmatcap_vert,fragmentShader:jt.meshmatcap_frag},points:{uniforms:ls([tt.points,tt.fog]),vertexShader:jt.points_vert,fragmentShader:jt.points_frag},dashed:{uniforms:ls([tt.common,tt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:jt.linedashed_vert,fragmentShader:jt.linedashed_frag},depth:{uniforms:ls([tt.common,tt.displacementmap]),vertexShader:jt.depth_vert,fragmentShader:jt.depth_frag},normal:{uniforms:ls([tt.common,tt.bumpmap,tt.normalmap,tt.displacementmap,{opacity:{value:1}}]),vertexShader:jt.meshnormal_vert,fragmentShader:jt.meshnormal_frag},sprite:{uniforms:ls([tt.sprite,tt.fog]),vertexShader:jt.sprite_vert,fragmentShader:jt.sprite_frag},background:{uniforms:{uvTransform:{value:new Pr},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:jt.background_vert,fragmentShader:jt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:jt.backgroundCube_vert,fragmentShader:jt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:jt.cube_vert,fragmentShader:jt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:jt.equirect_vert,fragmentShader:jt.equirect_frag},distanceRGBA:{uniforms:ls([tt.common,tt.displacementmap,{referencePosition:{value:new N},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:jt.distanceRGBA_vert,fragmentShader:jt.distanceRGBA_frag},shadow:{uniforms:ls([tt.lights,tt.fog,{color:{value:new Rt(0)},opacity:{value:1}}]),vertexShader:jt.shadow_vert,fragmentShader:jt.shadow_frag}};Pl.physical={uniforms:ls([Pl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Se(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Rt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Se},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Rt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Rt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:jt.meshphysical_vert,fragmentShader:jt.meshphysical_frag};var oS={r:0,b:0,g:0};function dwe(t,e,n,i,r,s,o){let a=new Rt(0),l=s===!0?0:1,c,h,u=null,d=0,f=null;function p(g,m){let y=!1,_=m.isScene===!0?m.background:null;_&&_.isTexture&&(_=(m.backgroundBlurriness>0?n:e).get(_));let S=t.xr,A=S.getSession&&S.getSession();A&&A.environmentBlendMode==="additive"&&(_=null),_===null?v(a,l):_&&_.isColor&&(v(_,1),y=!0),(t.autoClear||y)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),_&&(_.isCubeTexture||_.mapping===A1)?(h===void 0&&(h=new ao(new Zl(1,1,1),new nr({name:"BackgroundCubeMaterial",uniforms:kg(Pl.backgroundCube.uniforms),vertexShader:Pl.backgroundCube.vertexShader,fragmentShader:Pl.backgroundCube.fragmentShader,side:vr,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(b,T,M){this.matrixWorld.copyPosition(M.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(h)),h.material.uniforms.envMap.value=_,h.material.uniforms.flipEnvMap.value=_.isCubeTexture&&_.isRenderTargetTexture===!1?-1:1,h.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,h.material.toneMapped=_.encoding!==Wt,(u!==_||d!==_.version||f!==t.toneMapping)&&(h.material.needsUpdate=!0,u=_,d=_.version,f=t.toneMapping),h.layers.enableAll(),g.unshift(h,h.geometry,h.material,0,0,null)):_&&_.isTexture&&(c===void 0&&(c=new ao(new lE(2,2),new nr({name:"BackgroundMaterial",uniforms:kg(Pl.background.uniforms),vertexShader:Pl.background.vertexShader,fragmentShader:Pl.background.fragmentShader,side:Ka,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=_,c.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,c.material.toneMapped=_.encoding!==Wt,_.matrixAutoUpdate===!0&&_.updateMatrix(),c.material.uniforms.uvTransform.value.copy(_.matrix),(u!==_||d!==_.version||f!==t.toneMapping)&&(c.material.needsUpdate=!0,u=_,d=_.version,f=t.toneMapping),c.layers.enableAll(),g.unshift(c,c.geometry,c.material,0,0,null))}function v(g,m){g.getRGB(oS,AQ(t)),i.buffers.color.setClear(oS.r,oS.g,oS.b,m,o)}return{getClearColor:function(){return a},setClearColor:function(g,m=1){a.set(g),l=m,v(a,l)},getClearAlpha:function(){return l},setClearAlpha:function(g){l=g,v(a,l)},render:p}}function fwe(t,e,n,i){let r=t.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||s!==null,a={},l=g(null),c=l,h=!1;function u(k,j,Z,ee,O){let W=!1;if(o){let H=v(ee,Z,j);c!==H&&(c=H,f(c.object)),W=m(k,ee,Z,O),W&&y(k,ee,Z,O)}else{let H=j.wireframe===!0;(c.geometry!==ee.id||c.program!==Z.id||c.wireframe!==H)&&(c.geometry=ee.id,c.program=Z.id,c.wireframe=H,W=!0)}O!==null&&n.update(O,34963),(W||h)&&(h=!1,M(k,j,Z,ee),O!==null&&t.bindBuffer(34963,n.get(O).buffer))}function d(){return i.isWebGL2?t.createVertexArray():s.createVertexArrayOES()}function f(k){return i.isWebGL2?t.bindVertexArray(k):s.bindVertexArrayOES(k)}function p(k){return i.isWebGL2?t.deleteVertexArray(k):s.deleteVertexArrayOES(k)}function v(k,j,Z){let ee=Z.wireframe===!0,O=a[k.id];O===void 0&&(O={},a[k.id]=O);let W=O[j.id];W===void 0&&(W={},O[j.id]=W);let H=W[ee];return H===void 0&&(H=g(d()),W[ee]=H),H}function g(k){let j=[],Z=[],ee=[];for(let O=0;O<r;O++)j[O]=0,Z[O]=0,ee[O]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:j,enabledAttributes:Z,attributeDivisors:ee,object:k,attributes:{},index:null}}function m(k,j,Z,ee){let O=c.attributes,W=j.attributes,H=0,Y=Z.getAttributes();for(let z in Y)if(Y[z].location>=0){let X=O[z],q=W[z];if(q===void 0&&(z==="instanceMatrix"&&k.instanceMatrix&&(q=k.instanceMatrix),z==="instanceColor"&&k.instanceColor&&(q=k.instanceColor)),X===void 0||X.attribute!==q||q&&X.data!==q.data)return!0;H++}return c.attributesNum!==H||c.index!==ee}function y(k,j,Z,ee){let O={},W=j.attributes,H=0,Y=Z.getAttributes();for(let z in Y)if(Y[z].location>=0){let X=W[z];X===void 0&&(z==="instanceMatrix"&&k.instanceMatrix&&(X=k.instanceMatrix),z==="instanceColor"&&k.instanceColor&&(X=k.instanceColor));let q={};q.attribute=X,X&&X.data&&(q.data=X.data),O[z]=q,H++}c.attributes=O,c.attributesNum=H,c.index=ee}function _(){let k=c.newAttributes;for(let j=0,Z=k.length;j<Z;j++)k[j]=0}function S(k){A(k,0)}function A(k,j){let Z=c.newAttributes,ee=c.enabledAttributes,O=c.attributeDivisors;Z[k]=1,ee[k]===0&&(t.enableVertexAttribArray(k),ee[k]=1),O[k]!==j&&((i.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](k,j),O[k]=j)}function b(){let k=c.newAttributes,j=c.enabledAttributes;for(let Z=0,ee=j.length;Z<ee;Z++)j[Z]!==k[Z]&&(t.disableVertexAttribArray(Z),j[Z]=0)}function T(k,j,Z,ee,O,W){i.isWebGL2===!0&&(Z===5124||Z===5125)?t.vertexAttribIPointer(k,j,Z,O,W):t.vertexAttribPointer(k,j,Z,ee,O,W)}function M(k,j,Z,ee){if(i.isWebGL2===!1&&(k.isInstancedMesh||ee.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;_();let O=ee.attributes,W=Z.getAttributes(),H=j.defaultAttributeValues;for(let Y in W){let z=W[Y];if(z.location>=0){let X=O[Y];if(X===void 0&&(Y==="instanceMatrix"&&k.instanceMatrix&&(X=k.instanceMatrix),Y==="instanceColor"&&k.instanceColor&&(X=k.instanceColor)),X!==void 0){let q=X.normalized,re=X.itemSize,G=n.get(X);if(G===void 0)continue;let K=G.buffer,oe=G.type,ve=G.bytesPerElement;if(X.isInterleavedBufferAttribute){let $=X.data,se=$.stride,ne=X.offset;if($.isInstancedInterleavedBuffer){for(let ie=0;ie<z.locationSize;ie++)A(z.location+ie,$.meshPerAttribute);k.isInstancedMesh!==!0&&ee._maxInstanceCount===void 0&&(ee._maxInstanceCount=$.meshPerAttribute*$.count)}else for(let ie=0;ie<z.locationSize;ie++)S(z.location+ie);t.bindBuffer(34962,K);for(let ie=0;ie<z.locationSize;ie++)T(z.location+ie,re/z.locationSize,oe,q,se*ve,(ne+re/z.locationSize*ie)*ve)}else{if(X.isInstancedBufferAttribute){for(let $=0;$<z.locationSize;$++)A(z.location+$,X.meshPerAttribute);k.isInstancedMesh!==!0&&ee._maxInstanceCount===void 0&&(ee._maxInstanceCount=X.meshPerAttribute*X.count)}else for(let $=0;$<z.locationSize;$++)S(z.location+$);t.bindBuffer(34962,K);for(let $=0;$<z.locationSize;$++)T(z.location+$,re/z.locationSize,oe,q,re*ve,re/z.locationSize*$*ve)}}else if(H!==void 0){let q=H[Y];if(q!==void 0)switch(q.length){case 2:t.vertexAttrib2fv(z.location,q);break;case 3:t.vertexAttrib3fv(z.location,q);break;case 4:t.vertexAttrib4fv(z.location,q);break;default:t.vertexAttrib1fv(z.location,q)}}}}b()}function E(){F();for(let k in a){let j=a[k];for(let Z in j){let ee=j[Z];for(let O in ee)p(ee[O].object),delete ee[O];delete j[Z]}delete a[k]}}function P(k){if(a[k.id]===void 0)return;let j=a[k.id];for(let Z in j){let ee=j[Z];for(let O in ee)p(ee[O].object),delete ee[O];delete j[Z]}delete a[k.id]}function R(k){for(let j in a){let Z=a[j];if(Z[k.id]===void 0)continue;let ee=Z[k.id];for(let O in ee)p(ee[O].object),delete ee[O];delete Z[k.id]}}function F(){B(),h=!0,c!==l&&(c=l,f(c.object))}function B(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:u,reset:F,resetDefaultState:B,dispose:E,releaseStatesOfGeometry:P,releaseStatesOfProgram:R,initAttributes:_,enableAttribute:S,disableUnusedAttributes:b}}function pwe(t,e,n,i){let r=i.isWebGL2,s;function o(c){s=c}function a(c,h){t.drawArrays(s,c,h),n.update(h,s,1)}function l(c,h,u){if(u===0)return;let d,f;if(r)d=t,f="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[f](s,c,h,u),n.update(h,s,u)}this.setMode=o,this.render=a,this.renderInstances=l}function mwe(t,e,n){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){let T=e.get("EXT_texture_filter_anisotropic");i=t.getParameter(T.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(T){if(T==="highp"){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";T="mediump"}return T==="mediump"&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let o=typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext,a=n.precision!==void 0?n.precision:"highp",l=s(a);l!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",l,"instead."),a=l);let c=o||e.has("WEBGL_draw_buffers"),h=n.logarithmicDepthBuffer===!0,u=t.getParameter(34930),d=t.getParameter(35660),f=t.getParameter(3379),p=t.getParameter(34076),v=t.getParameter(34921),g=t.getParameter(36347),m=t.getParameter(36348),y=t.getParameter(36349),_=d>0,S=o||e.has("OES_texture_float"),A=_&&S,b=o?t.getParameter(36183):0;return{isWebGL2:o,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:h,maxTextures:u,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:v,maxVertexUniforms:g,maxVaryings:m,maxFragmentUniforms:y,vertexTextures:_,floatFragmentTextures:S,floatVertexTextures:A,maxSamples:b}}function gwe(t){let e=this,n=null,i=0,r=!1,s=!1,o=new $s,a=new Pr,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(u,d){let f=u.length!==0||d||i!==0||r;return r=d,i=u.length,f},this.beginShadows=function(){s=!0,h(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(u,d){n=h(u,d,0)},this.setState=function(u,d,f){let p=u.clippingPlanes,v=u.clipIntersection,g=u.clipShadows,m=t.get(u);if(!r||p===null||p.length===0||s&&!g)s?h(null):c();else{let y=s?0:i,_=y*4,S=m.clippingState||null;l.value=S,S=h(p,d,_,f);for(let A=0;A!==_;++A)S[A]=n[A];m.clippingState=S,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==n&&(l.value=n,l.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function h(u,d,f,p){let v=u!==null?u.length:0,g=null;if(v!==0){if(g=l.value,p!==!0||g===null){let m=f+v*4,y=d.matrixWorldInverse;a.getNormalMatrix(y),(g===null||g.length<m)&&(g=new Float32Array(m));for(let _=0,S=f;_!==v;++_,S+=4)o.copy(u[_]).applyMatrix4(y,a),o.normal.toArray(g,S),g[S+3]=o.constant}l.value=g,l.needsUpdate=!0}return e.numPlanes=v,e.numIntersection=0,g}}function vwe(t){let e=new WeakMap;function n(o,a){return a===bL?o.mapping=Rf:a===AL&&(o.mapping=Lf),o}function i(o){if(o&&o.isTexture&&o.isRenderTargetTexture===!1){let a=o.mapping;if(a===bL||a===AL)if(e.has(o)){let l=e.get(o).texture;return n(l,o.mapping)}else{let l=o.image;if(l&&l.height>0){let c=new Dxe(l.height/2);return c.fromEquirectangularTexture(t,o),e.set(o,c),o.addEventListener("dispose",r),n(c.texture,o.mapping)}else return null}}return o}function r(o){let a=o.target;a.removeEventListener("dispose",r);let l=e.get(a);l!==void 0&&(e.delete(a),l.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}var AA=class extends dv{constructor(t=-1,e=1,n=1,i=-1,r=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=i,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,e,n,i,r,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,r=n-t,s=n+t,o=i+e,a=i-e;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=l*this.view.offsetX,s=r+l*this.view.width,o-=c*this.view.offsetY,a=o-c*this.view.height}this.projectionMatrix.makeOrthographic(r,s,o,a,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){let e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}},Um=4,YH=[.125,.215,.35,.446,.526,.582],Hd=20,KP=new AA,qH=new Rt,JP=null,Fd=(1+Math.sqrt(5))/2,Qp=1/Fd,QH=[new N(1,1,1),new N(-1,1,1),new N(1,1,-1),new N(-1,1,-1),new N(0,Fd,Qp),new N(0,Fd,-Qp),new N(Qp,0,Fd),new N(-Qp,0,Fd),new N(Fd,Qp,0),new N(-Fd,Qp,0)],KH=class{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,e=0,n=.1,i=100){JP=this._renderer.getRenderTarget(),this._setSize(256);let r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(t,n,i,r),e>0&&this._blur(r,0,0,e),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=$H(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=ZH(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(JP),t.scissorTest=!1,aS(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===Rf||t.mapping===Lf?this._setSize(t.image.length===0?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),JP=this._renderer.getRenderTarget();let n=e||this._allocateTargets();return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){let t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,n={magFilter:En,minFilter:En,generateMipmaps:!1,type:bx,format:Fa,encoding:Jl,depthBuffer:!1},i=JH(t,e,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=JH(t,e,n);let{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=ywe(r)),this._blurMaterial=xwe(r,t,e)}return i}_compileMaterial(t){let e=new ao(this._lodPlanes[0],t);this._renderer.compile(e,KP)}_sceneToCubeUV(t,e,n,i){let r=new Yr(90,1,e,n),s=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],a=this._renderer,l=a.autoClear,c=a.toneMapping;a.getClearColor(qH),a.toneMapping=qc,a.autoClear=!1;let h=new E1({name:"PMREM.Background",side:vr,depthWrite:!1,depthTest:!1}),u=new ao(new Zl,h),d=!1,f=t.background;f?f.isColor&&(h.color.copy(f),t.background=null,d=!0):(h.color.copy(qH),d=!0);for(let p=0;p<6;p++){let v=p%3;v===0?(r.up.set(0,s[p],0),r.lookAt(o[p],0,0)):v===1?(r.up.set(0,0,s[p]),r.lookAt(0,o[p],0)):(r.up.set(0,s[p],0),r.lookAt(0,0,o[p]));let g=this._cubeSize;aS(i,v*g,p>2?g:0,g,g),a.setRenderTarget(i),d&&a.render(u,r),a.render(t,r)}u.geometry.dispose(),u.material.dispose(),a.toneMapping=c,a.autoClear=l,t.background=f}_textureToCubeUV(t,e){let n=this._renderer,i=t.mapping===Rf||t.mapping===Lf;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=$H()),this._cubemapMaterial.uniforms.flipEnvMap.value=t.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=ZH());let r=i?this._cubemapMaterial:this._equirectMaterial,s=new ao(this._lodPlanes[0],r),o=r.uniforms;o.envMap.value=t;let a=this._cubeSize;aS(e,0,0,3*a,2*a),n.setRenderTarget(e),n.render(s,KP)}_applyPMREM(t){let e=this._renderer,n=e.autoClear;e.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){let r=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),s=QH[(i-1)%QH.length];this._blur(t,i-1,i,r,s)}e.autoClear=n}_blur(t,e,n,i,r){let s=this._pingPongRenderTarget;this._halfBlur(t,s,e,n,i,"latitudinal",r),this._halfBlur(s,t,n,n,i,"longitudinal",r)}_halfBlur(t,e,n,i,r,s,o){let a=this._renderer,l=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let c=3,h=new ao(this._lodPlanes[i],l),u=l.uniforms,d=this._sizeLods[n]-1,f=isFinite(r)?Math.PI/(2*d):2*Math.PI/(2*Hd-1),p=r/f,v=isFinite(r)?1+Math.floor(c*p):Hd;v>Hd&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${v} samples when the maximum is set to ${Hd}`);let g=[],m=0;for(let b=0;b<Hd;++b){let T=b/p,M=Math.exp(-T*T/2);g.push(M),b===0?m+=M:b<v&&(m+=2*M)}for(let b=0;b<g.length;b++)g[b]=g[b]/m;u.envMap.value=t.texture,u.samples.value=v,u.weights.value=g,u.latitudinal.value=s==="latitudinal",o&&(u.poleAxis.value=o);let{_lodMax:y}=this;u.dTheta.value=f,u.mipInt.value=y-n;let _=this._sizeLods[i],S=3*_*(i>y-Um?i-y+Um:0),A=4*(this._cubeSize-_);aS(e,S,A,3*_,2*_),a.setRenderTarget(e),a.render(h,KP)}};function ywe(t){let e=[],n=[],i=[],r=t,s=t-Um+1+YH.length;for(let o=0;o<s;o++){let a=Math.pow(2,r);n.push(a);let l=1/a;o>t-Um?l=YH[o-t+Um-1]:o===0&&(l=0),i.push(l);let c=1/(a-2),h=-c,u=1+c,d=[h,h,u,h,u,u,h,h,u,u,h,u],f=6,p=6,v=3,g=2,m=1,y=new Float32Array(v*p*f),_=new Float32Array(g*p*f),S=new Float32Array(m*p*f);for(let b=0;b<f;b++){let T=b%3*2/3-1,M=b>2?0:-1,E=[T,M,0,T+2/3,M,0,T+2/3,M+1,0,T,M,0,T+2/3,M+1,0,T,M+1,0];y.set(E,v*p*b),_.set(d,g*p*b);let P=[b,b,b,b,b,b];S.set(P,m*p*b)}let A=new Lt;A.setAttribute("position",new Ut(y,v)),A.setAttribute("uv",new Ut(_,g)),A.setAttribute("faceIndex",new Ut(S,m)),e.push(A),r>Um&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}function JH(t,e,n){let i=new $i(t,e,n);return i.texture.mapping=A1,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function aS(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function xwe(t,e,n){let i=new Float32Array(Hd),r=new N(0,1,0);return new nr({name:"SphericalGaussianBlur",defines:{n:Hd,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:_O(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Rr,depthTest:!1,depthWrite:!1})}function ZH(){return new nr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:_O(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Rr,depthTest:!1,depthWrite:!1})}function $H(){return new nr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:_O(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Rr,depthTest:!1,depthWrite:!1})}function _O(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function _we(t){let e=new WeakMap,n=null;function i(a){if(a&&a.isTexture){let l=a.mapping,c=l===bL||l===AL,h=l===Rf||l===Lf;if(c||h)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let u=e.get(a);return n===null&&(n=new KH(t)),u=c?n.fromEquirectangular(a,u):n.fromCubemap(a,u),e.set(a,u),u.texture}else{if(e.has(a))return e.get(a).texture;{let u=a.image;if(c&&u&&u.height>0||h&&u&&r(u)){n===null&&(n=new KH(t));let d=c?n.fromEquirectangular(a):n.fromCubemap(a);return e.set(a,d),a.addEventListener("dispose",s),d.texture}else return null}}}return a}function r(a){let l=0,c=6;for(let h=0;h<c;h++)a[h]!==void 0&&l++;return l===c}function s(a){let l=a.target;l.removeEventListener("dispose",s);let c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function o(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:o}}function wwe(t){let e={};function n(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(i)}return e[i]=r,r}return{has:function(i){return n(i)!==null},init:function(i){i.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(i){let r=n(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function Swe(t,e,n,i){let r={},s=new WeakMap;function o(u){let d=u.target;d.index!==null&&e.remove(d.index);for(let p in d.attributes)e.remove(d.attributes[p]);d.removeEventListener("dispose",o),delete r[d.id];let f=s.get(d);f&&(e.remove(f),s.delete(d)),i.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,n.memory.geometries--}function a(u,d){return r[d.id]===!0||(d.addEventListener("dispose",o),r[d.id]=!0,n.memory.geometries++),d}function l(u){let d=u.attributes;for(let p in d)e.update(d[p],34962);let f=u.morphAttributes;for(let p in f){let v=f[p];for(let g=0,m=v.length;g<m;g++)e.update(v[g],34962)}}function c(u){let d=[],f=u.index,p=u.attributes.position,v=0;if(f!==null){let y=f.array;v=f.version;for(let _=0,S=y.length;_<S;_+=3){let A=y[_+0],b=y[_+1],T=y[_+2];d.push(A,b,b,T,T,A)}}else{let y=p.array;v=p.version;for(let _=0,S=y.length/3-1;_<S;_+=3){let A=_+0,b=_+1,T=_+2;d.push(A,b,b,T,T,A)}}let g=new(yQ(d)?Ey:bQ)(d,1);g.version=v;let m=s.get(u);m&&e.remove(m),s.set(u,g)}function h(u){let d=s.get(u);if(d){let f=u.index;f!==null&&d.version<f.version&&c(u)}else c(u);return s.get(u)}return{get:a,update:l,getWireframeAttribute:h}}function bwe(t,e,n,i){let r=i.isWebGL2,s;function o(d){s=d}let a,l;function c(d){a=d.type,l=d.bytesPerElement}function h(d,f){t.drawElements(s,f,a,d*l),n.update(f,s,1)}function u(d,f,p){if(p===0)return;let v,g;if(r)v=t,g="drawElementsInstanced";else if(v=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",v===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}v[g](s,f,a,d*l,p),n.update(f,s,p)}this.setMode=o,this.setIndex=c,this.render=h,this.renderInstances=u}function Awe(t){let e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(n.calls++,o){case 4:n.triangles+=a*(s/3);break;case 1:n.lines+=a*(s/2);break;case 3:n.lines+=a*(s-1);break;case 2:n.lines+=a*s;break;case 0:n.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:r,update:i}}function Mwe(t,e){return t[0]-e[0]}function Ewe(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Cwe(t,e,n){let i={},r=new Float32Array(8),s=new WeakMap,o=new Zt,a=[];for(let c=0;c<8;c++)a[c]=[c,0];function l(c,h,u,d){let f=c.morphTargetInfluences;if(e.isWebGL2===!0){let p=h.morphAttributes.position||h.morphAttributes.normal||h.morphAttributes.color,v=p!==void 0?p.length:0,g=s.get(h);if(g===void 0||g.count!==v){let _=function(){k.dispose(),s.delete(h),h.removeEventListener("dispose",_)};g!==void 0&&g.texture.dispose();let S=h.morphAttributes.position!==void 0,A=h.morphAttributes.normal!==void 0,b=h.morphAttributes.color!==void 0,T=h.morphAttributes.position||[],M=h.morphAttributes.normal||[],E=h.morphAttributes.color||[],P=0;S===!0&&(P=1),A===!0&&(P=2),b===!0&&(P=3);let R=h.attributes.position.count*P,F=1;R>e.maxTextureSize&&(F=Math.ceil(R/e.maxTextureSize),R=e.maxTextureSize);let B=new Float32Array(R*F*4*v),k=new SQ(B,R,F,v);k.type=ch,k.needsUpdate=!0;let j=P*4;for(let Z=0;Z<v;Z++){let ee=T[Z],O=M[Z],W=E[Z],H=R*F*4*Z;for(let Y=0;Y<ee.count;Y++){let z=Y*j;S===!0&&(o.fromBufferAttribute(ee,Y),B[H+z+0]=o.x,B[H+z+1]=o.y,B[H+z+2]=o.z,B[H+z+3]=0),A===!0&&(o.fromBufferAttribute(O,Y),B[H+z+4]=o.x,B[H+z+5]=o.y,B[H+z+6]=o.z,B[H+z+7]=0),b===!0&&(o.fromBufferAttribute(W,Y),B[H+z+8]=o.x,B[H+z+9]=o.y,B[H+z+10]=o.z,B[H+z+11]=W.itemSize===4?o.w:1)}}g={count:v,texture:k,size:new Se(R,F)},s.set(h,g),h.addEventListener("dispose",_)}let m=0;for(let _=0;_<f.length;_++)m+=f[_];let y=h.morphTargetsRelative?1:1-m;d.getUniforms().setValue(t,"morphTargetBaseInfluence",y),d.getUniforms().setValue(t,"morphTargetInfluences",f),d.getUniforms().setValue(t,"morphTargetsTexture",g.texture,n),d.getUniforms().setValue(t,"morphTargetsTextureSize",g.size)}else{let p=f===void 0?0:f.length,v=i[h.id];if(v===void 0||v.length!==p){v=[];for(let S=0;S<p;S++)v[S]=[S,0];i[h.id]=v}for(let S=0;S<p;S++){let A=v[S];A[0]=S,A[1]=f[S]}v.sort(Ewe);for(let S=0;S<8;S++)S<p&&v[S][1]?(a[S][0]=v[S][0],a[S][1]=v[S][1]):(a[S][0]=Number.MAX_SAFE_INTEGER,a[S][1]=0);a.sort(Mwe);let g=h.morphAttributes.position,m=h.morphAttributes.normal,y=0;for(let S=0;S<8;S++){let A=a[S],b=A[0],T=A[1];b!==Number.MAX_SAFE_INTEGER&&T?(g&&h.getAttribute("morphTarget"+S)!==g[b]&&h.setAttribute("morphTarget"+S,g[b]),m&&h.getAttribute("morphNormal"+S)!==m[b]&&h.setAttribute("morphNormal"+S,m[b]),r[S]=T,y+=T):(g&&h.hasAttribute("morphTarget"+S)===!0&&h.deleteAttribute("morphTarget"+S),m&&h.hasAttribute("morphNormal"+S)===!0&&h.deleteAttribute("morphNormal"+S),r[S]=0)}let _=h.morphTargetsRelative?1:1-y;d.getUniforms().setValue(t,"morphTargetBaseInfluence",_),d.getUniforms().setValue(t,"morphTargetInfluences",r)}}return{update:l}}function Twe(t,e,n,i){let r=new WeakMap;function s(l){let c=i.render.frame,h=l.geometry,u=e.get(l,h);return r.get(u)!==c&&(e.update(u),r.set(u,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",a)===!1&&l.addEventListener("dispose",a),n.update(l.instanceMatrix,34962),l.instanceColor!==null&&n.update(l.instanceColor,34962)),u}function o(){r=new WeakMap}function a(l){let c=l.target;c.removeEventListener("dispose",a),n.remove(c.instanceMatrix),c.instanceColor!==null&&n.remove(c.instanceColor)}return{update:s,dispose:o}}var EQ=new _r,CQ=new SQ,TQ=new pxe,PQ=new yO,eV=[],tV=[],nV=new Float32Array(16),iV=new Float32Array(9),rV=new Float32Array(4);function fv(t,e,n){let i=t[0];if(i<=0||i>0)return t;let r=e*n,s=eV[r];if(s===void 0&&(s=new Float32Array(r),eV[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=n,t[o].toArray(s,a)}return s}function ir(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function rr(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function cE(t,e){let n=tV[e];n===void 0&&(n=new Int32Array(e),tV[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function Pwe(t,e){let n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function Dwe(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(ir(n,e))return;t.uniform2fv(this.addr,e),rr(n,e)}}function Rwe(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(ir(n,e))return;t.uniform3fv(this.addr,e),rr(n,e)}}function Lwe(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(ir(n,e))return;t.uniform4fv(this.addr,e),rr(n,e)}}function Iwe(t,e){let n=this.cache,i=e.elements;if(i===void 0){if(ir(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),rr(n,e)}else{if(ir(n,i))return;rV.set(i),t.uniformMatrix2fv(this.addr,!1,rV),rr(n,i)}}function Bwe(t,e){let n=this.cache,i=e.elements;if(i===void 0){if(ir(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),rr(n,e)}else{if(ir(n,i))return;iV.set(i),t.uniformMatrix3fv(this.addr,!1,iV),rr(n,i)}}function Owe(t,e){let n=this.cache,i=e.elements;if(i===void 0){if(ir(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),rr(n,e)}else{if(ir(n,i))return;nV.set(i),t.uniformMatrix4fv(this.addr,!1,nV),rr(n,i)}}function Fwe(t,e){let n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function Nwe(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(ir(n,e))return;t.uniform2iv(this.addr,e),rr(n,e)}}function Uwe(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(ir(n,e))return;t.uniform3iv(this.addr,e),rr(n,e)}}function kwe(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(ir(n,e))return;t.uniform4iv(this.addr,e),rr(n,e)}}function zwe(t,e){let n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function Gwe(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(ir(n,e))return;t.uniform2uiv(this.addr,e),rr(n,e)}}function Hwe(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(ir(n,e))return;t.uniform3uiv(this.addr,e),rr(n,e)}}function Vwe(t,e){let n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(ir(n,e))return;t.uniform4uiv(this.addr,e),rr(n,e)}}function jwe(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2D(e||EQ,r)}function Wwe(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||TQ,r)}function Xwe(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||PQ,r)}function Ywe(t,e,n){let i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||CQ,r)}function qwe(t){switch(t){case 5126:return Pwe;case 35664:return Dwe;case 35665:return Rwe;case 35666:return Lwe;case 35674:return Iwe;case 35675:return Bwe;case 35676:return Owe;case 5124:case 35670:return Fwe;case 35667:case 35671:return Nwe;case 35668:case 35672:return Uwe;case 35669:case 35673:return kwe;case 5125:return zwe;case 36294:return Gwe;case 36295:return Hwe;case 36296:return Vwe;case 35678:case 36198:case 36298:case 36306:case 35682:return jwe;case 35679:case 36299:case 36307:return Wwe;case 35680:case 36300:case 36308:case 36293:return Xwe;case 36289:case 36303:case 36311:case 36292:return Ywe}}function Qwe(t,e){t.uniform1fv(this.addr,e)}function Kwe(t,e){let n=fv(e,this.size,2);t.uniform2fv(this.addr,n)}function Jwe(t,e){let n=fv(e,this.size,3);t.uniform3fv(this.addr,n)}function Zwe(t,e){let n=fv(e,this.size,4);t.uniform4fv(this.addr,n)}function $we(t,e){let n=fv(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function eSe(t,e){let n=fv(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function tSe(t,e){let n=fv(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function nSe(t,e){t.uniform1iv(this.addr,e)}function iSe(t,e){t.uniform2iv(this.addr,e)}function rSe(t,e){t.uniform3iv(this.addr,e)}function sSe(t,e){t.uniform4iv(this.addr,e)}function oSe(t,e){t.uniform1uiv(this.addr,e)}function aSe(t,e){t.uniform2uiv(this.addr,e)}function lSe(t,e){t.uniform3uiv(this.addr,e)}function cSe(t,e){t.uniform4uiv(this.addr,e)}function uSe(t,e,n){let i=this.cache,r=e.length,s=cE(n,r);ir(i,s)||(t.uniform1iv(this.addr,s),rr(i,s));for(let o=0;o!==r;++o)n.setTexture2D(e[o]||EQ,s[o])}function hSe(t,e,n){let i=this.cache,r=e.length,s=cE(n,r);ir(i,s)||(t.uniform1iv(this.addr,s),rr(i,s));for(let o=0;o!==r;++o)n.setTexture3D(e[o]||TQ,s[o])}function dSe(t,e,n){let i=this.cache,r=e.length,s=cE(n,r);ir(i,s)||(t.uniform1iv(this.addr,s),rr(i,s));for(let o=0;o!==r;++o)n.setTextureCube(e[o]||PQ,s[o])}function fSe(t,e,n){let i=this.cache,r=e.length,s=cE(n,r);ir(i,s)||(t.uniform1iv(this.addr,s),rr(i,s));for(let o=0;o!==r;++o)n.setTexture2DArray(e[o]||CQ,s[o])}function pSe(t){switch(t){case 5126:return Qwe;case 35664:return Kwe;case 35665:return Jwe;case 35666:return Zwe;case 35674:return $we;case 35675:return eSe;case 35676:return tSe;case 5124:case 35670:return nSe;case 35667:case 35671:return iSe;case 35668:case 35672:return rSe;case 35669:case 35673:return sSe;case 5125:return oSe;case 36294:return aSe;case 36295:return lSe;case 36296:return cSe;case 35678:case 36198:case 36298:case 36306:case 35682:return uSe;case 35679:case 36299:case 36307:return hSe;case 35680:case 36300:case 36308:case 36293:return dSe;case 36289:case 36303:case 36311:case 36292:return fSe}}var mSe=class{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.setValue=qwe(e.type)}},gSe=class{constructor(t,e,n){this.id=t,this.addr=n,this.cache=[],this.size=e.size,this.setValue=pSe(e.type)}},vSe=class{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,n){let i=this.seq;for(let r=0,s=i.length;r!==s;++r){let o=i[r];o.setValue(t,e[o.id],n)}}},ZP=/(\w+)(\])?(\[|\.)?/g;function sV(t,e){t.seq.push(e),t.map[e.id]=e}function ySe(t,e,n){let i=t.name,r=i.length;for(ZP.lastIndex=0;;){let s=ZP.exec(i),o=ZP.lastIndex,a=s[1],l=s[2]==="]",c=s[3];if(l&&(a=a|0),c===void 0||c==="["&&o+2===r){sV(n,c===void 0?new mSe(a,t,e):new gSe(a,t,e));break}else{let h=n.map[a];h===void 0&&(h=new vSe(a),sV(n,h)),n=h}}}var wb=class{constructor(t,e){this.seq=[],this.map={};let n=t.getProgramParameter(e,35718);for(let i=0;i<n;++i){let r=t.getActiveUniform(e,i),s=t.getUniformLocation(e,r.name);ySe(r,s,this)}}setValue(t,e,n,i){let r=this.map[e];r!==void 0&&r.setValue(t,n,i)}setOptional(t,e,n){let i=e[n];i!==void 0&&this.setValue(t,n,i)}static upload(t,e,n,i){for(let r=0,s=e.length;r!==s;++r){let o=e[r],a=n[o.id];a.needsUpdate!==!1&&o.setValue(t,a.value,i)}}static seqWithValue(t,e){let n=[];for(let i=0,r=t.length;i!==r;++i){let s=t[i];s.id in e&&n.push(s)}return n}};function oV(t,e,n){let i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}var xSe=0;function _Se(t,e){let n=t.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let o=r;o<s;o++){let a=o+1;i.push(`${a===e?">":" "} ${a}: ${n[o]}`)}return i.join(`
`)}function wSe(t){switch(t){case Jl:return["Linear","( value )"];case Wt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function aV(t,e,n){let i=t.getShaderParameter(e,35713),r=t.getShaderInfoLog(e).trim();if(i&&r==="")return"";let s=/ERROR: 0:(\d+)/.exec(r);if(s){let o=parseInt(s[1]);return n.toUpperCase()+`

`+r+`

`+_Se(t.getShaderSource(e),o)}else return r}function SSe(t,e){let n=wSe(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function bSe(t,e){let n;switch(e){case Tye:n="Linear";break;case Pye:n="Reinhard";break;case Dye:n="OptimizedCineon";break;case Rye:n="ACESFilmic";break;case Lye:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function ASe(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.tangentSpaceNormalMap||t.clearcoatNormalMap||t.flatShading||t.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Z0).join(`
`)}function MSe(t){let e=[];for(let n in t){let i=t[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function ESe(t,e){let n={},i=t.getProgramParameter(e,35721);for(let r=0;r<i;r++){let s=t.getActiveAttrib(e,r),o=s.name,a=1;s.type===35674&&(a=2),s.type===35675&&(a=3),s.type===35676&&(a=4),n[o]={type:s.type,location:t.getAttribLocation(e,o),locationSize:a}}return n}function Z0(t){return t!==""}function lV(t,e){let n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function cV(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var CSe=/^[ \t]*#include +<([\w\d./]+)>/gm;function PL(t){return t.replace(CSe,TSe)}function TSe(t,e){let n=jt[e];if(n===void 0)throw new Error("Can not resolve #include <"+e+">");return PL(n)}var PSe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function uV(t){return t.replace(PSe,DSe)}function DSe(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function hV(t){let e="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function RSe(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===mO?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===hQ?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===J0&&(e="SHADOWMAP_TYPE_VSM"),e}function LSe(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case Rf:case Lf:e="ENVMAP_TYPE_CUBE";break;case A1:e="ENVMAP_TYPE_CUBE_UV";break}return e}function ISe(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case Lf:e="ENVMAP_MODE_REFRACTION";break}return e}function BSe(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case pQ:e="ENVMAP_BLENDING_MULTIPLY";break;case Eye:e="ENVMAP_BLENDING_MIX";break;case Cye:e="ENVMAP_BLENDING_ADD";break}return e}function OSe(t){let e=t.envMapCubeUVHeight;if(e===null)return null;let n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:i,maxMip:n}}function FSe(t,e,n,i){let r=t.getContext(),s=n.defines,o=n.vertexShader,a=n.fragmentShader,l=RSe(n),c=LSe(n),h=ISe(n),u=BSe(n),d=OSe(n),f=n.isWebGL2?"":ASe(n),p=MSe(s),v=r.createProgram(),g,m,y=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(g=[p].filter(Z0).join(`
`),g.length>0&&(g+=`
`),m=[f,p].filter(Z0).join(`
`),m.length>0&&(m+=`
`)):(g=[hV(n),"#define SHADER_NAME "+n.shaderName,p,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Z0).join(`
`),m=[f,hV(n),"#define SHADER_NAME "+n.shaderName,p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+h:"",n.envMap?"#define "+u:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==qc?"#define TONE_MAPPING":"",n.toneMapping!==qc?jt.tonemapping_pars_fragment:"",n.toneMapping!==qc?bSe("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",jt.encodings_pars_fragment,SSe("linearToOutputTexel",n.outputEncoding),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(Z0).join(`
`)),o=PL(o),o=lV(o,n),o=cV(o,n),a=PL(a),a=lV(a,n),a=cV(a,n),o=uV(o),a=uV(a),n.isWebGL2&&n.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,m=["#define varying in",n.glslVersion===OH?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===OH?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+m);let _=y+g+o,S=y+m+a,A=oV(r,35633,_),b=oV(r,35632,S);if(r.attachShader(v,A),r.attachShader(v,b),n.index0AttributeName!==void 0?r.bindAttribLocation(v,0,n.index0AttributeName):n.morphTargets===!0&&r.bindAttribLocation(v,0,"position"),r.linkProgram(v),t.debug.checkShaderErrors){let E=r.getProgramInfoLog(v).trim(),P=r.getShaderInfoLog(A).trim(),R=r.getShaderInfoLog(b).trim(),F=!0,B=!0;if(r.getProgramParameter(v,35714)===!1){F=!1;let k=aV(r,A,"vertex"),j=aV(r,b,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(v,35715)+`

Program Info Log: `+E+`
`+k+`
`+j)}else E!==""?console.warn("THREE.WebGLProgram: Program Info Log:",E):(P===""||R==="")&&(B=!1);B&&(this.diagnostics={runnable:F,programLog:E,vertexShader:{log:P,prefix:g},fragmentShader:{log:R,prefix:m}})}r.deleteShader(A),r.deleteShader(b);let T;this.getUniforms=function(){return T===void 0&&(T=new wb(r,v)),T};let M;return this.getAttributes=function(){return M===void 0&&(M=ESe(r,v)),M},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(v),this.program=void 0},this.name=n.shaderName,this.id=xSe++,this.cacheKey=e,this.usedTimes=1,this.program=v,this.vertexShader=A,this.fragmentShader=b,this}var NSe=0,USe=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){let e=t.vertexShader,n=t.fragmentShader,i=this._getShaderStage(e),r=this._getShaderStage(n),s=this._getShaderCacheForMaterial(t);return s.has(i)===!1&&(s.add(i),i.usedTimes++),s.has(r)===!1&&(s.add(r),r.usedTimes++),this}remove(t){let e=this.materialCache.get(t);for(let n of e)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){let e=this.materialCache,n=e.get(t);return n===void 0&&(n=new Set,e.set(t,n)),n}_getShaderStage(t){let e=this.shaderCache,n=e.get(t);return n===void 0&&(n=new kSe(t),e.set(t,n)),n}},kSe=class{constructor(t){this.id=NSe++,this.code=t,this.usedTimes=0}};function zSe(t,e,n,i,r,s,o){let a=new vO,l=new USe,c=[],h=r.isWebGL2,u=r.logarithmicDepthBuffer,d=r.vertexTextures,f=r.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(M,E,P,R,F){let B=R.fog,k=F.geometry,j=M.isMeshStandardMaterial?R.environment:null,Z=(M.isMeshStandardMaterial?n:e).get(M.envMap||j),ee=Z&&Z.mapping===A1?Z.image.height:null,O=p[M.type];M.precision!==null&&(f=r.getMaxPrecision(M.precision),f!==M.precision&&console.warn("THREE.WebGLProgram.getParameters:",M.precision,"not supported, using",f,"instead."));let W=k.morphAttributes.position||k.morphAttributes.normal||k.morphAttributes.color,H=W!==void 0?W.length:0,Y=0;k.morphAttributes.position!==void 0&&(Y=1),k.morphAttributes.normal!==void 0&&(Y=2),k.morphAttributes.color!==void 0&&(Y=3);let z,X,q,re;if(O){let $=Pl[O];z=$.vertexShader,X=$.fragmentShader}else z=M.vertexShader,X=M.fragmentShader,l.update(M),q=l.getVertexShaderID(M),re=l.getFragmentShaderID(M);let G=t.getRenderTarget(),K=M.alphaTest>0,oe=M.clearcoat>0,ve=M.iridescence>0;return{isWebGL2:h,shaderID:O,shaderName:M.type,vertexShader:z,fragmentShader:X,defines:M.defines,customVertexShaderID:q,customFragmentShaderID:re,isRawShaderMaterial:M.isRawShaderMaterial===!0,glslVersion:M.glslVersion,precision:f,instancing:F.isInstancedMesh===!0,instancingColor:F.isInstancedMesh===!0&&F.instanceColor!==null,supportsVertexTextures:d,outputEncoding:G===null?t.outputEncoding:G.isXRRenderTarget===!0?G.texture.encoding:Jl,map:!!M.map,matcap:!!M.matcap,envMap:!!Z,envMapMode:Z&&Z.mapping,envMapCubeUVHeight:ee,lightMap:!!M.lightMap,aoMap:!!M.aoMap,emissiveMap:!!M.emissiveMap,bumpMap:!!M.bumpMap,normalMap:!!M.normalMap,objectSpaceNormalMap:M.normalMapType===Kye,tangentSpaceNormalMap:M.normalMapType===Qye,decodeVideoTexture:!!M.map&&M.map.isVideoTexture===!0&&M.map.encoding===Wt,clearcoat:oe,clearcoatMap:oe&&!!M.clearcoatMap,clearcoatRoughnessMap:oe&&!!M.clearcoatRoughnessMap,clearcoatNormalMap:oe&&!!M.clearcoatNormalMap,iridescence:ve,iridescenceMap:ve&&!!M.iridescenceMap,iridescenceThicknessMap:ve&&!!M.iridescenceThicknessMap,displacementMap:!!M.displacementMap,roughnessMap:!!M.roughnessMap,metalnessMap:!!M.metalnessMap,specularMap:!!M.specularMap,specularIntensityMap:!!M.specularIntensityMap,specularColorMap:!!M.specularColorMap,opaque:M.transparent===!1&&M.blending===og,alphaMap:!!M.alphaMap,alphaTest:K,gradientMap:!!M.gradientMap,sheen:M.sheen>0,sheenColorMap:!!M.sheenColorMap,sheenRoughnessMap:!!M.sheenRoughnessMap,transmission:M.transmission>0,transmissionMap:!!M.transmissionMap,thicknessMap:!!M.thicknessMap,combine:M.combine,vertexTangents:!!M.normalMap&&!!k.attributes.tangent,vertexColors:M.vertexColors,vertexAlphas:M.vertexColors===!0&&!!k.attributes.color&&k.attributes.color.itemSize===4,vertexUvs:!!M.map||!!M.bumpMap||!!M.normalMap||!!M.specularMap||!!M.alphaMap||!!M.emissiveMap||!!M.roughnessMap||!!M.metalnessMap||!!M.clearcoatMap||!!M.clearcoatRoughnessMap||!!M.clearcoatNormalMap||!!M.iridescenceMap||!!M.iridescenceThicknessMap||!!M.displacementMap||!!M.transmissionMap||!!M.thicknessMap||!!M.specularIntensityMap||!!M.specularColorMap||!!M.sheenColorMap||!!M.sheenRoughnessMap,uvsVertexOnly:!(M.map||M.bumpMap||M.normalMap||M.specularMap||M.alphaMap||M.emissiveMap||M.roughnessMap||M.metalnessMap||M.clearcoatNormalMap||M.iridescenceMap||M.iridescenceThicknessMap||M.transmission>0||M.transmissionMap||M.thicknessMap||M.specularIntensityMap||M.specularColorMap||M.sheen>0||M.sheenColorMap||M.sheenRoughnessMap)&&!!M.displacementMap,fog:!!B,useFog:M.fog===!0,fogExp2:B&&B.isFogExp2,flatShading:!!M.flatShading,sizeAttenuation:M.sizeAttenuation,logarithmicDepthBuffer:u,skinning:F.isSkinnedMesh===!0,morphTargets:k.morphAttributes.position!==void 0,morphNormals:k.morphAttributes.normal!==void 0,morphColors:k.morphAttributes.color!==void 0,morphTargetsCount:H,morphTextureStride:Y,numDirLights:E.directional.length,numPointLights:E.point.length,numSpotLights:E.spot.length,numSpotLightMaps:E.spotLightMap.length,numRectAreaLights:E.rectArea.length,numHemiLights:E.hemi.length,numDirLightShadows:E.directionalShadowMap.length,numPointLightShadows:E.pointShadowMap.length,numSpotLightShadows:E.spotShadowMap.length,numSpotLightShadowsWithMaps:E.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:M.dithering,shadowMapEnabled:t.shadowMap.enabled&&P.length>0,shadowMapType:t.shadowMap.type,toneMapping:M.toneMapped?t.toneMapping:qc,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:M.premultipliedAlpha,doubleSided:M.side===oo,flipSided:M.side===vr,useDepthPacking:!!M.depthPacking,depthPacking:M.depthPacking||0,index0AttributeName:M.index0AttributeName,extensionDerivatives:M.extensions&&M.extensions.derivatives,extensionFragDepth:M.extensions&&M.extensions.fragDepth,extensionDrawBuffers:M.extensions&&M.extensions.drawBuffers,extensionShaderTextureLOD:M.extensions&&M.extensions.shaderTextureLOD,rendererExtensionFragDepth:h||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||i.has("EXT_shader_texture_lod"),customProgramCacheKey:M.customProgramCacheKey()}}function g(M){let E=[];if(M.shaderID?E.push(M.shaderID):(E.push(M.customVertexShaderID),E.push(M.customFragmentShaderID)),M.defines!==void 0)for(let P in M.defines)E.push(P),E.push(M.defines[P]);return M.isRawShaderMaterial===!1&&(m(E,M),y(E,M),E.push(t.outputEncoding)),E.push(M.customProgramCacheKey),E.join()}function m(M,E){M.push(E.precision),M.push(E.outputEncoding),M.push(E.envMapMode),M.push(E.envMapCubeUVHeight),M.push(E.combine),M.push(E.vertexUvs),M.push(E.fogExp2),M.push(E.sizeAttenuation),M.push(E.morphTargetsCount),M.push(E.morphAttributeCount),M.push(E.numDirLights),M.push(E.numPointLights),M.push(E.numSpotLights),M.push(E.numSpotLightMaps),M.push(E.numHemiLights),M.push(E.numRectAreaLights),M.push(E.numDirLightShadows),M.push(E.numPointLightShadows),M.push(E.numSpotLightShadows),M.push(E.numSpotLightShadowsWithMaps),M.push(E.shadowMapType),M.push(E.toneMapping),M.push(E.numClippingPlanes),M.push(E.numClipIntersection),M.push(E.depthPacking)}function y(M,E){a.disableAll(),E.isWebGL2&&a.enable(0),E.supportsVertexTextures&&a.enable(1),E.instancing&&a.enable(2),E.instancingColor&&a.enable(3),E.map&&a.enable(4),E.matcap&&a.enable(5),E.envMap&&a.enable(6),E.lightMap&&a.enable(7),E.aoMap&&a.enable(8),E.emissiveMap&&a.enable(9),E.bumpMap&&a.enable(10),E.normalMap&&a.enable(11),E.objectSpaceNormalMap&&a.enable(12),E.tangentSpaceNormalMap&&a.enable(13),E.clearcoat&&a.enable(14),E.clearcoatMap&&a.enable(15),E.clearcoatRoughnessMap&&a.enable(16),E.clearcoatNormalMap&&a.enable(17),E.iridescence&&a.enable(18),E.iridescenceMap&&a.enable(19),E.iridescenceThicknessMap&&a.enable(20),E.displacementMap&&a.enable(21),E.specularMap&&a.enable(22),E.roughnessMap&&a.enable(23),E.metalnessMap&&a.enable(24),E.gradientMap&&a.enable(25),E.alphaMap&&a.enable(26),E.alphaTest&&a.enable(27),E.vertexColors&&a.enable(28),E.vertexAlphas&&a.enable(29),E.vertexUvs&&a.enable(30),E.vertexTangents&&a.enable(31),E.uvsVertexOnly&&a.enable(32),M.push(a.mask),a.disableAll(),E.fog&&a.enable(0),E.useFog&&a.enable(1),E.flatShading&&a.enable(2),E.logarithmicDepthBuffer&&a.enable(3),E.skinning&&a.enable(4),E.morphTargets&&a.enable(5),E.morphNormals&&a.enable(6),E.morphColors&&a.enable(7),E.premultipliedAlpha&&a.enable(8),E.shadowMapEnabled&&a.enable(9),E.physicallyCorrectLights&&a.enable(10),E.doubleSided&&a.enable(11),E.flipSided&&a.enable(12),E.useDepthPacking&&a.enable(13),E.dithering&&a.enable(14),E.specularIntensityMap&&a.enable(15),E.specularColorMap&&a.enable(16),E.transmission&&a.enable(17),E.transmissionMap&&a.enable(18),E.thicknessMap&&a.enable(19),E.sheen&&a.enable(20),E.sheenColorMap&&a.enable(21),E.sheenRoughnessMap&&a.enable(22),E.decodeVideoTexture&&a.enable(23),E.opaque&&a.enable(24),M.push(a.mask)}function _(M){let E=p[M.type],P;if(E){let R=Pl[E];P=hv.clone(R.uniforms)}else P=M.uniforms;return P}function S(M,E){let P;for(let R=0,F=c.length;R<F;R++){let B=c[R];if(B.cacheKey===E){P=B,++P.usedTimes;break}}return P===void 0&&(P=new FSe(t,E,M,s),c.push(P)),P}function A(M){if(--M.usedTimes===0){let E=c.indexOf(M);c[E]=c[c.length-1],c.pop(),M.destroy()}}function b(M){l.remove(M)}function T(){l.dispose()}return{getParameters:v,getProgramCacheKey:g,getUniforms:_,acquireProgram:S,releaseProgram:A,releaseShaderCache:b,programs:c,dispose:T}}function GSe(){let t=new WeakMap;function e(s){let o=t.get(s);return o===void 0&&(o={},t.set(s,o)),o}function n(s){t.delete(s)}function i(s,o,a){t.get(s)[o]=a}function r(){t=new WeakMap}return{get:e,remove:n,update:i,dispose:r}}function HSe(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function dV(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function fV(){let t=[],e=0,n=[],i=[],r=[];function s(){e=0,n.length=0,i.length=0,r.length=0}function o(u,d,f,p,v,g){let m=t[e];return m===void 0?(m={id:u.id,object:u,geometry:d,material:f,groupOrder:p,renderOrder:u.renderOrder,z:v,group:g},t[e]=m):(m.id=u.id,m.object=u,m.geometry=d,m.material=f,m.groupOrder=p,m.renderOrder=u.renderOrder,m.z=v,m.group=g),e++,m}function a(u,d,f,p,v,g){let m=o(u,d,f,p,v,g);f.transmission>0?i.push(m):f.transparent===!0?r.push(m):n.push(m)}function l(u,d,f,p,v,g){let m=o(u,d,f,p,v,g);f.transmission>0?i.unshift(m):f.transparent===!0?r.unshift(m):n.unshift(m)}function c(u,d){n.length>1&&n.sort(u||HSe),i.length>1&&i.sort(d||dV),r.length>1&&r.sort(d||dV)}function h(){for(let u=e,d=t.length;u<d;u++){let f=t[u];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:n,transmissive:i,transparent:r,init:s,push:a,unshift:l,finish:h,sort:c}}function VSe(){let t=new WeakMap;function e(i,r){let s=t.get(i),o;return s===void 0?(o=new fV,t.set(i,[o])):r>=s.length?(o=new fV,s.push(o)):o=s[r],o}function n(){t=new WeakMap}return{get:e,dispose:n}}function jSe(){let t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new N,color:new Rt};break;case"SpotLight":n={position:new N,direction:new N,color:new Rt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new N,color:new Rt,distance:0,decay:0};break;case"HemisphereLight":n={direction:new N,skyColor:new Rt,groundColor:new Rt};break;case"RectAreaLight":n={color:new Rt,position:new N,halfWidth:new N,halfHeight:new N};break}return t[e.id]=n,n}}}function WSe(){let t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Se};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Se};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Se,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}var XSe=0;function YSe(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function qSe(t,e){let n=new jSe,i=WSe(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let h=0;h<9;h++)r.probe.push(new N);let s=new N,o=new nt,a=new nt;function l(h,u){let d=0,f=0,p=0;for(let R=0;R<9;R++)r.probe[R].set(0,0,0);let v=0,g=0,m=0,y=0,_=0,S=0,A=0,b=0,T=0,M=0;h.sort(YSe);let E=u!==!0?Math.PI:1;for(let R=0,F=h.length;R<F;R++){let B=h[R],k=B.color,j=B.intensity,Z=B.distance,ee=B.shadow&&B.shadow.map?B.shadow.map.texture:null;if(B.isAmbientLight)d+=k.r*j*E,f+=k.g*j*E,p+=k.b*j*E;else if(B.isLightProbe)for(let O=0;O<9;O++)r.probe[O].addScaledVector(B.sh.coefficients[O],j);else if(B.isDirectionalLight){let O=n.get(B);if(O.color.copy(B.color).multiplyScalar(B.intensity*E),B.castShadow){let W=B.shadow,H=i.get(B);H.shadowBias=W.bias,H.shadowNormalBias=W.normalBias,H.shadowRadius=W.radius,H.shadowMapSize=W.mapSize,r.directionalShadow[v]=H,r.directionalShadowMap[v]=ee,r.directionalShadowMatrix[v]=B.shadow.matrix,S++}r.directional[v]=O,v++}else if(B.isSpotLight){let O=n.get(B);O.position.setFromMatrixPosition(B.matrixWorld),O.color.copy(k).multiplyScalar(j*E),O.distance=Z,O.coneCos=Math.cos(B.angle),O.penumbraCos=Math.cos(B.angle*(1-B.penumbra)),O.decay=B.decay,r.spot[m]=O;let W=B.shadow;if(B.map&&(r.spotLightMap[T]=B.map,T++,W.updateMatrices(B),B.castShadow&&M++),r.spotLightMatrix[m]=W.matrix,B.castShadow){let H=i.get(B);H.shadowBias=W.bias,H.shadowNormalBias=W.normalBias,H.shadowRadius=W.radius,H.shadowMapSize=W.mapSize,r.spotShadow[m]=H,r.spotShadowMap[m]=ee,b++}m++}else if(B.isRectAreaLight){let O=n.get(B);O.color.copy(k).multiplyScalar(j),O.halfWidth.set(B.width*.5,0,0),O.halfHeight.set(0,B.height*.5,0),r.rectArea[y]=O,y++}else if(B.isPointLight){let O=n.get(B);if(O.color.copy(B.color).multiplyScalar(B.intensity*E),O.distance=B.distance,O.decay=B.decay,B.castShadow){let W=B.shadow,H=i.get(B);H.shadowBias=W.bias,H.shadowNormalBias=W.normalBias,H.shadowRadius=W.radius,H.shadowMapSize=W.mapSize,H.shadowCameraNear=W.camera.near,H.shadowCameraFar=W.camera.far,r.pointShadow[g]=H,r.pointShadowMap[g]=ee,r.pointShadowMatrix[g]=B.shadow.matrix,A++}r.point[g]=O,g++}else if(B.isHemisphereLight){let O=n.get(B);O.skyColor.copy(B.color).multiplyScalar(j*E),O.groundColor.copy(B.groundColor).multiplyScalar(j*E),r.hemi[_]=O,_++}}y>0&&(e.isWebGL2||t.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=tt.LTC_FLOAT_1,r.rectAreaLTC2=tt.LTC_FLOAT_2):t.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=tt.LTC_HALF_1,r.rectAreaLTC2=tt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=f,r.ambient[2]=p;let P=r.hash;(P.directionalLength!==v||P.pointLength!==g||P.spotLength!==m||P.rectAreaLength!==y||P.hemiLength!==_||P.numDirectionalShadows!==S||P.numPointShadows!==A||P.numSpotShadows!==b||P.numSpotMaps!==T)&&(r.directional.length=v,r.spot.length=m,r.rectArea.length=y,r.point.length=g,r.hemi.length=_,r.directionalShadow.length=S,r.directionalShadowMap.length=S,r.pointShadow.length=A,r.pointShadowMap.length=A,r.spotShadow.length=b,r.spotShadowMap.length=b,r.directionalShadowMatrix.length=S,r.pointShadowMatrix.length=A,r.spotLightMatrix.length=b+T-M,r.spotLightMap.length=T,r.numSpotLightShadowsWithMaps=M,P.directionalLength=v,P.pointLength=g,P.spotLength=m,P.rectAreaLength=y,P.hemiLength=_,P.numDirectionalShadows=S,P.numPointShadows=A,P.numSpotShadows=b,P.numSpotMaps=T,r.version=XSe++)}function c(h,u){let d=0,f=0,p=0,v=0,g=0,m=u.matrixWorldInverse;for(let y=0,_=h.length;y<_;y++){let S=h[y];if(S.isDirectionalLight){let A=r.directional[d];A.direction.setFromMatrixPosition(S.matrixWorld),s.setFromMatrixPosition(S.target.matrixWorld),A.direction.sub(s),A.direction.transformDirection(m),d++}else if(S.isSpotLight){let A=r.spot[p];A.position.setFromMatrixPosition(S.matrixWorld),A.position.applyMatrix4(m),A.direction.setFromMatrixPosition(S.matrixWorld),s.setFromMatrixPosition(S.target.matrixWorld),A.direction.sub(s),A.direction.transformDirection(m),p++}else if(S.isRectAreaLight){let A=r.rectArea[v];A.position.setFromMatrixPosition(S.matrixWorld),A.position.applyMatrix4(m),a.identity(),o.copy(S.matrixWorld),o.premultiply(m),a.extractRotation(o),A.halfWidth.set(S.width*.5,0,0),A.halfHeight.set(0,S.height*.5,0),A.halfWidth.applyMatrix4(a),A.halfHeight.applyMatrix4(a),v++}else if(S.isPointLight){let A=r.point[f];A.position.setFromMatrixPosition(S.matrixWorld),A.position.applyMatrix4(m),f++}else if(S.isHemisphereLight){let A=r.hemi[g];A.direction.setFromMatrixPosition(S.matrixWorld),A.direction.transformDirection(m),g++}}}return{setup:l,setupView:c,state:r}}function pV(t,e){let n=new qSe(t,e),i=[],r=[];function s(){i.length=0,r.length=0}function o(h){i.push(h)}function a(h){r.push(h)}function l(h){n.setup(i,h)}function c(h){n.setupView(i,h)}return{init:s,state:{lightsArray:i,shadowsArray:r,lights:n},setupLights:l,setupLightsView:c,pushLight:o,pushShadow:a}}function QSe(t,e){let n=new WeakMap;function i(s,o=0){let a=n.get(s),l;return a===void 0?(l=new pV(t,e),n.set(s,[l])):o>=a.length?(l=new pV(t,e),a.push(l)):l=a[o],l}function r(){n=new WeakMap}return{get:i,dispose:r}}var DQ=class extends M1{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=hu,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}},KSe=class extends M1{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new N,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}},JSe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,ZSe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function $Se(t,e,n){let i=new xO,r=new Se,s=new Se,o=new Zt,a=new DQ({depthPacking:vQ}),l=new KSe,c={},h=n.maxTextureSize,u={[Ka]:vr,[vr]:Ka,[oo]:oo},d=new nr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Se},radius:{value:4}},vertexShader:JSe,fragmentShader:ZSe}),f=d.clone();f.defines.HORIZONTAL_PASS=1;let p=new Lt;p.setAttribute("position",new Ut(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let v=new ao(p,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=mO,this.render=function(S,A,b){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||S.length===0)return;let T=t.getRenderTarget(),M=t.getActiveCubeFace(),E=t.getActiveMipmapLevel(),P=t.state;P.setBlending(Rr),P.buffers.color.setClear(1,1,1,1),P.buffers.depth.setTest(!0),P.setScissorTest(!1);for(let R=0,F=S.length;R<F;R++){let B=S[R],k=B.shadow;if(k===void 0){console.warn("THREE.WebGLShadowMap:",B,"has no shadow.");continue}if(k.autoUpdate===!1&&k.needsUpdate===!1)continue;r.copy(k.mapSize);let j=k.getFrameExtents();if(r.multiply(j),s.copy(k.mapSize),(r.x>h||r.y>h)&&(r.x>h&&(s.x=Math.floor(h/j.x),r.x=s.x*j.x,k.mapSize.x=s.x),r.y>h&&(s.y=Math.floor(h/j.y),r.y=s.y*j.y,k.mapSize.y=s.y)),k.map===null){let ee=this.type!==J0?{minFilter:si,magFilter:si}:{};k.map=new $i(r.x,r.y,ee),k.map.texture.name=B.name+".shadowMap",k.camera.updateProjectionMatrix()}t.setRenderTarget(k.map),t.clear();let Z=k.getViewportCount();for(let ee=0;ee<Z;ee++){let O=k.getViewport(ee);o.set(s.x*O.x,s.y*O.y,s.x*O.z,s.y*O.w),P.viewport(o),k.updateMatrices(B,ee),i=k.getFrustum(),_(A,b,k.camera,B,this.type)}k.isPointLightShadow!==!0&&this.type===J0&&m(k,b),k.needsUpdate=!1}g.needsUpdate=!1,t.setRenderTarget(T,M,E)};function m(S,A){let b=e.update(v);d.defines.VSM_SAMPLES!==S.blurSamples&&(d.defines.VSM_SAMPLES=S.blurSamples,f.defines.VSM_SAMPLES=S.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),S.mapPass===null&&(S.mapPass=new $i(r.x,r.y)),d.uniforms.shadow_pass.value=S.map.texture,d.uniforms.resolution.value=S.mapSize,d.uniforms.radius.value=S.radius,t.setRenderTarget(S.mapPass),t.clear(),t.renderBufferDirect(A,null,b,d,v,null),f.uniforms.shadow_pass.value=S.mapPass.texture,f.uniforms.resolution.value=S.mapSize,f.uniforms.radius.value=S.radius,t.setRenderTarget(S.map),t.clear(),t.renderBufferDirect(A,null,b,f,v,null)}function y(S,A,b,T,M,E){let P=null,R=b.isPointLight===!0?S.customDistanceMaterial:S.customDepthMaterial;if(R!==void 0)P=R;else if(P=b.isPointLight===!0?l:a,t.localClippingEnabled&&A.clipShadows===!0&&Array.isArray(A.clippingPlanes)&&A.clippingPlanes.length!==0||A.displacementMap&&A.displacementScale!==0||A.alphaMap&&A.alphaTest>0||A.map&&A.alphaTest>0){let F=P.uuid,B=A.uuid,k=c[F];k===void 0&&(k={},c[F]=k);let j=k[B];j===void 0&&(j=P.clone(),k[B]=j),P=j}return P.visible=A.visible,P.wireframe=A.wireframe,E===J0?P.side=A.shadowSide!==null?A.shadowSide:A.side:P.side=A.shadowSide!==null?A.shadowSide:u[A.side],P.alphaMap=A.alphaMap,P.alphaTest=A.alphaTest,P.map=A.map,P.clipShadows=A.clipShadows,P.clippingPlanes=A.clippingPlanes,P.clipIntersection=A.clipIntersection,P.displacementMap=A.displacementMap,P.displacementScale=A.displacementScale,P.displacementBias=A.displacementBias,P.wireframeLinewidth=A.wireframeLinewidth,P.linewidth=A.linewidth,b.isPointLight===!0&&P.isMeshDistanceMaterial===!0&&(P.referencePosition.setFromMatrixPosition(b.matrixWorld),P.nearDistance=T,P.farDistance=M),P}function _(S,A,b,T,M){if(S.visible===!1)return;if(S.layers.test(A.layers)&&(S.isMesh||S.isLine||S.isPoints)&&(S.castShadow||S.receiveShadow&&M===J0)&&(!S.frustumCulled||i.intersectsObject(S))){S.modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,S.matrixWorld);let P=e.update(S),R=S.material;if(Array.isArray(R)){let F=P.groups;for(let B=0,k=F.length;B<k;B++){let j=F[B],Z=R[j.materialIndex];if(Z&&Z.visible){let ee=y(S,Z,T,b.near,b.far,M);t.renderBufferDirect(b,null,P,ee,S,j)}}}else if(R.visible){let F=y(S,R,T,b.near,b.far,M);t.renderBufferDirect(b,null,P,F,S,null)}}let E=S.children;for(let P=0,R=E.length;P<R;P++)_(E[P],A,b,T,M)}}function ebe(t,e,n){let i=n.isWebGL2;function r(){let J=!1,fe=new Zt,be=null,Oe=new Zt(0,0,0,0);return{setMask:function(qe){be!==qe&&!J&&(t.colorMask(qe,qe,qe,qe),be=qe)},setLocked:function(qe){J=qe},setClear:function(qe,vt,Et,un,ji){ji===!0&&(qe*=un,vt*=un,Et*=un),fe.set(qe,vt,Et,un),Oe.equals(fe)===!1&&(t.clearColor(qe,vt,Et,un),Oe.copy(fe))},reset:function(){J=!1,be=null,Oe.set(-1,0,0,0)}}}function s(){let J=!1,fe=null,be=null,Oe=null;return{setTest:function(qe){qe?K(2929):oe(2929)},setMask:function(qe){fe!==qe&&!J&&(t.depthMask(qe),fe=qe)},setFunc:function(qe){if(be!==qe){switch(qe){case xye:t.depthFunc(512);break;case _ye:t.depthFunc(519);break;case wye:t.depthFunc(513);break;case SL:t.depthFunc(515);break;case Sye:t.depthFunc(514);break;case bye:t.depthFunc(518);break;case Aye:t.depthFunc(516);break;case Mye:t.depthFunc(517);break;default:t.depthFunc(515)}be=qe}},setLocked:function(qe){J=qe},setClear:function(qe){Oe!==qe&&(t.clearDepth(qe),Oe=qe)},reset:function(){J=!1,fe=null,be=null,Oe=null}}}function o(){let J=!1,fe=null,be=null,Oe=null,qe=null,vt=null,Et=null,un=null,ji=null;return{setTest:function(Ot){J||(Ot?K(2960):oe(2960))},setMask:function(Ot){fe!==Ot&&!J&&(t.stencilMask(Ot),fe=Ot)},setFunc:function(Ot,jn,Wn){(be!==Ot||Oe!==jn||qe!==Wn)&&(t.stencilFunc(Ot,jn,Wn),be=Ot,Oe=jn,qe=Wn)},setOp:function(Ot,jn,Wn){(vt!==Ot||Et!==jn||un!==Wn)&&(t.stencilOp(Ot,jn,Wn),vt=Ot,Et=jn,un=Wn)},setLocked:function(Ot){J=Ot},setClear:function(Ot){ji!==Ot&&(t.clearStencil(Ot),ji=Ot)},reset:function(){J=!1,fe=null,be=null,Oe=null,qe=null,vt=null,Et=null,un=null,ji=null}}}let a=new r,l=new s,c=new o,h=new WeakMap,u=new WeakMap,d={},f={},p=new WeakMap,v=[],g=null,m=!1,y=null,_=null,S=null,A=null,b=null,T=null,M=null,E=!1,P=null,R=null,F=null,B=null,k=null,j=t.getParameter(35661),Z=!1,ee=0,O=t.getParameter(7938);O.indexOf("WebGL")!==-1?(ee=parseFloat(/^WebGL (\d)/.exec(O)[1]),Z=ee>=1):O.indexOf("OpenGL ES")!==-1&&(ee=parseFloat(/^OpenGL ES (\d)/.exec(O)[1]),Z=ee>=2);let W=null,H={},Y=t.getParameter(3088),z=t.getParameter(2978),X=new Zt().fromArray(Y),q=new Zt().fromArray(z);function re(J,fe,be){let Oe=new Uint8Array(4),qe=t.createTexture();t.bindTexture(J,qe),t.texParameteri(J,10241,9728),t.texParameteri(J,10240,9728);for(let vt=0;vt<be;vt++)t.texImage2D(fe+vt,0,6408,1,1,0,6408,5121,Oe);return qe}let G={};G[3553]=re(3553,3553,1),G[34067]=re(34067,34069,6),a.setClear(0,0,0,1),l.setClear(1),c.setClear(0),K(2929),l.setFunc(SL),Ae(!1),we(sH),K(2884),me(Rr);function K(J){d[J]!==!0&&(t.enable(J),d[J]=!0)}function oe(J){d[J]!==!1&&(t.disable(J),d[J]=!1)}function ve(J,fe){return f[J]!==fe?(t.bindFramebuffer(J,fe),f[J]=fe,i&&(J===36009&&(f[36160]=fe),J===36160&&(f[36009]=fe)),!0):!1}function $(J,fe){let be=v,Oe=!1;if(J)if(be=p.get(fe),be===void 0&&(be=[],p.set(fe,be)),J.isWebGLMultipleRenderTargets){let qe=J.texture;if(be.length!==qe.length||be[0]!==36064){for(let vt=0,Et=qe.length;vt<Et;vt++)be[vt]=36064+vt;be.length=qe.length,Oe=!0}}else be[0]!==36064&&(be[0]=36064,Oe=!0);else be[0]!==1029&&(be[0]=1029,Oe=!0);Oe&&(n.isWebGL2?t.drawBuffers(be):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(be))}function se(J){return g!==J?(t.useProgram(J),g=J,!0):!1}let ne={[dm]:32774,[lye]:32778,[cye]:32779};if(i)ne[cH]=32775,ne[uH]=32776;else{let J=e.get("EXT_blend_minmax");J!==null&&(ne[cH]=J.MIN_EXT,ne[uH]=J.MAX_EXT)}let ie={[uye]:0,[hye]:1,[dye]:768,[dQ]:770,[yye]:776,[gye]:774,[pye]:772,[fye]:769,[fQ]:771,[vye]:775,[mye]:773};function me(J,fe,be,Oe,qe,vt,Et,un){if(J===Rr){m===!0&&(oe(3042),m=!1);return}if(m===!1&&(K(3042),m=!0),J!==aye){if(J!==y||un!==E){if((_!==dm||b!==dm)&&(t.blendEquation(32774),_=dm,b=dm),un)switch(J){case og:t.blendFuncSeparate(1,771,1,771);break;case oH:t.blendFunc(1,1);break;case aH:t.blendFuncSeparate(0,769,0,1);break;case lH:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",J);break}else switch(J){case og:t.blendFuncSeparate(770,771,1,771);break;case oH:t.blendFunc(770,1);break;case aH:t.blendFuncSeparate(0,769,0,1);break;case lH:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",J);break}S=null,A=null,T=null,M=null,y=J,E=un}return}qe=qe||fe,vt=vt||be,Et=Et||Oe,(fe!==_||qe!==b)&&(t.blendEquationSeparate(ne[fe],ne[qe]),_=fe,b=qe),(be!==S||Oe!==A||vt!==T||Et!==M)&&(t.blendFuncSeparate(ie[be],ie[Oe],ie[vt],ie[Et]),S=be,A=Oe,T=vt,M=Et),y=J,E=!1}function xe(J,fe){J.side===oo?oe(2884):K(2884);let be=J.side===vr;fe&&(be=!be),Ae(be),J.blending===og&&J.transparent===!1?me(Rr):me(J.blending,J.blendEquation,J.blendSrc,J.blendDst,J.blendEquationAlpha,J.blendSrcAlpha,J.blendDstAlpha,J.premultipliedAlpha),l.setFunc(J.depthFunc),l.setTest(J.depthTest),l.setMask(J.depthWrite),a.setMask(J.colorWrite);let Oe=J.stencilWrite;c.setTest(Oe),Oe&&(c.setMask(J.stencilWriteMask),c.setFunc(J.stencilFunc,J.stencilRef,J.stencilFuncMask),c.setOp(J.stencilFail,J.stencilZFail,J.stencilZPass)),Re(J.polygonOffset,J.polygonOffsetFactor,J.polygonOffsetUnits),J.alphaToCoverage===!0?K(32926):oe(32926)}function Ae(J){P!==J&&(J?t.frontFace(2304):t.frontFace(2305),P=J)}function we(J){J!==sye?(K(2884),J!==R&&(J===sH?t.cullFace(1029):J===oye?t.cullFace(1028):t.cullFace(1032))):oe(2884),R=J}function Ee(J){J!==F&&(Z&&t.lineWidth(J),F=J)}function Re(J,fe,be){J?(K(32823),(B!==fe||k!==be)&&(t.polygonOffset(fe,be),B=fe,k=be)):oe(32823)}function Ue(J){J?K(3089):oe(3089)}function Ne(J){J===void 0&&(J=33984+j-1),W!==J&&(t.activeTexture(J),W=J)}function U(J,fe,be){be===void 0&&(W===null?be=33984+j-1:be=W);let Oe=H[be];Oe===void 0&&(Oe={type:void 0,texture:void 0},H[be]=Oe),(Oe.type!==J||Oe.texture!==fe)&&(W!==be&&(t.activeTexture(be),W=be),t.bindTexture(J,fe||G[J]),Oe.type=J,Oe.texture=fe)}function L(){let J=H[W];J!==void 0&&J.type!==void 0&&(t.bindTexture(J.type,null),J.type=void 0,J.texture=void 0)}function te(){try{t.compressedTexImage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function _e(){try{t.compressedTexImage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Te(){try{t.texSubImage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Ie(){try{t.texSubImage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Qe(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Ge(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function ye(){try{t.texStorage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Ve(){try{t.texStorage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function ue(){try{t.texImage2D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Me(){try{t.texImage3D.apply(t,arguments)}catch(J){console.error("THREE.WebGLState:",J)}}function Be(J){X.equals(J)===!1&&(t.scissor(J.x,J.y,J.z,J.w),X.copy(J))}function ze(J){q.equals(J)===!1&&(t.viewport(J.x,J.y,J.z,J.w),q.copy(J))}function $e(J,fe){let be=u.get(fe);be===void 0&&(be=new WeakMap,u.set(fe,be));let Oe=be.get(J);Oe===void 0&&(Oe=t.getUniformBlockIndex(fe,J.name),be.set(J,Oe))}function dt(J,fe){let be=u.get(fe).get(J);h.get(fe)!==be&&(t.uniformBlockBinding(fe,be,J.__bindingPointIndex),h.set(fe,be))}function Bt(){t.disable(3042),t.disable(2884),t.disable(2929),t.disable(32823),t.disable(3089),t.disable(2960),t.disable(32926),t.blendEquation(32774),t.blendFunc(1,0),t.blendFuncSeparate(1,0,1,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(513),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(519,0,4294967295),t.stencilOp(7680,7680,7680),t.clearStencil(0),t.cullFace(1029),t.frontFace(2305),t.polygonOffset(0,0),t.activeTexture(33984),t.bindFramebuffer(36160,null),i===!0&&(t.bindFramebuffer(36009,null),t.bindFramebuffer(36008,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),d={},W=null,H={},f={},p=new WeakMap,v=[],g=null,m=!1,y=null,_=null,S=null,A=null,b=null,T=null,M=null,E=!1,P=null,R=null,F=null,B=null,k=null,X.set(0,0,t.canvas.width,t.canvas.height),q.set(0,0,t.canvas.width,t.canvas.height),a.reset(),l.reset(),c.reset()}return{buffers:{color:a,depth:l,stencil:c},enable:K,disable:oe,bindFramebuffer:ve,drawBuffers:$,useProgram:se,setBlending:me,setMaterial:xe,setFlipSided:Ae,setCullFace:we,setLineWidth:Ee,setPolygonOffset:Re,setScissorTest:Ue,activeTexture:Ne,bindTexture:U,unbindTexture:L,compressedTexImage2D:te,compressedTexImage3D:_e,texImage2D:ue,texImage3D:Me,updateUBOMapping:$e,uniformBlockBinding:dt,texStorage2D:ye,texStorage3D:Ve,texSubImage2D:Te,texSubImage3D:Ie,compressedTexSubImage2D:Qe,compressedTexSubImage3D:Ge,scissor:Be,viewport:ze,reset:Bt}}function tbe(t,e,n,i,r,s,o){let a=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,h=r.maxTextureSize,u=r.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap,v,g=new WeakMap,m=!1;try{m=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(U,L){return m?new OffscreenCanvas(U,L):bA("canvas")}function _(U,L,te,_e){let Te=1;if((U.width>_e||U.height>_e)&&(Te=_e/Math.max(U.width,U.height)),Te<1||L===!0)if(typeof HTMLImageElement<"u"&&U instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&U instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&U instanceof ImageBitmap){let Ie=L?SA:Math.floor,Qe=Ie(Te*U.width),Ge=Ie(Te*U.height);v===void 0&&(v=y(Qe,Ge));let ye=te?y(Qe,Ge):v;return ye.width=Qe,ye.height=Ge,ye.getContext("2d").drawImage(U,0,0,Qe,Ge),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+U.width+"x"+U.height+") to ("+Qe+"x"+Ge+")."),ye}else return"data"in U&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+U.width+"x"+U.height+")."),U;return U}function S(U){return TL(U.width)&&TL(U.height)}function A(U){return a?!1:U.wrapS!==to||U.wrapT!==to||U.minFilter!==si&&U.minFilter!==En}function b(U,L){return U.generateMipmaps&&L&&U.minFilter!==si&&U.minFilter!==En}function T(U){t.generateMipmap(U)}function M(U,L,te,_e,Te=!1){if(a===!1)return L;if(U!==null){if(t[U]!==void 0)return t[U];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+U+"'")}let Ie=L;return L===6403&&(te===5126&&(Ie=33326),te===5131&&(Ie=33325),te===5121&&(Ie=33321)),L===33319&&(te===5126&&(Ie=33328),te===5131&&(Ie=33327),te===5121&&(Ie=33323)),L===6408&&(te===5126&&(Ie=34836),te===5131&&(Ie=34842),te===5121&&(Ie=_e===Wt&&Te===!1?35907:32856),te===32819&&(Ie=32854),te===32820&&(Ie=32855)),(Ie===33325||Ie===33326||Ie===33327||Ie===33328||Ie===34842||Ie===34836)&&e.get("EXT_color_buffer_float"),Ie}function E(U,L,te){return b(U,te)===!0||U.isFramebufferTexture&&U.minFilter!==si&&U.minFilter!==En?Math.log2(Math.max(L.width,L.height))+1:U.mipmaps!==void 0&&U.mipmaps.length>0?U.mipmaps.length:U.isCompressedTexture&&Array.isArray(U.image)?L.mipmaps.length:1}function P(U){return U===si||U===hH||U===bP?9728:9729}function R(U){let L=U.target;L.removeEventListener("dispose",R),B(L),L.isVideoTexture&&p.delete(L)}function F(U){let L=U.target;L.removeEventListener("dispose",F),j(L)}function B(U){let L=i.get(U);if(L.__webglInit===void 0)return;let te=U.source,_e=g.get(te);if(_e){let Te=_e[L.__cacheKey];Te.usedTimes--,Te.usedTimes===0&&k(U),Object.keys(_e).length===0&&g.delete(te)}i.remove(U)}function k(U){let L=i.get(U);t.deleteTexture(L.__webglTexture);let te=U.source,_e=g.get(te);delete _e[L.__cacheKey],o.memory.textures--}function j(U){let L=U.texture,te=i.get(U),_e=i.get(L);if(_e.__webglTexture!==void 0&&(t.deleteTexture(_e.__webglTexture),o.memory.textures--),U.depthTexture&&U.depthTexture.dispose(),U.isWebGLCubeRenderTarget)for(let Te=0;Te<6;Te++)t.deleteFramebuffer(te.__webglFramebuffer[Te]),te.__webglDepthbuffer&&t.deleteRenderbuffer(te.__webglDepthbuffer[Te]);else{if(t.deleteFramebuffer(te.__webglFramebuffer),te.__webglDepthbuffer&&t.deleteRenderbuffer(te.__webglDepthbuffer),te.__webglMultisampledFramebuffer&&t.deleteFramebuffer(te.__webglMultisampledFramebuffer),te.__webglColorRenderbuffer)for(let Te=0;Te<te.__webglColorRenderbuffer.length;Te++)te.__webglColorRenderbuffer[Te]&&t.deleteRenderbuffer(te.__webglColorRenderbuffer[Te]);te.__webglDepthRenderbuffer&&t.deleteRenderbuffer(te.__webglDepthRenderbuffer)}if(U.isWebGLMultipleRenderTargets)for(let Te=0,Ie=L.length;Te<Ie;Te++){let Qe=i.get(L[Te]);Qe.__webglTexture&&(t.deleteTexture(Qe.__webglTexture),o.memory.textures--),i.remove(L[Te])}i.remove(L),i.remove(U)}let Z=0;function ee(){Z=0}function O(){let U=Z;return U>=l&&console.warn("THREE.WebGLTextures: Trying to use "+U+" texture units while this GPU supports only "+l),Z+=1,U}function W(U){let L=[];return L.push(U.wrapS),L.push(U.wrapT),L.push(U.wrapR||0),L.push(U.magFilter),L.push(U.minFilter),L.push(U.anisotropy),L.push(U.internalFormat),L.push(U.format),L.push(U.type),L.push(U.generateMipmaps),L.push(U.premultiplyAlpha),L.push(U.flipY),L.push(U.unpackAlignment),L.push(U.encoding),L.join()}function H(U,L){let te=i.get(U);if(U.isVideoTexture&&Ue(U),U.isRenderTargetTexture===!1&&U.version>0&&te.__version!==U.version){let _e=U.image;if(_e===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(_e.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{oe(te,U,L);return}}n.bindTexture(3553,te.__webglTexture,33984+L)}function Y(U,L){let te=i.get(U);if(U.version>0&&te.__version!==U.version){oe(te,U,L);return}n.bindTexture(35866,te.__webglTexture,33984+L)}function z(U,L){let te=i.get(U);if(U.version>0&&te.__version!==U.version){oe(te,U,L);return}n.bindTexture(32879,te.__webglTexture,33984+L)}function X(U,L){let te=i.get(U);if(U.version>0&&te.__version!==U.version){ve(te,U,L);return}n.bindTexture(34067,te.__webglTexture,33984+L)}let q={[Sx]:10497,[to]:33071,[ML]:33648},re={[si]:9728,[hH]:9984,[bP]:9986,[En]:9729,[Iye]:9985,[Ug]:9987};function G(U,L,te){if(te?(t.texParameteri(U,10242,q[L.wrapS]),t.texParameteri(U,10243,q[L.wrapT]),(U===32879||U===35866)&&t.texParameteri(U,32882,q[L.wrapR]),t.texParameteri(U,10240,re[L.magFilter]),t.texParameteri(U,10241,re[L.minFilter])):(t.texParameteri(U,10242,33071),t.texParameteri(U,10243,33071),(U===32879||U===35866)&&t.texParameteri(U,32882,33071),(L.wrapS!==to||L.wrapT!==to)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(U,10240,P(L.magFilter)),t.texParameteri(U,10241,P(L.minFilter)),L.minFilter!==si&&L.minFilter!==En&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){let _e=e.get("EXT_texture_filter_anisotropic");if(L.magFilter===si||L.minFilter!==bP&&L.minFilter!==Ug||L.type===ch&&e.has("OES_texture_float_linear")===!1||a===!1&&L.type===bx&&e.has("OES_texture_half_float_linear")===!1)return;(L.anisotropy>1||i.get(L).__currentAnisotropy)&&(t.texParameterf(U,_e.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(L.anisotropy,r.getMaxAnisotropy())),i.get(L).__currentAnisotropy=L.anisotropy)}}function K(U,L){let te=!1;U.__webglInit===void 0&&(U.__webglInit=!0,L.addEventListener("dispose",R));let _e=L.source,Te=g.get(_e);Te===void 0&&(Te={},g.set(_e,Te));let Ie=W(L);if(Ie!==U.__cacheKey){Te[Ie]===void 0&&(Te[Ie]={texture:t.createTexture(),usedTimes:0},o.memory.textures++,te=!0),Te[Ie].usedTimes++;let Qe=Te[U.__cacheKey];Qe!==void 0&&(Te[U.__cacheKey].usedTimes--,Qe.usedTimes===0&&k(L)),U.__cacheKey=Ie,U.__webglTexture=Te[Ie].texture}return te}function oe(U,L,te){let _e=3553;(L.isDataArrayTexture||L.isCompressedArrayTexture)&&(_e=35866),L.isData3DTexture&&(_e=32879);let Te=K(U,L),Ie=L.source;n.bindTexture(_e,U.__webglTexture,33984+te);let Qe=i.get(Ie);if(Ie.version!==Qe.__version||Te===!0){n.activeTexture(33984+te),t.pixelStorei(37440,L.flipY),t.pixelStorei(37441,L.premultiplyAlpha),t.pixelStorei(3317,L.unpackAlignment),t.pixelStorei(37443,0);let Ge=A(L)&&S(L.image)===!1,ye=_(L.image,Ge,!1,h);ye=Ne(L,ye);let Ve=S(ye)||a,ue=s.convert(L.format,L.encoding),Me=s.convert(L.type),Be=M(L.internalFormat,ue,Me,L.encoding,L.isVideoTexture);G(_e,L,Ve);let ze,$e=L.mipmaps,dt=a&&L.isVideoTexture!==!0,Bt=Qe.__version===void 0||Te===!0,J=E(L,ye,Ve);if(L.isDepthTexture)Be=6402,a?L.type===ch?Be=36012:L.type===lh?Be=33190:L.type===ff?Be=35056:Be=33189:L.type===ch&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),L.format===pf&&Be===6402&&L.type!==gQ&&L.type!==lh&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),L.type=lh,Me=s.convert(L.type)),L.format===If&&Be===6402&&(Be=34041,L.type!==ff&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),L.type=ff,Me=s.convert(L.type))),Bt&&(dt?n.texStorage2D(3553,1,Be,ye.width,ye.height):n.texImage2D(3553,0,Be,ye.width,ye.height,0,ue,Me,null));else if(L.isDataTexture)if($e.length>0&&Ve){dt&&Bt&&n.texStorage2D(3553,J,Be,$e[0].width,$e[0].height);for(let fe=0,be=$e.length;fe<be;fe++)ze=$e[fe],dt?n.texSubImage2D(3553,fe,0,0,ze.width,ze.height,ue,Me,ze.data):n.texImage2D(3553,fe,Be,ze.width,ze.height,0,ue,Me,ze.data);L.generateMipmaps=!1}else dt?(Bt&&n.texStorage2D(3553,J,Be,ye.width,ye.height),n.texSubImage2D(3553,0,0,0,ye.width,ye.height,ue,Me,ye.data)):n.texImage2D(3553,0,Be,ye.width,ye.height,0,ue,Me,ye.data);else if(L.isCompressedTexture)if(L.isCompressedArrayTexture){dt&&Bt&&n.texStorage3D(35866,J,Be,$e[0].width,$e[0].height,ye.depth);for(let fe=0,be=$e.length;fe<be;fe++)ze=$e[fe],L.format!==Fa?ue!==null?dt?n.compressedTexSubImage3D(35866,fe,0,0,0,ze.width,ze.height,ye.depth,ue,ze.data,0,0):n.compressedTexImage3D(35866,fe,Be,ze.width,ze.height,ye.depth,0,ze.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):dt?n.texSubImage3D(35866,fe,0,0,0,ze.width,ze.height,ye.depth,ue,Me,ze.data):n.texImage3D(35866,fe,Be,ze.width,ze.height,ye.depth,0,ue,Me,ze.data)}else{dt&&Bt&&n.texStorage2D(3553,J,Be,$e[0].width,$e[0].height);for(let fe=0,be=$e.length;fe<be;fe++)ze=$e[fe],L.format!==Fa?ue!==null?dt?n.compressedTexSubImage2D(3553,fe,0,0,ze.width,ze.height,ue,ze.data):n.compressedTexImage2D(3553,fe,Be,ze.width,ze.height,0,ze.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):dt?n.texSubImage2D(3553,fe,0,0,ze.width,ze.height,ue,Me,ze.data):n.texImage2D(3553,fe,Be,ze.width,ze.height,0,ue,Me,ze.data)}else if(L.isDataArrayTexture)dt?(Bt&&n.texStorage3D(35866,J,Be,ye.width,ye.height,ye.depth),n.texSubImage3D(35866,0,0,0,0,ye.width,ye.height,ye.depth,ue,Me,ye.data)):n.texImage3D(35866,0,Be,ye.width,ye.height,ye.depth,0,ue,Me,ye.data);else if(L.isData3DTexture)dt?(Bt&&n.texStorage3D(32879,J,Be,ye.width,ye.height,ye.depth),n.texSubImage3D(32879,0,0,0,0,ye.width,ye.height,ye.depth,ue,Me,ye.data)):n.texImage3D(32879,0,Be,ye.width,ye.height,ye.depth,0,ue,Me,ye.data);else if(L.isFramebufferTexture){if(Bt)if(dt)n.texStorage2D(3553,J,Be,ye.width,ye.height);else{let fe=ye.width,be=ye.height;for(let Oe=0;Oe<J;Oe++)n.texImage2D(3553,Oe,Be,fe,be,0,ue,Me,null),fe>>=1,be>>=1}}else if($e.length>0&&Ve){dt&&Bt&&n.texStorage2D(3553,J,Be,$e[0].width,$e[0].height);for(let fe=0,be=$e.length;fe<be;fe++)ze=$e[fe],dt?n.texSubImage2D(3553,fe,0,0,ue,Me,ze):n.texImage2D(3553,fe,Be,ue,Me,ze);L.generateMipmaps=!1}else dt?(Bt&&n.texStorage2D(3553,J,Be,ye.width,ye.height),n.texSubImage2D(3553,0,0,0,ue,Me,ye)):n.texImage2D(3553,0,Be,ue,Me,ye);b(L,Ve)&&T(_e),Qe.__version=Ie.version,L.onUpdate&&L.onUpdate(L)}U.__version=L.version}function ve(U,L,te){if(L.image.length!==6)return;let _e=K(U,L),Te=L.source;n.bindTexture(34067,U.__webglTexture,33984+te);let Ie=i.get(Te);if(Te.version!==Ie.__version||_e===!0){n.activeTexture(33984+te),t.pixelStorei(37440,L.flipY),t.pixelStorei(37441,L.premultiplyAlpha),t.pixelStorei(3317,L.unpackAlignment),t.pixelStorei(37443,0);let Qe=L.isCompressedTexture||L.image[0].isCompressedTexture,Ge=L.image[0]&&L.image[0].isDataTexture,ye=[];for(let fe=0;fe<6;fe++)!Qe&&!Ge?ye[fe]=_(L.image[fe],!1,!0,c):ye[fe]=Ge?L.image[fe].image:L.image[fe],ye[fe]=Ne(L,ye[fe]);let Ve=ye[0],ue=S(Ve)||a,Me=s.convert(L.format,L.encoding),Be=s.convert(L.type),ze=M(L.internalFormat,Me,Be,L.encoding),$e=a&&L.isVideoTexture!==!0,dt=Ie.__version===void 0||_e===!0,Bt=E(L,Ve,ue);G(34067,L,ue);let J;if(Qe){$e&&dt&&n.texStorage2D(34067,Bt,ze,Ve.width,Ve.height);for(let fe=0;fe<6;fe++){J=ye[fe].mipmaps;for(let be=0;be<J.length;be++){let Oe=J[be];L.format!==Fa?Me!==null?$e?n.compressedTexSubImage2D(34069+fe,be,0,0,Oe.width,Oe.height,Me,Oe.data):n.compressedTexImage2D(34069+fe,be,ze,Oe.width,Oe.height,0,Oe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):$e?n.texSubImage2D(34069+fe,be,0,0,Oe.width,Oe.height,Me,Be,Oe.data):n.texImage2D(34069+fe,be,ze,Oe.width,Oe.height,0,Me,Be,Oe.data)}}}else{J=L.mipmaps,$e&&dt&&(J.length>0&&Bt++,n.texStorage2D(34067,Bt,ze,ye[0].width,ye[0].height));for(let fe=0;fe<6;fe++)if(Ge){$e?n.texSubImage2D(34069+fe,0,0,0,ye[fe].width,ye[fe].height,Me,Be,ye[fe].data):n.texImage2D(34069+fe,0,ze,ye[fe].width,ye[fe].height,0,Me,Be,ye[fe].data);for(let be=0;be<J.length;be++){let Oe=J[be].image[fe].image;$e?n.texSubImage2D(34069+fe,be+1,0,0,Oe.width,Oe.height,Me,Be,Oe.data):n.texImage2D(34069+fe,be+1,ze,Oe.width,Oe.height,0,Me,Be,Oe.data)}}else{$e?n.texSubImage2D(34069+fe,0,0,0,Me,Be,ye[fe]):n.texImage2D(34069+fe,0,ze,Me,Be,ye[fe]);for(let be=0;be<J.length;be++){let Oe=J[be];$e?n.texSubImage2D(34069+fe,be+1,0,0,Me,Be,Oe.image[fe]):n.texImage2D(34069+fe,be+1,ze,Me,Be,Oe.image[fe])}}}b(L,ue)&&T(34067),Ie.__version=Te.version,L.onUpdate&&L.onUpdate(L)}U.__version=L.version}function $(U,L,te,_e,Te){let Ie=s.convert(te.format,te.encoding),Qe=s.convert(te.type),Ge=M(te.internalFormat,Ie,Qe,te.encoding);i.get(L).__hasExternalTextures||(Te===32879||Te===35866?n.texImage3D(Te,0,Ge,L.width,L.height,L.depth,0,Ie,Qe,null):n.texImage2D(Te,0,Ge,L.width,L.height,0,Ie,Qe,null)),n.bindFramebuffer(36160,U),Re(L)?d.framebufferTexture2DMultisampleEXT(36160,_e,Te,i.get(te).__webglTexture,0,Ee(L)):(Te===3553||Te>=34069&&Te<=34074)&&t.framebufferTexture2D(36160,_e,Te,i.get(te).__webglTexture,0),n.bindFramebuffer(36160,null)}function se(U,L,te){if(t.bindRenderbuffer(36161,U),L.depthBuffer&&!L.stencilBuffer){let _e=33189;if(te||Re(L)){let Te=L.depthTexture;Te&&Te.isDepthTexture&&(Te.type===ch?_e=36012:Te.type===lh&&(_e=33190));let Ie=Ee(L);Re(L)?d.renderbufferStorageMultisampleEXT(36161,Ie,_e,L.width,L.height):t.renderbufferStorageMultisample(36161,Ie,_e,L.width,L.height)}else t.renderbufferStorage(36161,_e,L.width,L.height);t.framebufferRenderbuffer(36160,36096,36161,U)}else if(L.depthBuffer&&L.stencilBuffer){let _e=Ee(L);te&&Re(L)===!1?t.renderbufferStorageMultisample(36161,_e,35056,L.width,L.height):Re(L)?d.renderbufferStorageMultisampleEXT(36161,_e,35056,L.width,L.height):t.renderbufferStorage(36161,34041,L.width,L.height),t.framebufferRenderbuffer(36160,33306,36161,U)}else{let _e=L.isWebGLMultipleRenderTargets===!0?L.texture:[L.texture];for(let Te=0;Te<_e.length;Te++){let Ie=_e[Te],Qe=s.convert(Ie.format,Ie.encoding),Ge=s.convert(Ie.type),ye=M(Ie.internalFormat,Qe,Ge,Ie.encoding),Ve=Ee(L);te&&Re(L)===!1?t.renderbufferStorageMultisample(36161,Ve,ye,L.width,L.height):Re(L)?d.renderbufferStorageMultisampleEXT(36161,Ve,ye,L.width,L.height):t.renderbufferStorage(36161,ye,L.width,L.height)}}t.bindRenderbuffer(36161,null)}function ne(U,L){if(L&&L.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,U),!(L.depthTexture&&L.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(L.depthTexture).__webglTexture||L.depthTexture.image.width!==L.width||L.depthTexture.image.height!==L.height)&&(L.depthTexture.image.width=L.width,L.depthTexture.image.height=L.height,L.depthTexture.needsUpdate=!0),H(L.depthTexture,0);let te=i.get(L.depthTexture).__webglTexture,_e=Ee(L);if(L.depthTexture.format===pf)Re(L)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,te,0,_e):t.framebufferTexture2D(36160,36096,3553,te,0);else if(L.depthTexture.format===If)Re(L)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,te,0,_e):t.framebufferTexture2D(36160,33306,3553,te,0);else throw new Error("Unknown depthTexture format")}function ie(U){let L=i.get(U),te=U.isWebGLCubeRenderTarget===!0;if(U.depthTexture&&!L.__autoAllocateDepthBuffer){if(te)throw new Error("target.depthTexture not supported in Cube render targets");ne(L.__webglFramebuffer,U)}else if(te){L.__webglDepthbuffer=[];for(let _e=0;_e<6;_e++)n.bindFramebuffer(36160,L.__webglFramebuffer[_e]),L.__webglDepthbuffer[_e]=t.createRenderbuffer(),se(L.__webglDepthbuffer[_e],U,!1)}else n.bindFramebuffer(36160,L.__webglFramebuffer),L.__webglDepthbuffer=t.createRenderbuffer(),se(L.__webglDepthbuffer,U,!1);n.bindFramebuffer(36160,null)}function me(U,L,te){let _e=i.get(U);L!==void 0&&$(_e.__webglFramebuffer,U,U.texture,36064,3553),te!==void 0&&ie(U)}function xe(U){let L=U.texture,te=i.get(U),_e=i.get(L);U.addEventListener("dispose",F),U.isWebGLMultipleRenderTargets!==!0&&(_e.__webglTexture===void 0&&(_e.__webglTexture=t.createTexture()),_e.__version=L.version,o.memory.textures++);let Te=U.isWebGLCubeRenderTarget===!0,Ie=U.isWebGLMultipleRenderTargets===!0,Qe=S(U)||a;if(Te){te.__webglFramebuffer=[];for(let Ge=0;Ge<6;Ge++)te.__webglFramebuffer[Ge]=t.createFramebuffer()}else{if(te.__webglFramebuffer=t.createFramebuffer(),Ie)if(r.drawBuffers){let Ge=U.texture;for(let ye=0,Ve=Ge.length;ye<Ve;ye++){let ue=i.get(Ge[ye]);ue.__webglTexture===void 0&&(ue.__webglTexture=t.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&U.samples>0&&Re(U)===!1){let Ge=Ie?L:[L];te.__webglMultisampledFramebuffer=t.createFramebuffer(),te.__webglColorRenderbuffer=[],n.bindFramebuffer(36160,te.__webglMultisampledFramebuffer);for(let ye=0;ye<Ge.length;ye++){let Ve=Ge[ye];te.__webglColorRenderbuffer[ye]=t.createRenderbuffer(),t.bindRenderbuffer(36161,te.__webglColorRenderbuffer[ye]);let ue=s.convert(Ve.format,Ve.encoding),Me=s.convert(Ve.type),Be=M(Ve.internalFormat,ue,Me,Ve.encoding,U.isXRRenderTarget===!0),ze=Ee(U);t.renderbufferStorageMultisample(36161,ze,Be,U.width,U.height),t.framebufferRenderbuffer(36160,36064+ye,36161,te.__webglColorRenderbuffer[ye])}t.bindRenderbuffer(36161,null),U.depthBuffer&&(te.__webglDepthRenderbuffer=t.createRenderbuffer(),se(te.__webglDepthRenderbuffer,U,!0)),n.bindFramebuffer(36160,null)}}if(Te){n.bindTexture(34067,_e.__webglTexture),G(34067,L,Qe);for(let Ge=0;Ge<6;Ge++)$(te.__webglFramebuffer[Ge],U,L,36064,34069+Ge);b(L,Qe)&&T(34067),n.unbindTexture()}else if(Ie){let Ge=U.texture;for(let ye=0,Ve=Ge.length;ye<Ve;ye++){let ue=Ge[ye],Me=i.get(ue);n.bindTexture(3553,Me.__webglTexture),G(3553,ue,Qe),$(te.__webglFramebuffer,U,ue,36064+ye,3553),b(ue,Qe)&&T(3553)}n.unbindTexture()}else{let Ge=3553;(U.isWebGL3DRenderTarget||U.isWebGLArrayRenderTarget)&&(a?Ge=U.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(Ge,_e.__webglTexture),G(Ge,L,Qe),$(te.__webglFramebuffer,U,L,36064,Ge),b(L,Qe)&&T(Ge),n.unbindTexture()}U.depthBuffer&&ie(U)}function Ae(U){let L=S(U)||a,te=U.isWebGLMultipleRenderTargets===!0?U.texture:[U.texture];for(let _e=0,Te=te.length;_e<Te;_e++){let Ie=te[_e];if(b(Ie,L)){let Qe=U.isWebGLCubeRenderTarget?34067:3553,Ge=i.get(Ie).__webglTexture;n.bindTexture(Qe,Ge),T(Qe),n.unbindTexture()}}}function we(U){if(a&&U.samples>0&&Re(U)===!1){let L=U.isWebGLMultipleRenderTargets?U.texture:[U.texture],te=U.width,_e=U.height,Te=16384,Ie=[],Qe=U.stencilBuffer?33306:36096,Ge=i.get(U),ye=U.isWebGLMultipleRenderTargets===!0;if(ye)for(let Ve=0;Ve<L.length;Ve++)n.bindFramebuffer(36160,Ge.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+Ve,36161,null),n.bindFramebuffer(36160,Ge.__webglFramebuffer),t.framebufferTexture2D(36009,36064+Ve,3553,null,0);n.bindFramebuffer(36008,Ge.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,Ge.__webglFramebuffer);for(let Ve=0;Ve<L.length;Ve++){Ie.push(36064+Ve),U.depthBuffer&&Ie.push(Qe);let ue=Ge.__ignoreDepthValues!==void 0?Ge.__ignoreDepthValues:!1;if(ue===!1&&(U.depthBuffer&&(Te|=256),U.stencilBuffer&&(Te|=1024)),ye&&t.framebufferRenderbuffer(36008,36064,36161,Ge.__webglColorRenderbuffer[Ve]),ue===!0&&(t.invalidateFramebuffer(36008,[Qe]),t.invalidateFramebuffer(36009,[Qe])),ye){let Me=i.get(L[Ve]).__webglTexture;t.framebufferTexture2D(36009,36064,3553,Me,0)}t.blitFramebuffer(0,0,te,_e,0,0,te,_e,Te,9728),f&&t.invalidateFramebuffer(36008,Ie)}if(n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,null),ye)for(let Ve=0;Ve<L.length;Ve++){n.bindFramebuffer(36160,Ge.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064+Ve,36161,Ge.__webglColorRenderbuffer[Ve]);let ue=i.get(L[Ve]).__webglTexture;n.bindFramebuffer(36160,Ge.__webglFramebuffer),t.framebufferTexture2D(36009,36064+Ve,3553,ue,0)}n.bindFramebuffer(36009,Ge.__webglMultisampledFramebuffer)}}function Ee(U){return Math.min(u,U.samples)}function Re(U){let L=i.get(U);return a&&U.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&L.__useRenderToTexture!==!1}function Ue(U){let L=o.render.frame;p.get(U)!==L&&(p.set(U,L),U.update())}function Ne(U,L){let te=U.encoding,_e=U.format,Te=U.type;return U.isCompressedTexture===!0||U.isVideoTexture===!0||U.format===CL||te!==Jl&&(te===Wt?a===!1?e.has("EXT_sRGB")===!0&&_e===Fa?(U.format=CL,U.minFilter=En,U.generateMipmaps=!1):L=_Q.sRGBToLinear(L):(_e!==Fa||Te!==Kr)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",te)),L}this.allocateTextureUnit=O,this.resetTextureUnits=ee,this.setTexture2D=H,this.setTexture2DArray=Y,this.setTexture3D=z,this.setTextureCube=X,this.rebindTextures=me,this.setupRenderTarget=xe,this.updateRenderTargetMipmap=Ae,this.updateMultisampleRenderTarget=we,this.setupDepthRenderbuffer=ie,this.setupFrameBufferTexture=$,this.useMultisampledRTT=Re}function nbe(t,e,n){let i=n.isWebGL2;function r(s,o=null){let a;if(s===Kr)return 5121;if(s===Nye)return 32819;if(s===Uye)return 32820;if(s===Bye)return 5120;if(s===Oye)return 5122;if(s===gQ)return 5123;if(s===Fye)return 5124;if(s===lh)return 5125;if(s===ch)return 5126;if(s===bx)return i?5131:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===kye)return 6406;if(s===Fa)return 6408;if(s===zye)return 6409;if(s===Gye)return 6410;if(s===pf)return 6402;if(s===If)return 34041;if(s===CL)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===Hye)return 6403;if(s===Vye)return 36244;if(s===jye)return 33319;if(s===Wye)return 33320;if(s===Xye)return 36249;if(s===AP||s===MP||s===EP||s===CP)if(o===Wt)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===AP)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===MP)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===EP)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===CP)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===AP)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===MP)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===EP)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===CP)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===dH||s===fH||s===pH||s===mH)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===dH)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===fH)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===pH)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===mH)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===Yye)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===gH||s===vH)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===gH)return o===Wt?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===vH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===yH||s===xH||s===_H||s===wH||s===SH||s===bH||s===AH||s===MH||s===EH||s===CH||s===TH||s===PH||s===DH||s===RH)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===yH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===xH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===_H)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===wH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===SH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===bH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===AH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===MH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===EH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===CH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===TH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===PH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===DH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===RH)return o===Wt?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===TP)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===TP)return o===Wt?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===qye||s===LH||s===IH||s===BH)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===TP)return a.COMPRESSED_RED_RGTC1_EXT;if(s===LH)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===IH)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===BH)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===ff?i?34042:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):t[s]!==void 0?t[s]:null}return{convert:r}}var ibe=class extends Yr{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t}},km=class extends Fn{constructor(){super(),this.isGroup=!0,this.type="Group"}},rbe={type:"move"},$P=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new km,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new km,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new N,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new N),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new km,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new N,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new N),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){let e=this._hand;if(e)for(let n of t.hand.values())this._getHandJoint(e,n)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,e,n){let i=null,r=null,s=null,o=this._targetRay,a=this._grip,l=this._hand;if(t&&e.session.visibilityState!=="visible-blurred"){if(l&&t.hand){s=!0;for(let p of t.hand.values()){let v=e.getJointPose(p,n),g=this._getHandJoint(l,p);v!==null&&(g.matrix.fromArray(v.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.jointRadius=v.radius),g.visible=v!==null}let c=l.joints["index-finger-tip"],h=l.joints["thumb-tip"],u=c.position.distanceTo(h.position),d=.02,f=.005;l.inputState.pinching&&u>d+f?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!l.inputState.pinching&&u<=d-f&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else a!==null&&t.gripSpace&&(r=e.getPose(t.gripSpace,n),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1));o!==null&&(i=e.getPose(t.targetRaySpace,n),i===null&&r!==null&&(i=r),i!==null&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(rbe)))}return o!==null&&(o.visible=i!==null),a!==null&&(a.visible=r!==null),l!==null&&(l.visible=s!==null),this}_getHandJoint(t,e){if(t.joints[e.jointName]===void 0){let n=new km;n.matrixAutoUpdate=!1,n.visible=!1,t.joints[e.jointName]=n,t.add(n)}return t.joints[e.jointName]}},wO=class extends _r{constructor(t,e,n,i,r,s,o,a,l,c){if(c=c!==void 0?c:pf,c!==pf&&c!==If)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&c===pf&&(n=lh),n===void 0&&c===If&&(n=ff),super(null,i,r,s,o,a,c,n,l),this.isDepthTexture=!0,this.image={width:t,height:e},this.magFilter=o!==void 0?o:si,this.minFilter=a!==void 0?a:si,this.flipY=!1,this.generateMipmaps=!1}},sbe=class extends ys{constructor(t,e){super();let n=this,i=null,r=1,s=null,o="local-floor",a=1,l=null,c=null,h=null,u=null,d=null,f=null,p=e.getContextAttributes(),v=null,g=null,m=[],y=[],_=new Set,S=new Map,A=new Yr;A.layers.enable(1),A.viewport=new Zt;let b=new Yr;b.layers.enable(2),b.viewport=new Zt;let T=[A,b],M=new ibe;M.layers.enable(1),M.layers.enable(2);let E=null,P=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Y){let z=m[Y];return z===void 0&&(z=new $P,m[Y]=z),z.getTargetRaySpace()},this.getControllerGrip=function(Y){let z=m[Y];return z===void 0&&(z=new $P,m[Y]=z),z.getGripSpace()},this.getHand=function(Y){let z=m[Y];return z===void 0&&(z=new $P,m[Y]=z),z.getHandSpace()};function R(Y){let z=y.indexOf(Y.inputSource);if(z===-1)return;let X=m[z];X!==void 0&&X.dispatchEvent({type:Y.type,data:Y.inputSource})}function F(){i.removeEventListener("select",R),i.removeEventListener("selectstart",R),i.removeEventListener("selectend",R),i.removeEventListener("squeeze",R),i.removeEventListener("squeezestart",R),i.removeEventListener("squeezeend",R),i.removeEventListener("end",F),i.removeEventListener("inputsourceschange",B);for(let Y=0;Y<m.length;Y++){let z=y[Y];z!==null&&(y[Y]=null,m[Y].disconnect(z))}E=null,P=null,t.setRenderTarget(v),d=null,u=null,h=null,i=null,g=null,H.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Y){r=Y,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Y){o=Y,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(Y){l=Y},this.getBaseLayer=function(){return u!==null?u:d},this.getBinding=function(){return h},this.getFrame=function(){return f},this.getSession=function(){return i},this.setSession=async function(Y){if(i=Y,i!==null){if(v=t.getRenderTarget(),i.addEventListener("select",R),i.addEventListener("selectstart",R),i.addEventListener("selectend",R),i.addEventListener("squeeze",R),i.addEventListener("squeezestart",R),i.addEventListener("squeezeend",R),i.addEventListener("end",F),i.addEventListener("inputsourceschange",B),p.xrCompatible!==!0&&await e.makeXRCompatible(),i.renderState.layers===void 0||t.capabilities.isWebGL2===!1){let z={antialias:i.renderState.layers===void 0?p.antialias:!0,alpha:p.alpha,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:r};d=new XRWebGLLayer(i,e,z),i.updateRenderState({baseLayer:d}),g=new $i(d.framebufferWidth,d.framebufferHeight,{format:Fa,type:Kr,encoding:t.outputEncoding,stencilBuffer:p.stencil})}else{let z=null,X=null,q=null;p.depth&&(q=p.stencil?35056:33190,z=p.stencil?If:pf,X=p.stencil?ff:lh);let re={colorFormat:32856,depthFormat:q,scaleFactor:r};h=new XRWebGLBinding(i,e),u=h.createProjectionLayer(re),i.updateRenderState({layers:[u]}),g=new $i(u.textureWidth,u.textureHeight,{format:Fa,type:Kr,depthTexture:new wO(u.textureWidth,u.textureHeight,X,void 0,void 0,void 0,void 0,void 0,void 0,z),stencilBuffer:p.stencil,encoding:t.outputEncoding,samples:p.antialias?4:0});let G=t.properties.get(g);G.__ignoreDepthValues=u.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(a),l=null,s=await i.requestReferenceSpace(o),H.setContext(i),H.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}};function B(Y){for(let z=0;z<Y.removed.length;z++){let X=Y.removed[z],q=y.indexOf(X);q>=0&&(y[q]=null,m[q].disconnect(X))}for(let z=0;z<Y.added.length;z++){let X=Y.added[z],q=y.indexOf(X);if(q===-1){for(let G=0;G<m.length;G++)if(G>=y.length){y.push(X),q=G;break}else if(y[G]===null){y[G]=X,q=G;break}if(q===-1)break}let re=m[q];re&&re.connect(X)}}let k=new N,j=new N;function Z(Y,z,X){k.setFromMatrixPosition(z.matrixWorld),j.setFromMatrixPosition(X.matrixWorld);let q=k.distanceTo(j),re=z.projectionMatrix.elements,G=X.projectionMatrix.elements,K=re[14]/(re[10]-1),oe=re[14]/(re[10]+1),ve=(re[9]+1)/re[5],$=(re[9]-1)/re[5],se=(re[8]-1)/re[0],ne=(G[8]+1)/G[0],ie=K*se,me=K*ne,xe=q/(-se+ne),Ae=xe*-se;z.matrixWorld.decompose(Y.position,Y.quaternion,Y.scale),Y.translateX(Ae),Y.translateZ(xe),Y.matrixWorld.compose(Y.position,Y.quaternion,Y.scale),Y.matrixWorldInverse.copy(Y.matrixWorld).invert();let we=K+xe,Ee=oe+xe,Re=ie-Ae,Ue=me+(q-Ae),Ne=ve*oe/Ee*we,U=$*oe/Ee*we;Y.projectionMatrix.makePerspective(Re,Ue,Ne,U,we,Ee)}function ee(Y,z){z===null?Y.matrixWorld.copy(Y.matrix):Y.matrixWorld.multiplyMatrices(z.matrixWorld,Y.matrix),Y.matrixWorldInverse.copy(Y.matrixWorld).invert()}this.updateCamera=function(Y){if(i===null)return;M.near=b.near=A.near=Y.near,M.far=b.far=A.far=Y.far,(E!==M.near||P!==M.far)&&(i.updateRenderState({depthNear:M.near,depthFar:M.far}),E=M.near,P=M.far);let z=Y.parent,X=M.cameras;ee(M,z);for(let re=0;re<X.length;re++)ee(X[re],z);M.matrixWorld.decompose(M.position,M.quaternion,M.scale),Y.matrix.copy(M.matrix),Y.matrix.decompose(Y.position,Y.quaternion,Y.scale);let q=Y.children;for(let re=0,G=q.length;re<G;re++)q[re].updateMatrixWorld(!0);X.length===2?Z(M,A,b):M.projectionMatrix.copy(A.projectionMatrix)},this.getCamera=function(){return M},this.getFoveation=function(){if(!(u===null&&d===null))return a},this.setFoveation=function(Y){a=Y,u!==null&&(u.fixedFoveation=Y),d!==null&&d.fixedFoveation!==void 0&&(d.fixedFoveation=Y)},this.getPlanes=function(){return _};let O=null;function W(Y,z){if(c=z.getViewerPose(l||s),f=z,c!==null){let X=c.views;d!==null&&(t.setRenderTargetFramebuffer(g,d.framebuffer),t.setRenderTarget(g));let q=!1;X.length!==M.cameras.length&&(M.cameras.length=0,q=!0);for(let re=0;re<X.length;re++){let G=X[re],K=null;if(d!==null)K=d.getViewport(G);else{let ve=h.getViewSubImage(u,G);K=ve.viewport,re===0&&(t.setRenderTargetTextures(g,ve.colorTexture,u.ignoreDepthValues?void 0:ve.depthStencilTexture),t.setRenderTarget(g))}let oe=T[re];oe===void 0&&(oe=new Yr,oe.layers.enable(re),oe.viewport=new Zt,T[re]=oe),oe.matrix.fromArray(G.transform.matrix),oe.projectionMatrix.fromArray(G.projectionMatrix),oe.viewport.set(K.x,K.y,K.width,K.height),re===0&&M.matrix.copy(oe.matrix),q===!0&&M.cameras.push(oe)}}for(let X=0;X<m.length;X++){let q=y[X],re=m[X];q!==null&&re!==void 0&&re.update(q,z,l||s)}if(O&&O(Y,z),z.detectedPlanes){n.dispatchEvent({type:"planesdetected",data:z.detectedPlanes});let X=null;for(let q of _)z.detectedPlanes.has(q)||(X===null&&(X=[]),X.push(q));if(X!==null)for(let q of X)_.delete(q),S.delete(q),n.dispatchEvent({type:"planeremoved",data:q});for(let q of z.detectedPlanes)if(!_.has(q))_.add(q),S.set(q,z.lastChangedTime),n.dispatchEvent({type:"planeadded",data:q});else{let re=S.get(q);q.lastChangedTime>re&&(S.set(q,q.lastChangedTime),n.dispatchEvent({type:"planechanged",data:q}))}}f=null}let H=new MQ;H.setAnimationLoop(W),this.setAnimationLoop=function(Y){O=Y},this.dispose=function(){}}};function obe(t,e){function n(v,g){g.color.getRGB(v.fogColor.value,AQ(t)),g.isFog?(v.fogNear.value=g.near,v.fogFar.value=g.far):g.isFogExp2&&(v.fogDensity.value=g.density)}function i(v,g,m,y,_){g.isMeshBasicMaterial||g.isMeshLambertMaterial?r(v,g):g.isMeshToonMaterial?(r(v,g),h(v,g)):g.isMeshPhongMaterial?(r(v,g),c(v,g)):g.isMeshStandardMaterial?(r(v,g),u(v,g),g.isMeshPhysicalMaterial&&d(v,g,_)):g.isMeshMatcapMaterial?(r(v,g),f(v,g)):g.isMeshDepthMaterial?r(v,g):g.isMeshDistanceMaterial?(r(v,g),p(v,g)):g.isMeshNormalMaterial?r(v,g):g.isLineBasicMaterial?(s(v,g),g.isLineDashedMaterial&&o(v,g)):g.isPointsMaterial?a(v,g,m,y):g.isSpriteMaterial?l(v,g):g.isShadowMaterial?(v.color.value.copy(g.color),v.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function r(v,g){v.opacity.value=g.opacity,g.color&&v.diffuse.value.copy(g.color),g.emissive&&v.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(v.map.value=g.map),g.alphaMap&&(v.alphaMap.value=g.alphaMap),g.bumpMap&&(v.bumpMap.value=g.bumpMap,v.bumpScale.value=g.bumpScale,g.side===vr&&(v.bumpScale.value*=-1)),g.displacementMap&&(v.displacementMap.value=g.displacementMap,v.displacementScale.value=g.displacementScale,v.displacementBias.value=g.displacementBias),g.emissiveMap&&(v.emissiveMap.value=g.emissiveMap),g.normalMap&&(v.normalMap.value=g.normalMap,v.normalScale.value.copy(g.normalScale),g.side===vr&&v.normalScale.value.negate()),g.specularMap&&(v.specularMap.value=g.specularMap),g.alphaTest>0&&(v.alphaTest.value=g.alphaTest);let m=e.get(g).envMap;if(m&&(v.envMap.value=m,v.flipEnvMap.value=m.isCubeTexture&&m.isRenderTargetTexture===!1?-1:1,v.reflectivity.value=g.reflectivity,v.ior.value=g.ior,v.refractionRatio.value=g.refractionRatio),g.lightMap){v.lightMap.value=g.lightMap;let S=t.physicallyCorrectLights!==!0?Math.PI:1;v.lightMapIntensity.value=g.lightMapIntensity*S}g.aoMap&&(v.aoMap.value=g.aoMap,v.aoMapIntensity.value=g.aoMapIntensity);let y;g.map?y=g.map:g.specularMap?y=g.specularMap:g.displacementMap?y=g.displacementMap:g.normalMap?y=g.normalMap:g.bumpMap?y=g.bumpMap:g.roughnessMap?y=g.roughnessMap:g.metalnessMap?y=g.metalnessMap:g.alphaMap?y=g.alphaMap:g.emissiveMap?y=g.emissiveMap:g.clearcoatMap?y=g.clearcoatMap:g.clearcoatNormalMap?y=g.clearcoatNormalMap:g.clearcoatRoughnessMap?y=g.clearcoatRoughnessMap:g.iridescenceMap?y=g.iridescenceMap:g.iridescenceThicknessMap?y=g.iridescenceThicknessMap:g.specularIntensityMap?y=g.specularIntensityMap:g.specularColorMap?y=g.specularColorMap:g.transmissionMap?y=g.transmissionMap:g.thicknessMap?y=g.thicknessMap:g.sheenColorMap?y=g.sheenColorMap:g.sheenRoughnessMap&&(y=g.sheenRoughnessMap),y!==void 0&&(y.isWebGLRenderTarget&&(y=y.texture),y.matrixAutoUpdate===!0&&y.updateMatrix(),v.uvTransform.value.copy(y.matrix));let _;g.aoMap?_=g.aoMap:g.lightMap&&(_=g.lightMap),_!==void 0&&(_.isWebGLRenderTarget&&(_=_.texture),_.matrixAutoUpdate===!0&&_.updateMatrix(),v.uv2Transform.value.copy(_.matrix))}function s(v,g){v.diffuse.value.copy(g.color),v.opacity.value=g.opacity}function o(v,g){v.dashSize.value=g.dashSize,v.totalSize.value=g.dashSize+g.gapSize,v.scale.value=g.scale}function a(v,g,m,y){v.diffuse.value.copy(g.color),v.opacity.value=g.opacity,v.size.value=g.size*m,v.scale.value=y*.5,g.map&&(v.map.value=g.map),g.alphaMap&&(v.alphaMap.value=g.alphaMap),g.alphaTest>0&&(v.alphaTest.value=g.alphaTest);let _;g.map?_=g.map:g.alphaMap&&(_=g.alphaMap),_!==void 0&&(_.matrixAutoUpdate===!0&&_.updateMatrix(),v.uvTransform.value.copy(_.matrix))}function l(v,g){v.diffuse.value.copy(g.color),v.opacity.value=g.opacity,v.rotation.value=g.rotation,g.map&&(v.map.value=g.map),g.alphaMap&&(v.alphaMap.value=g.alphaMap),g.alphaTest>0&&(v.alphaTest.value=g.alphaTest);let m;g.map?m=g.map:g.alphaMap&&(m=g.alphaMap),m!==void 0&&(m.matrixAutoUpdate===!0&&m.updateMatrix(),v.uvTransform.value.copy(m.matrix))}function c(v,g){v.specular.value.copy(g.specular),v.shininess.value=Math.max(g.shininess,1e-4)}function h(v,g){g.gradientMap&&(v.gradientMap.value=g.gradientMap)}function u(v,g){v.roughness.value=g.roughness,v.metalness.value=g.metalness,g.roughnessMap&&(v.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(v.metalnessMap.value=g.metalnessMap),e.get(g).envMap&&(v.envMapIntensity.value=g.envMapIntensity)}function d(v,g,m){v.ior.value=g.ior,g.sheen>0&&(v.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),v.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(v.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(v.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(v.clearcoat.value=g.clearcoat,v.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(v.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(v.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),v.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===vr&&v.clearcoatNormalScale.value.negate())),g.iridescence>0&&(v.iridescence.value=g.iridescence,v.iridescenceIOR.value=g.iridescenceIOR,v.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],v.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(v.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(v.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(v.transmission.value=g.transmission,v.transmissionSamplerMap.value=m.texture,v.transmissionSamplerSize.value.set(m.width,m.height),g.transmissionMap&&(v.transmissionMap.value=g.transmissionMap),v.thickness.value=g.thickness,g.thicknessMap&&(v.thicknessMap.value=g.thicknessMap),v.attenuationDistance.value=g.attenuationDistance,v.attenuationColor.value.copy(g.attenuationColor)),v.specularIntensity.value=g.specularIntensity,v.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(v.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(v.specularColorMap.value=g.specularColorMap)}function f(v,g){g.matcap&&(v.matcap.value=g.matcap)}function p(v,g){v.referencePosition.value.copy(g.referencePosition),v.nearDistance.value=g.nearDistance,v.farDistance.value=g.farDistance}return{refreshFogUniforms:n,refreshMaterialUniforms:i}}function abe(t,e,n,i){let r={},s={},o=[],a=n.isWebGL2?t.getParameter(35375):0;function l(y,_){let S=_.program;i.uniformBlockBinding(y,S)}function c(y,_){let S=r[y.id];S===void 0&&(p(y),S=h(y),r[y.id]=S,y.addEventListener("dispose",g));let A=_.program;i.updateUBOMapping(y,A);let b=e.render.frame;s[y.id]!==b&&(d(y),s[y.id]=b)}function h(y){let _=u();y.__bindingPointIndex=_;let S=t.createBuffer(),A=y.__size,b=y.usage;return t.bindBuffer(35345,S),t.bufferData(35345,A,b),t.bindBuffer(35345,null),t.bindBufferBase(35345,_,S),S}function u(){for(let y=0;y<a;y++)if(o.indexOf(y)===-1)return o.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(y){let _=r[y.id],S=y.uniforms,A=y.__cache;t.bindBuffer(35345,_);for(let b=0,T=S.length;b<T;b++){let M=S[b];if(f(M,b,A)===!0){let E=M.__offset,P=Array.isArray(M.value)?M.value:[M.value],R=0;for(let F=0;F<P.length;F++){let B=P[F],k=v(B);typeof B=="number"?(M.__data[0]=B,t.bufferSubData(35345,E+R,M.__data)):B.isMatrix3?(M.__data[0]=B.elements[0],M.__data[1]=B.elements[1],M.__data[2]=B.elements[2],M.__data[3]=B.elements[0],M.__data[4]=B.elements[3],M.__data[5]=B.elements[4],M.__data[6]=B.elements[5],M.__data[7]=B.elements[0],M.__data[8]=B.elements[6],M.__data[9]=B.elements[7],M.__data[10]=B.elements[8],M.__data[11]=B.elements[0]):(B.toArray(M.__data,R),R+=k.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(35345,E,M.__data)}}t.bindBuffer(35345,null)}function f(y,_,S){let A=y.value;if(S[_]===void 0){if(typeof A=="number")S[_]=A;else{let b=Array.isArray(A)?A:[A],T=[];for(let M=0;M<b.length;M++)T.push(b[M].clone());S[_]=T}return!0}else if(typeof A=="number"){if(S[_]!==A)return S[_]=A,!0}else{let b=Array.isArray(S[_])?S[_]:[S[_]],T=Array.isArray(A)?A:[A];for(let M=0;M<b.length;M++){let E=b[M];if(E.equals(T[M])===!1)return E.copy(T[M]),!0}}return!1}function p(y){let _=y.uniforms,S=0,A=16,b=0;for(let T=0,M=_.length;T<M;T++){let E=_[T],P={boundary:0,storage:0},R=Array.isArray(E.value)?E.value:[E.value];for(let F=0,B=R.length;F<B;F++){let k=R[F],j=v(k);P.boundary+=j.boundary,P.storage+=j.storage}if(E.__data=new Float32Array(P.storage/Float32Array.BYTES_PER_ELEMENT),E.__offset=S,T>0){b=S%A;let F=A-b;b!==0&&F-P.boundary<0&&(S+=A-b,E.__offset=S)}S+=P.storage}return b=S%A,b>0&&(S+=A-b),y.__size=S,y.__cache={},this}function v(y){let _={boundary:0,storage:0};return typeof y=="number"?(_.boundary=4,_.storage=4):y.isVector2?(_.boundary=8,_.storage=8):y.isVector3||y.isColor?(_.boundary=16,_.storage=12):y.isVector4?(_.boundary=16,_.storage=16):y.isMatrix3?(_.boundary=48,_.storage=48):y.isMatrix4?(_.boundary=64,_.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),_}function g(y){let _=y.target;_.removeEventListener("dispose",g);let S=o.indexOf(_.__bindingPointIndex);o.splice(S,1),t.deleteBuffer(r[_.id]),delete r[_.id],delete s[_.id]}function m(){for(let y in r)t.deleteBuffer(r[y]);o=[],r={},s={}}return{bind:l,update:c,dispose:m}}function lbe(){let t=bA("canvas");return t.style.display="block",t}function RQ(t={}){this.isWebGLRenderer=!0;let e=t.canvas!==void 0?t.canvas:lbe(),n=t.context!==void 0?t.context:null,i=t.depth!==void 0?t.depth:!0,r=t.stencil!==void 0?t.stencil:!0,s=t.antialias!==void 0?t.antialias:!1,o=t.premultipliedAlpha!==void 0?t.premultipliedAlpha:!0,a=t.preserveDrawingBuffer!==void 0?t.preserveDrawingBuffer:!1,l=t.powerPreference!==void 0?t.powerPreference:"default",c=t.failIfMajorPerformanceCaveat!==void 0?t.failIfMajorPerformanceCaveat:!1,h;n!==null?h=n.getContextAttributes().alpha:h=t.alpha!==void 0?t.alpha:!1;let u=null,d=null,f=[],p=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Jl,this.physicallyCorrectLights=!1,this.toneMapping=qc,this.toneMappingExposure=1;let v=this,g=!1,m=0,y=0,_=null,S=-1,A=null,b=new Zt,T=new Zt,M=null,E=e.width,P=e.height,R=1,F=null,B=null,k=new Zt(0,0,E,P),j=new Zt(0,0,E,P),Z=!1,ee=new xO,O=!1,W=!1,H=null,Y=new nt,z=new Se,X=new N,q={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function re(){return _===null?R:1}let G=n;function K(he,Q){for(let de=0;de<he.length;de++){let le=he[de],ce=e.getContext(le,Q);if(ce!==null)return ce}return null}try{let he={alpha:!0,depth:i,stencil:r,antialias:s,premultipliedAlpha:o,preserveDrawingBuffer:a,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${cv}`),e.addEventListener("webglcontextlost",Be,!1),e.addEventListener("webglcontextrestored",ze,!1),e.addEventListener("webglcontextcreationerror",$e,!1),G===null){let Q=["webgl2","webgl","experimental-webgl"];if(v.isWebGL1Renderer===!0&&Q.shift(),G=K(Q,he),G===null)throw K(Q)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}G.getShaderPrecisionFormat===void 0&&(G.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(he){throw console.error("THREE.WebGLRenderer: "+he.message),he}let oe,ve,$,se,ne,ie,me,xe,Ae,we,Ee,Re,Ue,Ne,U,L,te,_e,Te,Ie,Qe,Ge,ye,Ve;function ue(){oe=new wwe(G),ve=new mwe(G,oe,t),oe.init(ve),Ge=new nbe(G,oe,ve),$=new ebe(G,oe,ve),se=new Awe,ne=new GSe,ie=new tbe(G,oe,$,ne,ve,Ge,se),me=new vwe(v),xe=new _we(v),Ae=new Ixe(G,ve),ye=new fwe(G,oe,Ae,ve),we=new Swe(G,Ae,se,ye),Ee=new Twe(G,we,Ae,se),Te=new Cwe(G,ve,ie),L=new gwe(ne),Re=new zSe(v,me,xe,oe,ve,ye,L),Ue=new obe(v,ne),Ne=new VSe,U=new QSe(oe,ve),_e=new dwe(v,me,xe,$,Ee,h,o),te=new $Se(v,Ee,ve),Ve=new abe(G,se,ve,$),Ie=new pwe(G,oe,se,ve),Qe=new bwe(G,oe,se,ve),se.programs=Re.programs,v.capabilities=ve,v.extensions=oe,v.properties=ne,v.renderLists=Ne,v.shadowMap=te,v.state=$,v.info=se}ue();let Me=new sbe(v,G);this.xr=Me,this.getContext=function(){return G},this.getContextAttributes=function(){return G.getContextAttributes()},this.forceContextLoss=function(){let he=oe.get("WEBGL_lose_context");he&&he.loseContext()},this.forceContextRestore=function(){let he=oe.get("WEBGL_lose_context");he&&he.restoreContext()},this.getPixelRatio=function(){return R},this.setPixelRatio=function(he){he!==void 0&&(R=he,this.setSize(E,P,!1))},this.getSize=function(he){return he.set(E,P)},this.setSize=function(he,Q,de){if(Me.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}E=he,P=Q,e.width=Math.floor(he*R),e.height=Math.floor(Q*R),de!==!1&&(e.style.width=he+"px",e.style.height=Q+"px"),this.setViewport(0,0,he,Q)},this.getDrawingBufferSize=function(he){return he.set(E*R,P*R).floor()},this.setDrawingBufferSize=function(he,Q,de){E=he,P=Q,R=de,e.width=Math.floor(he*de),e.height=Math.floor(Q*de),this.setViewport(0,0,he,Q)},this.getCurrentViewport=function(he){return he.copy(b)},this.getViewport=function(he){return he.copy(k)},this.setViewport=function(he,Q,de,le){he.isVector4?k.set(he.x,he.y,he.z,he.w):k.set(he,Q,de,le),$.viewport(b.copy(k).multiplyScalar(R).floor())},this.getScissor=function(he){return he.copy(j)},this.setScissor=function(he,Q,de,le){he.isVector4?j.set(he.x,he.y,he.z,he.w):j.set(he,Q,de,le),$.scissor(T.copy(j).multiplyScalar(R).floor())},this.getScissorTest=function(){return Z},this.setScissorTest=function(he){$.setScissorTest(Z=he)},this.setOpaqueSort=function(he){F=he},this.setTransparentSort=function(he){B=he},this.getClearColor=function(he){return he.copy(_e.getClearColor())},this.setClearColor=function(){_e.setClearColor.apply(_e,arguments)},this.getClearAlpha=function(){return _e.getClearAlpha()},this.setClearAlpha=function(){_e.setClearAlpha.apply(_e,arguments)},this.clear=function(he=!0,Q=!0,de=!0){let le=0;he&&(le|=16384),Q&&(le|=256),de&&(le|=1024),G.clear(le)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",Be,!1),e.removeEventListener("webglcontextrestored",ze,!1),e.removeEventListener("webglcontextcreationerror",$e,!1),Ne.dispose(),U.dispose(),ne.dispose(),me.dispose(),xe.dispose(),Ee.dispose(),ye.dispose(),Ve.dispose(),Re.dispose(),Me.dispose(),Me.removeEventListener("sessionstart",Oe),Me.removeEventListener("sessionend",qe),H&&(H.dispose(),H=null),vt.stop()};function Be(he){he.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function ze(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;let he=se.autoReset,Q=te.enabled,de=te.autoUpdate,le=te.needsUpdate,ce=te.type;ue(),se.autoReset=he,te.enabled=Q,te.autoUpdate=de,te.needsUpdate=le,te.type=ce}function $e(he){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",he.statusMessage)}function dt(he){let Q=he.target;Q.removeEventListener("dispose",dt),Bt(Q)}function Bt(he){J(he),ne.remove(he)}function J(he){let Q=ne.get(he).programs;Q!==void 0&&(Q.forEach(function(de){Re.releaseProgram(de)}),he.isShaderMaterial&&Re.releaseShaderCache(he))}this.renderBufferDirect=function(he,Q,de,le,ce,De){Q===null&&(Q=q);let Ke=ce.isMesh&&ce.matrixWorld.determinant()<0,Ze=Jf(he,Q,de,le,ce);$.setMaterial(le,Ke);let it=de.index,ht=1;le.wireframe===!0&&(it=we.getWireframeAttribute(de),ht=2);let lt=de.drawRange,ot=de.attributes.position,Mt=lt.start*ht,Vt=(lt.start+lt.count)*ht;De!==null&&(Mt=Math.max(Mt,De.start*ht),Vt=Math.min(Vt,(De.start+De.count)*ht)),it!==null?(Mt=Math.max(Mt,0),Vt=Math.min(Vt,it.count)):ot!=null&&(Mt=Math.max(Mt,0),Vt=Math.min(Vt,ot.count));let Nn=Vt-Mt;if(Nn<0||Nn===1/0)return;ye.setup(ce,le,Ze,de,it);let Si,vn=Ie;if(it!==null&&(Si=Ae.get(it),vn=Qe,vn.setIndex(Si)),ce.isMesh)le.wireframe===!0?($.setLineWidth(le.wireframeLinewidth*re()),vn.setMode(1)):vn.setMode(4);else if(ce.isLine){let yt=le.linewidth;yt===void 0&&(yt=1),$.setLineWidth(yt*re()),ce.isLineSegments?vn.setMode(1):ce.isLineLoop?vn.setMode(2):vn.setMode(3)}else ce.isPoints?vn.setMode(0):ce.isSprite&&vn.setMode(4);if(ce.isInstancedMesh)vn.renderInstances(Mt,Nn,ce.count);else if(de.isInstancedBufferGeometry){let yt=de._maxInstanceCount!==void 0?de._maxInstanceCount:1/0,Qt=Math.min(de.instanceCount,yt);vn.renderInstances(Mt,Nn,Qt)}else vn.render(Mt,Nn)},this.compile=function(he,Q){function de(le,ce,De){le.transparent===!0&&le.side===oo&&le.forceSinglePass===!1?(le.side=vr,le.needsUpdate=!0,Wn(le,ce,De),le.side=Ka,le.needsUpdate=!0,Wn(le,ce,De),le.side=oo):Wn(le,ce,De)}d=U.get(he),d.init(),p.push(d),he.traverseVisible(function(le){le.isLight&&le.layers.test(Q.layers)&&(d.pushLight(le),le.castShadow&&d.pushShadow(le))}),d.setupLights(v.physicallyCorrectLights),he.traverse(function(le){let ce=le.material;if(ce)if(Array.isArray(ce))for(let De=0;De<ce.length;De++){let Ke=ce[De];de(Ke,he,le)}else de(ce,he,le)}),p.pop(),d=null};let fe=null;function be(he){fe&&fe(he)}function Oe(){vt.stop()}function qe(){vt.start()}let vt=new MQ;vt.setAnimationLoop(be),typeof self<"u"&&vt.setContext(self),this.setAnimationLoop=function(he){fe=he,Me.setAnimationLoop(he),he===null?vt.stop():vt.start()},Me.addEventListener("sessionstart",Oe),Me.addEventListener("sessionend",qe),this.render=function(he,Q){if(Q!==void 0&&Q.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(g===!0)return;he.matrixWorldAutoUpdate===!0&&he.updateMatrixWorld(),Q.parent===null&&Q.matrixWorldAutoUpdate===!0&&Q.updateMatrixWorld(),Me.enabled===!0&&Me.isPresenting===!0&&(Me.cameraAutoUpdate===!0&&Me.updateCamera(Q),Q=Me.getCamera()),he.isScene===!0&&he.onBeforeRender(v,he,Q,_),d=U.get(he,p.length),d.init(),p.push(d),Y.multiplyMatrices(Q.projectionMatrix,Q.matrixWorldInverse),ee.setFromProjectionMatrix(Y),W=this.localClippingEnabled,O=L.init(this.clippingPlanes,W),u=Ne.get(he,f.length),u.init(),f.push(u),Et(he,Q,0,v.sortObjects),u.finish(),v.sortObjects===!0&&u.sort(F,B),O===!0&&L.beginShadows();let de=d.state.shadowsArray;if(te.render(de,he,Q),O===!0&&L.endShadows(),this.info.autoReset===!0&&this.info.reset(),_e.render(u,he),d.setupLights(v.physicallyCorrectLights),Q.isArrayCamera){let le=Q.cameras;for(let ce=0,De=le.length;ce<De;ce++){let Ke=le[ce];un(u,he,Ke,Ke.viewport)}}else un(u,he,Q);_!==null&&(ie.updateMultisampleRenderTarget(_),ie.updateRenderTargetMipmap(_)),he.isScene===!0&&he.onAfterRender(v,he,Q),ye.resetDefaultState(),S=-1,A=null,p.pop(),p.length>0?d=p[p.length-1]:d=null,f.pop(),f.length>0?u=f[f.length-1]:u=null};function Et(he,Q,de,le){if(he.visible===!1)return;if(he.layers.test(Q.layers)){if(he.isGroup)de=he.renderOrder;else if(he.isLOD)he.autoUpdate===!0&&he.update(Q);else if(he.isLight)d.pushLight(he),he.castShadow&&d.pushShadow(he);else if(he.isSprite){if(!he.frustumCulled||ee.intersectsSprite(he)){le&&X.setFromMatrixPosition(he.matrixWorld).applyMatrix4(Y);let De=Ee.update(he),Ke=he.material;Ke.visible&&u.push(he,De,Ke,de,X.z,null)}}else if((he.isMesh||he.isLine||he.isPoints)&&(he.isSkinnedMesh&&he.skeleton.frame!==se.render.frame&&(he.skeleton.update(),he.skeleton.frame=se.render.frame),!he.frustumCulled||ee.intersectsObject(he))){le&&X.setFromMatrixPosition(he.matrixWorld).applyMatrix4(Y);let De=Ee.update(he),Ke=he.material;if(Array.isArray(Ke)){let Ze=De.groups;for(let it=0,ht=Ze.length;it<ht;it++){let lt=Ze[it],ot=Ke[lt.materialIndex];ot&&ot.visible&&u.push(he,De,ot,de,X.z,lt)}}else Ke.visible&&u.push(he,De,Ke,de,X.z,null)}}let ce=he.children;for(let De=0,Ke=ce.length;De<Ke;De++)Et(ce[De],Q,de,le)}function un(he,Q,de,le){let ce=he.opaque,De=he.transmissive,Ke=he.transparent;d.setupLightsView(de),O===!0&&L.setGlobalState(v.clippingPlanes,de),De.length>0&&ji(ce,Q,de),le&&$.viewport(b.copy(le)),ce.length>0&&Ot(ce,Q,de),De.length>0&&Ot(De,Q,de),Ke.length>0&&Ot(Ke,Q,de),$.buffers.depth.setTest(!0),$.buffers.depth.setMask(!0),$.buffers.color.setMask(!0),$.setPolygonOffset(!1)}function ji(he,Q,de){let le=ve.isWebGL2;H===null&&(H=new $i(1,1,{generateMipmaps:!0,type:oe.has("EXT_color_buffer_half_float")?bx:Kr,minFilter:Ug,samples:le&&s===!0?4:0})),v.getDrawingBufferSize(z),le?H.setSize(z.x,z.y):H.setSize(SA(z.x),SA(z.y));let ce=v.getRenderTarget();v.setRenderTarget(H),v.clear();let De=v.toneMapping;v.toneMapping=qc,Ot(he,Q,de),v.toneMapping=De,ie.updateMultisampleRenderTarget(H),ie.updateRenderTargetMipmap(H),v.setRenderTarget(ce)}function Ot(he,Q,de){let le=Q.isScene===!0?Q.overrideMaterial:null;for(let ce=0,De=he.length;ce<De;ce++){let Ke=he[ce],Ze=Ke.object,it=Ke.geometry,ht=le===null?Ke.material:le,lt=Ke.group;Ze.layers.test(de.layers)&&jn(Ze,Q,de,it,ht,lt)}}function jn(he,Q,de,le,ce,De){he.onBeforeRender(v,Q,de,le,ce,De),he.modelViewMatrix.multiplyMatrices(de.matrixWorldInverse,he.matrixWorld),he.normalMatrix.getNormalMatrix(he.modelViewMatrix),ce.onBeforeRender(v,Q,de,le,he,De),ce.transparent===!0&&ce.side===oo&&ce.forceSinglePass===!1?(ce.side=vr,ce.needsUpdate=!0,v.renderBufferDirect(de,Q,le,ce,he,De),ce.side=Ka,ce.needsUpdate=!0,v.renderBufferDirect(de,Q,le,ce,he,De),ce.side=oo):v.renderBufferDirect(de,Q,le,ce,he,De),he.onAfterRender(v,Q,de,le,ce,De)}function Wn(he,Q,de){Q.isScene!==!0&&(Q=q);let le=ne.get(he),ce=d.state.lights,De=d.state.shadowsArray,Ke=ce.state.version,Ze=Re.getParameters(he,ce.state,De,Q,de),it=Re.getProgramCacheKey(Ze),ht=le.programs;le.environment=he.isMeshStandardMaterial?Q.environment:null,le.fog=Q.fog,le.envMap=(he.isMeshStandardMaterial?xe:me).get(he.envMap||le.environment),ht===void 0&&(he.addEventListener("dispose",dt),ht=new Map,le.programs=ht);let lt=ht.get(it);if(lt!==void 0){if(le.currentProgram===lt&&le.lightsStateVersion===Ke)return sc(he,Ze),lt}else Ze.uniforms=Re.getUniforms(he),he.onBuild(de,Ze,v),he.onBeforeCompile(Ze,v),lt=Re.acquireProgram(Ze,it),ht.set(it,lt),le.uniforms=Ze.uniforms;let ot=le.uniforms;(!he.isShaderMaterial&&!he.isRawShaderMaterial||he.clipping===!0)&&(ot.clippingPlanes=L.uniform),sc(he,Ze),le.needsLights=nd(he),le.lightsStateVersion=Ke,le.needsLights&&(ot.ambientLightColor.value=ce.state.ambient,ot.lightProbe.value=ce.state.probe,ot.directionalLights.value=ce.state.directional,ot.directionalLightShadows.value=ce.state.directionalShadow,ot.spotLights.value=ce.state.spot,ot.spotLightShadows.value=ce.state.spotShadow,ot.rectAreaLights.value=ce.state.rectArea,ot.ltc_1.value=ce.state.rectAreaLTC1,ot.ltc_2.value=ce.state.rectAreaLTC2,ot.pointLights.value=ce.state.point,ot.pointLightShadows.value=ce.state.pointShadow,ot.hemisphereLights.value=ce.state.hemi,ot.directionalShadowMap.value=ce.state.directionalShadowMap,ot.directionalShadowMatrix.value=ce.state.directionalShadowMatrix,ot.spotShadowMap.value=ce.state.spotShadowMap,ot.spotLightMatrix.value=ce.state.spotLightMatrix,ot.spotLightMap.value=ce.state.spotLightMap,ot.pointShadowMap.value=ce.state.pointShadowMap,ot.pointShadowMatrix.value=ce.state.pointShadowMatrix);let Mt=lt.getUniforms(),Vt=wb.seqWithValue(Mt.seq,ot);return le.currentProgram=lt,le.uniformsList=Vt,lt}function sc(he,Q){let de=ne.get(he);de.outputEncoding=Q.outputEncoding,de.instancing=Q.instancing,de.skinning=Q.skinning,de.morphTargets=Q.morphTargets,de.morphNormals=Q.morphNormals,de.morphColors=Q.morphColors,de.morphTargetsCount=Q.morphTargetsCount,de.numClippingPlanes=Q.numClippingPlanes,de.numIntersection=Q.numClipIntersection,de.vertexAlphas=Q.vertexAlphas,de.vertexTangents=Q.vertexTangents,de.toneMapping=Q.toneMapping}function Jf(he,Q,de,le,ce){Q.isScene!==!0&&(Q=q),ie.resetTextureUnits();let De=Q.fog,Ke=le.isMeshStandardMaterial?Q.environment:null,Ze=_===null?v.outputEncoding:_.isXRRenderTarget===!0?_.texture.encoding:Jl,it=(le.isMeshStandardMaterial?xe:me).get(le.envMap||Ke),ht=le.vertexColors===!0&&!!de.attributes.color&&de.attributes.color.itemSize===4,lt=!!le.normalMap&&!!de.attributes.tangent,ot=!!de.morphAttributes.position,Mt=!!de.morphAttributes.normal,Vt=!!de.morphAttributes.color,Nn=le.toneMapped?v.toneMapping:qc,Si=de.morphAttributes.position||de.morphAttributes.normal||de.morphAttributes.color,vn=Si!==void 0?Si.length:0,yt=ne.get(le),Qt=d.state.lights;if(O===!0&&(W===!0||he!==A)){let dn=he===A&&le.id===S;L.setState(le,he,dn)}let fa=!1;le.version===yt.__version?(yt.needsLights&&yt.lightsStateVersion!==Qt.state.version||yt.outputEncoding!==Ze||ce.isInstancedMesh&&yt.instancing===!1||!ce.isInstancedMesh&&yt.instancing===!0||ce.isSkinnedMesh&&yt.skinning===!1||!ce.isSkinnedMesh&&yt.skinning===!0||yt.envMap!==it||le.fog===!0&&yt.fog!==De||yt.numClippingPlanes!==void 0&&(yt.numClippingPlanes!==L.numPlanes||yt.numIntersection!==L.numIntersection)||yt.vertexAlphas!==ht||yt.vertexTangents!==lt||yt.morphTargets!==ot||yt.morphNormals!==Mt||yt.morphColors!==Vt||yt.toneMapping!==Nn||ve.isWebGL2===!0&&yt.morphTargetsCount!==vn)&&(fa=!0):(fa=!0,yt.__version=le.version);let Bn=yt.currentProgram;fa===!0&&(Bn=Wn(le,Q,ce));let xs=!1,Zr=!1,or=!1,Gt=Bn.getUniforms(),It=yt.uniforms;if($.useProgram(Bn.program)&&(xs=!0,Zr=!0,or=!0),le.id!==S&&(S=le.id,Zr=!0),xs||A!==he){if(Gt.setValue(G,"projectionMatrix",he.projectionMatrix),ve.logarithmicDepthBuffer&&Gt.setValue(G,"logDepthBufFC",2/(Math.log(he.far+1)/Math.LN2)),A!==he&&(A=he,Zr=!0,or=!0),le.isShaderMaterial||le.isMeshPhongMaterial||le.isMeshToonMaterial||le.isMeshStandardMaterial||le.envMap){let dn=Gt.map.cameraPosition;dn!==void 0&&dn.setValue(G,X.setFromMatrixPosition(he.matrixWorld))}(le.isMeshPhongMaterial||le.isMeshToonMaterial||le.isMeshLambertMaterial||le.isMeshBasicMaterial||le.isMeshStandardMaterial||le.isShaderMaterial)&&Gt.setValue(G,"isOrthographic",he.isOrthographicCamera===!0),(le.isMeshPhongMaterial||le.isMeshToonMaterial||le.isMeshLambertMaterial||le.isMeshBasicMaterial||le.isMeshStandardMaterial||le.isShaderMaterial||le.isShadowMaterial||ce.isSkinnedMesh)&&Gt.setValue(G,"viewMatrix",he.matrixWorldInverse)}if(ce.isSkinnedMesh){Gt.setOptional(G,ce,"bindMatrix"),Gt.setOptional(G,ce,"bindMatrixInverse");let dn=ce.skeleton;dn&&(ve.floatVertexTextures?(dn.boneTexture===null&&dn.computeBoneTexture(),Gt.setValue(G,"boneTexture",dn.boneTexture,ie),Gt.setValue(G,"boneTextureSize",dn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let Ri=de.morphAttributes;if((Ri.position!==void 0||Ri.normal!==void 0||Ri.color!==void 0&&ve.isWebGL2===!0)&&Te.update(ce,de,le,Bn),(Zr||yt.receiveShadow!==ce.receiveShadow)&&(yt.receiveShadow=ce.receiveShadow,Gt.setValue(G,"receiveShadow",ce.receiveShadow)),le.isMeshGouraudMaterial&&le.envMap!==null&&(It.envMap.value=it,It.flipEnvMap.value=it.isCubeTexture&&it.isRenderTargetTexture===!1?-1:1),Zr&&(Gt.setValue(G,"toneMappingExposure",v.toneMappingExposure),yt.needsLights&&Zf(It,or),De&&le.fog===!0&&Ue.refreshFogUniforms(It,De),Ue.refreshMaterialUniforms(It,le,R,P,H),wb.upload(G,yt.uniformsList,It,ie)),le.isShaderMaterial&&le.uniformsNeedUpdate===!0&&(wb.upload(G,yt.uniformsList,It,ie),le.uniformsNeedUpdate=!1),le.isSpriteMaterial&&Gt.setValue(G,"center",ce.center),Gt.setValue(G,"modelViewMatrix",ce.modelViewMatrix),Gt.setValue(G,"normalMatrix",ce.normalMatrix),Gt.setValue(G,"modelMatrix",ce.matrixWorld),le.isShaderMaterial||le.isRawShaderMaterial){let dn=le.uniformsGroups;for(let yn=0,Gs=dn.length;yn<Gs;yn++)if(ve.isWebGL2){let pa=dn[yn];Ve.update(pa,Bn),Ve.bind(pa,Bn)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Bn}function Zf(he,Q){he.ambientLightColor.needsUpdate=Q,he.lightProbe.needsUpdate=Q,he.directionalLights.needsUpdate=Q,he.directionalLightShadows.needsUpdate=Q,he.pointLights.needsUpdate=Q,he.pointLightShadows.needsUpdate=Q,he.spotLights.needsUpdate=Q,he.spotLightShadows.needsUpdate=Q,he.rectAreaLights.needsUpdate=Q,he.hemisphereLights.needsUpdate=Q}function nd(he){return he.isMeshLambertMaterial||he.isMeshToonMaterial||he.isMeshPhongMaterial||he.isMeshStandardMaterial||he.isShadowMaterial||he.isShaderMaterial&&he.lights===!0}this.getActiveCubeFace=function(){return m},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return _},this.setRenderTargetTextures=function(he,Q,de){ne.get(he.texture).__webglTexture=Q,ne.get(he.depthTexture).__webglTexture=de;let le=ne.get(he);le.__hasExternalTextures=!0,le.__hasExternalTextures&&(le.__autoAllocateDepthBuffer=de===void 0,le.__autoAllocateDepthBuffer||oe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),le.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(he,Q){let de=ne.get(he);de.__webglFramebuffer=Q,de.__useDefaultFramebuffer=Q===void 0},this.setRenderTarget=function(he,Q=0,de=0){_=he,m=Q,y=de;let le=!0,ce=null,De=!1,Ke=!1;if(he){let Ze=ne.get(he);Ze.__useDefaultFramebuffer!==void 0?($.bindFramebuffer(36160,null),le=!1):Ze.__webglFramebuffer===void 0?ie.setupRenderTarget(he):Ze.__hasExternalTextures&&ie.rebindTextures(he,ne.get(he.texture).__webglTexture,ne.get(he.depthTexture).__webglTexture);let it=he.texture;(it.isData3DTexture||it.isDataArrayTexture||it.isCompressedArrayTexture)&&(Ke=!0);let ht=ne.get(he).__webglFramebuffer;he.isWebGLCubeRenderTarget?(ce=ht[Q],De=!0):ve.isWebGL2&&he.samples>0&&ie.useMultisampledRTT(he)===!1?ce=ne.get(he).__webglMultisampledFramebuffer:ce=ht,b.copy(he.viewport),T.copy(he.scissor),M=he.scissorTest}else b.copy(k).multiplyScalar(R).floor(),T.copy(j).multiplyScalar(R).floor(),M=Z;if($.bindFramebuffer(36160,ce)&&ve.drawBuffers&&le&&$.drawBuffers(he,ce),$.viewport(b),$.scissor(T),$.setScissorTest(M),De){let Ze=ne.get(he.texture);G.framebufferTexture2D(36160,36064,34069+Q,Ze.__webglTexture,de)}else if(Ke){let Ze=ne.get(he.texture),it=Q||0;G.framebufferTextureLayer(36160,36064,Ze.__webglTexture,de||0,it)}S=-1},this.readRenderTargetPixels=function(he,Q,de,le,ce,De,Ke){if(!(he&&he.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Ze=ne.get(he).__webglFramebuffer;if(he.isWebGLCubeRenderTarget&&Ke!==void 0&&(Ze=Ze[Ke]),Ze){$.bindFramebuffer(36160,Ze);try{let it=he.texture,ht=it.format,lt=it.type;if(ht!==Fa&&Ge.convert(ht)!==G.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let ot=lt===bx&&(oe.has("EXT_color_buffer_half_float")||ve.isWebGL2&&oe.has("EXT_color_buffer_float"));if(lt!==Kr&&Ge.convert(lt)!==G.getParameter(35738)&&!(lt===ch&&(ve.isWebGL2||oe.has("OES_texture_float")||oe.has("WEBGL_color_buffer_float")))&&!ot){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Q>=0&&Q<=he.width-le&&de>=0&&de<=he.height-ce&&G.readPixels(Q,de,le,ce,Ge.convert(ht),Ge.convert(lt),De)}finally{let it=_!==null?ne.get(_).__webglFramebuffer:null;$.bindFramebuffer(36160,it)}}},this.copyFramebufferToTexture=function(he,Q,de=0){let le=Math.pow(2,-de),ce=Math.floor(Q.image.width*le),De=Math.floor(Q.image.height*le);ie.setTexture2D(Q,0),G.copyTexSubImage2D(3553,de,0,0,he.x,he.y,ce,De),$.unbindTexture()},this.copyTextureToTexture=function(he,Q,de,le=0){let ce=Q.image.width,De=Q.image.height,Ke=Ge.convert(de.format),Ze=Ge.convert(de.type);ie.setTexture2D(de,0),G.pixelStorei(37440,de.flipY),G.pixelStorei(37441,de.premultiplyAlpha),G.pixelStorei(3317,de.unpackAlignment),Q.isDataTexture?G.texSubImage2D(3553,le,he.x,he.y,ce,De,Ke,Ze,Q.image.data):Q.isCompressedTexture?G.compressedTexSubImage2D(3553,le,he.x,he.y,Q.mipmaps[0].width,Q.mipmaps[0].height,Ke,Q.mipmaps[0].data):G.texSubImage2D(3553,le,he.x,he.y,Ke,Ze,Q.image),le===0&&de.generateMipmaps&&G.generateMipmap(3553),$.unbindTexture()},this.copyTextureToTexture3D=function(he,Q,de,le,ce=0){if(v.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let De=he.max.x-he.min.x+1,Ke=he.max.y-he.min.y+1,Ze=he.max.z-he.min.z+1,it=Ge.convert(le.format),ht=Ge.convert(le.type),lt;if(le.isData3DTexture)ie.setTexture3D(le,0),lt=32879;else if(le.isDataArrayTexture)ie.setTexture2DArray(le,0),lt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}G.pixelStorei(37440,le.flipY),G.pixelStorei(37441,le.premultiplyAlpha),G.pixelStorei(3317,le.unpackAlignment);let ot=G.getParameter(3314),Mt=G.getParameter(32878),Vt=G.getParameter(3316),Nn=G.getParameter(3315),Si=G.getParameter(32877),vn=de.isCompressedTexture?de.mipmaps[0]:de.image;G.pixelStorei(3314,vn.width),G.pixelStorei(32878,vn.height),G.pixelStorei(3316,he.min.x),G.pixelStorei(3315,he.min.y),G.pixelStorei(32877,he.min.z),de.isDataTexture||de.isData3DTexture?G.texSubImage3D(lt,ce,Q.x,Q.y,Q.z,De,Ke,Ze,it,ht,vn.data):de.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),G.compressedTexSubImage3D(lt,ce,Q.x,Q.y,Q.z,De,Ke,Ze,it,vn.data)):G.texSubImage3D(lt,ce,Q.x,Q.y,Q.z,De,Ke,Ze,it,ht,vn),G.pixelStorei(3314,ot),G.pixelStorei(32878,Mt),G.pixelStorei(3316,Vt),G.pixelStorei(3315,Nn),G.pixelStorei(32877,Si),ce===0&&le.generateMipmaps&&G.generateMipmap(lt),$.unbindTexture()},this.initTexture=function(he){he.isCubeTexture?ie.setTextureCube(he,0):he.isData3DTexture?ie.setTexture3D(he,0):he.isDataArrayTexture||he.isCompressedArrayTexture?ie.setTexture2DArray(he,0):ie.setTexture2D(he,0),$.unbindTexture()},this.resetState=function(){m=0,y=0,_=null,$.reset(),ye.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var cbe=class extends RQ{};cbe.prototype.isWebGL1Renderer=!0;var LQ=class{constructor(t,e=1,n=1e3){this.isFog=!0,this.name="",this.color=new Rt(t),this.near=e,this.far=n}clone(){return new LQ(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},gf=class extends Fn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}},ube=class{constructor(t,e){this.isInterleavedBuffer=!0,this.array=t,this.stride=e,this.count=t!==void 0?t.length/e:0,this.usage=EL,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=jl()}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,e,n){t*=this.stride,n*=e.stride;for(let i=0,r=this.stride;i<r;i++)this.array[t+i]=e.array[n+i];return this}set(t,e=0){return this.array.set(t,e),this}clone(t){t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=jl()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let e=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(e,this.stride);return n.setUsage(this.usage),n}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=jl()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},is=new N,DL=class{constructor(t,e,n,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=t,this.itemSize=e,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let e=0,n=this.data.count;e<n;e++)is.fromBufferAttribute(this,e),is.applyMatrix4(t),this.setXYZ(e,is.x,is.y,is.z);return this}applyNormalMatrix(t){for(let e=0,n=this.count;e<n;e++)is.fromBufferAttribute(this,e),is.applyNormalMatrix(t),this.setXYZ(e,is.x,is.y,is.z);return this}transformDirection(t){for(let e=0,n=this.count;e<n;e++)is.fromBufferAttribute(this,e),is.transformDirection(t),this.setXYZ(e,is.x,is.y,is.z);return this}setX(t,e){return this.normalized&&(e=kn(e,this.array)),this.data.array[t*this.data.stride+this.offset]=e,this}setY(t,e){return this.normalized&&(e=kn(e,this.array)),this.data.array[t*this.data.stride+this.offset+1]=e,this}setZ(t,e){return this.normalized&&(e=kn(e,this.array)),this.data.array[t*this.data.stride+this.offset+2]=e,this}setW(t,e){return this.normalized&&(e=kn(e,this.array)),this.data.array[t*this.data.stride+this.offset+3]=e,this}getX(t){let e=this.data.array[t*this.data.stride+this.offset];return this.normalized&&(e=Gc(e,this.array)),e}getY(t){let e=this.data.array[t*this.data.stride+this.offset+1];return this.normalized&&(e=Gc(e,this.array)),e}getZ(t){let e=this.data.array[t*this.data.stride+this.offset+2];return this.normalized&&(e=Gc(e,this.array)),e}getW(t){let e=this.data.array[t*this.data.stride+this.offset+3];return this.normalized&&(e=Gc(e,this.array)),e}setXY(t,e,n){return t=t*this.data.stride+this.offset,this.normalized&&(e=kn(e,this.array),n=kn(n,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this}setXYZ(t,e,n,i){return t=t*this.data.stride+this.offset,this.normalized&&(e=kn(e,this.array),n=kn(n,this.array),i=kn(i,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this}setXYZW(t,e,n,i,r){return t=t*this.data.stride+this.offset,this.normalized&&(e=kn(e,this.array),n=kn(n,this.array),i=kn(i,this.array),r=kn(r,this.array)),this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=i,this.data.array[t+3]=r,this}clone(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let n=0;n<this.count;n++){let i=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)e.push(this.data.array[i+r])}return new Ut(new this.array.constructor(e),this.itemSize,this.normalized)}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new DL(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let n=0;n<this.count;n++){let i=n*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)e.push(this.data.array[i+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},hbe=class extends Ut{constructor(t,e,n,i=1){super(t,e,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){let t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}},$h=class extends M1{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Rt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}},mV=new N,gV=new N,vV=new nt,e2=new uv,lS=new la,MA=class extends Fn{constructor(t=new Lt,e=new $h){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){let t=this.geometry;if(t.index===null){let e=t.attributes.position,n=[0];for(let i=1,r=e.count;i<r;i++)mV.fromBufferAttribute(e,i-1),gV.fromBufferAttribute(e,i),n[i]=n[i-1],n[i]+=mV.distanceTo(gV);t.setAttribute("lineDistance",new ft(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,e){let n=this.geometry,i=this.matrixWorld,r=t.params.Line.threshold,s=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),lS.copy(n.boundingSphere),lS.applyMatrix4(i),lS.radius+=r,t.ray.intersectsSphere(lS)===!1)return;vV.copy(i).invert(),e2.copy(t.ray).applyMatrix4(vV);let o=r/((this.scale.x+this.scale.y+this.scale.z)/3),a=o*o,l=new N,c=new N,h=new N,u=new N,d=this.isLineSegments?2:1,f=n.index,p=n.attributes.position;if(f!==null){let v=Math.max(0,s.start),g=Math.min(f.count,s.start+s.count);for(let m=v,y=g-1;m<y;m+=d){let _=f.getX(m),S=f.getX(m+1);if(l.fromBufferAttribute(p,_),c.fromBufferAttribute(p,S),e2.distanceSqToSegment(l,c,u,h)>a)continue;u.applyMatrix4(this.matrixWorld);let A=t.ray.origin.distanceTo(u);A<t.near||A>t.far||e.push({distance:A,point:h.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else{let v=Math.max(0,s.start),g=Math.min(p.count,s.start+s.count);for(let m=v,y=g-1;m<y;m+=d){if(l.fromBufferAttribute(p,m),c.fromBufferAttribute(p,m+1),e2.distanceSqToSegment(l,c,u,h)>a)continue;u.applyMatrix4(this.matrixWorld);let _=t.ray.origin.distanceTo(u);_<t.near||_>t.far||e.push({distance:_,point:h.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let t=this.geometry.morphAttributes,e=Object.keys(t);if(e.length>0){let n=t[e[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,r=n.length;i<r;i++){let s=n[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=i}}}}},yV=new N,xV=new N,C1=class extends MA{constructor(t,e){super(t,e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let t=this.geometry;if(t.index===null){let e=t.attributes.position,n=[];for(let i=0,r=e.count;i<r;i+=2)yV.fromBufferAttribute(e,i),xV.fromBufferAttribute(e,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+yV.distanceTo(xV);t.setAttribute("lineDistance",new ft(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},dbe=class extends _r{constructor(t,e,n,i,r,s,o,a,l){super(t,e,n,i,r,s,o,a,l),this.isVideoTexture=!0,this.minFilter=s!==void 0?s:En,this.magFilter=r!==void 0?r:En,this.generateMipmaps=!1;let c=this;function h(){c.needsUpdate=!0,t.requestVideoFrameCallback(h)}"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(h)}clone(){return new this.constructor(this.image).copy(this)}update(){let t=this.image;!("requestVideoFrameCallback"in t)&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},nc=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){let n=this.getUtoTmapping(t);return this.getPoint(n,e)}getPoints(t=5){let e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return e}getSpacedPoints(t=5){let e=[];for(let n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e}getLength(){let t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let e=[],n,i=this.getPoint(0),r=0;e.push(0);for(let s=1;s<=t;s++)n=this.getPoint(s/t),r+=n.distanceTo(i),e.push(r),i=n;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){let n=this.getLengths(),i=0,r=n.length,s;e?s=e:s=t*n[r-1];let o=0,a=r-1,l;for(;o<=a;)if(i=Math.floor(o+(a-o)/2),l=n[i]-s,l<0)o=i+1;else if(l>0)a=i-1;else{a=i;break}if(i=a,n[i]===s)return i/(r-1);let c=n[i],h=n[i+1]-c,u=(s-c)/h;return(i+u)/(r-1)}getTangent(t,e){let n=t-1e-4,i=t+1e-4;n<0&&(n=0),i>1&&(i=1);let r=this.getPoint(n),s=this.getPoint(i),o=e||(r.isVector2?new Se:new N);return o.copy(s).sub(r).normalize(),o}getTangentAt(t,e){let n=this.getUtoTmapping(t);return this.getTangent(n,e)}computeFrenetFrames(t,e){let n=new N,i=[],r=[],s=[],o=new N,a=new nt;for(let d=0;d<=t;d++){let f=d/t;i[d]=this.getTangentAt(f,new N)}r[0]=new N,s[0]=new N;let l=Number.MAX_VALUE,c=Math.abs(i[0].x),h=Math.abs(i[0].y),u=Math.abs(i[0].z);c<=l&&(l=c,n.set(1,0,0)),h<=l&&(l=h,n.set(0,1,0)),u<=l&&n.set(0,0,1),o.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],o),s[0].crossVectors(i[0],r[0]);for(let d=1;d<=t;d++){if(r[d]=r[d-1].clone(),s[d]=s[d-1].clone(),o.crossVectors(i[d-1],i[d]),o.length()>Number.EPSILON){o.normalize();let f=Math.acos(Ki(i[d-1].dot(i[d]),-1,1));r[d].applyMatrix4(a.makeRotationAxis(o,f))}s[d].crossVectors(i[d],r[d])}if(e===!0){let d=Math.acos(Ki(r[0].dot(r[t]),-1,1));d/=t,i[0].dot(o.crossVectors(r[0],r[t]))>0&&(d=-d);for(let f=1;f<=t;f++)r[f].applyMatrix4(a.makeRotationAxis(i[f],d*f)),s[f].crossVectors(i[f],r[f])}return{tangents:i,normals:r,binormals:s}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){let t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}},uE=class extends nc{constructor(t=0,e=0,n=1,i=1,r=0,s=Math.PI*2,o=!1,a=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=n,this.yRadius=i,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=o,this.aRotation=a}getPoint(t,e){let n=e||new Se,i=Math.PI*2,r=this.aEndAngle-this.aStartAngle,s=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(s?r=0:r=i),this.aClockwise===!0&&!s&&(r===i?r=-i:r=r-i);let o=this.aStartAngle+t*r,a=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){let c=Math.cos(this.aRotation),h=Math.sin(this.aRotation),u=a-this.aX,d=l-this.aY;a=u*c-d*h+this.aX,l=u*h+d*c+this.aY}return n.set(a,l)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){let t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}},fbe=class extends uE{constructor(t,e,n,i,r,s){super(t,e,n,n,i,r,s),this.isArcCurve=!0,this.type="ArcCurve"}};function SO(){let t=0,e=0,n=0,i=0;function r(s,o,a,l){t=s,e=a,n=-3*s+3*o-2*a-l,i=2*s-2*o+a+l}return{initCatmullRom:function(s,o,a,l,c){r(o,a,c*(a-s),c*(l-o))},initNonuniformCatmullRom:function(s,o,a,l,c,h,u){let d=(o-s)/c-(a-s)/(c+h)+(a-o)/h,f=(a-o)/h-(l-o)/(h+u)+(l-a)/u;d*=h,f*=h,r(o,a,d,f)},calc:function(s){let o=s*s,a=o*s;return t+e*s+n*o+i*a}}}var cS=new N,t2=new SO,n2=new SO,i2=new SO,pbe=class extends nc{constructor(t=[],e=!1,n="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=n,this.tension=i}getPoint(t,e=new N){let n=e,i=this.points,r=i.length,s=(r-(this.closed?0:1))*t,o=Math.floor(s),a=s-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/r)+1)*r:a===0&&o===r-1&&(o=r-2,a=1);let l,c;this.closed||o>0?l=i[(o-1)%r]:(cS.subVectors(i[0],i[1]).add(i[0]),l=cS);let h=i[o%r],u=i[(o+1)%r];if(this.closed||o+2<r?c=i[(o+2)%r]:(cS.subVectors(i[r-1],i[r-2]).add(i[r-1]),c=cS),this.curveType==="centripetal"||this.curveType==="chordal"){let d=this.curveType==="chordal"?.5:.25,f=Math.pow(l.distanceToSquared(h),d),p=Math.pow(h.distanceToSquared(u),d),v=Math.pow(u.distanceToSquared(c),d);p<1e-4&&(p=1),f<1e-4&&(f=p),v<1e-4&&(v=p),t2.initNonuniformCatmullRom(l.x,h.x,u.x,c.x,f,p,v),n2.initNonuniformCatmullRom(l.y,h.y,u.y,c.y,f,p,v),i2.initNonuniformCatmullRom(l.z,h.z,u.z,c.z,f,p,v)}else this.curveType==="catmullrom"&&(t2.initCatmullRom(l.x,h.x,u.x,c.x,this.tension),n2.initCatmullRom(l.y,h.y,u.y,c.y,this.tension),i2.initCatmullRom(l.z,h.z,u.z,c.z,this.tension));return n.set(t2.calc(a),n2.calc(a),i2.calc(a)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){let i=t.points[e];this.points.push(i.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){let t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){let i=this.points[e];t.points.push(i.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){let i=t.points[e];this.points.push(new N().fromArray(i))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}};function _V(t,e,n,i,r){let s=(i-e)*.5,o=(r-n)*.5,a=t*t,l=t*a;return(2*n-2*i+s+o)*l+(-3*n+3*i-2*s-o)*a+s*t+n}function mbe(t,e){let n=1-t;return n*n*e}function gbe(t,e){return 2*(1-t)*t*e}function vbe(t,e){return t*t*e}function Cy(t,e,n,i){return mbe(t,e)+gbe(t,n)+vbe(t,i)}function ybe(t,e){let n=1-t;return n*n*n*e}function xbe(t,e){let n=1-t;return 3*n*n*t*e}function _be(t,e){return 3*(1-t)*t*t*e}function wbe(t,e){return t*t*t*e}function Ty(t,e,n,i,r){return ybe(t,e)+xbe(t,n)+_be(t,i)+wbe(t,r)}var Na=class extends nc{constructor(t=new Se,e=new Se,n=new Se,i=new Se){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new Se){let n=e,i=this.v0,r=this.v1,s=this.v2,o=this.v3;return n.set(Ty(t,i.x,r.x,s.x,o.x),Ty(t,i.y,r.y,s.y,o.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}},Sb=class extends nc{constructor(t=new N,e=new N,n=new N,i=new N){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=n,this.v3=i}getPoint(t,e=new N){let n=e,i=this.v0,r=this.v1,s=this.v2,o=this.v3;return n.set(Ty(t,i.x,r.x,s.x,o.x),Ty(t,i.y,r.y,s.y,o.y),Ty(t,i.z,r.z,s.z,o.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}},Wa=class extends nc{constructor(t=new Se,e=new Se){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new Se){let n=e;return t===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e){let n=e||new Se;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},IQ=class extends nc{constructor(t=new N,e=new N){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=t,this.v2=e}getPoint(t,e=new N){let n=e;return t===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,e){return this.getPoint(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},Hh=class extends nc{constructor(e=new Se,n=new Se,i=new Se){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new Se){let i=n,r=this.v0,s=this.v1,o=this.v2;return i.set(Cy(e,r.x,s.x,o.x),Cy(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Sbe=class extends nc{constructor(t=new N,e=new N,n=new N){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=n}getPoint(t,e=new N){let n=e,i=this.v0,r=this.v1,s=this.v2;return n.set(Cy(t,i.x,r.x,s.x),Cy(t,i.y,r.y,s.y),Cy(t,i.z,r.z,s.z)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},bO=class extends nc{constructor(t=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=t}getPoint(t,e=new Se){let n=e,i=this.points,r=(i.length-1)*t,s=Math.floor(r),o=r-s,a=i[s===0?s:s-1],l=i[s],c=i[s>i.length-2?i.length-1:s+1],h=i[s>i.length-3?i.length-1:s+2];return n.set(_V(o,a.x,l.x,c.x,h.x),_V(o,a.y,l.y,c.y,h.y)),n}copy(t){super.copy(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){let i=t.points[e];this.points.push(i.clone())}return this}toJSON(){let t=super.toJSON();t.points=[];for(let e=0,n=this.points.length;e<n;e++){let i=this.points[e];t.points.push(i.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,n=t.points.length;e<n;e++){let i=t.points[e];this.points.push(new Se().fromArray(i))}return this}},bbe=Object.freeze({__proto__:null,ArcCurve:fbe,CatmullRomCurve3:pbe,CubicBezierCurve:Na,CubicBezierCurve3:Sb,EllipseCurve:uE,LineCurve:Wa,LineCurve3:IQ,QuadraticBezierCurve:Hh,QuadraticBezierCurve3:Sbe,SplineCurve:bO}),BQ=class extends nc{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){let t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Wa(e,t))}getPoint(t,e){let n=t*this.getLength(),i=this.getCurveLengths(),r=0;for(;r<i.length;){if(i[r]>=n){let s=i[r]-n,o=this.curves[r],a=o.getLength(),l=a===0?0:1-s/a;return o.getPointAt(l,e)}r++}return null}getLength(){let t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let t=[],e=0;for(let n=0,i=this.curves.length;n<i;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){let e=[];for(let n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){let e=[],n;for(let i=0,r=this.curves;i<r.length;i++){let s=r[i],o=s.isEllipseCurve?t*2:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?t*s.points.length:t,a=s.getPoints(o);for(let l=0;l<a.length;l++){let c=a[l];n&&n.equals(c)||(e.push(c),n=c)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){let i=t.curves[e];this.curves.push(i.clone())}return this.autoClose=t.autoClose,this}toJSON(){let t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,n=this.curves.length;e<n;e++){let i=this.curves[e];t.curves.push(i.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,n=t.curves.length;e<n;e++){let i=t.curves[e];this.curves.push(new bbe[i.type]().fromJSON(i))}return this}},EA=class extends BQ{constructor(t){super(),this.type="Path",this.currentPoint=new Se,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){let n=new Wa(this.currentPoint.clone(),new Se(t,e));return this.curves.push(n),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,n,i){let r=new Hh(this.currentPoint.clone(),new Se(t,e),new Se(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this}bezierCurveTo(t,e,n,i,r,s){let o=new Na(this.currentPoint.clone(),new Se(t,e),new Se(n,i),new Se(r,s));return this.curves.push(o),this.currentPoint.set(r,s),this}splineThru(t){let e=[this.currentPoint.clone()].concat(t),n=new bO(e);return this.curves.push(n),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,n,i,r,s){let o=this.currentPoint.x,a=this.currentPoint.y;return this.absarc(t+o,e+a,n,i,r,s),this}absarc(t,e,n,i,r,s){return this.absellipse(t,e,n,n,i,r,s),this}ellipse(t,e,n,i,r,s,o,a){let l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(t+l,e+c,n,i,r,s,o,a),this}absellipse(t,e,n,i,r,s,o,a){let l=new uE(t,e,n,i,r,s,o,a);if(this.curves.length>0){let h=l.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(l);let c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){let t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}},OQ=class extends Lt{constructor(t=[new Se(0,-.5),new Se(.5,0),new Se(0,.5)],e=12,n=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:i},e=Math.floor(e),i=Ki(i,0,Math.PI*2);let r=[],s=[],o=[],a=[],l=[],c=1/e,h=new N,u=new Se,d=new N,f=new N,p=new N,v=0,g=0;for(let m=0;m<=t.length-1;m++)switch(m){case 0:v=t[m+1].x-t[m].x,g=t[m+1].y-t[m].y,d.x=g*1,d.y=-v,d.z=g*0,p.copy(d),d.normalize(),a.push(d.x,d.y,d.z);break;case t.length-1:a.push(p.x,p.y,p.z);break;default:v=t[m+1].x-t[m].x,g=t[m+1].y-t[m].y,d.x=g*1,d.y=-v,d.z=g*0,f.copy(d),d.x+=p.x,d.y+=p.y,d.z+=p.z,d.normalize(),a.push(d.x,d.y,d.z),p.copy(f)}for(let m=0;m<=e;m++){let y=n+m*c*i,_=Math.sin(y),S=Math.cos(y);for(let A=0;A<=t.length-1;A++){h.x=t[A].x*_,h.y=t[A].y,h.z=t[A].x*S,s.push(h.x,h.y,h.z),u.x=m/e,u.y=A/(t.length-1),o.push(u.x,u.y);let b=a[3*A+0]*_,T=a[3*A+1],M=a[3*A+0]*S;l.push(b,T,M)}}for(let m=0;m<e;m++)for(let y=0;y<t.length-1;y++){let _=y+m*t.length,S=_,A=_+t.length,b=_+t.length+1,T=_+1;r.push(S,A,T),r.push(b,T,A)}this.setIndex(r),this.setAttribute("position",new ft(s,3)),this.setAttribute("uv",new ft(o,2)),this.setAttribute("normal",new ft(l,3))}static fromJSON(t){return new OQ(t.points,t.segments,t.phiStart,t.phiLength)}},AO=class extends Lt{constructor(t=1,e=1,n=1,i=32,r=1,s=!1,o=0,a=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a};let l=this;i=Math.floor(i),r=Math.floor(r);let c=[],h=[],u=[],d=[],f=0,p=[],v=n/2,g=0;m(),s===!1&&(t>0&&y(!0),e>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new ft(h,3)),this.setAttribute("normal",new ft(u,3)),this.setAttribute("uv",new ft(d,2));function m(){let _=new N,S=new N,A=0,b=(e-t)/n;for(let T=0;T<=r;T++){let M=[],E=T/r,P=E*(e-t)+t;for(let R=0;R<=i;R++){let F=R/i,B=F*a+o,k=Math.sin(B),j=Math.cos(B);S.x=P*k,S.y=-E*n+v,S.z=P*j,h.push(S.x,S.y,S.z),_.set(k,b,j).normalize(),u.push(_.x,_.y,_.z),d.push(F,1-E),M.push(f++)}p.push(M)}for(let T=0;T<i;T++)for(let M=0;M<r;M++){let E=p[M][T],P=p[M+1][T],R=p[M+1][T+1],F=p[M][T+1];c.push(E,P,F),c.push(P,R,F),A+=6}l.addGroup(g,A,0),g+=A}function y(_){let S=f,A=new Se,b=new N,T=0,M=_===!0?t:e,E=_===!0?1:-1;for(let R=1;R<=i;R++)h.push(0,v*E,0),u.push(0,E,0),d.push(.5,.5),f++;let P=f;for(let R=0;R<=i;R++){let F=R/i*a+o,B=Math.cos(F),k=Math.sin(F);b.x=M*k,b.y=v*E,b.z=M*B,h.push(b.x,b.y,b.z),u.push(0,E,0),A.x=B*.5+.5,A.y=k*.5*E+.5,d.push(A.x,A.y),f++}for(let R=0;R<i;R++){let F=S+R,B=P+R;_===!0?c.push(B,B+1,F):c.push(B+1,B,F),T+=3}l.addGroup(g,T,_===!0?1:2),g+=T}}static fromJSON(t){return new AO(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}},FQ=class extends AO{constructor(t=1,e=1,n=32,i=1,r=!1,s=0,o=Math.PI*2){super(0,t,e,n,i,r,s,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:s,thetaLength:o}}static fromJSON(t){return new FQ(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}},MO=class extends Lt{constructor(t=[],e=[],n=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:i};let r=[],s=[];o(i),l(n),c(),this.setAttribute("position",new ft(r,3)),this.setAttribute("normal",new ft(r.slice(),3)),this.setAttribute("uv",new ft(s,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function o(m){let y=new N,_=new N,S=new N;for(let A=0;A<e.length;A+=3)d(e[A+0],y),d(e[A+1],_),d(e[A+2],S),a(y,_,S,m)}function a(m,y,_,S){let A=S+1,b=[];for(let T=0;T<=A;T++){b[T]=[];let M=m.clone().lerp(_,T/A),E=y.clone().lerp(_,T/A),P=A-T;for(let R=0;R<=P;R++)R===0&&T===A?b[T][R]=M:b[T][R]=M.clone().lerp(E,R/P)}for(let T=0;T<A;T++)for(let M=0;M<2*(A-T)-1;M++){let E=Math.floor(M/2);M%2===0?(u(b[T][E+1]),u(b[T+1][E]),u(b[T][E])):(u(b[T][E+1]),u(b[T+1][E+1]),u(b[T+1][E]))}}function l(m){let y=new N;for(let _=0;_<r.length;_+=3)y.x=r[_+0],y.y=r[_+1],y.z=r[_+2],y.normalize().multiplyScalar(m),r[_+0]=y.x,r[_+1]=y.y,r[_+2]=y.z}function c(){let m=new N;for(let y=0;y<r.length;y+=3){m.x=r[y+0],m.y=r[y+1],m.z=r[y+2];let _=v(m)/2/Math.PI+.5,S=g(m)/Math.PI+.5;s.push(_,1-S)}f(),h()}function h(){for(let m=0;m<s.length;m+=6){let y=s[m+0],_=s[m+2],S=s[m+4],A=Math.max(y,_,S),b=Math.min(y,_,S);A>.9&&b<.1&&(y<.2&&(s[m+0]+=1),_<.2&&(s[m+2]+=1),S<.2&&(s[m+4]+=1))}}function u(m){r.push(m.x,m.y,m.z)}function d(m,y){let _=m*3;y.x=t[_+0],y.y=t[_+1],y.z=t[_+2]}function f(){let m=new N,y=new N,_=new N,S=new N,A=new Se,b=new Se,T=new Se;for(let M=0,E=0;M<r.length;M+=9,E+=6){m.set(r[M+0],r[M+1],r[M+2]),y.set(r[M+3],r[M+4],r[M+5]),_.set(r[M+6],r[M+7],r[M+8]),A.set(s[E+0],s[E+1]),b.set(s[E+2],s[E+3]),T.set(s[E+4],s[E+5]),S.copy(m).add(y).add(_).divideScalar(3);let P=v(S);p(A,E+0,m,P),p(b,E+2,y,P),p(T,E+4,_,P)}}function p(m,y,_,S){S<0&&m.x===1&&(s[y]=m.x-1),_.x===0&&_.z===0&&(s[y]=S/2/Math.PI+.5)}function v(m){return Math.atan2(m.z,-m.x)}function g(m){return Math.atan2(-m.y,Math.sqrt(m.x*m.x+m.z*m.z))}}static fromJSON(t){return new MO(t.vertices,t.indices,t.radius,t.details)}},NQ=class extends MO{constructor(t=1,e=0){let n=(1+Math.sqrt(5))/2,i=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(r,s,t,e),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new NQ(t.radius,t.detail)}},CA=class extends EA{constructor(t){super(t),this.uuid=jl(),this.type="Shape",this.holes=[]}getPointsHoles(t){let e=[];for(let n=0,i=this.holes.length;n<i;n++)e[n]=this.holes[n].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){let i=t.holes[e];this.holes.push(i.clone())}return this}toJSON(){let t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,n=this.holes.length;e<n;e++){let i=this.holes[e];t.holes.push(i.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,n=t.holes.length;e<n;e++){let i=t.holes[e];this.holes.push(new EA().fromJSON(i))}return this}},Abe={triangulate:function(t,e,n=2){let i=e&&e.length,r=i?e[0]*n:t.length,s=UQ(t,0,r,n,!0),o=[];if(!s||s.next===s.prev)return o;let a,l,c,h,u,d,f;if(i&&(s=Pbe(t,e,s,n)),t.length>80*n){a=c=t[0],l=h=t[1];for(let p=n;p<r;p+=n)u=t[p],d=t[p+1],u<a&&(a=u),d<l&&(l=d),u>c&&(c=u),d>h&&(h=d);f=Math.max(c-a,h-l),f=f!==0?32767/f:0}return Mx(s,o,n,a,l,f,0),o}};function UQ(t,e,n,i,r){let s,o;if(r===zbe(t,e,n,i)>0)for(s=e;s<n;s+=i)o=wV(s,t[s],t[s+1],o);else for(s=n-i;s>=e;s-=i)o=wV(s,t[s],t[s+1],o);return o&&hE(o,o.next)&&(Cx(o),o=o.next),o}function Bf(t,e){if(!t)return t;e||(e=t);let n=t,i;do if(i=!1,!n.steiner&&(hE(n,n.next)||ci(n.prev,n,n.next)===0)){if(Cx(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function Mx(t,e,n,i,r,s,o){if(!t)return;!o&&s&&Bbe(t,i,r,s);let a=t,l,c;for(;t.prev!==t.next;){if(l=t.prev,c=t.next,s?Ebe(t,i,r,s):Mbe(t)){e.push(l.i/n|0),e.push(t.i/n|0),e.push(c.i/n|0),Cx(t),t=c.next,a=c.next;continue}if(t=c,t===a){o?o===1?(t=Cbe(Bf(t),e,n),Mx(t,e,n,i,r,s,2)):o===2&&Tbe(t,e,n,i,r,s):Mx(Bf(t),e,n,i,r,s,1);break}}}function Mbe(t){let e=t.prev,n=t,i=t.next;if(ci(e,n,i)>=0)return!1;let r=e.x,s=n.x,o=i.x,a=e.y,l=n.y,c=i.y,h=r<s?r<o?r:o:s<o?s:o,u=a<l?a<c?a:c:l<c?l:c,d=r>s?r>o?r:o:s>o?s:o,f=a>l?a>c?a:c:l>c?l:c,p=i.next;for(;p!==e;){if(p.x>=h&&p.x<=d&&p.y>=u&&p.y<=f&&zm(r,a,s,l,o,c,p.x,p.y)&&ci(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Ebe(t,e,n,i){let r=t.prev,s=t,o=t.next;if(ci(r,s,o)>=0)return!1;let a=r.x,l=s.x,c=o.x,h=r.y,u=s.y,d=o.y,f=a<l?a<c?a:c:l<c?l:c,p=h<u?h<d?h:d:u<d?u:d,v=a>l?a>c?a:c:l>c?l:c,g=h>u?h>d?h:d:u>d?u:d,m=RL(f,p,e,n,i),y=RL(v,g,e,n,i),_=t.prevZ,S=t.nextZ;for(;_&&_.z>=m&&S&&S.z<=y;){if(_.x>=f&&_.x<=v&&_.y>=p&&_.y<=g&&_!==r&&_!==o&&zm(a,h,l,u,c,d,_.x,_.y)&&ci(_.prev,_,_.next)>=0||(_=_.prevZ,S.x>=f&&S.x<=v&&S.y>=p&&S.y<=g&&S!==r&&S!==o&&zm(a,h,l,u,c,d,S.x,S.y)&&ci(S.prev,S,S.next)>=0))return!1;S=S.nextZ}for(;_&&_.z>=m;){if(_.x>=f&&_.x<=v&&_.y>=p&&_.y<=g&&_!==r&&_!==o&&zm(a,h,l,u,c,d,_.x,_.y)&&ci(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;S&&S.z<=y;){if(S.x>=f&&S.x<=v&&S.y>=p&&S.y<=g&&S!==r&&S!==o&&zm(a,h,l,u,c,d,S.x,S.y)&&ci(S.prev,S,S.next)>=0)return!1;S=S.nextZ}return!0}function Cbe(t,e,n){let i=t;do{let r=i.prev,s=i.next.next;!hE(r,s)&&kQ(r,i,i.next,s)&&Ex(r,s)&&Ex(s,r)&&(e.push(r.i/n|0),e.push(i.i/n|0),e.push(s.i/n|0),Cx(i),Cx(i.next),i=t=s),i=i.next}while(i!==t);return Bf(i)}function Tbe(t,e,n,i,r,s){let o=t;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&Nbe(o,a)){let l=zQ(o,a);o=Bf(o,o.next),l=Bf(l,l.next),Mx(o,e,n,i,r,s,0),Mx(l,e,n,i,r,s,0);return}a=a.next}o=o.next}while(o!==t)}function Pbe(t,e,n,i){let r=[],s,o,a,l,c;for(s=0,o=e.length;s<o;s++)a=e[s]*i,l=s<o-1?e[s+1]*i:t.length,c=UQ(t,a,l,i,!1),c===c.next&&(c.steiner=!0),r.push(Fbe(c));for(r.sort(Dbe),s=0;s<r.length;s++)n=Rbe(r[s],n);return n}function Dbe(t,e){return t.x-e.x}function Rbe(t,e){let n=Lbe(t,e);if(!n)return e;let i=zQ(n,t);return Bf(i,i.next),Bf(n,n.next)}function Lbe(t,e){let n=e,i=-1/0,r,s=t.x,o=t.y;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){let d=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(d<=s&&d>i&&(i=d,r=n.x<n.next.x?n:n.next,d===s))return r}n=n.next}while(n!==e);if(!r)return null;let a=r,l=r.x,c=r.y,h=1/0,u;n=r;do s>=n.x&&n.x>=l&&s!==n.x&&zm(o<c?s:i,o,l,c,o<c?i:s,o,n.x,n.y)&&(u=Math.abs(o-n.y)/(s-n.x),Ex(n,t)&&(u<h||u===h&&(n.x>r.x||n.x===r.x&&Ibe(r,n)))&&(r=n,h=u)),n=n.next;while(n!==a);return r}function Ibe(t,e){return ci(t.prev,t,e.prev)<0&&ci(e.next,t,t.next)<0}function Bbe(t,e,n,i){let r=t;do r.z===0&&(r.z=RL(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,Obe(r)}function Obe(t){let e,n,i,r,s,o,a,l,c=1;do{for(n=t,t=null,s=null,o=0;n;){for(o++,i=n,a=0,e=0;e<c&&(a++,i=i.nextZ,!!i);e++);for(l=c;a>0||l>0&&i;)a!==0&&(l===0||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;n=i}s.nextZ=null,c*=2}while(o>1);return t}function RL(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function Fbe(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function zm(t,e,n,i,r,s,o,a){return(r-o)*(e-a)>=(t-o)*(s-a)&&(t-o)*(i-a)>=(n-o)*(e-a)&&(n-o)*(s-a)>=(r-o)*(i-a)}function Nbe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Ube(t,e)&&(Ex(t,e)&&Ex(e,t)&&kbe(t,e)&&(ci(t.prev,t,e.prev)||ci(t,e.prev,e))||hE(t,e)&&ci(t.prev,t,t.next)>0&&ci(e.prev,e,e.next)>0)}function ci(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function hE(t,e){return t.x===e.x&&t.y===e.y}function kQ(t,e,n,i){let r=hS(ci(t,e,n)),s=hS(ci(t,e,i)),o=hS(ci(n,i,t)),a=hS(ci(n,i,e));return!!(r!==s&&o!==a||r===0&&uS(t,n,e)||s===0&&uS(t,i,e)||o===0&&uS(n,t,i)||a===0&&uS(n,e,i))}function uS(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function hS(t){return t>0?1:t<0?-1:0}function Ube(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&kQ(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Ex(t,e){return ci(t.prev,t,t.next)<0?ci(t,e,t.next)>=0&&ci(t,t.prev,e)>=0:ci(t,e,t.prev)<0||ci(t,t.next,e)<0}function kbe(t,e){let n=t,i=!1,r=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function zQ(t,e){let n=new LL(t.i,t.x,t.y),i=new LL(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function wV(t,e,n,i){let r=new LL(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function Cx(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function LL(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function zbe(t,e,n,i){let r=0;for(let s=e,o=n-i;s<n;s+=i)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r}var GQ=class{static area(t){let e=t.length,n=0;for(let i=e-1,r=0;r<e;i=r++)n+=t[i].x*t[r].y-t[r].x*t[i].y;return n*.5}static isClockWise(t){return GQ.area(t)<0}static triangulateShape(t,e){let n=[],i=[],r=[];SV(t),bV(n,t);let s=t.length;e.forEach(SV);for(let a=0;a<e.length;a++)i.push(s),s+=e[a].length,bV(n,e[a]);let o=Abe.triangulate(n,i);for(let a=0;a<o.length;a+=3)r.push(o.slice(a,a+3));return r}};function SV(t){let e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function bV(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}var HQ=class extends MO{constructor(t=1,e=0){let n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,r,t,e),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e}}static fromJSON(t){return new HQ(t.radius,t.detail)}},EO=class extends Lt{constructor(t=1,e=32,n=16,i=0,r=Math.PI*2,s=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:i,phiLength:r,thetaStart:s,thetaLength:o},e=Math.max(3,Math.floor(e)),n=Math.max(2,Math.floor(n));let a=Math.min(s+o,Math.PI),l=0,c=[],h=new N,u=new N,d=[],f=[],p=[],v=[];for(let g=0;g<=n;g++){let m=[],y=g/n,_=0;g==0&&s==0?_=.5/e:g==n&&a==Math.PI&&(_=-.5/e);for(let S=0;S<=e;S++){let A=S/e;h.x=-t*Math.cos(i+A*r)*Math.sin(s+y*o),h.y=t*Math.cos(s+y*o),h.z=t*Math.sin(i+A*r)*Math.sin(s+y*o),f.push(h.x,h.y,h.z),u.copy(h).normalize(),p.push(u.x,u.y,u.z),v.push(A+_,1-y),m.push(l++)}c.push(m)}for(let g=0;g<n;g++)for(let m=0;m<e;m++){let y=c[g][m+1],_=c[g][m],S=c[g+1][m],A=c[g+1][m+1];(g!==0||s>0)&&d.push(y,_,A),(g!==n-1||a<Math.PI)&&d.push(_,S,A)}this.setIndex(d),this.setAttribute("position",new ft(f,3)),this.setAttribute("normal",new ft(p,3)),this.setAttribute("uv",new ft(v,2))}static fromJSON(t){return new EO(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}},VQ=class extends Lt{constructor(t=1,e=.4,n=64,i=8,r=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:i,p:r,q:s},n=Math.floor(n),i=Math.floor(i);let o=[],a=[],l=[],c=[],h=new N,u=new N,d=new N,f=new N,p=new N,v=new N,g=new N;for(let y=0;y<=n;++y){let _=y/n*r*Math.PI*2;m(_,r,s,t,d),m(_+.01,r,s,t,f),v.subVectors(f,d),g.addVectors(f,d),p.crossVectors(v,g),g.crossVectors(p,v),p.normalize(),g.normalize();for(let S=0;S<=i;++S){let A=S/i*Math.PI*2,b=-e*Math.cos(A),T=e*Math.sin(A);h.x=d.x+(b*g.x+T*p.x),h.y=d.y+(b*g.y+T*p.y),h.z=d.z+(b*g.z+T*p.z),a.push(h.x,h.y,h.z),u.subVectors(h,d).normalize(),l.push(u.x,u.y,u.z),c.push(y/n),c.push(S/i)}}for(let y=1;y<=n;y++)for(let _=1;_<=i;_++){let S=(i+1)*(y-1)+(_-1),A=(i+1)*y+(_-1),b=(i+1)*y+_,T=(i+1)*(y-1)+_;o.push(S,A,T),o.push(A,b,T)}this.setIndex(o),this.setAttribute("position",new ft(a,3)),this.setAttribute("normal",new ft(l,3)),this.setAttribute("uv",new ft(c,2));function m(y,_,S,A,b){let T=Math.cos(y),M=Math.sin(y),E=S/_*y,P=Math.cos(E);b.x=A*(2+P)*.5*T,b.y=A*(2+P)*M*.5,b.z=A*Math.sin(E)*.5}}static fromJSON(t){return new VQ(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}},AV={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},jQ=class{constructor(t,e,n){let i=this,r=!1,s=0,o=0,a,l=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(c){o++,r===!1&&i.onStart!==void 0&&i.onStart(c,s,o),r=!0},this.itemEnd=function(c){s++,i.onProgress!==void 0&&i.onProgress(c,s,o),s===o&&(r=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(c){i.onError!==void 0&&i.onError(c)},this.resolveURL=function(c){return a?a(c):c},this.setURLModifier=function(c){return a=c,this},this.addHandler=function(c,h){return l.push(c,h),this},this.removeHandler=function(c){let h=l.indexOf(c);return h!==-1&&l.splice(h,2),this},this.getHandler=function(c){for(let h=0,u=l.length;h<u;h+=2){let d=l[h],f=l[h+1];if(d.global&&(d.lastIndex=0),d.test(c))return f}return null}}},Gbe=new jQ,CO=class{constructor(t){this.manager=t!==void 0?t:Gbe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,e){let n=this;return new Promise(function(i,r){n.load(t,i,e,r)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}},Ac={},Hbe=class extends Error{constructor(t,e){super(t),this.response=e}},IL=class extends CO{constructor(t){super(t)}load(t,e,n,i){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);let r=AV.get(t);if(r!==void 0)return this.manager.itemStart(t),setTimeout(()=>{e&&e(r),this.manager.itemEnd(t)},0),r;if(Ac[t]!==void 0){Ac[t].push({onLoad:e,onProgress:n,onError:i});return}Ac[t]=[],Ac[t].push({onLoad:e,onProgress:n,onError:i});let s=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,a=this.responseType;fetch(s).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let c=Ac[t],h=l.body.getReader(),u=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),d=u?parseInt(u):0,f=d!==0,p=0,v=new ReadableStream({start(g){m();function m(){h.read().then(({done:y,value:_})=>{if(y)g.close();else{p+=_.byteLength;let S=new ProgressEvent("progress",{lengthComputable:f,loaded:p,total:d});for(let A=0,b=c.length;A<b;A++){let T=c[A];T.onProgress&&T.onProgress(S)}g.enqueue(_),m()}})}}});return new Response(v)}else throw new Hbe(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(a){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(c=>new DOMParser().parseFromString(c,o));case"json":return l.json();default:if(o===void 0)return l.text();{let c=/charset="?([^;"\s]*)"?/i.exec(o),h=c&&c[1]?c[1].toLowerCase():void 0,u=new TextDecoder(h);return l.arrayBuffer().then(d=>u.decode(d))}}}).then(l=>{AV.add(t,l);let c=Ac[t];delete Ac[t];for(let h=0,u=c.length;h<u;h++){let d=c[h];d.onLoad&&d.onLoad(l)}}).catch(l=>{let c=Ac[t];if(c===void 0)throw this.manager.itemError(t),l;delete Ac[t];for(let h=0,u=c.length;h<u;h++){let d=c[h];d.onError&&d.onError(l)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}},T1=class extends Fn{constructor(t,e=1){super(),this.isLight=!0,this.type="Light",this.color=new Rt(t),this.intensity=e}dispose(){}copy(t,e){return super.copy(t,e),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){let e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,this.groundColor!==void 0&&(e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(e.object.distance=this.distance),this.angle!==void 0&&(e.object.angle=this.angle),this.decay!==void 0&&(e.object.decay=this.decay),this.penumbra!==void 0&&(e.object.penumbra=this.penumbra),this.shadow!==void 0&&(e.object.shadow=this.shadow.toJSON()),e}},Vbe=class extends T1{constructor(t,e,n){super(t,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Fn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Rt(e)}copy(t,e){return super.copy(t,e),this.groundColor.copy(t.groundColor),this}},r2=new nt,MV=new N,EV=new N,TO=class{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Se(512,512),this.map=null,this.mapPass=null,this.matrix=new nt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new xO,this._frameExtents=new Se(1,1),this._viewportCount=1,this._viewports=[new Zt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){let e=this.camera,n=this.matrix;MV.setFromMatrixPosition(t.matrixWorld),e.position.copy(MV),EV.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(EV),e.updateMatrixWorld(),r2.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r2),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(r2)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}},jbe=class extends TO{constructor(){super(new Yr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(t){let e=this.camera,n=Ax*2*t.angle*this.focus,i=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;(n!==e.fov||i!==e.aspect||r!==e.far)&&(e.fov=n,e.aspect=i,e.far=r,e.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}},Wbe=class extends T1{constructor(t,e,n=0,i=Math.PI/3,r=0,s=2){super(t,e),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Fn.DEFAULT_UP),this.updateMatrix(),this.target=new Fn,this.distance=n,this.angle=i,this.penumbra=r,this.decay=s,this.map=null,this.shadow=new jbe}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}},CV=new nt,_0=new N,s2=new N,Xbe=class extends TO{constructor(){super(new Yr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Se(4,2),this._viewportCount=6,this._viewports=[new Zt(2,1,1,1),new Zt(0,1,1,1),new Zt(3,1,1,1),new Zt(1,1,1,1),new Zt(3,0,1,1),new Zt(1,0,1,1)],this._cubeDirections=[new N(1,0,0),new N(-1,0,0),new N(0,0,1),new N(0,0,-1),new N(0,1,0),new N(0,-1,0)],this._cubeUps=[new N(0,1,0),new N(0,1,0),new N(0,1,0),new N(0,1,0),new N(0,0,1),new N(0,0,-1)]}updateMatrices(t,e=0){let n=this.camera,i=this.matrix,r=t.distance||n.far;r!==n.far&&(n.far=r,n.updateProjectionMatrix()),_0.setFromMatrixPosition(t.matrixWorld),n.position.copy(_0),s2.copy(n.position),s2.add(this._cubeDirections[e]),n.up.copy(this._cubeUps[e]),n.lookAt(s2),n.updateMatrixWorld(),i.makeTranslation(-_0.x,-_0.y,-_0.z),CV.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(CV)}},Ybe=class extends T1{constructor(t,e,n=0,i=2){super(t,e),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new Xbe}get power(){return this.intensity*4*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,e){return super.copy(t,e),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}},qbe=class extends TO{constructor(){super(new AA(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},Qbe=class extends T1{constructor(t,e){super(t,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Fn.DEFAULT_UP),this.updateMatrix(),this.target=new Fn,this.shadow=new qbe}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}},Kbe=class extends Lt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}toJSON(){let t=super.toJSON();return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}},WQ=class extends CO{constructor(t){super(t)}load(t,e,n,i){let r=this,s=new IL(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(t,function(o){try{e(r.parse(JSON.parse(o)))}catch(a){i?i(a):console.error(a),r.manager.itemError(t)}},n,i)}parse(t){let e={},n={};function i(u,d){if(e[d]!==void 0)return e[d];let f=u.interleavedBuffers[d],p=r(u,f.buffer),v=Vw(f.type,p),g=new ube(v,f.stride);return g.uuid=f.uuid,e[d]=g,g}function r(u,d){if(n[d]!==void 0)return n[d];let f=u.arrayBuffers[d],p=new Uint32Array(f).buffer;return n[d]=p,p}let s=t.isInstancedBufferGeometry?new Kbe:new Lt,o=t.data.index;if(o!==void 0){let u=Vw(o.type,o.array);s.setIndex(new Ut(u,1))}let a=t.data.attributes;for(let u in a){let d=a[u],f;if(d.isInterleavedBufferAttribute){let p=i(t.data,d.data);f=new DL(p,d.itemSize,d.offset,d.normalized)}else{let p=Vw(d.type,d.array),v=d.isInstancedBufferAttribute?hbe:Ut;f=new v(p,d.itemSize,d.normalized)}d.name!==void 0&&(f.name=d.name),d.usage!==void 0&&f.setUsage(d.usage),d.updateRange!==void 0&&(f.updateRange.offset=d.updateRange.offset,f.updateRange.count=d.updateRange.count),s.setAttribute(u,f)}let l=t.data.morphAttributes;if(l)for(let u in l){let d=l[u],f=[];for(let p=0,v=d.length;p<v;p++){let g=d[p],m;if(g.isInterleavedBufferAttribute){let y=i(t.data,g.data);m=new DL(y,g.itemSize,g.offset,g.normalized)}else{let y=Vw(g.type,g.array);m=new Ut(y,g.itemSize,g.normalized)}g.name!==void 0&&(m.name=g.name),f.push(m)}s.morphAttributes[u]=f}t.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);let c=t.data.groups||t.data.drawcalls||t.data.offsets;if(c!==void 0)for(let u=0,d=c.length;u!==d;++u){let f=c[u];s.addGroup(f.start,f.count,f.materialIndex)}let h=t.data.boundingSphere;if(h!==void 0){let u=new N;h.center!==void 0&&u.fromArray(h.center),s.boundingSphere=new la(u,h.radius)}return t.name&&(s.name=t.name),t.userData&&(s.userData=t.userData),s}},Jbe=class{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=TV(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let e=TV();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}};function TV(){return(typeof performance>"u"?Date:performance).now()}var XQ="\\[\\]\\.:\\/",PO="[^"+XQ+"]",Zbe="[^"+XQ.replace("\\.","")+"]";/((?:WC+[\/:])*)/.source.replace("WC",PO);/(WCOD+)?/.source.replace("WCOD",Zbe);/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",PO);/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",PO);var _t=class{constructor(e){this.value=e}clone(){return new _t(this.value.clone===void 0?this.value:this.value.clone())}},YQ=class{constructor(t,e,n=0,i=1/0){this.ray=new uv(t,e),this.near=n,this.far=i,this.camera=null,this.layers=new vO,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,e){this.ray.set(t,e)}setFromCamera(t,e){e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)}intersectObject(t,e=!0,n=[]){return BL(t,this,n,e),n.sort(PV),n}intersectObjects(t,e=!0,n=[]){for(let i=0,r=t.length;i<r;i++)BL(t[i],this,n,e);return n.sort(PV),n}};function PV(t,e){return t.distance-e.distance}function BL(t,e,n,i){if(t.layers.test(e.layers)&&t.raycast(e,n),i===!0){let r=t.children;for(let s=0,o=r.length;s<o;s++)BL(r[s],e,n,!0)}}var DV=class{constructor(t=1,e=0,n=0){return this.radius=t,this.phi=e,this.theta=n,this}set(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,n){return this.radius=Math.sqrt(t*t+e*e+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(Ki(e/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},RV=new Se,$be=class{constructor(t=new Se(1/0,1/0),e=new Se(-1/0,-1/0)){this.isBox2=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){let n=RV.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return RV.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}},LV=new N,dS=new N,ia=class{constructor(t=new N,e=new N){this.start=t,this.end=e}set(t,e){return this.start.copy(t),this.end.copy(e),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,e){return this.delta(e).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,e){LV.subVectors(t,this.start),dS.subVectors(this.end,this.start);let n=dS.dot(dS),i=dS.dot(LV)/n;return e&&(i=Ki(i,0,1)),i}closestPointToPoint(t,e,n){let i=this.closestPointToPointParameter(t,e);return this.delta(n).multiplyScalar(i).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},IV=new N,eAe=class extends Fn{constructor(t,e){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e,this.type="SpotLightHelper";let n=new Lt,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,o=1,a=32;s<a;s++,o++){let l=s/a*Math.PI*2,c=o/a*Math.PI*2;i.push(Math.cos(l),Math.sin(l),1,Math.cos(c),Math.sin(c),1)}n.setAttribute("position",new ft(i,3));let r=new $h({fog:!1,toneMapped:!1});this.cone=new C1(n,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let t=this.light.distance?this.light.distance:1e3,e=t*Math.tan(this.light.angle);this.cone.scale.set(e,e,t),IV.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(IV),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},tAe=class extends ao{constructor(t,e,n){let i=new EO(e,4,2),r=new E1({wireframe:!0,fog:!1,toneMapped:!1});super(i,r),this.light=t,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},BV=new N,fS=new N,OV=new N,nAe=class extends Fn{constructor(t,e,n){super(),this.light=t,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",e===void 0&&(e=1);let i=new Lt;i.setAttribute("position",new ft([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));let r=new $h({fog:!1,toneMapped:!1});this.lightPlane=new MA(i,r),this.add(this.lightPlane),i=new Lt,i.setAttribute("position",new ft([0,0,0,0,0,1],3)),this.targetLine=new MA(i,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),BV.setFromMatrixPosition(this.light.matrixWorld),fS.setFromMatrixPosition(this.light.target.matrixWorld),OV.subVectors(fS,BV),this.lightPlane.lookAt(fS),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(fS),this.targetLine.scale.z=OV.length()}},pS=new N,mi=new dv,TA=class extends C1{constructor(t){let e=new Lt,n=new $h({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],s={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(f,p){a(f),a(p)}function a(f){i.push(0,0,0),r.push(0,0,0),s[f]===void 0&&(s[f]=[]),s[f].push(i.length/3-1)}e.setAttribute("position",new ft(i,3)),e.setAttribute("color",new ft(r,3)),super(e,n),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();let l=new Rt(16755200),c=new Rt(16711680),h=new Rt(43775),u=new Rt(16777215),d=new Rt(3355443);this.setColors(l,c,h,u,d)}setColors(t,e,n,i,r){let s=this.geometry.getAttribute("color");s.setXYZ(0,t.r,t.g,t.b),s.setXYZ(1,t.r,t.g,t.b),s.setXYZ(2,t.r,t.g,t.b),s.setXYZ(3,t.r,t.g,t.b),s.setXYZ(4,t.r,t.g,t.b),s.setXYZ(5,t.r,t.g,t.b),s.setXYZ(6,t.r,t.g,t.b),s.setXYZ(7,t.r,t.g,t.b),s.setXYZ(8,t.r,t.g,t.b),s.setXYZ(9,t.r,t.g,t.b),s.setXYZ(10,t.r,t.g,t.b),s.setXYZ(11,t.r,t.g,t.b),s.setXYZ(12,t.r,t.g,t.b),s.setXYZ(13,t.r,t.g,t.b),s.setXYZ(14,t.r,t.g,t.b),s.setXYZ(15,t.r,t.g,t.b),s.setXYZ(16,t.r,t.g,t.b),s.setXYZ(17,t.r,t.g,t.b),s.setXYZ(18,t.r,t.g,t.b),s.setXYZ(19,t.r,t.g,t.b),s.setXYZ(20,t.r,t.g,t.b),s.setXYZ(21,t.r,t.g,t.b),s.setXYZ(22,t.r,t.g,t.b),s.setXYZ(23,t.r,t.g,t.b),s.setXYZ(24,e.r,e.g,e.b),s.setXYZ(25,e.r,e.g,e.b),s.setXYZ(26,e.r,e.g,e.b),s.setXYZ(27,e.r,e.g,e.b),s.setXYZ(28,e.r,e.g,e.b),s.setXYZ(29,e.r,e.g,e.b),s.setXYZ(30,e.r,e.g,e.b),s.setXYZ(31,e.r,e.g,e.b),s.setXYZ(32,n.r,n.g,n.b),s.setXYZ(33,n.r,n.g,n.b),s.setXYZ(34,n.r,n.g,n.b),s.setXYZ(35,n.r,n.g,n.b),s.setXYZ(36,n.r,n.g,n.b),s.setXYZ(37,n.r,n.g,n.b),s.setXYZ(38,i.r,i.g,i.b),s.setXYZ(39,i.r,i.g,i.b),s.setXYZ(40,r.r,r.g,r.b),s.setXYZ(41,r.r,r.g,r.b),s.setXYZ(42,r.r,r.g,r.b),s.setXYZ(43,r.r,r.g,r.b),s.setXYZ(44,r.r,r.g,r.b),s.setXYZ(45,r.r,r.g,r.b),s.setXYZ(46,r.r,r.g,r.b),s.setXYZ(47,r.r,r.g,r.b),s.setXYZ(48,r.r,r.g,r.b),s.setXYZ(49,r.r,r.g,r.b),s.needsUpdate=!0}update(){let t=this.geometry,e=this.pointMap,n=1,i=1;mi.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Mi("c",e,t,mi,0,0,-1),Mi("t",e,t,mi,0,0,1),Mi("n1",e,t,mi,-n,-i,-1),Mi("n2",e,t,mi,n,-i,-1),Mi("n3",e,t,mi,-n,i,-1),Mi("n4",e,t,mi,n,i,-1),Mi("f1",e,t,mi,-n,-i,1),Mi("f2",e,t,mi,n,-i,1),Mi("f3",e,t,mi,-n,i,1),Mi("f4",e,t,mi,n,i,1),Mi("u1",e,t,mi,n*.7,i*1.1,-1),Mi("u2",e,t,mi,-n*.7,i*1.1,-1),Mi("u3",e,t,mi,0,i*2,-1),Mi("cf1",e,t,mi,-n,0,1),Mi("cf2",e,t,mi,n,0,1),Mi("cf3",e,t,mi,0,-i,1),Mi("cf4",e,t,mi,0,i,1),Mi("cn1",e,t,mi,-n,0,-1),Mi("cn2",e,t,mi,n,0,-1),Mi("cn3",e,t,mi,0,-i,-1),Mi("cn4",e,t,mi,0,i,-1),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function Mi(t,e,n,i,r,s,o){pS.set(r,s,o).unproject(i);let a=e[t];if(a!==void 0){let l=n.getAttribute("position");for(let c=0,h=a.length;c<h;c++)l.setXYZ(a[c],pS.x,pS.y,pS.z)}}var PA=class extends C1{constructor(t,e=16776960){let n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],r=new Lt;r.setIndex(new Ut(n,1)),r.setAttribute("position",new ft(i,3)),super(r,new $h({color:e,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){let e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}dispose(){this.geometry.dispose(),this.material.dispose()}},iAe=class extends C1{constructor(t=1){let e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new Lt;i.setAttribute("position",new ft(e,3)),i.setAttribute("color",new ft(n,3));let r=new $h({vertexColors:!0,toneMapped:!1});super(i,r),this.type="AxesHelper"}setColors(t,e,n){let i=new Rt,r=this.geometry.attributes.color.array;return i.set(t),i.toArray(r,0),i.toArray(r,3),i.set(e),i.toArray(r,6),i.toArray(r,9),i.set(n),i.toArray(r,12),i.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:cv}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=cv);var w0=".",DO=Symbol("target"),qQ=Symbol("unsubscribe");function OL(t){return t instanceof Date||t instanceof Set||t instanceof Map||t instanceof WeakSet||t instanceof WeakMap||ArrayBuffer.isView(t)}function rAe(t){return(typeof t=="object"?t===null:typeof t!="function")||t instanceof RegExp}var Ll=Array.isArray;function RO(t){return typeof t=="symbol"}var sAe={after:(t,e)=>Ll(t)?t.slice(e.length):e===""?t:t.slice(e.length+1),concat:(t,e)=>Ll(t)?(t=[...t],e&&t.push(e),t):e&&e.toString!==void 0?(t!==""&&(t+=w0),RO(e)?t+e.toString():t+e):t,initial:t=>{if(Ll(t))return t.slice(0,-1);if(t==="")return t;let e=t.lastIndexOf(w0);return e===-1?"":t.slice(0,e)},last:t=>{if(Ll(t))return t[t.length-1]||"";if(t==="")return t;let e=t.lastIndexOf(w0);return e===-1?t:t.slice(e+1)},walk:(t,e)=>{if(Ll(t))for(let n of t)e(n);else if(t!==""){let n=0,i=t.indexOf(w0);if(i===-1)e(t);else for(;n<t.length;)i===-1&&(i=t.length),e(t.slice(n,i)),n=i+1,i=t.indexOf(w0,n)}},get(t,e){return this.walk(e,n=>{t&&(t=t[n])}),t}},Xo=sAe;function oAe(t){return typeof t=="object"&&typeof t.next=="function"}function aAe(t,e,n,i,r){let s=t.next;if(e.name==="entries")t.next=function(){let o=s.call(this);return o.done===!1&&(o.value[0]=r(o.value[0],e,o.value[0],i),o.value[1]=r(o.value[1],e,o.value[0],i)),o};else if(e.name==="values"){let o=n[DO].keys();t.next=function(){let a=s.call(this);return a.done===!1&&(a.value=r(a.value,e,o.next().value,i)),a}}else t.next=function(){let o=s.call(this);return o.done===!1&&(o.value=r(o.value,e,o.value,i)),o};return t}function FV(t,e,n){return t.isUnsubscribed||e.ignoreSymbols&&RO(n)||e.ignoreUnderscores&&n.charAt(0)==="_"||"ignoreKeys"in e&&e.ignoreKeys.includes(n)}var lAe=class{constructor(t){this._equals=t,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return this._descriptorCache===void 0&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(t){let e=this._getDescriptorCache(),n=e.get(t);return n===void 0&&(n={},e.set(t,n)),n}_getOwnPropertyDescriptor(t,e){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(t,e);let n=this._getProperties(t),i=n[e];return i===void 0&&(i=Reflect.getOwnPropertyDescriptor(t,e),n[e]=i),i}getProxy(t,e,n,i){if(this.isUnsubscribed)return t;let r=t[i],s=r||t;this._pathCache.set(s,e);let o=this._proxyCache.get(s);return o===void 0&&(o=r===void 0?new Proxy(t,n):t,this._proxyCache.set(s,o)),o}getPath(t){return this.isUnsubscribed?void 0:this._pathCache.get(t)}isDetached(t,e){return!Object.is(t,Xo.get(e,this.getPath(t)))}defineProperty(t,e,n){return Reflect.defineProperty(t,e,n)?(this.isUnsubscribed||(this._getProperties(t)[e]=n),!0):!1}setProperty(t,e,n,i,r){if(!this._equals(r,n)||!(e in t)){let s=this._getOwnPropertyDescriptor(t,e);return s!==void 0&&"set"in s?Reflect.set(t,e,n,i):Reflect.set(t,e,n)}return!0}deleteProperty(t,e,n){if(Reflect.deleteProperty(t,e)){if(!this.isUnsubscribed){let i=this._getDescriptorCache().get(t);i&&(delete i[e],this._pathCache.delete(n))}return!0}return!1}isSameDescriptor(t,e,n){let i=this._getOwnPropertyDescriptor(e,n);return t!==void 0&&i!==void 0&&Object.is(t.value,i.value)&&(t.writable||!1)===(i.writable||!1)&&(t.enumerable||!1)===(i.enumerable||!1)&&(t.configurable||!1)===(i.configurable||!1)&&t.get===i.get&&t.set===i.set}isGetInvariant(t,e){let n=this._getOwnPropertyDescriptor(t,e);return n!==void 0&&n.configurable!==!0&&n.writable!==!0}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function FL(t){return toString.call(t)==="[object Object]"}function mS(){return!0}function Kp(t,e){return t.length!==e.length||t.some((n,i)=>e[i]!==n)}var QQ=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),cAe=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),KQ={push:mS,pop:mS,shift:mS,unshift:mS,copyWithin:Kp,reverse:Kp,sort:Kp,splice:Kp,flat:Kp,fill:Kp},uAe=new Set([...QQ,...cAe,...Object.keys(KQ)]);function gS(t,e){if(t.size!==e.size)return!0;for(let n of t)if(!e.has(n))return!0;return!1}var JQ=["keys","values","entries"],ZQ=new Set(["has","toString"]),$Q={add:gS,clear:gS,delete:gS,forEach:gS},hAe=new Set([...ZQ,...Object.keys($Q),...JQ]);function vS(t,e){if(t.size!==e.size)return!0;let n;for(let[i,r]of t)if(n=e.get(i),n!==r||n===void 0&&!e.has(i))return!0;return!1}var dAe=new Set([...ZQ,"get"]),eK={set:vS,clear:vS,delete:vS,forEach:vS},fAe=new Set([...dAe,...Object.keys(eK),...JQ]),Vh=class{constructor(t,e,n,i){this._path=e,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=i,this._changes=i?[]:null,this.clone=e===void 0?t:this._shallowClone(t)}static isHandledMethod(t){return QQ.has(t)}_shallowClone(t){let e=t;if(FL(t))e={...t};else if(Ll(t))e=[...t];else if(t instanceof Date)e=new Date(t);else if(t instanceof Set)e=new Set([...t].map(n=>this._shallowClone(n)));else if(t instanceof Map){e=new Map;for(let[n,i]of t.entries())e.set(n,this._shallowClone(i))}return this._clonedCache.add(e),e}preferredThisArg(t,e,n,i){return t?(Ll(i)?this._onIsChanged=KQ[e]:i instanceof Set?this._onIsChanged=$Q[e]:i instanceof Map&&(this._onIsChanged=eK[e]),i):n}update(t,e,n){let i=Xo.after(t,this._path);if(e!=="length"){let r=this.clone;Xo.walk(i,s=>{r&&r[s]&&(this._clonedCache.has(r[s])||(r[s]=this._shallowClone(r[s])),r=r[s])}),this._hasOnValidate&&this._changes.push({path:i,property:e,previous:n}),r&&r[e]&&(r[e]=n)}this._isChanged=!0}undo(t){let e;for(let n=this._changes.length-1;n!==-1;n--)e=this._changes[n],Xo.get(t,e.path)[e.property]=e.previous}isChanged(t){return this._onIsChanged===void 0?this._isChanged:this._onIsChanged(this.clone,t)}},NV=class extends Vh{static isHandledMethod(t){return uAe.has(t)}},pAe=class extends Vh{undo(t){t.setTime(this.clone.getTime())}isChanged(t,e){return!e(this.clone.valueOf(),t.valueOf())}},UV=class extends Vh{static isHandledMethod(t){return hAe.has(t)}undo(t){for(let e of this.clone)t.add(e);for(let e of t)this.clone.has(e)||t.delete(e)}},kV=class extends Vh{static isHandledMethod(t){return fAe.has(t)}undo(t){for(let[e,n]of this.clone.entries())t.set(e,n);for(let e of t.keys())this.clone.has(e)||t.delete(e)}},mAe=class extends Vh{constructor(t,e,n,i){super(void 0,e,n,i),this._arg1=n[0],this._weakValue=t.has(this._arg1)}isChanged(t){return this._weakValue!==t.has(this._arg1)}undo(t){this._weakValue&&!t.has(this._arg1)?t.add(this._arg1):t.delete(this._arg1)}},gAe=class extends Vh{constructor(t,e,n,i){super(void 0,e,n,i),this._weakKey=n[0],this._weakHas=t.has(this._weakKey),this._weakValue=t.get(this._weakKey)}isChanged(t){return this._weakValue!==t.get(this._weakKey)}undo(t){let e=t.has(this._weakKey);this._weakHas&&!e?t.set(this._weakKey,this._weakValue):!this._weakHas&&e?t.delete(this._weakKey):this._weakValue!==t.get(this._weakKey)&&t.set(this._weakKey,this._weakValue)}},fm=class{constructor(t){this._stack=[],this._hasOnValidate=t}static isHandledType(t){return FL(t)||Ll(t)||OL(t)}static isHandledMethod(t,e){return FL(t)?Vh.isHandledMethod(e):Ll(t)?NV.isHandledMethod(e):t instanceof Set?UV.isHandledMethod(e):t instanceof Map?kV.isHandledMethod(e):OL(t)}get isCloning(){return this._stack.length>0}start(t,e,n){let i=Vh;Ll(t)?i=NV:t instanceof Date?i=pAe:t instanceof Set?i=UV:t instanceof Map?i=kV:t instanceof WeakSet?i=mAe:t instanceof WeakMap&&(i=gAe),this._stack.push(new i(t,e,n,this._hasOnValidate))}update(t,e,n){this._stack[this._stack.length-1].update(t,e,n)}preferredThisArg(t,e,n){let{name:i}=t,r=fm.isHandledMethod(n,i);return this._stack[this._stack.length-1].preferredThisArg(r,i,e,n)}isChanged(t,e,n){return this._stack[this._stack.length-1].isChanged(t,e,n)}undo(t){this._previousClone!==void 0&&this._previousClone.undo(t)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},vAe={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},LO=(t,e,n={})=>{n={...vAe,...n};let i=Symbol("ProxyTarget"),{equals:r,isShallow:s,ignoreDetached:o,details:a}=n,l=new lAe(r),c=typeof n.onValidate=="function",h=new fm(c),u=(y,_,S,A,b)=>!c||h.isCloning||n.onValidate(Xo.concat(l.getPath(y),_),S,A,b)===!0,d=(y,_,S,A)=>{!FV(l,n,_)&&!(o&&l.isDetached(y,t))&&f(l.getPath(y),_,S,A)},f=(y,_,S,A,b)=>{h.isCloning?h.update(y,_,A):e(Xo.concat(y,_),S,A,b)},p=y=>y&&(y[i]||y),v=(y,_,S,A)=>rAe(y)||S==="constructor"||s&&!fm.isHandledMethod(_,S)||FV(l,n,S)||l.isGetInvariant(_,S)||o&&l.isDetached(_,t)?y:(A===void 0&&(A=l.getPath(_)),l.getProxy(y,Xo.concat(A,S),g,i)),g={get(y,_,S){if(RO(_)){if(_===i||_===DO)return y;if(_===qQ&&!l.isUnsubscribed&&l.getPath(y).length===0)return l.unsubscribe(),y}let A=OL(y)?Reflect.get(y,_):Reflect.get(y,_,S);return v(A,y,_)},set(y,_,S,A){S=p(S);let b=y[i]||y,T=b[_];if(r(T,S)&&_ in y)return!0;let M=u(y,_,S,T);return M&&l.setProperty(b,_,S,A,T)?(d(y,_,y[_],T),!0):!M},defineProperty(y,_,S){if(!l.isSameDescriptor(S,y,_)){let A=y[_];u(y,_,S.value,A)&&l.defineProperty(y,_,S,A)&&d(y,_,S.value,A)}return!0},deleteProperty(y,_){if(!Reflect.has(y,_))return!0;let S=Reflect.get(y,_),A=u(y,_,void 0,S);return A&&l.deleteProperty(y,_,S)?(d(y,_,void 0,S),!0):!A},apply(y,_,S){let A=_[i]||_;if(l.isUnsubscribed)return Reflect.apply(y,A,S);if((a===!1||a!==!0&&!a.includes(y.name))&&fm.isHandledType(A)){let b=Xo.initial(l.getPath(y)),T=fm.isHandledMethod(A,y.name);h.start(A,b,S);let M=Reflect.apply(y,h.preferredThisArg(y,_,A),T?S.map(R=>p(R)):S),E=h.isChanged(A,r),P=h.stop();if(fm.isHandledType(M)&&T&&(_ instanceof Map&&y.name==="get"&&(b=Xo.concat(b,S[0])),M=l.getProxy(M,b,g)),E){let R={name:y.name,args:S,result:M},F=h.isCloning?Xo.initial(b):b,B=h.isCloning?Xo.last(b):"";u(Xo.get(t,F),B,A,P,R)?f(F,B,A,P,R):h.undo(A)}return(_ instanceof Map||_ instanceof Set)&&oAe(M)?aAe(M,y,_,b,v):M}return Reflect.apply(y,_,S)}},m=l.getProxy(t,n.pathAsArray?[]:"",g);return e=e.bind(m),c&&(n.onValidate=n.onValidate.bind(m)),m};LO.target=t=>t&&t[DO]||t;LO.unsubscribe=t=>t[qQ]||t;var zV=LO,yAe=typeof global=="object"&&global&&global.Object===Object&&global,tK=yAe,xAe=typeof self=="object"&&self&&self.Object===Object&&self,_Ae=tK||xAe||Function("return this")(),rl=_Ae,wAe=rl.Symbol,ca=wAe,nK=Object.prototype,SAe=nK.hasOwnProperty,bAe=nK.toString,S0=ca?ca.toStringTag:void 0;function AAe(t){var e=SAe.call(t,S0),n=t[S0];try{t[S0]=void 0;var i=!0}catch{}var r=bAe.call(t);return i&&(e?t[S0]=n:delete t[S0]),r}var MAe=AAe,EAe=Object.prototype,CAe=EAe.toString;function TAe(t){return CAe.call(t)}var PAe=TAe,DAe="[object Null]",RAe="[object Undefined]",GV=ca?ca.toStringTag:void 0;function LAe(t){return t==null?t===void 0?RAe:DAe:GV&&GV in Object(t)?MAe(t):PAe(t)}var Xf=LAe;function IAe(t){return t!=null&&typeof t=="object"}var su=IAe,BAe="[object Symbol]";function OAe(t){return typeof t=="symbol"||su(t)&&Xf(t)==BAe}var dE=OAe;function FAe(t,e){for(var n=-1,i=t==null?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}var iK=FAe,NAe=Array.isArray,$l=NAe,UAe=1/0,HV=ca?ca.prototype:void 0,VV=HV?HV.toString:void 0;function rK(t){if(typeof t=="string")return t;if($l(t))return iK(t,rK)+"";if(dE(t))return VV?VV.call(t):"";var e=t+"";return e=="0"&&1/t==-UAe?"-0":e}var kAe=rK,zAe=/\s/;function GAe(t){for(var e=t.length;e--&&zAe.test(t.charAt(e)););return e}var HAe=GAe,VAe=/^\s+/;function jAe(t){return t&&t.slice(0,HAe(t)+1).replace(VAe,"")}var WAe=jAe;function XAe(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Ja=XAe,jV=0/0,YAe=/^[-+]0x[0-9a-f]+$/i,qAe=/^0b[01]+$/i,QAe=/^0o[0-7]+$/i,KAe=parseInt;function JAe(t){if(typeof t=="number")return t;if(dE(t))return jV;if(Ja(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Ja(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=WAe(t);var n=qAe.test(t);return n||QAe.test(t)?KAe(t.slice(2),n?2:8):YAe.test(t)?jV:+t}var WV=JAe;function ZAe(t){return t}var $Ae=ZAe,eMe="[object AsyncFunction]",tMe="[object Function]",nMe="[object GeneratorFunction]",iMe="[object Proxy]";function rMe(t){if(!Ja(t))return!1;var e=Xf(t);return e==tMe||e==nMe||e==eMe||e==iMe}var sK=rMe,sMe=rl["__core-js_shared__"],o2=sMe,XV=function(){var t=/[^.]+$/.exec(o2&&o2.keys&&o2.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function oMe(t){return!!XV&&XV in t}var aMe=oMe,lMe=Function.prototype,cMe=lMe.toString;function uMe(t){if(t!=null){try{return cMe.call(t)}catch{}try{return t+""}catch{}}return""}var Yf=uMe,hMe=/[\\^$.*+?()[\]{}|]/g,dMe=/^\[object .+?Constructor\]$/,fMe=Function.prototype,pMe=Object.prototype,mMe=fMe.toString,gMe=pMe.hasOwnProperty,vMe=RegExp("^"+mMe.call(gMe).replace(hMe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function yMe(t){if(!Ja(t)||aMe(t))return!1;var e=sK(t)?vMe:dMe;return e.test(Yf(t))}var xMe=yMe;function _Me(t,e){return t==null?void 0:t[e]}var wMe=_Me;function SMe(t,e){var n=wMe(t,e);return xMe(n)?n:void 0}var qf=SMe,bMe=qf(rl,"WeakMap"),NL=bMe,YV=Object.create,AMe=function(){function t(){}return function(e){if(!Ja(e))return{};if(YV)return YV(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),MMe=AMe;function EMe(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var CMe=EMe;function TMe(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}var PMe=TMe,DMe=800,RMe=16,LMe=Date.now;function IMe(t){var e=0,n=0;return function(){var i=LMe(),r=RMe-(i-n);if(n=i,r>0){if(++e>=DMe)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var BMe=IMe;function OMe(t){return function(){return t}}var FMe=OMe,NMe=function(){try{var t=qf(Object,"defineProperty");return t({},"",{}),t}catch{}}(),DA=NMe,UMe=DA?function(t,e){return DA(t,"toString",{configurable:!0,enumerable:!1,value:FMe(e),writable:!0})}:$Ae,kMe=UMe,zMe=BMe(kMe),GMe=zMe;function HMe(t,e){for(var n=-1,i=t==null?0:t.length;++n<i&&e(t[n],n,t)!==!1;);return t}var VMe=HMe,jMe=9007199254740991,WMe=/^(?:0|[1-9]\d*)$/;function XMe(t,e){var n=typeof t;return e=e??jMe,!!e&&(n=="number"||n!="symbol"&&WMe.test(t))&&t>-1&&t%1==0&&t<e}var IO=XMe;function YMe(t,e,n){e=="__proto__"&&DA?DA(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var oK=YMe;function qMe(t,e){return t===e||t!==t&&e!==e}var BO=qMe,QMe=Object.prototype,KMe=QMe.hasOwnProperty;function JMe(t,e,n){var i=t[e];(!(KMe.call(t,e)&&BO(i,n))||n===void 0&&!(e in t))&&oK(t,e,n)}var OO=JMe;function ZMe(t,e,n,i){var r=!n;n||(n={});for(var s=-1,o=e.length;++s<o;){var a=e[s],l=i?i(n[a],t[a],a,n,t):void 0;l===void 0&&(l=t[a]),r?oK(n,a,l):OO(n,a,l)}return n}var P1=ZMe,qV=Math.max;function $Me(t,e,n){return e=qV(e===void 0?t.length-1:e,0),function(){for(var i=arguments,r=-1,s=qV(i.length-e,0),o=Array(s);++r<s;)o[r]=i[e+r];r=-1;for(var a=Array(e+1);++r<e;)a[r]=i[r];return a[e]=n(o),CMe(t,this,a)}}var eEe=$Me,tEe=9007199254740991;function nEe(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=tEe}var FO=nEe;function iEe(t){return t!=null&&FO(t.length)&&!sK(t)}var aK=iEe,rEe=Object.prototype;function sEe(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||rEe;return t===n}var NO=sEe;function oEe(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}var aEe=oEe,lEe="[object Arguments]";function cEe(t){return su(t)&&Xf(t)==lEe}var QV=cEe,lK=Object.prototype,uEe=lK.hasOwnProperty,hEe=lK.propertyIsEnumerable,dEe=QV(function(){return arguments}())?QV:function(t){return su(t)&&uEe.call(t,"callee")&&!hEe.call(t,"callee")},UO=dEe;function fEe(){return!1}var pEe=fEe,cK=typeof ho=="object"&&ho&&!ho.nodeType&&ho,KV=cK&&typeof fo=="object"&&fo&&!fo.nodeType&&fo,mEe=KV&&KV.exports===cK,JV=mEe?rl.Buffer:void 0,gEe=JV?JV.isBuffer:void 0,vEe=gEe||pEe,RA=vEe,yEe="[object Arguments]",xEe="[object Array]",_Ee="[object Boolean]",wEe="[object Date]",SEe="[object Error]",bEe="[object Function]",AEe="[object Map]",MEe="[object Number]",EEe="[object Object]",CEe="[object RegExp]",TEe="[object Set]",PEe="[object String]",DEe="[object WeakMap]",REe="[object ArrayBuffer]",LEe="[object DataView]",IEe="[object Float32Array]",BEe="[object Float64Array]",OEe="[object Int8Array]",FEe="[object Int16Array]",NEe="[object Int32Array]",UEe="[object Uint8Array]",kEe="[object Uint8ClampedArray]",zEe="[object Uint16Array]",GEe="[object Uint32Array]",Yn={};Yn[IEe]=Yn[BEe]=Yn[OEe]=Yn[FEe]=Yn[NEe]=Yn[UEe]=Yn[kEe]=Yn[zEe]=Yn[GEe]=!0;Yn[yEe]=Yn[xEe]=Yn[REe]=Yn[_Ee]=Yn[LEe]=Yn[wEe]=Yn[SEe]=Yn[bEe]=Yn[AEe]=Yn[MEe]=Yn[EEe]=Yn[CEe]=Yn[TEe]=Yn[PEe]=Yn[DEe]=!1;function HEe(t){return su(t)&&FO(t.length)&&!!Yn[Xf(t)]}var VEe=HEe;function jEe(t){return function(e){return t(e)}}var kO=jEe,uK=typeof ho=="object"&&ho&&!ho.nodeType&&ho,Py=uK&&typeof fo=="object"&&fo&&!fo.nodeType&&fo,WEe=Py&&Py.exports===uK,a2=WEe&&tK.process,XEe=function(){try{var t=Py&&Py.require&&Py.require("util").types;return t||a2&&a2.binding&&a2.binding("util")}catch{}}(),zg=XEe,ZV=zg&&zg.isTypedArray,YEe=ZV?kO(ZV):VEe,hK=YEe,qEe=Object.prototype,QEe=qEe.hasOwnProperty;function KEe(t,e){var n=$l(t),i=!n&&UO(t),r=!n&&!i&&RA(t),s=!n&&!i&&!r&&hK(t),o=n||i||r||s,a=o?aEe(t.length,String):[],l=a.length;for(var c in t)(e||QEe.call(t,c))&&!(o&&(c=="length"||r&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||IO(c,l)))&&a.push(c);return a}var dK=KEe;function JEe(t,e){return function(n){return t(e(n))}}var fK=JEe,ZEe=fK(Object.keys,Object),$Ee=ZEe,eCe=Object.prototype,tCe=eCe.hasOwnProperty;function nCe(t){if(!NO(t))return $Ee(t);var e=[];for(var n in Object(t))tCe.call(t,n)&&n!="constructor"&&e.push(n);return e}var iCe=nCe;function rCe(t){return aK(t)?dK(t):iCe(t)}var zO=rCe;function sCe(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var oCe=sCe,aCe=Object.prototype,lCe=aCe.hasOwnProperty;function cCe(t){if(!Ja(t))return oCe(t);var e=NO(t),n=[];for(var i in t)i=="constructor"&&(e||!lCe.call(t,i))||n.push(i);return n}var uCe=cCe;function hCe(t){return aK(t)?dK(t,!0):uCe(t)}var GO=hCe,dCe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,fCe=/^\w*$/;function pCe(t,e){if($l(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||dE(t)?!0:fCe.test(t)||!dCe.test(t)||e!=null&&t in Object(e)}var mCe=pCe,gCe=qf(Object,"create"),Tx=gCe;function vCe(){this.__data__=Tx?Tx(null):{},this.size=0}var yCe=vCe;function xCe(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var _Ce=xCe,wCe="__lodash_hash_undefined__",SCe=Object.prototype,bCe=SCe.hasOwnProperty;function ACe(t){var e=this.__data__;if(Tx){var n=e[t];return n===wCe?void 0:n}return bCe.call(e,t)?e[t]:void 0}var MCe=ACe,ECe=Object.prototype,CCe=ECe.hasOwnProperty;function TCe(t){var e=this.__data__;return Tx?e[t]!==void 0:CCe.call(e,t)}var PCe=TCe,DCe="__lodash_hash_undefined__";function RCe(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Tx&&e===void 0?DCe:e,this}var LCe=RCe;function pv(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}pv.prototype.clear=yCe;pv.prototype.delete=_Ce;pv.prototype.get=MCe;pv.prototype.has=PCe;pv.prototype.set=LCe;var $V=pv;function ICe(){this.__data__=[],this.size=0}var BCe=ICe;function OCe(t,e){for(var n=t.length;n--;)if(BO(t[n][0],e))return n;return-1}var fE=OCe,FCe=Array.prototype,NCe=FCe.splice;function UCe(t){var e=this.__data__,n=fE(e,t);if(n<0)return!1;var i=e.length-1;return n==i?e.pop():NCe.call(e,n,1),--this.size,!0}var kCe=UCe;function zCe(t){var e=this.__data__,n=fE(e,t);return n<0?void 0:e[n][1]}var GCe=zCe;function HCe(t){return fE(this.__data__,t)>-1}var VCe=HCe;function jCe(t,e){var n=this.__data__,i=fE(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}var WCe=jCe;function mv(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}mv.prototype.clear=BCe;mv.prototype.delete=kCe;mv.prototype.get=GCe;mv.prototype.has=VCe;mv.prototype.set=WCe;var pE=mv,XCe=qf(rl,"Map"),Px=XCe;function YCe(){this.size=0,this.__data__={hash:new $V,map:new(Px||pE),string:new $V}}var qCe=YCe;function QCe(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var KCe=QCe;function JCe(t,e){var n=t.__data__;return KCe(e)?n[typeof e=="string"?"string":"hash"]:n.map}var mE=JCe;function ZCe(t){var e=mE(this,t).delete(t);return this.size-=e?1:0,e}var $Ce=ZCe;function eTe(t){return mE(this,t).get(t)}var tTe=eTe;function nTe(t){return mE(this,t).has(t)}var iTe=nTe;function rTe(t,e){var n=mE(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}var sTe=rTe;function gv(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}gv.prototype.clear=qCe;gv.prototype.delete=$Ce;gv.prototype.get=tTe;gv.prototype.has=iTe;gv.prototype.set=sTe;var gE=gv,oTe="Expected a function";function HO(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(oTe);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],s=n.cache;if(s.has(r))return s.get(r);var o=t.apply(this,i);return n.cache=s.set(r,o)||s,o};return n.cache=new(HO.Cache||gE),n}HO.Cache=gE;var aTe=HO,lTe=500;function cTe(t){var e=aTe(t,function(i){return n.size===lTe&&n.clear(),i}),n=e.cache;return e}var uTe=cTe,hTe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dTe=/\\(\\)?/g,fTe=uTe(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(hTe,function(n,i,r,s){e.push(r?s.replace(dTe,"$1"):i||n)}),e}),pTe=fTe;function mTe(t){return t==null?"":kAe(t)}var gTe=mTe;function vTe(t,e){return $l(t)?t:mCe(t,e)?[t]:pTe(gTe(t))}var vv=vTe,yTe=1/0;function xTe(t){if(typeof t=="string"||dE(t))return t;var e=t+"";return e=="0"&&1/t==-yTe?"-0":e}var vE=xTe;function _Te(t,e){e=vv(e,t);for(var n=0,i=e.length;t!=null&&n<i;)t=t[vE(e[n++])];return n&&n==i?t:void 0}var pK=_Te;function wTe(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}var VO=wTe,e5=ca?ca.isConcatSpreadable:void 0;function STe(t){return $l(t)||UO(t)||!!(e5&&t&&t[e5])}var bTe=STe;function mK(t,e,n,i,r){var s=-1,o=t.length;for(n||(n=bTe),r||(r=[]);++s<o;){var a=t[s];e>0&&n(a)?e>1?mK(a,e-1,n,i,r):VO(r,a):i||(r[r.length]=a)}return r}var ATe=mK;function MTe(t){var e=t==null?0:t.length;return e?ATe(t,1):[]}var ETe=MTe;function CTe(t){return GMe(eEe(t,void 0,ETe),t+"")}var gK=CTe,TTe=fK(Object.getPrototypeOf,Object),jO=TTe,PTe="[object Object]",DTe=Function.prototype,RTe=Object.prototype,vK=DTe.toString,LTe=RTe.hasOwnProperty,ITe=vK.call(Object);function BTe(t){if(!su(t)||Xf(t)!=PTe)return!1;var e=jO(t);if(e===null)return!0;var n=LTe.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&vK.call(n)==ITe}var OTe=BTe;function FTe(t,e,n){var i=-1,r=t.length;e<0&&(e=-e>r?0:r+e),n=n>r?r:n,n<0&&(n+=r),r=e>n?0:n-e>>>0,e>>>=0;for(var s=Array(r);++i<r;)s[i]=t[i+e];return s}var NTe=FTe;function UTe(){this.__data__=new pE,this.size=0}var kTe=UTe;function zTe(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var GTe=zTe;function HTe(t){return this.__data__.get(t)}var VTe=HTe;function jTe(t){return this.__data__.has(t)}var WTe=jTe,XTe=200;function YTe(t,e){var n=this.__data__;if(n instanceof pE){var i=n.__data__;if(!Px||i.length<XTe-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new gE(i)}return n.set(t,e),this.size=n.size,this}var qTe=YTe;function yv(t){var e=this.__data__=new pE(t);this.size=e.size}yv.prototype.clear=kTe;yv.prototype.delete=GTe;yv.prototype.get=VTe;yv.prototype.has=WTe;yv.prototype.set=qTe;var bb=yv;function QTe(t,e){return t&&P1(e,zO(e),t)}var KTe=QTe;function JTe(t,e){return t&&P1(e,GO(e),t)}var ZTe=JTe,yK=typeof ho=="object"&&ho&&!ho.nodeType&&ho,t5=yK&&typeof fo=="object"&&fo&&!fo.nodeType&&fo,$Te=t5&&t5.exports===yK,n5=$Te?rl.Buffer:void 0,i5=n5?n5.allocUnsafe:void 0;function ePe(t,e){if(e)return t.slice();var n=t.length,i=i5?i5(n):new t.constructor(n);return t.copy(i),i}var tPe=ePe;function nPe(t,e){for(var n=-1,i=t==null?0:t.length,r=0,s=[];++n<i;){var o=t[n];e(o,n,t)&&(s[r++]=o)}return s}var iPe=nPe;function rPe(){return[]}var xK=rPe,sPe=Object.prototype,oPe=sPe.propertyIsEnumerable,r5=Object.getOwnPropertySymbols,aPe=r5?function(t){return t==null?[]:(t=Object(t),iPe(r5(t),function(e){return oPe.call(t,e)}))}:xK,WO=aPe;function lPe(t,e){return P1(t,WO(t),e)}var cPe=lPe,uPe=Object.getOwnPropertySymbols,hPe=uPe?function(t){for(var e=[];t;)VO(e,WO(t)),t=jO(t);return e}:xK,_K=hPe;function dPe(t,e){return P1(t,_K(t),e)}var fPe=dPe;function pPe(t,e,n){var i=e(t);return $l(t)?i:VO(i,n(t))}var wK=pPe;function mPe(t){return wK(t,zO,WO)}var UL=mPe;function gPe(t){return wK(t,GO,_K)}var SK=gPe,vPe=qf(rl,"DataView"),kL=vPe,yPe=qf(rl,"Promise"),zL=yPe,xPe=qf(rl,"Set"),GL=xPe,s5="[object Map]",_Pe="[object Object]",o5="[object Promise]",a5="[object Set]",l5="[object WeakMap]",c5="[object DataView]",wPe=Yf(kL),SPe=Yf(Px),bPe=Yf(zL),APe=Yf(GL),MPe=Yf(NL),Nd=Xf;(kL&&Nd(new kL(new ArrayBuffer(1)))!=c5||Px&&Nd(new Px)!=s5||zL&&Nd(zL.resolve())!=o5||GL&&Nd(new GL)!=a5||NL&&Nd(new NL)!=l5)&&(Nd=function(t){var e=Xf(t),n=e==_Pe?t.constructor:void 0,i=n?Yf(n):"";if(i)switch(i){case wPe:return c5;case SPe:return s5;case bPe:return o5;case APe:return a5;case MPe:return l5}return e});var Dx=Nd,EPe=Object.prototype,CPe=EPe.hasOwnProperty;function TPe(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&CPe.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var PPe=TPe,DPe=rl.Uint8Array,LA=DPe;function RPe(t){var e=new t.constructor(t.byteLength);return new LA(e).set(new LA(t)),e}var XO=RPe;function LPe(t,e){var n=e?XO(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var IPe=LPe,BPe=/\w*$/;function OPe(t){var e=new t.constructor(t.source,BPe.exec(t));return e.lastIndex=t.lastIndex,e}var FPe=OPe,u5=ca?ca.prototype:void 0,h5=u5?u5.valueOf:void 0;function NPe(t){return h5?Object(h5.call(t)):{}}var UPe=NPe;function kPe(t,e){var n=e?XO(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var zPe=kPe,GPe="[object Boolean]",HPe="[object Date]",VPe="[object Map]",jPe="[object Number]",WPe="[object RegExp]",XPe="[object Set]",YPe="[object String]",qPe="[object Symbol]",QPe="[object ArrayBuffer]",KPe="[object DataView]",JPe="[object Float32Array]",ZPe="[object Float64Array]",$Pe="[object Int8Array]",e2e="[object Int16Array]",t2e="[object Int32Array]",n2e="[object Uint8Array]",i2e="[object Uint8ClampedArray]",r2e="[object Uint16Array]",s2e="[object Uint32Array]";function o2e(t,e,n){var i=t.constructor;switch(e){case QPe:return XO(t);case GPe:case HPe:return new i(+t);case KPe:return IPe(t,n);case JPe:case ZPe:case $Pe:case e2e:case t2e:case n2e:case i2e:case r2e:case s2e:return zPe(t,n);case VPe:return new i;case jPe:case YPe:return new i(t);case WPe:return FPe(t);case XPe:return new i;case qPe:return UPe(t)}}var a2e=o2e;function l2e(t){return typeof t.constructor=="function"&&!NO(t)?MMe(jO(t)):{}}var c2e=l2e,u2e="[object Map]";function h2e(t){return su(t)&&Dx(t)==u2e}var d2e=h2e,d5=zg&&zg.isMap,f2e=d5?kO(d5):d2e,p2e=f2e,m2e="[object Set]";function g2e(t){return su(t)&&Dx(t)==m2e}var v2e=g2e,f5=zg&&zg.isSet,y2e=f5?kO(f5):v2e,x2e=y2e,_2e=1,w2e=2,S2e=4,bK="[object Arguments]",b2e="[object Array]",A2e="[object Boolean]",M2e="[object Date]",E2e="[object Error]",AK="[object Function]",C2e="[object GeneratorFunction]",T2e="[object Map]",P2e="[object Number]",MK="[object Object]",D2e="[object RegExp]",R2e="[object Set]",L2e="[object String]",I2e="[object Symbol]",B2e="[object WeakMap]",O2e="[object ArrayBuffer]",F2e="[object DataView]",N2e="[object Float32Array]",U2e="[object Float64Array]",k2e="[object Int8Array]",z2e="[object Int16Array]",G2e="[object Int32Array]",H2e="[object Uint8Array]",V2e="[object Uint8ClampedArray]",j2e="[object Uint16Array]",W2e="[object Uint32Array]",Hn={};Hn[bK]=Hn[b2e]=Hn[O2e]=Hn[F2e]=Hn[A2e]=Hn[M2e]=Hn[N2e]=Hn[U2e]=Hn[k2e]=Hn[z2e]=Hn[G2e]=Hn[T2e]=Hn[P2e]=Hn[MK]=Hn[D2e]=Hn[R2e]=Hn[L2e]=Hn[I2e]=Hn[H2e]=Hn[V2e]=Hn[j2e]=Hn[W2e]=!0;Hn[E2e]=Hn[AK]=Hn[B2e]=!1;function Ab(t,e,n,i,r,s){var o,a=e&_2e,l=e&w2e,c=e&S2e;if(n&&(o=r?n(t,i,r,s):n(t)),o!==void 0)return o;if(!Ja(t))return t;var h=$l(t);if(h){if(o=PPe(t),!a)return PMe(t,o)}else{var u=Dx(t),d=u==AK||u==C2e;if(RA(t))return tPe(t,a);if(u==MK||u==bK||d&&!r){if(o=l||d?{}:c2e(t),!a)return l?fPe(t,ZTe(o,t)):cPe(t,KTe(o,t))}else{if(!Hn[u])return r?t:{};o=a2e(t,u,a)}}s||(s=new bb);var f=s.get(t);if(f)return f;s.set(t,o),x2e(t)?t.forEach(function(g){o.add(Ab(g,e,n,g,t,s))}):p2e(t)&&t.forEach(function(g,m){o.set(m,Ab(g,e,n,m,t,s))});var p=c?l?SK:UL:l?GO:zO,v=h?void 0:p(t);return VMe(v||t,function(g,m){v&&(m=g,g=t[m]),OO(o,m,Ab(g,e,n,m,t,s))}),o}var EK=Ab,X2e=1,Y2e=4;function q2e(t){return EK(t,X2e|Y2e)}var yE=q2e,Q2e="__lodash_hash_undefined__";function K2e(t){return this.__data__.set(t,Q2e),this}var J2e=K2e;function Z2e(t){return this.__data__.has(t)}var $2e=Z2e;function IA(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new gE;++e<n;)this.add(t[e])}IA.prototype.add=IA.prototype.push=J2e;IA.prototype.has=$2e;var eDe=IA;function tDe(t,e){for(var n=-1,i=t==null?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}var nDe=tDe;function iDe(t,e){return t.has(e)}var rDe=iDe,sDe=1,oDe=2;function aDe(t,e,n,i,r,s){var o=n&sDe,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(t),h=s.get(e);if(c&&h)return c==e&&h==t;var u=-1,d=!0,f=n&oDe?new eDe:void 0;for(s.set(t,e),s.set(e,t);++u<a;){var p=t[u],v=e[u];if(i)var g=o?i(v,p,u,e,t,s):i(p,v,u,t,e,s);if(g!==void 0){if(g)continue;d=!1;break}if(f){if(!nDe(e,function(m,y){if(!rDe(f,y)&&(p===m||r(p,m,n,i,s)))return f.push(y)})){d=!1;break}}else if(!(p===v||r(p,v,n,i,s))){d=!1;break}}return s.delete(t),s.delete(e),d}var CK=aDe;function lDe(t){var e=-1,n=Array(t.size);return t.forEach(function(i,r){n[++e]=[r,i]}),n}var cDe=lDe;function uDe(t){var e=-1,n=Array(t.size);return t.forEach(function(i){n[++e]=i}),n}var hDe=uDe,dDe=1,fDe=2,pDe="[object Boolean]",mDe="[object Date]",gDe="[object Error]",vDe="[object Map]",yDe="[object Number]",xDe="[object RegExp]",_De="[object Set]",wDe="[object String]",SDe="[object Symbol]",bDe="[object ArrayBuffer]",ADe="[object DataView]",p5=ca?ca.prototype:void 0,l2=p5?p5.valueOf:void 0;function MDe(t,e,n,i,r,s,o){switch(n){case ADe:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case bDe:return!(t.byteLength!=e.byteLength||!s(new LA(t),new LA(e)));case pDe:case mDe:case yDe:return BO(+t,+e);case gDe:return t.name==e.name&&t.message==e.message;case xDe:case wDe:return t==e+"";case vDe:var a=cDe;case _De:var l=i&dDe;if(a||(a=hDe),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;i|=fDe,o.set(t,e);var h=CK(a(t),a(e),i,r,s,o);return o.delete(t),h;case SDe:if(l2)return l2.call(t)==l2.call(e)}return!1}var EDe=MDe,CDe=1,TDe=Object.prototype,PDe=TDe.hasOwnProperty;function DDe(t,e,n,i,r,s){var o=n&CDe,a=UL(t),l=a.length,c=UL(e),h=c.length;if(l!=h&&!o)return!1;for(var u=l;u--;){var d=a[u];if(!(o?d in e:PDe.call(e,d)))return!1}var f=s.get(t),p=s.get(e);if(f&&p)return f==e&&p==t;var v=!0;s.set(t,e),s.set(e,t);for(var g=o;++u<l;){d=a[u];var m=t[d],y=e[d];if(i)var _=o?i(y,m,d,e,t,s):i(m,y,d,t,e,s);if(!(_===void 0?m===y||r(m,y,n,i,s):_)){v=!1;break}g||(g=d=="constructor")}if(v&&!g){var S=t.constructor,A=e.constructor;S!=A&&"constructor"in t&&"constructor"in e&&!(typeof S=="function"&&S instanceof S&&typeof A=="function"&&A instanceof A)&&(v=!1)}return s.delete(t),s.delete(e),v}var RDe=DDe,LDe=1,m5="[object Arguments]",g5="[object Array]",yS="[object Object]",IDe=Object.prototype,v5=IDe.hasOwnProperty;function BDe(t,e,n,i,r,s){var o=$l(t),a=$l(e),l=o?g5:Dx(t),c=a?g5:Dx(e);l=l==m5?yS:l,c=c==m5?yS:c;var h=l==yS,u=c==yS,d=l==c;if(d&&RA(t)){if(!RA(e))return!1;o=!0,h=!1}if(d&&!h)return s||(s=new bb),o||hK(t)?CK(t,e,n,i,r,s):EDe(t,e,l,n,i,r,s);if(!(n&LDe)){var f=h&&v5.call(t,"__wrapped__"),p=u&&v5.call(e,"__wrapped__");if(f||p){var v=f?t.value():t,g=p?e.value():e;return s||(s=new bb),r(v,g,n,i,s)}}return d?(s||(s=new bb),RDe(t,e,n,i,r,s)):!1}var ODe=BDe;function TK(t,e,n,i,r){return t===e?!0:t==null||e==null||!su(t)&&!su(e)?t!==t&&e!==e:ODe(t,e,n,i,TK,r)}var FDe=TK;function NDe(t,e){return t!=null&&e in Object(t)}var UDe=NDe;function kDe(t,e,n){e=vv(e,t);for(var i=-1,r=e.length,s=!1;++i<r;){var o=vE(e[i]);if(!(s=t!=null&&n(t,o)))break;t=t[o]}return s||++i!=r?s:(r=t==null?0:t.length,!!r&&FO(r)&&IO(o,r)&&($l(t)||UO(t)))}var zDe=kDe;function GDe(t,e){return t!=null&&zDe(t,e,UDe)}var HDe=GDe,VDe=function(){return rl.Date.now()},c2=VDe,jDe="Expected a function",WDe=Math.max,XDe=Math.min;function YDe(t,e,n){var i,r,s,o,a,l,c=0,h=!1,u=!1,d=!0;if(typeof t!="function")throw new TypeError(jDe);e=WV(e)||0,Ja(n)&&(h=!!n.leading,u="maxWait"in n,s=u?WDe(WV(n.maxWait)||0,e):s,d="trailing"in n?!!n.trailing:d);function f(b){var T=i,M=r;return i=r=void 0,c=b,o=t.apply(M,T),o}function p(b){return c=b,a=setTimeout(m,e),h?f(b):o}function v(b){var T=b-l,M=b-c,E=e-T;return u?XDe(E,s-M):E}function g(b){var T=b-l,M=b-c;return l===void 0||T>=e||T<0||u&&M>=s}function m(){var b=c2();if(g(b))return y(b);a=setTimeout(m,v(b))}function y(b){return a=void 0,d&&i?f(b):(i=r=void 0,o)}function _(){a!==void 0&&clearTimeout(a),c=0,i=l=r=a=void 0}function S(){return a===void 0?o:y(c2())}function A(){var b=c2(),T=g(b);if(i=arguments,r=this,l=b,T){if(a===void 0)return p(l);if(u)return clearTimeout(a),a=setTimeout(m,e),f(l)}return a===void 0&&(a=setTimeout(m,e)),o}return A.cancel=_,A.flush=S,A}var YO=YDe;function qDe(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var QDe=qDe;function KDe(t,e){return e.length<2?t:pK(t,NTe(e,0,-1))}var JDe=KDe;function ZDe(t,e){return FDe(t,e)}var qO=ZDe;function $De(t,e){return e=vv(e,t),t=JDe(t,e),t==null||delete t[vE(QDe(e))]}var eRe=$De;function tRe(t){return OTe(t)?void 0:t}var nRe=tRe,iRe=1,rRe=2,sRe=4,oRe=gK(function(t,e){var n={};if(t==null)return n;var i=!1;e=iK(e,function(s){return s=vv(s,t),i||(i=s.length>1),s}),P1(t,SK(t),n),i&&(n=EK(n,iRe|rRe|sRe,nRe));for(var r=e.length;r--;)eRe(n,e[r]);return n}),HL=oRe;function aRe(t,e,n,i){if(!Ja(t))return t;e=vv(e,t);for(var r=-1,s=e.length,o=s-1,a=t;a!=null&&++r<s;){var l=vE(e[r]),c=n;if(l==="__proto__"||l==="constructor"||l==="prototype")return t;if(r!=o){var h=a[l];c=i?i(h,l,a):void 0,c===void 0&&(c=Ja(h)?h:IO(e[r+1])?[]:{})}OO(a,l,c),a=a[l]}return t}var lRe=aRe;function cRe(t,e,n){for(var i=-1,r=e.length,s={};++i<r;){var o=e[i],a=pK(t,o);n(a,o)&&lRe(s,vv(o,t),a)}return s}var uRe=cRe;function hRe(t,e){return uRe(t,e,function(n,i){return HDe(t,i)})}var dRe=hRe,fRe=gK(function(t,e){return t==null?{}:dRe(t,e)}),Rx=fRe,pRe="Expected a function";function mRe(t,e,n){var i=!0,r=!0;if(typeof t!="function")throw new TypeError(pRe);return Ja(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),YO(t,e,{leading:i,maxWait:e,trailing:r})}var gRe=mRe,PK,vRe=new Promise(t=>{PK=t}),y5=!1;async function yRe(){if(y5)return;let t=await oE(()=>import("./physics-dee4de67.js"),[]);await t.init(),PK(t),y5=!0}var Ui=class{modifyById(t,e){let n=this;if(n[t]===void 0)throw new Error("not expected");{let i={...n,[t]:e};return Object.setPrototypeOf(i,Ui.prototype),i}}add(t,e){var n;return((n=this.runOp({type:1,id:t,data:e}))==null?void 0:n.data)??this}runOp(t){let e=this;if(t.type===1){let n=e[t.id],i;n===void 0?i={type:2,id:t.id}:i={type:1,id:t.id,data:n};let{id:r,data:s}=t,o={...e,[r]:s};return Object.setPrototypeOf(o,Ui.prototype),{data:o,actual:t,reverse:i}}else if(t.type===2){let{id:n}=t,i=e[n];if(i===void 0)return null;{let r={...e};return Object.setPrototypeOf(r,Ui.prototype),delete r[n],{data:r,actual:t,reverse:{type:1,id:n,data:i}}}}return null}};function QO(t){if(t.deepFreeze!==void 0){t.deepFreeze(t);return}let e=Object.getOwnPropertyNames(t);for(let n of e){let i=t[n];i&&typeof i=="object"&&QO(i)}return Object.freeze(t)}function xRe(t,e){let n=0;for(;n<t.length&&n<e.length;){if(t[n]<e[n])return-1;if(t[n]>e[n])return 1;n+=1}return n!==e.length?-1:n!==t.length?1:0}var DK=class extends Error{};function u2(t){let e={...t};return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}function uh(t,e,n){if(t===void 0?e===void 0?(t=0,e=10):t=e-10:e===void 0&&(e=t+10),t>e){let s=t;t=e,e=s}let i=[],r=1/(n+1);for(let s=0;s<n;s++){let o=t+(e-t)*(s+.75+Math.random()*.5)*r;i.push(o)}return i}function KO(t){return t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Uint32Array||t instanceof Int8Array||t instanceof Int16Array||t instanceof Int32Array||t instanceof Float32Array||t instanceof Float64Array}function _Re(){return typeof process<"u"}function RK(t,e){for(let n of t)e(n.id,n.data)!==!0&&RK(n.children,e)}function LK(t,e){if(e(t.id,t.data)!==!0)for(let n of t.children)LK(n,e)}var Fs=class extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Fs.prototype)}deepFreeze(){let t=0;for(;t<this.length;)QO(this[t]),t++}fillCaches0(t,e){this.objCaches.set(t.id,t),this.parentCaches.set(t.id,e);for(let n of t.children)this.fillCaches0(n,t.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let t of this)this.fillCaches0(t,null)}}randomId(){this.fillCaches();let t=Array.from(this.objCaches.keys());if(t.length!==0)return t[Math.max(0,Math.floor(Math.random()*t.length)-1)]}nonExistOrDescendantOf(t,e){if(!this.has(t))return!0;for(;t;){let n=this.parent(t);if(n===e)return!0;t=n}return!1}isDescendantOf(t,e){for(;t;){let n=this.parent(t);if(n===e)return!0;t=n}return!1}data(t){var e;return(e=this.get(t))==null?void 0:e.data}has(t){return this.childrenOf(t)!==void 0}get(t){return this.fillCaches(),this.objCaches.get(t)}childrenOf(t){var e;return t===null?this:(e=this.get(t))==null?void 0:e.children}traverseFrom(t,e){if(t===null)this.traverse(e);else{let n=this.get(t);n&&LK(n,e)}}traverse(t){RK(this,t)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(t){return this.fillCaches(),this.parentCaches.get(t)}childrenArray(t){return t===null?this:this.get(t).children}modifyById(t,e){if(this.get(t)===void 0)throw new Error("not expected");{let n=this.parent(t),i=this.childrenArray(n),r=i.findIndex(o=>o.id===t);if(r<0)throw new Error("not expected");let s=i[r];return i=[...i],i[r]={...s,data:e},this.modifyArrayBy(n,i)}}modifyArrayBy(t,e){let n=t,i=e;for(;n!==null;){let s=i,o=n;if(n=this.parent(n),n===void 0)throw new Error;i=this.childrenArray(n);let a=i.findIndex(l=>l.id===o);if(a<0)throw new Error;i=[...i],i[a]={...i[a],children:s}}Object.setPrototypeOf(i,Fs.prototype);let r=i;return r.fillCaches(),r}runOp(t){switch(t.type){case 7:return this.addOp(t);case 8:return this.deleteOp(t);case 9:return this.moveOp(t)}return null}checkDuplicatedIdRec({id:t,children:e}){if(this.get(t)!==void 0)return!0;for(let n of e)if(this.checkDuplicatedIdRec(n))return!0;return!1}addOp(t){let{parent:e,fi:n,id:i,data:r,children:s}=t;if(e!==null&&this.get(e)===void 0||this.checkDuplicatedIdRec(t))return null;{let o=e,a=this.childrenArray(o),l={fi:n,id:i,data:r,children:s};return a=[...a,l],a.sort((c,h)=>c.fi-h.fi),t.localIndex=a.indexOf(l),{data:this.modifyArrayBy(o,a),actual:t,reverse:{type:8,id:i}}}}deleteOp(t){let{id:e}=t;if(this.get(e)===null)return null;{let n=this.parent(e);if(n===void 0)return null;let i=this.childrenArray(n),r=i.findIndex(o=>o.id===e);t.localIndex=r,i=[...i];let s=i.splice(r,1)[0];return{data:this.modifyArrayBy(n,i),actual:t,reverse:{type:7,...s,parent:n}}}}moveOp(t){let{parent:e,fi:n,id:i}=t;if(e!==null&&this.get(e)===void 0)return this.deleteOp({type:8,id:i});if(e!==null){let u=e;for(;u!==null;){if(u===void 0)throw new Error;if(u===i)throw new DK("cyclic tree");u=this.parent(u)}}let r=this.parent(i);if(r===void 0)return null;let s=r,o=this.childrenArray(r),a=o.findIndex(u=>u.id===i);o=[...o];let l=o.splice(a,1)[0],c=this.modifyArrayBy(r,o);r=e,o=c.childrenArray(r);let h=l.fi;return l={...l,fi:n},o=[...o,l],o.sort((u,d)=>u.fi-d.fi),t.localIndex=o.indexOf(l),c=c.modifyArrayBy(r,o),{data:c,actual:t,reverse:{type:9,parent:s,fi:h,id:i}}}previous(t,e){if(e===null){let i=this.childrenArray(t);return i.length===0?null:i[i.length-1].id}let n=null;for(let i of this.childrenArray(t)){if(i.id===e)return n;n=i.id}return null}traverseSortNext(t){let e=this.parent(t);if(e!==void 0){let n=this.childrenArray(e),i=n.findIndex(r=>r.id===t)+1;if(i<n.length)return n[i].id;if(e)return this.traverseSortNext(e)}}sortNext(t){let e=this.childrenArray(t);return e.length>0?e[0].id:this.traverseSortNext(t)}traverseSortPrevious(t){let e=this.childrenArray(t);return e.length>0?this.traverseSortPrevious(e[e.length-1].id):t}sortPrevious(t){let e=this.parent(t);if(e!==void 0){let n=this.childrenArray(e),i=n.findIndex(r=>r.id===t)-1;return i>=0?this.traverseSortPrevious(n[i].id):e}}getAllSorted(t){let e=[];for(let n of t){let i=this.getWithSortKey(n.id);i!==void 0&&e.push({...n,...i})}e.sort((n,i)=>xRe(n.sortKey,i.sortKey));for(let n of e)delete n.sortKey;return e}getWithSortKey(t){var e=t;let n=[],i=this.get(e),r=i;if(i!==void 0){for(;e;)n.splice(0,0,i.fi),e=this.parent(e),e!==null&&(i=this.get(e));return{...r,sortKey:n}}}insertBeforeHelper(t,e,n){return this.insertAfterHelper(t,this.previous(t,e),n)}insertAfterHelper(t,e,n){let i=this.childrenArray(t);if(e===null){if(i.length===0)return uh(0,n,n);{let r=i[0].fi;return uh(r-n,r,n)}}else{let r=this.get(e);if(r===void 0||this.parent(e)!==t)throw new Error("illegal args");let s=i.find(o=>o.fi>r.fi);if(s===void 0){let o=i[i.length-1].fi;return uh(o,o+n,n)}else return uh(r.fi,s.fi,n)}}},BA;(t=>{function e(n,i){if(i.type!==0)return null;if(Array.isArray(n)){let r=i.props,s={},o=[...n],a=!1;if(r)for(let l of Object.keys(r)){let c=parseInt(l);if(isNaN(c))throw new Error("wrong index");s[l]=o[c],o[c]=r[l],a=!0}return a?{data:o,actual:i,reverse:{type:0,props:s}}:null}else{let r=i.props,s={},o={...n},a=!1;if(r)for(let l of Object.keys(r)){s[l]=o[l];let c=r[l];c===void 0?delete o[l]:o[l]=c,a=!0}return a?{data:o,actual:i,reverse:{type:0,props:s}}:null}}t.runOp=e})(BA||(BA={}));var $t=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,$t.prototype)}deepFreeze(){let e=0;for(;e<this.length;)QO(this[e]),e++}fillCaches0(e){this.objCaches.set(e.id,e)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let e of this)this.fillCaches0(e)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}data(e){var n;return(n=this.get(e))==null?void 0:n.data}get(e){return this.fillCaches(),this.objCaches.get(e)}modifyById(e,n){if(this.get(e)===void 0)throw new Error("not expected");{let i=this,r=i.findIndex(o=>o.id===e);if(r<0)throw new Error("not expected");let s=i[r];return i=[...i],i[r]={...s,data:n},this.modifyArrayBy(i)}}modifyArrayBy(e){Object.setPrototypeOf(e,$t.prototype);let n=e;return _Re()||n.fillCaches(),n}runOp(e){switch(e.type){case 4:return this.addOp(e);case 5:return this.deleteOp(e);case 6:return this.moveOp(e)}return null}addOp(e){let{fi:n,id:i,data:r}=e,s=this,o={fi:n,id:i,data:r};return s=[...s,o],s.sort((a,l)=>a.fi-l.fi),e.localIndex=s.indexOf(o),{data:this.modifyArrayBy(s),actual:e,reverse:{type:5,id:i}}}deleteOp(e){let{id:n}=e,i=this,r=i.findIndex(o=>o.id===n);if(r===-1)return null;e.localIndex=r,i=[...i];let s=i.splice(r,1)[0];return{data:this.modifyArrayBy(i),actual:e,reverse:{type:4,...s}}}moveOp(e){let{fi:n,id:i}=e,r=this;r=[...r];let s=r.findIndex(l=>l.id===i);if(s===-1)return null;let o=r[s].fi,a={...r[s],fi:n};return r[s]=a,r.sort((l,c)=>l.fi-c.fi),e.localIndex=r.indexOf(a),{data:this.modifyArrayBy(r),actual:e,reverse:{type:6,fi:o,id:i}}}previous(e){if(e===null)return this.length===0?null:this[this.length-1].id;let n=null;for(let i of this){if(i.id===e)return n;n=i.id}return null}insertBeforeHelper(e,n){return this.insertAfterHelper(this.previous(e),n)}insertAfterHelper(e,n){let i=this;if(e===null){if(i.length===0)return uh(0,n,n);{let r=i[0].fi;return uh(r-n,r,n)}}else{let r=this.get(e);if(r===void 0)throw new Error("illegal args");let s=i.find(o=>o.fi>r.fi);if(s===void 0){let o=i[i.length-1].fi;return uh(o,o+n,n)}else return uh(r.fi,s.fi,n)}}};function Gg(t){return t&&typeof t=="object"&&t instanceof Lr}var Lr=class{unusedFunOverridesTable(t){}runOp(t){let e=[],n=this,i=0,r={};for(;i<t.path.length;){if(e.push(n),n=n===void 0?void 0:n[t.path[i]],n!==void 0&&!Gg(n))return null;i+=1}n=n?u2(n):new Lr;for(let[a,l]of Object.entries(t.props)){let c=n[a];r[a]=c,l===void 0?delete n[a]:n[a]=l}for(;i>0;){if(Object.keys(n).length===0){let a=e[i-1];a&&(n=u2(a),delete n[t.path[i-1]])}else{let a=e[i-1];if(a){let l=u2(a);l[t.path[i-1]]=n,n=l}else{let l=new Lr;l[t.path[i-1]]=n,n=l}}i-=1}let s=Object.setPrototypeOf(n,Lr.prototype),o={...t,props:r};return{data:s,actual:t,reverse:o}}},vf;(t=>{function e(r,s){return Lx(r,s)??r}t.apply=e;function n(r,s){return ZO(r,s)}t.merge=n;function i(r,s){let o=0,a=s.path,l=r;for(;o<a.length&&l!==void 0;){if(l=Wl.zoomOnce(l,a[o]),l===void 0)return s;if(!Gg(l))return;o+=1}if(l===void 0)return s;if(Gg(l))if(s.type===0){let c={...s.props};for(let h of Object.keys(l))delete c[h];return{...s,props:c}}else if(s.type===1||s.type===4||s.type===7){let c=JO([s],l);return c?(console.log(c),c):s}else return s}t.filterOp=i})(vf||(vf={}));function JO(t,e){if(e===void 0)return;let n=!1,i=t.map(r=>{let s=r.id,o=Lx(r.data,e[s]);if(n=n||o!==void 0,o===void 0&&(o=r.data),r.children){let a=JO(r.children,e);return a!==void 0?n=!0:a=r.children,{...r,id:s,data:o,children:a}}else return{...r,id:s,data:o}});if(n)return i}function wRe(t,e){if(e===void 0)return;let n=!1,i=t.map(r=>{let s=r.id,o=Lx(r.data,e[s]);return n=n||o!==void 0,o===void 0&&(o=r.data),{...r,id:s,data:o}});if(n)return Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i}function Lx(t,e){if(!Gg(e))return e;if(t instanceof Fs){let n=JO(t,e);return n!==void 0&&Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n}else{if(t instanceof $t)return wRe(t,e);if(Array.isArray(t)){let n=!1,i=t.map((r,s)=>{let o=Lx(r,e[s]);return n=n||o!==void 0,o===void 0&&(o=r),o});return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i):void 0}else{if(t instanceof Lr)return ZO(t,e);if(t&&typeof t=="object"){let n={},i=!1;for(let[r,s]of Object.entries(t)){let o=Lx(s,e[r]);i=i||o!==void 0,o===void 0&&(o=s),n[r]=o}return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(t)),n):void 0}}}}function ZO(t,e){if(t===void 0)return e;if(e===void 0)return t;if(!Gg(e))return e;if(!Gg(t))return vf.apply(t,e);let n=new Set;for(let r of Object.keys(t))n.add(r);for(let r of Object.keys(e))n.add(r);let i=new Lr;for(let r of n){let s=ZO(t===void 0?void 0:t[r],e===void 0?void 0:e[r]);i[r]=s}return i}function SRe(t,e){let n={cur:[],result:[],len:0};return t=Ix(t,e,n)??t,[t,n.result]}function OA(t,e){return t===null?null:(t.cur[t.len]=e,t.len+=1,t)}function FA(t){t&&(t.len-=1)}function bRe(t){if(t===null)return null;t.result.push(t.cur.slice(0,t.len))}function IK(t,e,n){let i=!1,r=t.map(s=>{let o=s.id,a=e[o];if(a!==void 0&&typeof a=="string"&&(i=!0,o=a,n!==null))throw new Error("not supported");let l=Ix(s.data,e,OA(n,o));FA(n),i=i||l!==void 0,l===void 0&&(l=s.data);let c=IK(s.children,e,n);return c!==void 0?i=!0:c=s.children,{...s,id:o,data:l,children:c}});if(i)return r}function ARe(t,e,n){let i=!1,r=t.map(s=>{let o=s.id,a=e[o];if(a!==void 0&&typeof a=="string"&&(i=!0,o=a,n!==null))throw new Error("not supported");let l=Ix(s.data,e,OA(n,o));return FA(n),i=i||l!==void 0,l===void 0&&(l=s.data),{...s,id:o,data:l}});if(i)return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r}function Ix(t,e,n){if(t instanceof Fs){let i=IK(t,e,n);return i!==void 0&&Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i}else{if(t instanceof $t)return ARe(t,e,n);if(Array.isArray(t)){let i=!1,r=t.map((s,o)=>{let a=Ix(s,e,OA(n,o));return FA(n),i=i||a!==void 0,a===void 0&&(a=s),a});return i?(Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r):void 0}else if(t&&typeof t=="object"&&!KO(t)){let i={},r=!1;for(let[s,o]of Object.entries(t))if(s!=="name"&&s!=="text"){let a=e[s];if(typeof a=="string"){if(n!==null)throw new Error("not supported");r=!0,s=a}let l=Ix(o,e,OA(n,s));FA(n),r=r||l!==void 0,l===void 0&&(l=o),i[s]=l}else i[s]=o;return r?(Object.setPrototypeOf(i,Object.getPrototypeOf(t)),i):void 0}else if(typeof t=="string"){let i=e[t];if(i!==void 0){if(t.length!==36)throw new Error("for now you should only call this method when the key is a uuid");bRe(n)}return i}else return}}var VL;(t=>{function e(n,i){let r=Wl.zoom(i,n.path);if(typeof r=="object"){let s={};for(let o of Object.keys(n.props))s[o]=r[o];return{...n,props:s}}else return{...n,props:{}}}t.replaceProps=e})(VL||(VL={}));var lo;(t=>{function e(l,c){return{...l,path:l.path.slice(c)}}t.drop=e;function n(l,c){var h;return((h=i(l,c))==null?void 0:h.data)??l}t.applySimple=n;function i(l,c){var d,f;let h=c.path;for(var u=[];;){let p;if(l instanceof Lr&&c.type===0&&(p=l.runOp({...c,path:h.slice(u.length)}),p===null&&(p=void 0)),p===void 0&&u.length===h.length&&(l instanceof Fs||l instanceof $t||l instanceof Ui?p=l.runOp(c):p=BA.runOp(l,c)),p!==void 0)if(p!==null){let m=p.data;for(let y=u.length-1;y>=0;y--){let _=h[y],S=u[y];if(S instanceof Fs){if(typeof _=="number")throw new Error("illegal arg");m=S.modifyById(_,m)}else if(S instanceof $t){if(typeof _=="number")throw new Error("illegal arg");m=S.modifyById(_,m)}else if(S instanceof Ui){if(typeof _=="number")throw new Error("illegal arg");m=S.modifyById(_,m)}else if(S instanceof Lr){let A={...S,[_]:m};m=Object.setPrototypeOf(A,Lr.prototype)}else if(typeof S=="object")if(Array.isArray(S)){if(typeof _=="string"&&(_=parseInt(_),isNaN(_)))throw new Error("Invalid path");let A=m;m=[...S],m[_]=A}else m={...S,[_]:m};else return null}return{data:m,actual:{...p.actual,path:h},reverse:{...p.reverse,path:h}}}else return null;let v=h[u.length],g;if(l instanceof Fs){if(typeof v=="number")throw new Error("");g=(d=l.get(v))==null?void 0:d.data}else if(l instanceof $t){if(typeof v=="number")throw new Error("");g=(f=l.get(v))==null?void 0:f.data}else l!==null&&(g=l[v]);if(g!==void 0)u.push(l),l=g;else return null}}t.apply=i;function r(l,c){for(let h=0;h<l.length&&h<c.length;h++)if(l[h]!==c[h])return!0;return!1}t.pathDisjoint=r;function s(l,c){if(l.length!==c.length)return!1;for(let h=0;h<l.length;h++)if(l[h]!==c[h])return!1;return!0}t.pathEq=s;function o(l,c){return r(l.path,c.path)}t.commutative=o;function a(l,c){return l.type===0&&c.type===0&&s(l.path,c.path)?Object.keys(l.props).every(h=>c.props[h]!==void 0):!1}t.subsumed=a})(lo||(lo={}));var x5;(t=>{function e(){return[]}t.empty=e;function n(c,h){let u=[];for(let d of c){let[f,...p]=d.path;f===h&&u.push({...d,path:p})}return u}t.removePrefix=n;function i(c,h){return c.map(u=>({...u,path:[h,...u.path]}))}t.addPrefix=i;function r(c,h){return[...c,...h]}t.concat=r;function s(c,h){return[...c.filter(u=>!h.some(d=>lo.subsumed(u,d))),...h]}t.compress=s;function o(c,h){return c.every(u=>h.every(d=>lo.commutative(u,d)))}t.commutative=o;function a(c,h){for(let u of h){let d=l(c,u);d!==null&&(c=d.data)}return c}t.applyAll=a;function l(c,h){var u=c;let d=[],f=[];for(let p of h)try{if(p.type===3){let v=Wl.zoom(u,[...p.path,p.id]),g=lo.apply(u,{...p,type:2});if(g!==null){u=g.data;let[m,y]=SRe(u,{[p.id]:v});u=m;for(let _ of y){let S=_[_.length-1];_.splice(_.length-1,1),d.push({type:0,path:_,props:{[S]:v}}),f.push({type:0,path:_,props:{[S]:p.id}})}f.push(g.reverse),d.push(g.actual)}}else{let v=lo.apply(u,p);v!==null&&(d.push(v.actual),u=v.data,f.push(v.reverse))}}catch(v){if(v instanceof DK)return null;throw v}return{data:u,actual:d,reverse:f.reverse()}}t.apply=l})(x5||(x5={}));var BK=Symbol(),MRe=Symbol(),xE=Symbol(),D1=class{reportOp(t,e,n=[]){let i=this;if(e===null)return;i._current=e.data;let r=n;for(;!(i instanceof FK);){let s=i._path,o=i._current;if(s!==""&&r.splice(0,0,s),i=i._parent,i===null)return;i.update(s,o)}i.push(r,t,e.actual,e.reverse)}deleteChildren(t){if(this._children){let e=this._children[t];if(e){let n=e[xE];n&&n(),delete this._children[t]}}}},ERe=class extends D1{constructor(t,e,n){super(),this._parent=t,this._path=e,this._current=n}update(t,e){if(Array.isArray(this._current)){if(typeof t=="string"&&(t=parseInt(t),isNaN(t)))throw new Error("Invalid path");this._current=[...this._current],this._current[t]=e}else this._current={...this._current,[t]:e}}runOp(t){this.reportOp(t,BA.runOp(this._current,t),t.path)}},CRe=class extends D1{constructor(t,e,n){super(),this._parent=t,this._path=e,this._current=n}update(t,e){this._current={...this._current,[t]:e},Object.setPrototypeOf(this._current,Ui.prototype)}runOp(t){this.reportOp(t,this._current.runOp(t))}},OK={get(t,e){if(e===xE)return()=>{t._parent=null};if(e===BK)return t._current;if(e===MRe)return t;let{_current:n,_children:i}=t;if(e==="push"&&Array.isArray(n))throw new Error("not supported to expand array");let r=i===void 0?void 0:i[e];if(r!==void 0)return r;let s=n[e],o=_E(t,e,s);return o!==s?(i===void 0&&(i={},t._children=i),i[e]=o,o):s},has(t,e){return e in t._current},ownKeys(t){return Reflect.ownKeys(t._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(t){return Object.getPrototypeOf(t._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(t,e){let n=t._current,i=Reflect.getOwnPropertyDescriptor(n,e);return i&&{writable:!0,configurable:!0,enumerable:i.enumerable,value:n[e]}}},TRe={...OK,set(t,e,n){let i={type:0,props:{[e]:qr(n)??n}};return t.deleteChildren(e),t.runOp(i),!0},deleteProperty(t,e){let n={type:0,props:{[e]:void 0}};return t.deleteChildren(e),t.runOp(n),!0}},PRe={...OK,set(t,e,n){return n===void 0?this.deleteProperty(t,e):(t.deleteChildren(e),t.runOp({type:1,id:e,data:n})),!0},deleteProperty(t,e){return t.runOp({type:2,id:e}),!0}},$O=class extends D1{constructor(t,e,n){super(),this._children={},this._parent=t,this._path=e,this._current=n,this[xE]=()=>{this._parent=null}}unproxy(){return this._current}update(t,e){this._current=this._current.modifyById(t,e)}runOp(t){this.reportOp(t,this._current.runOp(t))}randomId(){return this._current.randomId()}isDescendantOf(t,e){return this._current.isDescendantOf(t,e)}childrenOf(t){return this._current.childrenOf(t)}traverse(t){return this._current.traverse(t)}get(t){return this._current.get(t)}parent(t){return this._current.parent(t)}traverse(t){this._current.traverse((e,n)=>{t(e,this.data(e))})}data(t){var o;let{_current:e,_children:n}=this,i=n===void 0?void 0:n[t];if(i!==void 0)return i;let r=(o=e.get(t))==null?void 0:o.data,s=_E(this,t,r);return s!==r?(n===void 0&&(n={},this._children=n),n[t]=s,s):r}add(t,e,n,i,r){this.runOp({type:7,parent:t,fi:e,id:n,data:i,children:r})}move(t,e,n){this.runOp({type:9,parent:t,fi:e,id:n})}insertAfter(t,e,n){let i=this._current.insertAfterHelper(t,e,n.length);for(let r=0;r<n.length;r++){let s=n[r];this.add(t,i[r],s.id,s.data,s.children)}}insertBefore(t,e,n){let i=this._current.insertBeforeHelper(t,e,n.length);for(let r=0;r<n.length;r++){let s=n[r];this.add(t,i[r],s.id,s.data,s.children)}}moveAfter(t,e,n){let i=this._current.insertAfterHelper(t,e,n.length);for(let r=0;r<n.length;r++){let s=n[r];this.move(t,i[r],s)}}moveBefore(t,e,n){let i=this._current.insertBeforeHelper(t,e,n.length);for(let r=0;r<n.length;r++){let s=n[r];this.move(t,i[r],s)}}delete(t){this.deleteChildren(t),this.runOp({type:8,id:t})}sortNext(t){return this._current.sortNext(t)}sortPrevious(t){return this._current.sortPrevious(t)}getAllSorted(t){return this._current.getAllSorted(t)}},eF=class extends D1{constructor(t,e,n){super(),this._children={},this._parent=t,this._path=e,this._current=n,this[xE]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(t){let e=this.length;for(let n=0;n<e;n++){let i=this._current[n].id,r=this._current[n].fi;t(this.data(this._current[n].id),i,r)}}find(t){let e=this.length;for(let n=0;n<e;n++){let i=this._current[n].id;if(t(this.data(i),i))return this.get(i)}}update(t,e){this._current=this._current.modifyById(t,e)}randomId(){return this._current.randomId()}get(t){return{...this._current.get(t),data:this.data(t)}}data(t){var o;let{_current:e,_children:n}=this,i=n===void 0?void 0:n[t];if(i!==void 0)return i;let r=(o=e.get(t))==null?void 0:o.data,s=_E(this,t,r);return s!==r?(n===void 0&&(n={},this._children=n),n[t]=s,s):r}runOp(t){this.reportOp(t,this._current.runOp(t))}add(t,e,n){this.runOp({type:4,fi:t,id:e,data:n})}move(t,e){this.runOp({type:6,fi:t,id:e})}insertAfter(t,e){let n=this._current.insertAfterHelper(t,e.length);for(let i=0;i<e.length;i++){let r=e[i];this.add(n[i],r.id,r.data)}}insertBefore(t,e){let n=this._current.insertBeforeHelper(t,e.length);for(let i=0;i<e.length;i++){let r=e[i];this.add(n[i],r.id,r.data)}}moveAfter(t,e){let n=this._current.insertAfterHelper(t,e.length);for(let i=0;i<e.length;i++){let r=e[i];this.move(n[i],r)}}moveBefore(t,e){let n=this._current.insertBeforeHelper(t,e.length);for(let i=0;i<e.length;i++){let r=e[i];this.move(n[i],r)}}delete(t){this.deleteChildren(t),this.runOp({type:5,id:t})}};function h2(t,e,n){if(t.length>0){let i=t[t.length-1];if(i.type===0&&e.type===0&&Wl.equal(i.path,n)){Object.assign(i.props,e.props);return}}t.push({...e,path:n})}var FK=class extends D1{constructor(t){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=t}update(t,e){if(t!=="")throw new Error("");this._current=e}push(t,e,n,i){h2(this.ts,e,t),h2(this.actual,n,t),h2(this.reverse,i,t)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function _E(t,e,n){return n instanceof Fs?new $O(t,e,n):n instanceof $t?new eF(t,e,n):n instanceof Ui?new Proxy(new CRe(t,e,n),PRe):n!==null&&typeof n=="object"?KO(n)?n:new Proxy(new ERe(t,e,n),TRe):n}function NK(t){let e=new FK(t);return[_E(e,"",t),e]}function NA(t,e){let[n,i]=NK(t);return e(n),i.result()}function qr(t){return t instanceof $O||t instanceof eF?t._current:t!==null&&typeof t=="object"?t[BK]:t}var Wl;(t=>{function e(s,o){if(o.length===s.length)for(var a=0;a<s.length;){if(s[a]!==o[a])return!1;a+=1}else return!1;return!0}t.equal=e;function n(s,o,a){let l=r(a,s);if(l!==void 0&&typeof l=="object"&&l!==null){let c={...o};return Object.keys(l).forEach(h=>{delete c[h]}),c}else return o}t.removeOverridden=n;function i(s,o){if((s instanceof Fs||s instanceof $O)&&typeof o=="string"||(s instanceof $t||s instanceof eF)&&typeof o=="string")return s.data(o);if(typeof o=="number"&&Array.isArray(s)||typeof o=="string"&&typeof s=="object"&&s!==null)return s[o]}t.zoomOnce=i;function r(s,o,a=0){for(;a<o.length&&s!==void 0;)s=i(s,o[a]),a+=1;return s}t.zoom=r})(Wl||(Wl={}));function DRe(t,e){let n=[];if(e.length===t.length)for(var i=0;i<t.length;){if(e[i]==="*")n.push(t[i]);else if(t[i]!==e[i])return null;i+=1}else return null;return n}function th(t,e){let n=[];if(e.length<=t.length)for(var i=0;i<e.length;){if(e[i]==="*")n.push(t[i]);else if(t[i]!==e[i])return null;i+=1}else return null;return n}var UK=class{},_5=class extends UK{constructor(t){super(),this.id=t}},w5=class extends UK{constructor(t){super(),this.data=t}},jL;try{jL=new TextDecoder}catch{}var ut,Dh,Le=0,Ts={},Sn,hh,Yo=0,Il=0,Zs,Qc,ps=[],Mn,S5={useRecords:!1,mapsAsObjects:!0},kK=class{},zK=new kK;zK.name="MessagePack 0xC1";var Hg=!1,UA=class{constructor(t){t&&(t.useRecords===!1&&t.mapsAsObjects===void 0&&(t.mapsAsObjects=!0),t.structures?t.structures.sharedLength=t.structures.length:t.getStructures&&((t.structures=[]).uninitialized=!0,t.structures.sharedLength=0)),Object.assign(this,t)}unpack(t,e){if(ut)return XK(()=>(XL(),this?this.unpack(t,e):UA.prototype.unpack.call(S5,t,e)));Dh=e>-1?e:t.length,Le=0,Il=0,hh=null,Zs=null,ut=t;try{Mn=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(n){throw ut=null,t instanceof Uint8Array?n:new Error("Source must be a Uint8Array or Buffer but was a "+(t&&typeof t=="object"?t.constructor.name:typeof t))}if(this instanceof UA){if(Ts=this,this.structures)return Sn=this.structures,xS();(!Sn||Sn.length>0)&&(Sn=[])}else Ts=S5,(!Sn||Sn.length>0)&&(Sn=[]);return xS()}unpackMultiple(t,e){let n,i=0;try{Hg=!0;let r=t.length,s=this?this.unpack(t,r):SE.unpack(t,r);if(e){for(e(s);Le<r;)if(i=Le,e(xS())===!1)return}else{for(n=[s];Le<r;)i=Le,n.push(xS());return n}}catch(r){throw r.lastPosition=i,r.values=n,r}finally{Hg=!1,XL()}}_mergeStructures(t,e){t=t||[];for(let n=0,i=t.length;n<i;n++){let r=t[n];r&&(r.isShared=!0,n>=32&&(r.highByte=n-32>>5))}t.sharedLength=t.length;for(let n in e||[])if(n>=0){let i=t[n],r=e[n];r&&(i&&((t.restoreStructures||(t.restoreStructures=[]))[n]=i),t[n]=r)}return this.structures=t}decode(t,e){return this.unpack(t,e)}};function xS(){try{if(!Ts.trusted&&!Hg){let e=Sn.sharedLength||0;e<Sn.length&&(Sn.length=e)}let t=xi();if(Le==Dh)Sn.restoreStructures&&b5(),Sn=null,ut=null,Qc&&(Qc=null);else if(Le>Dh){let e=new Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}else if(!Hg)throw new Error("Data read, but end of buffer not reached");return t}catch(t){throw Sn.restoreStructures&&b5(),XL(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function b5(){for(let t in Sn.restoreStructures)Sn[t]=Sn.restoreStructures[t];Sn.restoreStructures=null}function xi(){let t=ut[Le++];if(t<160)if(t<128){if(t<64)return t;{let e=Sn[t&63]||Ts.getStructures&&GK()[t&63];return e?(e.read||(e.read=tF(e,t&63)),e.read()):t}}else if(t<144)if(t-=128,Ts.mapsAsObjects){let e={};for(let n=0;n<t;n++)e[VK()]=xi();return e}else{let e=new Map;for(let n=0;n<t;n++)e.set(xi(),xi());return e}else{t-=144;let e=new Array(t);for(let n=0;n<t;n++)e[n]=xi();return e}else if(t<192){let e=t-160;if(Il>=Le)return hh.slice(Le-Yo,(Le+=e)-Yo);if(Il==0&&Dh<140){let n=e<16?nF(e):HK(e);if(n!=null)return n}return WL(e)}else{let e;switch(t){case 192:return null;case 193:return Zs?(e=xi(),e>0?Zs[1].slice(Zs.position1,Zs.position1+=e):Zs[0].slice(Zs.position0,Zs.position0-=e)):zK;case 194:return!1;case 195:return!0;case 196:return d2(ut[Le++]);case 197:return e=Mn.getUint16(Le),Le+=2,d2(e);case 198:return e=Mn.getUint32(Le),Le+=4,d2(e);case 199:return Md(ut[Le++]);case 200:return e=Mn.getUint16(Le),Le+=2,Md(e);case 201:return e=Mn.getUint32(Le),Le+=4,Md(e);case 202:if(e=Mn.getFloat32(Le),Ts.useFloat32>2){let n=iF[(ut[Le]&127)<<1|ut[Le+1]>>7];return Le+=4,(n*e+(e>0?.5:-.5)>>0)/n}return Le+=4,e;case 203:return e=Mn.getFloat64(Le),Le+=8,e;case 204:return ut[Le++];case 205:return e=Mn.getUint16(Le),Le+=2,e;case 206:return e=Mn.getUint32(Le),Le+=4,e;case 207:return Ts.int64AsNumber?(e=Mn.getUint32(Le)*4294967296,e+=Mn.getUint32(Le+4)):e=Mn.getBigUint64(Le),Le+=8,e;case 208:return Mn.getInt8(Le++);case 209:return e=Mn.getInt16(Le),Le+=2,e;case 210:return e=Mn.getInt32(Le),Le+=4,e;case 211:return Ts.int64AsNumber?(e=Mn.getInt32(Le)*4294967296,e+=Mn.getUint32(Le+4)):e=Mn.getBigInt64(Le),Le+=8,e;case 212:if(e=ut[Le++],e==114)return T5(ut[Le++]&63);{let n=ps[e];if(n)return n.read?(Le++,n.read(xi())):n.noBuffer?(Le++,n()):n(ut.subarray(Le,++Le));throw new Error("Unknown extension "+e)}case 213:return e=ut[Le],e==114?(Le++,T5(ut[Le++]&63,ut[Le++])):Md(2);case 214:return Md(4);case 215:return Md(8);case 216:return Md(16);case 217:return e=ut[Le++],Il>=Le?hh.slice(Le-Yo,(Le+=e)-Yo):LRe(e);case 218:return e=Mn.getUint16(Le),Le+=2,Il>=Le?hh.slice(Le-Yo,(Le+=e)-Yo):IRe(e);case 219:return e=Mn.getUint32(Le),Le+=4,Il>=Le?hh.slice(Le-Yo,(Le+=e)-Yo):BRe(e);case 220:return e=Mn.getUint16(Le),Le+=2,M5(e);case 221:return e=Mn.getUint32(Le),Le+=4,M5(e);case 222:return e=Mn.getUint16(Le),Le+=2,E5(e);case 223:return e=Mn.getUint32(Le),Le+=4,E5(e);default:if(t>=224)return t-256;if(t===void 0){let n=new Error("Unexpected end of MessagePack data");throw n.incomplete=!0,n}throw new Error("Unknown MessagePack token "+t)}}}var RRe=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function tF(t,e){function n(){if(n.count++>2){let r=t.read=new Function("r","return function(){return {"+t.map(s=>RRe.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"}}")(xi);return t.highByte===0&&(t.read=A5(e,t.read)),r()}let i={};for(let r=0,s=t.length;r<s;r++){let o=t[r];i[o]=xi()}return i}return n.count=0,t.highByte===0?A5(e,n):n}var A5=(t,e)=>function(){let n=ut[Le++];if(n===0)return e();let i=t<32?-(t+(n<<5)):t+(n<<5),r=Sn[i]||GK()[i];if(!r)throw new Error("Record id is not defined for "+i);return r.read||(r.read=tF(r,t)),r.read()};function GK(){let t=XK(()=>(ut=null,Ts.getStructures()));return Sn=Ts._mergeStructures(t,Sn)}var WL=wE,LRe=wE,IRe=wE,BRe=wE;function wE(t){let e;if(t<16&&(e=nF(t)))return e;if(t>64&&jL)return jL.decode(ut.subarray(Le,Le+=t));let n=Le+t,i=[];for(e="";Le<n;){let r=ut[Le++];if(!(r&128))i.push(r);else if((r&224)===192){let s=ut[Le++]&63;i.push((r&31)<<6|s)}else if((r&240)===224){let s=ut[Le++]&63,o=ut[Le++]&63;i.push((r&31)<<12|s<<6|o)}else if((r&248)===240){let s=ut[Le++]&63,o=ut[Le++]&63,a=ut[Le++]&63,l=(r&7)<<18|s<<12|o<<6|a;l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|l&1023),i.push(l)}else i.push(r);i.length>=4096&&(e+=fr.apply(String,i),i.length=0)}return i.length>0&&(e+=fr.apply(String,i)),e}function M5(t){let e=new Array(t);for(let n=0;n<t;n++)e[n]=xi();return e}function E5(t){if(Ts.mapsAsObjects){let e={};for(let n=0;n<t;n++)e[VK()]=xi();return e}else{let e=new Map;for(let n=0;n<t;n++)e.set(xi(),xi());return e}}var fr=String.fromCharCode;function HK(t){let e=Le,n=new Array(t);for(let i=0;i<t;i++){let r=ut[Le++];if((r&128)>0){Le=e;return}n[i]=r}return fr.apply(String,n)}function nF(t){if(t<4)if(t<2){if(t===0)return"";{let e=ut[Le++];if((e&128)>1){Le-=1;return}return fr(e)}}else{let e=ut[Le++],n=ut[Le++];if((e&128)>0||(n&128)>0){Le-=2;return}if(t<3)return fr(e,n);let i=ut[Le++];if((i&128)>0){Le-=3;return}return fr(e,n,i)}else{let e=ut[Le++],n=ut[Le++],i=ut[Le++],r=ut[Le++];if((e&128)>0||(n&128)>0||(i&128)>0||(r&128)>0){Le-=4;return}if(t<6){if(t===4)return fr(e,n,i,r);{let s=ut[Le++];if((s&128)>0){Le-=5;return}return fr(e,n,i,r,s)}}else if(t<8){let s=ut[Le++],o=ut[Le++];if((s&128)>0||(o&128)>0){Le-=6;return}if(t<7)return fr(e,n,i,r,s,o);let a=ut[Le++];if((a&128)>0){Le-=7;return}return fr(e,n,i,r,s,o,a)}else{let s=ut[Le++],o=ut[Le++],a=ut[Le++],l=ut[Le++];if((s&128)>0||(o&128)>0||(a&128)>0||(l&128)>0){Le-=8;return}if(t<10){if(t===8)return fr(e,n,i,r,s,o,a,l);{let c=ut[Le++];if((c&128)>0){Le-=9;return}return fr(e,n,i,r,s,o,a,l,c)}}else if(t<12){let c=ut[Le++],h=ut[Le++];if((c&128)>0||(h&128)>0){Le-=10;return}if(t<11)return fr(e,n,i,r,s,o,a,l,c,h);let u=ut[Le++];if((u&128)>0){Le-=11;return}return fr(e,n,i,r,s,o,a,l,c,h,u)}else{let c=ut[Le++],h=ut[Le++],u=ut[Le++],d=ut[Le++];if((c&128)>0||(h&128)>0||(u&128)>0||(d&128)>0){Le-=12;return}if(t<14){if(t===12)return fr(e,n,i,r,s,o,a,l,c,h,u,d);{let f=ut[Le++];if((f&128)>0){Le-=13;return}return fr(e,n,i,r,s,o,a,l,c,h,u,d,f)}}else{let f=ut[Le++],p=ut[Le++];if((f&128)>0||(p&128)>0){Le-=14;return}if(t<15)return fr(e,n,i,r,s,o,a,l,c,h,u,d,f,p);let v=ut[Le++];if((v&128)>0){Le-=15;return}return fr(e,n,i,r,s,o,a,l,c,h,u,d,f,p,v)}}}}}function d2(t){return Ts.copyBuffers?Uint8Array.prototype.slice.call(ut,Le,Le+=t):ut.subarray(Le,Le+=t)}function Md(t){let e=ut[Le++];if(ps[e])return ps[e](ut.subarray(Le,Le+=t));throw new Error("Unknown extension type "+e)}var C5=new Array(4096);function VK(){let t=ut[Le++];if(t>=160&&t<192){if(t=t-160,Il>=Le)return hh.slice(Le-Yo,(Le+=t)-Yo);if(!(Il==0&&Dh<180))return WL(t)}else return Le--,xi();let e=(t<<5^(t>1?Mn.getUint16(Le):t>0?ut[Le]:0))&4095,n=C5[e],i=Le,r=Le+t-3,s,o=0;if(n&&n.bytes==t){for(;i<r;){if(s=Mn.getUint32(i),s!=n[o++]){i=1879048192;break}i+=4}for(r+=3;i<r;)if(s=ut[i++],s!=n[o++]){i=1879048192;break}if(i===r)return Le=i,n.string;r-=3,i=Le}for(n=[],C5[e]=n,n.bytes=t;i<r;)s=Mn.getUint32(i),n.push(s),i+=4;for(r+=3;i<r;)s=ut[i++],n.push(s);let a=t<16?nF(t):HK(t);return a!=null?n.string=a:n.string=WL(t)}var T5=(t,e)=>{var n=xi();let i=t;e!==void 0&&(t=t<32?-((e<<5)+t):(e<<5)+t,n.highByte=e);let r=Sn[t];return r&&r.isShared&&((Sn.restoreStructures||(Sn.restoreStructures=[]))[t]=r),Sn[t]=n,n.read=tF(n,i),n.read()},jK=typeof self=="object"?self:global;ps[0]=()=>{};ps[0].noBuffer=!0;ps[101]=()=>{let t=xi();return(jK[t[0]]||Error)(t[1])};ps[105]=t=>{let e=Mn.getUint32(Le-4);Qc||(Qc=new Map);let n=ut[Le],i;n>=144&&n<160||n==220||n==221?i=[]:i={};let r={target:i};Qc.set(e,r);let s=xi();return r.used?Object.assign(i,s):(r.target=s,s)};ps[112]=t=>{let e=Mn.getUint32(Le-4),n=Qc.get(e);return n.used=!0,n.target};ps[115]=()=>new Set(xi());var WK=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(t=>t+"Array");ps[116]=t=>{let e=t[0],n=WK[e];if(!n)throw new Error("Could not find typed array for code "+e);return new jK[n](Uint8Array.prototype.slice.call(t,1).buffer)};ps[120]=()=>{let t=xi();return new RegExp(t[0],t[1])};ps[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],n=Le;Le+=e-4,Zs=[xi(),xi()],Zs.position0=0,Zs.position1=0;let i=Le;Le=n;try{return xi()}finally{Le=i}};ps[255]=t=>t.length==4?new Date((t[0]*16777216+(t[1]<<16)+(t[2]<<8)+t[3])*1e3):t.length==8?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+((t[3]&3)*4294967296+t[4]*16777216+(t[5]<<16)+(t[6]<<8)+t[7])*1e3):t.length==12?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+((t[4]&128?-281474976710656:0)+t[6]*1099511627776+t[7]*4294967296+t[8]*16777216+(t[9]<<16)+(t[10]<<8)+t[11])*1e3):new Date("invalid");function XK(t){let e=Dh,n=Le,i=Yo,r=Il,s=hh,o=Qc,a=Zs,l=new Uint8Array(ut.slice(0,Dh)),c=Sn,h=Sn.slice(0,Sn.length),u=Ts,d=Hg,f=t();return Dh=e,Le=n,Yo=i,Il=r,hh=s,Qc=o,Zs=a,ut=l,Hg=d,Sn=c,Sn.splice(0,Sn.length,...h),Ts=u,Mn=new DataView(ut.buffer,ut.byteOffset,ut.byteLength),f}function XL(){ut=null,Qc=null,Sn=null}function ORe(t){t.unpack?ps[t.type]=t.unpack:ps[t.type]=t}var iF=new Array(147);for(let t=0;t<256;t++)iF[t]=+("1e"+Math.floor(45.15-t*.30103));var SE=new UA({useRecords:!1});SE.unpack;SE.unpackMultiple;SE.unpack;var FRe=new Float32Array(1);new Uint8Array(FRe.buffer,0,4);var Mb;try{Mb=new TextEncoder}catch{}var kA,rF,bE=typeof Buffer<"u",f2=bE?Buffer.allocUnsafeSlow:Uint8Array,YK=bE?Buffer:Uint8Array,P5=bE?4294967296:2144337920,Xe,Ei,ke=0,pl,ml=null,NRe=/[\u0080-\uFFFF]/,b0=Symbol("record-id"),qK=class extends UA{constructor(t){super(t),this.offset=0;let e,n,i,r,s,o=0,a=YK.prototype.utf8Write?function(b,T,M){return Xe.utf8Write(b,T,M)}:Mb&&Mb.encodeInto?function(b,T){return Mb.encodeInto(b,Xe.subarray(T)).written}:!1,l=this;t||(t={});let c=t&&t.sequential,h=t.structures||t.saveStructures,u=t.maxSharedStructures;if(u==null&&(u=h?32:0),u>8160)throw new Error("Maximum maxSharedStructure is 8160");let d=t.maxOwnStructures;d==null&&(d=h?32:64),c&&!t.saveStructures&&(this.structures=[]);let f=u>32||d+u>64,p=u+64,v=u+d+64;if(v>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let g=[],m=0,y=0;this.pack=this.encode=function(b,T){if(Xe||(Xe=new f2(8192),Ei=new DataView(Xe.buffer,0,8192),ke=0),pl=Xe.length-10,pl-ke<2048?(Xe=new f2(Xe.length),Ei=new DataView(Xe.buffer,0,Xe.length),pl=Xe.length-10,ke=0):ke=ke+7&2147483640,e=ke,s=l.structuredClone?new Map:null,l.bundleStrings?(ml=["",""],Xe[ke++]=214,Xe[ke++]=98,ml.position=ke-e,ke+=4):ml=null,n=l.structures,n){n.uninitialized&&(n=l._mergeStructures(l.getStructures()));let M=n.sharedLength||0;if(M>u)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+n.sharedLength);if(!n.transitions){n.transitions=Object.create(null);for(let E=0;E<M;E++){let P=n[E];if(!P)continue;let R,F=n.transitions;for(let B=0,k=P.length;B<k;B++){let j=P[B];R=F[j],R||(R=F[j]=Object.create(null)),F=R}F[b0]=E+64}o=M}c||(n.nextId=M+64)}i&&(i=!1),r=n||[];try{if(_(b),ml){Ei.setUint32(ml.position+e,ke-ml.position-e);let M=ml;ml=null,_(M[0]),_(M[1])}if(l.offset=ke,s&&s.idsToInsert){ke+=s.idsToInsert.length*6,ke>pl&&A(ke),l.offset=ke;let M=kRe(Xe.subarray(e,ke),s.idsToInsert);return s=null,M}return T&zRe?(Xe.start=e,Xe.end=ke,Xe):Xe.subarray(e,ke)}finally{if(n){if(y<10&&y++,m>1e4)n.transitions=null,y=0,m=0,g.length>0&&(g=[]);else if(g.length>0&&!c){for(let M=0,E=g.length;M<E;M++)g[M][b0]=0;g=[]}if(i&&l.saveStructures){let M=n.sharedLength||u;n.length>M&&(n=n.slice(0,M));let E=Xe.subarray(e,ke);return l.saveStructures(n,o)===!1?(l._mergeStructures(l.getStructures()),l.pack(b)):(o=M,E)}}T&GRe&&(ke=e)}};let _=b=>{ke>pl&&(Xe=A(ke));var T=typeof b,M;if(T==="string"){let E=b.length;if(ml&&E>=8&&E<4096){let F=NRe.test(b);ml[F?0:1]+=b,Xe[ke++]=193,_(F?-E:E);return}let P;E<32?P=1:E<256?P=2:E<65536?P=3:P=5;let R=E*3;if(ke+R>pl&&(Xe=A(ke+R)),E<64||!a){let F,B,k,j=ke+P;for(F=0;F<E;F++)B=b.charCodeAt(F),B<128?Xe[j++]=B:B<2048?(Xe[j++]=B>>6|192,Xe[j++]=B&63|128):(B&64512)===55296&&((k=b.charCodeAt(F+1))&64512)===56320?(B=65536+((B&1023)<<10)+(k&1023),F++,Xe[j++]=B>>18|240,Xe[j++]=B>>12&63|128,Xe[j++]=B>>6&63|128,Xe[j++]=B&63|128):(Xe[j++]=B>>12|224,Xe[j++]=B>>6&63|128,Xe[j++]=B&63|128);M=j-ke-P}else M=a(b,ke+P,R);M<32?Xe[ke++]=160|M:M<256?(P<2&&Xe.copyWithin(ke+2,ke+1,ke+1+M),Xe[ke++]=217,Xe[ke++]=M):M<65536?(P<3&&Xe.copyWithin(ke+3,ke+2,ke+2+M),Xe[ke++]=218,Xe[ke++]=M>>8,Xe[ke++]=M&255):(P<5&&Xe.copyWithin(ke+5,ke+3,ke+3+M),Xe[ke++]=219,Ei.setUint32(ke,M),ke+=4),ke+=M}else if(T==="number")if(b>>>0===b)b<64?Xe[ke++]=b:b<256?(Xe[ke++]=204,Xe[ke++]=b):b<65536?(Xe[ke++]=205,Xe[ke++]=b>>8,Xe[ke++]=b&255):(Xe[ke++]=206,Ei.setUint32(ke,b),ke+=4);else if(b>>0===b)b>=-32?Xe[ke++]=256+b:b>=-128?(Xe[ke++]=208,Xe[ke++]=b+256):b>=-32768?(Xe[ke++]=209,Ei.setInt16(ke,b),ke+=2):(Xe[ke++]=210,Ei.setInt32(ke,b),ke+=4);else{let E;if((E=this.useFloat32)>0&&b<4294967296&&b>=-2147483648){Xe[ke++]=202,Ei.setFloat32(ke,b);let P;if(E<4||(P=b*iF[(Xe[ke]&127)<<1|Xe[ke+1]>>7])>>0===P){ke+=4;return}else ke--}Xe[ke++]=203,Ei.setFloat64(ke,b),ke+=8}else if(T==="object")if(!b)Xe[ke++]=192;else{if(s){let P=s.get(b);if(P){if(!P.id){let R=s.idsToInsert||(s.idsToInsert=[]);P.id=R.push(P)}Xe[ke++]=214,Xe[ke++]=112,Ei.setUint32(ke,P.id),ke+=4;return}else s.set(b,{offset:ke-e})}let E=b.constructor;if(E===Object)S(b,!0);else if(E===Array){M=b.length,M<16?Xe[ke++]=144|M:M<65536?(Xe[ke++]=220,Xe[ke++]=M>>8,Xe[ke++]=M&255):(Xe[ke++]=221,Ei.setUint32(ke,M),ke+=4);for(let P=0;P<M;P++)_(b[P])}else if(E===Map){M=b.size,M<16?Xe[ke++]=128|M:M<65536?(Xe[ke++]=222,Xe[ke++]=M>>8,Xe[ke++]=M&255):(Xe[ke++]=223,Ei.setUint32(ke,M),ke+=4);for(let[P,R]of b)_(P),_(R)}else{for(let P=0,R=kA.length;P<R;P++){let F=rF[P];if(b instanceof F){let B=kA[P];if(B.write){B.type&&(Xe[ke++]=212,Xe[ke++]=B.type,Xe[ke++]=0),_(B.write.call(this,b));return}let k=Xe,j=Ei,Z=ke;Xe=null;let ee;try{ee=B.pack.call(this,b,O=>(Xe=k,k=null,ke+=O,ke>pl&&A(ke),{target:Xe,targetView:Ei,position:ke-O}),_)}finally{k&&(Xe=k,Ei=j,ke=Z,pl=Xe.length-10)}ee&&(ee.length+ke>pl&&A(ee.length+ke),ke=URe(ee,Xe,ke,B.type));return}}S(b,!b.hasOwnProperty)}}else if(T==="boolean")Xe[ke++]=b?195:194;else if(T==="bigint"){if(b<BigInt(1)<<BigInt(63)&&b>=-(BigInt(1)<<BigInt(63)))Xe[ke++]=211,Ei.setBigInt64(ke,b);else if(b<BigInt(1)<<BigInt(64)&&b>0)Xe[ke++]=207,Ei.setBigUint64(ke,b);else if(this.largeBigIntToFloat)Xe[ke++]=203,Ei.setFloat64(ke,Number(b));else throw new RangeError(b+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");ke+=8}else if(T==="undefined")this.encodeUndefinedAsNil?Xe[ke++]=192:(Xe[ke++]=212,Xe[ke++]=0,Xe[ke++]=0);else if(T==="function")_(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+T)},S=this.useRecords===!1?this.variableMapSize?b=>{let T=Object.keys(b),M=T.length;M<16?Xe[ke++]=128|M:M<65536?(Xe[ke++]=222,Xe[ke++]=M>>8,Xe[ke++]=M&255):(Xe[ke++]=223,Ei.setUint32(ke,M),ke+=4);let E;for(let P=0;P<M;P++)_(E=T[P]),_(b[E])}:(b,T)=>{Xe[ke++]=222;let M=ke-e;ke+=2;let E=0;for(let P in b)(T||b.hasOwnProperty(P))&&(_(P),_(b[P]),E++);Xe[M+++e]=E>>8,Xe[M+e]=E&255}:b=>{let T=Object.keys(b),M,E=r.transitions||(r.transitions=Object.create(null)),P=0;for(let F=0,B=T.length;F<B;F++){let k=T[F];M=E[k],M||(M=E[k]=Object.create(null),P++),E=M}let R=E[b0];if(R)R>=96&&f?(Xe[ke++]=((R-=96)&31)+96,Xe[ke++]=R>>5):Xe[ke++]=R;else{R=r.nextId,R||(R=64),R<p&&this.shouldShareStructure&&!this.shouldShareStructure(T)?(R=r.nextOwnId,R<v||(R=p),r.nextOwnId=R+1):(R>=v&&(R=p),r.nextId=R+1);let F=T.highByte=R>=96&&f?R-96>>5:-1;E[b0]=R,r[R-64]=T,R<p?(T.isShared=!0,r.sharedLength=R-63,i=!0,F>=0?(Xe[ke++]=(R&31)+96,Xe[ke++]=F):Xe[ke++]=R):(F>=0?(Xe[ke++]=213,Xe[ke++]=114,Xe[ke++]=(R&31)+96,Xe[ke++]=F):(Xe[ke++]=212,Xe[ke++]=114,Xe[ke++]=R),P&&(m+=y*P),g.length>=d&&(g.shift()[b0]=0),g.push(E),_(T))}for(let F=0,B=T.length;F<B;F++)_(b[T[F]])},A=b=>{let T;if(b>16777216){if(b-e>P5)throw new Error("Packed buffer would be larger than maximum buffer size");T=Math.min(P5,Math.round(Math.max((b-e)*(b>67108864?1.25:2),4194304)/4096)*4096)}else T=(Math.max(b-e<<2,Xe.length-1)>>12)+1<<12;let M=new f2(T);return Ei=new DataView(M.buffer,0,T),Xe.copy?Xe.copy(M,0,e,b):M.set(Xe.slice(e,b)),ke-=e,e=0,pl=M.length-10,Xe=M}}useBuffer(t){Xe=t,Ei=new DataView(Xe.buffer,Xe.byteOffset,Xe.byteLength),ke=0}};rF=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,kK];kA=[{pack(t,e,n){let i=t.getTime()/1e3;if((this.useTimestamp32||t.getMilliseconds()===0)&&i>=0&&i<4294967296){let{target:r,targetView:s,position:o}=e(6);r[o++]=214,r[o++]=255,s.setUint32(o,i)}else if(i>0&&i<17179869184){let{target:r,targetView:s,position:o}=e(10);r[o++]=215,r[o++]=255,s.setUint32(o,t.getMilliseconds()*4e6+(i/1e3/4294967296>>0)),s.setUint32(o+4,i)}else if(isNaN(i)){if(this.onInvalidDate)return e(0),n(this.onInvalidDate());let{target:r,targetView:s,position:o}=e(3);r[o++]=212,r[o++]=255,r[o++]=255}else{let{target:r,targetView:s,position:o}=e(15);r[o++]=199,r[o++]=12,r[o++]=255,s.setUint32(o,t.getMilliseconds()*1e6),s.setBigInt64(o+4,BigInt(Math.floor(i)))}}},{pack(t,e,n){let i=Array.from(t),{target:r,position:s}=e(this.structuredClone?3:0);this.structuredClone&&(r[s++]=212,r[s++]=115,r[s++]=0),n(i)}},{pack(t,e,n){let{target:i,position:r}=e(this.structuredClone?3:0);this.structuredClone&&(i[r++]=212,i[r++]=101,i[r++]=0),n([t.name,t.message])}},{pack(t,e,n){let{target:i,position:r}=e(this.structuredClone?3:0);this.structuredClone&&(i[r++]=212,i[r++]=120,i[r++]=0),n([t.source,t.flags])}},{pack(t,e){this.structuredClone?D5(t,16,e):R5(bE?Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let n=t.constructor;n!==YK&&this.structuredClone?D5(t,WK.indexOf(n.name),e):R5(t,e)}},{pack(t,e){let{target:n,position:i}=e(1);n[i]=193}}];function D5(t,e,n,i){let r=t.byteLength;if(r+1<256){var{target:s,position:o}=n(4+r);s[o++]=199,s[o++]=r+1}else if(r+1<65536){var{target:s,position:o}=n(5+r);s[o++]=200,s[o++]=r+1>>8,s[o++]=r+1&255}else{var{target:s,position:o,targetView:a}=n(7+r);s[o++]=201,a.setUint32(o,r+1),o+=4}s[o++]=116,s[o++]=e,s.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),o)}function R5(t,e){let n=t.byteLength;var i,r;if(n<256){var{target:i,position:r}=e(n+2);i[r++]=196,i[r++]=n}else if(n<65536){var{target:i,position:r}=e(n+3);i[r++]=197,i[r++]=n>>8,i[r++]=n&255}else{var{target:i,position:r,targetView:s}=e(n+5);i[r++]=198,s.setUint32(r,n),r+=4}i.set(t,r)}function URe(t,e,n,i){let r=t.length;switch(r){case 1:e[n++]=212;break;case 2:e[n++]=213;break;case 4:e[n++]=214;break;case 8:e[n++]=215;break;case 16:e[n++]=216;break;default:r<256?(e[n++]=199,e[n++]=r):r<65536?(e[n++]=200,e[n++]=r>>8,e[n++]=r&255):(e[n++]=201,e[n++]=r>>24,e[n++]=r>>16&255,e[n++]=r>>8&255,e[n++]=r&255)}return e[n++]=i,e.set(t,n),n+=r,n}function kRe(t,e){let n,i=e.length*6,r=t.length-i;for(e.sort((s,o)=>s.offset>o.offset?1:-1);n=e.pop();){let s=n.offset,o=n.id;t.copyWithin(s+i,s,r),i-=6;let a=s+i;t[a++]=214,t[a++]=105,t[a++]=o>>24,t[a++]=o>>16&255,t[a++]=o>>8&255,t[a++]=o&255,r=s}return t}function xv(t){if(t.Class){if(!t.pack&&!t.write)throw new Error("Extension has no pack or write function");if(t.pack&&!t.type)throw new Error("Extension has no type (numeric code to identify the extension)");rF.unshift(t.Class),kA.unshift(t)}ORe(t)}var QK=new qK({useRecords:!1});QK.pack;QK.pack;var zRe=512,GRe=1024,L5=new qK({structuredClone:!0});xv({Class:Ui.prototype.constructor,type:1,write(t){return{...t}},read(t){return Object.setPrototypeOf(t,Ui.prototype),t}});xv({Class:$t.prototype.constructor,type:2,write(t){return[...t]},read(t){return Object.setPrototypeOf(t,$t.prototype),t}});xv({Class:Fs.prototype.constructor,type:3,write(t){return[...t]},read(t){return Object.setPrototypeOf(t,Fs.prototype),t}});xv({Class:_5.prototype.constructor,type:4,write(t){return t.id},read(t){return new _5(t)}});xv({Class:w5.prototype.constructor,type:5,write(t){return t.data},read(t){return new w5(t)}});xv({Class:Lr.prototype.constructor,type:6,write(t){return{...t}},read(t){return Object.setPrototypeOf(t,Lr.prototype),t}});function HRe(t){var e=0;if(t.length===0)return e;for(let n=0;n<t.length;n++){let i=t[n];e=(e<<5)-e+i,e=e&e}return e}function YL(t){if(KO(t))return t;if(Array.isArray(t))return t.map(YL);if(typeof t=="object"&&t!==null){let e={};for(let n of Object.keys(t).sort())e[n]=YL(t[n]);return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}else return t}var qL;(t=>{function e(r){return L5.pack(r)}t.serialize=e;function n(r){return L5.unpack(r)}t.deserialize=n;function i(r){return HRe(e(YL(r))).toString()}t.checksum=i})(qL||(qL={}));var Ou={LookAt:[],Follow:["Create"],DragDrop:["Transition","Audio","Create"],MouseHover:["Transition","Create","Destroy","SwitchCamera"],Scroll:["Transition","Create"],Start:["Transition","Audio","Video","Create","Destroy","SwitchCamera"],Conditional:["Transition","Audio","Video","Create","Destroy","SwitchCamera","Reset"],MouseDown:["Transition","SwitchCamera","Audio","Video","Link","Create","Destroy","Reset"],MouseUp:["Transition","SwitchCamera","Audio","Video","Link","Create","Destroy","Reset"],MousePress:["Transition","SwitchCamera","Audio","Video","Link","Create","Reset"],KeyDown:["Transition","SwitchCamera","Audio","Video","Link","Create","Destroy","Reset"],KeyUp:["Transition","SwitchCamera","Audio","Video","Link","Create","Destroy","Reset"],KeyPress:["Transition","SwitchCamera","Audio","Video","Link","Create","Reset"],GameControl:["Transition","Audio","Video","Create"],Collision:["Transition","Audio","Video","Create","Destroy","Reset"]},I5;(t=>{function e(i){return i.type==="MouseDown"||i.type==="MouseUp"||i.type==="MousePress"||i.type==="KeyDown"||i.type==="KeyUp"||i.type==="KeyPress"}t.is=e;function n(i){return i==="MouseDown"||i==="MouseUp"||i==="MousePress"?{type:i,mode:"Object",disabled:!1,toggle:!1,actions:new $t}:{type:i,disabled:!1,key:void 0,toggle:!1,actions:new $t}}t.defaultData=n})(I5||(I5={}));var zA;(t=>{function e(n){return{type:"Property",value:[n??null,"position","x"]}}t.propertyDefaultData=e,t.valueDefaultData={type:"Literal",value:0}})(zA||(zA={}));var QL;(t=>{function e(r){return{type:"Comparison",operator:"==",lOperand:zA.propertyDefaultData(r),rOperand:{...zA.valueDefaultData}}}t.comparisonDefaultData=e;function n(r){return{type:"Distance",toObject:r??null,fromObject:r??null,distance:200}}t.distanceDefaultData=n;function i(r,s){return{type:"State",object:r??null,state:s??null}}t.stateDefaultData=i})(QL||(QL={}));var B5;(t=>{function e(i){return i.type==="Conditional"}t.is=e;function n(i){return{type:"Conditional",disabled:!1,inActions:new $t,outActions:new $t,condition:QL.distanceDefaultData(i)}}t.defaultData=n})(B5||(B5={}));var O5;(t=>t.defaultData={type:"DragDrop",cursor:"hand",render:"normal",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new $t,drop:new $t}})(O5||(O5={}));var KL;(t=>t.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new $t})(KL||(KL={}));var JL;(t=>t.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5})(JL||(JL={}));var F5;(t=>{function e(i){return i.type==="MouseHover"}t.is=e;function n(){return{type:"MouseHover",disabled:!1,actions:new $t}}t.defaultData=n})(F5||(F5={}));var N5;(t=>{function e(i){return i.type==="Scroll"}t.is=e;function n(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new $t}}t.defaultData=n})(N5||(N5={}));var U5;(t=>{function e(i){return i.type==="Start"}t.is=e;function n(){return{type:"Start",disabled:!1,actions:new $t}}t.defaultData=n})(U5||(U5={}));var k5;(t=>{function e(i){return i.type==="Collision"}t.is=e;function n(){return{type:"Collision",disabled:!1,toggle:!1,target:"character",actions:new $t}}t.defaultData=n})(k5||(k5={}));var Gm;(t=>{function e(i,r){return i[0]===r[0]&&i[1]===r[1]}t.isEqual=e;function n(i,r,s){return[i[0]+(r[0]-i[0])*s,i[1]+(r[1]-i[1])*s]}t.lerp=n})(Gm||(Gm={}));var yf;(t=>{function e(l,c){return l[0]===c[0]&&l[1]===c[1]&&l[2]===c[2]}t.isEqual=e;function n(l,c){return[l[0]+c[0],l[1]+c[1],l[2]+c[2]]}t.add=n;function i(l,c){return[l[0]-c[0],l[1]-c[1],l[2]-c[2]]}t.sub=i;function r(l,c){return[l[0]/c[0],l[1]/c[1],l[2]/c[2]]}t.div=r;function s(l,c){return[l[0]*c[0],l[1]*c[1],l[2]*c[2]]}t.mul=s;function o(l,c){return Math.hypot(l[0]-c[0],l[1]-c[1],l[2]-c[2])}t.dist=o;function a(l,c,h){return[l[0]+(c[0]-l[0])*h,l[1]+(c[1]-l[1])*h,l[2]+(c[2]-l[2])*h]}t.lerp=a})(yf||(yf={}));var GA;(t=>{function e(i,r){return i[0]===r[0]&&i[1]===r[1]&&i[2]===r[2]&&i[3]===r[3]}t.isEqual=e;function n(i,r,s){return[i[0]+(r[0]-i[0])*s,i[1]+(r[1]-i[1])*s,i[2]+(r[2]-i[2])*s,i[3]+(r[3]-i[3])*s]}t.lerp=n})(GA||(GA={}));var Vg;(t=>{t.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function e(r,s){for(let o=0;o<16;o++)if(r[o]!==s[o])return!1;return!0}t.isEqual=e;function n(r){return r??t.identity}t.simplify=n;function i(r,s){let o=s.slice(0);for(var a=0,l=s.length;a<l;a+=3){let c=r[3]*s[a]+r[7]*s[a+1]+r[11]*s[a+2]+r[15];o[a]=(r[0]*s[a]+r[4]*s[a+1]+r[8]*s[a+2]+r[12])/c,o[a+1]=(r[1]*s[a]+r[5]*s[a+1]+r[9]*s[a+2]+r[13])/c,o[a+2]=(r[2]*s[a]+r[6]*s[a+1]+r[10]*s[a+2]+r[14])/c}return o}t.applyMatrix4=i})(Vg||(Vg={}));var no;(t=>{function e(a){return typeof a=="object"&&typeof a.r=="number"&&typeof a.g=="number"&&typeof a.b=="number"}t.isRGB=e,t.white={r:1,g:1,b:1},t.red={r:1,g:0,b:0},t.black={r:0,g:0,b:0};function n(a){return{r:Math.round(a.r*255),g:Math.round(a.g*255),b:Math.round(a.b*255),a:1}}t.toRgb255a1=n;function i(a){return{r:a.r,g:a.g,b:a.b}}t.clone=i;function r(a){return a=Math.floor(a),{r:(a>>16&255)/255,g:(a>>8&255)/255,b:(a&255)/255}}t.fromHex=r;function s(a,l){return a.r===l.r&&a.g===l.g&&a.b===l.b}t.equals=s;function o(a,l,c){return{r:a.r+(l.r-a.r)*c,g:a.g+(l.g-a.g)*c,b:a.b+(l.b-a.b)*c}}t.lerp=o})(no||(no={}));var Ua;(t=>{t.white={...no.white,a:1},t.transparent={...no.white,a:0};function e(o){return{r:o[0],g:o[1],b:o[2],a:o[3]}}t.from0to1=e;function n(o,a){return{...no.fromHex(o),a}}t.fromHexAndA=n;function i(o){return{r:Math.round(o.r*255),g:Math.round(o.g*255),b:Math.round(o.b*255),a:o.a}}t.toRgb255a1=i;function r(o,a){return no.equals(o,a)&&o.a===a.a}t.equals=r;function s(o,a,l){return{r:o.r+(a.r-o.r)*l,g:o.g+(a.g-o.g)*l,b:o.b+(a.b-o.b)*l,a:o.a+(a.a-o.a)*l}}t.lerp=s})(Ua||(Ua={}));var ZL;(t=>t.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(ZL||(ZL={}));var z5;(t=>t.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(z5||(z5={}));var G5;(t=>t.defaultData={control1:[.5,.05],control2:[.1,.3]})(G5||(G5={}));var Of;(t=>{t.all=["PerspectiveCamera","OrthographicCamera"];function e(n){return t.all.includes(n)}t.is=e})(Of||(Of={}));var Bx;(t=>{t.DefaultUp=[0,1,0],t.DefaultTargetOffset=1e3,t.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1,autoZoom:!1,autoZoomFrustumSize:790},up:t.DefaultUp,isUpVectorFlipped:!1,targetOffset:t.DefaultTargetOffset};function e(n){return n.type==="PerspectiveCamera"?n.perspective.zoom:n.orthographic.zoom}t.getZoom=e})(Bx||(Bx={}));var dh;(t=>{function e(i,r=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(i[0],i[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[i[0]+i[0]*r,0,0]},grid:{count:[2,2,2],size:i.map(s=>s*(1+r)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}t.defaultData=e;function n(i,r){let s={...i};if(KK.forEach(o=>{Object.assign(s,{[o]:r[o]??i[o]})}),s.radial={...i.radial},r.radial){let o=i.radial,a=r.radial;JK.forEach(l=>{Object.assign(s.radial,{[l]:a[l]??o[l]})})}if(s.linear={...i.linear},r.linear){let o=i.linear,a=r.linear;ZK.forEach(l=>{Object.assign(s.linear,{[l]:a[l]??o[l]})})}if(s.grid={...i.grid},r.grid){let o=i.grid,a=r.grid;$K.forEach(l=>{Object.assign(s.grid,{[l]:a[l]??o[l]})})}if(s.toObject={...i.toObject},r.toObject){let o=i.toObject,a=r.toObject;eJ.forEach(l=>{Object.assign(s.toObject,{[l]:a[l]??o[l]})})}if(s.randomnessObject={...i.randomnessObject},r.randomnessObject){let o=i.randomnessObject,a=r.randomnessObject;tJ.forEach(l=>{Object.assign(s.randomnessObject,{[l]:a[l]??o[l]})})}return s}t.merge=n})(dh||(dh={}));var $L;(t=>{t.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let e=["radial","linear","grid","toObject","randomnessObject"];function n(i,r){let s=[];i.count!==void 0&&s.push({type:0,path:r,props:{count:i.count}});for(let o of e){let a=i[o];a&&Object.keys(a).length>0&&s.push({type:0,path:[...r,o],props:a})}return s}t.toOps=n})($L||($L={}));var KK=["count"],JK=["radius","start","end","position","scale","rotation"],ZK=["position","scale","rotation"],$K=["count","size"],eJ=["count","position","scale","rotation"],tJ=["strength","scale","rotation","position","movement","seed","freqScale"],Ox;(t=>{let e={opacity:1,blendFunction:13,enabled:!1};t.defaultData={enabled:!1,pixelation:{...e,blendFunction:16,granularity:15},bloom:{...e,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...e,offset:[2,2]},vignette:{...e,darkness:1,offset:0},hueSaturation:{...e,hue:3,saturation:0},brightnessContrast:{...e,brightness:.25,contrast:0},depthOfField:{...e,focalLength:2,focusDistance:2,bokehScale:2},noise:{...e,blendFunction:16}}})(Ox||(Ox={}));var eI;(t=>{t.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function e(n){return t.all.includes(n)}t.is=e})(eI||(eI={}));var tI;(t=>{function e(i){return n(i)}t.defaultData=e;function n(i){if(i==="PointLight")return{type:i,color:Ua.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,depth:1e5};if(i==="SpotLight")return{type:i,color:Ua.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,shadowResolution:1024,shadowRadius:1};if(i==="DirectionalLight")return{type:i,color:Ua.white,intensity:1,shadows:!0,size:2e3,depth:1e5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(tI||(tI={}));var nI;(t=>{t.defaultData={castShadow:!0,receiveShadow:!0};function e(n,i){return n.castShadow===i.castShadow&&n.receiveShadow===i.receiveShadow}t.equals=e})(nI||(nI={}));var iI;(t=>{t.defaultData={flatShading:!1,wireframe:!1,side:0};function e(n,i){return n.flatShading===i.flatShading&&n.side===i.side&&n.wireframe===i.wireframe}t.equals=e})(iI||(iI={}));var rI;(t=>t.defaultData={...iI.defaultData,...nI.defaultData})(rI||(rI={}));var HA;(t=>(t.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},t.maxSize=3e7))(HA||(HA={}));var H5;(t=>{function e(n){return n==="texture"||n==="video"||n==="color"||n==="depth"||n==="normal"||n==="gradient"||n==="noise"||n==="fresnel"||n==="rainbow"||n==="toon"||n==="outline"||n==="transmission"||n==="matcap"||n==="displace"||n==="light"}t.is=e})(H5||(H5={}));var V5;(t=>{function e(n){return n==="phong"||n==="toon"||n==="lambert"||n==="physical"}t.is=e})(V5||(V5={}));var nJ=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],VRe=["wrapping","image","video"],Jo;(t=>{function e(s,o){let{texture:a,...l}=o;if(Object.assign(s,l),a){let c=s.texture;c&&Object.assign(c,a)}}t.patch=e;function n(s,o){return s==="light"&&o?i(o):r(s)}t.defaultData=n;function i(s){switch(s){case"phong":return{category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",alpha:.6,visible:!0,mode:0};case"toon":return{category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1,visible:!0,mode:0};case"lambert":return{category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0};case"physical":return{category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0}}}function r(s){switch(s){case"texture":return{alpha:1,visible:!0,size:[128,128],mode:0,axis:"x",side:2,type:"texture",projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0]},crop:!1};case"video":return{alpha:1,visible:!0,size:[128,128],mode:0,axis:"x",side:2,type:"video",projection:0,texture:{video:HA.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0]},crop:!0};case"color":return{type:"color",alpha:1,visible:!0,mode:0,color:no.fromHex(5526619)};case"depth":return{type:"depth",alpha:1,visible:!0,mode:0,gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{type:"normal",alpha:1,visible:!0,mode:0,cnormal:[1,1,1]};case"gradient":return{type:"gradient",alpha:1,visible:!0,mode:0,gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{type:"noise",alpha:1,visible:!0,mode:0,size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...no.fromHex(6710886),a:1},colorB:{...no.fromHex(6710886),a:1},colorC:{...no.fromHex(16777215),a:1},colorD:{...no.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8]};case"fresnel":return{type:"fresnel",alpha:1,visible:!0,mode:0,color:Ua.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{type:"rainbow",alpha:1,visible:!0,mode:0,filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{type:"toon",alpha:1,visible:!0,mode:0,positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:Ua.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{type:"outline",alpha:1,visible:!0,mode:0,outlineColor:Ua.fromHexAndA(0,1),contourColor:Ua.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{type:"matcap",alpha:1,visible:!0,mode:0,texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0]}};case"transmission":return{type:"transmission",alpha:1,visible:!0,mode:0,thickness:10,ior:1.5,roughness:1};case"displace":return{type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,visible:!0}}}})(Jo||(Jo={}));var vo;(t=>{function e(c){return!c.layers.some(h=>h.data.type==="texture"&&h.data.projection!==0||h.data.type==="depth"&&!h.data.isWorldSpace||h.data.type==="noise"||h.data.type==="displace")}t.isMergable=e;function n(c){let h="";return c.layers.forEach(u=>{Object.entries(u.data).forEach(([d,f])=>{h+=`${d}${f}`,Array.isArray(f)?f.forEach(p=>h+=`${p}`):typeof f=="object"?Object.values(f).forEach(p=>{typeof p=="number"?h+=`${p.toFixed(4)}`:h+=`${p}`}):h+=`${f}`})}),h}t.getHash=n;function i(){return{layers:new $t}}t.defaultEmptyData=i;function r(c="layer1",h="layer2"){return o("phong",c,h)}t.defaultData=r;function s(c,h){return{...c,name:h}}t.withName=s;function o(c,h="layer1",u="layer2"){let d=new $t;return d.push({fi:0,data:Jo.defaultData("light",c),id:h}),d.push({fi:1,data:Jo.defaultData("color"),id:u}),{layers:d}}t.defaultTwoLayerData=o;function a(c,h="phong",u="layer1",d="layer2"){let f=Jo.defaultData("texture");Object.assign(f.texture,{image:c});let p=new $t;return p.push({fi:0,data:f,id:u}),p.push({fi:1,data:Jo.defaultData("light",h),id:d}),{layers:p}}t.defaultTwoLayerTextureData=a;function l(c,h="phong",u="layer1",d="layer2"){let f=Jo.defaultData("video");Object.assign(f.texture,{video:c});let p=new $t;return p.push({fi:0,data:f,id:u}),p.push({fi:1,data:Jo.defaultData("light",h),id:d}),{layers:p}}t.defaultTwoLayerVideoTextureData=l})(vo||(vo={}));var VA;(t=>{function e(){return{points:new $t,roundness:0,shapeHoles:[],isClosed:!1}}t.defaultData=e})(VA||(VA={}));var jA;(t=>{function e(){return{points:new $t,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}t.defaultData=e})(jA||(jA={}));var iJ={type:"Ellipse",width:100,height:100,spikes:64,angle:360,innerRadius:0},sI;(t=>{function e(n,i){let r={...n};return sJ.forEach(s=>{Object.assign(r,{[s]:i[s]??n[s]})}),r}t.merge=e})(sI||(sI={}));var rJ={shape:iJ,depth:1,offset:0,bevel:0,bevelSides:1,angle:0,twist:0,startScale:1,endScale:1},sJ=["depth","offset","angle","twist","startScale","endScale"],WA;(t=>{function e(i){return i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"}t.is2DParametricMesh=e;function n(i){return i==="PolygonGeometry"||i==="PolygonGeometry"||i==="RectangleGeometry"||i==="StarGeometry"||i==="TriangleGeometry"||i==="EllipseGeometry"||i==="PathGeometry"||i==="VectorGeometry"||i==="ConeGeometry"||i==="CubeGeometry"||i==="CylinderGeometry"||i==="DodecahedronGeometry"||i==="HelixGeometry"||i==="IcosahedronGeometry"||i==="LatheGeometry"||i==="PyramidGeometry"||i==="SphereGeometry"||i==="PlaneGeometry"||i==="BackdropGeometry"||i==="TorusGeometry"||i==="TorusKnotGeometry"||i==="BooleanGeometry"||i==="TextGeometry"}t.isParametricMesh=n})(WA||(WA={}));var oI;(t=>{function e(n,i){let r={...n};return Object.assign(r,i),r.type==="PathGeometry"&&"extrusion"in i&&i.extrusion&&(r.extrusion={...n.extrusion},Object.assign(r.extrusion,sI.merge(r.extrusion,i.extrusion))),r}t.merge=e})(oI||(oI={}));var ag;(t=>{function e(n){if(n==="RectangleGeometry")return{width:320,height:320,type:n,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(n==="PathGeometry")return{type:n,width:1,height:1,depth:1,path:jA.defaultData(),extrusion:rJ};if(n==="VectorGeometry")return{width:1,height:1,type:n,subdivisions:12,shape:VA.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(n==="BooleanGeometry")return{type:n,operation:2,width:0,height:0,depth:0,phongAngle:35};if(n==="TextGeometry")return{type:n,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:"",textTransform:1,font:"Roboto_regular",extrudeBevelSize:0,extrudeBevelSegments:1};throw new Error("not implemented")}t.defaultData=e})(ag||(ag={}));var j5=["width","height","depth"],W5;(t=>{function e(i){return i==="Component"||i==="Instance"}t.isComponentRelated=e;function n(i){return i==="Empty"||i==="Instance"}t.isEmptyOrComponent=n})(W5||(W5={}));var jg;(t=>{t.identity={...ZL.identity,hiddenMatrix:Vg.identity};function e(r){return{position:r.position,rotation:r.rotation,scale:r.scale,hiddenMatrix:r.hiddenMatrix}}t.fromObject=e;function n(r,s){return{position:(s==null?void 0:s.position)||r.position,rotation:(s==null?void 0:s.rotation)||r.rotation,scale:(s==null?void 0:s.scale)||r.scale,hiddenMatrix:(s==null?void 0:s.hiddenMatrix)||r.hiddenMatrix}}t.merge=n;function i(r,s){return{position:yf.isEqual(r.position,s.position)?null:s.position,rotation:yf.isEqual(r.rotation,s.rotation)?null:s.rotation,scale:yf.isEqual(r.scale,s.scale)?null:s.scale,hiddenMatrix:Vg.isEqual(r.hiddenMatrix,s.hiddenMatrix)?null:s.hiddenMatrix}}t.diff=i})(jg||(jg={}));var X5;(t=>t.defaultData={fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(X5||(X5={}));var ra;(t=>t.defaultData={states:new $t,events:new $t,visible:!0,raycastLock:!1,collision:"visibility",physics:null,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...jg.identity,cloner:null})(ra||(ra={}));var Y5;(t=>t.defaultData={type:"Empty",...ra.defaultData})(Y5||(Y5={}));var q5;(t=>t.defaultData={type:"Component",...ra.defaultData})(q5||(q5={}));var lg;(t=>t.defaultData={type:"Mesh",...ra.defaultData,...rI.defaultData})(lg||(lg={}));var XA;(t=>t.defaultData={...ra.defaultData,...jg.identity,...Bx.defaultData})(XA||(XA={}));var aI;(t=>{function e(n){return{...ra.defaultData,...tI.defaultData(n)}}t.defaultData=e})(aI||(aI={}));var YA;(t=>{function e(i,r,s=0){for(;s<r.length;){let o=i?i[r[s]]:void 0;if(r.length===s+1)return o;if(o)i=o.descendants,s+=1;else return}}t.resolveWithDes=e;function n(i,r,s=0){let o=e(i,r,s);if(o){let a=Object.keys(o);if(a.length===1&&a[0]==="descendants")return}return o}t.resolve=n})(YA||(YA={}));var Wg;(t=>{t.rootOverrideProps=["physics"],t.compositeNonOptionalOverrideProps=["geometry"],t.compositeEntireOverrideOverrideProps=["material"];function e(i,r){return{...ra.defaultData,...r,component:i,overrides:new Lr,physics:void 0,type:"Instance"}}t.ofComponent=e;function n(i){let r=jg.fromObject(i.data);return e(i.id,r)}t.fromComponentData=n})(Wg||(Wg={}));var lI;(t=>(t.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:Vg.identity,name:"Play Camera",visible:!0,raycastLock:!1,collision:"visibility",physics:null,states:new $t,events:new $t,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...Bx.defaultData},t.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},t.defaultMeshObject={name:"Rectangle",...ra.defaultData,...lg.defaultData,geometry:ag.defaultData("RectangleGeometry"),material:vo.defaultTwoLayerData("phong","layer1","layer2")},t.defaultBooleanObject={name:"Boolean",...ra.defaultData,...lg.defaultData,geometry:ag.defaultData("BooleanGeometry"),material:vo.defaultTwoLayerData("phong","layer1","layer2")},t.defaultTextObject={name:"Text",...ra.defaultData,...lg.defaultData,geometry:ag.defaultData("TextGeometry"),material:vo.defaultTwoLayerData("phong","layer1","layer2")}))(lI||(lI={}));var tf;(t=>{function e(s,o){let a={name:o};return s.type==="Mesh"?(a.geometry={},"material"in s&&(a.material={layers:new Lr}),"materials"in s&&(a.materials=s.materials.map(l=>({layers:new Lr})))):Of.is(s.type)&&(a.perspective={},a.orthographic={}),a}t.newEmpty=e;function n(s,o){if(o===void 0)return s;let a={...s};return"material"in a&&"material"in o&&o.material&&(a.material=NA(a.material,l=>{if(typeof l!="string")for(let[c,h]of Object.entries(o.material.layers)){let u=l.layers.data(c);u&&Jo.patch(u,h)}}).data),a.materials&&o.materials&&(a.materials=NA(a.materials,l=>{var c,h;for(let u=0;u<a.materials.length;u++){let d=o.materials[u];if(typeof d!="string")for(let[f,p]of Object.entries(d.layers)){let v=(h=(c=l[u])==null?void 0:c.layers)==null?void 0:h.data(f);v&&Jo.patch(v,p)}}}).data),a}function i(s,o){let a,l=[],c={orthographic:0,perspective:0,geometry:0};function h(u,d){for(let[f,p]of Object.entries(d.layers)){let{texture:v,...g}=p;if(v!==void 0&&Object.keys(v).length>0){let m={path:[...u,"layers",f,"texture"],props:v,type:0};l.push(m)}if(Object.keys(g).length>0){let m={path:[...u,"layers",f],props:g,type:0};l.push(m)}}}for(let[u,d]of Object.entries(o))if(u!=="name")if(u==="cloner")l.push(...$L.toOps(d,["cloner"]));else if(u==="pathSnapping")l.push({path:[u],props:{slide:d.slide,offset:d.offset},type:0});else if(u==="material")h(["material"],d);else if(u==="materials")for(let[f,p]of Object.entries(d))h(["materials",f],p);else if(c[u]===0){if(u==="geometry"&&d.extrusion!==void 0){let f={path:[u,"extrusion"],props:d.extrusion,type:0};l.push(f),d={...d},delete d.extrusion}if(Object.keys(d).length>0){let f={path:[u],props:d,type:0};l.push(f)}}else a===void 0&&(a={path:[],props:{},type:0},l.push(a)),a.props[u]=d;return l}t.toOps=i;function r(s,o){var l,c,h,u,d,f;if(o===void 0)return s;let a={...s};if(Object.assign(a,jg.merge(a,o)),Object.assign(a,{pathSnapping:Object.assign({},a.pathSnapping,{slide:((l=o.pathSnapping)==null?void 0:l.slide)??((c=a.pathSnapping)==null?void 0:c.slide)??0,offset:((h=o.pathSnapping)==null?void 0:h.offset)??((u=a.pathSnapping)==null?void 0:u.offset)??0})}),Of.is(s.type)){a.orthographic={...a.orthographic},a.perspective={...a.perspective};let p=o;((d=p.orthographic)==null?void 0:d.zoom)!==void 0&&(a.orthographic.zoom=p.orthographic.zoom),((f=p.perspective)==null?void 0:f.zoom)!==void 0&&(a.perspective.zoom=p.perspective.zoom),p.isUpVectorFlipped!==void 0&&(a.isUpVectorFlipped=p.isUpVectorFlipped),p.targetOffset!==void 0&&(a.targetOffset=p.targetOffset)}else if(s.type==="Mesh")"geometry"in o&&Object.assign(a,{geometry:oI.merge(a.geometry,o.geometry)}),(o.material||o.materials)&&(a=n(a,o)),a.cloner&&"cloner"in o&&Object.assign(a,{cloner:dh.merge(a.cloner,o.cloner)});else if(s.type==="Empty")a.cloner&&"cloner"in o&&Object.assign(a,{cloner:dh.merge(a.cloner,o.cloner)});else if(eI.is(s.type)){let p=o;p.intensity!==void 0&&(a.intensity=p.intensity),p.color!==void 0&&(typeof p.color=="string"?a.color=p.color:a.color=no.clone(p.color))}return a}t.patch=r})(tf||(tf={}));var qA;(t=>t.defaultData={enabled:!1,useBackgroundColor:!1,color:no.white,near:.1,far:2e3})(qA||(qA={}));var QA;(t=>t.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0,autoZoom:!1})(QA||(QA={}));var Xg;(t=>t.defaultData={orbitControls:QA.defaultData,playCamera:null,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1}},stopRaycast:!0,joystickSizeAndXYOffset:Array(12).fill(0).map((e,n)=>{let i=0,r=0;return n<5?r=-30:n<10&&(r=30),n===0||n===10||n===5?i=30:(n===4||n===11||n===9)&&(i=-30),[120,[i,r],"show"]}),gameControlObject:null})(Xg||(Xg={}));function Ff(t,e){return Object.setPrototypeOf(t,e),t}var jRe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes(" electron/"),WRe=()=>typeof window>"u"?!1:window.navigator.platform.toUpperCase().includes("MAC"),XRe=()=>typeof window>"u"?!1:/iPad|iPhone|iPod/.test(window.navigator.userAgent)||AE&&"ontouchend"in document,YRe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,qRe=()=>typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0,QRe=()=>{if(typeof window>"u")return!1;let t=navigator.userAgent,e=navigator.vendor;return/Safari/i.test(t)&&/Apple Computer/.test(e)},KRe=()=>{if(typeof window>"u")return null;let t=navigator.userAgent.match(/Version\/(\d+\.\d)/);return t&&t[1]};jRe();var AE=WRe(),cI=XRe(),JRe=YRe(),co=qRe(),Q5=QRe(),K5=Number(KRe());function oJ(t){return Array.isArray(t)?t:[t]}function ZRe(t,e){let n=0;for(;n<t.length&&n<e.length;){if(t[n]<e[n])return-1;if(t[n]>e[n])return 1;n+=1}return n!==e.length?-1:n!==t.length?1:0}function _S(t){return AE?t.metaKey:t.ctrlKey}var Nt=[],KA={},$0={},Eb={};function aJ(t){Nt.includes(t)||Nt.push(t)}function cg(t){delete KA[t.pointerId];for(let e=0;e<Nt.length;e++)if(Nt[e].pointerId===t.pointerId){Nt.splice(e,1);break}}function $Re(){Nt.splice(0,Nt.length)}function JA(t){if(t.pointerType!=="touch")return;let e=KA[t.pointerId];e===void 0&&(e={x:0,y:0},KA[t.pointerId]=e),e.x=t.pageX,e.y=t.pageY}function p2(t){let e=t.pointerId===Nt[0].pointerId?Nt[1]:Nt[0];return KA[e.pointerId]}function lJ(t){$0[t.key]=!0,Eb[t.key]=Eb[t.key]===void 0?1:Eb[t.key]+1}function cJ(t){if(AE&&$0.Meta)for(let e in $0)$0[e]=!1;else $0[t.key]=!1;Eb={}}function eLe(t){t.addEventListener("pointerdown",aJ,!0),t.addEventListener("pointerdown",JA,!0),t.addEventListener("pointermove",JA,!0),t.addEventListener("pointerup",cg,!0),t.addEventListener("pointercancel",cg,!0),t.addEventListener("pointerleave",cg,!0),window.addEventListener("keydown",lJ,!0),window.addEventListener("keyup",cJ,!0)}function tLe(t){t.removeEventListener("pointerdown",aJ,!0),t.removeEventListener("pointerdown",JA,!0),t.removeEventListener("pointermove",JA,!0),t.removeEventListener("pointerup",cg,!0),t.removeEventListener("pointercancel",cg,!0),t.removeEventListener("pointerleave",cg,!0),window.removeEventListener("keydown",lJ,!0),window.removeEventListener("keyup",cJ,!0)}var eo;(t=>t.defaultData={ambientLight:{enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75,depth:100,groundColor:{r:.5098039215686274,g:.5098039215686274,b:.5098039215686274},softShadows:!0,softShadowQuality:"low"},usePhysics:!1,gravity:-10,pixelsPerMeter:200,skinWidthRelative:.02,stepThreshRelative:.3,slopeThresh:65})(eo||(eo={}));var uI;(t=>{t.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222";function e(r={withLight:!0,withSquare:!0}){let s=new Fs,o=lI.defaultMeshObject;return r.withLight===!0&&s.push({fi:-1,data:{...aI.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7},id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]}),r.withSquare===!0&&s.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:o,children:[]}),s}t.defaultData={backgroundColor:Ua.fromHexAndA(2960946,1),postprocessing:Ox.defaultData,fog:qA.defaultData,objects:e(),environment:eo.defaultData,publish:Xg.defaultData},t.emptyData=function(r){return{backgroundColor:Ua.fromHexAndA(2960946,1),postprocessing:Ox.defaultData,fog:qA.defaultData,objects:r?e(r):new Fs,environment:eo.defaultData,publish:Xg.defaultData}};function n(r){return{...t.defaultData,objects:Ff(r,Fs.prototype)}}t.withObjs=n;function i(r,s){return n([{id:r,data:s,children:[],fi:0}])}t.withObj=i})(uI||(uI={}));var ZA;(t=>t.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII="})(ZA||(ZA={}));var $A;(t=>{function e(){let r={};return r["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},Ff(r,Ui.prototype)}t.defaultColors=e;function n(r){let s={};return r!=null&&r.withAITexture&&(s["a1b10010-844c-a8a3-11ec-0242ac2011ec"]={...ZA.emptyImage,name:"AI generated image"}),Ff(s,Ui.prototype)}t.defaultImages=n;function i(){return{materials:new Ui,images:new Ui,videos:new Ui,colors:new Ui,audios:new Ui,fonts:new Ui,penumbraSize:[2,2,2]}}t.emptyData=i})($A||($A={}));function J5(t){t.layers.forEach(e=>{if(e.type==="depth"&&e.colorA!==void 0){let n=e.colorA,i=e.colorB,r=[[n.r,n.g,n.b,n.a],[i.r,i.g,i.b,i.a]],s=[0,1];for(let a=2;a<10;a++)r.push(r[1]),s.push(1);let o={...Rx(qr(e),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,e.near),far:Math.max(0,e.far),colors:r,steps:s,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(e,o)}else if(e.type==="depth"&&e.gradientType===1&&(e.near<0||e.far<0)){let n={...qr(e),near:Math.max(e.near,0),far:Math.max(e.far,0)};Object.assign(e,n)}})}function Cb(t,e){Object.values(t.shared.materials).forEach(n=>e(n))}function Tb(t,e){t.scene.objects.traverse((n,i)=>{"materials"in i?i.materials.forEach(r=>{typeof r!="string"&&e(r)}):"material"in i&&typeof i.material!="string"&&e(i.material)})}function nLe(t){Object.assign(t.scene.publish,{orbitControls:{...QA.defaultData,...qr(t.scene.publish.orbitControls)}})}function iLe(t){Object.assign(t.scene.publish.settings,{video:{...Xg.defaultData.settings.video,...qr(t.scene.publish.settings.video)}})}function rLe(t){function e(n){if(n.layers){for(let i of Object.values(n.layers))if(i){for(let[r,s]of Object.entries(i))if((nJ.includes(r)||typeof s=="boolean")&&delete i[r],r==="texture")for(let[o,a]of Object.entries(s))(VRe.includes(o)||typeof a=="boolean")&&delete s[o]}}}t.scene.objects.traverse((n,i)=>{i.states.forEach(r=>{let s=r;s.material?e(s.material):s.materials&&s.materials.forEach(o=>{e(o)})})})}function sLe(t){t.scene.publish.withBackground=!0}function oLe(t){t.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function aLe(t){t.scene.objects.traverse((e,n)=>{let i=n.cloner;i&&(i.radial.scale=i.radial.scale.map(r=>r+1),i.linear.scale=i.linear.scale.map(r=>r+1))})}function lLe(t){t.scene.objects.traverse((e,n)=>{let i=n.geometry;i&&(i.type==="DodecahedronGeometry"||i.type==="IcosahedronGeometry")&&(i.detail=Math.round(i.detail))})}function cLe(t){t.scene.objects.traverse((e,n)=>{let i=t.scene.objects.unproxy().parent(e);if(i){let r=qr(t.scene.objects.data(i));r&&r.type==="Mesh"&&r.geometry.type==="BooleanGeometry"&&n.type==="Mesh"&&(n.visible=qr(n).booleanExclude!==!0)}})}function uLe(t){t.scene.objects.traverse((e,n)=>{if(n.type==="Mesh"){let i=n;n.geometry.type==="NonParametricGeometry"?i.material!==void 0&&delete i.material:i.materials!==void 0&&delete i.materials}})}function hLe(t){function e(i){Object.setPrototypeOf(i,Lr.prototype),i.texture&&Object.setPrototypeOf(i.texture,Lr.prototype)}function n(i){Object.setPrototypeOf(i,Lr.prototype);for(let r in i)e(i[r])}t.scene.objects.traverse((i,r)=>{r.states.forEach(s=>{let o=s;if(o.material){let a=qr(o.material).layers;n(a),o.material.layers=a}if(o.materials)for(let a=0;a<o.materials.length;a++){let l=o.materials[a],c=qr(l).layers;n(c),l.layers=c}})})}function Z5(t){t.layers===void 0&&Object.assign(t,vo.defaultTwoLayerData("lambert"))}function m2(t){!t.layers||t.layers.forEach(e=>{if(e.type==="depth"&&e.colors.length===10){let n=[...e.colors];n.push(e.colors[9]);let i=[...e.steps];i.push(e.steps[9]);let r={...qr(e),colors:n,steps:i};Object.assign(e,r)}})}function dLe(t){t.scene.objects.traverse((e,n)=>{n.type==="Mesh"&&(n.geometry.type==="BooleanGeometry"||n.geometry.type==="SubdivGeometry")&&(n.geometry.phongAngle=35)})}function $5(t){t.scene.objects.traverse((e,n)=>{"materials"in n?n.materials.forEach(i=>{typeof i!="string"&&m2(i)}):"material"in n&&typeof n.material!="string"&&m2(n.material)}),Object.values(t.shared.materials).forEach(e=>m2(e))}function fLe(t){t.scene.environment.ambientLight.softShadows=!1,t.scene.environment.ambientLight.softShadowQuality="low",t.scene.objects.traverse((e,n)=>{(n.type==="DirectionalLight"||n.type==="SpotLight")&&(n.shadowResolution=1024,n.shadowRadius=1,n.depth=1e5)}),t.shared.penumbraSize=new Array(5).fill(.5)}function pLe(t){t.shared.audios=Ff({},Ui.prototype)}function mLe(t){t.shared.videos=Ff({},Ui.prototype)}function gLe(t){let e=t.shared.materials;Object.entries(e).forEach(([n,i])=>{if(!i.layers){let r={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(e,{[n]:r})}})}function vLe(t){Object.entries(qr(t.shared.images)).filter(e=>e[1].asset===!1).map(e=>e[0]).forEach(e=>{delete t.shared.images[e]}),Object.entries(qr(t.shared.audios)).filter(e=>e[1].asset===!1).map(e=>e[0]).forEach(e=>{delete t.shared.audios[e]})}function yLe(t){t.scene.publish.settings.web.preload=!1}function ej(t){t.layers&&t.layers.forEach(e=>{e.type==="depth"&&e.num!==void 0&&(e.colors=e.colors.slice(0,e.num),e.steps=e.steps.slice(0,e.num),delete e.num)})}function xLe(t){t.shared.fonts=Ff({},Ui.prototype)}function _Le(t){return t.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function wLe(t){let e=[];t.scene.objects.traverse((n,i)=>{let r=i;if(r.type==="TextFrame"){let s=vo.defaultTwoLayerData("phong"),o=typeof r.color=="string"?t.shared.colors[r.color]:r.color;s.layers[1].data.color={r:o.r,g:o.g,b:o.b},s.layers[1].data.alpha=r.alpha;let a=_Le(r.font);t.shared.fonts[a]===void 0&&(t.shared.fonts[a]={name:a});let l={name:r.name,...ra.defaultData,...lg.defaultData,flatShading:!1,wireframe:!1,geometry:{...ag.defaultData("TextGeometry"),width:r.width,height:r.height,font:a,depth:0,horizontalAlign:r.horizontalAlign,verticalAlign:r.verticalAlign,fontSize:r.fontSize*1.40625,lineHeight:r.lineHeight/1.40625,letterSpacing:r.letterSpacing-1,text:r.text,textTransform:r.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:s,states:qr(r.states),events:qr(r.events),visible:r.visible,raycastLock:r.raycastLock,position:r.position,rotation:r.rotation,scale:r.scale,hiddenMatrix:r.hiddenMatrix},c=qr(t.scene.objects).parent(n);t.scene.objects.insertAfter(c??null,n,[{id:n+"new",data:l,children:[]}]),e.push(n)}}),e.forEach(n=>{t.scene.objects.delete(n)})}function SLe(t){let e={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};t.scene.objects.traverse((n,i)=>{i.events.forEach(r=>{if(e[Number(r.type)])if(Object.assign(r,{type:e[Number(r.type)]}),r.type==="Audio"&&"audioEvent"in r&&(Object.assign(r,{playAudio:r.audioEvent}),delete r.audioEvent),r.type==="GameControl")Object.assign(r,{gameActions:{idle:new $t,move:new $t,jump:new $t}});else{let s=new $t;Object.assign(r,{actions:s}),(r.type==="MouseDown"||r.type==="MouseUp"||r.type==="KeyDown"||r.type==="KeyUp")&&"url"in r&&s.push({fi:0,id:sn.generateUUID(),data:{type:"Link",url:r.url,delay:0}}),"targets"in r&&(r.targets.forEach((o,a,l)=>{let c={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},h={easing:o.easing,duration:o.duration};o.easing===6?Object.assign(h,Rx(o,"mass","stiffness","damping","velocity")):o.easing===5&&Object.assign(h,{control1:{...o.control1},control2:{...o.control2}});let u={repeat:o.repeat?-1:0,delay:o.delay,delayDirection:o.delayDirection,direction:o.cycle&&o.rewind?"pingpong-rewind":o.cycle?"pingpong":"normal"},d={state:o.state,...u,...h},f={allowSlerp:!0,type:"Transition",object:o.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new $t({fi:0,id:sn.generateUUID(),data:c},{fi:1,id:sn.generateUUID(),data:d})};s.push({fi:l,id:a,data:f})}),delete r.targets)}})})}function bLe(t){t.scene.objects.traverse((e,n)=>{function i(r,s){var l;let o=new $t,a=[];if(n.events.forEach((c,h,u)=>{if(c.type==="Audio"&&c.trigger===s){let d;a.push(h),c.interaction==="play"?d={...Rx(c,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in c?c.after:void 0,toggle:"after"in c?c.toggle:void 0,type:"Audio"}:(c.interaction==="pause"||c.interaction==="stop")&&(d={...Rx(c,"interaction","delay","object","playAudio"),type:"Audio"}),d&&o.push({fi:u,id:h,data:d})}}),a.forEach(c=>n.events.delete(c)),o.length){let c=(l=n.events.find(h=>h.type===r))==null?void 0:l.data;c?"actions"in c&&c.actions.insertBefore(null,o):n.events.insertBefore(null,[{id:sn.generateUUID(),data:{type:r,actions:o}}])}}i("Start","start"),i("MouseDown","mouseDown"),i("MouseUp","mouseUp"),i("KeyDown","keyDown"),i("KeyUp","keyUp")})}function tj(t){var n;let e=(n=t.layers.find(i=>i.type==="light"))==null?void 0:n.data;if((e==null?void 0:e.category)==="basic"){let i=Jo.defaultData("light","phong"),r=e;Object.assign(r,i),r.visible=!1}}function nj(t){Cb(t,tj),Tb(t,tj)}function ALe(t){t.scene.objects.traverse((e,n)=>{n.type==="Mesh"&&n.geometry.type==="SubdivGeometry"&&(n.geometry.scaleBaked||(n.geometry.scaleBaked=[1,1,1]))})}function MLe(t){t.scene.objects.traverse((e,n)=>{(n.type==="Empty"||n.type==="Mesh")&&n.cloner&&!n.cloner.randomnessObject&&!n.cloner.toObject&&!n.cloner.randomness&&(n.cloner={...n.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function ELe(t){t.scene.objects.traverse((e,n)=>{n.type==="Mesh"&&n.geometry.type==="NonParametricGeometry"&&!("material"in n)&&!("materials"in n)&&(n.material=vo.defaultTwoLayerData("phong"))})}function CLe(t){t.scene.publish.orbitControls.autoZoom===void 0&&(t.scene.publish.orbitControls.autoZoom=!1),t.scene.objects.traverse((e,n)=>{(n.type==="OrthographicCamera"||n.type==="PerspectiveCamera")&&(n.orthographic.autoZoom===void 0&&(n.orthographic.autoZoom=!1),n.orthographic.autoZoomFrustumSize===void 0&&(n.orthographic.autoZoomFrustumSize=790))})}function TLe(t){t.scene.objects.traverse((e,n)=>{n.pathSnapping===void 0&&(n.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),n.pathSnapping.offset===void 0&&(n.pathSnapping.offset=0)})}function PLe(t){t.scene.publish.mouseEventTarget===void 0&&(t.scene.publish.mouseEventTarget="canvas"),t.scene.publish.settings.web.hint===void 0&&(t.scene.publish.settings.web.hint=!1)}function DLe(t){let{video:e}=t.scene.publish.settings;e.format==="gif"&&e.fps>48&&(e.fps=15)}function RLe(t){t.scene.objects.traverse((e,n)=>{n.events.forEach(i=>{i.type==="GameControl"&&(i.resetYPosition=Math.abs(i.resetYPosition-n.position[1]))})})}function LLe(t){let e=t.scene.environment.usePhysics;t.scene.objects.traverse((n,i)=>{e&&i.physics===null?i.collision=!1:i.collision="visibility"})}var ij=37;function ILe(t){let e=t.schema??0;e!==ij&&(console.warn("updating from ",e,"to ",ij),e<1&&(Tb(t,J5),Cb(t,J5),t.schema=1),e<2&&(nLe(t),t.schema=2),e<3&&(rLe(t),t.schema=3),e<4&&(sLe(t),t.schema=4),e<5&&(oLe(t),t.schema=5),e<6&&(aLe(t),t.schema=6),e<7&&(lLe(t),t.schema=7),e<8&&(t.schema=8),e<9&&($5(t),t.schema=9),e<10&&(dLe(t),t.schema=10),e<11&&(fLe(t),t.schema=11),e<12&&($5(t),t.schema=12),e<13&&(pLe(t),t.schema=13),e<14&&(gLe(t),t.schema=14),e<15&&(vLe(t),t.schema=15),e<16&&(yLe(t),t.schema=16),e<17&&(Tb(t,ej),Cb(t,ej),t.schema=17),e<18&&(Tb(t,Z5),Cb(t,Z5),t.schema=18),e<19&&(iLe(t),t.schema=19),e<20&&(xLe(t),wLe(t),t.schema=20),e<21&&(SLe(t),bLe(t),t.schema=21),e<22&&(nj(t),t.schema=22),e<23&&(ALe(t),t.schema=23),e<24&&(MLe(t),t.schema=24),(e<25||t.shared.videos===void 0)&&(mLe(t),e<25&&(t.schema=25)),e<26&&(cLe(t),t.schema=26),e<27&&(uLe(t),t.schema=27),e<28&&(nj(t),t.schema=28),e<29&&(hLe(t),t.schema=29),e<30&&(ELe(t),t.schema=30),e<31&&(CLe(t),t.schema=31),e<33&&(TLe(t),t.schema=33),e<34&&(PLe(t),t.schema=34),e<35&&(DLe(t),t.schema=35),e<36&&(RLe(t),t.schema=36),e<37&&(LLe(t),t.schema=37))}function Hm(t,e=!1){let n=t[0].index!==null,i=new Set(Object.keys(t[0].attributes)),r=new Set(Object.keys(t[0].morphAttributes)),s={},o={},a=t[0].morphTargetsRelative,l=new Lt,c=0;for(let h=0;h<t.length;++h){let u=t[h],d=0;if(n!==(u.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let f in u.attributes){if(!i.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+'. All geometries must have compatible attributes; make sure "'+f+'" attribute exists among all geometries, or in none of them.'),null;s[f]===void 0&&(s[f]=[]),s[f].push(u.attributes[f]),d++}if(d!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". Make sure all geometries have the same number of attributes."),null;if(a!==u.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let f in u.morphAttributes){if(!r.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+".  .morphAttributes must be consistent throughout all geometries."),null;o[f]===void 0&&(o[f]=[]),o[f].push(u.morphAttributes[f])}if(e){let f;if(n)f=u.index.count;else if(u.attributes.position!==void 0)f=u.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+h+". The geometry must have either an index or a position attribute"),null;l.addGroup(c,f,h),c+=f}}if(n){let h=0,u=[];for(let d=0;d<t.length;++d){let f=t[d].index;for(let p=0;p<f.count;++p)u.push(f.getX(p)+h);h+=t[d].attributes.position.count}l.setIndex(u)}for(let h in s){let u=rj(s[h]);if(!u)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" attribute."),null;l.setAttribute(h,u)}for(let h in o){let u=o[h][0].length;if(u===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[h]=[];for(let d=0;d<u;++d){let f=[];for(let v=0;v<o[h].length;++v)f.push(o[h][v][d]);let p=rj(f);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+h+" morphAttribute."),null;l.morphAttributes[h].push(p)}}return l}function rj(t){let e,n,i,r=0;for(let a=0;a<t.length;++a){let l=t[a];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(e===void 0&&(e=l.array.constructor),e!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(n===void 0&&(n=l.itemSize),n!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=l.normalized),i!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;r+=l.array.length}let s=new e(r),o=0;for(let a=0;a<t.length;++a)s.set(t[a].array,o),o+=t[a].array.length;return new Ut(s,n,i)}var hI;(t=>(t.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},t.defaultDataThirdPerson={moveMode:"walk",speedTranslate:1e3,speedRotate:100,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX",""],["rotPosY",""],["rotNegX",""],["rotNegY",""],["jump","Space"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:t.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new $t,move:new $t,jump:new $t}}))(hI||(hI={}));var BLe=Math.pow(2,-24),wS=class{constructor(){}};function Bl(t,e,n){return n.min.x=e[t],n.min.y=e[t+1],n.min.z=e[t+2],n.max.x=e[t+3],n.max.y=e[t+4],n.max.z=e[t+5],n}function sj(t){let e=-1,n=-1/0;for(let i=0;i<3;i++){let r=t[i+3]-t[i];r>n&&(n=r,e=i)}return e}function oj(t,e){e.set(t)}function aj(t,e,n){let i,r;for(let s=0;s<3;s++){let o=s+3;i=t[s],r=e[s],n[s]=i<r?i:r,i=t[o],r=e[o],n[o]=i>r?i:r}}function SS(t,e,n){for(let i=0;i<3;i++){let r=e[t+2*i],s=e[t+2*i+1],o=r-s,a=r+s;o<n[i]&&(n[i]=o),a>n[i+3]&&(n[i+3]=a)}}function A0(t){let e=t[3]-t[0],n=t[4]-t[1],i=t[5]-t[2];return 2*(e*n+n*i+i*e)}function OLe(t,e){if(!t.index){let n=t.attributes.position.count,i=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,r;n>65535?r=new Uint32Array(new i(4*n)):r=new Uint16Array(new i(2*n)),t.setIndex(new Ut(r,1));for(let s=0;s<n;s++)r[s]=s}}function FLe(t){if(!t.groups||!t.groups.length)return[{offset:0,count:t.index.count/3}];let e=[],n=new Set;for(let r of t.groups)n.add(r.start),n.add(r.start+r.count);let i=Array.from(n.values()).sort((r,s)=>r-s);for(let r=0;r<i.length-1;r++){let s=i[r],o=i[r+1];e.push({offset:s/3,count:(o-s)/3})}return e}function g2(t,e,n,i,r=null){let s=1/0,o=1/0,a=1/0,l=-1/0,c=-1/0,h=-1/0,u=1/0,d=1/0,f=1/0,p=-1/0,v=-1/0,g=-1/0,m=r!==null;for(let y=e*6,_=(e+n)*6;y<_;y+=6){let S=t[y+0],A=t[y+1],b=S-A,T=S+A;b<s&&(s=b),T>l&&(l=T),m&&S<u&&(u=S),m&&S>p&&(p=S);let M=t[y+2],E=t[y+3],P=M-E,R=M+E;P<o&&(o=P),R>c&&(c=R),m&&M<d&&(d=M),m&&M>v&&(v=M);let F=t[y+4],B=t[y+5],k=F-B,j=F+B;k<a&&(a=k),j>h&&(h=j),m&&F<f&&(f=F),m&&F>g&&(g=F)}i[0]=s,i[1]=o,i[2]=a,i[3]=l,i[4]=c,i[5]=h,m&&(r[0]=u,r[1]=d,r[2]=f,r[3]=p,r[4]=v,r[5]=g)}function NLe(t,e,n,i){let r=1/0,s=1/0,o=1/0,a=-1/0,l=-1/0,c=-1/0;for(let h=e*6,u=(e+n)*6;h<u;h+=6){let d=t[h+0];d<r&&(r=d),d>a&&(a=d);let f=t[h+2];f<s&&(s=f),f>l&&(l=f);let p=t[h+4];p<o&&(o=p),p>c&&(c=p)}i[0]=r,i[1]=s,i[2]=o,i[3]=a,i[4]=l,i[5]=c}function ULe(t,e,n,i,r){let s=n,o=n+i-1,a=r.pos,l=r.axis*2;for(;;){for(;s<=o&&e[s*6+l]<a;)s++;for(;s<=o&&e[o*6+l]>=a;)o--;if(s<o){for(let c=0;c<3;c++){let h=t[s*3+c];t[s*3+c]=t[o*3+c],t[o*3+c]=h;let u=e[s*6+c*2+0];e[s*6+c*2+0]=e[o*6+c*2+0],e[o*6+c*2+0]=u;let d=e[s*6+c*2+1];e[s*6+c*2+1]=e[o*6+c*2+1],e[o*6+c*2+1]=d}s++,o--}else return s}}var Dc=32,kLe=(t,e)=>t.candidate-e.candidate,Fu=new Array(Dc).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),bS=new Float32Array(6);function zLe(t,e,n,i,r,s){let o=-1,a=0;if(s===0)o=sj(e),o!==-1&&(a=(e[o]+e[o+3])/2);else if(s===1)o=sj(t),o!==-1&&(a=GLe(n,i,r,o));else if(s===2){let l=A0(t),c=1.25*r,h=i*6,u=(i+r)*6;for(let d=0;d<3;d++){let f=e[d],p=(e[d+3]-f)/Dc;if(r<Dc/4){let v=[...Fu];v.length=r;let g=0;for(let y=h;y<u;y+=6,g++){let _=v[g];_.candidate=n[y+2*d],_.count=0;let{bounds:S,leftCacheBounds:A,rightCacheBounds:b}=_;for(let T=0;T<3;T++)b[T]=1/0,b[T+3]=-1/0,A[T]=1/0,A[T+3]=-1/0,S[T]=1/0,S[T+3]=-1/0;SS(y,n,S)}v.sort(kLe);let m=r;for(let y=0;y<m;y++){let _=v[y];for(;y+1<m&&v[y+1].candidate===_.candidate;)v.splice(y+1,1),m--}for(let y=h;y<u;y+=6){let _=n[y+2*d];for(let S=0;S<m;S++){let A=v[S];_>=A.candidate?SS(y,n,A.rightCacheBounds):(SS(y,n,A.leftCacheBounds),A.count++)}}for(let y=0;y<m;y++){let _=v[y],S=_.count,A=r-_.count,b=_.leftCacheBounds,T=_.rightCacheBounds,M=0;S!==0&&(M=A0(b)/l);let E=0;A!==0&&(E=A0(T)/l);let P=1+1.25*(M*S+E*A);P<c&&(o=d,c=P,a=_.candidate)}}else{for(let m=0;m<Dc;m++){let y=Fu[m];y.count=0,y.candidate=f+p+m*p;let _=y.bounds;for(let S=0;S<3;S++)_[S]=1/0,_[S+3]=-1/0}for(let m=h;m<u;m+=6){let y=~~((n[m+2*d]-f)/p);y>=Dc&&(y=Dc-1);let _=Fu[y];_.count++,SS(m,n,_.bounds)}let v=Fu[Dc-1];oj(v.bounds,v.rightCacheBounds);for(let m=Dc-2;m>=0;m--){let y=Fu[m],_=Fu[m+1];aj(y.bounds,_.rightCacheBounds,y.rightCacheBounds)}let g=0;for(let m=0;m<Dc-1;m++){let y=Fu[m],_=y.count,S=y.bounds,A=Fu[m+1].rightCacheBounds;_!==0&&(g===0?oj(S,bS):aj(S,bS,bS)),g+=_;let b=0,T=0;g!==0&&(b=A0(bS)/l);let M=r-g;M!==0&&(T=A0(A)/l);let E=1+1.25*(b*g+T*M);E<c&&(o=d,c=E,a=y.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${s} used.`);return{axis:o,pos:a}}function GLe(t,e,n,i){let r=0;for(let s=e,o=e+n;s<o;s++)r+=t[s*6+i*2];return r/n}function HLe(t,e){let n=t.attributes.position,i=n.array,r=t.index.array,s=r.length/3,o=new Float32Array(s*6),a=n.offset||0,l=3;n.isInterleavedBufferAttribute&&(l=n.data.stride);for(let c=0;c<s;c++){let h=c*3,u=c*6,d=r[h+0]*l+a,f=r[h+1]*l+a,p=r[h+2]*l+a;for(let v=0;v<3;v++){let g=i[d+v],m=i[f+v],y=i[p+v],_=g;m<_&&(_=m),y<_&&(_=y);let S=g;m>S&&(S=m),y>S&&(S=y);let A=(S-_)/2,b=v*2;o[u+b+0]=_+A,o[u+b+1]=A+(Math.abs(_)+A)*BLe,_<e[v]&&(e[v]=_),S>e[v+3]&&(e[v+3]=S)}}return o}function VLe(t,e){function n(m){d&&d(m/f)}function i(m,y,_,S=null,A=0){if(!p&&A>=l&&(p=!0,c&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(t))),_<=h||A>=l)return n(y+_),m.offset=y,m.count=_,m;let b=zLe(m.boundingData,S,o,y,_,u);if(b.axis===-1)return n(y+_),m.offset=y,m.count=_,m;let T=ULe(a,o,y,_,b);if(T===y||T===y+_)n(y+_),m.offset=y,m.count=_;else{m.splitAxis=b.axis;let M=new wS,E=y,P=T-y;m.left=M,M.boundingData=new Float32Array(6),g2(o,E,P,M.boundingData,s),i(M,E,P,s,A+1);let R=new wS,F=T,B=_-P;m.right=R,R.boundingData=new Float32Array(6),g2(o,F,B,R.boundingData,s),i(R,F,B,s,A+1)}return m}OLe(t,e);let r=new Float32Array(6),s=new Float32Array(6),o=HLe(t,r),a=t.index.array,l=e.maxDepth,c=e.verbose,h=e.maxLeafTris,u=e.strategy,d=e.onProgress,f=t.index.count/3,p=!1,v=[],g=FLe(t);if(g.length===1){let m=g[0],y=new wS;y.boundingData=r,NLe(o,m.offset,m.count,s),i(y,m.offset,m.count,s),v.push(y)}else for(let m of g){let y=new wS;y.boundingData=new Float32Array(6),g2(o,m.offset,m.count,y.boundingData,s),i(y,m.offset,m.count,s),v.push(y)}return v}function jLe(t,e){let n=VLe(t,e),i,r,s,o=[],a=e.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let h=0;h<n.length;h++){let u=n[h],d=l(u),f=new a(32*d);i=new Float32Array(f),r=new Uint32Array(f),s=new Uint16Array(f),c(0,u),o.push(f)}return o;function l(h){return h.count?1:1+l(h.left)+l(h.right)}function c(h,u){let d=h/4,f=h/2,p=!!u.count,v=u.boundingData;for(let g=0;g<6;g++)i[d+g]=v[g];if(p){let g=u.offset,m=u.count;return r[d+6]=g,s[f+14]=m,s[f+15]=65535,h+32}else{let g=u.left,m=u.right,y=u.splitAxis,_;if(_=c(h+32,g),_/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return r[d+6]=_/4,_=c(_,m),r[d+7]=y,_}}}var ou=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(t,e){let n=1/0,i=-1/0;for(let r=0,s=t.length;r<s;r++){let o=t[r][e];n=o<n?o:n,i=o>i?o:i}this.min=n,this.max=i}setFromPoints(t,e){let n=1/0,i=-1/0;for(let r=0,s=e.length;r<s;r++){let o=e[r],a=t.dot(o);n=a<n?a:n,i=a>i?a:i}this.min=n,this.max=i}isSeparated(t){return this.min>t.max||t.min>this.max}};ou.prototype.setFromBox=function(){let t=new N;return function(e,n){let i=n.min,r=n.max,s=1/0,o=-1/0;for(let a=0;a<=1;a++)for(let l=0;l<=1;l++)for(let c=0;c<=1;c++){t.x=i.x*a+r.x*(1-a),t.y=i.y*l+r.y*(1-l),t.z=i.z*c+r.z*(1-c);let h=e.dot(t);s=Math.min(h,s),o=Math.max(h,o)}this.min=s,this.max=o}}();var WLe=function(){let t=new N,e=new N,n=new N;return function(i,r,s){let o=i.start,a=t,l=r.start,c=e;n.subVectors(o,l),t.subVectors(i.end,r.start),e.subVectors(r.end,r.start);let h=n.dot(c),u=c.dot(a),d=c.dot(c),f=n.dot(a),p=a.dot(a)*d-u*u,v,g;p!==0?v=(h*u-f*d)/p:v=0,g=(h+v*u)/d,s.x=v,s.y=g}}(),sF=function(){let t=new Se,e=new N,n=new N;return function(i,r,s,o){WLe(i,r,t);let a=t.x,l=t.y;if(a>=0&&a<=1&&l>=0&&l<=1){i.at(a,s),r.at(l,o);return}else if(a>=0&&a<=1){l<0?r.at(0,o):r.at(1,o),i.closestPointToPoint(o,!0,s);return}else if(l>=0&&l<=1){a<0?i.at(0,s):i.at(1,s),r.closestPointToPoint(s,!0,o);return}else{let c;a<0?c=i.start:c=i.end;let h;l<0?h=r.start:h=r.end;let u=e,d=n;if(i.closestPointToPoint(h,!0,e),r.closestPointToPoint(c,!0,n),u.distanceToSquared(h)<=d.distanceToSquared(c)){s.copy(u),o.copy(h);return}else{s.copy(c),o.copy(d);return}}}}(),XLe=function(){let t=new N,e=new N,n=new $s,i=new ia;return function(r,s){let{radius:o,center:a}=r,{a:l,b:c,c:h}=s;if(i.start=l,i.end=c,i.closestPointToPoint(a,!0,t).distanceTo(a)<=o||(i.start=l,i.end=h,i.closestPointToPoint(a,!0,t).distanceTo(a)<=o)||(i.start=c,i.end=h,i.closestPointToPoint(a,!0,t).distanceTo(a)<=o))return!0;let u=s.getPlane(n);if(Math.abs(u.distanceToPoint(a))<=o){let d=u.projectPoint(a,e);if(s.containsPoint(d))return!0}return!1}}(),YLe=1e-15;function Jp(t){return Math.abs(t)<YLe}var au=class extends Cs{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new N),this.satBounds=new Array(4).fill().map(()=>new ou),this.points=[this.a,this.b,this.c],this.sphere=new la,this.plane=new $s,this.needsUpdate=!0}intersectsSphere(e){return XLe(e,this)}update(){let e=this.a,n=this.b,i=this.c,r=this.points,s=this.satAxes,o=this.satBounds,a=s[0],l=o[0];this.getNormal(a),l.setFromPoints(a,r);let c=s[1],h=o[1];c.subVectors(e,n),h.setFromPoints(c,r);let u=s[2],d=o[2];u.subVectors(n,i),d.setFromPoints(u,r);let f=s[3],p=o[3];f.subVectors(i,e),p.setFromPoints(f,r),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,e),this.needsUpdate=!1}};au.prototype.closestPointToSegment=function(){let t=new N,e=new N,n=new ia;return function(i,r=null,s=null){let{start:o,end:a}=i,l=this.points,c,h=1/0;for(let u=0;u<3;u++){let d=(u+1)%3;n.start.copy(l[u]),n.end.copy(l[d]),sF(n,i,t,e),c=t.distanceToSquared(e),c<h&&(h=c,r&&r.copy(t),s&&s.copy(e))}return this.closestPointToPoint(o,t),c=o.distanceToSquared(t),c<h&&(h=c,r&&r.copy(t),s&&s.copy(o)),this.closestPointToPoint(a,t),c=a.distanceToSquared(t),c<h&&(h=c,r&&r.copy(t),s&&s.copy(a)),Math.sqrt(h)}}();au.prototype.intersectsTriangle=function(){let t=new au,e=new Array(3),n=new Array(3),i=new ou,r=new ou,s=new N,o=new N,a=new N,l=new N,c=new ia,h=new ia,u=new ia;return function(d,f=null){this.needsUpdate&&this.update(),d.isExtendedTriangle?d.needsUpdate&&d.update():(t.copy(d),t.update(),d=t);let p=this.plane,v=d.plane;if(Math.abs(p.normal.dot(v.normal))>1-1e-10){let g=this.satBounds,m=this.satAxes;n[0]=d.a,n[1]=d.b,n[2]=d.c;for(let S=0;S<4;S++){let A=g[S],b=m[S];if(i.setFromPoints(b,n),A.isSeparated(i))return!1}let y=d.satBounds,_=d.satAxes;e[0]=this.a,e[1]=this.b,e[2]=this.c;for(let S=0;S<4;S++){let A=y[S],b=_[S];if(i.setFromPoints(b,e),A.isSeparated(i))return!1}for(let S=0;S<4;S++){let A=m[S];for(let b=0;b<4;b++){let T=_[b];if(s.crossVectors(A,T),i.setFromPoints(s,e),r.setFromPoints(s,n),i.isSeparated(r))return!1}}return f&&(console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),f.start.set(0,0,0),f.end.set(0,0,0)),!0}else{let g=this.points,m=!1,y=0;for(let F=0;F<3;F++){let B=g[F],k=g[(F+1)%3];c.start.copy(B),c.end.copy(k),c.delta(o);let j=m?h.start:h.end,Z=Jp(v.distanceToPoint(B));if(Jp(v.normal.dot(o))&&Z){h.copy(c),y=2;break}if((v.intersectLine(c,j)||Z)&&!Jp(j.distanceTo(k))){if(y++,m)break;m=!0}}if(y===1&&this.containsPoint(h.start))return f&&(f.start.copy(h.start),f.end.copy(h.start)),!0;if(y!==2)return!1;let _=d.points,S=!1,A=0;for(let F=0;F<3;F++){let B=_[F],k=_[(F+1)%3];c.start.copy(B),c.end.copy(k),c.delta(a);let j=S?u.start:u.end,Z=Jp(p.distanceToPoint(B));if(Jp(p.normal.dot(a))&&Z){u.copy(c),A=2;break}if((p.intersectLine(c,j)||Z)&&!Jp(j.distanceTo(k))){if(A++,S)break;S=!0}}if(A===1&&this.containsPoint(u.start))return f&&(f.start.copy(u.start),f.end.copy(u.start)),!0;if(A!==2)return!1;if(h.delta(o),u.delta(a),o.dot(a)<0){let F=u.start;u.start=u.end,u.end=F}let b=h.start.dot(o),T=h.end.dot(o),M=u.start.dot(o),E=u.end.dot(o),P=T<M,R=b<E;return b!==E&&M!==T&&P===R?!1:(f&&(l.subVectors(h.start,u.start),l.dot(o)>0?f.start.copy(h.start):f.start.copy(u.start),l.subVectors(h.end,u.end),l.dot(o)<0?f.end.copy(h.end):f.end.copy(u.end)),!0)}}}();au.prototype.distanceToPoint=function(){let t=new N;return function(e){return this.closestPointToPoint(e,t),e.distanceTo(t)}}();au.prototype.distanceToTriangle=function(){let t=new N,e=new N,n=["a","b","c"],i=new ia,r=new ia;return function(s,o=null,a=null){let l=o||a?i:null;if(this.intersectsTriangle(s,l))return(o||a)&&(o&&l.getCenter(o),a&&l.getCenter(a)),0;let c=1/0;for(let h=0;h<3;h++){let u,d=n[h],f=s[d];this.closestPointToPoint(f,t),u=f.distanceToSquared(t),u<c&&(c=u,o&&o.copy(t),a&&a.copy(f));let p=this[d];s.closestPointToPoint(p,t),u=p.distanceToSquared(t),u<c&&(c=u,o&&o.copy(p),a&&a.copy(t))}for(let h=0;h<3;h++){let u=n[h],d=n[(h+1)%3];i.set(this[u],this[d]);for(let f=0;f<3;f++){let p=n[f],v=n[(f+1)%3];r.set(s[p],s[v]),sF(i,r,t,e);let g=t.distanceToSquared(e);g<c&&(c=g,o&&o.copy(t),a&&a.copy(e))}}return Math.sqrt(c)}}();var ec=class extends Vi{constructor(...e){super(...e),this.isOrientedBox=!0,this.matrix=new nt,this.invMatrix=new nt,this.points=new Array(8).fill().map(()=>new N),this.satAxes=new Array(3).fill().map(()=>new N),this.satBounds=new Array(3).fill().map(()=>new ou),this.alignedSatBounds=new Array(3).fill().map(()=>new ou),this.needsUpdate=!1}set(e,n,i){super.set(e,n),this.matrix.copy(i),this.needsUpdate=!0}copy(e){super.copy(e),this.matrix.copy(e.matrix),this.needsUpdate=!0}};ec.prototype.update=function(){return function(){let t=this.matrix,e=this.min,n=this.max,i=this.points;for(let l=0;l<=1;l++)for(let c=0;c<=1;c++)for(let h=0;h<=1;h++){let u=1*l|2*c|4*h,d=i[u];d.x=l?n.x:e.x,d.y=c?n.y:e.y,d.z=h?n.z:e.z,d.applyMatrix4(t)}let r=this.satBounds,s=this.satAxes,o=i[0];for(let l=0;l<3;l++){let c=s[l],h=r[l],u=1<<l,d=i[u];c.subVectors(o,d),h.setFromPoints(c,i)}let a=this.alignedSatBounds;a[0].setFromPointsField(i,"x"),a[1].setFromPointsField(i,"y"),a[2].setFromPointsField(i,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();ec.prototype.intersectsBox=function(){let t=new ou;return function(e){this.needsUpdate&&this.update();let n=e.min,i=e.max,r=this.satBounds,s=this.satAxes,o=this.alignedSatBounds;if(t.min=n.x,t.max=i.x,o[0].isSeparated(t)||(t.min=n.y,t.max=i.y,o[1].isSeparated(t))||(t.min=n.z,t.max=i.z,o[2].isSeparated(t)))return!1;for(let a=0;a<3;a++){let l=s[a],c=r[a];if(t.setFromBox(l,e),c.isSeparated(t))return!1}return!0}}();ec.prototype.intersectsTriangle=function(){let t=new au,e=new Array(3),n=new ou,i=new ou,r=new N;return function(s){this.needsUpdate&&this.update(),s.isExtendedTriangle?s.needsUpdate&&s.update():(t.copy(s),t.update(),s=t);let o=this.satBounds,a=this.satAxes;e[0]=s.a,e[1]=s.b,e[2]=s.c;for(let u=0;u<3;u++){let d=o[u],f=a[u];if(n.setFromPoints(f,e),d.isSeparated(n))return!1}let l=s.satBounds,c=s.satAxes,h=this.points;for(let u=0;u<3;u++){let d=l[u],f=c[u];if(n.setFromPoints(f,h),d.isSeparated(n))return!1}for(let u=0;u<3;u++){let d=a[u];for(let f=0;f<4;f++){let p=c[f];if(r.crossVectors(d,p),n.setFromPoints(r,e),i.setFromPoints(r,h),n.isSeparated(i))return!1}}return!0}}();ec.prototype.closestPointToPoint=function(){return function(t,e){return this.needsUpdate&&this.update(),e.copy(t).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),e}}();ec.prototype.distanceToPoint=function(){let t=new N;return function(e){return this.closestPointToPoint(e,t),e.distanceTo(t)}}();ec.prototype.distanceToBox=function(){let t=["x","y","z"],e=new Array(12).fill().map(()=>new ia),n=new Array(12).fill().map(()=>new ia),i=new N,r=new N;return function(s,o=0,a=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(s))return(a||l)&&(s.getCenter(r),this.closestPointToPoint(r,i),s.closestPointToPoint(i,r),a&&a.copy(i),l&&l.copy(r)),0;let c=o*o,h=s.min,u=s.max,d=this.points,f=1/0;for(let v=0;v<8;v++){let g=d[v];r.copy(g).clamp(h,u);let m=g.distanceToSquared(r);if(m<f&&(f=m,a&&a.copy(g),l&&l.copy(r),m<c))return Math.sqrt(m)}let p=0;for(let v=0;v<3;v++)for(let g=0;g<=1;g++)for(let m=0;m<=1;m++){let y=(v+1)%3,_=(v+2)%3,S=g<<y|m<<_,A=1<<v|g<<y|m<<_,b=d[S],T=d[A];e[p].set(b,T);let M=t[v],E=t[y],P=t[_],R=n[p],F=R.start,B=R.end;F[M]=h[M],F[E]=g?h[E]:u[E],F[P]=m?h[P]:u[E],B[M]=u[M],B[E]=g?h[E]:u[E],B[P]=m?h[P]:u[E],p++}for(let v=0;v<=1;v++)for(let g=0;g<=1;g++)for(let m=0;m<=1;m++){r.x=v?u.x:h.x,r.y=g?u.y:h.y,r.z=m?u.z:h.z,this.closestPointToPoint(r,i);let y=r.distanceToSquared(i);if(y<f&&(f=y,a&&a.copy(i),l&&l.copy(r),y<c))return Math.sqrt(y)}for(let v=0;v<12;v++){let g=e[v];for(let m=0;m<12;m++){let y=n[m];sF(g,y,i,r);let _=i.distanceToSquared(r);if(_<f&&(f=_,a&&a.copy(i),l&&l.copy(r),_<c))return Math.sqrt(_)}}return Math.sqrt(f)}}();var AS=new N,MS=new N,ES=new N,lj=new Se,cj=new Se,uj=new Se,hj=new N;function qLe(t,e,n,i,r,s){let o;return s===vr?o=t.intersectTriangle(i,n,e,!0,r):o=t.intersectTriangle(e,n,i,s!==oo,r),o===null?null:{distance:t.origin.distanceTo(r),point:r.clone()}}function QLe(t,e,n,i,r,s,o){AS.fromBufferAttribute(e,i),MS.fromBufferAttribute(e,r),ES.fromBufferAttribute(e,s);let a=qLe(t,AS,MS,ES,hj,o);if(a){n&&(lj.fromBufferAttribute(n,i),cj.fromBufferAttribute(n,r),uj.fromBufferAttribute(n,s),a.uv=Cs.getUV(hj,AS,MS,ES,lj,cj,uj,new Se));let l={a:i,b:r,c:s,normal:new N,materialIndex:0};Cs.getNormal(AS,MS,ES,l.normal),a.face=l,a.faceIndex=i}return a}function uJ(t,e,n,i,r){let s=i*3,o=t.index.getX(s),a=t.index.getX(s+1),l=t.index.getX(s+2),c=QLe(n,t.attributes.position,t.attributes.uv,o,a,l,e);return c?(c.faceIndex=i,r&&r.push(c),c):null}function KLe(t,e,n,i,r,s){for(let o=i,a=i+r;o<a;o++)uJ(t,e,n,o,s)}function JLe(t,e,n,i,r){let s=1/0,o=null;for(let a=i,l=i+r;a<l;a++){let c=uJ(t,e,n,a);c&&c.distance<s&&(o=c,s=c.distance)}return o}function hJ(t,e,n){return t===null||(t.point.applyMatrix4(e.matrixWorld),t.distance=t.point.distanceTo(n.ray.origin),t.object=e,t.distance<n.near||t.distance>n.far)?null:t}function Dl(t,e,n,i){let r=t.a,s=t.b,o=t.c,a=e,l=e+1,c=e+2;n&&(a=n.getX(e),l=n.getX(e+1),c=n.getX(e+2)),r.x=i.getX(a),r.y=i.getY(a),r.z=i.getZ(a),s.x=i.getX(l),s.y=i.getY(l),s.z=i.getZ(l),o.x=i.getX(c),o.y=i.getY(c),o.z=i.getZ(c)}function dj(t,e,n,i,r,s,o){let a=n.index,l=n.attributes.position;for(let c=t,h=e+t;c<h;c++)if(Dl(o,c*3,a,l),o.needsUpdate=!0,i(o,c,r,s))return!0;return!1}var dJ=class{constructor(t){this._getNewPrimitive=t,this._primitives=[]}getPrimitive(){let t=this._primitives;return t.length===0?this._getNewPrimitive():t.pop()}releasePrimitive(t){this._primitives.push(t)}};function nh(t,e){return e[t+15]===65535}function ug(t,e){return e[t+6]}function Fx(t,e){return e[t+14]}function Nx(t){return t+8}function Ux(t,e){return e[t+6]}function ZLe(t,e){return e[t+7]}var Vm=new Vi,eM=new N,$Le=["x","y","z"];function dI(t,e,n,i,r){let s=t*2,o=_v,a=Rh,l=Lh;if(nh(s,a)){let c=ug(t,l),h=Fx(s,a);KLe(e,n,i,c,h,r)}else{let c=Nx(t);tM(c,o,i,eM)&&dI(c,e,n,i,r);let h=Ux(t,l);tM(h,o,i,eM)&&dI(h,e,n,i,r)}}function fI(t,e,n,i){let r=t*2,s=_v,o=Rh,a=Lh;if(nh(r,o)){let l=ug(t,a),c=Fx(r,o);return JLe(e,n,i,l,c)}else{let l=ZLe(t,a),c=$Le[l],h=i.direction[c]>=0,u,d;h?(u=Nx(t),d=Ux(t,a)):(u=Ux(t,a),d=Nx(t));let f=tM(u,s,i,eM)?fI(u,e,n,i):null;if(f){let v=f.point[c];if(h?v<=s[d+l]:v>=s[d+l+3])return f}let p=tM(d,s,i,eM)?fI(d,e,n,i):null;return f&&p?f.distance<=p.distance?f:p:f||p||null}}var eIe=function(){let t,e,n=[],i=new dJ(()=>new Vi);return function(...s){t=i.getPrimitive(),e=i.getPrimitive(),n.push(t,e);let o=r(...s);i.releasePrimitive(t),i.releasePrimitive(e),n.pop(),n.pop();let a=n.length;return a>0&&(e=n[a-1],t=n[a-2]),o};function r(s,o,a,l,c=null,h=0,u=0){function d(y){let _=y*2,S=Rh,A=Lh;for(;!nh(_,S);)y=Nx(y),_=y*2;return ug(y,A)}function f(y){let _=y*2,S=Rh,A=Lh;for(;!nh(_,S);)y=Ux(y,A),_=y*2;return ug(y,A)+Fx(_,S)}let p=s*2,v=_v,g=Rh,m=Lh;if(nh(p,g)){let y=ug(s,m),_=Fx(p,g);return Bl(s,v,t),l(y,_,!1,u,h+s,t)}else{let y=Nx(s),_=Ux(s,m),S=y,A=_,b,T,M,E;if(c&&(M=t,E=e,Bl(S,v,M),Bl(A,v,E),b=c(M),T=c(E),T<b)){S=_,A=y;let Z=b;b=T,T=Z,M=E}M||(M=t,Bl(S,v,M));let P=nh(S*2,g),R=a(M,P,b,u+1,h+S),F;if(R===2){let Z=d(S),ee=f(S)-Z;F=l(Z,ee,!0,u+1,h+S,M)}else F=R&&r(S,o,a,l,c,h,u+1);if(F)return!0;E=e,Bl(A,v,E);let B=nh(A*2,g),k=a(E,B,T,u+1,h+A),j;if(k===2){let Z=d(A),ee=f(A)-Z;j=l(Z,ee,!0,u+1,h+A,E)}else j=k&&r(A,o,a,l,c,h,u+1);return!!j}}}(),tIe=function(){let t=new au,e=new au,n=new nt,i=new ec,r=new ec;return function s(o,a,l,c,h=null){let u=o*2,d=_v,f=Rh,p=Lh;if(h===null&&(l.boundingBox||l.computeBoundingBox(),i.set(l.boundingBox.min,l.boundingBox.max,c),h=i),nh(u,f)){let v=a,g=v.index,m=v.attributes.position,y=l.index,_=l.attributes.position,S=ug(o,p),A=Fx(u,f);if(n.copy(c).invert(),l.boundsTree)return Bl(o,d,r),r.matrix.copy(n),r.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:b=>r.intersectsBox(b),intersectsTriangle:b=>{b.a.applyMatrix4(c),b.b.applyMatrix4(c),b.c.applyMatrix4(c),b.needsUpdate=!0;for(let T=S*3,M=(A+S)*3;T<M;T+=3)if(Dl(e,T,g,m),e.needsUpdate=!0,b.intersectsTriangle(e))return!0;return!1}});for(let b=S*3,T=A+S*3;b<T;b+=3){Dl(t,b,g,m),t.a.applyMatrix4(n),t.b.applyMatrix4(n),t.c.applyMatrix4(n),t.needsUpdate=!0;for(let M=0,E=y.count;M<E;M+=3)if(Dl(e,M,y,_),e.needsUpdate=!0,t.intersectsTriangle(e))return!0}}else{let v=o+8,g=p[o+6];return Bl(v,d,Vm),!!(h.intersectsBox(Vm)&&s(v,a,l,c,h)||(Bl(g,d,Vm),h.intersectsBox(Vm)&&s(g,a,l,c,h)))}}}();function tM(t,e,n,i){return Bl(t,e,Vm),n.intersectBox(Vm,i)}var pI=[],Pb,_v,Rh,Lh;function ey(t){Pb&&pI.push(Pb),Pb=t,_v=new Float32Array(t),Rh=new Uint16Array(t),Lh=new Uint32Array(t)}function CS(){Pb=null,_v=null,Rh=null,Lh=null,pI.length&&ey(pI.pop())}var v2=Symbol("skip tree generation"),y2=new Vi,x2=new Vi,Zp=new nt,Ed=new ec,M0=new ec,E0=new N,TS=new N,nIe=new N,iIe=new N,rIe=new N,fj=new Vi,gl=new dJ(()=>new au),Ir=class{static serialize(t,e={}){if(e.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),Ir.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});e={cloneBuffers:!0,...e};let n=t.geometry,i=t._roots,r=n.getIndex(),s;return e.cloneBuffers?s={roots:i.map(o=>o.slice()),index:r.array.slice()}:s={roots:i,index:r.array},s}static deserialize(t,e,n={}){if(typeof n=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),Ir.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});n={setIndex:!0,...n};let{index:i,roots:r}=t,s=new Ir(e,{...n,[v2]:!0});if(s._roots=r,n.setIndex){let o=e.getIndex();if(o===null){let a=new Ut(t.index,1,!1);e.setIndex(a)}else o.array!==i&&(o.array.set(i),o.needsUpdate=!0)}return s}constructor(t,e={}){if(t.isBufferGeometry){if(t.index&&t.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[v2]:!1},e),e.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,e[v2]||(this._roots=jLe(t,e),!t.boundingBox&&e.setBoundingBox&&(t.boundingBox=this.getBoundingBox(new Vi))),this.geometry=t}refit(t=null){t&&Array.isArray(t)&&(t=new Set(t));let e=this.geometry,n=e.index.array,i=e.attributes.position,r=i.array,s=i.offset||0,o=3;i.isInterleavedBufferAttribute&&(o=i.data.stride);let a,l,c,h,u=0,d=this._roots;for(let p=0,v=d.length;p<v;p++)a=d[p],l=new Uint32Array(a),c=new Uint16Array(a),h=new Float32Array(a),f(0,u),u+=a.byteLength;function f(p,v,g=!1){let m=p*2;if(c[m+15]===65535){let y=l[p+6],_=c[m+14],S=1/0,A=1/0,b=1/0,T=-1/0,M=-1/0,E=-1/0;for(let P=3*y,R=3*(y+_);P<R;P++){let F=n[P]*o+s,B=r[F+0],k=r[F+1],j=r[F+2];B<S&&(S=B),B>T&&(T=B),k<A&&(A=k),k>M&&(M=k),j<b&&(b=j),j>E&&(E=j)}return h[p+0]!==S||h[p+1]!==A||h[p+2]!==b||h[p+3]!==T||h[p+4]!==M||h[p+5]!==E?(h[p+0]=S,h[p+1]=A,h[p+2]=b,h[p+3]=T,h[p+4]=M,h[p+5]=E,!0):!1}else{let y=p+8,_=l[p+6],S=y+v,A=_+v,b=g,T=!1,M=!1;t?b||(T=t.has(S),M=t.has(A),b=!T&&!M):(T=!0,M=!0);let E=b||T,P=b||M,R=!1;E&&(R=f(y,v,b));let F=!1;P&&(F=f(_,v,b));let B=R||F;if(B)for(let k=0;k<3;k++){let j=y+k,Z=_+k,ee=h[j],O=h[j+3],W=h[Z],H=h[Z+3];h[p+k]=ee<W?ee:W,h[p+k+3]=O>H?O:H}return B}}}traverse(t,e=0){let n=this._roots[e],i=new Uint32Array(n),r=new Uint16Array(n);s(0);function s(o,a=0){let l=o*2,c=r[l+15]===65535;if(c){let h=i[o+6],u=r[l+14];t(a,c,new Float32Array(n,o*4,6),h,u)}else{let h=o+8,u=i[o+6],d=i[o+7];t(a,c,new Float32Array(n,o*4,6),d)||(s(h,a+1),s(u,a+1))}}}raycast(t,e=Ka){let n=this._roots,i=this.geometry,r=[],s=e.isMaterial,o=Array.isArray(e),a=i.groups,l=s?e.side:e;for(let c=0,h=n.length;c<h;c++){let u=o?e[a[c].materialIndex].side:l,d=r.length;if(ey(n[c]),dI(0,i,u,t,r),CS(),o){let f=a[c].materialIndex;for(let p=d,v=r.length;p<v;p++)r[p].face.materialIndex=f}}return r}raycastFirst(t,e=Ka){let n=this._roots,i=this.geometry,r=e.isMaterial,s=Array.isArray(e),o=null,a=i.groups,l=r?e.side:e;for(let c=0,h=n.length;c<h;c++){let u=s?e[a[c].materialIndex].side:l;ey(n[c]);let d=fI(0,i,u,t);CS(),d!=null&&(o==null||d.distance<o.distance)&&(o=d,s&&(d.face.materialIndex=a[c].materialIndex))}return o}intersectsGeometry(t,e){let n=this.geometry,i=!1;for(let r of this._roots)if(ey(r),i=tIe(0,n,t,e),CS(),i)break;return i}shapecast(t,e,n){let i=this.geometry;if(t instanceof Function){if(e){let u=e;e=(d,f,p,v)=>{let g=f*3;return u(d,g,g+1,g+2,p,v)}}t={boundsTraverseOrder:n,intersectsBounds:t,intersectsTriangle:e,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let r=gl.getPrimitive(),{boundsTraverseOrder:s,intersectsBounds:o,intersectsRange:a,intersectsTriangle:l}=t;if(a&&l){let u=a;a=(d,f,p,v,g)=>u(d,f,p,v,g)?!0:dj(d,f,i,l,p,v,r)}else a||(l?a=(u,d,f,p)=>dj(u,d,i,l,f,p,r):a=(u,d,f)=>f);let c=!1,h=0;for(let u of this._roots){if(ey(u),c=eIe(0,i,o,a,s,h),CS(),c)break;h+=u.byteLength}return gl.releasePrimitive(r),c}bvhcast(t,e,n){let{intersectsRanges:i,intersectsTriangles:r}=n,s=this.geometry.index,o=this.geometry.attributes.position,a=t.geometry.index,l=t.geometry.attributes.position;Zp.copy(e).invert();let c=gl.getPrimitive(),h=gl.getPrimitive();if(r){let d=function(f,p,v,g,m,y,_,S){for(let A=v,b=v+g;A<b;A++){Dl(h,A*3,a,l),h.a.applyMatrix4(e),h.b.applyMatrix4(e),h.c.applyMatrix4(e),h.needsUpdate=!0;for(let T=f,M=f+p;T<M;T++)if(Dl(c,T*3,s,o),c.needsUpdate=!0,r(c,h,T,A,m,y,_,S))return!0}return!1};if(i){let f=i;i=function(p,v,g,m,y,_,S,A){return f(p,v,g,m,y,_,S,A)?!0:d(p,v,g,m,y,_,S,A)}}else i=d}t.getBoundingBox(x2),x2.applyMatrix4(e);let u=this.shapecast({intersectsBounds:d=>x2.intersectsBox(d),intersectsRange:(d,f,p,v,g,m)=>(y2.copy(m),y2.applyMatrix4(Zp),t.shapecast({intersectsBounds:y=>y2.intersectsBox(y),intersectsRange:(y,_,S,A,b)=>i(d,f,y,_,v,g,A,b)}))});return gl.releasePrimitive(c),gl.releasePrimitive(h),u}intersectsBox(t,e){return Ed.set(t.min,t.max,e),Ed.needsUpdate=!0,this.shapecast({intersectsBounds:n=>Ed.intersectsBox(n),intersectsTriangle:n=>Ed.intersectsTriangle(n)})}intersectsSphere(t){return this.shapecast({intersectsBounds:e=>t.intersectsBox(e),intersectsTriangle:e=>e.intersectsSphere(t)})}closestPointToGeometry(t,e,n={},i={},r=0,s=1/0){t.boundingBox||t.computeBoundingBox(),Ed.set(t.boundingBox.min,t.boundingBox.max,e),Ed.needsUpdate=!0;let o=this.geometry,a=o.attributes.position,l=o.index,c=t.attributes.position,h=t.index,u=gl.getPrimitive(),d=gl.getPrimitive(),f=TS,p=nIe,v=null,g=null;i&&(v=iIe,g=rIe);let m=1/0,y=null,_=null;return Zp.copy(e).invert(),M0.matrix.copy(Zp),this.shapecast({boundsTraverseOrder:S=>Ed.distanceToBox(S),intersectsBounds:(S,A,b)=>b<m&&b<s?(A&&(M0.min.copy(S.min),M0.max.copy(S.max),M0.needsUpdate=!0),!0):!1,intersectsRange:(S,A)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:b=>M0.distanceToBox(b),intersectsBounds:(b,T,M)=>M<m&&M<s,intersectsRange:(b,T)=>{for(let M=b*3,E=(b+T)*3;M<E;M+=3){Dl(d,M,h,c),d.a.applyMatrix4(e),d.b.applyMatrix4(e),d.c.applyMatrix4(e),d.needsUpdate=!0;for(let P=S*3,R=(S+A)*3;P<R;P+=3){Dl(u,P,l,a),u.needsUpdate=!0;let F=u.distanceToTriangle(d,f,v);if(F<m&&(p.copy(f),g&&g.copy(v),m=F,y=P/3,_=M/3),F<r)return!0}}}});{let b=h?h.count:c.count;for(let T=0,M=b;T<M;T+=3){Dl(d,T,h,c),d.a.applyMatrix4(e),d.b.applyMatrix4(e),d.c.applyMatrix4(e),d.needsUpdate=!0;for(let E=S*3,P=(S+A)*3;E<P;E+=3){Dl(u,E,l,a),u.needsUpdate=!0;let R=u.distanceToTriangle(d,f,v);if(R<m&&(p.copy(f),g&&g.copy(v),m=R,y=E/3,_=T/3),R<r)return!0}}}}}),gl.releasePrimitive(u),gl.releasePrimitive(d),m===1/0?null:(n.point?n.point.copy(p):n.point=p.clone(),n.distance=m,n.faceIndex=y,i&&(i.point?i.point.copy(g):i.point=g.clone(),i.point.applyMatrix4(Zp),p.applyMatrix4(Zp),i.distance=p.sub(i.point).length(),i.faceIndex=_),n)}closestPointToPoint(t,e={},n=0,i=1/0){let r=n*n,s=i*i,o=1/0,a=null;if(this.shapecast({boundsTraverseOrder:c=>(E0.copy(t).clamp(c.min,c.max),E0.distanceToSquared(t)),intersectsBounds:(c,h,u)=>u<o&&u<s,intersectsTriangle:(c,h)=>{c.closestPointToPoint(t,E0);let u=t.distanceToSquared(E0);return u<o&&(TS.copy(E0),o=u,a=h),u<r}}),o===1/0)return null;let l=Math.sqrt(o);return e.point?e.point.copy(TS):e.point=TS.clone(),e.distance=l,e.faceIndex=a,e}getBoundingBox(t){return t.makeEmpty(),this._roots.forEach(e=>{Bl(0,new Float32Array(e),fj),t.union(fj)}),t}},pj=Ir.prototype.raycast;Ir.prototype.raycast=function(...t){if(t[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "raycast" has changed. See docs for new signature.');let[e,n,i,r]=t;return pj.call(this,i,e.material).forEach(s=>{s=hJ(s,e,n),s&&r.push(s)}),r}else return pj.apply(this,t)};var mj=Ir.prototype.raycastFirst;Ir.prototype.raycastFirst=function(...t){if(t[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "raycastFirst" has changed. See docs for new signature.');let[e,n,i]=t;return hJ(mj.call(this,i,e.material),e,n)}else return mj.apply(this,t)};var gj=Ir.prototype.closestPointToPoint;Ir.prototype.closestPointToPoint=function(...t){if(t[0].isMesh){console.warn('MeshBVH: The function signature and results frame for "closestPointToPoint" has changed. See docs for new signature.'),t.unshift();let e=t[1],n={};return t[1]=n,gj.apply(this,t),e&&e.copy(n.point),n.distance}else return gj.apply(this,t)};var vj=Ir.prototype.closestPointToGeometry;Ir.prototype.closestPointToGeometry=function(...t){let e=t[2],n=t[3];if(e&&e.isVector3||n&&n.isVector3){console.warn('MeshBVH: The function signature and results frame for "closestPointToGeometry" has changed. See docs for new signature.');let i={},r={},s=t[1];return t[2]=i,t[3]=r,vj.apply(this,t),e&&e.copy(i.point),n&&n.copy(r.point).applyMatrix4(s),i.distance}else return vj.apply(this,t)};var yj=Ir.prototype.refit;Ir.prototype.refit=function(...t){let e=t[0],n=t[1];if(n&&(n instanceof Set||Array.isArray(n))){console.warn('MeshBVH: The function signature for "refit" has changed. See docs for new signature.');let i=new Set;n.forEach(r=>i.add(r)),e&&e.forEach(r=>i.add(r)),yj.call(this,i)}else yj.apply(this,t)};["intersectsGeometry","shapecast","intersectsBox","intersectsSphere"].forEach(t=>{let e=Ir.prototype[t];Ir.prototype[t]=function(...n){return(n[0]===null||n[0].isMesh)&&(n.shift(),console.warn(`MeshBVH: The function signature for "${t}" has changed and no longer takes Mesh. See docs for new signature.`)),e.apply(this,n)}});var C0=b1(nye()),sIe=.5*(Math.sqrt(3)-1),T0=(3-Math.sqrt(3))/6,oIe=1/3,vl=1/6,Dy=t=>Math.floor(t)|0,xj=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),_2=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function w2(t=Math.random){let e=fJ(t),n=new Float64Array(e).map(r=>xj[r%12*2]),i=new Float64Array(e).map(r=>xj[r%12*2+1]);return function(r,s){let o=0,a=0,l=0,c=(r+s)*sIe,h=Dy(r+c),u=Dy(s+c),d=(h+u)*T0,f=h-d,p=u-d,v=r-f,g=s-p,m,y;v>g?(m=1,y=0):(m=0,y=1);let _=v-m+T0,S=g-y+T0,A=v-1+2*T0,b=g-1+2*T0,T=h&255,M=u&255,E=.5-v*v-g*g;if(E>=0){let F=T+e[M],B=n[F],k=i[F];E*=E,o=E*E*(B*v+k*g)}let P=.5-_*_-S*S;if(P>=0){let F=T+m+e[M+y],B=n[F],k=i[F];P*=P,a=P*P*(B*_+k*S)}let R=.5-A*A-b*b;if(R>=0){let F=T+1+e[M+1],B=n[F],k=i[F];R*=R,l=R*R*(B*A+k*b)}return 70*(o+a+l)}}function aIe(t=Math.random){let e=fJ(t),n=new Float64Array(e).map(s=>_2[s%12*3]),i=new Float64Array(e).map(s=>_2[s%12*3+1]),r=new Float64Array(e).map(s=>_2[s%12*3+2]);return function(s,o,a){let l,c,h,u,d=(s+o+a)*oIe,f=Dy(s+d),p=Dy(o+d),v=Dy(a+d),g=(f+p+v)*vl,m=f-g,y=p-g,_=v-g,S=s-m,A=o-y,b=a-_,T,M,E,P,R,F;S>=A?A>=b?(T=1,M=0,E=0,P=1,R=1,F=0):S>=b?(T=1,M=0,E=0,P=1,R=0,F=1):(T=0,M=0,E=1,P=1,R=0,F=1):A<b?(T=0,M=0,E=1,P=0,R=1,F=1):S<b?(T=0,M=1,E=0,P=0,R=1,F=1):(T=0,M=1,E=0,P=1,R=1,F=0);let B=S-T+vl,k=A-M+vl,j=b-E+vl,Z=S-P+2*vl,ee=A-R+2*vl,O=b-F+2*vl,W=S-1+3*vl,H=A-1+3*vl,Y=b-1+3*vl,z=f&255,X=p&255,q=v&255,re=.6-S*S-A*A-b*b;if(re<0)l=0;else{let ve=z+e[X+e[q]];re*=re,l=re*re*(n[ve]*S+i[ve]*A+r[ve]*b)}let G=.6-B*B-k*k-j*j;if(G<0)c=0;else{let ve=z+T+e[X+M+e[q+E]];G*=G,c=G*G*(n[ve]*B+i[ve]*k+r[ve]*j)}let K=.6-Z*Z-ee*ee-O*O;if(K<0)h=0;else{let ve=z+P+e[X+R+e[q+F]];K*=K,h=K*K*(n[ve]*Z+i[ve]*ee+r[ve]*O)}let oe=.6-W*W-H*H-Y*Y;if(oe<0)u=0;else{let ve=z+1+e[X+1+e[q+1]];oe*=oe,u=oe*oe*(n[ve]*W+i[ve]*H+r[ve]*Y)}return 32*(l+c+h+u)}}function fJ(t){let e=new Uint8Array(512);for(let n=0;n<512/2;n++)e[n]=n;for(let n=0;n<512/2-1;n++){let i=n+~~(t()*(256-n)),r=e[n];e[n]=e[i],e[i]=r}for(let n=256;n<512;n++)e[n]=e[n-256];return e}var Ma=new Cs,lIe=class{constructor(t){this.weightAttribute=null;let e=t.geometry;if(!e.isBufferGeometry||e.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");e.index&&(e=e.toNonIndexed()),this.geometry=e,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let t=this.positionAttribute,e=new Float32Array(t.count/3);for(let i=0;i<t.count;i+=3){let r=1;Ma.a.fromBufferAttribute(t,i),Ma.b.fromBufferAttribute(t,i+1),Ma.c.fromBufferAttribute(t,i+2),r*=Ma.getArea(),e[i/3]=r}this.distribution=new Float32Array(t.count/3);let n=0;for(let i=0;i<e.length;i++)n+=e[i],this.distribution[i]=n;return this}setRandomGenerator(t){return this.randomFunction=t,this}sample(t,e){if(this.distribution){let n=this.distribution[this.distribution.length-1],i=this.binarySearch(this.randomFunction()*n);return this.sampleFace(i,t,e)}}binarySearch(t){if(!this.distribution)return 0;let e=this.distribution,n=0,i=e.length-1,r=-1;for(;n<=i;){let s=Math.ceil((n+i)/2);if(s===0||e[s-1]<=t&&e[s]>t){r=s;break}else t<e[s]?i=s-1:n=s+1}return r}sampleFace(t,e,n){let i=this.randomFunction(),r=this.randomFunction();return i+r>1&&(i=1-i,r=1-r),Ma.a.fromBufferAttribute(this.positionAttribute,t*3),Ma.b.fromBufferAttribute(this.positionAttribute,t*3+1),Ma.c.fromBufferAttribute(this.positionAttribute,t*3+2),e.set(0,0,0).addScaledVector(Ma.a,i).addScaledVector(Ma.b,r).addScaledVector(Ma.c,1-(i+r)),Ma.getNormal(n),this}},cIe=b1(uQ()),uIe=new nt,hIe=new nt,dIe=new nt,nM;(t=>{function e(n){return n&&n.__isSPEObject}t.is=e})(nM||(nM={}));var oF=t=>class extends t{constructor(){super(...arguments),this.hiddenMatrix=new nt,this.matrixWorldRigid=new nt,this.shearScale=new nt,this.shearScaleInv=new nt}get __isSPEObject(){return!0}isDescendantOf(e){e instanceof Fn&&(e=e.uuid);let n=this;for(;n.parent;){if(n.parent.uuid===e)return!0;n=n.parent}return!1}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);for(let n of this.children)n.updateMatrixWorld(e)}updateWorldMatrix(e,n){let i=this.parent;if(e&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),n)for(let r of this.children)r.updateWorldMatrix(!1,!0)}traverseObject(e,n=0){if(e(this,n)!==!0)for(let i of this.children)nM.is(i)&&i.traverseObject(e,n+1)}updateMatrixWorldSVD(){let e=this.matrixWorld.elements,n=[[e[0],e[4],e[8]],[e[1],e[5],e[9]],[e[2],e[6],e[10]]],{u:i,v:r,q:s}=(0,cIe.SVD)(n),o=uIe.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),a=hIe.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),l=dIe.copy(a).transpose();this.shearScale.makeScale(s[0],s[1],s[2]).multiply(l).premultiply(a),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(o,l).copyPosition(this.matrixWorld),s.every(c=>Math.abs(s[0]-c)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(e,n){this.updateWorldMatrix(!0,!1);let i=new nt().copy(this.matrixWorld).invert();return e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),i.multiply(e.parent.matrixWorld)),"hiddenMatrix"in e&&e.hiddenMatrix instanceof nt?e.hiddenMatrix.premultiply(i):e.applyMatrix4(i),e.updateWorldMatrix(!1,!1),this.add(e),n!==void 0&&(this.children.pop(),this.children.splice(n,0,e)),this}copy(e,n=!1){return super.copy(e,n),this.hasNonUniformScale=e.hasNonUniformScale,this}},fIe=class extends oF(Fn){},pIe=t=>t.type==="Mesh",Fl=class extends fIe{constructor(t){super(),this.object=t,this.matrixAutoUpdate=!1}expand(){let t=0,e=this.object.entityChildren(t);for(;e;){let n=this.children[t];(n==null?void 0:n.object)!==e&&(n&&this.remove(n),n=new Fl(e),this.add(n),this.children.splice(t,0,this.children.pop()),n.matrixWorldNeedsUpdate=!0,n.matrixAutoUpdate=!1,n.matrix=e.matrix,n.hiddenMatrix=e.hiddenMatrix),n.expand(),t+=1,e=this.object.entityChildren(t)}for(;this.children.length>t;)this.remove(this.children[t])}get visible(){var t;return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&((t=this.object.dataPatched.cloner)==null?void 0:t.hideBase)===!0}set visible(t){}get castShadow(){return this.object.castShadow}set castShadow(t){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(t){}get isMesh(){return pIe(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(t){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},Vd=new N,jd=new N,hg=new nt,pJ=[new N(-1,1,1),new N(-1,-1,1),new N(1,-1,1),new N(1,1,1),new N(-1,1,-1),new N(-1,-1,-1),new N(1,-1,-1),new N(1,1,-1)],mIe=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],gIe=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],_j=(t,e,n)=>{t.updateEntityBoxSize(Vd,jd),hg.copy(e).multiply(t.matrixWorld),jd.x===0&&jd.y===0&&jd.z===0?n.push(new N(Vd.x,Vd.y,Vd.z).applyMatrix4(hg)):pJ.forEach(i=>{n.push(i.clone().multiply(jd).add(Vd).applyMatrix4(hg))})},wj=class extends Vi{constructor(){super(...arguments),this.matrix=new nt,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(t){return super.copy(t),this.matrix.copy(t.matrix),this.vertices=t.vertices.map(e=>e.clone()),this.faces=t.faces.map(e=>e.clone()),this.edges=t.edges.map(e=>e.clone()),this.centerEdges=t.centerEdges.map(e=>e.clone()),this}setFromObjectSize(t,e=!1){t.updateWorldMatrix(!1,e),this.makeEmpty(),this.matrix.copy(t.matrixWorld);let n=new nt().copy(t.matrixWorld).invert();return this.expandByObjectSize(t,n,e)}expandByObjectSize(t,e,n=!1){let i=[];return n===!0?t.traverseEntity(r=>{(r.visible||r.cloner&&r.data.visible)&&_j(r,e,i)}):_j(t,e,i),this.setFromPoints(i)}getCenter(t){return t=super.getCenter(t),t.applyMatrix4(this.matrix),t}getPositionToCenter(t){return t=super.getCenter(t),t.applyMatrix4(hg.copy(this.matrix).setPosition(0,0,0)),t}computeVertices(){this.getSize(jd).multiplyScalar(.5),this.getCenter(Vd),hg.copy(this.matrix).setPosition(Vd),this.vertices=pJ.map(t=>t.clone().multiply(jd).applyMatrix4(hg))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=mIe.map(([t,e])=>new ia(this.vertices[t],this.vertices[e])),this.centerEdges=this.edges.map(t=>t.getCenter(new N))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=gIe.map(([t,e])=>this.vertices[t].clone().add(this.vertices[e]).multiplyScalar(.5))}},fh={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},vIe=class extends BQ{constructor(){super()}getPoints(t=12){let e=[],n,i=this.getCurveLengths(),r=i[i.length-1]/i.length;for(let s=0,o=this.curves;s<o.length;s++){let a=o[s],l=s===0?i[s]:i[s]-i[s-1],c=Math.ceil(t*l/r),h=a.getPoints(c);for(let u=0;u<h.length;u++){let d=h[u];n&&n.equals(d)||(e.push(d),n=d)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}},mI=.001;function gI(t,e,n){return e.clone().sub(t).cross(e.clone().sub(n)).length()<=mI}function S2(t,e){let n=new N(...t.position),i=new N(...t.controlNext.position),r=new N(...e.controlPrevious.position),s=new N(...e.position);return gI(n,i,s)&&gI(n,r,s)}function mJ(t){let e=t.points.map(h=>new N(...h.data.position)),n=[t.points[0]],i=new N(...n[0].data.position);for(let h=0;h<t.points.length-1;h++)gI(i,e[h],e[h+1])||(n.push(t.points[h]),i=e[h]);n.push(t.points[t.points.length-1]);let r=t.isClosed,s=n.length-(r?0:1),o=n.length,a=[];for(let h=0;h<o;h++){let u=n[h].data,d=new N(...u.position),f=new N(...u.controlPrevious.position),p=new N(...u.controlNext.position),v={position:d,baseRoundness:u.roundness,controlPrevious:f,controlNext:p};if(u.roundness===0||!t.isClosed&&(h===0||h===o-1)){a[h]={...v,removedLength:0};continue}let g=r&&h==0?o-1:h-1,m=r&&h==o-1?0:h+1,y=n[g].data,_=n[m].data,S=new N(...y.position),A=new N(..._.position),b=S.clone().sub(d).normalize(),T=A.clone().sub(d).normalize();Object.assign(v,{prevDir:b,nextDir:T});let M=S2(y,u),E=S2(u,_);if(!M||!E)a[h]={...v,removedLength:0};else{let P=b.clone().add(T).normalize(),R=P.clone().cross(b).length()/b.dot(P);a[h]={...v,tan:R,removedLength:u.roundness/R}}}for(let h=0;h<s;h++){let u=h,d=r&&h===o-1?0:h+1,f=a[u],p=a[d];if(f.removedLength!==0||p.removedLength!==0){let v=f.position.distanceTo(p.position);f.removedLength=Math.min(f.removedLength,v/2),p.removedLength=Math.min(p.removedLength,v/2)}}let l=[];for(let h=0;h<s;h++){let u=h,d=r&&h===o-1?0:h+1,f=a[u],p=a[d],v=null;if(!S2(n[u].data,n[d].data))f.position.distanceTo(p.position)>mI&&(v=new Sb(f.position,f.controlNext,p.controlPrevious,p.position));else{let g=f.position.clone(),m=p.position.clone();(f.removedLength!==0||p.removedLength!==0)&&(f.nextDir&&g.add(f.nextDir.clone().setLength(f.removedLength)),p.prevDir&&m.add(p.prevDir.clone().setLength(p.removedLength))),g.distanceTo(m)>mI&&(v=new Sb(g,g.clone().lerp(m,.3),m.clone().lerp(g,.3),m))}l[2*h+1]=v}for(let h=0;h<o;h++){let u=a[h];if(u.removedLength===0){l[2*h]=null;continue}let d=u.position,f=u.prevDir.clone().multiplyScalar(u.removedLength).add(d),p=u.nextDir.clone().multiplyScalar(u.removedLength).add(d),v=u.tan*u.removedLength,g=u.prevDir.clone().add(u.nextDir).normalize(),m=f.clone().lerp(p,.5),y=f.distanceTo(p)/2,_=g.clone().multiplyScalar(Math.sqrt(Math.pow(v,2)-Math.pow(y,2))).add(m),S=g.clone().multiplyScalar(-v).add(_),A=d.distanceTo(S)/d.distanceTo(m),b=u.prevDir.clone().multiplyScalar(A*d.distanceTo(f)).add(d),T=b.clone().lerp(S,2),M=f.clone().lerp(b,4/3),E=p.clone().lerp(T,4/3);l[2*h]=new Sb(f,M,E,p)}let c=new vIe;return l.forEach(h=>{h&&c.add(h)}),c}var Pn;(t=>{function e(n){return n&&n.__isEntity}t.is=e})(Pn||(Pn={}));var ih=t=>Pn.is(t),yIe={type:"completeState",isfromEntity:!0},gJ=t=>class extends oF(t){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new wj,this._recursiveBBox=new wj,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(e){let n=this.children[e];if(Pn.is(n))return n}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let e=this;for(;e.data.type!=="Instance";){let n=e.parent;if(Pn.is(n))e=n;else return}return e}forInstancesRec(e){this.instances.forEach(n=>{n.disposed||e(n),n.forInstancesRec(e)})}super_Entity(e,n){typeof e=="string"&&(this.uuid=e),this.identity=e,this.data=n,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(e,n,i=!1){if(!(this.data.states.length===0&&!i)){for(let r of this.data.states)tf.toOps(this.data,r.data).forEach(s=>{let o=VL.replaceProps(s,this.data);this.dataPatched=this.data,this.updateByPatchedOp(o,this.data,n)});if(e!==null){let r=this.data.states.data(e);r&&(this.dataPatched=tf.patch(this.data,r),tf.toOps(this.data,r).forEach(s=>{this.updateByPatchedOp(s,this.dataPatched,n)}))}i&&this.updateTransformState(this.dataPatched),this.stateSelection=e,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(e,n){e.setScalar(0),n.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(e=>{ih(e)&&e.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(e=>{e.resetBBoxNeedsUpdateSelf()})}find(e){let n;return this.traverseEntity(i=>{i.uuid===e&&(n=i)}),n}traverseSortNextHelper(){let e=this.parent;if(e){let n=e.children,i=n.indexOf(this)+1;if(Pn.is(n[i]))return n[i];if(Pn.is(e))return e.traverseSortNextHelper()}}sortNext(){let e=this.children;return this.children.length>0&&Pn.is(this.children[0])?e[0]:this.traverseSortNextHelper()}goUp(e){let n=this;for(;e>0&&n!==null;)n=n.parent,e-=1;return n}hasAnccestorOrSelf(e){return this===e||this.hasAnccestor(e)}hasAnccestor(e){let n=this.parent;for(;n;){if(e===n)return!0;n=n.parent}return!1}countToAccestor(e){let n=0,i=this;for(;i!==e;){if(i===null)return-1;i=i.parent,n+=1}return n}forEachEntity(e){for(let n of this.children)ih(n)&&e(n)}traverseEntityAncestors(e){this.traverseAncestors(n=>{Pn.is(n)&&e(n)})}traverseEntity(e,n=0){if(e(this,n)!==!0)for(let i of this.children)ih(i)&&i.traverseEntity(e,n+1)}traverseVisibleEntity(e){e(this);for(let n of this.children)ih(n)&&n.visible&&n.traverseVisibleEntity(e)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}copy(e,n=!1){return super.copy(e,n),this.dataPatched=e.dataPatched,this.raycastLock=e.raycastLock,this.scaleLock=e.scaleLock,this.hiddenMatrix.copy(e.hiddenMatrix),this}hasEntityChild(){return this.children.some(e=>ih(e))}isAncestorOf(e){if(this.uuid===e)return!1;let n=!1;return this.traverseEntity(i=>{i.uuid===e&&(n=!0)}),n}toObjectTransformState(e=[]){this.updateWorldMatrix(!0,!1);let n={position:this.position.toArray(),rotation:[this.rotation.x,this.rotation.y,this.rotation.z],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return HL(n,e)}updateTransformState(e){let n=!1;return e.position&&(this.position.fromArray(e.position),n=!0),e.rotation&&(this.rotation.fromArray(e.rotation),n=!0),e.scale&&(n=!0,this.scale.fromArray(e.scale)),e.hiddenMatrix!==void 0&&(n=!0,this.hiddenMatrix.fromArray(e.hiddenMatrix??Vg.identity)),n&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(i=>{i.invalidateClonerTransform(this)})),e.position&&e.rotation&&e.scale&&e.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),n}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let e of this.children)Pn.is(e)&&e.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(e=>{Pn.is(e)&&e.disposeRecursively()})}toState(e=[]){let n={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(e)};return HL(n,e)}updateByOp(e,n,i,r){let s=this.data;this.data=n;let o=e,a=th(e.path,["states","*"]);if(a!==null){if(e.type===0){let[l]=a;if((this==null?void 0:this.stateSelection)===l){let c={...e.props};if(Object.values(e.props).some(h=>h===void 0)){let h=this.data;if(h!==void 0){let u=Wl.zoom(h,e.path.slice(2));if(u)for(let d in e.props)e.props[d]===void 0&&d in u&&(c[d]=u[d])}}o={...e,props:c,path:e.path.slice(2)}}}}else if(e.type===0){let l=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(l!==void 0){if(e.props.name!==void 0&&l.name){let{name:h,...u}=l;l=u}if(e.props.material!==void 0&&"material"in l){let{material:h,...u}=l;l=u}let c=Wl.removeOverridden(e.path,e.props,l);o={...e,props:c}}}if(this.updateByPatchedOpBase(o,tf.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),i),th(e.path,["overrides"])){let l=[],c=[...e.path];for(l.push(c[1]),c.splice(0,2);c.length>0&&c[0]==="descendants";)l.push(c[1]),c.splice(0,2);if(l[l.length-1]===void 0){if(e.type===0)for(let h of Object.keys(e.props)){l[l.length-1]=h;let u=i.scene.findInstance([this.uuid,...l]);u&&(u.overrideData=e.props[h],u.updateState(vf.apply(u.component.data,u.overrideData),i))}}else{let h=i.scene.findInstance([this.uuid,...l]);if(h){let u=Wl.zoom(h.component.data,c);if(e={...e,path:c},e.type===0){let d=e.props;if(u)for(let[f,p]of Object.entries(e.props))p===void 0&&(d===e.props&&(d={...e.props}),d[f]=u[f]);e={...e,props:d}}h.overrideData=YA.resolve(n.overrides,l),h.updateByOp(e,lo.applySimple(h.data,e),i,!1)}}}else if(this.instances.length>0){let l;if(e.path.length===0&&e.type===0){let c;for(let h of Wg.rootOverrideProps)h in e.props&&(c===void 0&&(c={}),c[h]=e.props[h]);c&&(l={...e,props:c})}else for(let c of Wg.rootOverrideProps)if(th(e.path,[c])){l=e;break}l!==void 0&&this.instances.forEach(c=>{if(c.isInstanceRoot){let h=vf.filterOp(c.overrideData,l);h&&c.updateByOp(h,lo.applySimple(c.data,h),i,!0)}}),this.instances.forEach(c=>{if(!c.isInstanceRoot){let h=vf.filterOp(c.overrideData,e);if(h){let u;s===c.data&&e===h?u=n:u=lo.applySimple(c.data,h),c.updateByOp(h,u,i,!0)}}})}}updateByPatchedOpBase(e,n,i){if(this.dataPatched=n,e.path.length===0&&e.type===0)e.props.type!==void 0&&!Of.is(e.props.type)&&fh.changeEntityProptotype(this,n,i);else if(e.path.length===1&&e.path[0]==="geometry"&&e.type===0&&"type"in e.props){fh.changeEntityProptotype(this,n,i);for(let r of this.children)Pn.is(r)&&r.updateVisible()}this.updateByPatchedOp(e,n,i)}updateByPatchedOp(e,n,i){if(e.path.length===0&&e.type===0&&this.updateState(e.props,i),th(e.path,["pathSnapping"])!==null&&this.updatePathSnapping(n.pathSnapping),th(e.path,["cloner"])!==null){let r=lo.drop(e,1);r.path.length===0&&r.type===0&&r.props.disabled===!0?this.setFromClonerState(null,i):this.cloner?this.cloner.updateState(n.cloner,i.scene):(this.setFromClonerState(n.cloner,i),this.expandCloner(i.scene)),this.updateVisible()}}updatePathSnapping(e){this._updatedPathSnapping=e,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(e){var p,v,g,m,y;let n=((p=this._updatedPathSnapping)==null?void 0:p.pathId)??this.dataPatched.pathSnapping.pathId,i=((v=this._updatedPathSnapping)==null?void 0:v.slide)??this.dataPatched.pathSnapping.slide??0,r=((g=this._updatedPathSnapping)==null?void 0:g.offset)??this.dataPatched.pathSnapping.offset,s=((m=this._updatedPathSnapping)==null?void 0:m.orientation)??this.dataPatched.pathSnapping.orientation;if(n===null)return;let o=e.find(n);if(!o||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let a=o.data,l=mJ(a.geometry.path),c=(i+r)%1,h=l.getPointAt(c),u=this.parent?(y=this.parent)==null?void 0:y.matrixWorld:new nt;o.updateMatrixWorld();let d=new nt().multiplyMatrices(u.clone().invert(),o.matrixWorld);h.applyMatrix4(d);let f={position:h.toArray(),rotation:a.rotation};if(s==="tangential"){let _=new nt().extractRotation(o.matrixWorld),S=l.getTangentAt(c).applyMatrix4(_).add(h),A=new nt().lookAt(h,S,new N(0,1,0)),b=new Tr().setFromRotationMatrix(A);f={...f,rotation:[b.x,b.y,b.z]}}this.updateTransformState(f),this.traverseEntity(_=>{_._cameraType&&_.dispatchEvent(yIe)})}updateVisible(){var e;this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((e=this.dataPatched.cloner)==null?void 0:e.hideBase)!==!0)}updateState_Entity(e,n){e.name!==void 0&&(this.name=e.name),e.raycastLock!==void 0&&(this.raycastLock=e.raycastLock),e.visible!==void 0&&(this.updateVisible(),this.resetBBoxNeedsUpdate()),"cloner"in e&&e.cloner!==void 0&&(this.setFromClonerState(e.cloner,n),this.updateVisible()),this.updateTransformState(e)}get attachedSurfaceCloners(){return this.children.filter(e=>e instanceof fh.Cloner&&e.parameters.type==="toObject")}setFromClonerState(e,n){this.disposed||(e===null||e.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new fh.Cloner(this,e),n.scene.addPendingExpandCloner(this)):this.cloner.updateState(e,n.scene))}expandCloner(e){!this.disposed&&this.cloner&&this.cloner.expandClones(e)}invalidateClonerTransform(e){this.cloner&&this.cloner.invalidateTransform(e)}},xIe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},t.parameters),i=n.width/2,r=n.radiusTop??i,s=n.radiusBottom??i;return r===s?(r=i,s=i):r>s?(r=i,s=s*i/r):(r=r*i/s,s=i),{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width),radiusTop:r,radiusBottom:s})}}static build(t){let{width:e,depth:n,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l,radiusTop:c,radiusBottom:h,cornerRadius:u,cornerSegments:d,hollow:f}=t.parameters,p;return u||f?p=new vJ(c,h,i,r,s,o,a,l*Math.PI/180,u,u,d,f):p=new AO(c,h,i,r,s,o,a,l*Math.PI/180),p.scale(1,1,n/e),Object.assign(p,{userData:{...t,type:"CylinderGeometry"}})}};function Nu(t,e,n){n.x=t.x*e.x,n.y=t.y,n.z=t.x*e.y}function Sj(t){return new Se(t.y,-t.x)}var vJ=class extends Lt{constructor(t,e,n,i,r,s,o,a,l,c,h,u,d=!1){super(),this.type="RoundedCylinderBufferGeometry",t=t!==void 0?t:1,e=e!==void 0?e:1,n=n||1,i=Math.floor(i)||8,r=Math.floor(r)||1,s=s!==void 0?s:!1,o=o!==void 0?o:0,a=a!==void 0?a:Math.PI*2,s&&(l=0,c=0);let f=[],p=[],v=[],g=[],m=0,y=n/2,_=new N,S=new N;d&&t==0&&(t=l),d&&e==0&&(e=c);let A=new Se(t,y),b=new Se(e,-y),T=null,M=null,E=null,P=null,R=A.clone().sub(b),F=0,B=0,k=0;u>0&&(F=Math.min(t,e)*(1-u),B=t-F,k=e-F);let j=A.clone();j.x-=F;let Z=Math.PI-R.angle(),ee=R.angle(),O=Math.tan(ee/2),W=Math.tan(Z/2),H=O+W,Y=u?H:W,z=u?H:O;if(l=Math.min(l,(t-B)/Y,R.length()/H),c=Math.min(c,(e-k)/z,R.length()/H),l>0){let oe=l/O;T=A.clone().sub(new Se(oe,l)),u&&(E=T.clone(),E.x-=F-H*l),A.sub(R.clone().setLength(oe))}if(c>0){let oe=c/W;M=b.clone().sub(new Se(oe,-c)),b.add(R.clone().setLength(oe)),u&&(P=M.clone(),P.x-=F-H*c,j.sub(R.clone().setLength(oe)))}R=A.clone().sub(b);let X=R.length()<.5,q=[];for(let oe=0;oe<=i;oe++){let ve=[],$=oe/i,se=$*a+o,ne=new Se(Math.sin(se),Math.cos(se));P&&M?(re(ve,$,ne,Z,c,P,-1,!0),re(ve,$,ne,ee,c,M,-1,!1)):M?(G(ve,ne,M.x,0,-1),re(ve,$,ne,ee,c,M,-1,!1)):s||G(ve,ne,e,k,-1);let ie=Sj(R).normalize();if(Nu(ie,ne,_),!X)for(let me=0;me<=r;me++){let xe=me/r,Ae=R.clone().multiplyScalar(xe).add(b);Nu(Ae,ne,S),p.push(S.x,S.y,S.z),v.push(_.x,_.y,_.z),g.push($,.5+S.y/n),ve.push(m++)}if(E&&T?(re(ve,$,ne,Z,l,T,1,!1),re(ve,$,ne,ee,l,E,1,!0)):T?(re(ve,$,ne,Z,l,T,1,!1),G(ve,ne,T.x,0,1)):s||G(ve,ne,t,B,1),u&&!X){let me=Sj(R).multiplyScalar(-1).normalize();Nu(me,ne,_);for(let xe=0;xe<=r;xe++){let Ae=xe/r,we=R.clone().multiplyScalar(-Ae).add(j);Nu(we,ne,S),p.push(S.x,S.y,S.z),v.push(_.x,_.y,_.z),g.push($,.5+S.y/n),ve.push(m++)}}u&&!s&&ve.push(ve[0]),q.push(ve)}for(let oe=0;oe<q.length-1;oe++)for(let ve=0;ve<q[0].length-1;ve++){if(s&&u&&ve==r)continue;let $=q[oe][ve],se=q[oe+1][ve],ne=q[oe+1][ve+1],ie=q[oe][ve+1],me=p[ne*3+0],xe=p[ne*3+2];f.push($,se,ie),(me!=0||xe!=0)&&f.push(se,ne,ie)}a<Math.PI*2&&(K(-1,q[0],o),K(1,q[q.length-1],o+a)),this.setIndex(f),this.setAttribute("position",new ft(p,3)),this.setAttribute("normal",new ft(v,3)),this.setAttribute("uv",new ft(g,2));function re(oe,ve,$,se,ne,ie,me,xe){for(let Ae=0;Ae<h+1;Ae++){let we=Ae/h,Ee=me<0?we:1-we;xe&&(Ee-=1),Ee*=se;let Re=new Se(Math.sin(Ee),Math.cos(Ee)*me),Ue=Re.clone().multiplyScalar(ne).add(ie);Nu(Ue,$,S),p.push(S.x,S.y,S.z),Nu(Re,$,_),v.push(_.x,_.y,_.z),g.push(ve,.5+S.y/n),oe.push(m++)}}function G(oe,ve,$,se,ne){let ie=new N,me=new Se,xe=[$,se];ne<0&&xe.reverse();for(let Ae of xe)me.set(Ae,y*ne),Nu(me,ve,ie),p.push(ie.x,ie.y,ie.z),v.push(0,ne,0),g.push(.5,.5),oe.push(m++)}function K(oe,ve,$){let se=new Se(Math.sin($),Math.cos($)),ne=new Se(-Math.cos($),Math.sin($)),ie=new N,me=oe<0?(we,Ee,Re)=>f.push(we,Ee,Re):(we,Ee,Re)=>f.push(we,Re,Ee),xe=new Se((t+e+B+k)/4,0);Nu(xe,se,ie),p.push(ie.x,ie.y,ie.z),v.push(ne.x,0,ne.y),g.push(.5,.5);let Ae=m++;for(let we of ve){let Ee=p.slice(we*3,we*3+3);p.push(...Ee),v.push(ne.x,0,ne.y);let Re=g.slice(we*2,we*2+2);g.push(...Re),m++}for(let we=Ae+1;we<m-1;we++)me(Ae,we,we+1);me(Ae,m-1,Ae+1)}}},_Ie=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,depth:n,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:l,cornerRadiusTop:c,cornerRadiusBottom:h,cornerSegments:u}=t.parameters,d;return c>0||h>0||l<360?d=new vJ(0,e/2,i,r,s,o,a,l*Math.PI/180,c,h,u,0,!0):d=new FQ(e/2,i,r,s,o),d.scale(1,1,n/e),Object.assign(d,{userData:{...t,type:"ConeGeometry"}})}},wIe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,widthSegments:r,heightSegments:s,depthSegments:o,cornerRadius:a,cornerSegments:l}=t.parameters,c;return a==0?c=new Zl(e,n,i,r,s,o):c=new SIe(e,n,i,r,s,o,a,l),Object.assign(c,{userData:{...t,type:"CubeGeometry"}})}},b2=Math.PI/2,SIe=class extends Lt{constructor(t=1,e=1,n=1,i=1,r=1,s=1,o=0,a=4){super(),this.type="BoxGeometry";let l=this;i=Math.floor(i),r=Math.floor(r),s=Math.floor(s),a=Math.floor(a),o=Math.min(o,t/2,e/2,n/2);let c=[],h=[],u=[],d=[],f=0,p=0;v("z","y","x",-1,-1,n,e,t,s,r,0),v("z","y","x",1,-1,n,e,-t,s,r,1),v("x","z","y",1,1,t,n,e,i,s,2),v("x","z","y",1,-1,t,n,-e,i,s,3),v("x","y","z",1,-1,t,e,n,i,r,4),v("x","y","z",-1,-1,t,e,-n,i,r,5),o>0&&(g("z","y","x",-1,-1,1,n,e,t,s,0),g("z","y","x",1,-1,-1,n,e,t,s,1),g("z","y","x",-1,1,-1,n,e,t,s,1),g("z","y","x",1,1,1,n,e,t,s,0),g("x","y","z",-1,-1,-1,t,e,n,i,0),g("x","y","z",1,-1,1,t,e,n,i,1),g("x","y","z",-1,1,1,t,e,n,i,0),g("x","y","z",1,1,-1,t,e,n,i,1),g("y","x","z",-1,-1,1,e,t,n,r,0),g("y","x","z",1,-1,-1,e,t,n,r,1),g("y","x","z",1,1,1,e,t,n,r,1),g("y","x","z",-1,1,-1,e,t,n,r,0),m(1,1,1),m(-1,1,1),m(1,-1,1),m(-1,-1,1),m(1,1,-1),m(-1,1,-1),m(1,-1,-1),m(-1,-1,-1)),this.setIndex(c),this.setAttribute("position",new ft(h,3)),this.setAttribute("normal",new ft(u,3)),this.setAttribute("uv",new ft(d,2));function v(y,_,S,A,b,T,M,E,P,R,F){let B=(T-2*o)/P,k=(M-2*o)/R,j=T/2-o,Z=M/2-o,ee=E/2,O=P+1,W=R+1,H=0,Y=0,z=new N;for(let X=0;X<W;X++){let q=X*k-Z;for(let re=0;re<O;re++){let G=re*B-j;z[y]=G*A,z[_]=q*b,z[S]=ee,h.push(z.x,z.y,z.z),z[y]=0,z[_]=0,z[S]=E>0?1:-1,u.push(z.x,z.y,z.z),d.push(re/P),d.push(1-X/R),H+=1}}for(let X=0;X<R;X++)for(let q=0;q<P;q++){let re=f+q+O*X,G=f+q+O*(X+1),K=f+(q+1)+O*(X+1),oe=f+(q+1)+O*X;c.push(re,G,oe),c.push(G,K,oe),Y+=6}l.addGroup(p,Y,F),p+=Y,f+=H}function g(y,_,S,A,b,T,M,E,P,R,F){let B=(M-2*o)/R,k=M/2-o,j=E/2-o,Z=P/2,ee=R+1,O=0,W=0,H=new N,Y=new N;for(let z=0;z<a+1;z++){let X=z/a*b2,q=Math.sin(X)*o,re=(1-Math.cos(X))*o,G=Math.sin(X),K=Math.cos(X);H[_]=(j+q)*b,H[S]=(Z-re)*T,Y[y]=0,Y[_]=G*Math.sign(H[_]),Y[S]=K*Math.sign(H[S]);for(let oe=0;oe<ee;oe++){let ve=oe*B-k;H[y]=ve*A,h.push(H.x,H.y,H.z),u.push(Y.x,Y.y,Y.z),d.push(oe/R),d.push(0),O+=1}}for(let z=0;z<a;z++)for(let X=0;X<R;X++){let q=f+X+ee*z,re=f+X+ee*(z+1),G=f+(X+1)+ee*(z+1),K=f+(X+1)+ee*z;c.push(q,re,K),c.push(re,G,K),W+=6}l.addGroup(p,W,F),p+=W,f+=O}function m(y,_,S){let A=new N,b=new N(t/2,e/2,n/2);b.subScalar(o);let T=[],M=y*_*S>0?(P,R,F)=>c.push(P,R,F):(P,R,F)=>c.push(P,F,R);for(let P=0;P<=a;P++){let R=[],F=b2*(1-P/a),B=Math.cos(F),k=Math.sin(F),j=0;for(let Z=0;Z<=P;Z++){let ee=Math.cos(j),O=Math.sin(j);A.x=B*ee,A.y=k,A.z=B*O;let W=b.clone().addScaledVector(A,o);h.push(y*W.x,_*W.y,S*W.z),u.push(y*A.x,_*A.y,S*A.z),d.push(0,0),R.push(f++),j+=b2/P}T.push(R)}let E=T.length-1;for(let P=0;P<E;P++){let R=T[P],F=T[P+1],B=R.length-1;M(R[0],F[1],F[0]);for(let k=1;k<=B;k++)M(R[k-1],R[k],F[k]),M(R[k],F[k+1],F[k])}}}},aF=class extends Lt{constructor(t=[],e=[],n="",i=1,r=.2,s=4){super(),this.type="PolyhedronGeometryRound";let o=[],a=[],l=[];c(),h(),this.setAttribute("position",new ft(o,3)),this.setAttribute("normal",new ft(l,3)),this.setAttribute("uv",new ft(a,2));return;function c(){var ee;r=Math.min(1-1e-5,r),r==0&&(s=0);let u={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[n],d=new N,f=d.clone(),p=new Cs,v=r*i,g=i-v,m=s+1,y=new N,_=(O,W)=>y.subVectors(O,W).normalize(),S=(O,W)=>Array(O).fill(void 0).map(W),A=S(t.length/3,(O,W)=>new N().fromArray(t,W*3).setLength(i)),b=[],T=1e6;for(let O=0;O<A.length;O++){let W=A[O],H=[],Y,z,X,q=1e10,re=-1;for(;(re=e.indexOf(O,re+1))!=-1;){let ve=re-re%3;Y=e[ve+(re+1)%3],z=e[ve+(re+2)%3],X=W.distanceToSquared(A[Y]),q=Math.min(q,X),H.push([Y,z,X])}q+=1e-6;let G=[],K=0,oe=H.length;for(let ve=0;ve<oe;ve++){[Y,z,X]=H[K];let $=((ee=b[Y])==null?void 0:ee.includes(O))==!0;X<=q&&G.push(Y+ +$*T),K=H.findIndex(se=>se[0]==z)}b.push(G)}let M=[];{let O=0,W=0,H,Y,z=u==3;for(let X=0;X<=s;X++){H=X*(X+1)/2,Y=(X+1)*(X+2)/2;for(let q=0;q<s-X;q++)[O,W]=[H+q+X+2,Y+q+X+3],M.push(H,Y,...z?[W,H]:[O,Y],W,O),[H,Y]=[O,W];M.push(H,Y,H+s+2)}}let E=d.clone(),P=d.clone(),R=d.clone(),F=d.clone(),B=d.clone(),k=[],j=S(A.length,()=>S(u,()=>d.clone()));for(let O=0;O<A.length;O++){d.copy(A[O]).normalize(),E.copy(d).multiplyScalar(g);let W=b[O];for(let G=0;G<W.length;G++){let K=W[G],oe=W[(G+1)%u];p.setFromPointsAndIndices(A,O,K%T,oe%T),p.b.sub(p.a).setLength(1e10).add(p.a),p.c.sub(p.a).setLength(1e10).add(p.a),p.closestPointToPoint(E,j[O][G])}let H=[],Y=[],z=[],X=new N;s==0&&[...j[O]].reduce((G,K)=>G.add(K),X).multiplyScalar(1/u);for(let G=0;G<u;G++){let K=[],oe=(G-1+u)%u,ve=j[O][oe],$=j[O][G];d.copy(ve).sub(E),f.copy($).sub(E);let se=E.angleTo(d),ne=d.angleTo(f),ie=Math.cos(se)*v;s==0?P.copy(X):P.copy(E).setLength(g+ie),Y.push(ie);let me=[P,ve,$];for(let xe=0;xe<2;xe++){let Ae=me[xe],we=me[xe+1];F.subVectors(Ae,E),B.subVectors(we,E),R.crossVectors(F,B).normalize();for(let Ee=0;Ee<m;Ee++){let Re=[se,ne][xe]*Ee/m;d.copy(F).applyAxisAngle(R,Re).add(E),H.push(d.clone()),xe&&(_(d,E),K.push([Ee==0?Ae:d.clone(),y.clone()]))}xe&&(_(we,E),K.push([we,y.clone()]))}z.push(K)}k.push(z);let q=2*m,re=2;for(let G=0;G<u;G++){let K=q*G,oe=q*((G+1)%u),ve=[H[K]];for(let se=1;se<m;se++){F=H[K+se],B=H[oe+se],ve.push(F);for(let ne=1,ie=se-re+1;ne<=ie;ne++)d.lerpVectors(F,B,ne/(ie+1)),d.sub(E).setLength(Y[G]).add(E),ve.push(d.clone());ve.push(B)}for(let se=0;se<m;se++)ve.push(H[se+m+K]);ve.push(H[oe+m]);let $=M.map(se=>ve[se]);o.push(...$.map(se=>[se.x,se.y,se.z]).flat()),l.push(...$.map(se=>(_(se,E),[y.x,y.y,y.z])).flat())}}let Z=[];for(let O=0;O<b.length;O++)for(let W=0;W<u;W++){let H=b[O][W];if(H<T){let Y=b[H].findIndex(q=>q%T==O),z=k[O][W],X=k[H][Y];for(let q=0;q<m;q++){let re=z[q],G=X[m-q],K=z[q+1],oe=X[m-(q+1)];[re,G,K,K,G,oe].forEach(ve=>{o.push(ve[0].x,ve[0].y,ve[0].z),l.push(ve[1].x,ve[1].y,ve[1].z)})}Z.push(z[0][0],X[m][0],z[m][0],X[0][0])}}for(;Z.length;){let O,W,H,Y;[O,W]=Z.splice(0,2);let z=[O];for(;O!=W;)z.push(W),H=Z.indexOf(W),Y=H%2,W=Z.splice(H-Y,2)[1-Y];y.subVectors(z[0],z[1]).cross(d.subVectors(z[0],z[2])).normalize();let X=y.dot(z[0])<0;X&&y.negate();for(let q=1;q<=z.length-2;q++)[z[q+ +X],z[q+1-+X],z[0]].forEach(re=>{o.push(re.x,re.y,re.z),l.push(y.x,y.y,y.z)})}}function h(){let u=new N;for(let b=0;b<o.length;b+=3){u.x=o[b+0],u.y=o[b+1],u.z=o[b+2];let T=S(u)/2/Math.PI+.5,M=A(u)/Math.PI+.5;a.push(T,1-M)}let d=new N,f=new N,p=new N,v=new N,g=new Se,m=new Se,y=new Se,_=(b,T,M,E)=>{E<0&&b.x===1&&(a[T]=b.x-1),M.x===0&&M.z===0&&(a[T]=E/2/Math.PI+.5)};for(let b=0,T=0;b<o.length;b+=9,T+=6){d.set(o[b+0],o[b+1],o[b+2]),f.set(o[b+3],o[b+4],o[b+5]),p.set(o[b+6],o[b+7],o[b+8]),g.set(a[T+0],a[T+1]),m.set(a[T+2],a[T+3]),y.set(a[T+4],a[T+5]),v.copy(d).add(f).add(p).divideScalar(3);let M=S(v);_(g,T+0,d,M),_(m,T+2,f,M),_(y,T+4,p,M)}for(let b=0;b<a.length;b+=6){let T=a[b+0],M=a[b+2],E=a[b+4],P=Math.max(T,M,E),R=Math.min(T,M,E);P>.9&&R<.1&&(T<.2&&(a[b+0]+=1),M<.2&&(a[b+2]+=1),E<.2&&(a[b+4]+=1))}function S(b){return Math.atan2(b.z,-b.x)}function A(b){return Math.atan2(-b.y,Math.sqrt(b.x*b.x+b.z*b.z))}}}static fromJSON(t){return new aF(t.vertices,t.indices,t.radius,t.corner,t.cornerSides)}},bIe=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,detail:0,corner:0,cornerSides:4},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,detail:r,corner:s,cornerSides:o}=t.parameters,a=r===0&&s!==0?new yJ(e*.5,s,o):new NQ(e*.5,r);return a.scale(1,n/e,i/e),Object.assign(a,{userData:{...t,type:"DodecahedronGeometry"}})}},yJ=class extends aF{constructor(t=1,e=.2,n=4){let i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],a="DodecahedronGeometry";super(s,o,a,t,e,n),this.type=a}static fromJSON(t){return new yJ(t.radius,t.corner,t.cornerSides)}},P0=1e-12,lF=class{constructor(t){this.position=new Se,this.startPosition=new Se,this.uuid=sn.generateUUID(),this.position=t.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(t){this.position.copy(this.startPosition).add(t)}copy(t){return this.position.copy(t.position),this.startPosition.copy(t.startPosition),this}clone(){return new lF(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},vI=class extends lF{constructor(t){super(t.position),this.parent=t}copy(t){return super.copy(t),this}clone(){return new vI(this.parent).copy(this)}},dg=class extends lF{constructor(t,e){super(e),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=t,this.controls.push(new vI(this),new vI(this))}static create(t,e){let n=new dg(t,new Se(...e.position));return n.controls[0].position.set(...e.controlPrevious.position),n.controls[1].position.set(...e.controlNext.position),n.roundness=e.roundness,n.areControlsDirectionsMirrored=e.areControlsDirectionsMirrored,n}getOppositeControl(t){let e=this.controls.indexOf(t);return e===0?this.controls[1]:e===1?this.controls[0]:null}applyOffsetToControls(t,e=1){for(let n=0,i=this.controls.length;n<i;n++){let r=this.controls[n];this.position.distanceTo(r.position)<=e?r.position.copy(this.position):r.applyOffset(t)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(t){return super.copy(t),this.controls[0].copy(t.controls[0]),this.controls[1].copy(t.controls[1]),this.roundness=t.roundness,this.uuid=t.uuid,this}clone(){return new dg(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var n,i;let t=(n=this.curveBefore)==null?void 0:n.getTangentAt(1),e=(i=this.curveAfter)==null?void 0:i.getTangentAt(0);return[t,e]}computeNormals(t=new Se,e=new Se){let[n,i]=this.computeTangents();return n&&i&&(bj(n,t),bj(i,e)),[t,e]}computeTangent(t=new Se){let[e,n]=this.computeTangents();return e&&n&&t.copy(e).add(n).normalize(),t}computeNormal(t=new Se){let[e,n]=this.computeNormals();return t.copy(e).add(n).normalize(),t}};function bj(t,e=new Se){let n=t.length();return e.set(-t.y/n,t.x/n)}var cF=t=>t,wv=new Se,ME=new Se,AIe=new Se,MIe=new Se,EIe=new Se,CIe=new Se,xJ=new N,_J=new N;function TIe(t){let e=new Se;e.addVectors(t.v0,wv.subVectors(t.v1,t.v0).multiplyScalar(2/3));let n=new Se;return n.addVectors(t.v2,ME.subVectors(t.v1,t.v2).multiplyScalar(2/3)),new Na(t.v0,e,n,t.v2)}function ty(t,e,n=Number.EPSILON){return Math.abs(t-e)<n}function PIe(t,e,n=Number.EPSILON){return t.distanceTo(e)<n}function DIe(t,e,n=Number.EPSILON){return t.distanceTo(e)<n}function wJ(t,e,n){let i=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),r=Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2)),s=Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2));return Math.acos((r*r+i*i-s*s)/(2*r*i))}function RIe(t,e,n){return Mj(t,e)&&Mj(e,n)&&yI(t.position,e.position,n.position)}function yI(t,e,n){return wv.copy(e).sub(t).cross(ME.copy(n).sub(t))===0}function LIe(t,e,n,i,r){let s=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),o=(t.y+e.y)/2,a=(t.x+e.x)/2,l=Math.sqrt(Math.pow(n,2)-Math.pow(s/2,2))*(t.y-e.y)/s,c=Math.sqrt(Math.pow(n,2)-Math.pow(s/2,2))*(e.x-t.x)/s;return i.set(a+l,o+c),r.set(a-l,o-c),[i,r]}function IIe(t,e,n){let i=t.distanceTo(n),r=e.distanceTo(n);return i<r?e:t}function BIe(t,e,n,i,r,s){let o=e.x-t.x,a=e.y-t.y,l=n.x-t.x,c=n.y-t.y,h=Math.sqrt((o+l)*(o+l)+(a+c)*(a+c)),u;return wJ(e,t,n)>Math.PI&&(h*=-1),ty(c,a)?u=(a+c)*(i/h-.5)*8/3/(o-l):u=(o+l)*(i/h-.5)*8/3/(c-a),r.set(e.x-u*a,e.y+u*o),s.set(n.x+u*c,n.y-u*l),[r,s]}function Aj(t,e){return t.position.equals(t.controls[1].position)&&e.position.equals(e.controls[0].position)}function Mj(t,e){return yI(t.position,t.controls[1].position,e.position)&&yI(t.position,e.controls[0].position,e.position)}function OIe(t,e,n,i,r=.5){let s=wv.subVectors(e,t).multiplyScalar(r).add(t),o=ME.subVectors(n,e).multiplyScalar(r).add(e),a=AIe.subVectors(i,n).multiplyScalar(r).add(n),l=s,c=MIe.subVectors(o,s).multiplyScalar(r).add(s),h=EIe.subVectors(a,o).multiplyScalar(r).add(o),u=a,d=CIe.subVectors(h,c).multiplyScalar(r).add(c);return[t.x,t.y,l.x,l.y,c.x,c.y,d.x,d.y,h.x,h.y,u.x,u.y,i.x,i.y]}function FIe(t,e,n=12,i=!0){let r=_J.set(0,0,0),s,o=0;for(let a=0;a<e.length;a++){let l=cF(e[a]),c=wv,h=xf(l,n);for(let u=0;u<=h;u++)if(l instanceof Na||l instanceof Hh||l instanceof Wa){if(l.getPoint(u/h,c),r.set(c.x,c.y,0),s!==void 0&&DIe(s,r))continue;s===void 0&&(s=xJ),s.copy(r),t.setXYZ(o,r.x,r.y,r.z),o++}}return i&&o>1&&!(t.getX(o-1)===t.getX(0)&&t.getY(o-1)===t.getY(0)&&t.getZ(o-1)===t.getZ(0))&&(t.setXYZ(o,t.getX(0),t.getY(0),t.getZ(0)),o++),t}function NIe(t,e,n,i=12,r=!0){let s=_J.set(0,0,0),o=0,a=[];for(let l=0;l<e.length;l++){if(n[l]===!1)continue;let c,h=cF(e[l]),u=wv,d=xf(h,i);a.push(d);for(let f=0;f<=d;f++)if(h instanceof Na||h instanceof Hh||h instanceof Wa){if(h.getPoint(f/d,u),s.set(u.x,u.y,0),c==null?void 0:c.equals(s))continue;c===void 0?c=xJ:(t.setXYZ(o,c.x,c.y,c.z),o++,t.setXYZ(o,s.x,s.y,s.z),o++),c.copy(s)}}return r&&o>1&&!(t.getX(o-1)===t.getX(0)&&t.getY(o-1)===t.getY(0)&&t.getZ(o-1)===t.getZ(0))&&(t.setXYZ(o,t.getX(0),t.getY(0),t.getZ(0)),o++),a}function Ej(t,e=12,n=!1){let i=[];for(let r=0,s=t.length;r<s;r++){let o=t[r],a=0;if(n&&o.roundedCurveCorner!==void 0){let l=xf(o.roundedCurveCorner,e)*.5;r>0&&(i[r-1]+=l),a+=l}o.curveAfter!==void 0&&(a+=xf(o.curveAfter,e)),i.push(a)}return t.length>0&&n&&t[0].roundedCurveCorner!==void 0&&(i[t.length-1]+=xf(t[0].roundedCurveCorner,e)*.5),i}function xf(t,e=12){return t&&t instanceof uE?e*2:t&&(t instanceof Wa||t instanceof IQ)?1:t&&t instanceof bO?e*t.points.length:e}function UIe(t,e,n=12,i=!0){let r,s=0;for(let o=0;o<e.length;o++){let a=cF(e[o]),l=xf(a,n),c=wv;for(let h=0;h<=l;h++)if(a instanceof Na||a instanceof Hh||a instanceof Wa){if(a.getPoint(h/l,c),r!==void 0&&PIe(r,c,P0))continue;r===void 0&&(r=ME),r.copy(c),t.push(c.x,c.y),s++}}return ty(t[0],t[t.length-2],P0)&&ty(t[1],t[t.length-1],P0)&&(t.pop(),t.pop()),i&&s>1&&!(ty(t[s-1],t[1],P0)&&ty(t[s-2],t[0],P0))&&(t.push(t[0],t[1]),s++),t}var A2=new Se,kIe=new Se,zIe=new Se,GIe=new Se,HIe=new Se,VIe=new Se,_i=class extends CA{constructor(t=100,e=100){super(),this.points=[],this.shapeHoles=[],this.plane=new $s(new N(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=sn.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=t,this._height=e}static createFromState(t,e,n){let i=new _i;return i.isClosed=t.isClosed,i.points=t.points.map(r=>dg.create(r.id,r.data)),typeof t.roundness=="number"&&(i.roundness=t.roundness),i.shapeHoles=t.shapeHoles.map(r=>_i.createFromState(r)),e!==void 0&&n!==void 0&&i.applySize(e,n),i.update(),i}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(t){if(this._roundness!==t){this._roundness=t;for(let e=0,n=this.points.length;e<n;e++)this.points[e].roundness=t;this.needsUpdate=!0}}getPointsIndexesByIds(t){return t.map(e=>this.getPointIndexById(e)).filter(e=>e>=0)}getPointIndexById(t){let e=this.points.length,n=this.points.findIndex(i=>i.uuid===t);if(n<0){let i=e;for(let r=0,s=this.shapeHoles.length;r<s;r++){let o=this.shapeHoles[r],a=o.points.length,l=o.getPointIndexById(t);if(l<0)i+=a;else return l+i}}return n}getLineIndexById(t){return this.getPointIndexById(t)}getBezierPoint(t){if(t<=this.points.length-1)return this.points[t];if(this.shapeHoles.length>0){let e=this.points.length;for(let n=0,i=this.shapeHoles.length;n<i;n++){let r=this.shapeHoles[n],s=t-e;if(s<=r.points.length-1)return r.points[s];e+=r.points.length}}throw new Error("This shape does not have a point for this index: "+t)}getBezierPointIndex(t){let e=this.points.indexOf(t);if(e>=0)return e;if(e=this.points.length,this.shapeHoles.length>0)for(let n=0,i=this.shapeHoles.length;n<i;n++){let r=this.shapeHoles[n],s=r.points.indexOf(t);if(s>=0)return e+s;e+=r.points.length}return-1}getAllPoints(){let t=[].concat(...this.shapeHoles.map(e=>e.points));return[...this.points,...t]}applySize(t,e){t===0&&(t=.001),e===0&&(e=.001),this._width=t,this._height=e}applyScale(t,e){let n=A2.set(t,e);for(let i=0,r=this.points.length;i<r;i++){let s=this.points[i];s.position.multiply(n),s.controls[0].position.multiply(n),s.controls[1].position.multiply(n)}for(let i=0,r=this.shapeHoles.length;i<r;i++)this.shapeHoles[i].applyScale(t,e);this._update()}createPoint(t,e=0,n=sn.generateUUID()){let i;t instanceof Se?i=t:i=new Se(t,e);let r=new dg(n,i);return r.roundness=this.roundness,r}addPoint(t){this.points.push(t),this.needsUpdate=!0}addPointAt(t,e){this.points.splice(e,0,t),this.needsUpdate=!0}getPointByUuid(t){for(let e=0,n=this.points.length;e<n;e++){let i=this.points[e];if(i.uuid===t)return i}for(let e=0,n=this.shapeHoles.length;e<n;e++){let i=this.shapeHoles[e].getPointByUuid(t);if(i)return i}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(t){let e=this.points.indexOf(t);e>=0&&this.points.splice(e,1),this.needsUpdate=!0}removePointById(t){let e=this.points.find(n=>n.uuid===t);e&&this.removePoint(e)}update(){for(let t=0,e=this.shapeHoles.length;t<e;t++)this.shapeHoles[t].update();this._update()}extractShapePointsToBuffer(t,e=12,n=!1){this.subdivision=e,this.curveDivisions===void 0&&this.computeCurveDivisions(e);let i=n?this.roundedCurveDivisions:this.curveDivisions;return FIe(t,n?this.roundedCurves:this.curves,e,this.autoClose),i.reduce((r,s)=>r+s,0)+1}computeCurveDivisions(t=12){return this.curveDivisions=Ej(this.points,t,!1),this.roundedCurveDivisions=Ej(this.points,t,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(t,e,n=12){return NIe(t,this.curves,e,n,this.autoClose).reduce((i,r)=>i+r,0)*2}extractShapePointsToFlatArray(t,e=12){return this.subdivision=e,this.curveDivisions===void 0&&this.computeCurveDivisions(e),UIe(t,this.roundedCurves,e,this.autoClose)}getCurveIndexFromVertexId(t,e=!1){let n=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let i=e?this.roundedCurveDivisions:this.curveDivisions,r=0;e&&this.points[0].roundedCurveCorner!==void 0&&(r=xf(this.points[0].roundedCurveCorner,this.subdivision)*.5);let s=t-r;s<0&&(s+=i.reduce((o,a)=>o+a,0));for(let o=0,a=i.length;o<a;o++){let l=i[o];if(s<n+l)return[o,(s-n+1)/l];n+=l}return[0,1]}getCurveT(t,e,n){let i=this.points[t],r=this.points[t>=this.points.length-1?0:t+1],s=this.curveDivisions,o=s[t];if(Aj(i,r)){let l=i.position.distanceTo(r.position);return i.position.distanceTo(A2.set(n.x,n.y))/l}let a=0;for(let l=0;l<t;l++)a+=s[l];return(e-a)/o}dispose(){}_applyCurveForPoint(t,e){Aj(e,t)?this.lineTo(t.position.x,t.position.y):this.bezierCurveTo(e.controls[1].position.x,e.controls[1].position.y,t.controls[0].position.x,t.controls[0].position.y,t.position.x,t.position.y);let n=this.curves[this.curves.length-1];t.curveBefore=n,e.curveAfter=n;let i=n.clone();t.roundedCurveBefore=i,e.roundedCurveAfter=i,t.roundedCurveCorner=void 0,this.roundedCurves.push(i)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let e=0,n=this.points.length;e<n;e++){let i=this.points[e];if(e===0)this.moveTo(i.position.x,i.position.y);else{let r=this.points[e-1];this._applyCurveForPoint(i,r)}}let t=this.getLastPoint();if(t!=null&&t.curveAfter&&(t.curveAfter=void 0),this.isClosed){let e=this.points[0],n=this.points[this.points.length-1];this._applyCurveForPoint(e,n)}if(this.points.length>2){let e=0;for(let n=0,i=this.points.length;n<i;n++){let r=this.points[n],s=this.points[n-1]??this.points[this.points.length-1],o=this.points[n+1]??this.points[0],a=r.roundness,l=s&&o&&RIe(s,r,o);if(!r.controlsMoved()&&a>0&&!l){let c=r.curveBefore,h=r.curveAfter;if(c===void 0||h===void 0)continue;let u=r.roundedCurveBefore,d=r.roundedCurveAfter,f=c.getLength(),p=h.getLength(),v=Math.min(a,f*.499),g=Math.min(a,p*.499),m=Math.min(v,g),y=1-m/f,_=m/p,S=c.getPointAt(y,A2),A=h.getPointAt(_,kIe);this._subSplitCurve(c,u,y,S,void 0),this._subSplitCurve(h,d,_,void 0,A);let b;if(this.useCubicForRoundedCorners){let T=wJ(S,r.position,A)/2,M=Math.tan(T)*S.distanceTo(r.position),[E,P]=LIe(S,A,M,zIe,GIe),R=IIe(E,P,r.position),[F,B]=BIe(R,S,A,M,HIe,VIe);b=new Na(S.clone(),F.clone(),B.clone(),A.clone())}else b=new Hh(S.clone(),r.position.clone(),A.clone());r.roundedCurveCorner=b,this.roundedCurves.splice(n+e,0,b),e++}}}}_subSplitCurve(t,e,n,i,r){if(t instanceof Wa)i!==void 0&&e.v2.copy(i),r!==void 0&&e.v1.copy(r);else{let s=t,o=e,a=s.getUtoTmapping(n,0),l=OIe(s.v0,s.v1,s.v2,s.v3,a);return i!==void 0&&(o.v0.set(l[0],l[1]),o.v1.set(l[2],l[3]),o.v2.set(l[4],l[5]),o.v3.set(l[6],l[7])),r!==void 0&&(o.v0.set(l[6],l[7]),o.v1.set(l[8],l[9]),o.v2.set(l[10],l[11]),o.v3.set(l[12],l[13])),o}return e}clone(){let t=new _i(this._width,this._height);return t.points=this.points.map(e=>e.clone()),t.isClosed=this.isClosed,t.roundness=this.roundness,t.isMesh2D=this.isMesh2D,t.shapeHoles=this.shapeHoles.map(e=>e.clone()),t}toJSON(){return{points:this.points.reduce((t,e)=>t.concat(e.toJSON()),[]),shapeHoles:this.shapeHoles.map(t=>t.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(t){var n;this.points=[],this.pointIDs=0;let e=t.points.length/7;for(let i=0;i<e;i++){let r=i*7,s=t.points[r+0],o=t.points[r+1],a=t.points[r+2],l=t.points[r+3],c=t.points[r+4],h=t.points[r+5],u=t.points[r+6],d=new dg(sn.generateUUID(),new Se(s,o));d.controls[0].position.set(a,l),d.controls[1].position.set(c,h),d.roundness=u,this.points.push(d)}return this.shapeHoles=(n=t.shapeHoles)!=null&&n.length?t.shapeHoles.map(i=>{let r=new _i;return r.fromJSON(i),r}):[],this.isClosed=t.isClosed,this._roundness=t.roundness,this._update(),this}fromShape(t){let e=(i,r)=>{r instanceof Na&&r.v3.equals(i.position)&&i.controls[0].position.copy(r.v2)},n=i=>{let r=[],s,o;for(s=0,o=i.length;s<o;s++)i[s]instanceof Hh&&(i[s]=TIe(i[s]));for(s=0,o=i.length;s<o;s++){let c=i[s],h=s>0?i[s-1]:null,u;c instanceof Na?(u=this.createPoint(c.v0),u.controls[1].position.copy(c.v1)):c instanceof Wa&&(u=this.createPoint(c.v1)),u!==void 0&&(h!==null&&e(u,h),r.push(u))}let a=i[i.length-1],l=!1;return a instanceof Na?a.v3.equals(r[0].position)&&(r[0].controls[0].position.copy(a.v2),l=!0):a instanceof Wa&&a.v2.equals(r[0].position)&&(l=!0),this.isClosed=l,r};return this.points=n(t.curves),t instanceof CA&&(this.shapeHoles=t.holes.map(i=>{let r=new _i;return r.fromShape(i),r})),this.update(),this}updatePoint(t,e){let n=this.getPointByUuid(t);n&&(e.position!==void 0&&n.position.fromArray(e.position),e.roundness!==void 0&&(n.roundness=e.roundness),e.areControlsDirectionsMirrored!==void 0&&(n.areControlsDirectionsMirrored=e.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(t,e){var i;let n=(i=this.getPointByUuid(t))==null?void 0:i.controls[0];n&&(e.position&&n.position.fromArray(e.position),this.needsUpdate=!0)}updateNextControl(t,e){var i;let n=(i=this.getPointByUuid(t))==null?void 0:i.controls[1];n&&(e.position&&n.position.fromArray(e.position),this.needsUpdate=!0)}},xI=Math.PI*2;function M2({x:t,y:e},n,i,r,s){return{x:t*n+r,y:e*i+s}}function jIe(t,e){let n=e===1.5707963267948966?.551915024494:e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),i=Math.cos(t),r=Math.sin(t),s=Math.cos(t+e),o=Math.sin(t+e);return[{x:i-r*n,y:r+i*n},{x:s+o*n,y:o-s*n},{x:s,y:o}]}function Cj(t,e,n,i){let r=t*i-e*n<0?-1:1,s=Math.min(1,Math.max(-1,t*n+e*i));return r*Math.acos(s)}function WIe(t,e,n,i,r,s,o,a,l,c){let h=Math.pow(r,2),u=Math.pow(s,2),d=Math.pow(o,2),f=Math.pow(a,2),p=h*u-h*f-u*d;p<0&&(p=0),p/=h*f+u*d,p=Math.sqrt(p)*(l===c?-1:1);let v=p*r/s*a,g=p*-s/r*o,m=v+(t+n)/2,y=g+(e+i)/2,_=(o-v)/r,S=(a-g)/s,A=(-o-v)/r,b=(-a-g)/s,T=Cj(1,0,_,S),M=Cj(_,S,A,b);return!c&&M>0&&(M-=xI),c&&M<0&&(M+=xI),{centerx:m,centery:y,ang1:T,ang2:M}}function XIe({px:t,py:e,cx:n,cy:i,rx:r,ry:s,largeArcFlag:o,sweepFlag:a}){let l=[];if(r===0||s===0)return[];let c=(t-n)/2,h=(e-i)/2;if(c===0&&h===0)return[];r=Math.abs(r),s=Math.abs(s);let u=Math.pow(c,2)/Math.pow(r,2)+Math.pow(h,2)/Math.pow(s,2);u>1&&(r*=Math.sqrt(u),s*=Math.sqrt(u));let d=WIe(t,e,n,i,r,s,c,h,o,a),{ang1:f,ang2:p}=d,{centerx:v,centery:g}=d,m=Math.abs(p)/(xI/4);Math.abs(1-m)<1e-7&&(m=1);let y=Math.max(Math.ceil(m),1);p/=y;for(let _=0;_<y;_++)l.push(jIe(f,p)),f+=p;return l.map(_=>{let{x:S,y:A}=M2(_[0],r,s,v,g),{x:b,y:T}=M2(_[1],r,s,v,g),{x:M,y:E}=M2(_[2],r,s,v,g);return{x1:S,y1:A,x2:b,y2:T,x:M,y:E}})}var Rn;(function(t){t[t.ODD=0]="ODD",t[t.NONZERO=1]="NONZERO",t[t.POSITIVE=2]="POSITIVE",t[t.NEGATIVE=3]="NEGATIVE",t[t.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(Rn||(Rn={}));var zi;(function(t){t[t.POLYGONS=0]="POLYGONS",t[t.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",t[t.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(zi||(zi={}));function Pt(t,e){if(!t)throw e||"Assertion Failed!"}var At=function(){function t(){}return t.vertEq=function(e,n){return e.s===n.s&&e.t===n.t},t.vertLeq=function(e,n){return e.s<n.s||e.s===n.s&&e.t<=n.t},t.transLeq=function(e,n){return e.t<n.t||e.t===n.t&&e.s<=n.s},t.edgeGoesLeft=function(e){return t.vertLeq(e.Dst,e.Org)},t.edgeGoesRight=function(e){return t.vertLeq(e.Org,e.Dst)},t.vertL1dist=function(e,n){return Math.abs(e.s-n.s)+Math.abs(e.t-n.t)},t.edgeEval=function(e,n,i){Pt(t.vertLeq(e,n)&&t.vertLeq(n,i));var r=n.s-e.s,s=i.s-n.s;return r+s>0?r<s?n.t-e.t+(e.t-i.t)*(r/(r+s)):n.t-i.t+(i.t-e.t)*(s/(r+s)):0},t.edgeSign=function(e,n,i){Pt(t.vertLeq(e,n)&&t.vertLeq(n,i));var r=n.s-e.s,s=i.s-n.s;return r+s>0?(n.t-i.t)*r+(n.t-e.t)*s:0},t.transEval=function(e,n,i){Pt(t.transLeq(e,n)&&t.transLeq(n,i));var r=n.t-e.t,s=i.t-n.t;return r+s>0?r<s?n.s-e.s+(e.s-i.s)*(r/(r+s)):n.s-i.s+(i.s-e.s)*(s/(r+s)):0},t.transSign=function(e,n,i){Pt(t.transLeq(e,n)&&t.transLeq(n,i));var r=n.t-e.t,s=i.t-n.t;return r+s>0?(n.s-i.s)*r+(n.s-e.s)*s:0},t.vertCCW=function(e,n,i){return e.s*(n.t-i.t)+n.s*(i.t-e.t)+i.s*(e.t-n.t)>=0},t.interpolate=function(e,n,i,r){return e=e<0?0:e,i=i<0?0:i,e<=i?i===0?(n+r)/2:n+(r-n)*(e/(e+i)):r+(n-r)*(i/(e+i))},t.intersect=function(e,n,i,r,s){var o,a,l;t.vertLeq(e,n)||(l=e,e=n,n=l),t.vertLeq(i,r)||(l=i,i=r,r=l),t.vertLeq(e,i)||(l=e,e=i,i=l,l=n,n=r,r=l),t.vertLeq(i,n)?t.vertLeq(n,r)?(o=t.edgeEval(e,i,n),a=t.edgeEval(i,n,r),o+a<0&&(o=-o,a=-a),s.s=t.interpolate(o,i.s,a,n.s)):(o=t.edgeSign(e,i,n),a=-t.edgeSign(e,r,n),o+a<0&&(o=-o,a=-a),s.s=t.interpolate(o,i.s,a,r.s)):s.s=(i.s+n.s)/2,t.transLeq(e,n)||(l=e,e=n,n=l),t.transLeq(i,r)||(l=i,i=r,r=l),t.transLeq(e,i)||(l=e,e=i,i=l,l=n,n=r,r=l),t.transLeq(i,n)?t.transLeq(n,r)?(o=t.transEval(e,i,n),a=t.transEval(i,n,r),o+a<0&&(o=-o,a=-a),s.t=t.interpolate(o,i.t,a,n.t)):(o=t.transSign(e,i,n),a=-t.transSign(e,r,n),o+a<0&&(o=-o,a=-a),s.t=t.interpolate(o,i.t,a,r.t)):s.t=(i.t+n.t)/2},t}(),D0=function(){function t(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return t}(),PS=function(){function t(e){this.side=e,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(t.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(e){this.Sym.Lface=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(e){this.Sym.Org=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(e){this.Sym.Lnext=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(e){this.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(e){this.Lnext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(e){this.Sym.Onext=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(e){this.Sym.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(e){this.Sym.Lnext.Sym=e},enumerable:!0,configurable:!0}),t}(),pm=function(){function t(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return t}(),Tj=function(){function t(){var e=new pm,n=new D0,i=new PS(0),r=new PS(1);e.next=e.prev=e,e.anEdge=null,n.next=n.prev=n,i.next=i,i.Sym=r,r.next=r,r.Sym=i,this.vHead=e,this.fHead=n,this.eHead=i,this.eHeadSym=r}return t.prototype.makeEdge_=function(e){var n=new PS(0),i=new PS(1);e.Sym.side<e.side&&(e=e.Sym);var r=e.Sym.next;return i.next=r,r.Sym.next=n,n.next=e,e.Sym.next=i,n.Sym=i,n.Onext=n,n.Lnext=i,n.Org=null,n.Lface=null,n.winding=0,n.activeRegion=null,i.Sym=n,i.Onext=i,i.Lnext=n,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,n},t.prototype.splice_=function(e,n){var i=e.Onext,r=n.Onext;i.Sym.Lnext=n,r.Sym.Lnext=e,e.Onext=r,n.Onext=i},t.prototype.makeVertex_=function(e,n,i){var r=e;Pt(r,"Vertex can't be null!");var s=i.prev;r.prev=s,s.next=r,r.next=i,i.prev=r,r.anEdge=n;var o=n;do o.Org=r,o=o.Onext;while(o!==n)},t.prototype.makeFace_=function(e,n,i){var r=e;Pt(r,"Face can't be null");var s=i.prev;r.prev=s,s.next=r,r.next=i,i.prev=r,r.anEdge=n,r.trail=null,r.marked=!1,r.inside=i.inside;var o=n;do o.Lface=r,o=o.Lnext;while(o!==n)},t.prototype.killEdge_=function(e){e.Sym.side<e.side&&(e=e.Sym);var n=e.next,i=e.Sym.next;n.Sym.next=i,i.Sym.next=n},t.prototype.killVertex_=function(e,n){var i=e.anEdge,r=i;do r.Org=n,r=r.Onext;while(r!==i);var s=e.prev,o=e.next;o.prev=s,s.next=o},t.prototype.killFace_=function(e,n){var i=e.anEdge,r=i;do r.Lface=n,r=r.Lnext;while(r!==i);var s=e.prev,o=e.next;o.prev=s,s.next=o},t.prototype.makeEdge=function(){var e=new pm,n=new pm,i=new D0,r=this.makeEdge_(this.eHead);return this.makeVertex_(e,r,this.vHead),this.makeVertex_(n,r.Sym,this.vHead),this.makeFace_(i,r,this.fHead),r},t.prototype.splice=function(e,n){var i=!1,r=!1;if(e!==n){if(n.Org!==e.Org&&(r=!0,this.killVertex_(n.Org,e.Org)),n.Lface!==e.Lface&&(i=!0,this.killFace_(n.Lface,e.Lface)),this.splice_(n,e),!r){var s=new pm;this.makeVertex_(s,n,e.Org),e.Org.anEdge=e}if(!i){var o=new D0;this.makeFace_(o,n,e.Lface),e.Lface.anEdge=e}}},t.prototype.delete=function(e){var n=e.Sym,i=!1;if(e.Lface!==e.Rface&&(i=!0,this.killFace_(e.Lface,e.Rface)),e.Onext===e)this.killVertex_(e.Org,null);else if(e.Rface.anEdge=e.Oprev,e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev),!i){var r=new D0;this.makeFace_(r,e,e.Lface)}n.Onext===n?(this.killVertex_(n.Org,null),this.killFace_(n.Lface,null)):(e.Lface.anEdge=n.Oprev,n.Org.anEdge=n.Onext,this.splice_(n,n.Oprev)),this.killEdge_(e)},t.prototype.addEdgeVertex=function(e){var n=this.makeEdge_(e),i=n.Sym;this.splice_(n,e.Lnext),n.Org=e.Dst;var r=new pm;return this.makeVertex_(r,i,n.Org),n.Lface=i.Lface=e.Lface,n},t.prototype.splitEdge=function(e){var n=this.addEdgeVertex(e),i=n.Sym;return this.splice_(e.Sym,e.Sym.Oprev),this.splice_(e.Sym,i),e.Dst=i.Org,i.Dst.anEdge=i.Sym,i.Rface=e.Rface,i.winding=e.winding,i.Sym.winding=e.Sym.winding,i.idx=e.idx,i.Sym.idx=e.Sym.idx,i},t.prototype.connect=function(e,n){var i=!1,r=this.makeEdge_(e),s=r.Sym;if(n.Lface!==e.Lface&&(i=!0,this.killFace_(n.Lface,e.Lface)),this.splice_(r,e.Lnext),this.splice_(s,n),r.Org=e.Dst,s.Org=n.Org,r.Lface=s.Lface=e.Lface,e.Lface.anEdge=s,!i){var o=new D0;this.makeFace_(o,r,e.Lface)}return r},t.prototype.zapFace=function(e){var n=e.anEdge,i,r,s,o,a;r=n.Lnext;do i=r,r=i.Lnext,i.Lface=null,i.Rface===null&&(i.Onext===i?this.killVertex_(i.Org,null):(i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),s=i.Sym,s.Onext===s?this.killVertex_(s.Org,null):(s.Org.anEdge=s.Onext,this.splice_(s,s.Oprev)),this.killEdge_(i));while(i!=n);o=e.prev,a=e.next,a.prev=o,o.next=a},t.prototype.countFaceVerts_=function(e){var n=e.anEdge,i=0;do i++,n=n.Lnext;while(n!==e.anEdge);return i},t.prototype.mergeConvexFaces=function(e){var n,i,r,s,o,a,l;for(n=this.fHead.next;n!==this.fHead;n=n.next)if(n.inside)for(i=n.anEdge,o=i.Org;r=i.Lnext,s=i.Sym,s&&s.Lface&&s.Lface.inside&&(a=this.countFaceVerts_(n),l=this.countFaceVerts_(s.Lface),a+l-2<=e&&At.vertCCW(i.Lprev.Org,i.Org,s.Lnext.Lnext.Org)&&At.vertCCW(s.Lprev.Org,s.Org,i.Lnext.Lnext.Org)&&(r=s.Lnext,this.delete(s),i=null,s=null)),!(i&&i.Lnext.Org===o);)i=r;return!0},t.prototype.check=function(){var e=this.fHead,n=this.vHead,i=this.eHead,r,s,o,a,l,c;for(s=e,s=e;(r=s.next)!==e;s=r){Pt(r.prev===s),l=r.anEdge;do Pt(l.Sym!==l),Pt(l.Sym.Sym===l),Pt(l.Lnext.Onext.Sym===l),Pt(l.Onext.Sym.Lnext===l),Pt(l.Lface===r),l=l.Lnext;while(l!==r.anEdge)}for(Pt(r.prev===s&&r.anEdge===null),a=n,a=n;(o=a.next)!==n;a=o){Pt(o.prev===a),l=o.anEdge;do Pt(l.Sym!==l),Pt(l.Sym.Sym===l),Pt(l.Lnext.Onext.Sym===l),Pt(l.Onext.Sym.Lnext===l),Pt(l.Org===o),l=l.Onext;while(l!==o.anEdge)}for(Pt(o.prev===a&&o.anEdge===null),c=i,c=i;(l=c.next)!==i;c=l)Pt(l.Sym.next===c.Sym),Pt(l.Sym!==l),Pt(l.Sym.Sym===l),Pt(l.Org!==null),Pt(l.Dst!==null),Pt(l.Lnext.Onext.Sym===l),Pt(l.Onext.Sym.Lnext===l);Pt(l.Sym.next===c.Sym&&l.Sym===this.eHeadSym&&l.Sym.Sym===l&&l.Org===null&&l.Dst===null&&l.Lface===null&&l.Rface===null)},t}(),Pj=function(){function t(){this.handle=null}return t}(),Dj=function(){function t(){this.key=null,this.node=0}return t}(),YIe=function(){function t(e,n){this.leq=n,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=e,this.nodes=[],this.handles=[];for(var i=0;i<e+1;i++)this.nodes[i]=new Pj,this.handles[i]=new Dj;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return t.prototype.floatDown_=function(e){var n=this.nodes,i=this.handles,r,s,o;for(r=n[e].handle;;){if(o=e<<1,o<this.size&&this.leq(i[n[o+1].handle].key,i[n[o].handle].key)&&++o,Pt(o<=this.max),s=n[o].handle,o>this.size||this.leq(i[r].key,i[s].key)){n[e].handle=r,i[r].node=e;break}n[e].handle=s,i[s].node=e,e=o}},t.prototype.floatUp_=function(e){var n=this.nodes,i=this.handles,r,s,o;for(r=n[e].handle;;){if(o=e>>1,s=n[o].handle,o===0||this.leq(i[s].key,i[r].key)){n[e].handle=r,i[r].node=e;break}n[e].handle=s,i[s].node=e,e=o}},t.prototype.init=function(){for(var e=this.size;e>=1;--e)this.floatDown_(e);this.initialized=!0},t.prototype.min=function(){return this.handles[this.nodes[1].handle].key},t.prototype.insert=function(e){var n,i;if(n=++this.size,n*2>this.max){this.max*=2;var r,s;for(s=this.nodes.length,this.nodes.length=this.max+1,r=s;r<this.nodes.length;r++)this.nodes[r]=new Pj;for(s=this.handles.length,this.handles.length=this.max+1,r=s;r<this.handles.length;r++)this.handles[r]=new Dj}return this.freeList===0?i=n:(i=this.freeList,this.freeList=this.handles[i].node),this.nodes[n].handle=i,this.handles[i].node=n,this.handles[i].key=e,this.initialized&&this.floatUp_(n),i},t.prototype.extractMin=function(){var e=this.nodes,n=this.handles,i=e[1].handle,r=n[i].key;return this.size>0&&(e[1].handle=e[this.size].handle,n[e[1].handle].node=1,n[i].key=null,n[i].node=this.freeList,this.freeList=i,--this.size,this.size>0&&this.floatDown_(1)),r},t.prototype.delete=function(e){var n=this.nodes,i=this.handles,r;Pt(e>=1&&e<=this.max&&i[e].key!==null),r=i[e].node,n[r].handle=n[this.size].handle,i[n[r].handle].node=r,--this.size,r<=this.size&&(r<=1||this.leq(i[n[r>>1].handle].key,i[n[r].handle].key)?this.floatDown_(r):this.floatUp_(r)),i[e].key=null,i[e].node=this.freeList,this.freeList=e},t}(),E2=function(){function t(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return t}(),Rj=function(){function t(){this.key=null,this.next=null,this.prev=null}return t}(),qIe=function(){function t(e,n){this.frame=e,this.leq=n,this.head=new Rj,this.head.next=this.head,this.head.prev=this.head}return t.prototype.min=function(){return this.head.next},t.prototype.max=function(){return this.head.prev},t.prototype.insert=function(e){return this.insertBefore(this.head,e)},t.prototype.search=function(e){var n=this.head;do n=n.next;while(n.key!==null&&!this.leq(this.frame,e,n.key));return n},t.prototype.insertBefore=function(e,n){do e=e.prev;while(e.key!==null&&!this.leq(this.frame,e.key,n));var i=new Rj;return i.key=n,i.next=e.next,e.next.prev=i,i.prev=e,e.next=i,i},t.prototype.delete=function(e){e.next.prev=e.prev,e.prev.next=e.next},t}(),QIe=function(){function t(){}return t.regionBelow=function(e){return e.nodeUp.prev.key},t.regionAbove=function(e){return e.nodeUp.next.key},t.debugEvent=function(e){},t.addWinding=function(e,n){e.winding+=n.winding,e.Sym.winding+=n.Sym.winding},t.edgeLeq=function(e,n,i){var r=e.event,s=n.eUp,o=i.eUp;if(s.Dst===r)return o.Dst===r?At.vertLeq(s.Org,o.Org)?At.edgeSign(o.Dst,s.Org,o.Org)<=0:At.edgeSign(s.Dst,o.Org,s.Org)>=0:At.edgeSign(o.Dst,r,o.Org)<=0;if(o.Dst===r)return At.edgeSign(s.Dst,r,s.Org)>=0;var a=At.edgeEval(s.Dst,r,s.Org),l=At.edgeEval(o.Dst,r,o.Org);return a>=l},t.deleteRegion=function(e,n){n.fixUpperEdge&&Pt(n.eUp.winding===0),n.eUp.activeRegion=null,e.dict.delete(n.nodeUp)},t.fixUpperEdge=function(e,n,i){Pt(n.fixUpperEdge),e.mesh.delete(n.eUp),n.fixUpperEdge=!1,n.eUp=i,i.activeRegion=n},t.topLeftRegion=function(e,n){var i=n.eUp.Org,r;do n=t.regionAbove(n);while(n.eUp.Org===i);if(n.fixUpperEdge){if(r=e.mesh.connect(t.regionBelow(n).eUp.Sym,n.eUp.Lnext),r===null)return null;t.fixUpperEdge(e,n,r),n=t.regionAbove(n)}return n},t.topRightRegion=function(e){var n=e.eUp.Dst;do e=t.regionAbove(e);while(e.eUp.Dst===n);return e},t.addRegionBelow=function(e,n,i){var r=new E2;return r.eUp=i,r.nodeUp=e.dict.insertBefore(n.nodeUp,r),r.fixUpperEdge=!1,r.sentinel=!1,r.dirty=!1,i.activeRegion=r,r},t.isWindingInside=function(e,n){switch(e.windingRule){case Rn.ODD:return(n&1)!==0;case Rn.NONZERO:return n!==0;case Rn.POSITIVE:return n>0;case Rn.NEGATIVE:return n<0;case Rn.ABS_GEQ_TWO:return n>=2||n<=-2}throw new Error("Invalid winding rulle")},t.computeWinding=function(e,n){n.windingNumber=t.regionAbove(n).windingNumber+n.eUp.winding,n.inside=t.isWindingInside(e,n.windingNumber)},t.finishRegion=function(e,n){var i=n.eUp,r=i.Lface;r.inside=n.inside,r.anEdge=i,t.deleteRegion(e,n)},t.finishLeftRegions=function(e,n,i){for(var r,s=null,o=n,a=n.eUp;o!==i;){if(o.fixUpperEdge=!1,s=t.regionBelow(o),r=s.eUp,r.Org!=a.Org){if(!s.fixUpperEdge){t.finishRegion(e,o);break}r=e.mesh.connect(a.Lprev,r.Sym),t.fixUpperEdge(e,s,r)}a.Onext!==r&&(e.mesh.splice(r.Oprev,r),e.mesh.splice(a,r)),t.finishRegion(e,o),a=s.eUp,o=s}return a},t.addRightEdges=function(e,n,i,r,s,o){var a,l,c,h,u=!0;c=i;do Pt(At.vertLeq(c.Org,c.Dst)),t.addRegionBelow(e,n,c.Sym),c=c.Onext;while(c!==r);for(s===null&&(s=t.regionBelow(n).eUp.Rprev),l=n,h=s;a=t.regionBelow(l),c=a.eUp.Sym,c.Org===h.Org;)c.Onext!==h&&(e.mesh.splice(c.Oprev,c),e.mesh.splice(h.Oprev,c)),a.windingNumber=l.windingNumber-c.winding,a.inside=t.isWindingInside(e,a.windingNumber),l.dirty=!0,!u&&t.checkForRightSplice(e,l)&&(t.addWinding(c,h),t.deleteRegion(e,l),e.mesh.delete(h)),u=!1,l=a,h=c;l.dirty=!0,Pt(l.windingNumber-c.winding===a.windingNumber),o&&t.walkDirtyRegions(e,l)},t.spliceMergeVertices=function(e,n,i){e.mesh.splice(n,i)},t.vertexWeights=function(e,n,i){var r=At.vertL1dist(n,e),s=At.vertL1dist(i,e),o=.5*s/(r+s),a=.5*r/(r+s);e.coords[0]+=o*n.coords[0]+a*i.coords[0],e.coords[1]+=o*n.coords[1]+a*i.coords[1],e.coords[2]+=o*n.coords[2]+a*i.coords[2]},t.getIntersectData=function(e,n,i,r,s,o){n.coords[0]=n.coords[1]=n.coords[2]=0,n.idx=-1,t.vertexWeights(n,i,r),t.vertexWeights(n,s,o)},t.checkForRightSplice=function(e,n){var i=t.regionBelow(n),r=n.eUp,s=i.eUp;if(At.vertLeq(r.Org,s.Org)){if(At.edgeSign(s.Dst,r.Org,s.Org)>0)return!1;At.vertEq(r.Org,s.Org)?r.Org!==s.Org&&(e.pq.delete(r.Org.pqHandle),t.spliceMergeVertices(e,s.Oprev,r)):(e.mesh.splitEdge(s.Sym),e.mesh.splice(r,s.Oprev),n.dirty=i.dirty=!0)}else{if(At.edgeSign(r.Dst,s.Org,r.Org)<0)return!1;t.regionAbove(n).dirty=n.dirty=!0,e.mesh.splitEdge(r.Sym),e.mesh.splice(s.Oprev,r)}return!0},t.checkForLeftSplice=function(e,n){var i=t.regionBelow(n),r=n.eUp,s=i.eUp,o;if(Pt(!At.vertEq(r.Dst,s.Dst)),At.vertLeq(r.Dst,s.Dst)){if(At.edgeSign(r.Dst,s.Dst,r.Org)<0)return!1;t.regionAbove(n).dirty=n.dirty=!0,o=e.mesh.splitEdge(r),e.mesh.splice(s.Sym,o),o.Lface.inside=n.inside}else{if(At.edgeSign(s.Dst,r.Dst,s.Org)>0)return!1;n.dirty=i.dirty=!0,o=e.mesh.splitEdge(s),e.mesh.splice(r.Lnext,s.Sym),o.Rface.inside=n.inside}return!0},t.checkForIntersect=function(e,n){var i=t.regionBelow(n),r=n.eUp,s=i.eUp,o=r.Org,a=s.Org,l=r.Dst,c=s.Dst,h,u,d=new pm,f,p;if(Pt(!At.vertEq(c,l)),Pt(At.edgeSign(l,e.event,o)<=0),Pt(At.edgeSign(c,e.event,a)>=0),Pt(o!==e.event&&a!==e.event),Pt(!n.fixUpperEdge&&!i.fixUpperEdge),o===a||(h=Math.min(o.t,l.t),u=Math.max(a.t,c.t),h>u))return!1;if(At.vertLeq(o,a)){if(At.edgeSign(c,o,a)>0)return!1}else if(At.edgeSign(l,a,o)<0)return!1;return t.debugEvent(e),At.intersect(l,o,c,a,d),Pt(Math.min(o.t,l.t)<=d.t),Pt(d.t<=Math.max(a.t,c.t)),Pt(Math.min(c.s,l.s)<=d.s),Pt(d.s<=Math.max(a.s,o.s)),At.vertLeq(d,e.event)&&(d.s=e.event.s,d.t=e.event.t),f=At.vertLeq(o,a)?o:a,At.vertLeq(f,d)&&(d.s=f.s,d.t=f.t),At.vertEq(d,o)||At.vertEq(d,a)?(t.checkForRightSplice(e,n),!1):!At.vertEq(l,e.event)&&At.edgeSign(l,e.event,d)>=0||!At.vertEq(c,e.event)&&At.edgeSign(c,e.event,d)<=0?c===e.event?(e.mesh.splitEdge(r.Sym),e.mesh.splice(s.Sym,r),n=t.topLeftRegion(e,n),r=t.regionBelow(n).eUp,t.finishLeftRegions(e,t.regionBelow(n),i),t.addRightEdges(e,n,r.Oprev,r,r,!0),!0):l===e.event?(e.mesh.splitEdge(s.Sym),e.mesh.splice(r.Lnext,s.Oprev),i=n,n=t.topRightRegion(n),p=t.regionBelow(n).eUp.Rprev,i.eUp=s.Oprev,s=t.finishLeftRegions(e,i,null),t.addRightEdges(e,n,s.Onext,r.Rprev,p,!0),!0):(At.edgeSign(l,e.event,d)>=0&&(t.regionAbove(n).dirty=n.dirty=!0,e.mesh.splitEdge(r.Sym),r.Org.s=e.event.s,r.Org.t=e.event.t),At.edgeSign(c,e.event,d)<=0&&(n.dirty=i.dirty=!0,e.mesh.splitEdge(s.Sym),s.Org.s=e.event.s,s.Org.t=e.event.t),!1):(e.mesh.splitEdge(r.Sym),e.mesh.splitEdge(s.Sym),e.mesh.splice(s.Oprev,r),r.Org.s=d.s,r.Org.t=d.t,r.Org.pqHandle=e.pq.insert(r.Org),t.getIntersectData(e,r.Org,o,l,a,c),t.regionAbove(n).dirty=n.dirty=i.dirty=!0,!1)},t.walkDirtyRegions=function(e,n){for(var i=t.regionBelow(n),r,s;;){for(;i.dirty;)n=i,i=t.regionBelow(i);if(!n.dirty&&(i=n,n=t.regionAbove(n),n===null||!n.dirty))return;if(n.dirty=!1,r=n.eUp,s=i.eUp,r.Dst!==s.Dst&&t.checkForLeftSplice(e,n)&&(i.fixUpperEdge?(t.deleteRegion(e,i),e.mesh.delete(s),i=t.regionBelow(n),s=i.eUp):n.fixUpperEdge&&(t.deleteRegion(e,n),e.mesh.delete(r),n=t.regionAbove(i),r=n.eUp)),r.Org!==s.Org)if(r.Dst!==s.Dst&&!n.fixUpperEdge&&!i.fixUpperEdge&&(r.Dst===e.event||s.Dst===e.event)){if(t.checkForIntersect(e,n))return}else t.checkForRightSplice(e,n);r.Org===s.Org&&r.Dst===s.Dst&&(t.addWinding(s,r),t.deleteRegion(e,n),e.mesh.delete(r),n=t.regionAbove(i))}},t.connectRightVertex=function(e,n,i){var r,s=i.Onext,o=t.regionBelow(n),a=n.eUp,l=o.eUp,c=!1;if(a.Dst!==l.Dst&&t.checkForIntersect(e,n),At.vertEq(a.Org,e.event)&&(e.mesh.splice(s.Oprev,a),n=t.topLeftRegion(e,n),s=t.regionBelow(n).eUp,t.finishLeftRegions(e,t.regionBelow(n),o),c=!0),At.vertEq(l.Org,e.event)&&(e.mesh.splice(i,l.Oprev),i=t.finishLeftRegions(e,o,null),c=!0),c){t.addRightEdges(e,n,i.Onext,s,s,!0);return}At.vertLeq(l.Org,a.Org)?r=l.Oprev:r=a,r=e.mesh.connect(i.Lprev,r),t.addRightEdges(e,n,r,r.Onext,r.Onext,!1),r.Sym.activeRegion.fixUpperEdge=!0,t.walkDirtyRegions(e,n)},t.connectLeftDegenerate=function(e,n,i){var r,s,o,a,l;if(r=n.eUp,At.vertEq(r.Org,i)){Pt(!1),t.spliceMergeVertices(e,r,i.anEdge);return}if(!At.vertEq(r.Dst,i)){e.mesh.splitEdge(r.Sym),n.fixUpperEdge&&(e.mesh.delete(r.Onext),n.fixUpperEdge=!1),e.mesh.splice(i.anEdge,r),t.sweepEvent(e,i);return}Pt(!1),n=t.topRightRegion(n),l=t.regionBelow(n),o=l.eUp.Sym,s=a=o.Onext,l.fixUpperEdge&&(Pt(s!==o),t.deleteRegion(e,l),e.mesh.delete(o),o=s.Oprev),e.mesh.splice(i.anEdge,o),At.edgeGoesLeft(s)||(s=null),t.addRightEdges(e,n,o.Onext,a,s,!0)},t.connectLeftVertex=function(e,n){var i,r,s,o,a,l,c=new E2;if(c.eUp=n.anEdge.Sym,i=e.dict.search(c).key,r=t.regionBelow(i),!!r){if(o=i.eUp,a=r.eUp,At.edgeSign(o.Dst,n,o.Org)===0){t.connectLeftDegenerate(e,i,n);return}if(s=At.vertLeq(a.Dst,o.Dst)?i:r,i.inside||s.fixUpperEdge){if(s===i)l=e.mesh.connect(n.anEdge.Sym,o.Lnext);else{var h=e.mesh.connect(a.Dnext,n.anEdge);l=h.Sym}s.fixUpperEdge?t.fixUpperEdge(e,s,l):t.computeWinding(e,t.addRegionBelow(e,i,l)),t.sweepEvent(e,n)}else t.addRightEdges(e,i,n.anEdge,n.anEdge,null,!0)}},t.sweepEvent=function(e,n){e.event=n,t.debugEvent(e);for(var i=n.anEdge;i.activeRegion===null;)if(i=i.Onext,i===n.anEdge){t.connectLeftVertex(e,n);return}var r=t.topLeftRegion(e,i.activeRegion);Pt(r!==null);var s=t.regionBelow(r),o=s.eUp,a=t.finishLeftRegions(e,s,null);a.Onext===o?t.connectRightVertex(e,r,a):t.addRightEdges(e,r,a.Onext,o,o,!0)},t.addSentinel=function(e,n,i,r){var s=new E2,o=e.mesh.makeEdge();o.Org.s=i,o.Org.t=r,o.Dst.s=n,o.Dst.t=r,e.event=o.Dst,s.eUp=o,s.windingNumber=0,s.inside=!1,s.fixUpperEdge=!1,s.sentinel=!0,s.dirty=!1,s.nodeUp=e.dict.insert(s)},t.initEdgeDict=function(e){e.dict=new qIe(e,t.edgeLeq);var n=e.bmax[0]-e.bmin[0],i=e.bmax[1]-e.bmin[1],r=e.bmin[0]-n,s=e.bmax[0]+n,o=e.bmin[1]-i,a=e.bmax[1]+i;t.addSentinel(e,r,s,o),t.addSentinel(e,r,s,a)},t.doneEdgeDict=function(e){for(var n,i=0;(n=e.dict.min().key)!==null;)n.sentinel||(Pt(n.fixUpperEdge),Pt(++i===1)),Pt(n.windingNumber===0),t.deleteRegion(e,n)},t.removeDegenerateEdges=function(e){var n,i,r,s=e.mesh.eHead;for(n=s.next;n!==s;n=i)i=n.next,r=n.Lnext,At.vertEq(n.Org,n.Dst)&&n.Lnext.Lnext!==n&&(t.spliceMergeVertices(e,r,n),e.mesh.delete(n),n=r,r=n.Lnext),r.Lnext===n&&(r!==n&&((r===i||r===i.Sym)&&(i=i.next),e.mesh.delete(r)),(n===i||n===i.Sym)&&(i=i.next),e.mesh.delete(n))},t.initPriorityQ=function(e){var n,i,r,s=0;for(r=e.mesh.vHead,i=r.next;i!==r;i=i.next)s++;for(s+=8,n=e.pq=new YIe(s,At.vertLeq),r=e.mesh.vHead,i=r.next;i!==r;i=i.next)i.pqHandle=n.insert(i);return i!==r?!1:(n.init(),!0)},t.donePriorityQ=function(e){e.pq=null},t.removeDegenerateFaces=function(e,n){var i,r,s;for(i=n.fHead.next;i!==n.fHead;i=r)r=i.next,s=i.anEdge,Pt(s.Lnext!==s),s.Lnext.Lnext===s&&(t.addWinding(s.Onext,s),e.mesh.delete(s));return!0},t.computeInterior=function(e,n){n===void 0&&(n=!0);var i,r;if(t.removeDegenerateEdges(e),!t.initPriorityQ(e))return!1;for(t.initEdgeDict(e);(i=e.pq.extractMin())!==null;){for(;r=e.pq.min(),!(r===null||!At.vertEq(r,i));)r=e.pq.extractMin(),t.spliceMergeVertices(e,i.anEdge,r.anEdge);t.sweepEvent(e,i)}return e.event=e.dict.min().key.eUp.Org,t.debugEvent(e),t.doneEdgeDict(e),t.donePriorityQ(e),t.removeDegenerateFaces(e,e.mesh)?(n&&e.mesh.check(),!0):!1},t}(),KIe=function(){function t(){this.mesh=new Tj,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=Rn.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return t.prototype.dot_=function(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]},t.prototype.normalize_=function(e){var n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(!n)throw"Zero-size vector!";n=Math.sqrt(n),e[0]/=n,e[1]/=n,e[2]/=n},t.prototype.longAxis_=function(e){var n=0;return Math.abs(e[1])>Math.abs(e[0])&&(n=1),Math.abs(e[2])>Math.abs(e[n])&&(n=2),n},t.prototype.computeNormal_=function(e){var n,i,r,s,o,a,l=[0,0,0],c=[0,0,0],h=[0,0,0],u=[0,0,0],d=[0,0,0],f=[null,null,null],p=[null,null,null],v=this.mesh.vHead;n=v.next;for(var g=0;g<3;++g)s=n.coords[g],c[g]=s,p[g]=n,l[g]=s,f[g]=n;for(n=v.next;n!==v;n=n.next)for(var m=0;m<3;++m)s=n.coords[m],s<c[m]&&(c[m]=s,p[m]=n),s>l[m]&&(l[m]=s,f[m]=n);var y=0;if(l[1]-c[1]>l[0]-c[0]&&(y=1),l[2]-c[2]>l[y]-c[y]&&(y=2),c[y]>=l[y]){e[0]=0,e[1]=0,e[2]=1;return}for(a=0,i=p[y],r=f[y],h[0]=i.coords[0]-r.coords[0],h[1]=i.coords[1]-r.coords[1],h[2]=i.coords[2]-r.coords[2],n=v.next;n!==v;n=n.next)u[0]=n.coords[0]-r.coords[0],u[1]=n.coords[1]-r.coords[1],u[2]=n.coords[2]-r.coords[2],d[0]=h[1]*u[2]-h[2]*u[1],d[1]=h[2]*u[0]-h[0]*u[2],d[2]=h[0]*u[1]-h[1]*u[0],o=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],o>a&&(a=o,e[0]=d[0],e[1]=d[1],e[2]=d[2]);a<=0&&(e[0]=e[1]=e[2]=0,e[this.longAxis_(h)]=1)},t.prototype.checkOrientation_=function(){for(var e=this.mesh.fHead,n,i=this.mesh.vHead,r,s=0,o=e.next;o!==e;o=o.next)if(r=o.anEdge,!(r.winding<=0))do s+=(r.Org.s-r.Dst.s)*(r.Org.t+r.Dst.t),r=r.Lnext;while(r!==o.anEdge);if(s<0){for(n=i.next;n!==i;n=n.next)n.t=-n.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},t.prototype.projectPolygon_=function(){var e=this.mesh.vHead,n=[0,0,0],i,r,s=!1;n[0]=this.normal[0],n[1]=this.normal[1],n[2]=this.normal[2],!n[0]&&!n[1]&&!n[2]&&(this.computeNormal_(n),s=!0),i=this.sUnit,r=this.tUnit;var o=this.longAxis_(n);i[o]=0,i[(o+1)%3]=1,i[(o+2)%3]=0,r[o]=0,r[(o+1)%3]=0,r[(o+2)%3]=n[o]>0?1:-1;for(var a=e.next;a!==e;a=a.next)a.s=this.dot_(a.coords,i),a.t=this.dot_(a.coords,r);s&&this.checkOrientation_();for(var l=!0,c=e.next;c!==e;c=c.next)l?(this.bmin[0]=this.bmax[0]=c.s,this.bmin[1]=this.bmax[1]=c.t,l=!1):(c.s<this.bmin[0]&&(this.bmin[0]=c.s),c.s>this.bmax[0]&&(this.bmax[0]=c.s),c.t<this.bmin[1]&&(this.bmin[1]=c.t),c.t>this.bmax[1]&&(this.bmax[1]=c.t))},t.prototype.addWinding_=function(e,n){e.winding+=n.winding,e.Sym.winding+=n.Sym.winding},t.prototype.tessellateMonoRegion_=function(e,n){var i,r;if(i=n.anEdge,!(i.Lnext!==i&&i.Lnext.Lnext!==i))throw"Mono region invalid";for(;At.vertLeq(i.Dst,i.Org);i=i.Lprev);for(;At.vertLeq(i.Org,i.Dst);i=i.Lnext);r=i.Lprev;for(var s=void 0;i.Lnext!==r;)if(At.vertLeq(i.Dst,r.Org)){for(;r.Lnext!==i&&(At.edgeGoesLeft(r.Lnext)||At.edgeSign(r.Org,r.Dst,r.Lnext.Dst)<=0);)s=e.connect(r.Lnext,r),r=s.Sym;r=r.Lprev}else{for(;r.Lnext!==i&&(At.edgeGoesRight(i.Lprev)||At.edgeSign(i.Dst,i.Org,i.Lprev.Org)>=0);)s=e.connect(i,i.Lprev),i=s.Sym;i=i.Lnext}if(r.Lnext===i)throw"Mono region invalid";for(;r.Lnext.Lnext!==i;)s=e.connect(r.Lnext,r),r=s.Sym;return!0},t.prototype.tessellateInterior_=function(e){for(var n,i=e.fHead.next;i!==e.fHead;i=n)if(n=i.next,i.inside&&!this.tessellateMonoRegion_(e,i))return!1;return!0},t.prototype.discardExterior_=function(e){for(var n,i=e.fHead.next;i!==e.fHead;i=n)n=i.next,i.inside||e.zapFace(i)},t.prototype.setWindingNumber_=function(e,n,i){for(var r,s=e.eHead.next;s!==e.eHead;s=r)r=s.next,s.Rface.inside!==s.Lface.inside?s.winding=s.Lface.inside?n:-n:i?e.delete(s):s.winding=0},t.prototype.getNeighbourFace_=function(e){return!e.Rface||!e.Rface.inside?-1:e.Rface.n},t.prototype.outputPolymesh_=function(e,n,i,r){var s,o=0,a=0,l;i>3&&e.mergeConvexFaces(i);for(var c=e.vHead.next;c!==e.vHead;c=c.next)c.n=-1;for(var h=e.fHead.next;h!==e.fHead;h=h.next)if(h.n=-1,!!h.inside){s=h.anEdge,l=0;do{var c=s.Org;c.n===-1&&(c.n=a,a++),l++,s=s.Lnext}while(s!==h.anEdge);if(l>i)throw"Face vertex greater that support polygon";h.n=o,++o}this.elementCount=o,n===zi.CONNECTED_POLYGONS&&(o*=2),this.elements=[],this.elements.length=o*i,this.vertexCount=a,this.vertices=[],this.vertices.length=a*r,this.vertexIndices=[],this.vertexIndices.length=a;for(var c=e.vHead.next;c!==e.vHead;c=c.next)if(c.n!==-1){var u=c.n*r;this.vertices[u+0]=c.coords[0],this.vertices[u+1]=c.coords[1],r>2&&(this.vertices[u+2]=c.coords[2]),this.vertexIndices[c.n]=c.idx}for(var d=0,h=e.fHead.next;h!==e.fHead;h=h.next)if(h.inside){s=h.anEdge,l=0;do{var c=s.Org;this.elements[d++]=c.n,l++,s=s.Lnext}while(s!==h.anEdge);for(var f=l;f<i;++f)this.elements[d++]=-1;if(n===zi.CONNECTED_POLYGONS){s=h.anEdge;do this.elements[d++]=this.getNeighbourFace_(s),s=s.Lnext;while(s!==h.anEdge);for(var p=l;p<i;++p)this.elements[d++]=-1}}},t.prototype.outputContours_=function(e,n){var i,r,s=0,o=0;this.vertexCount=0,this.elementCount=0;for(var a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){r=i=a.anEdge;do this.vertexCount++,i=i.Lnext;while(i!==r);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*n,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var l=0,c=0,h=0;s=0;for(var a=e.fHead.next;a!==e.fHead;a=a.next)if(a.inside){o=0,r=i=a.anEdge;do this.vertices[l++]=i.Org.coords[0],this.vertices[l++]=i.Org.coords[1],n>2&&(this.vertices[l++]=i.Org.coords[2]),this.vertexIndices[c++]=this.vertexIdCallback?this.vertexIdCallback(i):i.Org.idx,o++,i=i.Lnext;while(i!==r);this.elements[h++]=s,this.elements[h++]=o,s+=o}},t.prototype.addContour=function(e,n){this.mesh===null&&(this.mesh=new Tj),e<2&&(e=2),e>3&&(e=3);for(var i=null,r=0;r<n.length;r+=e)i===null?(i=this.mesh.makeEdge(),this.mesh.splice(i,i.Sym)):(this.mesh.splitEdge(i),i=i.Lnext),i.Org.coords[0]=n[r+0],i.Org.coords[1]=n[r+1],e>2?i.Org.coords[2]=n[r+2]:i.Org.coords[2]=0,i.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(i),i.winding=1,i.Sym.winding=-1},t.prototype.tesselate=function(e,n,i,r,s,o){if(e===void 0&&(e=Rn.ODD),n===void 0&&(n=zi.POLYGONS),o===void 0&&(o=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,s&&(this.normal[0]=s[0],this.normal[1]=s[1],this.normal[2]=s[2]),this.windingRule=e,r<2&&(r=2),r>3&&(r=3),!this.mesh)return!1;this.projectPolygon_(),QIe.computeInterior(this,o);var a=this.mesh;return n===zi.BOUNDARY_CONTOURS?this.setWindingNumber_(a,1,!0):this.tessellateInterior_(a),o&&a.check(),n===zi.BOUNDARY_CONTOURS?this.outputContours_(a,r):this.outputPolymesh_(a,n,i,r),!0},t}();function ph(t){var e=t.windingRule,n=e===void 0?Rn.ODD:e,i=t.elementType,r=i===void 0?zi.POLYGONS:i,s=t.polySize,o=s===void 0?3:s,a=t.vertexSize,l=a===void 0?2:a,c=t.normal,h=c===void 0?[0,0,1]:c,u=t.contours,d=u===void 0?[]:u,f=t.strict,p=f===void 0?!0:f,v=t.debug,g=v===void 0?!1:v;if(!d&&p)throw new Error("Contours can't be empty");if(d){var m=new KIe;t.edgeCreateCallback&&(m.edgeCreateCallback=t.edgeCreateCallback),t.vertexIdCallback&&(m.vertexIdCallback=t.vertexIdCallback);for(var y=0;y<d.length;y++)m.addContour(l||2,d[y]);return m.tesselate(n,r,o,l,h,p),{vertices:m.vertices,vertexIndices:m.vertexIndices,vertexCount:m.vertexCount,elements:m.elements,elementCount:m.elementCount,mesh:g?m.mesh:void 0}}}Rn.ODD;Rn.NONZERO;Rn.POSITIVE;Rn.NEGATIVE;Rn.ABS_GEQ_TWO;zi.POLYGONS;zi.CONNECTED_POLYGONS;zi.BOUNDARY_CONTOURS;var _I=class{constructor(t=256,e=!1){this.capacity=t,this.size=0,this.debug=e,this.debug&&console.log(`allocating with cap ${t}`);let n=t*_I.eSize;this.buffer=new ArrayBuffer(n);let i=Float32Array.BYTES_PER_ELEMENT,r=0;this.positions=new Float32Array(this.buffer,r*i,3*t),r+=3*t,this.normals=new Float32Array(this.buffer,r*i,3*t),r+=3*t,this.uvs=new Float32Array(this.buffer,r*i,2*t)}realloc(t,e=!1){if(t<this.size)throw Error("cannot shrink buffer");if(t<=this.capacity&&!e)return;this.debug&&console.log(`resizing from ${this.capacity}  ${t}`);let n=t*_I.eSize,i=new ArrayBuffer(n),r=Float32Array.BYTES_PER_ELEMENT,s=0,o=new Float32Array(i,s*r,3*t);s+=3*t;let a=new Float32Array(i,s*r,3*t);s+=3*t;let l=new Float32Array(i,s*r,2*t);o.set(this.positions.slice(0,this.size*3)),a.set(this.normals.slice(0,this.size*3)),l.set(this.uvs.slice(0,this.size*2)),this.buffer=i,this.positions=o,this.normals=a,this.uvs=l,this.capacity=t}get(t=1){let e=this.size+t;if(e>this.capacity){let i=this.capacity;for(;e>i;)i*=2;this.realloc(i)}let n=this.size;return this.size=e,n}reserve(t){let e=this.size+t;e>this.capacity&&this.realloc(e)}shrink(){this.debug&&console.log(`shrinking ${this.capacity}  ${this.size}`),this.realloc(this.size,!0)}},SJ=_I;SJ.eSize=(3+3+2)*Float32Array.BYTES_PER_ELEMENT;var uF={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},bJ={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},AJ={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},C2=(t,e)=>([n,i])=>(i<n&&(i+=e),(t>=n?t:t+e)<=i),MJ=class extends Lt{constructor(t,e,n=0,i=12,r=3,s=Rn.ODD){super(),this.type="ShapeGeometry",this.vertexCache={},this._shape=t,this._depth=e,this._bevel=n,this._curveSegments=i,this._bevelSegmentsInput=r,n<=0?(this._bevelSize=0,this._bevelSegments=0):(this._bevelSize=Math.min(n,e/2-1e-12),this._bevelSegments=Math.floor(r));let o=this._shape.extractShapePointsToFlatArray([],i),a=this._shape.shapeHoles.map(A=>{let b=A.extractShapePointsToFlatArray([],i),T=[];for(let M=b.length-1;M>=1;M-=2){let E=b[M-1],P=b[M-0];T.push(E,P)}return T}),l;try{l=ph({windingRule:s,elementType:zi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[o]})}catch{l=uF}let c;try{c=ph({windingRule:Rn.ODD,elementType:zi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...a]})}catch{c=bJ}if(!l)throw new Error("error generating geometry");let h=l.elementCount;if(c){l.elementCount+=c.elementCount;for(let A=0;A<c.elements.length;A++){let b=c.elements[A],T=A%2===0?l.vertexCount:0;l.elements.push(b+T)}for(let A=0;A<c.vertexIndices.length;A++){let b=c.vertexIndices[A],T=l.vertexCount;l.vertexIndices.push(b+T)}for(let A=0;A<c.vertices.length;A++){let b=c.vertices[A];l.vertices.push(b)}}let u=1/0,d=-1/0,f=1/0,p=-1/0;for(let A=0,b=l.vertexCount;A<b;A++){let T=A*2,M=l.vertices[T+0],E=l.vertices[T+1];M<u&&(u=M),M>d&&(d=M),E<f&&(f=E),E>p&&(p=E)}this._minX=u,this._minY=f,this._width=d-u,this._height=p-f,this._buffer=new SJ(this._computeBufferEstimatedSize(l));let v=[],g=[];for(let A=l.elementCount-1;A>=0;A--){let b=A>=h,T=A*2,M=l.elements[T+0],E=l.elements[T+1],P=M+E,R={start:M,count:E,normals:[],continuous:[],concave:[]},F=M,B=P-1,k=M+1,j=this._shape.roundedCurves.length;do{let W=F-M,H=l.vertices[B*2+0],Y=l.vertices[B*2+1],z=l.vertices[F*2+0],X=l.vertices[F*2+1],q=l.vertices[k*2+0],re=l.vertices[k*2+1],G=z-H,K=X-Y,oe=Math.sqrt(G*G+K*K);G/=oe,K/=oe;let ve=z-q,$=X-re,se=Math.sqrt(ve*ve+$*$);ve/=se,$/=se,R.normals[W*2+0]=-$,R.normals[W*2+1]=ve,R.concave[W]=G*$-K*ve>0;let ne=l.vertexIndices[F];if(Array.isArray(ne))R.continuous[W]=!1;else{let[ie,me]=this._shape.getCurveIndexFromVertexId(ne-1,!0);if(me>0&&me<1)R.continuous[W]=!0;else{let xe=me===1?ie+1:ie-1;xe=(xe+j)%j;let Ae=me===1?0:1,we=this._shape.roundedCurves[ie].getTangent(me),Ee=this._shape.roundedCurves[xe].getTangent(Ae);R.continuous[W]=we.dot(Ee)>.95}}b&&(R.normals[W*2+0]*=-1,R.normals[W*2+1]*=-1),[B,F,k]=[F,k,k+1],k>=P&&(k-=E)}while(k!==M+1);let Z=[];Z.push({bevelI:0,angle:0,size:0,boundary:{vertices:l.vertices.slice(M*2,P*2),vertexCount:E,vertexIndices:new Array(E).fill(!0).map((W,H)=>[H,H]),elements:[0,E],elementCount:1,mesh:null},reverseMap:[],insetPoints:l.vertices.slice(M*2,P*2)});for(let W=1;W<=this._bevelSegments;W++){let H=W/this._bevelSegments*Math.PI/2,Y=(1-Math.cos(H))*this._bevelSize,z=[],X=[],q=0;for(let G=0;G<E;G++){let K=G*2,oe=(G-1+E)%E*2,ve=l.vertices[R.start*2+K+0],$=l.vertices[R.start*2+K+1],se=-R.normals[oe+0]*Y,ne=-R.normals[oe+1]*Y,ie=-R.normals[K+0]*Y,me=-R.normals[K+1]*Y;if(R.concave[G]||!R.concave[G]&&b){let xe=Math.atan2(ne,se),Ae=Math.atan2(me,ie);Ae>xe&&(Ae-=Math.PI*2);let we=Ae-xe;if(R.continuous[G]||b){let Ee=xe+we/2,Re=Math.cos(Ee)*Y,Ue=Math.sin(Ee)*Y;z[2*q+0]=ve+Re*(b?-1:1),z[2*q+1]=$+Ue*(b?-1:1),X[q]=G,q++}else{let Ee=Math.max(1,Math.floor(i/4*Math.abs(we)/Math.PI));for(let Re=0;Re<=Ee;Re++){let Ue=xe+we*(Re/Ee),Ne=Math.cos(Ue)*Y,U=Math.sin(Ue)*Y;z[2*q+0]=ve+Ne,z[2*q+1]=$+U,X[q]=G,q++}}}else z[2*q+0]=ve+se,z[2*q+1]=$+ne,X[q]=G,q++,z[2*q+0]=ve,z[2*q+1]=$,X[q]=G,q++,z[2*q+0]=ve+ie,z[2*q+1]=$+me,X[q]=G,q++}let re=ph({windingRule:Rn.POSITIVE,elementType:zi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[z],edgeCreateCallback:G=>{let K=G.Org.idx,oe=X[K],ve=X[(K+1)%X.length];G.idx=[oe,ve],G.Sym.idx=[ve,oe]},vertexIdCallback:G=>{let K=G.Lprev.idx;return[K?K[1]:0,G.idx?G.idx[0]:0]}});if(!re)throw console.log("Error"),new Error(`error generating bevel geometry for ${W}'th loop`);if(!re.vertexCount)break;for(let G=0;G<re.vertexIndices.length;G++){let[K,oe]=re.vertexIndices[G];if(K===oe)continue;let ve=oe;oe<K&&(ve+=E);for(let $=K;$<ve;$++){let se=$%E,ne=($+1)%E;if(!R.continuous[se]||!R.continuous[ne]){re.vertexIndices[G]=[K,se],re.vertexIndices.splice(G+1,0,[ne,oe]),re.vertices.splice((G+1)*2,0,re.vertices[G*2],re.vertices[G*2+1]);break}}}Z.push({bevelI:W,angle:H,size:Y,boundary:re,reverseMap:X,insetPoints:z})}let ee=(W,H,Y)=>{let z=0,X=W.boundary.vertexIndices.length;for(;z<X&&Y(W.boundary.vertexIndices[H]);)H=(H+1)%X,z++;return z},O=v.length;for(let W=1;W<Z.length;W++){let H=Z[W-1],Y=Z[W],z=H.boundary.vertexIndices.length,X=Y.boundary.vertexIndices.length;if(!z||!X)break;let q=R.concave.length,re=0,G=C2(re,E);for(;!H.boundary.vertexIndices.filter(G).length||!Y.boundary.vertexIndices.filter(G).length;)re++,G=C2(re,E);let K=H.boundary.vertexIndices.findIndex(G),oe=Y.boundary.vertexIndices.findIndex(G);do K=(K+1)%z;while(G(H.boundary.vertexIndices[K]));do oe=(oe+1)%X;while(G(Y.boundary.vertexIndices[oe]));re=(re+1)%E;let ve=re,$=this._buildBevelVert(R,H,(K-1+z)%z),se=this._buildBevelVert(R,Y,(oe-1+X)%X),ne=$,ie=se,me,xe,Ae=!1;do{G=C2(re,E);let we=ee(H,K,G),Ee=ee(Y,oe,G),Re=Ae;if(Ae=!1,we&&!Ee){for(let Ue=0;Ue<we;Ue++)me=this._buildBevelVert(R,H,(K+Ue)%z,Ue/(we-1)),v.push(ne.topN,me.topP,ie.topN),v.push(me.bottomP,ne.bottomN,ie.bottomN),ne=me;Ae=!0}else if(!we&&Ee)for(let Ue=0;Ue<Ee;Ue++)xe=this._buildBevelVert(R,Y,(oe+Ue)%X,Ue/(Ee-1)),v.push(ie.topN,ne.topP,xe.topP),v.push(ne.bottomP,ie.bottomN,xe.bottomP),ie=xe;else if(we&&Ee)if(me=this._buildBevelVert(R,H,K,0),xe=this._buildBevelVert(R,Y,oe,0),Re?(v.push(ne.topN,xe.topP,ie.topN),v.push(ne.topN,me.topP,xe.topP),v.push(xe.bottomP,ne.bottomN,ie.bottomN),v.push(xe.bottomP,me.bottomP,ne.bottomN)):(v.push(ie.topN,ne.topN,me.topP),v.push(ie.topN,me.topP,xe.topP),v.push(me.bottomP,ne.bottomN,ie.bottomN),v.push(me.bottomP,ie.bottomN,xe.bottomP)),ne=me,ie=xe,we===Ee)for(let Ue=1;Ue<we;Ue++)me=this._buildBevelVert(R,H,(K+Ue)%z,Ue/(we-1)),xe=this._buildBevelVert(R,Y,(oe+Ue)%X,Ue/(Ee-1)),v.push(ne.topN,me.topP,ie.topN),v.push(ie.topN,me.topP,xe.topP),v.push(me.bottomP,ne.bottomN,ie.bottomN),v.push(me.bottomP,ie.bottomN,xe.bottomP),ne=me,ie=xe;else if(we>Ee){let Ue=we/Ee,Ne=0;for(let U=1;U<we;U++)me=this._buildBevelVert(R,H,(K+U)%z,U/(we-1)),v.push(ne.topN,me.topP,ie.topN),v.push(me.bottomP,ne.bottomN,ie.bottomN),ne=me,U>(Ne+1)*Ue&&(Ne++,xe=this._buildBevelVert(R,Y,(oe+Ne)%X,Ne/(Ee-1)),v.push(ie.topN,me.topP,xe.topP),v.push(me.bottomP,ie.bottomN,xe.bottomP),ie=xe)}else{let Ue=Ee/we,Ne=0;for(let U=1;U<Ee;U++)xe=this._buildBevelVert(R,Y,(oe+U)%X,U/(Ee-1)),v.push(ie.topN,me.topP,xe.topP),v.push(me.bottomP,ie.bottomN,xe.bottomP),ie=xe,U>(Ne+1)*Ue&&(Ne++,me=this._buildBevelVert(R,H,(K+Ne)%z,Ne/(we-1)),v.push(ne.topN,me.topP,ie.topN),v.push(me.bottomP,ne.bottomN,ie.bottomN),ne=me)}K=(K+we)%z,oe=(oe+Ee)%X,re=(re+1)%q}while(re!==ve)}if(this._buildWall(Z,R,v),b){let W=[];for(let H=v.length-1;H>=O+2;H-=3){let Y=v[H-2],z=v[H-1],X=v[H-0];W.push(X,z,Y)}v.splice(O,v.length-O,...W)}if(b){let W=[];for(let H=Z[Z.length-1].boundary.vertices.length-1;H>=1;H-=2){let Y=Z[Z.length-1].boundary.vertices[H-1],z=Z[Z.length-1].boundary.vertices[H-0];W.push(Y,z)}g.push(W)}if(!b){let W=Z[Z.length-1],H;try{H=ph({windingRule:Z.length>1?Rn.POSITIVE:Rn.ODD,elementType:zi.POLYGONS,vertexSize:2,strict:!0,contours:[W.insetPoints,...g]})}catch{H=AJ}if(!H)throw new Error("Error generating geometry for surface");a.length===0&&Object.assign(this,{capStartIndex:v.length});for(let Y=0;Y<H.elementCount*3;Y+=3){let z=this._buildSurfaceVert(H,H.elements[Y+0]),X=this._buildSurfaceVert(H,H.elements[Y+1]),q=this._buildSurfaceVert(H,H.elements[Y+2]);v.push(z.top,X.top,q.top),v.push(q.bottom,X.bottom,z.bottom)}}this.vertexCache={}}this._buffer.shrink();let m=new Ut(Uint32Array.from(v),1),y=new Ut(this._buffer.positions,3),_=new Ut(this._buffer.normals,3),S=new Ut(this._buffer.uvs,2);y.needsUpdate=!0,_.needsUpdate=!0,S.needsUpdate=!0,m.needsUpdate=!0,this.setAttribute("position",y),this.setAttribute("normal",_),this.setAttribute("uv",S),this.setIndex(m)}_computeBufferEstimatedSize(t){return t.vertexCount*2*(2+this._bevelSegments)}_buildWall(t,e,n){let i=t[0];for(let r=0,s=i.boundary.vertexCount;r<s;r++){let o=this._buildBevelVert(e,i,r),a=this._buildBevelVert(e,i,(r+1)%s);n.push(a.topP,o.topN,o.bottomN),n.push(a.topP,o.bottomN,a.bottomP)}}_buildSurfaceVert(t,e){let n=e.toString();if(n in this.vertexCache)return this.vertexCache[n];let i=t.vertices[e*2+0],r=t.vertices[e*2+1],s=(i-this._minX)/this._width,o=(r-this._minY)/this._height,a=this._buffer.get(2),l=a*3,c=a*2,h={top:a+0,bottom:a+1};return this._buffer.positions[l+0]=i,this._buffer.positions[l+1]=r,this._buffer.positions[l+2]=this._depth,this._buffer.normals[l+0]=0,this._buffer.normals[l+1]=0,this._buffer.normals[l+2]=1,this._buffer.uvs[c+0]=s,this._buffer.uvs[c+1]=o,this._buffer.positions[l+3]=i,this._buffer.positions[l+4]=r,this._buffer.positions[l+5]=0,this._buffer.normals[l+3]=0,this._buffer.normals[l+4]=0,this._buffer.normals[l+5]=-1,this._buffer.uvs[c+2]=s,this._buffer.uvs[c+3]=o,this.vertexCache[n]=h,h}_buildBevelVert(t,e,n,i=1){let r=`${e.bevelI}:${n}`;if(r in this.vertexCache)return this.vertexCache[r];let[s,o]=e.boundary.vertexIndices[n],a,l,c,h;s!==o?(l=s,a=o,h=!1,c=t.continuous[l]&&t.continuous[a]):(a=s,l=(a-1+t.count)%t.count,h=t.concave[a]&&e.bevelI>0,c=t.continuous[a]||h);let u=Math.cos(e.angle),d=Math.sin(e.angle),f=n*2,p=a*2,v=l*2,g=e.boundary.vertices[f+0],m=e.boundary.vertices[f+1],y=(1-d)*this._bevelSize,_=(g-this._minX)/this._width,S=(m-this._minY)/this._height,A=t.normals[p+0],b=t.normals[p+1],T=t.normals[v+0],M=t.normals[v+1];if(h){let B=T-A,k=M-b;A=A+B*(1-i),b=b+k*(1-i);let j=Math.sqrt(A*A+b*b);A/=j,b/=j}let E=this._buffer.get(c?2:4),P=E*3,R=E*2,F={i:n,fi:a,topP:E+0,topN:E+0,bottomP:E+1,bottomN:E+1};return this._buffer.positions[P+0]=g,this._buffer.positions[P+1]=m,this._buffer.positions[P+2]=this._depth-y,this._buffer.normals[P+0]=A*u,this._buffer.normals[P+1]=b*u,this._buffer.normals[P+2]=d,this._buffer.uvs[R+0]=_,this._buffer.uvs[R+1]=S,this._buffer.positions[P+3]=g,this._buffer.positions[P+4]=m,this._buffer.positions[P+5]=y,this._buffer.normals[P+3]=A*u,this._buffer.normals[P+4]=b*u,this._buffer.normals[P+5]=-d,this._buffer.uvs[R+2]=S,this._buffer.uvs[R+3]=_,c||(E+=2,P+=6,R+=4,F.topP=E+0,F.bottomP=E+1,this._buffer.positions[P+0]=g,this._buffer.positions[P+1]=m,this._buffer.positions[P+2]=this._depth-y,this._buffer.normals[P+0]=T*u,this._buffer.normals[P+1]=M*u,this._buffer.normals[P+2]=d,this._buffer.uvs[R+0]=_,this._buffer.uvs[R+1]=S,this._buffer.positions[P+3]=g,this._buffer.positions[P+4]=m,this._buffer.positions[P+5]=y,this._buffer.normals[P+3]=T*u,this._buffer.normals[P+4]=M*u,this._buffer.normals[P+5]=-d,this._buffer.uvs[R+2]=S,this._buffer.uvs[R+3]=_),this.vertexCache[r]=F,F}clone(){let t=new MJ(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return t.userData=yE(this.userData),t}},EJ=class extends Lt{constructor(t,e=12,n={}){super(),this.type="ShapeGeometry",this.windingRule=Rn.ODD,this.elementType=zi.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=t,this._curveSegments=e,this._triangulationOptions=Object.assign({windingRule:Rn.ODD,elementType:zi.POLYGONS,polySize:3,vertexSize:2,strict:!0},n);let i=this._shape.extractShapePointsToFlatArray([],this._curveSegments),r=this._shape.shapeHoles.map(d=>d.extractShapePointsToFlatArray([],this._curveSegments)),s,o=!0,a=!0,l,c;for(let d=0,f=i.length/2;d<f;d++){let p=d*2,v=i[p+0],g=i[p+1];if(l!==void 0&&v!==l&&(o=!1),c!==void 0&&g!==c&&(a=!1),l=v,c=g,!o&&!a)break}if(!o&&!a)try{s=ph({contours:[i,...r],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{s=uF}let h=(s==null?void 0:s.vertexCount)??1,u=(s==null?void 0:s.elementCount)??1;if(this._positionAttribute=new Ut(new Float32Array(h*3),3),this._normalAttribute=new Ut(new Float32Array(h*3),3),this._uvAttribute=new Ut(new Float32Array(h*2),2),this._indexAttribute=new Ut(new Uint32Array(u*3),1),s){let d=1/0,f=-1/0,p=1/0,v=-1/0;for(let y=0,_=h;y<_;y++){let S=y*2,A=s.vertices[S+0],b=s.vertices[S+1];A<d&&(d=A),A>f&&(f=A),b<p&&(p=b),b>v&&(v=b)}let g=f-d,m=v-p;for(let y=0,_=h;y<_;y++){let S=y*2,A=s.vertices[S+0],b=s.vertices[S+1],T=(A-d)/g,M=(b-p)/m;this._positionAttribute.setXYZ(y,A,b,0),this._normalAttribute.setXYZ(y,0,0,1),this._uvAttribute.setXY(y,T,M)}for(let y=0,_=u;y<_;y++){let S=y*3,A=s.elements[S+0],b=s.elements[S+1],T=s.elements[S+2];this._indexAttribute.setX(S+0,A),this._indexAttribute.setX(S+1,b),this._indexAttribute.setX(S+2,T)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((s==null?void 0:s.elementCount)??1)*3)}clone(){let t=new EJ(this._shape,this._curveSegments);return t.userData=yE(this.userData),t}},CJ=class extends MJ{constructor(t,e,n=0,i=12,r=3,s=Rn.ODD){super(t,e,n,i,r,s),this.type="ShapeGeometry"}_computeBufferEstimatedSize(t){return t.vertexCount*2*(2+this._bevelSegments)}_buildWall(t,e,n){let i=t[0];for(let r=0,s=i.boundary.vertexCount;r<s;r++){let o=this._buildBevelVert(e,i,r),a=this._buildBevelVert(e,i,(r+1)%s);n.push(a.topP,o.topN,o.bottomN),n.push(a.topP,o.bottomN,a.bottomP)}}clone(){let t=new CJ(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return t.userData=yE(this.userData),t}},Qf=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){var c,h;let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:Rn.ODD},t.parameters),i=Math.abs(n.width),r=Math.abs(n.height??n.width),s=Math.abs(n.depth??0),o=t.shape??(e==null?void 0:e.shape),a=(o==null?void 0:o.roundness)??n.roundness;o!==void 0&&(o instanceof _i?(o.width!==i||o.height!==r)&&o.applySize(i,r):o=new _i(i,r).fromJSON(o),((c=t.parameters)==null?void 0:c.roundness)!==void 0&&((h=t.parameters)==null?void 0:h.roundness)>0&&o.update());let l=o??new _i(i,r);return{parameters:Object.assign(n,{width:i,height:r,depth:s,roundness:a}),shape:l}}static build(t){let{depth:e,extrudeBevelSize:n,extrudeBevelSegments:i,subdivisions:r,roundness:s,windingRule:o}=t.parameters;t.shape.roundness=s;let a;return e<=0?a=new EJ(t.shape,r,{windingRule:o}):a=new CJ(t.shape,e,n,r,i,o),Object.assign(a,{userData:{...t,type:"VectorGeometry"}})}},TJ=Math.PI*2,hF=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters);return{shape:t.shape&&t.shape instanceof _i?t.shape:new _i,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e,height:n,spikes:i,angle:r,innerRadius:s,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}=t.parameters,c=t.shape,h=e*.5,u=n*.5,d=JIe(c,h,u,r*Math.PI/180,i,s);c.isClosed=!0,c.update();let f=Qf.create({shape:c,parameters:{subdivisions:d,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}});return Object.assign(f,{userData:{...t,type:"EllipseGeometry"}})}};function JIe(t,e,n,i,r,s){if(i>=TJ)return r>30||r%4===0?($Ie(t,e,n,s),Math.round(r/4)):Lj(t,i,r,e,n,s);i=Math.max(i,.001);let o={x:0,y:n},a=i+Math.PI*.5,l={x:Math.cos(a)*e,y:Math.sin(a)*n},c=XIe({px:o.x,py:o.y,cx:l.x,cy:l.y,rx:e,ry:n,largeArcFlag:i>Math.PI,sweepFlag:!0});return r>30||r%c.length===0?ZIe(t,o.x,o.y,c,r,e,n,s):Lj(t,i,r,e,n,s)}function ZIe(t,e,n,i,r,s,o,a){let l=Math.round(r/i.length);t.addPoint(fg(e,n));for(let c=0,h=i.length;c<h;c++){let u=i[c],d=t.points[c],f=fg(u.x,u.y);d.controls[1].position.set(u.x1,u.y1),f.controls[0].position.set(u.x2,u.y2),t.addPoint(f)}return a>0?PJ(t,s,o,a):t.addPoint(fg(0,0)),l}function Lj(t,e,n,i,r,s){let o=-e/n;for(let a=0;a<=n;a++){let l=o*a,c=Math.sin(l)*i,h=Math.cos(l)*r;t.addPoint(fg(c,h))}return e<TJ?s>0?PJ(t,i,r,s):t.addPoint(fg(0,0)):(t.removePoint(t.points[t.points.length-1]),s>0&&DJ(t,i,r,s)),1}function $Ie(t,e,n,i=0,r=0,s=0){let o=.5522847498,a=e*o,l=n*o;t.addPoint(DS(r-e,s,r-e,s-l,r-e,s+l)),t.addPoint(DS(r,s+n,r-a,s+n,r+a,s+n)),t.addPoint(DS(r+e,s,r+e,s+l,r+e,s-l)),t.addPoint(DS(r,s-n,r+a,s-n,r-a,s-n)),i>0&&DJ(t,e,n,i)}function fg(t,e){return new dg(sn.generateUUID(),new Se(t,e))}function DS(t,e,n,i,r,s){let o=fg(t,e);return o.controls[0].position.set(n,i),o.controls[1].position.set(r,s),o}function PJ(t,e,n,i){RJ(t,e,n,i).forEach(r=>t.addPoint(r))}function DJ(t,e,n,i){let r=RJ(t,e,n,i),s=new _i;r.forEach(o=>s.addPoint(o)),s.isClosed=!0,t.shapeHoles.push(s)}function RJ(t,e,n,i){let r=i*e/100,s=r*(Math.abs(n)/Math.abs(e)),o=new Se(r/e,s/n),a=t.points.map(l=>{let c=l.clone();return c.uuid=sn.generateUUID(),c}).reverse();return a.forEach(l=>{l.position.multiply(o);let c=l.controls[0].position.clone().multiply(o),h=l.controls[1].position.clone().multiply(o);l.controls[0].position.copy(h),l.controls[1].position.copy(c)}),a}var e3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},t.parameters),i=Math.abs(n.width),r=Math.abs(n.height??i),s=Math.abs(n.depth??i),o=Math.abs(Math.min(i,s))/2;return{parameters:Object.assign(n,{width:i,height:r,depth:s,radius:o,segments:Math.round(n.segments),pathSegments:Math.round(n.pathSegments),cornerSegments:Math.round(n.cornerSegments)})}}static build(t){let{width:e,height:n,depth:i,radius:r,revolutions:s,segments:o,pathRadius:a,pathType:l,pathSegments:c,cornerRadius:h,cornerSegments:u}=t.parameters,d=new dF(!1,e,n,i,r,s,o,a,l,c,h,u);return Object.assign(d,{userData:{...t,type:"HelixGeometry"}})}},dF=class extends Lt{constructor(t=!0,e=1,n=1,i=1,r=1,s=1,o=1,a=1,l=1,c=1,h=1,u=1,d=!1){super();let f=t&&s===1;f&&(u=0),h>100&&(h=100);let p=()=>new N,v=new N,g=p(),m=p(),y=p(),_,S,A,b,T,M,E,P,R=p(),F=p(),B=p(),k=p(),j=p(),Z=p(),ee=p(),O=p(),W=n-2*a+.001,H=W/s,Y=Math.ceil(o*s),z=Y+1,X=W/Y,q=-W/2,re=c+1,G=2*Math.PI/c,K=Math.PI/2/u,oe=.01,ve=Math.min((1-h/100)*a,a-oe),$=a-ve,se=0,ne=2,ie=u*ne+ne,me=re*ie/ne,xe=me+re*z,Ae=re*(z+ie),[we,Ee,Re]=[3,3,2].map(Ve=>Array(Ae*Ve).fill(0)),Ue=[],Ne=r-a;function U(Ve,ue){let Me=Math.PI/2;M=ue*X,P=2*Math.PI*(M%H)/H+Me,M+=q,E=Math.sin(P)*Ne,T=Math.cos(P)*Ne,t?Ve.set(T,E,M):Ve.set(T,M,E)}U(v,-1e-10),U(g,0),R.copy(v),U(v,1);let L=v.distanceTo(g),te=f?0:$+ve,_e=L*Y+2*te,Te=ve,Ie=_e-te;for(let Ve=0;Ve<=Y;Ve++){U(m,Ve),O.subVectors(m,R).normalize(),R.copy(m),Z.copy(m).setComponent(+t+1,0).normalize(),ee.crossVectors(O,Z).normalize();let ue=Ve===0,Me=Ve===Y,Be=ue?3*Math.PI/2:K,ze=ue?Te:Ie,$e=ue?re:xe,dt=ue?0:Ae-re,Bt=O.clone().multiplyScalar(ue?-$:$).add(m),J=O.clone().multiplyScalar(ue?-1:1).normalize();for(let fe=0;fe<re;fe++){let be=fe*G;if(F.addVectors(v.copy(Z).multiplyScalar(a*Math.cos(be)),g.copy(ee).multiplyScalar(a*Math.sin(be))),B.copy(F).normalize(),ue||Me){f||(se=dt+fe,[0,1,2].forEach(Oe=>{we[se*3+Oe]=Bt.getComponent(Oe),Ee[se*3+Oe]=J.getComponent(Oe)}),Re[se*2]=+Me,Re[se*2+1]=fe/c),g.copy(B).multiplyScalar(ve),y.addVectors(m,g);for(let Oe=0;Oe<u;Oe++){let qe=Oe*K+Be;k.addVectors(v.copy(O).multiplyScalar($*Math.sin(qe)),g.copy(B).multiplyScalar($*Math.cos(qe))),j.copy(k).normalize(),g.addVectors(y,k),k.normalize(),se=$e+Oe*re+fe,[0,1,2].forEach(Et=>{we[se*3+Et]=g.getComponent(Et),Ee[se*3+Et]=j.getComponent(Et)});let vt=+ue+Math.sin(qe);Re[se*2]=(ze+$*vt)/_e,Re[se*2+1]=fe/c}}g.addVectors(m,F),se=me+Ve*re+fe,[0,1,2].forEach(Oe=>{we[se*3+Oe]=g.getComponent(Oe),Ee[se*3+Oe]=B.getComponent(Oe)}),Re[se*2]=(te+Ve*L)/_e,Re[se*2+1]=fe/c}}let Qe=z+2*u+ne,[Ge,ye]=[+f,Qe-1];d&&(ye-=1);for(let Ve=Ge;Ve<=ye-1;Ve++){let ue=f&&Ve===ye-1;for(let Me=0;Me<re-1;Me++)_=Ve*re+Me,S=_+1,A=(ue?Me:_)+re,b=(ue?Me+1:S)+re,Ve===0?Ue.push(S,b,A):Ve===Qe-2?Ue.push(_,S,A):Ue.push(_,S,A,S,b,A)}this.setIndex(Ue),this.setAttribute("position",new ft(we,3)),this.setAttribute("normal",new ft(Ee,3)),this.setAttribute("uv",new ft(Re,2))}},t3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,detail:0,corner:0,cornerSides:4},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,detail:r,corner:s,cornerSides:o}=t.parameters,a=r===0&&s!==0?new LJ(e*.5,s,o):new HQ(e*.5,r);return a.scale(1,n/e,i/e),Object.assign(a,{userData:{...t,type:"IcosahedronGeometry"}})}},LJ=class extends aF{constructor(t=1,e=.2,n=4){let i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],o="IcosahedronGeometry";super(r,s,o,t,e,n),this.type=o}static fromJSON(t){return new LJ(t.radius,t.corner,t.cornerSides)}},n3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){var i;(((i=t.parameters)==null?void 0:i.points)??[]).forEach(r=>{Array.isArray(r)&&(r.x=r[0],r.y=r[1])});let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{points:e,segments:n,verticalSegments:i}=t.parameters,r=new CA;r.moveTo(e[0].x,e[0].y),r.bezierCurveTo(e[1].x,e[1].y,e[2].x,e[2].y,e[3].x,e[3].y);let s=new OQ(r.extractPoints(i).shape,n);return s.rotateZ(Math.PI),Object.assign(s,{userData:{...t,type:"LatheGeometry"}})}},yl=new nt,T2=new Fn,RS=new N,iM=class extends ys{constructor(){super(),this.uuid=sn.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(t){let e=new Pr().getNormalMatrix(t);for(let n=0,i=this.vertices.length;n<i;n++)this.vertices[n].applyMatrix4(t);for(let n=0,i=this.faces.length;n<i;n++){let r=this.faces[n];r.normal.applyMatrix3(e).normalize();for(let s=0,o=r.vertexNormals.length;s<o;s++)r.vertexNormals[s].applyMatrix3(e).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(t){return yl.makeRotationX(t),this.applyMatrix4(yl),this}rotateY(t){return yl.makeRotationY(t),this.applyMatrix4(yl),this}rotateZ(t){return yl.makeRotationZ(t),this.applyMatrix4(yl),this}translate(t,e,n){return yl.makeTranslation(t,e,n),this.applyMatrix4(yl),this}scale(t,e,n){return yl.makeScale(t,e,n),this.applyMatrix4(yl),this}lookAt(t){return T2.lookAt(t),T2.updateMatrix(),this.applyMatrix4(T2.matrix),this}fromBufferGeometry(t){let e=this,n=t.index!==null?t.index:void 0,i=t.attributes;if(i.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let r=i.position,s=i.normal,o=i.color,a=i.uv,l=i.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(let u=0;u<r.count;u++)e.vertices.push(new N().fromBufferAttribute(r,u)),o!==void 0&&e.colors.push(new Rt().fromBufferAttribute(o,u));function c(u,d,f,p){let v=o===void 0?[]:[e.colors[u].clone(),e.colors[d].clone(),e.colors[f].clone()],g=s===void 0?[]:[new N().fromBufferAttribute(s,u),new N().fromBufferAttribute(s,d),new N().fromBufferAttribute(s,f)],m=new wI(u,d,f,g,v,p);e.faces.push(m),a!==void 0&&e.faceVertexUvs[0].push([new Se().fromBufferAttribute(a,u),new Se().fromBufferAttribute(a,d),new Se().fromBufferAttribute(a,f)]),l!==void 0&&e.faceVertexUvs[1].push([new Se().fromBufferAttribute(l,u),new Se().fromBufferAttribute(l,d),new Se().fromBufferAttribute(l,f)])}let h=t.groups;if(h.length>0)for(let u=0;u<h.length;u++){let d=h[u],f=d.start,p=d.count;for(let v=f,g=f+p;v<g;v+=3)n!==void 0?c(n.getX(v),n.getX(v+1),n.getX(v+2),d.materialIndex):c(v,v+1,v+2,d.materialIndex)}else if(n!==void 0)for(let u=0;u<n.count;u+=3)c(n.getX(u),n.getX(u+1),n.getX(u+2));else for(let u=0;u<r.count;u+=3)c(u,u+1,u+2);return this.computeFaceNormals(),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(RS).negate(),this.translate(RS.x,RS.y,RS.z),this}normalize(){this.computeBoundingSphere();let t=this.boundingSphere.center,e=this.boundingSphere.radius,n=e===0?1:1/e,i=new nt;return i.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix4(i),this}computeFaceNormals(){let t=new N,e=new N;for(let n=0,i=this.faces.length;n<i;n++){let r=this.faces[n],s=this.vertices[r.a],o=this.vertices[r.b],a=this.vertices[r.c];t.subVectors(a,o),e.subVectors(s,o),t.cross(e),t.normalize(),r.normal.copy(t)}}computeVertexNormals(t=!0){let e=new Array(this.vertices.length);for(let n=0,i=this.vertices.length;n<i;n++)e[n]=new N;if(t){let n=new N,i=new N;for(let r=0,s=this.faces.length;r<s;r++){let o=this.faces[r],a=this.vertices[o.a],l=this.vertices[o.b],c=this.vertices[o.c];n.subVectors(c,l),i.subVectors(a,l),n.cross(i),e[o.a].add(n),e[o.b].add(n),e[o.c].add(n)}}else{this.computeFaceNormals();for(let n=0,i=this.faces.length;n<i;n++){let r=this.faces[n];e[r.a].add(r.normal),e[r.b].add(r.normal),e[r.c].add(r.normal)}}for(let n=0,i=this.vertices.length;n<i;n++)e[n].normalize();for(let n=0,i=this.faces.length;n<i;n++){let r=this.faces[n],s=r.vertexNormals;s.length===3?(s[0].copy(e[r.a]),s[1].copy(e[r.b]),s[2].copy(e[r.c])):(s[0]=e[r.a].clone(),s[1]=e[r.b].clone(),s[2]=e[r.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let t=0,e=this.faces.length;t<e;t++){let n=this.faces[t],i=n.vertexNormals;i.length===3?(i[0].copy(n.normal),i[1].copy(n.normal),i[2].copy(n.normal)):(i[0]=n.normal.clone(),i[1]=n.normal.clone(),i[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let e=0,n=this.faces.length;e<n;e++){let i=this.faces[e];i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]);for(let r=0,s=i.vertexNormals.length;r<s;r++)i.__originalVertexNormals[r]?i.__originalVertexNormals[r].copy(i.vertexNormals[r]):i.__originalVertexNormals[r]=i.vertexNormals[r].clone()}let t=new iM;t.faces=this.faces;for(let e=0,n=this.morphTargets.length;e<n;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];let r=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(let o=0,a=this.faces.length;o<a;o++){let l=new N,c={a:new N,b:new N,c:new N};r.push(l),s.push(c)}}let i=this.morphNormals[e];t.vertices=this.morphTargets[e].vertices,t.computeFaceNormals(),t.computeVertexNormals();for(let r=0,s=this.faces.length;r<s;r++){let o=this.faces[r],a=i.faceNormals[r],l=i.vertexNormals[r];a.copy(o.normal),l.a.copy(o.vertexNormals[0]),l.b.copy(o.vertexNormals[1]),l.c.copy(o.vertexNormals[2])}}for(let e=0,n=this.faces.length;e<n;e++){let i=this.faces[e];i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Vi),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new la),this.boundingSphere.setFromPoints(this.vertices)}merge(t,e,n=0){if(!(t&&t.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);return}let i,r=this.vertices.length,s=this.vertices,o=t.vertices,a=this.faces,l=t.faces,c=this.colors,h=t.colors;e!==void 0&&(i=new Pr().getNormalMatrix(e));for(let u=0,d=o.length;u<d;u++){let f=o[u].clone();e!==void 0&&f.applyMatrix4(e),s.push(f)}for(let u=0,d=h.length;u<d;u++)c.push(h[u].clone());for(let u=0,d=l.length;u<d;u++){let f=l[u],p,v,g=f.vertexNormals,m=f.vertexColors,y=new wI(f.a+r,f.b+r,f.c+r);y.normal.copy(f.normal),i!==void 0&&y.normal.applyMatrix3(i).normalize();for(let _=0,S=g.length;_<S;_++)p=g[_].clone(),i!==void 0&&p.applyMatrix3(i).normalize(),y.vertexNormals.push(p);y.color.copy(f.color);for(let _=0,S=m.length;_<S;_++)v=m[_],y.vertexColors.push(v.clone());y.materialIndex=f.materialIndex+n,a.push(y)}for(let u=0,d=t.faceVertexUvs.length;u<d;u++){let f=t.faceVertexUvs[u];this.faceVertexUvs[u]===void 0&&(this.faceVertexUvs[u]=[]);for(let p=0,v=f.length;p<v;p++){let g=f[p],m=[];for(let y=0,_=g.length;y<_;y++)m.push(g[y].clone());this.faceVertexUvs[u].push(m)}}}mergeMesh(t){if(!(t&&t.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t);return}t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)}mergeVertices(t=4){let e={},n=[],i=[],r=Math.pow(10,t);for(let a=0,l=this.vertices.length;a<l;a++){let c=this.vertices[a],h=Math.round(c.x*r)+"_"+Math.round(c.y*r)+"_"+Math.round(c.z*r);e[h]===void 0?(e[h]=a,n.push(this.vertices[a]),i[a]=n.length-1):i[a]=i[e[h]]}let s=[];for(let a=0,l=this.faces.length;a<l;a++){let c=this.faces[a];c.a=i[c.a],c.b=i[c.b],c.c=i[c.c];let h=[c.a,c.b,c.c];for(let u=0;u<3;u++)if(h[u]===h[(u+1)%3]){s.push(a);break}}for(let a=s.length-1;a>=0;a--){let l=s[a];this.faces.splice(l,1);for(let c=0,h=this.faceVertexUvs.length;c<h;c++)this.faceVertexUvs[c].splice(l,1)}let o=this.vertices.length-n.length;return this.vertices=n,o}setFromPoints(t){this.vertices=[];for(let e=0,n=t.length;e<n;e++){let i=t[e];this.vertices.push(new N(i.x,i.y,i.z||0))}return this}sortFacesByMaterialIndex(){let t=this.faces,e=t.length;for(let a=0;a<e;a++)t[a]._id=a;function n(a,l){return a.materialIndex-l.materialIndex}t.sort(n);let i=this.faceVertexUvs[0],r=this.faceVertexUvs[1],s,o;i&&i.length===e&&(s=[]),r&&r.length===e&&(o=[]);for(let a=0;a<e;a++){let l=t[a]._id;s&&s.push(i[l]),o&&o.push(r[l])}s&&(this.faceVertexUvs[0]=s),o&&(this.faceVertexUvs[1]=o)}toJSON(){let t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),this.parameters!==void 0){let f=this.parameters;for(let p in f)f[p]!==void 0&&(t[p]=f[p]);return t}let e=[];for(let f=0;f<this.vertices.length;f++){let p=this.vertices[f];e.push(p.x,p.y,p.z)}let n=[],i=[],r={},s=[],o={},a=[],l={};for(let f=0;f<this.faces.length;f++){let p=this.faces[f],v=!0,g=!1,m=this.faceVertexUvs[0][f]!==void 0,y=p.normal.length()>0,_=p.vertexNormals.length>0,S=p.color.r!==1||p.color.g!==1||p.color.b!==1,A=p.vertexColors.length>0,b=0;if(b=c(b,0,0),b=c(b,1,v),b=c(b,2,g),b=c(b,3,m),b=c(b,4,y),b=c(b,5,_),b=c(b,6,S),b=c(b,7,A),n.push(b),n.push(p.a,p.b,p.c),n.push(p.materialIndex),m){let T=this.faceVertexUvs[0][f];n.push(d(T[0]),d(T[1]),d(T[2]))}if(y&&n.push(h(p.normal)),_){let T=p.vertexNormals;n.push(h(T[0]),h(T[1]),h(T[2]))}if(S&&n.push(u(p.color)),A){let T=p.vertexColors;n.push(u(T[0]),u(T[1]),u(T[2]))}}function c(f,p,v){return v?f|1<<p:f&~(1<<p)}function h(f){let p=f.x.toString()+f.y.toString()+f.z.toString();return r[p]!==void 0||(r[p]=i.length/3,i.push(f.x,f.y,f.z)),r[p]}function u(f){let p=f.r.toString()+f.g.toString()+f.b.toString();return o[p]!==void 0||(o[p]=s.length,s.push(f.getHex())),o[p]}function d(f){let p=f.x.toString()+f.y.toString();return l[p]!==void 0||(l[p]=a.length/2,a.push(f.x,f.y)),l[p]}return t.data={},t.data.vertices=e,t.data.normals=i,s.length>0&&(t.data.colors=s),a.length>0&&(t.data.uvs=[a]),t.data.faces=n,t}clone(){return new iM().copy(this)}copy(t){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;let e=t.vertices;for(let u=0,d=e.length;u<d;u++)this.vertices.push(e[u].clone());let n=t.colors;for(let u=0,d=n.length;u<d;u++)this.colors.push(n[u].clone());let i=t.faces;for(let u=0,d=i.length;u<d;u++)this.faces.push(i[u].clone());for(let u=0,d=t.faceVertexUvs.length;u<d;u++){let f=t.faceVertexUvs[u];this.faceVertexUvs[u]===void 0&&(this.faceVertexUvs[u]=[]);for(let p=0,v=f.length;p<v;p++){let g=f[p],m=[];for(let y=0,_=g.length;y<_;y++){let S=g[y];m.push(S.clone())}this.faceVertexUvs[u].push(m)}}let r=t.morphTargets;for(let u=0,d=r.length;u<d;u++){let f={};if(f.name=r[u].name,r[u].vertices!==void 0){f.vertices=[];for(let p=0,v=r[u].vertices.length;p<v;p++)f.vertices.push(r[u].vertices[p].clone())}if(r[u].normals!==void 0){f.normals=[];for(let p=0,v=r[u].normals.length;p<v;p++)f.normals.push(r[u].normals[p].clone())}this.morphTargets.push(f)}let s=t.morphNormals;for(let u=0,d=s.length;u<d;u++){let f={};if(s[u].vertexNormals!==void 0){f.vertexNormals=[];for(let p=0,v=s[u].vertexNormals.length;p<v;p++){let g=s[u].vertexNormals[p],m={};m.a=g.a.clone(),m.b=g.b.clone(),m.c=g.c.clone(),f.vertexNormals.push(m)}}if(s[u].faceNormals!==void 0){f.faceNormals=[];for(let p=0,v=s[u].faceNormals.length;p<v;p++)f.faceNormals.push(s[u].faceNormals[p].clone())}this.morphNormals.push(f)}let o=t.skinWeights;for(let u=0,d=o.length;u<d;u++)this.skinWeights.push(o[u].clone());let a=t.skinIndices;for(let u=0,d=a.length;u<d;u++)this.skinIndices.push(a[u].clone());let l=t.lineDistances;for(let u=0,d=l.length;u<d;u++)this.lineDistances.push(l[u]);let c=t.boundingBox;c!==null&&(this.boundingBox=c.clone());let h=t.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}toBufferGeometry(){let t=new i3e().fromGeometry(this),e=new Lt,n=new Float32Array(t.vertices.length*3);if(e.setAttribute("position",LS.call(new Ut(n,3),t.vertices)),t.normals.length>0){let i=new Float32Array(t.normals.length*3);e.setAttribute("normal",LS.call(new Ut(i,3),t.normals))}if(t.colors.length>0){let i=new Float32Array(t.colors.length*3);e.setAttribute("color",Ij.call(new Ut(i,3),t.colors))}if(t.uvs.length>0){let i=new Float32Array(t.uvs.length*2);e.setAttribute("uv",Bj.call(new Ut(i,2),t.uvs))}if(t.uvs2.length>0){let i=new Float32Array(t.uvs2.length*2);e.setAttribute("uv2",Bj.call(new Ut(i,2),t.uvs2))}e.groups=t.groups;for(let i in t.morphTargets){let r=[],s=t.morphTargets[i];for(let o=0,a=s.length;o<a;o++){let l=s[o],c=new ft(l.data.length*3,3);c.name=l.name,r.push(LS.call(c,l.data))}e.morphAttributes[i]=r}if(t.skinIndices.length>0){let i=new ft(t.skinIndices.length*4,4);e.setAttribute("skinIndex",Oj.call(i,t.skinIndices))}if(t.skinWeights.length>0){let i=new ft(t.skinWeights.length*4,4);e.setAttribute("skinWeight",Oj.call(i,t.skinWeights))}return t.boundingSphere!==null&&(e.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(e.boundingBox=t.boundingBox.clone()),e}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(t){let e=new Lt,n=t.geometry;if(t.isPoints||t.isLine){let i=new ft(n.vertices.length*3,3),r=new ft(n.colors.length*3,3);if(e.setAttribute("position",LS.call(i,n.vertices)),e.setAttribute("color",Ij.call(r,n.colors)),n.lineDistances&&n.lineDistances.length===n.vertices.length){let s=new ft(n.lineDistances.length,1);e.setAttribute("lineDistance",r3e.call(s,n.lineDistances))}n.boundingSphere!==null&&(e.boundingSphere=n.boundingSphere.clone()),n.boundingBox!==null&&(e.boundingBox=n.boundingBox.clone())}else t.isMesh&&(e=n.toBufferGeometry());return e}};iM.prototype.isGeometry=!0;var i3e=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(t){let e=[],n,i,r,s=t.faces;for(i=0;i<s.length;i++){let o=s[i];o.materialIndex!==r&&(r=o.materialIndex,n!==void 0&&(n.count=i*3-n.start,e.push(n)),n={start:i*3,materialIndex:r})}n!==void 0&&(n.count=i*3-n.start,e.push(n)),this.groups=e}fromGeometry(t){let e=t.faces,n=t.vertices,i=t.faceVertexUvs,r=i[0]&&i[0].length>0,s=i[1]&&i[1].length>0,o=t.morphTargets,a=o.length,l;if(a>0){l=[];for(let g=0;g<a;g++)l[g]={name:o[g].name,data:[]};this.morphTargets.position=l}let c=t.morphNormals,h=c.length,u;if(h>0){u=[];for(let g=0;g<h;g++)u[g]={name:c[g].name,data:[]};this.morphTargets.normal=u}let d=t.skinIndices,f=t.skinWeights,p=d.length===n.length,v=f.length===n.length;n.length>0&&e.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let g=0;g<e.length;g++){let m=e[g];this.vertices.push(n[m.a],n[m.b],n[m.c]);let y=m.vertexNormals;if(y.length===3)this.normals.push(y[0],y[1],y[2]);else{let S=m.normal;this.normals.push(S,S,S)}let _=m.vertexColors;if(_.length===3)this.colors.push(_[0],_[1],_[2]);else{let S=m.color;this.colors.push(S,S,S)}if(r===!0){let S=i[0][g];S!==void 0?this.uvs.push(S[0],S[1],S[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",g),this.uvs.push(new Se,new Se,new Se))}if(s===!0){let S=i[1][g];S!==void 0?this.uvs2.push(S[0],S[1],S[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",g),this.uvs2.push(new Se,new Se,new Se))}for(let S=0;S<a;S++){let A=o[S].vertices;l[S].data.push(A[m.a],A[m.b],A[m.c])}for(let S=0;S<h;S++){let A=c[S].vertexNormals[g];u[S].data.push(A.a,A.b,A.c)}p&&this.skinIndices.push(d[m.a],d[m.b],d[m.c]),v&&this.skinWeights.push(f[m.a],f[m.b],f[m.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this}},wI=class{constructor(t,e,n,i,r,s=0){this.a=t,this.b=e,this.c=n,this.normal=i&&i.isVector3?i:new N,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new Rt,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=s}clone(){return new this.constructor().copy(this)}copy(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(let e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(let e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}};function r3e(t){return this.array.set(t),this}function Ij(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),s=new Rt),e[n++]=s.r,e[n++]=s.g,e[n++]=s.b}return this}function Bj(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),s=new Se),e[n++]=s.x,e[n++]=s.y}return this}function LS(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),s=new N),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z}return this}function Oj(t){let e=this.array,n=0;for(let i=0,r=t.length;i<r;i++){let s=t[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),s=new Zt),e[n++]=s.x,e[n++]=s.y,e[n++]=s.z,e[n++]=s.w}return this}var s3e=["a","b","c"];function o3e(t,e){switch(e){case"c":return t.c;case"b":return t.b;case"a":default:return t.a}}function P2(t,e,n){let i=Math.min(t,e),r=Math.max(t,e),s=i+"_"+r;return n.get(s)}function D2(t,e,n,i,r,s){let o=Math.min(t,e),a=Math.max(t,e),l=o+"_"+a,c;if(i.has(l))c=i.get(l);else{let h=n[o],u=n[a];c={a:h,b:u,newEdge:null,faces:[]},i.set(l,c)}c.faces.push(r),s[t].edges.push(c),s[e].edges.push(c)}function a3e(t,e,n,i){let r,s,o;for(r=0,s=t.length;r<s;r++)n[r]={edges:[]};for(r=0,s=e.length;r<s;r++)o=e[r],D2(o.a,o.b,t,i,o,n),D2(o.b,o.c,t,i,o,n),D2(o.c,o.a,t,i,o,n)}function IS(t,e,n,i,r){t.push(new wI(e,n,i,void 0,void 0,r))}function $p(t,e){return Math.abs(e-t)/2+Math.min(t,e)}function BS(t,e,n,i){t.push([e.clone(),n.clone(),i.clone()])}var l3e=class{constructor(t=1){this.subdivisions=t}modify(t){t instanceof Lt?t=new iM().fromBufferGeometry(t):t=t.clone(),t.mergeVertices();let e=this.subdivisions;for(;e-- >0;)this._smooth(t);return t.computeFaceNormals(),t.computeVertexNormals(),t}_smooth(t){let e=new N,n,i,r,s,o,a=t.vertices,l=t.faces,c=t.faceVertexUvs[0],h=c!==void 0&&c.length>0,u=[],d=new Map;a3e(a,l,u,d);let f=[],p,v,g,m,y,_,S;for(let K of Array.from(d.keys())){for(v=d.get(K),g=new N,y=3/8,_=1/8,S=v.faces.length,S!=2&&(y=.5,_=0,S!=1),g.addVectors(v.a,v.b).multiplyScalar(y),e.set(0,0,0),s=0;s<S;s++){for(m=v.faces[s],o=0;o<3&&(p=a[o3e(m,s3e[o])],!(p!==v.a&&p!==v.b));o++);p&&e.add(p)}e.multiplyScalar(_),g.add(e),v.newEdge=f.length,f.push(g)}let A,b,T,M,E,P,R,F=[];for(i=0,r=a.length;i<r;i++){for(P=a[i],E=u[i].edges,n=E.length,n==3?A=3/16:n>3&&(A=3/(8*n)),b=1-n*Number(A),T=A,n<=2&&(n==2?(b=3/4,T=1/8):n==1||n==0),R=P.clone().multiplyScalar(b),e.set(0,0,0),s=0;s<n;s++)M=E[s],p=M.a!==P?M.a:M.b,e.add(p);e.multiplyScalar(Number(T)),R.add(e),F.push(R)}let B=F.concat(f),k=F.length,j,Z,ee,O=[],W=[],H,Y,z,X,q=new Se,re=new Se,G=new Se;for(i=0,r=l.length;i<r;i++)m=l[i],j=Number(P2(m.a,m.b,d).newEdge)+k,Z=Number(P2(m.b,m.c,d).newEdge)+k,ee=Number(P2(m.c,m.a,d).newEdge)+k,IS(O,j,Z,ee,m.materialIndex),IS(O,m.a,j,ee,m.materialIndex),IS(O,m.b,Z,j,m.materialIndex),IS(O,m.c,ee,Z,m.materialIndex),h&&(H=c[i],Y=H[0],z=H[1],X=H[2],q.set($p(Y.x,z.x),$p(Y.y,z.y)),re.set($p(z.x,X.x),$p(z.y,X.y)),G.set($p(Y.x,X.x),$p(Y.y,X.y)),BS(W,q,re,G),BS(W,Y,q,G),BS(W,z,re,q),BS(W,X,G,re));t.vertices=B,t.faces=O,h&&(t.faceVertexUvs[0]=W)}},Yi=new N,c3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=t.geometry??(e==null?void 0:e.geometry)??new Lt().copy(new Zl(100,100,100)),i;e===void 0?(n.computeBoundingBox(),n.boundingBox.getSize(Yi),i={width:Yi.x,height:Yi.y,depth:Yi.z,subdivisions:0}):i=e.parameters;let r={...i,...t.parameters};return{parameters:{width:Math.abs(r.width),height:Math.abs(r.height),depth:Math.abs(r.depth),subdivisions:Math.abs(r.subdivisions)},geometry:n}}static build(t){let{width:e,height:n,depth:i,subdivisions:r}=t.parameters,s=t.geometry??new Lt().copy(new Zl(100,100,100)),o=s.userData.parameters;o===void 0?(s.computeBoundingBox(),s.boundingBox.getSize(Yi)):Yi.set(o.width,o.height,o.depth),(e!==Yi.x||n!==Yi.y||i!==Yi.z)&&s.scale(Yi.x===0?1:e/Yi.x,Yi.y===0?1:n/Yi.y,Yi.z===0?1:i/Yi.z);let a=s.originalGeometry;return r>0?(a===void 0||(o==null?void 0:o.subdivisions)!==r)&&(a===void 0&&(a=s),s=new l3e(r).modify(a).toBufferGeometry()):(a!==void 0&&(s=a),a=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals()),a!==void 0&&Object.assign(s,{originalGeometry:a}),delete t.geometry,Object.assign(s,{userData:{...t,type:"NonParametricGeometry"}})}static loadFromUrl(t,e,n){new WQ(n).load(t,i=>{let r=this.normalizeInputs({geometry:i});i.boundingBox.getSize(Yi);let s=100/Yi.x;Object.assign(r.parameters,{width:100,height:Yi.y*s,depth:Yi.z*s}),e(this.build(r))})}},IJ=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},t.parameters);return{shape:t.shape&&t.shape instanceof _i?t.shape:new _i,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e,height:n,spikes:i,cornerRadius:r,depth:s,extrudeBevelSize:o,extrudeBevelSegments:a}=t.parameters,l=t.shape,c=e*.5,h=n*.5,u=0,d=0,f=2*Math.PI/i;for(let v=0;v<i;v++){let g=f*v,m=u+Math.sin(g)*c,y=d+Math.cos(g)*h;l.addPoint(l.createPoint(m,y))}l.isClosed=!0;for(let v=0,g=l.points.length;v<g;v++)l.points[v].roundness=r;l.roundness=r,l.update();let p=Qf.create({shape:l,parameters:{roundness:r,depth:s,extrudeBevelSize:o,extrudeBevelSegments:a}});return Object.assign(p,{userData:{...t,type:"PolygonGeometry"}})}},u3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,radialSegments:r,heightSegments:s,openEnded:o,cornerRadius:a,cornerSegments:l}=t.parameters,c=new d3e(e*.5,n,r,s,o,a,l);return c.scale(1,1,i/e),Object.assign(c,{userData:{...t,type:"PyramidGeometry"}})}};function R0(t,e,n){n.x=t.x*e.x,n.y=t.y,n.z=t.x*e.y}function R2(t,e,n,i,r,s){let o=e.clone().sub(t),a=n.clone().sub(t),l=o.angleTo(a);if(o.normalize(),a.normalize(),i===r){let c=o.add(a).normalize();s.copy(t).addScaledVector(c,i/Math.sin(l/2))}else{let c=o.angleTo(a);s.copy(t),s.addScaledVector(o,r/Math.sin(c)),s.addScaledVector(a,i/Math.sin(c))}}function h3e(t,e,n){let i=t.clone().sub(e),r=n.clone().sub(e);return i.projectOnVector(r),i.add(e)}var d3e=class extends Lt{constructor(t=.5,e=1,n=4,i=1,r=!1,s=0,o=4){super(),n=Math.floor(Math.max(3,n)),i=Math.floor(i),o=Math.floor(o);let a=[],l=[],c=[],h=[],u=0,d=e/2,f=Math.PI/n,p=t*Math.cos(Math.PI/n),v=2*Math.PI/n,g=(n-2)*Math.PI/n,m=Math.PI-g,y=new N(0,-d,0),_=new N(0,d,0),S=new Se(t,-d),A=new Se(p,-d),b=new Se(0,_.y).sub(A),T=new Se(0,_.y).sub(S),M=new Se(b.y,-b.x).normalize(),E=new Se(T.y,-T.x).normalize(),P=t*Math.cos(Math.PI/n)*Math.tan((Math.PI-b.angle())/2)-1e-8;s=Math.min(s,P);let R;{let ee=new N(M.x,M.y,0),O=new N(Math.cos(v)*ee.x,ee.y,Math.sin(v)*ee.x);R=ee.angleTo(O)}let F=s/Math.tan((Math.PI-b.angle())/2),B=s/Math.tan((Math.PI-R)/2),k=new N;if(!r){l.push(y.x,y.y,y.z),c.push(0,-1,0),h.push(0,0);let ee=u++,O=[],W=S.clone(),H=F/Math.cos(Math.PI/n);W.x-=H;for(let Y=0;Y<n;Y++){let z=Y/n*Math.PI*2+f,X=new Se(Math.sin(z),Math.cos(z));R0(W,X,k),l.push(k.x,k.y,k.z),c.push(0,-1,0),h.push(0,0),O.push(u++)}for(let Y=0;Y<O.length;Y++)a.push(O[Y],ee,O[(Y+1)%O.length])}{let ee=new N,O=new N,W=new N,H=new N,Y=new N,z=new N;for(let X=0;X<n;X++){let q=X/n*Math.PI*2+f,re=(X+.5)/n*Math.PI*2+f,G=(X+1)/n*Math.PI*2+f,K=new Se(Math.sin(q),Math.cos(q)),oe=new Se(Math.sin(re),Math.cos(re)),ve=new Se(Math.sin(G),Math.cos(G));R0(S,K,O),R0(S,ve,W),R0(M,oe,ee),R2(_,O,W,B,B,H),l.push(H.x,H.y,H.z),R2(O,_,W,B,F,Y),l.push(Y.x,Y.y,Y.z),R2(W,O,_,F,B,z),l.push(z.x,z.y,z.z),c.push(ee.x,ee.y,ee.z),c.push(ee.x,ee.y,ee.z),c.push(ee.x,ee.y,ee.z),h.push(0,0),h.push(0,0),h.push(0,0);let $=u++,se=u++,ne=u++;if(a.push($,se,ne),s>0){{let xe=O.clone().add(W).multiplyScalar(.5),Ae=_.clone().sub(xe).normalize(),we=y.clone().sub(xe).normalize().add(Ae).normalize().multiplyScalar(-1),Ee=z.clone().sub(Y);j(xe,Ee,we,b.angle())}let ie,me;{let xe=new N;R0(E,ve,xe);let Ae=z.clone().add(H).multiplyScalar(.5);Ae=h3e(Ae,W,_);let we=z.clone().sub(H);[ie,me]=j(Ae,we,xe,R,H.y)}{let xe=ie,Ae=xe.clone().setY(0).normalize(),we=new N(0,-1,0),Ee=Ae.clone().cross(we);Z(xe,Ae,we,Ee)}{let xe=b.angle(),Ae=Math.PI-xe,we=_.clone();we.y-=s/Math.sin(xe-Math.PI/2);let Ee=new N,Re=[];for(let Ne=0;Ne<o;Ne++){let U=[],L=Math.PI/2-Ae*Ne/o,te=Math.cos(L),_e=Math.sin(L),Te=re;for(let Ie=0;Ie<=Ne;Ie++){let Qe=Math.cos(Te),Ge=Math.sin(Te);ee.x=te*Ge,ee.y=_e,ee.z=te*Qe,Ee.copy(we).addScaledVector(ee,s),l.push(Ee.x,Ee.y,Ee.z),c.push(ee.x,ee.y,ee.z),h.push(0,0),U.push(u++),Te+=Math.PI*2/Ne/n}Re.push(U)}me.reverse(),Re.push(me);let Ue=Re.length-1;for(let Ne=0;Ne<Ue;Ne++){let U=Re[Ne],L=Re[Ne+1],te=U.length-1;a.push(L[1],U[0],L[0]);for(let _e=1;_e<=te;_e++)a.push(U[_e],U[_e-1],L[_e]),a.push(L[_e+1],U[_e],L[_e])}}}}}this.setIndex(a),this.setAttribute("position",new ft(l,3)),this.setAttribute("normal",new ft(c,3)),this.setAttribute("uv",new ft(h,2));function j(ee,O,W,H,Y){let z=-H/2,X=(Math.PI-H)/2,q=O.clone().normalize().cross(W);ee.addScaledVector(W,-s/Math.sin(X));let re=new N,G=new N,K=1,oe=u,ve=[];for(let $=0;$<=o;$++){let se=z+$/o*H;G.set(0,0,0),G.addScaledVector(q,Math.sin(se)),G.addScaledVector(W,Math.cos(se));for(let ne=0;ne<=K;ne++){let ie=ne/K-.5;if(re.copy(ee),re.addScaledVector(O,ie),re.addScaledVector(G,s),Y!=null){let me=Math.max(0,re.y-Y);re.addScaledVector(O,-me/O.y)}l.push(re.x,re.y,re.z),c.push(G.x,G.y,G.z),h.push(0,0),ne===0&&ve.push(u),u++}}for(let $=0;$<o;$++)for(let se=0;se<K;se++){let ne=oe+se+(K+1)*$,ie=ne+(K+1),me=ie+1,xe=ne+1;a.push(ne,ie,xe),a.push(ie,me,xe)}return[ee.clone().addScaledVector(O,.5),ve]}function Z(ee,O,W,H){let Y=Math.PI/2,z=T.angle()-Y,X=[],q=new N,re=new N;for(let K=0;K<=o;K++){let oe=[],ve=K/o;for(let $=0;$<=K;$++){let se=((K?$/K:0)-.5)*m,ne=Math.cos(se),ie=Math.sin(se),me=Math.atan(Math.tan(z)*ne),xe=(Y+me)*ve,Ae=Math.cos(xe),we=Math.sin(xe);q.set(0,0,0),q.addScaledVector(O,we*ne),q.addScaledVector(W,Ae),q.addScaledVector(H,we*ie),re.copy(ee).addScaledVector(q,s),l.push(re.x,re.y,re.z),c.push(q.x,q.y,q.z),h.push(0,0),oe.push(u++)}X.push(oe)}let G=X.length-1;for(let K=0;K<G;K++){let oe=X[K],ve=X[K+1],$=oe.length-1;a.push(oe[0],ve[1],ve[0]);for(let se=1;se<=$;se++)a.push(oe[se-1],oe[se],ve[se]),a.push(oe[se],ve[se+1],ve[se])}}}},BJ=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters),i=Object.assign((e==null?void 0:e.ui)??{enabledIndieCorners:!1},t.ui);return{shape:t.shape&&t.shape instanceof _i?t.shape:new _i,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)}),ui:i}}static build(t){let e=t.shape,{width:n,height:i,cornerRadius:r,cornerType:s,depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}=t.parameters,c={x:n*.5,y:i*.5},h={x:-c.x,y:-c.y},u={x:c.x,y:c.y};function d(S,A,b){return A>n&&b>i?Math.min(S*n/A,S*i/b):A>n?S*n/A:b>i?S*i/b:S}let f=[];f[0]=r[0]===0?0:d(r[0],r[0]+r[3],r[0]+r[1]),f[1]=r[1]===0?0:d(r[1],r[1]+r[2],r[1]+r[0]),f[2]=r[2]===0?0:d(r[2],r[2]+r[1],r[2]+r[3]),f[3]=r[3]===0?0:d(r[3],r[3]+r[0],r[3]+r[2]);let p=h.x,v=u.x,g=u.y,m=h.y;e.addPoint(e.createPoint(p,g)),e.addPoint(e.createPoint(v,g)),e.addPoint(e.createPoint(v,m)),e.addPoint(e.createPoint(p,m)),e.isClosed=!0;let y=!0;for(let S=0,A=e.points.length;S<A;S++)e.points[S].roundness=f[S],S>0&&f[S]!==f[S-1]&&(y=!1);y&&(e.roundness=f[0]),e.useCubicForRoundedCorners=s!==1,e.update();let _=Qf.create({shape:e,parameters:{depth:o,extrudeBevelSize:a,extrudeBevelSegments:l}});return Object.assign(_,{userData:{...t,type:"RectangleGeometry"}})}},f3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e=100,height:n=e,depth:i=e,widthSegments:r=64,heightSegments:s=64,phiStart:o,phiLength:a,thetaStart:l,thetaLength:c}=t.parameters,h=new EO(.5*e,r,s,o,a,l,c);return h.scale(1,n/e,i/e),Object.assign(h,{userData:{...t,type:"SphereGeometry"}})}},p3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:0})}}static build(t){let{width:e=100,height:n=e,widthSegments:i=8,heightSegments:r=8}=t.parameters,s=new lE(e,n,i,r);return s.scale(1,1,1),Object.assign(s,{userData:{...t,type:"PlaneGeometry"}})}},m3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width)})}}static build(t){let{width:e,height:n,depth:i,angle:r,cornerRadius:s,cornerSegments:o}=t.parameters,a=new g3e(e,n,i,r,s,o);return Object.assign(a,{userData:{...t,type:"BackdropGeometry"}})}},g3e=class extends Lt{constructor(t=1,e=1,n=1,i=90,r=10,s=24){super(),this.type="BackdropGeometry";let o=[],a=[],l=[],c=.001;r==0&&(s=1),s=Math.max(1,Math.floor(s)),r=Math.min(r,100),i=Math.min(180-c,i),i*=Math.PI/180;let h=[],u=Math.PI/2,d=(K=0,oe=0,ve=0)=>new N(K,oe,ve),f=d(),p=d(),[v,g,m]=[e/2,t/2,n/2],y=-g,_=+g,[S,A,b]=[d(y,-v,+m),d(y,-v,-m),d(y,+v,-m)],T=(K,oe=!1)=>Math.sin(K-Math.PI/(1+ +oe)),M=(K,oe=!1)=>Math.cos(K-Math.PI/(1+ +oe));b.y=Math.sin(i)*e-v;let E=Math.cos(i)*e-m,P=S.z-c;i<=u?(b.z=Math.min(E,P),b.z==P&&(b.y-=(E-P)/Math.tan(u-i))):A.z=Math.min(A.z-E-m,S.z-c),f.subVectors(S,A),p.subVectors(b,A);let R=Math.min(f.length(),p.length())*r/100,F=R*Math.tan(i/2),B=R/Math.cos(i/2),k=f.clone().normalize().add(p.normalize()).setLength(B).add(A);f.set(0,T(i,!0),M(i,!0)),h.push([b,f.clone()]);let j=(Math.PI-i)/s;for(let K=0;K<=s;K++){let oe=u+i+K*j;f.set(0,Math.sin(oe)*F,Math.cos(oe)*F),f.add(k),p.set(0,T(oe),M(oe)),h.push([f.clone(),p.clone()])}h.push([S,d(0,1,0)]);let Z=Math.sin(j/2)*F*2,ee=h.length-1,O=h[0][0].distanceTo(h[1][0]),W=h[ee-1][0].distanceTo(h[ee][0]),H=O+Z*s+W;h[0].push(1);for(let K=0;K<=s;K++)h[K+1].push(1-(O+K*Z)/H);h[ee].push(0);let[Y,z,X]=h[0],q,re,G;for(let K=1;K<h.length;K++)[q,re,G]=h[K],o.push(y,Y.y,Y.z,y,q.y,q.z,_,Y.y,Y.z,_,Y.y,Y.z,y,q.y,q.z,_,q.y,q.z),a.push(0,z.y,z.z,0,re.y,re.z,0,z.y,z.z,0,z.y,z.z,0,re.y,re.z,0,re.y,re.z),l.push(0,X,0,G,1,X,1,X,0,G,1,G),[Y,z,X]=[q,re,G];this.setAttribute("position",new ft(o,3)),this.setAttribute("normal",new ft(a,3)),this.setAttribute("uv",new ft(l,2))}},OJ=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},t.parameters);return{shape:t.shape&&t.shape instanceof _i?t.shape:new _i,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e,height:n,innerRadiusPercent:i,spikes:r,cornerRadius:s,angle:o,depth:a,extrudeBevelSize:l,extrudeBevelSegments:c}=t.parameters,h=t.shape,u=e*.5,d=n*.5,f=0,p=0,v=o*Math.PI/360/r,g=Math.PI/2*3*-1,m=u*i/100,y=d*i/100;if(r===3&&i===50){v=2*Math.PI/r;for(let S=0;S<r;S++){let A=v*S,b=f+Math.sin(A)*u,T=p+Math.cos(A)*d;h.addPoint(h.createPoint(b,T))}}else for(let S=0;S<r;S++){let A=f+Math.cos(g)*u,b=p+Math.sin(g)*d;h.addPoint(h.createPoint(A,b)),g+=v,A=f+Math.cos(g)*m,b=p+Math.sin(g)*y,h.addPoint(h.createPoint(A,b)),g+=v}h.isClosed=!0;for(let S=0,A=h.points.length;S<A;S++)h.points[S].roundness=s;h.roundness=s,h.update();let _=Qf.create({shape:h,parameters:{roundness:s,depth:a,extrudeBevelSize:l,extrudeBevelSegments:c}});return Object.assign(_,{userData:{...t,type:"StarGeometry"}})}},v3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e,height:n}=t.parameters,i=new lE(e,n);return Object.assign(i,{userData:{...t,type:"TextFrameGeometry"}})}},y3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:Math.PI*2,cornerRadius:30,cornerSegments:8},t.parameters),i=Math.abs(n.width),r=Math.abs(n.height??n.width),s=Math.round(Math.abs(n.depth??n.width*.25));return{parameters:Object.assign(n,{width:i,height:r,depth:s})}}static build(t){let{width:e,height:n,depth:i,radialSegments:r,tubularSegments:s,arc:o,cornerRadius:a,cornerSegments:l}=t.parameters,c=x3e(e,n,i,e*.5,o,s,0,0,r,a,l);return c.scale(1,n/e,1),Object.assign(c,{userData:{...t,type:"TorusGeometry"}})}};function x3e(t,e,n,i,r,s,o,a,l,c,h){return[e,n]=[n,e],o=e/2,r/=2*Math.PI,r==1&&(c=0),new dF(!0,t,e,n,i,r,s,o,a,l,c,h)}var _3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},t.parameters);return{parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width),depth:Math.abs(n.depth??n.width),tube:n.tube??n.width*.125})}}static build(t){let{width:e,tube:n,tubularSegments:i,radialSegments:r,p:s,q:o}=t.parameters,a=e*.5;a!==n&&(a-=n);let l=new VQ(a,n,i,r,s,o);return Object.assign(l,{userData:{...t,type:"TorusKnotGeometry"}})}},w3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},t.parameters);return{shape:t.shape&&t.shape instanceof _i?t.shape:new _i,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(n.height??n.width*(n.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(n.depth??0)})}}static build(t){let{width:e=100,height:n,cornerRadius:i,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o,isRect:a}=t.parameters,l=t.shape,c=e*.5,h=n*.5;a?(l.addPoint(l.createPoint(-c,h)),l.addPoint(l.createPoint(c,-h)),l.addPoint(l.createPoint(-c,-h))):(l.addPoint(l.createPoint(0,h)),l.addPoint(l.createPoint(c,-h)),l.addPoint(l.createPoint(-c,-h))),l.isClosed=!0;for(let d=0,f=l.points.length;d<f;d++)l.points[d].roundness=i;l.roundness=i,l.update();let u=Qf.create({shape:l,parameters:{roundness:i,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o}});return Object.assign(u,{userData:{...t,type:"TriangleGeometry"}})}};function S3e(t,e){let n=2*Math.PI;return(t%n+n)%n===(e%n+n)%n}function b3e(t,e,n){let i=[new N,new N,new N],r=[new N,new N,new N];return t.extractBasis(i[0],i[1],i[2]),e.extractBasis(r[0],r[1],r[2]),i.forEach((s,o)=>{let a=r[o],l=sn.lerp(s.length(),a.length(),n);s.lerp(a,n).setLength(l)}),new nt().makeBasis(i[0],i[1],i[2])}var A3e=class{static create(t){return this.build(this.normalizeInputs(t))}static normalizeInputs(t,e){let n=Object.assign({},(e==null?void 0:e.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},t.parameters),i=Math.abs(n.width),r=Math.abs(n.height??n.width),s=Math.abs(n.depth??0),o=(e==null?void 0:e.shapeData)??hF.create({parameters:iJ}).userData.shape;return{path:t.path??jA.defaultData(),parameters:Object.assign(n,{width:i,height:r,depth:s,extrusion:{...rJ,...n.extrusion}}),shapeData:o}}static build(t){if(t.path.points.length>=2){let e=new M3e(t);return Object.assign(e,{userData:{...t,type:"PathGeometry"}})}else return Object.assign(new Lt,{userData:{...t,type:"PathGeometry"}})}},M3e=class extends Lt{constructor(t){super(),this.type="PathExtrusionGeometry",this.inputs=t,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let t=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&t.depth===1)||!S3e(t.twist,0)||t.startScale!==t.endScale}build(){let t=this._extractPathPoints();if(t.length<2)return;let e=this._computeBasisMatrices(t),{depth:n,offset:i}=this.inputs.parameters.extrusion,r=this.inputs.path.isClosed?t.length:t.length-1,s=Math.floor(i*r),o=this.inputs.path.isClosed?Math.ceil((n+i)*r):Math.ceil(Math.min(1,n+i)*r),a=Math.min(Math.max(2,o-s+1),r+2),l=[],c=[];for(let P=0;P<a;P++){let R=this.inputs.path.isClosed?(P+s)%t.length:Math.min(P+s,t.length-1);l.push(t[R].clone()),c.push(e[R].clone())}let h=(P,R,F)=>{l[P]=l[P].clone().lerp(l[R],F),c[P]=b3e(c[P],c[R],F)},u=0,d=i*r%1;(!this.inputs.path.isClosed||n<=1)&&(d||i===0)&&(u=d,h(0,1,u));let f=0,p=(i+n)*r%1;if((this.inputs.path.isClosed&&n<=1||!this.inputs.path.isClosed&&i+n<1)&&p&&(f=p,h(l.length-1,l.length-2,1-f)),n===0){let P=l.length-1;l[P].copy(l[0]),c[P].copy(c[0])}this._applyPathModifiers(c,u,f);let{regions:v,infos:g,vertices:m}=this._computeShapePoints(5),y=0,_=0;g.sort((P,R)=>P.start-R.start),g.forEach(P=>{P.verticesStart=y,P.verticesCount=P.continuous.reduce((R,F,B)=>R+(B===0||!F?2:1),0),_+=P.verticesCount,y=_});let S=_*a,A,b=0;if(this._isOpenEnded()){try{A=ph({windingRule:Rn.ODD,elementType:zi.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:v})}catch{A=AJ}b=A.vertexCount}let T=S+2*b,M={positions:new Float32Array(T*3),normals:new Float32Array(T*3),uvs:new Float32Array(T*2)},E=[];g.forEach(P=>{this._extrudeRegion(P,m,c,l,M,E,this._isGeometryClosed()&&!this._isOpenEnded())}),A&&(this._closeEnd(A,S,E,M,c[0],l[0],!1),this._closeEnd(A,S+b,E,M,c[c.length-1],l[l.length-1],!0)),this.setAttribute("position",new Ut(M.positions,3)),this.setAttribute("normal",new Ut(M.normals,3)),this.setAttribute("uv",new Ut(M.uvs,2)),this.setIndex(E)}_extractPathPoints(){let t=mJ(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(t.length<2)return[];let e=[t[0]];return t.forEach(n=>{e[e.length-1].distanceToSquared(n)>.001&&e.push(n)}),this.inputs.path.isClosed&&e[e.length-1].distanceTo(e[0])<.001&&e.pop(),e}_computeBasisMatrices(t){let e=[],n=t.length,i=this.inputs.path.isClosed,r=new N,s=new N,o=new N,a=new N,l=new N(0,1,0);for(let p=0;p<n;p++){let v=t[p],g;p===0?g=i?t[t.length-2]:v.clone().multiplyScalar(2).sub(t[1]):g=t[p-1];let m;p===n-1?m=i?t[1]:v.clone().multiplyScalar(2).sub(t[p-1]):m=t[p+1];let y=v.clone().sub(g).normalize(),_=m.clone().sub(v).normalize(),S=y.clone().add(_).normalize();o.copy(S),p===0&&(S.equals(l)||S.clone().negate().equals(l))&&l.set(0,0,1);let A=l.clone().cross(S).normalize(),b=S.clone().cross(A).normalize();l.copy(b),a.copy(A),p===0&&(r.copy(b),s.copy(S));let T=new nt().makeBasis(A,b,S);e.push(T)}let c=i?s:o,h=i?r:new N(0,1,0),u=c.clone().cross(a).normalize(),d=Math.acos(h.dot(u));if(isNaN(d))return e;let f=h.clone().cross(u);c.dot(f)>0&&(d*=-1);for(let p=1;p<e.length;p++){let v=new nt().makeRotationZ(d*p/e.length);e[p].multiply(v)}return e}_applyPathModifiers(t,e,n){let i=t.length,{angle:r,twist:s,startScale:o,endScale:a}=this.inputs.parameters.extrusion,l=new nt,c=new nt;return t.forEach((h,u)=>{let d=u===0?0:u===i-1?1:(u-e)/(i-(n===0?0:1)-(e+(1-n)));l.makeRotationZ(sn.lerp(r,r+s,d));let f=sn.lerp(o,a,d);c.makeScale(f,f,f),h.multiply(l).multiply(c)}),t}_computeShapePoints(t=12,e=Rn.ODD){let n=this.inputs.shapeData,i=n.extractShapePointsToFlatArray([],t),r=n.shapeHoles.map(c=>{let h=c.extractShapePointsToFlatArray([],t),u=[];for(let d=h.length-1;d>=1;d-=2){let f=h[d-1],p=h[d-0];u.push(f,p)}return u}),s;try{s=ph({windingRule:e,elementType:zi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[i]})}catch{s=uF}let o;try{o=ph({windingRule:Rn.ODD,elementType:zi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...r]})}catch{o=bJ}if(!s)throw new Error("error generating geometry");let a=s.elementCount;if(o){s.elementCount+=o.elementCount;for(let c=0;c<o.elements.length;c++){let h=o.elements[c],u=c%2===0?s.vertexCount:0;s.elements.push(h+u)}for(let c=0;c<o.vertexIndices.length;c++){let h=o.vertexIndices[c],u=s.vertexCount;s.vertexIndices.push(h+u)}for(let c=0;c<o.vertices.length;c++){let h=o.vertices[c];s.vertices.push(h)}}for(let c=0,h=s.vertexCount;c<h;c++){let u=c*2;s.vertices[u+0],s.vertices[u+1]}let l=[];for(let c=s.elementCount-1;c>=0;c--){let h=c>=a,u=c*2,d=s.elements[u+0],f=s.elements[u+1],p=d+f,v={start:d,count:f,normals:[],isHole:h,continuous:[],verticesStart:0,verticesCount:0};l.push(v);let g=d,m=p-1,y=d+1,_=n.roundedCurves.length;do{let S=g-d;s.vertices[m*2+0],s.vertices[m*2+1];let A=s.vertices[g*2+0],b=s.vertices[g*2+1],T=s.vertices[y*2+0],M=s.vertices[y*2+1],E=A-T,P=b-M,R=Math.sqrt(E*E+P*P);E/=R,P/=R,v.normals[S*2+0]=-P,v.normals[S*2+1]=E;let F=s.vertexIndices[g];if(Array.isArray(F))v.continuous[S]=!1;else{let[B,k]=n.getCurveIndexFromVertexId(F-1,!0);if(k>0&&k<1)v.continuous[S]=!0;else{let j=k===1?B+1:B-1;j=(j+_)%_;let Z=k===1?0:1,ee=n.roundedCurves[B].getTangent(k),O=n.roundedCurves[j].getTangent(Z);v.continuous[S]=ee.dot(O)>.95}}h&&(v.normals[S*2+0]*=-1,v.normals[S*2+1]*=-1),[m,g,y]=[g,y,y+1],y>=p&&(y-=f)}while(y!==d+1)}return{regions:[i,...r],infos:l,vertices:s.vertices}}_insertVertex(t,e,n,i,r){let s=e*2,o=e*3;t.positions[o+0]=n.x,t.positions[o+1]=n.y,t.positions[o+2]=n.z,t.normals[o+0]=i.x,t.normals[o+1]=i.y,t.normals[o+2]=i.z,t.uvs[s+0]=r.x,t.uvs[s+1]=r.y}_extrudeRegion(t,e,n,i,r,s,o){let a=new N,l=new N,c=new N,h=new N,u=new Se;n.forEach((f,p)=>{let v=i[p],g=t.verticesStart*n.length+t.verticesCount*p;for(let m=0;m<t.count;m++){let y=(t.start+m)*2;if(a.set(e[y+0],e[y+1],0),c.copy(a).applyMatrix4(f).add(v),t.continuous[m])h.set(t.normals[m*2+0],t.normals[m*2+1],0);else{let _=m==0?(t.start+t.count-1)*2:y-2;l.set(e[_+0],e[_+1],0),h.copy(a).sub(l),h.set(-h.y,h.x,0),t.isHole||h.negate()}if(h.applyMatrix4(f).normalize(),u.set(m===0?1:m/t.count,p/(n.length-1)),this._insertVertex(r,g,c,h,u),g++,!t.continuous[m]||m===0){if(m===0)h.set(t.normals[m*2+0],t.normals[m*2+1],0),u.set(0,p/(n.length-1));else{let _=m===t.count-1?t.start*2:y+2;l.set(e[_+0],e[_+1],0),h.copy(l).sub(a),h.set(-h.y,h.x,0),t.isHole||h.negate()}h.applyMatrix4(f).normalize(),this._insertVertex(r,g,c,h,u),g++}}});let d=n.length-1;for(let f=0;f<d;f++){let p=t.verticesStart*n.length+t.verticesCount*f,v=t.verticesStart*n.length+t.verticesCount*(f+1),g=0;for(let m=0;m<t.count;m++){(!t.continuous[m]||m===0)&&g++;let y=m===t.count-1?0:g+1,_=p+g,S=p+y,A=v+y,b=v+g;t.isHole?s.push(_,A,S,_,b,A):s.push(_,S,A,_,A,b),g++}}}_closeEnd(t,e,n,i,r,s,o){let a=t.vertexCount,l=new N(0,0,o?-1:1).applyMatrix4(r),c=new N,h=new Se;for(let d=0;d<a;d++){let f=2*d;c.set(t.vertices[f+0],t.vertices[f+1],0).applyMatrix4(r).add(s),this._insertVertex(i,e+d,c,l,h)}let u=t.elements;for(let d=0;d<t.elementCount;d++){let f=3*d,p=u[f+0]+e,v=u[f+(o?1:2)]+e,g=u[f+(o?2:1)]+e;n.push(p,v,g)}}};function FJ(){let t=new Lt;return t.setAttribute("position",new Ut(new Float32Array([]),3)),t.setIndex(new Ut(new Uint16Array([]),1)),t}var E3e=FJ().attributes,C3e=12,T3e=1,NJ=class extends Lt{constructor(t,e){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,E3e),this.userData={parameters:t,type:"TextGeometry"};let n=e.getFont(t.font);n!=null&&n.isLoaded?(this.font=n,this.update(t)):this.updateFont(t.font,e).then(()=>{this.update(t),e==null||e.requestRender()})}async updateFont(t,e){let n=e.getFont(t);n&&(this.font=n,await n.loadingPromise)}update(t){let e=this.font;if(this.userData={parameters:t,type:"TextGeometry"},!(e!=null&&e.isLoaded)){console.warn("Cannot update text because its font is not loaded");return}let{width:n,height:i,depth:r,extrudeBevelSize:s,extrudeBevelSegments:o,text:a,textTransform:l}=t,c=l===2?a.toUpperCase():l===3?a.toLowerCase():a,h=P3e(t,e,c),{shapes:u,charWidths:d,charCoords:f}=e.generateShapes(h,t),p=n*.5,v=i*.5,g=u.map(_=>new _i().fromShape(_));this.vectorShapes=g;let m=g.map(_=>Qf.create({shape:_,parameters:{depth:r,extrudeBevelSegments:o,extrudeBevelSize:s,windingRule:r<=0?Rn.NONZERO:Rn.ODD,subdivisions:this.isLowResolution&&r>0?T3e:C3e}})),y=m.length?Hm(m):FJ();y.translate(-p,v,0),this.dispose(),this.wrappedText=h,this.charCoords=f,this.charWidths=d,this.deleteAttribute("extrudeNormal"),Object.entries(y.attributes).forEach(([_,S])=>{this.setAttribute(_,S)}),this.setIndex(y.index),this.computeBoundingSphere()}clone(){let t=Ff(new Lt,NJ.prototype);return t.copy(this),console.log("CloneGeometry",this,t),t}copy(t){return Object.entries(t.attributes).forEach(([e,n])=>{this.setAttribute(e,n)}),this.setIndex(t.index),this.userData={parameters:{...t.userData.parameters},type:"TextGeometry"},this}async setText(t){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:t})}get text(){return this.userData.parameters.text??""}};function P3e(t,e,n){n=n??t.text;let i=[""],r="";for(let s of n)r+=s,s===" "||s===`
`?(i[i.length-1]+=r,r="",s===`
`&&i.push("")):e.getTextWidth(i[i.length-1]+r,t)>t.width&&(i[i.length-1].length&&i.push(""),e.getTextWidth(i[i.length-1]+r,t)>t.width&&(r.length===1?(i[i.length-1]+=r,r=""):(i[i.length-1]+=r.slice(0,-1),r=r[r.length-1],i.push(""))));return i[i.length-1]+=r,i}var UJ,fF=new Promise(t=>{UJ=t}),Fj=!1;async function D3e(){if(Fj)return;let t="https://unpkg.com/@splinetool/modelling-wasm@0.9.314/build",[e,n]=await Promise.all([oE(()=>import("./process-10f79362.js"),[]),fetch(`${t}/process.wasm`).then(s=>s.arrayBuffer())]),i=e.default,r=await i({wasmBinary:n});UJ(r),Fj=!0}function rM(t,e,n){let i={parameters:t,type:t.type};if(t.type==="PathGeometry")i.path=t.path;else if(t.type==="VectorGeometry"){let s=_i.createFromState(t.shape,t.width,t.height);i.shape=s}else if(t.type==="NonParametricGeometry")t.data.groups&&t.data.groups.forEach(s=>s.materialIndex=Math.max(s.materialIndex??0,0)),i.geometry=new WQ().parse(t);else{if(t.type==="SubdivGeometry")return new hs(t,n);if(t.type==="TextGeometry")return new NJ(t,e)}let r;try{r=Hj(i)}catch(s){console.error(s)}if(!r){let s=_i.createFromState(VA.defaultData(),100,100);i.shape=s,r=Hj(i)}return r}var R3e=new nt;function SI(t,e,n,i){let r=t.position.array,s=t.normal.array,o=R3e.makeScale(e,n,i).invert().elements,a,l,c;for(var h=0,u=r.length;h<u;h+=3)r[h]*=e,r[h+1]*=n,r[h+2]*=i,a=s[h],l=s[h+1],c=s[h+2],s[h]=o[0]*a+o[4]*l+o[8]*c,s[h+1]=o[1]*a+o[5]*l+o[9]*c,s[h+2]=o[2]*a+o[6]*l+o[10]*c;t.position.needsUpdate=!0,t.normal.needsUpdate=!0}var OS=new Vi,em=new N,Ct;fF.then(t=>{Ct=t});var Nj=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),Uj=new Uint32Array([0,1,2,3]),kj=new Uint8Array([4]),hs=class extends Lt{constructor(t,e){super(),this.data=t,this.flatShading=e,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(t,e){this.freeSubdivPointer();let n=this.data.scaleBaked,i=yf.div(e,n);this.subdividedGeometry&&SI(this.subdividedGeometry.attributes,...i),this.originalGeometry&&SI(this.originalGeometry.attributes,...i),this.data=t;let r=this.userData.parameters;this.userData.parameters={width:r.width*i[0],height:r.height*i[1],depth:r.depth*i[2]},this.originalGeometry.boundingSphere.center.multiply(em.fromArray(i));let s=em.set(r.width,r.height,r.depth).length();this.originalGeometry.boundingSphere.radius=s/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let t,e,n;try{({originalGeometry:t,subdividedGeometry:e,subdivPointer:n}=hs.build(this.data,void 0,!this.flatShading,void 0))}catch{t=new Zl(100,100,100),n=0}this.subdivPointer=n,this.originalGeometry=t,this.subdividedGeometry=e??void 0;let i=this.subdividedGeometry??this.originalGeometry;Object.assign(this,i),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(hs.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let t=this.originalGeometry;t.boundingSphere===null&&(t.boundingSphere=new la,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=t.boundingSphere));let e=t.attributes.position,n=t.boundingSphere.center;OS.setFromBufferAttribute(e),OS.getCenter(n),t.boundingSphere.radius=n.distanceTo(OS.max),isNaN(t.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),OS.getSize(em);let i={width:em.x,height:em.y,depth:em.z};return this.userData.parameters=i,i}static build(t,e,n,i){let r,s,o,a=(t==null?void 0:t.phongAngle)??35;n===!1&&(a=-1),e&&(Ct.free_bvh(e),Ct.free_subdivision_surface(e));try{r=hs.allocate(t,i)}catch(l){console.error(l,t),r=hs.allocate({positionWASM:Nj,indexWASM:Uj,verticesPerFaceWASM:kj},i)}if(Ct.set_destination_refinement_level(r,0),s=hs.buildLevel(r,!0,a),t.subdivisions>0)try{Ct.set_destination_refinement_level(r,t.subdivisions),o=hs.buildLevel(r,!1,a)}catch{try{Ct.set_destination_refinement_level(r,t.subdivisions-1),o=hs.buildLevel(r,!1,a)}catch{o=null}}else o=null;return{subdivPointer:r,originalGeometry:s,subdividedGeometry:o}}static primitiveToQuads(t,e,n){t.widthSegments>16&&(t.widthSegments=16),t.heightSegments>16&&(t.heightSegments=16),t.depthSegments>16&&(t.depthSegments=16),t.radialSegments>16&&(t.radialSegments=16),t.type==="DodecahedronGeometry"&&(t.detail=0);let i;if(t.type==="TorusGeometry"&&t.arc===Math.PI*2){let{width:c,height:h,depth:u,arc:d,tubularSegments:f,radialSegments:p}=t;i=new dF(!0,c,u,h,c*.5,d/(2*Math.PI),f,u/2,0,p,0,0,!0)}else i=t.shape!==void 0?e.geometry:rM(t,n,!1);let r,s,o,a;({positions:r,triIndices:a}=pF(i.getAttribute("position"),i.getIndex()));let l;if(t.type==="CylinderGeometry"&&t.cornerRadius===0&&t.hollow===0&&t.openEnded===!1){let c=t.radialSegments*t.heightSegments*3*2,h=c+t.radialSegments*3;l=[c,h]}return{indices:s,verticesPerFace:o}=kJ(r,a,i,l),{positions:r,indices:s,verticesPerFace:o}}static allocate(t,e){var _;let n,i,r,s=[],o=[];t.positionWASM&&t.positionWASM.length>0?(n=t.positionWASM,i=t.indexWASM,r=t.verticesPerFaceWASM):(n=Nj,i=Uj,r=kj);let a=n.length,l=i.length,c=r.length,h=n.length+s.length+o.length,u=i.length+r.length,d=h*Float32Array.BYTES_PER_ELEMENT+u*Uint32Array.BYTES_PER_ELEMENT,f=h*Float32Array.BYTES_PER_ELEMENT,p=Ct._malloc(d),v=new Float32Array(Ct.HEAPF32.buffer,p,h),g=new Uint32Array(Ct.HEAPU32.buffer,p+f,u);v.set(n,0),v.set(s,n.length),v.set(o,n.length+s.length),g.set(i,0),g.set(r,i.length);let m;(_=t==null?void 0:t.scaleBaked)!=null&&_.some(S=>S!==1)&&(m=new nt().makeScale(...t.scaleBaked)),e&&(m?m.premultiply(e):m=e);let y=m?Ct.alloc_subdivision_surface2(p,a,p+f,l,p+f+i.length*Uint32Array.BYTES_PER_ELEMENT,c,m.elements):Ct.alloc_subdivision_surface(p,a,p+f,l,p+f+i.length*Uint32Array.BYTES_PER_ELEMENT,c);return Ct._free(p),y}static buildLevel(t,e,n,i,r){let s=r?Ct.get_mesh_data2(t,e?Ct.Level.CONTROL:Ct.Level.REFINED,n,r.elements):Ct.get_mesh_data(t,e?Ct.Level.CONTROL:Ct.Level.REFINED,n),o=8,a=Ct.HEAPU32.subarray(s>>2,(s>>2)+o),l=a.subarray(4,4+4),c=0,h=Ct.HEAPU32[a[c]>>2],u=Ct.HEAPF32.subarray(h>>2,(h>>2)+l[c]);c++;let d=Ct.HEAPU32[a[c]>>2],f=Ct.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let p=Ct.HEAPU32[a[c]>>2],v=Ct.HEAPU32.subarray(p>>2,(p>>2)+l[c]);c++;let g=Ct.HEAPU32[a[c]>>2],m=Ct.HEAPU32.subarray(g>>2,(g>>2)+l[c]);if(c++,i===void 0){let y=new Lt;if(y.setIndex(new Ey(m,1)),y.setAttribute("position",new ft(u,3)),y.setAttribute("normal",new ft(f,3)),e){y.setAttribute("faceMap",new Ey(v,1));let _=new Float32Array(f.length/3*4).fill(0);y.setAttribute("color",new Ut(_,4))}return Ct.free_mesh_data(s),y.userData.type="SubdivGeometry",y}i.getAttribute("position").copyArray(u),i.getAttribute("normal").copyArray(f),i.attributes.position.needsUpdate=!0,i.attributes.normal.needsUpdate=!0,Ct.free_mesh_data(s)}static freeSubdivPointer(t){Ct.free_bvh(t),Ct.free_subdivision_surface(t)}static buildControlCageWireframe(t,e,n){let i=Ct.get_wireframe_data_for_base_level(t),r=4,s=Ct.HEAPU32.subarray(i>>2,(i>>2)+r),o=s.subarray(2,2+2),a=0,l=Ct.HEAPU32[s[a]>>2],c=Ct.HEAPF32.subarray(l>>2,(l>>2)+o[a]);a++;let h=Ct.HEAPU32[s[a]>>2],u=Ct.HEAPU32.subarray(h>>2,(h>>2)+o[a]);if(e===void 0){let d=new Lt;d.setAttribute("position",new ft(c,3));let f=new Float32Array(c.length);for(let p=0,v=c.length;p<v;)f[p++]=n.r,f[p++]=n.g,f[p++]=n.b;return d.setAttribute("color",new Ut(f,3)),d.setIndex(new Ey(u,1)),Ct.free_wireframe_data_for_base_level(i),d}e.getAttribute("position").copyArray(c),e.attributes.position.needsUpdate=!0,Ct.free_wireframe_data_for_base_level(i)}static updateCollabMesh(t,e,n){let i=e===0;i||Ct.set_destination_refinement_level(t,e);let r=n?Ct.get_topological_data2(t,i?Ct.Level.CONTROL:Ct.Level.REFINED,n.elements):Ct.get_topological_data(t,i?Ct.Level.CONTROL:Ct.Level.REFINED),s=6,o=Ct.HEAPU32.subarray(r>>2,(r>>2)+s),a=o.subarray(3,3+3),l=0,c=Ct.HEAPU32[o[l]>>2],h=new Float32Array(Ct.HEAPF32.subarray(c>>2,(c>>2)+a[l]));l++;let u=Ct.HEAPU32[o[l]>>2],d=new Uint32Array(Ct.HEAPU32.subarray(u>>2,(u>>2)+a[l]));l++;let f=Ct.HEAPU32[o[l]>>2],p=new Uint8Array(Ct.HEAPU32.subarray(f>>2,(f>>2)+a[l]));return Ct.free_topological_data(r),{positions:h,indices:d,verticesPerFace:p}}},zj=["getX","getY","getZ"];function pF(t,e){let n={},i=e?e.count:t.count,r=0,s=[],o=[],a=1e4;for(let c=0;c<i;c++){let h=e?e.getX(c):c,u="";for(let d=0;d<3;d++)u+=`${~~(t[zj[d]](h)*a)},`;if(u in n)s.push(n[u]);else{for(let d=0;d<3;d++)o.push(t[zj[d]](h));n[u]=r,s.push(r),r++}}let l=[];for(let c=0;c<s.length;c+=3)s[c]===s[c+1]||s[c]===s[c+2]||s[c+1]===s[c+2]||l.push(s[c],s[c+1],s[c+2]);return{positions:o,triIndices:l}}var FS=new N,L2=new N,I2=new N,B2=new N;function kJ(t,e,n,i){let r=[],s=[];if(n.userData.shape!==void 0&&n.userData.parameters.depth===0&&n.userData.shape.shapeHoles.length===0){let o=n.userData.shape.extractShapePointsToFlatArray([]),a=n.userData.parameters.spikes;if(n.userData.type==="EllipseGeometry"&&a<=24&&a%4===0&&n.userData.parameters.angle>=360){let h=o.length/2/a;o=o.filter((u,d)=>Math.floor(d/2)%h===0)}let l=0;for(let h=0;h<o.length;h+=2)l+=(o[h]-o[(h===0?o.length:h)-2])*(o[h+1]+o[(h===0?o.length:h)-1]);t.length=0;let c=0;if(l<0)for(let h=0;h<o.length;h+=2)t.push(o[h],o[h+1],0),r.push(c++);else for(let h=o.length-2;h>=0;h-=2)t.push(o[h],o[h+1],0),r.push(c++);return s.push(c),{indices:r,verticesPerFace:s}}for(let o=0,a=n.capStartIndex??e.length;o<a;)if(e[o+1]===e[o+3]&&e[o+2]===e[o+5]||e[o+0]===e[o+3]&&e[o+2]===e[o+4]){FS.set(t[e[o]*3],t[e[o]*3+1],t[e[o]*3+2]),L2.set(t[e[o+1]*3],t[e[o+1]*3+1],t[e[o+1]*3+2]),I2.set(t[e[o+4]*3],t[e[o+4]*3+1],t[e[o+4]*3+2]),B2.set(t[e[o+5]*3],t[e[o+5]*3+1],t[e[o+5]*3+2]),L2.sub(FS).normalize(),I2.sub(FS).normalize(),B2.sub(FS).normalize();let l=L2.cross(I2).dot(B2);Math.abs(l)>.005||i&&i.some((c,h)=>h%2===1?!1:o>=i[h]&&o<i[h+1])?(r.push(e[o],e[o+1],e[o+2]),s.push(3),o+=3):(r.push(e[o],e[o+1],e[o+4],e[o+5]),s.push(4),o+=6)}else r.push(e[o],e[o+1],e[o+2]),s.push(3),o+=3;if(n.capStartIndex!==void 0){let o=[],a=[],l=0,c=new Float32Array([n.userData.parameters.depth])[0];for(let h=0,u=0;h<t.length;h+=3,u++)t[h+2]===0&&(o.push(u),l++),t[h+2]===c&&a.push(u);if(n.userData.parameters.extrudeBevelSize===0){let h=a[0];a[0]=a[1],a[1]=h}o.reverse(),r.push(...o,...a),s.push(l,l)}return{indices:r,verticesPerFace:s}}var Ju={};eye(Ju,{calcBoolean:()=>F3e,calcBooleanTopological:()=>O3e,freeMeshSet:()=>k3e,getMeshSet:()=>N3e,transformMeshSet:()=>U3e});var zJ,L3e=new Promise(t=>{zJ=t}),Gj=!1;async function I3e(){if(Gj)return;let t="https://unpkg.com/@splinetool/boolean-wasm@0.9.314/build",[e,n]=await Promise.all([oE(()=>import("./boolean-63aef768.js"),[]),fetch(`${t}/boolean.wasm`).then(s=>s.arrayBuffer())]),i=e.default,r=await i({wasmBinary:n});zJ(r),Gj=!0}var an,pg;L3e.then(t=>an=t);function B3e(t,e,n){let i,{positions:r,triIndices:s}=pF(t.getAttribute("position"),t.getIndex()),o;if(e&&n){let{indices:a,verticesPerFace:l}=kJ(r,s,t);o=l.length,i=[];for(let c=0,h=0;c<o;c++){i.push(l[c]);for(let u=0;u<l[c];u++)i.push(a[h++])}}else{let a=s.length;i=Array(a+a/3),o=0;for(let l=0,c=0;c<i.length;)i[c++]=3,o++,i[c++]=s[l++],i[c++]=s[l++],i[c++]=s[l++]}return{positions:r,faceIndices:i,nFaces:o}}function GJ(t){let e=t.length,n=e*Uint32Array.BYTES_PER_ELEMENT,i=e*Float32Array.BYTES_PER_ELEMENT,r=Number.isInteger(t[0])?n:i,s=an._malloc(r);return(Number.isInteger(t[0])?new Uint32Array(an.HEAPU32.buffer,s,e):new Float32Array(an.HEAPF32.buffer,s,e)).set(t,0),s}function HJ(t){switch(t){case 0:return an.OP.UNION;case 1:return an.OP.INTERSECTION;case 2:return an.OP.A_MINUS_B;case 3:return an.OP.B_MINUS_A;case 4:return an.OP.SYMMETRIC_DIFFERENCE;case 5:return an.OP.ALL;default:throw new Error("Unknown boolean operation "+t)}}function O3e(t,e){pg===void 0&&(pg=an.init_csg());let n=GJ(t),i=an.csg_calc_topological(pg,n,t.length,HJ(e));an._free(n);let r=6,s=an.HEAPU32.subarray(i>>2,(i>>2)+r),o=s.subarray(3,3+3),a=0,l=an.HEAPU32[s[a]>>2],c=new Float32Array(an.HEAPF32.subarray(l>>2,(l>>2)+o[a]));a++;let h=an.HEAPU32[s[a]>>2],u=new Uint32Array(an.HEAPU32.subarray(h>>2,(h>>2)+o[a]));a++;let d=an.HEAPU32[s[a]>>2],f=new Uint8Array(an.HEAPU32.subarray(d>>2,(d>>2)+o[a]));return an.free_mesh_data(i),{positions:c,indices:u,verticesPerFace:f}}function F3e(t,e,n,i){pg===void 0&&(pg=an.init_csg());let r=GJ(t),s=an.csg_calc(pg,r,t.length,i,HJ(e));an._free(r);let o=5,a=an.HEAPU32.subarray(s>>2,(s>>2)+o),l=a.subarray(2,2+3),c=0,h=an.HEAPU32[a[c]>>2],u=an.HEAPF32.subarray(h>>2,(h>>2)+l[c]);c++;let d=an.HEAPU32[a[c]>>2],f=an.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let p=l[c];n.setAttribute("position",new ft(u,3)),n.setAttribute("normal",new ft(f,3));let v=an.HEAPF32.subarray((s>>2)+5,(s>>2)+5+6);return n.boundingSphere===null&&(n.boundingSphere=new la),n.boundingSphere.center.set(v[0],v[1],v[2]),n.boundingSphere.radius=(v[3]**2+v[4]**2+v[5]**2)**.5,n.userData.parameters={width:v[3]*2,height:v[4]*2,depth:v[5]*2},an.free_mesh_data(s),p}function N3e(t,e,n){if(an===void 0)return-1;let i,r,s;if(e&&t.userData.positions!==void 0){let v=t.userData;s=v.verticesPerFace.length,i=v.positions,r=Array(v.verticesPerFace.reduce((g,m)=>g+m,0)+s);for(let g=0,m=0,y=0;g<v.verticesPerFace.length;g++){r[y++]=v.verticesPerFace[g];for(let _=0;_<v.verticesPerFace[g];_++)r[y++]=v.indices[m++]}}else({positions:i,faceIndices:r,nFaces:s}=B3e(t,e,n));let o=i.length,a=r.length,l=i.length,c=r.length,h=l*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,u=l*Float32Array.BYTES_PER_ELEMENT,d=an._malloc(h),f=new Float32Array(an.HEAPF32.buffer,d,l),p=new Uint32Array(an.HEAPU32.buffer,d+u,c);return f.set(i,0),p.set(r,0),an.get_csg_mesh(d,o,d+u,a,s)}function U3e(t,e){an.transform_csg_mesh(t,e.elements)}function k3e(t){an.free_csg_mesh(t)}var z3e={ConeGeometry:_Ie,CubeGeometry:wIe,CylinderGeometry:xIe,DodecahedronGeometry:bIe,EllipseGeometry:hF,HelixGeometry:e3e,IcosahedronGeometry:t3e,LatheGeometry:n3e,NonParametricGeometry:c3e,PolygonGeometry:IJ,PyramidGeometry:u3e,RectangleGeometry:BJ,SphereGeometry:f3e,PlaneGeometry:p3e,BackdropGeometry:m3e,StarGeometry:OJ,TextFrameGeometry:v3e,TorusGeometry:y3e,TorusKnotGeometry:_3e,TriangleGeometry:w3e,PathGeometry:A3e,VectorGeometry:Qf},Hj=t=>z3e[t.type].create(t);function L0(t){return t!==null&&"booleanOp"in t}var VJ=class extends gJ(ao){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new nt}updateVisible(){super.updateVisible(),this.visible=!L0(this.parent)&&this.visible,L0(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(Ju.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(t=!1){return t?this.booleanWasTransformed=!0:this.freeBooleanPointer(),L0(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let t of this.children)t instanceof VJ&&(t.freeBooleanPointer(),L0(t)&&t.invalidateUpstreamBooleanData())}updateTransformState(t){let e=super.updateTransformState(t);return e&&L0(this.parent)&&this.invalidateDownstreamBooleanData(!0),e}},NS=new Vi;function mF(t,e=0,n=t.count,i,r){let s=1/0,o=1/0,a=1/0,l=-1/0,c=-1/0,h=-1/0;for(let u=e;u<n;u++){let d=t.getX(u),f=t.getY(u),p=t.getZ(u);d<s&&(s=d),f<o&&(o=f),p<a&&(a=p),d>l&&(l=d),f>c&&(c=f),p>h&&(h=p)}NS.min.set(s,o,a),NS.max.set(l,c,h),NS.getCenter(i),NS.getSize(r).multiplyScalar(.5)}var G3e=new Lt,H3e=new E1,zs=class extends VJ{constructor(t,e){super(G3e,H3e),this.super_Entity(t,e)}updateState(t,e){this.updateState_Entity(t,e)}updateEntityBoxSize(t,e){let n=this.geometry.getAttribute("position");n!==void 0?mF(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,t,e):super.updateEntityBoxSize(t,e)}},Vj=class{constructor(t){t=t??{},this.name=t.name,this.type=t.type,this.node=t.node,this.size=t.size,this.needsUpdate=t.needsUpdate}get value(){return this.node.value}set value(t){this.node.value=t}},ed=class{constructor(t){this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},this.uuid=sn.generateUUID(),this.type=t,this.name=""}analyze(t,e){e=e??{},t.analyzing=!0,this.build(t.addFlow(e.slot,e.cache,e.context),"v4"),t.clearVertexNodeCode(),t.clearFragmentNodeCode(),t.removeFlow(),t.analyzing=!1}analyzeAndFlow(t,e,n){return n=n??{},this.analyze(t,n),this.flow(t,e,n)}flow(t,e,n){n=n??{},t.addFlow(n.slot,n.cache,n.context);let i={result:this.build(t,e),code:t.clearNodeCode(),extra:t.context.extra};return t.removeFlow(),i}build(t,e,n){e=e??this.getType(t,e);let i=t.getNodeData(n??this);return t.analyzing&&this.appendDepsNode(t,i,e),t.nodes.indexOf(this)===-1&&t.nodes.push(this),this.updateFrame!==void 0&&t.updaters.indexOf(this)===-1&&t.updaters.push(this),this.generate(t,e,n)}updateFrame(t){}generateReadonly(t,e,n,i,r,s){return""}generate(t,e,n,i,r){return""}parse(t,e,n,i){}appendDepsNode(t,e,n){e.deps=(e.deps||0)+1;let i=t.getTypeLength(n);(i>(e.outputMax||0)||this.getType(t,n))&&(e.outputMax=i,e.output=n)}setName(t){this.name=t}getName(){return this.name}getType(t,e){return e==="sampler2D"||e==="samplerCube"?e:this.type}getHash(){let t="{",e,n;for(e in this)n=this[e],n instanceof ed&&(t+='"'+e+'":'+n.getHash()+",");if(this.hashProperties)for(let i=0;i<this.hashProperties.length;i++)e=this.hashProperties[i],n=this[e],t+='"'+e+'":"'+String(n)+'",';return t+='"id":"'+this.uuid+'"}',t}},V3e=class{constructor(){this.nodes={},this.keywords={}}add(t){this.nodes[t.name]=t}addKeyword(t,e,n){n=n!==void 0?n:!0,this.keywords[t]={callback:e,cache:n}}remove(t){delete this.nodes[t.name]}removeKeyword(t){delete this.keywords[t]}get(t){return this.nodes[t]}getKeyword(t,e){return this.keywords[t].callback(e)}getKeywordData(t){return this.keywords[t]}contains(t){return this.nodes[t]!==void 0}containsKeyword(t){return this.keywords[t]!==void 0}},Ps=new V3e,Gn=class extends ed{constructor(e,n){super(e),this.scope="",n=n??{},this.shared=n.shared!==void 0?n.shared:!0,this.unique=n.unique!==void 0?n.unique:!1}build(e,n,i,r){if(n=n??this.getType(e),this.getShared(e,n)){let s=this.getUnique(e,n);s&&this.uuid===void 0&&(this.uuid=sn.generateUUID()),i=e.getUUID(i??this.getUUID(),!s);let o=e.getNodeData(i),a=o.output||this.getType(e);if(e.analyzing)return(o.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,o,n),this.generate(e,n,i)):super.build(e,n,i);if(s)return o.name=o.name||super.build(e,n,i),o.name;if(!this.getLabel()&&(!this.getShared(e,a)||e.context.ignoreCache||o.deps===1))return super.build(e,n,i);i=this.getUUID(!1);let l=this.getTemp(e,i);if(l)return e.format(l,a,n);{l=super.generate(e,n,i,o.output,r);let c=this.generate(e,a,i);return e.addNodeCode(l+" = "+c+";"),e.format(l,a,n)}}return super.build(e,n,i)}getShared(e,n){return n!=="sampler2D"&&n!=="samplerCube"&&this.shared}getUnique(e,n){return this.unique}setLabel(e){return this.label=e,this}getLabel(){return this.label}getUUID(e){let n=this.uuid;return typeof this.scope=="string"&&(n=this.scope+"-"+n),n}getTemp(e,n){n=n||this.uuid;let i=e.getVars()[n];return i?i.name:void 0}generate(e,n,i,r,s){return this.getShared(e,n)||console.error("TempNode is not shared"),i=i??this.uuid,e.getTempVar(i,r??this.getType(e),s,this.getLabel()).name}},bo=class extends Gn{constructor(t,e){e=e??{},e.shared=e.shared!==void 0?e.shared:!1,super(t,e),this.readonly=!1}setReadonly(t){return this.readonly=t,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(t,e,n,i,r,s){n=t.getUUID(n??this.getUUID()),i=i??this.getType(t);let o=t.getNodeData(n);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(t,e,n,i,r,s):t.isShader("vertex")?(o.vertex||(o.vertex=t.createVertexUniform(i,this,r,s,this.getLabel())),t.format(o.vertex.name,i,e)):(o.fragment||(o.fragment=t.createFragmentUniform(i,this,r,s,this.getLabel())),t.format(o.fragment.name,i,e))}},qo=class extends bo{constructor(t=0,e){super("v2"),this.nodeType="Vector2",this.value=t instanceof Se?t:new Se(t,e)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}generateReadonly(t,e,n,i,r,s){return t.format("vec2("+this.value.x+", "+this.value.y+")",i,e)}},Vo=class extends bo{constructor(t=0,e,n){super("v3"),this.nodeType="Vector3",this.value=t instanceof N?t:new N(t,e,n)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}get z(){return this.value.z}set z(t){this.value.z=t}generateReadonly(t,e,n,i,r,s){return t.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",i,e)}},Ns=class extends Rt{constructor(t,e,n,i){super(t,e,n),this.isColorA=!0,this.a=i}setRGBA(t,e,n,i){super.setRGB(t,e,n),this.a=i}copy(t){return super.copy(t),this.a="a"in t?t.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}setStyle(t,e="srgb"){let n;if(t==="transparent")return this.setRGBA(0,0,0,0),this;if(n=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(t)){let i,r=n[1],s=n[2];switch(r){case"rgb":case"rgba":if(i=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=r==="rgba"?parseFloat(i[4]):1,super.setStyle(t,e);break;case"hsl":case"hsla":if(i=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=r==="hsla"?parseFloat(i[4]):1,super.setStyle(t,e);break}}return super.setStyle(t,e)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(t){this.r=t}set y(t){this.g=t}set z(t){this.b=t}set w(t){this.a=t}},Wd=class extends bo{constructor(t){super("v4"),this.nodeType="Vector4",this.value=t instanceof Ns?t:new Ns(t.r,t.g,t.b,t.a)}generateReadonly(t,e,n,i,r,s){return t.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",i,e)}},j3e=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,jj=/[a-z_0-9]+/gi,wt=class extends Gn{constructor(e,n,i,r,s){super(s),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=s===void 0,this.isInterface=!1,this.parse(e,n,i,r)}getShared(e,n){return!this.isMethod}getType(e){return e.getTypeByFormat(this.type)}getInputByName(e){if(this.inputs){let n=this.inputs.length;for(;n--;)if(this.inputs[n].name===e)return this.inputs[n]}}getIncludeByName(e){if(this.includes){let n=this.includes.length;for(;n--;)if(this.includes[n].name===e)return this.includes[n]}}generate(e,n,i,r,s){let o,a=0,l=this.src;if(this.includes)for(let h=0;h<this.includes.length;h++)e.include(this.includes[h],this);for(let h in this.extensions)e.extensions[h]=!0;let c=[];for(;o=jj.exec(this.src);)c.push(o);for(let h=0;h<c.length;h++){let u=c[h],d=u[0],f=this.isMethod?!this.getInputByName(d):!0,p=d;if(this.keywords[d]||this.useKeywords&&f&&Ps.containsKeyword(d)){let v=this.keywords[d];if(!v){let g=Ps.getKeywordData(d);g.cache&&(v=e.keywords[d]),v=v||Ps.getKeyword(d,e),g.cache&&(e.keywords[d]=v)}p=v.build(e)}d!==p&&l[u.index+a-1]!=="."&&(l=l.substring(0,u.index+a)+p+l.substring(u.index+d.length+a),a+=p.length-d.length),this.getIncludeByName(p)===void 0&&Ps.contains(p)&&e.include(Ps.get(p))}return n==="source"?l:this.isMethod?(this.isInterface||e.include(this,void 0,l),this.name):e.format("( "+l+" )",this.getType(e),n)}parse(e,n,i,r){if(this.src=e||"",this.includes=n??[],this.extensions=i??{},this.keywords=r??{},this.isMethod){let s=j3e.exec(this.src);if(this.inputs=[],s&&s.length==4){this.type=s[1],this.name=s[2];let o=s[3].match(jj);if(o){let a=0;for(;a<o.length;){let l=o[a++],c;l==="in"||l==="out"||l==="inout"?c=o[a++]:(c=l,l="");let h=o[a++];this.inputs.push({name:h,type:c,qualifier:l})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},W3e=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,jJ=class extends Gn{constructor(t="",e){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(t||jJ.PI,void 0,void 0,void 0,e)}getType(t){return t.getTypeByFormat(this.type)}parse(t,e,n,i,r){this.src=t||"";let s,o,a="",l=W3e.exec(t);this.useDefine=r??this.src.charAt(0)==="#",l&&l.length>1?(o=l[1],s=l[2],a=l[3]):(s=this.src,o="f"),this.name=s,this.type=o,this.value=a}build(t,e){if(e==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return t.include(this),t.format(this.name,this.getType(t),e)}generate(t,e,n,i,r){return t.format(this.name,this.getType(t),e)}},Tn=jJ;Tn.PI="PI",Tn.PI2="PI2",Tn.RECIPROCAL_PI="RECIPROCAL_PI",Tn.RECIPROCAL_PI2="RECIPROCAL_PI2",Tn.LOG2="LOG2",Tn.EPSILON="EPSILON";var X3e=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),Y3e=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),WJ=class extends Gn{constructor(t=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(t)}getType(t){return t.getTypeByFormat(this.name)}getInputByName(t){let e=this.inputs.length;for(;e--;)if(this.inputs[e].name===t)return this.inputs[e]}generate(t,e,n,i,r){return e==="source"?this.src+";":t.format("( "+this.src+" )",this.getType(t),e)}parse(t=""){this.src=t,this.inputs=[];let e=X3e.exec(t);if(e){let n=e[2],i;for(;i=Y3e.exec(n);)this.inputs.push({type:i[1],name:i[2]});this.name=e[1]}else this.name="";this.type=this.name}},gF=class extends Gn{constructor(t){super("v2",{shared:!1}),this.nodeType="UV",this.index=t??0}generate(t,e){t.requires.uv[this.index]=!0;let n=this.index>0?this.index+1:"",i=t.isShader("vertex")?"uv"+n:"vUv"+n;return t.format(i,this.getType(t),e)}};Ps.addKeyword("uv",function(){return new gF});Ps.addKeyword("uv2",function(){return new gF(1)});var mm=class extends Gn{constructor(t,e){super("v4"),this.nodeType="ColorSpace",this.input=t,this.method=e??mm.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(t){switch(t){case Jl:return["Linear"];case Wt:return["sRGB"];default:return[]}}generate(t,e){var o;let n=this.input.build(t,"v4"),i=this.getType(t),r=mm.Nodes[this.method],s=t.include(r);if(s===mm.LINEAR_TO_LINEAR)return t.format(n,i,e);if(((o=r.inputs)==null?void 0:o.length)===2){let a=this.factor.build(t,"f");return t.format(s+"( "+n+", "+a+" )",i,e)}else return t.format(s+"( "+n+" )",i,e)}fromEncoding(t){let e=mm.getEncodingComponents(t);this.method="LinearTo"+e[0],this.factor=e[1]}fromDecoding(t){let e=mm.getEncodingComponents(t);this.method=e[0]+"ToLinear",this.factor=e[1]}},Nl=mm;Nl.Nodes={LinearToLinear:new wt(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new wt(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new wt(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},Nl.LINEAR_TO_LINEAR="LinearToLinear",Nl.SRGB_TO_LINEAR="sRGBToLinear",Nl.LINEAR_TO_SRGB="LinearTosRGB";var qn=class extends wt{constructor(t="",e,n,i,r){super(t,r,i,n,e),this.nodeType="Expression"}},mh=class extends bo{constructor(e=new _r,n,i,r){super("v4",{shared:!0}),this.nodeType="Texture",this.value=e,this.uv=n??new gF,this.bias=i,this.project=r!==void 0?r:!1}getTexture(e,n){return super.generate(e,n,this.value.uuid,"t")}generate(e,n){if(n==="sampler2D")return this.getTexture(e,n);let i=this.getTexture(e,n),r=this.uv.build(e,this.project?"v4":"v2"),s=this.bias?this.bias.build(e,"f"):void 0;s===void 0&&e.context.bias&&(s=e.context.bias.setTexture(this).build(e,"f"));let o,a;this.project?o="texture2DProj":o=s?"tex2DBias":"tex2D",s?a=o+"( "+i+", "+r+", "+s+" )":a=o+"( "+i+", "+r+" )";let l={include:e.isShader("vertex"),ignoreCache:!0},c=this.getType(e);return e.addContext(l),this.colorSpace=this.colorSpace??new Nl(new qn("",c)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(a),a=this.colorSpace.build(e,c),e.removeContext(),e.format(a,c,n)}},gt=class extends bo{constructor(e){super("f"),this.nodeType="Float",this.value=e??0}generateReadonly(e,n,i,r,s,o){return e.format(this.value+(this.value%1?"":".0"),r,n)}},Wj=class extends Gn{constructor(t,e){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=t,this.inputs=e??[]}getFunction(){return this.value}getType(t){return this.value.getType(t)}generate(t,e,n,i,r){i=this.getType(t);let s=this.value,o=s.build(t,e)+"( ",a=[];if(s.inputs){for(let l=0;l<s.inputs.length;l++){let c=s.inputs[l],h=this.inputs[l]||this.inputs[c.name];a.push(h.build(t,t.getTypeByFormat(c.type)))}o+=a.join(", ")+" )"}return t.format(o,i,e)}},XJ=class extends Gn{constructor(t,e,n=XJ.ADD){super(),this.nodeType="Operator",this.type=t.type,this.a=t,this.b=e,this.op=n}getType(t){let e=this.a.getType(t),n=this.b.getType(t);return t.isTypeMatrix(e)?"v4":t.getTypeLength(n)>t.getTypeLength(e)?n:e}generate(t,e){let n=this.getType(t);this.type=n;let i=this.a.build(t,n),r=this.b.build(t,n);return t.format("( "+i+" "+this.op+" "+r+" )",n,e)}},Ul=XJ;Ul.ADD="+",Ul.SUB="-",Ul.MUL="*",Ul.DIV="/";var Cn=class extends Gn{constructor(t,e=Cn.ABS,n,i){super(),this.nodeType="Math",this.a=t,typeof e!="string"?this.b=e:i=e,typeof n!="string"?this.c=n:i=n,this.method=i,this.hashProperties=["method"]}getNumInputs(t){switch(this.method){case Cn.MIX:case Cn.CLAMP:case Cn.REFRACT:case Cn.SMOOTHSTEP:case Cn.FACEFORWARD:return 3;case Cn.MIN:case Cn.MAX:case Cn.MOD:case Cn.STEP:case Cn.REFLECT:case Cn.DISTANCE:case Cn.DOT:case Cn.CROSS:case Cn.POW:return 2;default:return 1}}getInputType(t){let e=t.getTypeLength(this.a.getType(t)),n=this.b?t.getTypeLength(this.b.getType(t)):0,i=this.c?t.getTypeLength(this.c.getType(t)):0;return e>n&&e>i?this.a.getType(t):n>i?this.b.getType(t):this.c.getType(t)}getType(t){switch(this.method){case Cn.LENGTH:case Cn.DISTANCE:case Cn.DOT:return"f";case Cn.CROSS:return"v3"}return this.getInputType(t)}generate(t,e){let n,i,r,s=this.a?t.getTypeLength(this.a.getType(t)):0,o=this.b?t.getTypeLength(this.b.getType(t)):0,a=this.c?t.getTypeLength(this.c.getType(t)):0,l=this.getInputType(t),c=this.getType(t);switch(this.type=c,this.method){case Cn.NEGATE:return t.format("( -"+this.a.build(t,l)+" )",l,e);case Cn.INVERT:return t.format("( 1.0 - "+this.a.build(t,l)+" )",l,e);case Cn.CROSS:n=this.a.build(t,"v3"),i=this.b.build(t,"v3");break;case Cn.STEP:n=this.a.build(t,s===1?"f":l),i=this.b.build(t,l);break;case Cn.MIN:case Cn.MAX:case Cn.MOD:n=this.a.build(t,l),i=this.b.build(t,o===1?"f":l);break;case Cn.REFRACT:n=this.a.build(t,l),i=this.b.build(t,l),r=this.c.build(t,"f");break;case Cn.MIX:n=this.a.build(t,l),i=this.b.build(t,l),r=this.c.build(t,a===1?"f":l);break;default:n=this.a.build(t,l),this.b&&(i=this.b.build(t,l)),this.c&&(r=this.c.build(t,l));break}let h=[];h.push(n),i&&h.push(i),r&&h.push(r);let u=this.getNumInputs(t);if(h.length!==u)throw Error(`Arguments not match used in "${this.method}". Require ${u}, currently ${h.length}.`);return t.format(this.method+"( "+h.join(", ")+" )",c,e)}},zt=Cn;zt.RAD="radians",zt.DEG="degrees",zt.EXP="exp",zt.EXP2="exp2",zt.LOG="log",zt.LOG2="log2",zt.SQRT="sqrt",zt.INV_SQRT="inversesqrt",zt.FLOOR="floor",zt.CEIL="ceil",zt.NORMALIZE="normalize",zt.FRACT="fract",zt.SATURATE="saturate",zt.SIN="sin",zt.COS="cos",zt.TAN="tan",zt.ASIN="asin",zt.ACOS="acos",zt.ARCTAN="atan",zt.ABS="abs",zt.SIGN="sign",zt.LENGTH="length",zt.NEGATE="negate",zt.INVERT="invert",zt.MIN="min",zt.MAX="max",zt.MOD="mod",zt.STEP="step",zt.REFLECT="reflect",zt.DISTANCE="distance",zt.DOT="dot",zt.CROSS="cross",zt.POW="pow",zt.MIX="mix",zt.CLAMP="clamp",zt.REFRACT="refract",zt.SMOOTHSTEP="smoothstep",zt.FACEFORWARD="faceforward";var ny=class extends Gn{constructor(t,e,n){super("v4"),this.nodeType="TextureCubeUV",this.value=t,this.uv=e,this.bias=n}bilinearCubeUV(t,e,n,i){let r=new Wj(ny.Nodes.bilinearCubeUV,[e,n,i]);this.colorSpaceTL=this.colorSpaceTL??new Nl(new qn("","v4")),this.colorSpaceTL.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(r.build(t)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new Nl(new qn("","v4")),this.colorSpaceTR.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(r.build(t)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new Nl(new qn("","v4")),this.colorSpaceBL.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(r.build(t)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new Nl(new qn("","v4")),this.colorSpaceBR.fromDecoding(t.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(r.build(t)+".br");let s={include:t.isShader("vertex"),ignoreCache:!0};t.addContext(s),this.colorSpaceTLExp=new qn(this.colorSpaceTL.build(t,"v4"),"v4"),this.colorSpaceTRExp=new qn(this.colorSpaceTR.build(t,"v4"),"v4"),this.colorSpaceBLExp=new qn(this.colorSpaceBL.build(t,"v4"),"v4"),this.colorSpaceBRExp=new qn(this.colorSpaceBR.build(t,"v4"),"v4"),t.removeContext();let o=new qn("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return o.keywords.cubeUV_TL=this.colorSpaceTLExp,o.keywords.cubeUV_TR=this.colorSpaceTRExp,o.keywords.cubeUV_BL=this.colorSpaceBLExp,o.keywords.cubeUV_BR=this.colorSpaceBRExp,o.keywords.cubeUV=r,o}generate(t,e){if(t.isShader("fragment")){let n=this.uv,i=this.bias||t.context.roughness,r=new Wj(ny.Nodes.roughnessToMip,[i]),s=new zt(r,ny.Nodes.m0,ny.Nodes.cubeUV_maxMipLevel,zt.CLAMP),o=new zt(s,zt.FLOOR),a=new zt(s,zt.FRACT),l=this.bilinearCubeUV(t,this.value,n,o),c=this.bilinearCubeUV(t,this.value,n,new Ul(o,new gt(1).setReadonly(!0),Ul.ADD)),h=new zt(l,c,a,zt.MIX);return t.format(h.build(t),"v4",e)}else return console.warn("TextureCubeUVNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e)}},bI=ny;bI.Nodes=function(){let t=new WJ(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),e=new Tn("float cubeUV_maxMipLevel 8.0",!0),n=new Tn("float cubeUV_minMipLevel 4.0",!0),i=new Tn("float cubeUV_maxTileSize 256.0",!0),r=new Tn("float cubeUV_minTileSize 16.0",!0),s=new wt(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);s.useKeywords=!1;let o=new wt(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);o.useKeywords=!1;let a=new wt(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[t,s,o,e,n,i,r]);a.useKeywords=!1;let l=new Tn("float r0 1.0",!0),c=new Tn("float v0 0.339",!0),h=new Tn("float m0 -2.0",!0),u=new Tn("float r1 0.8",!0),d=new Tn("float v1 0.276",!0),f=new Tn("float m1 -1.0",!0),p=new Tn("float r4 0.4",!0),v=new Tn("float v4 0.046",!0),g=new Tn("float m4 2.0",!0),m=new Tn("float r5 0.305",!0),y=new Tn("float v5 0.016",!0),_=new Tn("float m5 3.0",!0),S=new Tn("float r6 0.21",!0),A=new Tn("float v6 0.0038",!0),b=new Tn("float m6 4.0",!0),T=[l,c,h,u,d,f,p,v,g,m,y,_,S,A,b],M=new wt(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,T);return{bilinearCubeUV:a,roughnessToMip:M,m0:h,cubeUV_maxMipLevel:e}}();var gm=class extends Gn{constructor(t){super("v3"),this.nodeType="Normal",this.scope=t??gm.VIEW}getShared(){return this.scope===gm.WORLD}build(t,e,n,i){let r=t.context[this.scope+"Normal"];return r?r.build(t,e,n,i):super.build(t,e,n)}generate(t,e,n,i,r){let s;switch(this.scope){case gm.VIEW:t.isShader("vertex")?s="transformedNormal":s="geometryNormal";break;case gm.LOCAL:t.isShader("vertex")?s="objectNormal":(t.requires.normal=!0,s="vObjectNormal");break;case gm.WORLD:t.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(t.requires.worldNormal=!0,s="vWNormal");break}return t.format(s,this.getType(t),e)}},Rs=gm;Rs.LOCAL="local",Rs.WORLD="world",Rs.VIEW="view",Rs.NORMAL="normal";Ps.addKeyword("viewNormal",function(){return new Rs(Rs.VIEW)});Ps.addKeyword("localNormal",function(){return new Rs(Rs.NORMAL)});Ps.addKeyword("worldNormal",function(){return new Rs(Rs.WORLD)});var Rc=class extends Gn{constructor(t){super("v3"),this.nodeType="Position",this.scope=t??Rc.LOCAL}getType(){switch(this.scope){case Rc.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case Rc.LOCAL:case Rc.WORLD:return!1}return!0}generate(t,e,n,i,r){let s;switch(this.scope){case Rc.LOCAL:t.isShader("vertex")?s="transformed":(t.requires.position=!0,s="vPosition");break;case Rc.WORLD:if(t.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";t.requires.worldPosition=!0,s="vWPosition";break;case Rc.VIEW:s=t.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case Rc.PROJECTION:s=t.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return t.format(s,this.getType(),e)}},ka=Rc;ka.LOCAL="local",ka.WORLD="world",ka.VIEW="view",ka.PROJECTION="projection";Ps.addKeyword("position",function(){return new ka});Ps.addKeyword("worldPosition",function(){return new ka(ka.WORLD)});Ps.addKeyword("viewPosition",function(){return new ka(ka.VIEW)});var Ml=class extends Gn{constructor(t){super("v3"),this.nodeType="Reflect",this.scope=t??Ml.CUBE}getUnique(t){return!t.context.viewNormal}getType(){switch(this.scope){case Ml.SPHERE:return"v2"}return this.type}generate(t,e){let n=this.getUnique(t);if(t.isShader("fragment")){let i;switch(this.scope){case Ml.VECTOR:{let r=new Rs(Rs.VIEW),s=t.context.roughness,o=r.build(t,"v3"),a=new ka(ka.VIEW).build(t,"v3"),l=s?s.build(t,"f"):void 0,c=`reflect( -normalize( ${a} ), ${o} )`;l&&(c=`normalize( mix( ${c}, ${o}, ${l} * ${l} ) )`);let h=`inverseTransformDirection( ${c}, viewMatrix )`;n?(t.addNodeCode(`vec3 reflectVec = ${h};`),i="reflectVec"):i=h;break}case Ml.CUBE:{let r=new Ml(Ml.VECTOR).build(t,"v3"),s="vec3( -"+r+".x, "+r+".yz )";n?(t.addNodeCode(`vec3 reflectCubeVec = ${s};`),i="reflectCubeVec"):i=s;break}case Ml.SPHERE:{let r="normalize( ( viewMatrix * vec4( "+new Ml(Ml.VECTOR).build(t,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";n?(t.addNodeCode(`vec2 reflectSphereVec = ${r};`),i="reflectSphereVec"):i=r;break}}return t.format(i,this.getType(),e)}else return console.warn("ReflectNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.type,e)}},mg=Ml;mg.CUBE="cube",mg.SPHERE="sphere",mg.VECTOR="vector";var q3e=class extends Gn{constructor(t=new mh,e,n){super("v4"),this.nodeType="TextureCube",this.value=t,this.radianceNode=new bI(this.value,e??new mg(mg.VECTOR),n),this.irradianceNode=new bI(this.value,new Rs(Rs.WORLD),new gt(1).setReadonly(!0))}generate(t,e){return t.isShader("fragment")?(t.require("irradiance"),t.context.bias&&t.context.bias.setTexture(this.value),(t.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(t,e)):(console.warn("TextureCubeNode is not compatible with "+t.shader+" shader."),t.format("vec4( 0.0 )",this.getType(t),e))}},Q3e=class extends bo{constructor(t=new yO,e,n){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=t,this.uv=e??new mg,this.bias=n}getTexture(t,e){return super.generate(t,e,this.value.uuid,"tc")}generate(t,e){var l;if(e==="samplerCube")return this.getTexture(t,e);let n=this.getTexture(t,e),i=(l=this.uv)==null?void 0:l.build(t,"v3"),r=this.bias?this.bias.build(t,"f"):void 0;r===void 0&&t.context.bias&&(r=t.context.bias.setTexture(this).build(t,"f"));let s;r?s="texCubeBias( "+n+", "+i+", "+r+" )":s="texCube( "+n+", "+i+" )";let o={include:t.isShader("vertex"),ignoreCache:!0},a=this.getType(t);return t.addContext(o),this.colorSpace=this.colorSpace??new Nl(new qn("",a)),this.colorSpace.fromDecoding(t.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(s),s=this.colorSpace.build(t,a),t.removeContext(),t.format(s,a,e)}},Xj=["x","y","z","w"],K3e=["float","vec2","vec3","vec4"],J3e={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},Z3e={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},$3e=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.getIncludesCode=function(){function t(e,n){return e.deps.length-n.deps.length}return function(e,n){let i=this.getIncludes(e,n);if(!i)return"";let r="";i=i.sort(t);for(let s=0;s<i.length;s++)i[s].src&&(r+=i[s].src+`
`);return r}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(t,e){this.buildShader("vertex",t),this.buildShader("fragment",e);for(let n=0;n<this.requires.uv.length;n++)if(this.requires.uv[n]){let i=n>0?n+1:"";this.addVaryCode("varying vec2 vUv"+i+";"),n>0&&this.addVertexParsCode("attribute vec2 uv"+i+";"),this.addVertexFinalCode("vUv"+i+" = uv"+i+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this}buildShader(t,e){this.resultCode[t]=e.build(this.setShader(t),"v4")}setMaterial(t,e){return this.defines={},this}addFlow(t,e,n){return this.addSlot(t).addCache(e).addContext(n)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(t){return this.cache=t??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(t){return this.context=Object.assign({},this.context,t),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(t){return this.slot=t||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(t,e){this.fragmentVariables[t]===void 0&&(this.addFragmentCode(`${e} ${t};`),this.fragmentVariables[t]="")}addFragmentParsVariable(t,e){this.fragmentParsVariables[t]===void 0&&(this.addFragmentParsCode(`${e} ${t};`),this.fragmentParsVariables[t]="")}addVertexParsVariable(t,e){this.vertexParsVariables[t]===void 0&&(this.addVertexParsCode(`${e} ${t};`),this.vertexParsVariables[t]="")}addVertexCode(t){this.addCode(t,"vertex")}addFragmentCode(t){this.addCode(t,"fragment")}addCode(t,e){this.code[e??this.shader]+=t+`
`}addVertexNodeCode(t){this.addNodeCode(t,"vertex")}addFragmentNodeCode(t){this.addNodeCode(t,"fragment")}addNodeCode(t,e){this.nodeCode[e??this.shader]+=t+`
`}clearNodeCode(t){t=t??this.shader;let e=this.nodeCode[t];return this.nodeCode[t]="",e}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(t){this.addFinalCode(t,"vertex")}addFragmentFinalCode(t){this.addFinalCode(t,"fragment")}addFinalCode(t,e){this.finalCode[e??this.shader]+=t+`
`}addVertexParsCode(t){this.addParsCode(t,"vertex")}addFragmentParsCode(t){this.addParsCode(t,"fragment")}addParsCode(t,e){this.parsCode[e??this.shader]+=t+`
`}addVaryCode(t){this.addVertexParsCode(t),this.addFragmentParsCode(t)}isCache(t){return this.caches.indexOf(t)!==-1}isSlot(t){return this.slots.indexOf(t)!==-1}define(t,e){this.defines[t]=e===void 0?1:e}require(t){this.requires[t]=!0}isDefined(t){return this.defines[t]!==void 0}getVar(t,e,n,i="varying",r="V",s=""){let o=this.getVars(i),a=o[t];if(!a){let l=o.length;a={name:n||"node"+r+l+(s?"_"+s:""),type:e},o.push(a),o[t]=a}return a}getTempVar(t,e,n,i){return this.getVar(t,e,n,this.shader,"T",i)}getAttribute(t,e){if(!this.attributes[t]){let n=this.getVar(t,e);this.addVertexParsCode("attribute "+e+" "+t+";"),this.addVertexFinalCode(n.name+" = "+t+";"),this.attributes[t]={varying:n,name:t,type:e}}return this.attributes[t]}getCode(t){return[this.prefixCode,this.parsCode[t],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[t],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[t],"uniform"),this.getIncludesCode("consts",t),this.getIncludesCode("structs",t),this.getIncludesCode("functions",t),"void main() {",this.getVarListCode(this.getVars(t)),this.code[t],this.resultCode[t],this.finalCode[t],"}"].join(`
`)}getVarListCode(t,e){e=e??"";let n="";for(let i=0,r=t.length;i<r;++i){let s=t[i],o=s.type,a=s.name,l=s.size,c=this.getFormatByType(o);if(c===void 0)throw new Error("Node pars "+c+" not found.");c.includes("[]")?n+=e+" "+c.substring(0,c.length-2)+" "+a+`[${l}];
`:n+=e+" "+c+" "+a+`;
`}return n}getVars(t){return this.inputs.vars[t??this.shader]}getNodeData(t){let e=t instanceof ed?t.uuid:t;return this.nodeData[e]=this.nodeData[e]||{}}createUniform(t,e,n,i,r,s){if(e.includes("[]")){let o=this.inputs.arrayUniforms,a=o.list.length,l=new Vj({type:e,size:n.size,name:i||"nodeUA"+a+(s?"_"+s:""),node:n,needsUpdate:r});return o.list.push(l),o[t].push(l),o[t][l.name]=l,this.uniforms[l.name]=l,l}else{let o=this.inputs.uniforms,a=o.list.length,l=new Vj({type:e,name:i||"nodeU"+a+(s?"_"+s:""),node:n,needsUpdate:r});return o.list.push(l),o[t].push(l),o[t][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(t,e,n,i,r){return this.createUniform("vertex",t,e,n,i,r)}createFragmentUniform(t,e,n,i,r){return this.createUniform("fragment",t,e,n,i,r)}include(t,e,n){var s;let i;if(t=typeof t=="string"?Ps.get(t):t,this.context.include===!1)return t.name;t instanceof wt?i=this.includes.functions:t instanceof Tn?i=this.includes.consts:t instanceof WJ&&(i=this.includes.structs);let r=i[this.shader]=i[this.shader]||[];if(t){let o=r[t.name];if(o||(o=r[t.name]={node:t,deps:[]},r.push(o),o.src=t.build(this,"source")),t instanceof wt&&e&&r[e.name]&&r[e.name].deps.indexOf(t)===-1&&(r[e.name].deps.push(t),(s=t.includes)==null?void 0:s.length)){let a=0;do this.include(t.includes[a++],e);while(a<t.includes.length)}return n&&(o.src=n),t.name}else throw new Error("Include not found.")}colorToVectorProperties(t){return t.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(t){return t.replace(/c/g,"v3")}getIncludes(t,e){return this.includes[t][e||this.shader]}getConstructorFromLength(t){return K3e[t-1]}isTypeMatrix(t){return/^m/.test(t)}getTypeLength(t){return t==="f"?1:parseInt(this.colorToVector(t).substr(1))}getTypeFromLength(t){return t===1?"f":"v"+t}findNode(...t){for(let e=0;e<arguments.length;e++){let n=t[e];if(n!=null&&n.isNode)return n}}resolve(...t){for(let e=0;e<arguments.length;e++){let n=t[e];if(n!==void 0){if(n.isNode)return n;if(n.isTexture)switch(n.mapping){case Rf:case Lf:return new Q3e(n);case A1:return new q3e(new mh(n));default:return new mh(n)}else{if(n.isVector2)return new qo(n);if(n.isVector3)return new Vo(n);if(n.isVector4)return new Wd(n)}}}}format(t,e,n){switch(this.colorToVector(n+" <- "+e)){case"f <- v2":return t+".x";case"f <- v3":return t+".x";case"f <- v4":return t+".x";case"f <- i":case"f <- b":return"float( "+t+" )";case"v2 <- f":return"vec2( "+t+" )";case"v2 <- v3":return t+".xy";case"v2 <- v4":return t+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+t+" ) )";case"v3 <- f":return"vec3( "+t+" )";case"v3 <- v2":return"vec3( "+t+", 0.0 )";case"v3 <- v4":return t+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+t+" ) )";case"v4 <- f":return"vec4( "+t+" )";case"v4 <- v2":return"vec4( "+t+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+t+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+t+" ) )";case"i <- f":case"i <- b":return"int( "+t+" )";case"i <- v2":return"int( "+t+".x )";case"i <- v3":return"int( "+t+".x )";case"i <- v4":return"int( "+t+".x )";case"b <- f":return"( "+t+" != 0.0 )";case"b <- v2":return"( "+t+" != vec2( 0.0 ) )";case"b <- v3":return"( "+t+" != vec3( 0.0 ) )";case"b <- v4":return"( "+t+" != vec4( 0.0 ) )";case"b <- i":return"( "+t+" != 0 )"}return t}getTypeByFormat(t){return J3e[t]||t}getFormatByType(t){return Z3e[t]||t}getUUID(t,e){return e=e!==void 0?e:!0,e&&this.cache&&(t=this.cache+"-"+t),t}getElementByIndex(t){return Xj[t]}getIndexByElement(t){return Xj.indexOf(t)}isShader(t){return this.shader===t}setShader(t){return this.shader=t,this}mergeDefines(t){for(let e in t)this.defines[e]=t[e];return this.defines}mergeUniform(t){for(let e in t)this.uniforms[e]=t[e];return this.uniforms}getTextureEncodingFromMap(t){let e;return t?t.isTexture&&(e=t.encoding):e=Jl,e===Jl&&this.context.gamma&&(e=Wt),e}},wi=class extends bo{constructor(t=0,e,n,i){super("c"),this.nodeType="Color",this.value=t instanceof Ns?t:new Ns(t||0,e,n,i)}setRGBA(t){this.value.setRGBA(t.r,t.g,t.b,t.a)}generate(t,e,n,i,r,s){n=t.getUUID(n??this.getUUID()),i=i??this.getType(t);let o=t.getNodeData(n),a=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let l=this.alpha.build(t,"f");t.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${l};`)}return a?this.generateReadonly(t,e,n,i,r,s):t.isShader("vertex")?(o.vertex||(o.vertex=t.createVertexUniform(i,this,r,s,this.getLabel())),t.format(o.vertex.name,i,e)):(o.fragment||(o.fragment=t.createFragmentUniform(i,this,r,s,this.getLabel())),t.format(o.fragment.name,i,e))}generateReadonly(t,e,n,i,r,s){return t.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",i,e)}},On=class extends bo{constructor(t){super("i"),this.nodeType="Int",this.value=Math.floor(t??0)}generateReadonly(t,e,n,i,r,s){return t.format(this.value.toString(),i,e)}},YJ=class extends ed{constructor(){super("basic"),this.nodeType="Basic",this.color=new wi(5526619),this.shadingAlpha=new gt(1),this.shadingBlend=new On(0)}get category(){return"phong"}generate(t){let e;if(t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform(hv.merge([tt.fog])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{this.color===void 0&&(this.color=new wi(5526619)),this.color.analyze(t,{slot:"color"}),this.alpha&&this.alpha.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"});let n=this.color.flow(t,"c",{slot:"color"}),i=this.alpha?this.alpha.flow(t,"f"):void 0,r=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0;t.requires.transparent=i!==void 0,t.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let s=["#include <normal_fragment_begin>",n.code];i&&s.push(i.code,"#ifdef ALPHATEST"," if ( "+i.result+" <= ALPHATEST ) discard;","#endif"),r?s.push(r.code,`vec3 outgoingLight = ${n.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${r.result}, 1.0, SPE_BLENDING_NORMAL);`):s.push(`vec3 finalColor = ${n.result};`),i?s.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${i.result} );`):s.push("gl_FragColor = vec4("+n.result+", 1.0 );"),s.push("#include <fog_fragment>","#include <dithering_fragment>"),e=s.join(`
`)}return e}},Ud=class extends bo{constructor(t=1,e){super("f[]"),this.nodeType="FloatArray",this.size=t,this.value=Array.isArray(e)?e:typeof e=="number"?new Array(t).fill(e):new Array(t).fill(0)}},ei={normalRenderTarget:new mh,normalRenderTargetDepth:new mh,transmissionRenderTarget:new mh,transmissionSize:new qo(2048,2048),transmissionRenderTargetDepth:new mh,pixelRatioNode:new gt(1),resolution:new qo,penumbraSize:new Ud(5,.5)};for(let t of Object.values(ei))t.isRenderGlobal=!0;var eBe=class extends ed{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new wi(5526619),this.emissive=new wi(0),this.emissiveIntensity=new gt(1),this.shadingAlpha=new gt(1),this.shadingBlend=new On(0)}get category(){return"lambert"}build(t){let e;if(t.define("LAMBERT"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform(hv.merge([tt.fog,tt.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{t.mergeUniform({penumbraSize:ei.penumbraSize}),this.color===void 0&&(this.color=new wi(5526619)),this.color.analyze(t,{slot:"color"}),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let n=this.color.flow(t,"c",{slot:"color"}),i=this.emissive.flow(t,"c",{slot:"emissive"}),r=this.emissiveIntensity.flow(t,"f",{slot:"emissive"}),s=this.shadingAlpha.flow(t,"f"),o=this.shadingBlend.flow(t,"i"),a=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(t,"f"):void 0;t.requires.transparent=l!==void 0,t.addParsCode(["uniform float penumbraSize[5];","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let c=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];c.push(n.code,"vec3 diffuseColor = "+n.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),l&&c.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),c.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),i&&c.push(i.code,"reflectedLight.directDiffuse += "+i.result+" * "+r.result+";"),c.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;"),c.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result}, ${o.result} );
				}
				`),a&&c.push(a.code,`outgoingLight = spe_blend(outgoingLight, ${a.result}, 1.0, SPE_BLENDING_NORMAL);`),l?c.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):c.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=c.join(`
`)}return e}},tBe=class extends ed{constructor(){super("phong"),this.nodeType="Phong",this.color=new wi(5526619),this.specular=new wi(1118481),this.shininess=new gt(30),this.shadingAlpha=new gt(1),this.shadingBlend=new On(0)}get category(){return"phong"}build(t){let e;if(t.define("PHONG"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform(hv.merge([tt.fog,tt.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif


				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{t.mergeUniform({penumbraSize:ei.penumbraSize}),this.color===void 0&&(this.color=new wi(5526619)),this.color.analyze(t,{slot:"color"}),this.specular.analyze(t),this.shininess.analyze(t),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let n=this.color.flow(t,"c",{slot:"color"}),i=this.specular.flow(t,"c"),r=this.shininess.flow(t,"f"),s=this.shadingAlpha.flow(t,"f"),o=this.shadingBlend.flow(t,"i"),a=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(t,"f"):void 0;t.requires.transparent=l!==void 0,t.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let c=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];c.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",i.code,"	vec3 specular = "+i.result+";",r.code,"	float shininess = max( 0.0001, "+r.result+" );","	float specularStrength = 1.0;"),l&&c.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),c.push("material.diffuseColor = diffuseColor;"),c.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),c.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;"),c.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result}, ${o.result} );
				}
				`),a&&c.push(a.code,`outgoingLight = spe_blend(outgoingLight, ${a.result}, 1.0, SPE_BLENDING_NORMAL);`),l?c.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):c.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=c.join(`
`)}return e}},nBe=class extends ed{constructor(){super("standard"),this.nodeType="Standard",this.color=new wi(5526619),this.roughness=new gt(.3),this.metalness=new gt(0),this.reflectivity=new gt(.5),this.shadingAlpha=new gt(1),this.shadingBlend=new On(0)}get category(){return"physical"}build(t){let e;if(t.define("STANDARD"),t.requires.lights=!0,t.extensions.derivatives=!0,t.extensions.shaderTextureLOD=!0,t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform(hv.merge([tt.fog,tt.lights])),tt.LTC_1&&(t.uniforms.ltc_1={value:void 0},t.uniforms.ltc_2={value:void 0}),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{t.mergeUniform({penumbraSize:ei.penumbraSize});let n={gamma:!0};this.color===void 0&&(this.color=new wi(5526619)),this.color.analyze(t,{slot:"color",context:n}),this.roughness.analyze(t),this.metalness.analyze(t),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t),this.reflectivity&&this.reflectivity.analyze(t);let i=this.color.flow(t,"c",{slot:"color",context:n}),r=this.roughness.flow(t,"f"),s=this.metalness.flow(t,"f"),o=this.shadingAlpha.flow(t,"f"),a=this.shadingBlend.flow(t,"i"),l=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(t,"f"):void 0,h=this.reflectivity?this.reflectivity.flow(t,"f"):void 0;t.requires.transparent=c!==void 0,t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let u=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];u.push(i.code,"	vec3 diffuseColor = "+i.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",r.code,"	float roughnessFactor = "+r.result+";",s.code,"	float metalnessFactor = "+s.result+";"),c&&u.push(c.code,"#ifdef ALPHATEST","	if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),u.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),u.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),h?u.push(h.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+h.result+" ) ), diffuseColor, metalnessFactor );"):u.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),u.push("#include <lights_fragment_begin>"),u.push("#include <lights_fragment_end>"),u.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;"),u.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result}, ${a.result} );
				}
				`),l&&u.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result} );`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=u.join(`
`)}return e}},iBe=class extends ed{constructor(){super("toon"),this.nodeType="Toon",this.color=new wi(5526619),this.specular=new wi(1118481),this.shininess=new gt(30),this.shadingAlpha=new gt(1),this.shadingBlend=new On(0)}get category(){return"toon"}build(t){let e;if(t.define("TOON"),t.requires.lights=!0,t.extensions.derivatives=!0,t.isShader("vertex")){let n=this.position?this.position.analyzeAndFlow(t,"v3",{cache:"position"}):void 0;t.mergeUniform(hv.merge([tt.fog,tt.lights])),t.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];n&&i.push(n.code,n.result?"displaced_position = "+n.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),e=i.join(`
`)}else{t.mergeUniform({penumbraSize:ei.penumbraSize}),this.color===void 0&&(this.color=new wi(5526619)),this.color.analyze(t,{slot:"color"}),this.specular.analyze(t),this.shininess.analyze(t),this.shadingAlpha.analyze(t),this.shadingBlend.analyze(t),this.afterColor&&this.afterColor.analyze(t,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(t);let n=this.color.flow(t,"c",{slot:"color"}),i=this.specular.flow(t,"c"),r=this.shininess.flow(t,"f"),s=this.shadingAlpha.flow(t,"f"),o=this.shadingBlend.flow(t,"i"),a=this.afterColor?this.afterColor.flow(t,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(t,"f"):void 0;t.requires.transparent=l!==void 0,t.addParsCode(["uniform float penumbraSize[5];","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let c=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];c.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",i.code,"	vec3 specular = "+i.result+";",r.code,"	float shininess = max( 0.0001, "+r.result+" );","	float specularStrength = 1.0;"),l&&c.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),c.push("material.diffuseColor = diffuseColor;"),c.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),c.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular;"),c.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result}, ${o.result} );
				}
				`),a&&c.push(a.code,`outgoingLight = spe_blend(outgoingLight, ${a.result}, 1.0, SPE_BLENDING_NORMAL);`),l?c.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):c.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),e=c.join(`
`)}return e}},I0=class extends bo{constructor(t){super("b"),this.nodeType="Bool",this.value=t??!1}generateReadonly(t,e,n,i){return t.format(this.value?"true":"false",i,e)}},qJ=class extends bo{constructor(t){super("m3"),this.nodeType="Matrix3",this.value=t??new Pr}generateReadonly(t,e,n,i,r,s){return t.format("mat3("+this.value.elements.join(", ")+")",i,e)}get elements(){return this.value.elements}set elements(t){this.value.fromArray(t)}},kd=class extends bo{constructor(t=1,e){super("v4[]"),this.nodeType="Vector4Array",this.size=t,this.value=Array.isArray(e)?e:e instanceof Zt?new Array(t).fill(e):new Array(t).fill(new Zt(0))}},vF=(t=>(t.SIMPLEX="simplex3d",t.SIMPLEX_FRACTAL="simplex3dFractal",t.ASHIMA="simplexAshima",t.FBM="fbm",t.PERLIN="perlin",t))(vF||{}),ea=function(){let t=new wt(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),e=new wt(`float simplex3d(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[t]);e.keywords.F3=new Tn("float F3 0.3333333"),e.keywords.G3=new Tn("float G3 0.1666667");let n=new wt(`float simplex3dFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplex3d(m * rot1)
				 + 0.2666667 * simplex3d(2.0 * m * rot2)
				 + 0.1333333 * simplex3d(4.0 * m * rot3)
				 + 0.0666667 * simplex3d(8.0 * m);
		}`,[e]),i=new wt("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),r=new wt("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),s=new wt(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[i,r]),o=new wt("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),a=new wt("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[o]),l=new wt(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[a]),c=new wt(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[l]);c.keywords.NUM_OCTAVES=new Tn("int NUM_OCTAVES 5");let h=new wt("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),u=new wt(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[i,r,h]);return{simplex:e,simplexFractal:n,simplexAshima:s,fbm:c,perlin:u}}(),QJ=class extends Gn{constructor(t,e,n,i,r,s,o,a,l,c,h,u){super("v3"),this.nodeType="Noise",this.scale=t,this.size=e,this.move=n,this.fA=i,this.fB=r,this.distortion=s,this.colorA=o,this.colorB=a,this.colorC=l,this.colorD=c,this.alpha=h,this.noiseType=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e,n,i,r){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let s=Object.values(vF)[this.noiseType.value],o=new wt(`vec3 ${s}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, float alpha, out float calpha) {
                vec3 st = position / size;
				st /= scale;
				vec3 q = vec3(${s}(st),
							  ${s}(st + vec3(1.0)),
							  ${s}(st + vec3(1.0)));
				vec3 r = vec3(${s}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
							  ${s}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
							  ${s}(st * q));
				float f = ${s}(st + r);
				vec4 color;
				color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
				color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
				color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));

                float lalpha = alpha * color.a;
                calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );

			    accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return clamp(color, 0.0, 1.0).rgb;
			}`,[ea.simplex,ea.simplexFractal,ea.simplexAshima,ea.fbm,ea.perlin]),a=t.include(o),l=[];return l.push(this.scale.build(t,"f")),l.push(this.size.build(t,"v3")),l.push(this.move.build(t,"f")),l.push(this.fA.build(t,"v2")),l.push(this.fB.build(t,"v2")),l.push(this.distortion.build(t,"v2")),l.push(this.colorA.build(t,"v4")),l.push(this.colorB.build(t,"v4")),l.push(this.colorC.build(t,"v4")),l.push(this.colorD.build(t,"v4")),l.push(this.alpha.build(t,"f")),l.push(this.calpha),t.format(a+"("+l.join(",")+")",this.getType(t),e)}};QJ.numOctaves=5;var KJ=class extends Gn{constructor(t,e,n,i,r,s,o){super("v3"),this.nodeType="Fresnel",this.color=t,this.bias=e,this.scale=n,this.intensity=i,this.factor=r,this.alpha=s,this.mode=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("vWorldViewDir"),t.require("worldNormal"),t.isShader("fragment")){t.addFragmentVariable(this.calpha,"float");let n=t.include(KJ.Nodes.fresnel),i=[];return i.push(this.color.build(t,"c")),i.push(this.bias.build(t,"f")),i.push(this.scale.build(t,"f")),i.push(this.intensity.build(t,"f")),i.push(this.factor.build(t,"f")),i.push(this.alpha.build(t,"f")),i.push(this.mode.build(t,"i")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("FresnelNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},JJ=KJ;JJ.Nodes=function(){return{fresnel:new wt(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, float alpha, int mode, out float calpha) {
				float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

				float lalpha = clamp( fresnel, 0.0, 1.0 ) * alpha;
				calpha = lalpha / clamp(lalpha + accumAlpha, 0.001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;
				return color;
			}`)}}();var ZJ=class extends Gn{constructor(t,e,n,i,r,s,o){super("v3"),this.nodeType="Rainbow",this.filmThickness=t,this.movement=e,this.wavelengths=n,this.noiseStrength=i,this.noiseScale=r,this.offset=s,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("vWorldViewDir"),t.require("worldNormal"),t.isShader("fragment")){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let n=t.include(ZJ.Nodes.rainbow),i=[];return i.push(this.filmThickness.build(t,"f")),i.push(this.movement.build(t,"f")),i.push(this.wavelengths.build(t,"v3")),i.push(this.noiseStrength.build(t,"f")),i.push(this.noiseScale.build(t,"f")),i.push(this.offset.build(t,"v3")),i.push(this.alpha.build(t,"f")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("RainbowNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},$J=ZJ;$J.Nodes=function(){let t=new wt(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
                 vec3 st = position / noiseScale;
				 vec3 q = vec3(simplex3d(st),
							  simplex3d(st + vec3(1.0)),
							  simplex3d(st + vec3(1.0)));

				 vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),
							  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),
							  simplex3d(st * q));

                 float noise = simplex3d(st + r);

                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);
             }`,[ea.simplex]);return{rainbow:new wt(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, float alpha, out float calpha) {
                 vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

                 float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);
                 float lalpha = alpha * rainbowContribution;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

                 return res;
             }`,[t])}}();var eZ=class extends Gn{constructor(t,e,n,i,r,s,o,a,l,c,h,u,d,f,p,v){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=t,this.contourColor=e,this.outlineWidth=n,this.contourWidth=i,this.contourThreshold=r,this.outlineThreshold=s,this.contourFrequency=o,this.outlineSmoothing=a,this.contourDirection=l,this.positionalLines=c,this.compensation=h,this.resolution=u,this.normalMap=d,this.depthMap=f,this.pixelRatio=p,this.alpha=v,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("vWorldViewDir"),t.require("worldNormal"),t.extensions.derivatives=!0,this.firstTime){let n=this.outlineWidth.build(t,"f"),i=this.resolution.build(t,"v2"),r=this.compensation.build(t,"b"),s=this.pixelRatio.build(t,"f");t.addVertexParsVariable("randomColor","attribute vec3"),t.addVertexParsVariable("extrudeNormal","attribute vec3"),t.addVertexParsVariable(n,"uniform float"),t.addVertexParsVariable(i,"uniform vec2"),t.addVertexParsVariable(r,"uniform bool"),t.addVertexParsVariable(s,"uniform float"),t.addVertexParsVariable("vID","flat out float"),t.addFragmentParsVariable("vID","flat in float");let o=`g${this.uuid.toString().replace(/-/g,"")}`;t.addVertexFinalCode(`
                vID = randomColor.r;
                if (${r}) {
                    vec4 ${o}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${o}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    vec2 ${o}_offset = normalize(${o}_clipNormal.xy) / ${i} * (${n} / 2.0) * ${o}_clipPosition.w * 2.0 * ${s};
                    ${o}_clipPosition.xy += ${o}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${o}_clipPosition;
                }
            `)}if(t.isShader("fragment")){t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let n=t.include(eZ.Nodes.outline),i=[];return i.push(this.outlineColor.build(t,"c")),i.push(this.contourColor.build(t,"c")),i.push(this.outlineWidth.build(t,"f")),i.push(this.contourWidth.build(t,"f")),i.push(this.contourThreshold.build(t,"f")),i.push(this.outlineThreshold.build(t,"f")),i.push(this.contourFrequency.build(t,"f")),i.push(this.outlineSmoothing.build(t,"f")),i.push(this.contourDirection.build(t,"v3")),i.push(this.positionalLines.build(t,"b")),i.push(this.resolution.build(t,"v2")),i.push(this.normalMap.getTexture(t,"t")),i.push(this.depthMap.getTexture(t,"t")),i.push(this.pixelRatio.build(t,"f")),i.push(this.compensation.build(t,"b")),i.push(this.alpha.build(t,"f")),i.push(this.calpha),this.firstTime=!this.firstTime,t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("OutlineNode is not compatible with "+t.shader+" shader."),""}},tZ=eZ;tZ.Nodes=function(){let t=new wt(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 texelSize = (vec2(1.0) / resolution) * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -texelSize.x, -texelSize.y);
	uvSamples[1] = uv + vec2(0.0, -texelSize.y);
	uvSamples[2] = uv + vec2(  texelSize.x, -texelSize.y);
	uvSamples[3] = uv + vec2( -texelSize.x, 0.0);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  texelSize.x, 0.0);
	uvSamples[6] = uv + vec2( -texelSize.x, texelSize.y);
	uvSamples[7] = uv + vec2(0.0, texelSize.y);
	uvSamples[8] = uv + vec2(  texelSize.x, texelSize.y);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec4 sobel_edge_h = normalSamples[2] + (2.0*normalSamples[5]) + normalSamples[8] - (normalSamples[0] + (2.0*normalSamples[3]) + normalSamples[6]);
  	vec4 sobel_edge_v = normalSamples[0] + (2.0*normalSamples[1]) + normalSamples[2] - (normalSamples[6] + (2.0*normalSamples[7]) + normalSamples[8]);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new wt(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
                 return result;
             }`,[t])}}();var nZ=class extends Gn{constructor(t,e,n,i,r,s,o,a){super("v3"),this.nodeType="Transmission",this.thickness=t,this.ior=e,this.roughness=n,this.transmissionSamplerSize=i,this.transmissionSamplerMap=r,this.transmissionDepthMap=s,this.aspectRatio=o,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.extensions.shaderTextureLOD=!0,t.extensions.derivatives=!0,t.isShader("fragment")){t.define("NUM_SAMPLES",30),t.require("worldPosition"),t.requires.worldNormal=!0,t.requires.modelMatrix=!0,t.requires.projectionMatrix=!0,t.addFragmentVariable(this.calpha,"float");let n=t.include(nZ.Nodes.transmission),i=[];return i.push(this.thickness.build(t,"f")),i.push(this.ior.build(t,"f")),i.push(this.roughness.build(t,"f")),i.push(this.transmissionSamplerSize.build(t,"v2")),i.push(this.transmissionSamplerMap.getTexture(t,"t")),i.push(this.transmissionDepthMap.getTexture(t,"t")),i.push(this.aspectRatio.build(t,"v2")),i.push("normal"),i.push(this.alpha.build(t,"f")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("TransmissionNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},iZ=nZ;iZ.Nodes=function(){let t=new wt(`
            float gaussian(vec2 i) {
                const float sigma = float(NUM_SAMPLES) * .25;
                return exp( -.5* dot(i/=sigma,i) ) / ( 6.28 * sigma*sigma );
            }`),e=new wt(`
            vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

                const int LOD = 2;
                const int sLOD = 4; // tile size = 2^LOD

                vec3 O = vec3(0);
                float a = 0.0;
                const int s = NUM_SAMPLES/sLOD;
                for ( int i = 0; i < s*s; i++ ) {
                    int modulo = (i)-((i)/(s))*(s);
                    vec2 d = vec2(float(modulo), float(i/s))*float(sLOD) - float(NUM_SAMPLES)/2.;
                    vec2 uv = U + (scale * aspectRatio) * d;
                    // What is the depth of the opaque object we're trying to sample
                    float opaqueDepth = unpackRGBAToDepth(texture2D(dm, uv));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU + ((scale * min(lod / 2., 1.)) * aspectRatio) * d;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    float gaussian = gaussian(d);
		            #ifdef TEXTURE_LOD_EXT
                    O += gaussian * texture2DLodEXT( sp, uv, lod).rgb;
                    #else
                    O += gaussian * textureLod( sp, uv, lod).rgb;
                    #endif
                    a += gaussian;
                }
                return O / a;
            }`,[t]),n=new wt(`
            vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        // Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		        // The thickness is specified in local space.
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),i=new wt(`
float applyIorToRoughness( float roughness, float ior ) {
		// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
		// an IOR of 1.5 results in the default amount of microfacet refraction.
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	} `),r=new wt(`
vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
        float lod = applyIorToRoughness(roughness, ior);

        return blur(transmissionSamplerMap, fragCoord, vec2(lod / (transmissionSamplerSize.x / 2.)), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
	}`,[i,e]),s=new wt(`
vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
        vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
        vec3 refractedRayExit = position + transmissionRay;

        // Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
        vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
        vec2 refractionCoords = ndcPos.xy / ndcPos.w;
        refractionCoords += 1.0;
        refractionCoords /= 2.0;

        vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
        vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
        unrefractedCoords += 1.0;
        unrefractedCoords /= 2.0;

        // Sample framebuffer to get pixel the refracted ray hits.
        return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    }`,[r,n]);return{transmission:new wt(`
            vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                float lalpha = alpha;

                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
                 return transmission;
            }`,[s])}}();var iy=class extends Gn{constructor(t,e,n,i,r,s,o,a,l,c,h){super("v3"),this.nodeType="Depth",this.gradientType=t,this.smooth=e,this.near=n,this.far=i,this.isVector=r,this.isWorldSpace=s,this.origin=o,this.direction=a,this.colors=l,this.steps=c,this.alpha=h,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){let n=`g${this.uuid.toString().replace(/-/g,"")}`,i=new wt(`vec3 ${n}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${n}_MAX_COLORS], float steps[${n}_MAX_COLORS], float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${n}_IS_VECTOR
                   #ifdef ${n}_LINEAR
                       #ifdef ${n}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${n}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${n}_SMOOTH
				for ( int i = 1; i < ${n}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${n}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a;
               calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );

			   accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
               return color.rgb;
			}`,[iy.Nodes.vectorLinearWorldSpaceDepth,iy.Nodes.vectorLinearObjectSpaceDepth,iy.Nodes.vectorSphericalObjectSpaceDepth,iy.Nodes.vectorSphericalWorldSpaceDepth]);if(t.isShader("fragment")){t.define(`${n}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&t.define(`${n}_SMOOTH`),this.isVector.value>.5&&t.define(`${n}_IS_VECTOR`),this.gradientType.value===0&&t.define(`${n}_LINEAR`),this.isWorldSpace.value>.5&&t.define(`${n}_WORLDSPACE`),t.require("worldPosition"),t.addFragmentVariable(this.calpha,"float");let r=t.include(i),s=[];return s.push(this.near.build(t,"f")),s.push(this.far.build(t,"f")),s.push(this.origin.build(t,"v3")),s.push(this.direction.build(t,"v3")),s.push(this.colors.build(t,"v4[]")),s.push(this.steps.build(t,"f[]")),s.push(this.alpha.build(t,"f")),s.push(this.calpha),t.format(r+"("+s.join(",")+")",this.getType(t),e)}else return console.warn("DepthNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},rZ=iy;rZ.Nodes=function(){let t=new wt(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),e=new wt(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),n=new wt(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),i=new wt(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:t,vectorLinearObjectSpaceDepth:e,vectorSphericalWorldSpaceDepth:n,vectorSphericalObjectSpaceDepth:i}}();var Yj=class extends Gn{constructor(t,e,n,i){super("v3"),this.nodeType="Blend",this.a=t,this.b=e,this.alpha=n,this.mode=i}generate(t,e){if(t.isShader("fragment")){let n=[];return n.push(this.a.build(t,"c")),n.push(this.b.build(t,"c")),n.push(this.alpha.build(t,"f")),n.push(this.mode.build(t,"i")),t.format("spe_blend("+n.join(",")+")",this.getType(t),e)}else return console.warn("BlendNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},AI=(t=>(t.NOISE="noise",t.MAP="map",t))(AI||{}),sZ=class extends Gn{constructor(t,e,n,i,r){super("v3"),this.displacementTypeIndex=new On(0),this.nodeType="VertexDisplacement",this.intensity=t,this.movementOrTexture=e,Object.values(AI)[this.displacementTypeIndex.value]==="map"&&(this.mat=new qJ(this.movementOrTexture.value.matrix)),this.cropOrOffset=n,this.scale=i,this.noiseFunctionIndex=r}generate(t,e){if(t.isShader("vertex")){t.define("USE_LAYER_DISPLACE");let n,i=[];switch(i.push("displaced_position"),i.push("displaced_normal"),Object.values(AI)[this.displacementTypeIndex.value]){case"map":{n=t.include(sZ.Nodes.map),i.push(this.movementOrTexture.getTexture(t,"t")),i.push("uv"),i.push(this.cropOrOffset.build(t,"f")),this.mat&&i.push(this.mat.build(t,"mat3"));break}case"noise":{let r=Object.values(vF)[this.noiseFunctionIndex.value],s=new wt(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),o=new wt(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement) {
							return p + n * ${r}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
						}`,[ea.simplex,ea.simplexFractal,ea.simplexAshima,ea.fbm,ea.perlin]),a=new wt(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[o,s]);n=t.include(a),i.push(this.scale.build(t,"f")),i.push(this.cropOrOffset.build(t,"v3")),i.push(this.movementOrTexture.build(t,"f"));break}}return i.push(this.intensity.build(t,"f")),i.push("displaced_normal"),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("VertexDisplacementNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},oZ=sZ;oZ.Nodes=function(){let t=new wt(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),e=new wt(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new wt(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[t,e])}}();var aZ=class extends Gn{constructor(t,e,n,i,r,s,o,a){super("v3"),this.nodeType="Gradient",this.gradientType=t,this.smooth=e,this.colors=n,this.steps=i,this.offset=r,this.morph=s,this.angle=o,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.define("GRAD_MAX",10),t.require("uv"),t.requires.uv=[!0],t.addFragmentVariable(this.calpha,"float");let n=t.include(aZ.Nodes.gradient),i=[];return i.push(this.gradientType.build(t,"i")),i.push(this.smooth.build(t,"b")),i.push(this.colors.build(t,"v4[]")),i.push(this.steps.build(t,"f[]")),i.push(this.offset.build(t,"v2")),i.push(this.morph.build(t,"v2")),i.push(this.angle.build(t,"f")),i.push(this.alpha.build(t,"f")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("GradientNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},lZ=aZ;lZ.Nodes=function(){return{gradient:new wt(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return color.xyz;
			}`)}}();var Db=class extends Gn{constructor(t,e,n,i,r,s,o,a,l,c){super("v3"),this.nodeType="CustomTexture",this.firstTime=!0,this.texture=t,this.textureSize=e,this.crop=n,this.projection=i,this.axis=r,this.side=s,this.size=o,this.mat=a,this.alpha=l,this.mode=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){t.require("position"),t.require("normal"),t.require("uv"),t.requires.uv=[!0],t.extensions.shaderTextureLOD=!0,t.extensions.derivatives=!0;let n=`g${this.uuid.toString().replace(/-/g,"")}`,i;switch(this.projection.value){case 3:i=t.include(Db.Nodes.cylindrical);break;case 2:i=t.include(Db.Nodes.spherical);break;case 1:let s=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],o=new wt(`
		vec3 ${n}_planarTexture(sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float alpha, int mode, out float calpha) {

				vec2 uvs = ( mat * vec3( (${n}_vCustomUv * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, mat * ${s}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return col;
			}`);i=t.include(o);break;default:i=t.include(Db.Nodes.uv);break}if(this.projection.value===1&&this.firstTime){t.addVertexParsCode(`varying vec2 ${n}_vCustomUv;`),t.addFragmentParsCode(`varying vec2 ${n}_vCustomUv;`);let s=["zy","xz","xy"][this.axis.value];t.addVertexFinalCode(`${n}_vCustomUv = (1. + (transformed.${s})) / 2.;`)}t.addFragmentVariable(this.calpha,"float");let r=[];return r.push(this.texture.generate(t,"t")),r.push(this.textureSize.build(t,"v2")),r.push(this.crop.build(t,"f")),r.push(this.mat.build(t,"mat3")),r.push(this.size.build(t,"v2")),r.push(this.alpha.build(t,"f")),r.push(this.mode.build(t,"i")),r.push(this.calpha),this.firstTime=!this.firstTime,t.format(i+"("+r.join(",")+")",this.getType(t),e)}},cZ=Db;cZ.Nodes=function(){let t=new wt(`
vec3 cylindricalTexture(sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float alpha, int mode, out float calpha) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return col;
			}
`),e=new wt(`
vec3 sphericalTexture(sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float alpha, int mode, out float calpha) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return col;
			}
`),n=new wt(`vec3 uvTexture(sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float alpha, int mode, out float calpha) {

				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return col;
			}`);return{cylindrical:t,spherical:e,uv:n}}();var uZ=class extends Gn{constructor(t,e){super("v3"),this.nodeType="CustomNormal",this.cnormal=t,this.alpha=e}generate(t,e){if(t.isShader("fragment")){let n=t.include(uZ.Nodes.customNormal),i=[];return i.push(this.cnormal.build(t,"v3")),i.push("normal"),i.push(this.alpha.build(t,"f")),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("CustomNormalNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},hZ=uZ;hZ.Nodes=function(){return{customNormal:new wt(`vec3 customNormal(vec3 cnormal, vec3 norm, float alpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return normal;
			}`)}}();function uo(t,e){return e.color(t)}function rBe(t,e){switch(t.type){case"fresnel":return aBe(t,e);case"gradient":return lBe(t);case"depth":return cBe(t);case"normal":return uBe(t);case"noise":return hBe(t,e);case"rainbow":return dBe(t);case"toon":return fBe(t,e);case"outline":return pBe(t,e);case"transmission":return mBe(t);case"color":return oBe(t,e)}}function sBe(t){return{type:t.type}}function ic(t){let{alpha:e,mode:n}=t;return{...sBe(t),alpha:e,mode:n}}function oBe(t,e){return{...ic(t),color:uo(t.color,e)}}function aBe(t,e){let{bias:n,scale:i,intensity:r,factor:s,color:o}=t;return{...ic(t),color:uo(o,e),bias:n,scale:i,intensity:r,factor:s}}function lBe(t){let{gradientType:e,smooth:n,colors:i,steps:r,angle:s,offset:o,morph:a}=t;return{...ic(t),gradientType:e,smooth:n,colors:i.map(l=>new Zt(l[0],l[1],l[2],l[3])),num:i.length,steps:r,offset:new Se(...o),morph:new Se(...a),angle:s}}function cBe(t){let{gradientType:e,near:n,far:i,isVector:r,isWorldSpace:s,origin:o,direction:a,colors:l,steps:c,smooth:h}=t;return{...ic(t),gradientType:e,near:n,far:i,isVector:r,isWorldSpace:s,origin:new N(...o),direction:a?new N(...a):new N(1,0,0),colors:l.map(u=>u!==void 0?new Zt(u[0],u[1],u[2],u[3]):new Zt(0,0,0,0)),steps:c.slice(0,l.length),smooth:h}}function uBe(t){let{cnormal:e}=t;return{...ic(t),cnormal:new N(e[0],e[1],e[2])}}function hBe(t,e){return{...ic(t),scale:t.scale,move:t.move,fA:new Se(...t.fA),fB:new Se(...t.fB),size:new N(...t.size),distortion:new Se(...t.distortion),colorA:uo(t.colorA,e),colorB:uo(t.colorB,e),colorC:uo(t.colorC,e),colorD:uo(t.colorD,e),noiseType:t.noiseType}}function dBe(t){return{...ic(t),filmThickness:t.filmThickness,movement:t.movement,wavelengths:new N(...t.wavelengths),noiseStrength:t.noiseStrength,noiseScale:t.noiseScale,offset:new N(...t.offset)}}function fBe(t,e){return{...ic(t),positioning:t.positioning,colors:t.colors.map(n=>new Zt(n[0],n[1],n[2],n[3])),num:t.colors.length,steps:t.steps,source:new N(...t.source),isWorldSpace:t.isWorldSpace,noiseStrength:t.noiseStrength,noiseScale:t.noiseScale,shadowColor:uo(t.shadowColor,e),offset:new N(...t.offset)}}function pBe(t,e){return{...ic(t),outlineColor:uo(t.outlineColor,e),contourColor:uo(t.contourColor,e),outlineWidth:t.outlineWidth,contourWidth:t.contourWidth,outlineThreshold:t.outlineThreshold,contourThreshold:t.contourThreshold,outlineSmoothing:t.outlineSmoothing,contourFrequency:t.contourFrequency,contourDirection:new N(...t.contourDirection),positionalLines:t.positionalLines,compensation:t.compensation}}function mBe(t,e){return{...ic(t),thickness:t.thickness,ior:t.ior,roughness:t.roughness}}var sM=class extends Ns{},gBe=class{constructor(t=1e3*10){this.timeout=t,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...t){}remove(t){let e=this.cache.get(t);e&&(this.dispose(t,e.data),this.cache.delete(t),e.prev.next=e.next,e.next.prev=e.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let t=Date.now(),e=this.head.next;for(;e.time<t-this.timeout;)this.dispose(e.src,e.data),this.cache.delete(e.src),e=e.next,e.prev=this.head,this.head.next=e;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(t){var e;return(e=this.cache.get(t))==null?void 0:e.data}load(t){let e=Date.now(),n=this.cache.get(t);return n===void 0?(n={data:this.create(t),src:t,time:e,next:null,prev:null},this.cache.set(t,n)):(n.time=e,n.prev.next=n.next,n.next.prev=n.prev),n.prev=this.tail.prev,n.next=this.tail,this.tail.prev.next=n,this.tail.prev=n,this.scheduleCleanup(),n.data}},vBe=class extends gBe{create(t){return URL.createObjectURL(new Blob([t]))}dispose(t,e){URL.revokeObjectURL(e)}},O2;function yBe(t){return typeof t=="string"?t:(O2||(O2=new vBe),O2.load(t))}var xBe=class{constructor(t,e){this.data=t,this.cache=e,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},_Be=class{constructor(){this.cache=new Map}remove(t){this.cache.delete(t.data)}load(t){let e=this.cache.get(t);return e===void 0&&(e=this.create(t),this.cache.set(t,e)),e.refCount+=1,e}},dZ=class extends xBe{constructor(t,e){super(t,e.imageHolderCache),this.data=t,this.shared=e,this.loaded=!1,this.isVideo=!1,this.isVideo=t.type=="video",this.updateSrc(t.data)}async updateSrc(t){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let e=()=>{this.loaded=!0;let i=[1e3,1001,1002];for(let r of i){let s=this[r];s&&(s.image=this.img,s.needsUpdate=!0)}this.shared.requestRender()};if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof t!="string"){var n=new FileReader;n.readAsDataURL(new Blob([t],{type:"video/mp4"}));let i;await new Promise(r=>{n.onloadend=s=>{var o;i=(o=s.target)==null?void 0:o.result,r(null)}}),this.img.src=i}else this.img.src=t;this.img.onloadeddata=()=>{e()}}else this.img=new Image,this.img.src=yBe(t),this.img.onload=e}getTexture(t){let e=this[t];if(e)return e;{let n;return this.isVideo?n=new dbe(this.img,void 0,t,t):n=new _r(this.img,void 0,t,t),this.loaded&&(n.needsUpdate=!0),this[t]=n,n}}disposeTextures(){var t,e,n;(t=this[1e3])==null||t.dispose(),this[1e3]=void 0,(e=this[1001])==null||e.dispose(),this[1001]=void 0,(n=this[1002])==null||n.dispose(),this[1002]=void 0}dispose(){super.dispose(),this.disposeTextures()}},nf=class extends dZ{},yF=class extends bo{},fZ={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],depth:["smooth","isWorldSpace","gradientType","isVector"]},pZ={depth:["colors"]};function wBe(t,e,n){var s,o;let i=fZ[t.type],r=pZ[t.type];if(r!==void 0){let a=t.color;if(r.includes(e)){let l=(o=(s=a[e])==null?void 0:s.value)==null?void 0:o.length;if(l!==void 0&&l!==n.length)return!0}}return i!==void 0?i.includes(e):!1}function mZ(t,e,n){let i=n.uniforms[`f${n.id}_texture`];if(!i)return!1;let r=!1,s=t;if("image"in s){let o=s.image,a=e.image(o),l=i;l.image instanceof nf||l.image.deref(),l.image=a}if("video"in s){let o=s.video,a=e.video(o),l=i;l.image instanceof nf||l.image.deref(),l.image=a}if("wrapping"in s){let o=i;o.wrap=s.wrapping}if("repeat"in s||"offset"in s){let o="mat",a=n.uniforms[`f${n.id}_${o}`];"repeat"in s&&(a.repeat=s.repeat),"offset"in s&&(a.offset=s.offset),a.updateMatrix()}return r}function SBe(t,e,n,i){let r=!1;for(let[s,o]of Object.entries(t)){if(!s||o===void 0)continue;if(wZ(s,n,i)){s==="visible"&&n.type==="light"&&(r=!0);continue}n.visible=i.visible;let a=n.uniforms[`f${n.id}_${s}`];if(a&&!(a instanceof yF))switch(r=r||wBe(n,s,o),a.constructor){case wi:if(typeof o=="string"){let l=e.getColor(o);l&&(a.value=l);break}else{let l=o;a.value instanceof sM?a.value=new Ns(l.r,l.g,l.b,l.a):a.setRGBA(l);break}case Wd:if(typeof o=="string"){let l=e.getColor(o);l&&(a.value=l);break}else{let l=o;a.value instanceof sM?a.value=new Ns(l.r,l.g,l.b,l.a):a.value.setRGBA(l.r,l.g,l.b,l.a);break}case qo:{let l=o;a.value.setX(l[0]),a.value.setY(l[1]);break}case Vo:{let l=o;a.value.setX(l[0]),a.value.setY(l[1]),a.value.setZ(l[2]);break}case mh:{mZ(o,e,n);break}case kd:{a.value=o.map(l=>new Zt(...l));break}default:{a.value=o;break}}}return r}var gZ=class extends Gn{constructor(t,e,n){super("v3"),this.nodeType="Matcap",this.texture=t,this.alpha=e,this.mode=n,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.isShader("fragment")){t.addFragmentVariable(this.calpha,"float");let n=t.include(gZ.Nodes.matcap);t.require("normal"),t.requires.normal=!0;let i=[];return i.push(this.texture.generate(t,"t")),i.push("normal"),i.push(this.alpha.build(t,"f")),i.push(this.mode.build(t,"i")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("MatcapNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},vZ=gZ;vZ.Nodes=function(){return{matcap:new wt(`vec3 matcap(sampler2D matcapTex, vec3 normal, float alpha, int mode, out float calpha) {
                vec3 viewDir = normalize( vViewPosition );
                vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
                vec3 y = cross( viewDir, x );
                vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks
                vec4 matcapColor = texture2D( matcapTex, uv );

                calpha =  alpha / clamp( alpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;
                
                return matcapColor.rgb;
            }
            `)}}();var MI=class extends yF{constructor(t,e){super("t"),this.image=t,this.wrap=e}get value(){return this.image.getTexture(this.wrap)}},bBe=class extends yF{constructor(t){super("v3"),this.image=t,this._value=new N}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},yZ=class extends Gn{constructor(t,e,n,i,r,s,o,a,l,c){super("v3"),this.nodeType="Toon",this.positioning=t,this.colors=e,this.steps=n,this.source=i,this.isWorldSpace=r,this.noiseStrength=s,this.noiseScale=o,this.shadowColor=a,this.offset=l,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(t,e){if(t.require("worldNormal"),t.require("worldPosition"),t.isShader("fragment")){t.define("COLORS_MAX",10),t.addFragmentVariable(this.calpha,"float");let n=t.include(yZ.Nodes.toon),i=[];return i.push(this.positioning.build(t,"i")),i.push(this.colors.build(t,"v4[]")),i.push(this.steps.build(t,"f[]")),i.push(this.source.build(t,"v3")),i.push(this.isWorldSpace.build(t,"b")),i.push(this.noiseStrength.build(t,"f")),i.push(this.noiseScale.build(t,"f")),i.push(this.shadowColor.build(t,"v4")),i.push(this.offset.build(t,"v3")),i.push(this.alpha.build(t,"f")),i.push(this.calpha),t.format(n+"("+i.join(",")+")",this.getType(t),e)}else return console.warn("ToonNode is not compatible with "+t.shader+" shader."),t.format("vec3( 0.0 )",this.getType(t),e)}},xZ=yZ;xZ.Nodes=function(){let t=new wt(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),e=new wt(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),n=new wt(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[e]),i=new wt(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),r=new wt(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[i]);return{toon:new wt(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplex3d(st),
					// 	simplex3d(st + vec3(111.1, 143.89, 217.19)),
					// 	simplex3d(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[ea.simplex,t,n,r])}}();function qj(t,e,n){t.setUvTransform(n[0],n[1],e[0],e[1],0,0,0)}var ABe=class extends qJ{constructor(t,e){super(new Pr),this.repeat=t,this.offset=e,qj(this.value,t,e)}updateMatrix(){qj(this.value,this.repeat,this.offset)}},_f=class{constructor(t,e,n,i){this.id=t,this.uuid=e,this.data=n,this.uniforms={};for(let r in i)this.uniforms[`f${this.id}_${r}`]=i[r];for(let r in n)wZ(r,this,n)}get type(){return this.data.type}static create(t,e,n,i){if(n.type==="light")return jm.createLigherLayer(t,e,n,i);if(n.type==="texture"||n.type==="video"){let r=n.type==="texture"?i.image(n.texture.image):i.video(n.texture.video),s=new MI(r,n.texture.wrapping),o=new bBe(r),a=new ABe(n.texture.repeat,n.texture.offset),l=new gt(n.crop?1:0),c=new On(n.projection??0),h=new On(["x","y","z"].indexOf(n.axis)??0),u=new On(n.side??0),d=new qo(n.size?new Se(n.size[0],n.size[1]):new Se(100,100)),f=new gt(n.alpha??1),p=new On(n.mode??0),v=new cZ(s,o,l,c,h,u,d,a,f,p),g=new qn(v.calpha,"f");return new Er(t,e,n,{texture:s,textureSize:o,crop:l,projection:c,axis:h,side:u,size:d,mat:a,alpha:f,mode:p},v,p,g)}else if(n.type==="matcap"){let r=i.image(n.texture.image),s=new MI(r,n.texture.wrapping),o=new gt(n.alpha??1),a=new On(n.mode??0),l=new vZ(s,o,a),c=new qn(l.calpha,"f");return new Er(t,e,n,{texture:s,alpha:o,mode:a},l,a,c)}else if(n.type==="displace")if(n.displacementType==="noise"){let r=new Vo(new N(...n.offset)),s=new gt(n.scale??10),o=new gt(n.intensity??8),a=new gt(n.movement??1),l=new On(n.noiseType??0),c=new oZ(o,a,r,s,l);return new _Z(t,e,n,{offset:r,scale:s,intensity:o,movement:a,noiseType:l},c)}else throw new Error;else return CBe(t,e,n,i)}updateByOp(t,e,n){var r;let i=t;if(i.path[0]===void 0){if(i.type===0)return"type"in i.props||"category"in i.props||"visible"in i.props?((r=n.scene)==null||r.markNeedsUpdateRendererDirty(),!0):SBe(i.props,n.shared,this,e)}else if(i.path[0]==="texture")return"texture"in e||"video"in e?mZ(i.props,n.shared,this):!0;return!1}dispose(){if(MBe(this)){let t=this.uniforms[`f${this.id}_texture`];if(!t)return!1;let e=t;e.image instanceof nf||e.image.deref()}}hasValueByKey(t){return this.uniforms[t]!==void 0}hasValue(t){return this.hasValueByKey(`f${this.id}_${t}`)}setValue(t,e){let n=`f${this.id}_${t}`;this.hasValueByKey(n)&&e!==void 0&&(this.uniforms[n].value=e)}getNode(t){let e=`f${this.id}_${t}`;if(this.hasValueByKey(e))return this.uniforms[e]}getValue(t){let e=`f${this.id}_${t}`;if(this.hasValueByKey(e))return this.uniforms[e].value}getName(t){let e=/f\d+_(.*)/.exec(t);if(e&&e.length>1)return e[1];console.log(`Layer.getName: error ${t}`)}getNames(){let t=[];for(let e in this.uniforms){let n=this.getName(e);n&&t.push(n)}return t}},Er=class extends _f{constructor(t,e,n,i,r,s,o){super(t,e,n,i),this.params=i,this.color=r,this.mode=s,this.alpha=o}},_Z=class extends _f{constructor(t,e,n,i,r){super(t,e,n,i),this.position=r}},jm=class extends _f{constructor(t,e,n,i,r){super(t,e,n,r),this.node=i}static createLigherLayer(t,e,n,i){let r,s=new gt(n.alpha),o=new On(n.mode),a;if(!n.visible)r=new YJ,a={};else if(n.category==="lambert"){r=new eBe;let l=new wi(i.color(n.emissive)??0);a={emissive:l},r.emissive=l}else if(n.category==="toon"){r=new iBe;let l=new gt(n.shininess??30),c=new wi(i.color(n.specular)??1118481);a={shininess:l,specular:c},r.shininess=l,r.specular=c}else if(n.category==="physical"){r=new nBe;let l=new gt(n.roughness??.3),c=new gt(n.metalness??0),h=new gt(n.reflectivity??.5);a={roughness:l,metalness:c,reflectivity:h},r.roughness=l,r.metalness=c,r.reflectivity=h}else{r=new tBe;let l=new gt(n.shininess??30),c=new wi(n.specular!==void 0?i.color(n.specular)??1118481:1118481);a={shininess:l,specular:c},r.shininess=l,r.specular=c}return r.alpha=new gt(1),r.shadingAlpha=s,r.shadingBlend=o,a.alpha=r.shadingAlpha,a.mode=r.shadingBlend,new jm(t,e,n,r,a)}get category(){return this.node.category}};function MBe(t){let e=t instanceof _f?t.type:t;return e==="texture"||e==="video"||e==="displace_map"||e==="matcap"}function EBe(t,e,n,i){switch(t.type){case"color":{let r=new wi(i.color??5526619),s=new gt(i.alpha??1),o=new qn("alpha / clamp(alpha + accumAlpha, 0.00001, 1.0 )","f");o.keywords.alpha=s;let a=new On(i.mode??0);return r.alpha=s,new Er(e,n,t,{color:r,alpha:s,mode:a},r,a,o)}case"fresnel":{let r=new wi(i.color??16777215),s=new gt(i.bias??.1),o=new gt(i.scale??1),a=new gt(i.intensity??2),l=new gt(i.factor??1),c=new gt(i.alpha??1),h=new On(i.mode??0),u=new JJ(r,s,o,a,l,c,h),d=new qn(u.calpha,"f");return new Er(e,n,t,{color:r,bias:s,scale:o,intensity:a,factor:l,alpha:c,mode:h},u,h,d)}case"rainbow":{let r=new gt(i.filmThickness??30),s=new gt(i.movement??0),o=new Vo(i.wavelengths??new N(0,0,0)),a=new gt(i.noiseStrength??0),l=new gt(i.noiseScale??1),c=new Vo(i.offset??new N(0,0,0)),h=new gt(i.alpha??1),u=new $J(r,s,o,a,l,c,h),d=new qn(u.calpha,"f"),f=new On(i.mode??0);return new Er(e,n,t,{filmThickness:r,movement:s,wavelengths:o,noiseStrength:a,noiseScale:l,offset:c,alpha:h,mode:f},u,f,d)}case"transmission":{let r=new gt(i.thickness??10),s=new gt(i.ior??1.5),o=new gt(i.roughness??.5),a=ei.transmissionSize,l=ei.transmissionRenderTarget,c=ei.transmissionRenderTargetDepth,h=window.innerWidth,u=window.innerHeight,d=h>=u?new qo(u/h,1):new qo(1,h/u),f=new gt(i.alpha??1),p=new iZ(r,s,o,a,l,c,d,f),v=new qn(p.calpha,"f"),g=new On(i.mode??0);return new Er(e,n,t,{thickness:r,ior:s,roughness:o,aspectRatio:d,alpha:f,mode:g},p,g,v)}case"toon":{let r=new On(i.positioning??0),s;i.colors?s=new kd(i.colors.length,i.colors):(s=new kd(10,new Zt(0,0,0,1)),s.value[1]=new Zt(1,1,1,1));let o;i.steps?o=new Ud(i.steps.length,i.steps):(o=new Ud(10,1),o.value[0]=0);let a=new Vo(i.source??new N(0,0,0)),l=new I0(i.isWorldSpace??!0),c=new gt(i.noiseStrength??0),h=new gt(i.noiseScale??1),u=new Wd(i.shadowColor),d=new Vo(i.offset??new N(0,0,0)),f=new gt(i.alpha??1),p=new xZ(r,s,o,a,l,c,h,u,d,f),v=new qn(p.calpha,"f"),g=new On(i.mode??0);return new Er(e,n,t,{positioning:r,colors:s,steps:o,source:a,isWorldSpace:l,noiseStrength:c,noiseScale:h,shadowColor:u,offset:d,alpha:f,mode:g},p,g,v)}case"outline":{let r=new wi(i.outlineColor??16777215),s=new wi(i.contourColor??16777215),o=new gt(i.outlineWidth??.1),a=new gt(i.contourWidth??.1),l=new gt(i.outlineThreshold??.1),c=new gt(i.contourThreshold??.1),h=new gt(i.outlineSmoothing??.1),u=new gt(i.contourFrequency??.1),d=new Vo(i.contourDirection??new N(0,1,0)),f=new I0(i.positionalLines??!1),p=new I0(i.compensation??!0),v=ei.normalRenderTarget,g=ei.normalRenderTargetDepth,m=ei.pixelRatioNode,y=ei.resolution,_=new gt(i.alpha??1),S=new tZ(r,s,o,a,l,c,h,u,d,f,p,y,v,g,m,_),A=new qn(S.calpha,"f"),b=new On(i.mode??0);return new Er(e,n,t,{outlineColor:r,contourColor:s,outlineWidth:o,contourWidth:a,outlineThreshold:l,contourThreshold:c,outlineSmoothing:h,contourFrequency:u,contourDirection:d,positionalLines:f,compensation:p,alpha:_,mode:b},S,b,A)}case"depth":{let r=new On(i.gradientType??0),s=new I0(i.smooth??!1),o=new gt(i.near??50),a=new gt(i.far??200),l=new gt(i.isVector??1),c=new gt(i.isWorldSpace??0),h=new Vo(i.origin??new N),u=new Vo(i.direction??new N),d;i.colors?d=new kd(i.colors.length,i.colors):(d=new kd(2,new Zt(0,0,0,1)),d.value[1]=new Zt(1,1,1,1));let f;i.steps?f=new Ud(i.steps.length,i.steps):(f=new Ud(2,1),f.value[0]=0);let p=new gt(i.alpha??1),v=new On(i.mode??0),g=new rZ(r,s,o,a,l,c,h,u,d,f,p),m=new qn(g.calpha,"f");return new Er(e,n,t,{gradientType:r,smooth:s,near:o,far:a,isVector:l,isWorldSpace:c,origin:h,direction:u,colors:d,steps:f,alpha:p,mode:v},g,v,m)}case"noise":{let r=new gt(i.scale??1),s=new Vo(i.size??new N(100,100,100)),o=new gt(i.move??1),a=new qo(i.fA??new Se(1.7,9.2)),l=new qo(i.fB??new Se(8.3,2.8)),c=new qo(i.distortion??new Se(1,1)),h=new Wd(i.colorA),u=new Wd(i.colorB),d=new Wd(i.colorC),f=new Wd(i.colorD),p=new gt(i.alpha??1),v=new On(i.mode??0),g=new On(i.noiseType??0),m=new QJ(r,s,o,a,l,c,h,u,d,f,p,g),y=new qn(m.calpha,"f");return new Er(e,n,t,{scale:r,size:s,move:o,fA:a,fB:l,distortion:c,colorA:h,colorB:u,colorC:d,colorD:f,alpha:p,mode:v,noiseType:g},m,v,y)}case"normal":{let r=new Vo(i.cnormal??new N(1,1,1)),s=new gt(i.alpha??1),o=new On(i.mode??0),a=new hZ(r,s),l=new qn("alpha / clamp(alpha + accumAlpha, 0.00001, 1.0 )","f");return l.keywords.alpha=s,new Er(e,n,t,{cnormal:r,alpha:s,mode:o},a,o,l)}case"gradient":{let r=new On(i.gradientType??0),s=new I0(i.smooth??!1),o;i.colors?o=new kd(i.colors.length,i.colors):(o=new kd(10,new Zt(0,0,0,1)),o.value[1]=new Zt(1,1,1,1));let a;i.steps?a=new Ud(i.steps.length,i.steps):(a=new Ud(10,1),a.value[0]=0);let l=new qo(i.offset??new Se(0,0)),c=new qo(i.morph??new Se(0,0)),h=new gt(i.angle??0),u=new gt(i.alpha??1),d=new On(i.mode??0),f=new lZ(r,s,o,a,l,c,h,u),p=new qn(f.calpha,"f");return new Er(e,n,t,{gradientType:r,smooth:s,colors:o,steps:a,offset:l,morph:c,angle:h,alpha:u,mode:d},f,d,p)}default:{let r=new wi(1,0,0,1),s=new gt(1),o=new qn("alpha / clamp(alpha + accumAlpha, 0.00001, 1.0 )","f");o.keywords.alpha=s;let a=new On(0);return r.alpha=s,new Er(e,n,t,{color:r,alpha:s,mode:a},r,a,o)}}}function CBe(t,e,n,i){let r=rBe(n,i);return EBe(n,t,e,r)}function wZ(t,e,n){if(n.type==="displace"&&(t==="intensity"||t==="visible")){let i=e.uniforms[`f${e.id}_intensity`];return i?(i.value=n.intensity*(n.visible?1:0),i):void 0}if(n.type!=="displace"&&(t==="alpha"||t==="visible")){let i=e.uniforms[`f${e.id}_alpha`];if(!i)return;if(i.value=n.alpha*(n.visible?1:0),n.type==="outline"&&t==="visible"){let r=e.uniforms[`f${e.id}_compensation`];r&&(r.value=n.compensation&&n.visible)}return i}}function oM(t,e){let n=0;for(let i of t.layers)if(i.data.type!=="displace"&&"alpha"in i.data&&i.data.type!=="light"&&i.data.type!=="fresnel"&&i.data.type!=="texture"&&i.data.type!=="matcap"&&i.data.type!=="rainbow"&&i.data.type!=="outline"){let r=i.data.visible?i.data.alpha:0;if(r===1&&i.data.type==="depth"||i.data.type==="gradient"){for(let s of i.data.colors)if(s[3]<1){r=s[3];break}}else if(r===1&&i.data.type==="noise"){let s=e.color(i.data.colorA).a,o=e.color(i.data.colorB).a,a=e.color(i.data.colorC).a,l=e.color(i.data.colorD).a,c=Math.min(s,Math.min(o,Math.min(a,l)));c<1&&(r=c)}n+=(1-n)*r}return n<1}var jh=class extends nr{constructor(){super(void 0),this.flatShading=!1,this.cacheKey="",this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return this.cacheKey}},TBe=class extends jh{constructor(t,e,n,i){super(),this.flatShading=t,this.side=e,this.wireframe=n,this.root=i}updateAfterBuild(){let t=this.root;this.lights=t.lights,this.vertexShader=t.vertexShader,this.fragmentShader=t.fragmentShader,this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.transparent=t.transparent,this.cacheKey=t.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(t,e){this.root.onBeforeCompile(t)}get data(){return this.root.data}get category(){return this.root.category}getFlavor(t,e,n){return this.root.getFlavor(t,e,n)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(t){return this.root.getLayersOfType(t)}getLayerByUuid(t){return this.root.getLayerByUuid(t)}updateByOp(t,e,n){this.root.updateByOp(t,e,n)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},SZ=class extends jh{constructor(t,e){super(),this.data=t,this.layerIdGen=0,this.flavors=[],this.type="NodeMaterial",this.updaters=[],this.reset0(t,e)}get nodeMaterial(){return this}getFlavor(t,e,n){let i=n?6:(t?3:0)+e;if(i===0)return this;this.flavors===void 0&&(this.flavors=[]),i-=1;let r=this.flavors[i];return r===void 0&&(r=new TBe(t,e,n,this),this.flavors[i]=r,r.flatShading=t,r.side=e,r.updateAfterBuild()),r}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}reset(t,e){this.data!==t&&this.reset0(t,e)}reset0(t,e){this.data=t;let n=t.layers??vo.defaultTwoLayerData("phong").layers;this.layers=n.map(i=>_f.create(this.layerIdGen++,i.id,i.data,e.shared)),this.layers.reverse(),this.name=t.name??"Untitled Material",this.onUpdate(),this.transparent=oM(t,e.shared)}getLayersOfType(t){return this.layers.filter(e=>e.type===t)}getLayerByUuid(t){return this.layers.find(e=>e.uuid===t)}onUpdate(){this.cacheKey=this.computeCacheKey(),this.lightLayer=this.layers.find(t=>t instanceof jm),this.lightLayer===void 0&&(this.lightLayer=new jm(0,"",{...Jo.defaultData("light","phong"),visible:!1},new YJ,{})),this.dispose();for(let t of this.flavors)t&&t.dispose();this.blendColors(),this.blendAfterColors(),this.blendPositions()}updateByOp(t,e,n){var i,r,s;if(e!==void 0?this.data=e:e=this.data,this.transparent=oM(e,n.shared),t.path[0]==="layers"){this.data=e;let o=n.shared,a=t.path[1];if(a===void 0){if(this.layers.reverse(),t.type===4){let l=_f.create(this.layerIdGen++,t.id,t.data,n.shared);this.layers.splice(t.localIndex,0,l),(i=n.scene)==null||i.markNeedsUpdateRendererDirty()}else if(t.type===5)this.layers.splice(t.localIndex,1)[0].dispose(),(r=n.scene)==null||r.markNeedsUpdateRendererDirty();else if(t.type===6){let l=this.layers.findIndex(h=>h.uuid===t.id),c=this.layers[l];this.layers.splice(l,1),this.layers.splice(t.localIndex,0,c),(s=n.scene)==null||s.markNeedsUpdateRendererDirty()}this.layers.reverse(),this.onUpdate()}else{let l=this.layers.find(c=>c.uuid===a);if(l){let c=e.layers.data(a);if(l.updateByOp({...t,path:t.path.slice(2)},c,n)){let h=_f.create(this.layerIdGen++,a,c,o);this.layers.splice(this.layers.findIndex(u=>u.uuid===a),1,h),this.onUpdate()}}}}else this.reset(e,n)}blendColors(){let t=this.layers.findIndex(n=>n instanceof Er),e=this.layers.findIndex(n=>n instanceof jm);if(t!==-1&&t<e){let n=this.layers[t].color;for(let i=t+1;i<e;++i){let r=this.layers[i];r instanceof Er&&(n=new Yj(n,r.color,r.alpha,r.mode))}this.fragment.color=n}else this.fragment.color=void 0}blendAfterColors(){let t=new qn("outgoingLight","f"),e=this.layers.findIndex(n=>n instanceof jm);if(this.layers.length>e+1){for(let n=e+1;n<this.layers.length;++n){let i=this.layers[n];i instanceof Er&&(t=new Yj(t,i.color,i.alpha,i.mode))}this.fragment.afterColor=t}else this.fragment.afterColor=void 0}blendPositions(){let t=this.layers.filter(e=>e instanceof _Z);if(t.length>0){let e=t[0].position;for(let n=1;n<t.length;++n)t[n]&&(e=new Ul(e,t[n].position,Ul.ADD),e=new Ul(e,new gt(.5).setReadonly(!0),Ul.MUL));this.fragment.position=e}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(t){this.build(),t.defines=this.defines,t.uniforms=this.uniforms,t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.extensionDerivatives=this.extensions.derivatives===!0,t.extensionFragDepth=this.extensions.fragDepth===!0,t.extensionDrawBuffers=this.extensions.drawBuffers===!0,t.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(t,e){let n=(i,r,s)=>Math.min(Math.max(i,r),s);for(let i of this.layers)if(i.type==="displace"){let r=n(i.uniforms[`f${i.id}_intensity`].value,t,e);i.uniforms[`f${i.id}_intensity`].value=r}}computeCacheKey(){let t="[";for(let{data:e}of this.data.layers)if(e.type==="light")t+=`"${e.visible?e.category.toUpperCase():"Basic"}"`;else{let n=(fZ[e.type]??[]).map(s=>e[s]),i=(pZ[e.type]??[]).map(s=>{var o;return((o=e[s])==null?void 0:o.length)??0}),r=[...n,...i];r.length?t+=`["${e.type}", "${r.join('","')}"],`:t+=`"${e.type}",`}return t=t.slice(0,-1)+"]",t}updateFrame(t){for(let e=0;e<this.updaters.length;++e)t.updateNode(this.updaters[e])}build(){let t=new $3e;this.lights=this.lightLayer.data.visible,t.build(this.fragment,this.fragment),this.vertexShader=t.getCode("vertex"),this.fragmentShader=t.getCode("fragment"),this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.updaters=t.updaters;for(let e of this.flavors)e&&e.updateAfterBuild();return this}nodeMaterialDispose(){this.layers.forEach(t=>t.dispose()),super.dispose();for(let t of this.flavors)t&&t.dispose()}assetsLoaded(){for(let t of this.layers)if(t instanceof Er){let e=t.params.texture;if(e instanceof MI&&!e.image.loaded)return!1}return!0}getHash(){let t="{";return t+='"fragment":'+this.fragment.getHash(),t+="}",t}};Object.defineProperties(jh.prototype,{properties:{get:function(){return this.fragment.properties}}});var EI=class extends SZ{},PBe=b1(iye()),Qj=new Map;function DBe(t){if(typeof t=="string")return t;let e=Qj.get(t);return e||(e={url:URL.createObjectURL(new Blob([t]))},Qj.set(t,e)),e.url}var ry=class{constructor({src:t,volume:e,delay:n,loop:i}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let r;typeof t=="string"?r={src:t}:r={src:DBe(t),format:"wav"},this.sound=new PBe.Howl(r),this.sound.on("end",this.onEnd),this.src=t,e!==void 0&&(this.volume=e),n!==void 0&&(this.delay=n),i!==void 0&&(this.loop=i)}get status(){return this._status}get volume(){return this._volume}set volume(t){this._volume=t,this.sound.volume(t)}get loop(){return this._loop}set loop(t){this._loop=t,this.loopsRemaining=t}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(t,e=1e3){t?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,e),this.clearFade()},t)):this.sound.fade(this._volume,0,e)}on(t,e,n){this.sound.on(t,e,n)}off(t,e,n){this.sound.off(t,e,n)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(t=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},RBe=class{constructor(){this.type="ShapePath",this.color=new Rt,this.subPaths=[],this.currentPath=null}moveTo(t,e){return this.currentPath=new EA,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this}lineTo(t,e){var n;return(n=this.currentPath)==null||n.lineTo(t,e),this}quadraticCurveTo(t,e,n,i){var r;return(r=this.currentPath)==null||r.quadraticCurveTo(t,e,n,i),this}bezierCurveTo(t,e,n,i,r,s){var o;return(o=this.currentPath)==null||o.bezierCurveTo(t,e,n,i,r,s),this}splineThru(t){var e;return(e=this.currentPath)==null||e.splineThru(t),this}toShapes(){let t={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},e={loc:t.ORIGIN,t:0};function n(f,p,v,g){let m=f.x,y=p.x,_=v.x,S=g.x,A=f.y,b=p.y,T=v.y,M=g.y,E=(S-_)*(A-T)-(M-T)*(m-_),P=(y-m)*(A-T)-(b-A)*(m-_),R=(M-T)*(y-m)-(S-_)*(b-A),F=E/R,B=P/R;if(R===0&&E!==0||F<=0||F>=1||B<0||B>1)return null;if(E===0&&R===0){for(let k=0;k<2;k++)if(i(k===0?v:g,f,p),e.loc===t.ORIGIN){let j=k===0?v:g;return{x:j.x,y:j.y,t:e.t}}else if(e.loc===t.BETWEEN){let j=+(m+e.t*(y-m)).toPrecision(10),Z=+(A+e.t*(b-A)).toPrecision(10);return{x:j,y:Z,t:e.t}}return null}else{for(let Z=0;Z<2;Z++)if(i(Z===0?v:g,f,p),e.loc===t.ORIGIN){let ee=Z===0?v:g;return{x:ee.x,y:ee.y,t:e.t}}let k=+(m+F*(y-m)).toPrecision(10),j=+(A+F*(b-A)).toPrecision(10);return{x:k,y:j,t:F}}}function i(f,p,v){let g=v.x-p.x,m=v.y-p.y,y=f.x-p.x,_=f.y-p.y,S=g*_-y*m;if(f.x===p.x&&f.y===p.y){e.loc=t.ORIGIN,e.t=0;return}if(f.x===v.x&&f.y===v.y){e.loc=t.DESTINATION,e.t=1;return}if(S<-Number.EPSILON){e.loc=t.LEFT;return}if(S>Number.EPSILON){e.loc=t.RIGHT;return}if(g*y<0||m*_<0){e.loc=t.BEHIND;return}if(Math.sqrt(g*g+m*m)<Math.sqrt(y*y+_*_)){e.loc=t.BEYOND;return}let A;g!==0?A=y/g:A=_/m,e.loc=t.BETWEEN,e.t=A}function r(f,p){let v=[],g=[];for(let m=1;m<f.length;m++){let y=f[m-1],_=f[m];for(let S=1;S<p.length;S++){let A=p[S-1],b=p[S],T=n(y,_,A,b);T!==null&&v.find(M=>M.t<=T.t+Number.EPSILON&&M.t>=T.t-Number.EPSILON)===void 0&&(v.push(T),g.push(new Se(T.x,T.y)))}}return g}function s(f,p,v){let g=new Se;p.getCenter(g);let m=[];return v.forEach(y=>{y.boundingBox.containsPoint(g)&&r(f,y.points).forEach(_=>{m.push({identifier:y.identifier,isCW:y.isCW,point:_})})}),m.sort((y,_)=>y.point.x-_.point.x),m}function o(f,p,v,g,m){(m==null||m==="")&&(m="nonzero");let y=new Se;f.boundingBox.getCenter(y);let _=[new Se(v,y.y),new Se(g,y.y)],S=s(_,f.boundingBox,p);S.sort((P,R)=>P.point.x-R.point.x);let A=[],b=[];S.forEach(P=>{P.identifier===f.identifier?A.push(P):b.push(P)});let T=A[0].point.x,M=[],E=0;for(;E<b.length&&b[E].point.x<T;)M.length>0&&M[M.length-1]===b[E].identifier?M.pop():M.push(b[E].identifier),E++;if(M.push(f.identifier),m==="evenodd"){let P=M.length%2===0,R=M[M.length-2];return{identifier:f.identifier,isHole:P,for:R}}else if(m==="nonzero"){let P=!0,R=null,F=null;for(let B=0;B<M.length;B++){let k=M[B];p[k]&&(P?(F=p[k].isCW,P=!1,R=k):F!==p[k].isCW&&(F=p[k].isCW,P=!0))}return{identifier:f.identifier,isHole:P,for:R}}else console.warn('fill-rule: "'+m+'" is currently not implemented.')}let a=0,l=999999999,c=-999999999,h=[];this.subPaths.forEach(f=>{let p=f.getPoints(),v=-999999999,g=999999999,m=-999999999,y=999999999;for(let _=0;_<p.length;_++){let S=p[_];S.y>v&&(v=S.y),S.y<g&&(g=S.y),S.x>m&&(m=S.x),S.x<y&&(y=S.x)}c<=m&&(c=m+1),l>=y&&(l=y-1),p.length&&h.push({curves:f.curves,points:p,isCW:GQ.isClockWise(p),identifier:a++,boundingBox:new $be(new Se(y,g),new Se(m,v))})});let u=h.map(f=>{var p;return o(f,h,l,c,(p=this.userData)==null?void 0:p.style.fillRule)}),d=[];return h.forEach(f=>{let p=u[f.identifier];if(p&&!p.isHole){let v=new CA;v.curves=f.curves,u.filter(g=>(g==null?void 0:g.isHole)&&g.for===f.identifier).forEach(g=>{if(g){let m=h[g.identifier],y=new EA;y.curves=m.curves,v.holes.push(y)}}),d.push(v)}}),d}},bZ,Kj=new Promise(t=>{bZ=t}),Jj=!1;async function LBe(){if(Jj)return;let t=await oE(()=>import("./opentype-fc28cde9.js"),[]);bZ(t),Jj=!0}var IBe=class{async load(t,e,n=()=>{}){let{load:i}=await Kj;i(t,(r,s)=>{r||!s?n(r??"Something went wrong"):e(s)})}async parse(t){let{parse:e,Bidi:n}=await Kj;try{let i=e(t),r=new n,s=o=>i.charToGlyphIndex(o.char);return r.registerModifier("glyphIndex",null,s),r.applyFeatures(i,i.defaultRenderOptions.features),{font:i,bidi:r}}catch(i){console.error(i)}}};async function BBe(t){return await(await fetch(t)).arrayBuffer()}var OBe=new IBe;async function Zj(t){let e,n,i=!1;if(t.url?(e=await BBe(t.url),n=t.url,i=t.url.startsWith("/")):t.data&&(e=t.data.buffer),e){let r=await OBe.parse(e);if(r)return{font:r.font,url:n,intercepted:i,arr:e,bidi:r.bidi}}}function FBe(t,e){return e.state.glyphIndex===t||e.state.fina===t||e.state.medi===t||e.state.init===t}var NBe=class{constructor(t){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=t.isUserFont??!1,this._loadingPromise=Zj(t).then(e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)})}update(t){this._isLoaded=!1,this._isUserFont=t.isUserFont??!1,this._loadingPromise=Zj(t).then(e=>{e&&(this._arrayBuffer=e.arr,this._url=e.url,this.font=e.font,this._intercepted=e.intercepted,this._isLoaded=!0,this._bidi=e.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(t,e,n){if(!this._bidi)return[];let i=this._bidi;i.getTextGlyphs(e);let r=i.tokenizer.tokens,s=[],o=0,a=n.length===r.length;for(let l=0;l<n.length;l++){let c=n[l].index,h=String.fromCharCode(n[l].unicode),u=r[o];if(FBe(c,u)||a)s.push({char:h,index:c,replacements:[u.state.glyphIndex],replacementChars:[u.char]}),o++;else{let d=u.char,f="",p=[u.state.glyphIndex],v=[],g=!1;for(;!g;)o++,f=e.charAt(o),d+=f,p.push(t.charToGlyphIndex(f)),v=t.stringToGlyphs(d),v.length===1&&v[0].index===c&&(g=!0),o>e.length&&(g=!0);s.push({char:h,index:c,replacements:p,replacementChars:Array.from(d)}),o++}}return s}generateShapes(t,e){if(!this._isLoaded)return;let n=this.font,i=e.fontSize/this.unitsPerEm,r=e.fontSize*e.lineHeight,s=t.map(m=>this.getTextWidth(m,e)),o=e.width,a=this.getCharWidth(`
`,e),l=e.horizontalAlign===1?a:0,c=this.computeSpaceWidthForLine(t,0,e),h=this.getLineInitialOffsetX(s[0],o,e.horizontalAlign,t[0],a),u=this.getLineInitialOffsetY(r,t.length,e.height,i,e.verticalAlign),d=[],f=t.map(m=>[]),p=t.map(m=>[]),v;for(let m=0;m<t.length;m++){let y=t[m],_={features:{liga:!0}},S=[];try{S=n.stringToGlyphs(y,_)}catch(b){console.warn(b)}h=this.getLineInitialOffsetX(s[m],o,e.horizontalAlign,y,a);let A=[];try{A=this.reverseLigaturesTable(n,y,S)}catch(b){console.warn(b)}c=this.computeSpaceWidthForLine(t,m,e);for(let b=0;b<S.length;b++){let T=S[b],M=T.index===0?`
`:T.unicode?String.fromCharCode(T.unicode):void 0,E=A[b],P=0,R=0;b===0&&e.horizontalAlign===2&&T.leftSideBearing!==void 0&&(R=-T.leftSideBearing*i),v&&(P=n.getKerningValue(T,v)*i),h+=R+P;let F=0;if(M===`
`)F=l;else if(M===" ")F=c;else{let B=this.createPath(T,i,h,u,e);B&&(F=B.offsetX-(P+R),d.push(B.path))}if(E.replacements.length===1)p[m].push([h,u]),f[m].push(F);else{let B=E.replacements.map(ee=>(n.glyphs.get(ee).advanceWidth??0)*i),k=B.reduce((ee,O)=>ee+=O,0),j=B.map(ee=>ee/k),Z=h;for(let ee=0;ee<j.length;ee++){let O=F*j[ee];p[m].push([Z,u]),f[m].push(O),Z+=O}}h+=F,v=T}u-=r}let g=[];for(let m=0,y=d.length;m<y;m++)g.push(...d[m].toShapes());return{shapes:g,charWidths:f,lineWidths:s,charCoords:p}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var t;return((t=this.font)==null?void 0:t.ascender)??0}get descender(){var t;return((t=this.font)==null?void 0:t.descender)??0}get familyName(){var t;return((t=this.font)==null?void 0:t.names.fontFamily)??""}get subfamilyName(){var t;return((t=this.font)==null?void 0:t.names.fontSubfamily)??""}get unitsPerEm(){var t;return((t=this.font)==null?void 0:t.unitsPerEm)??1}getLineInitialOffsetX(t,e,n,i,r){return(n===3||n===2)&&i.indexOf(`
`)>=0&&(t-=r),n===3?e*.5-t*.5:n===2?e-t:0}getLineInitialOffsetY(t,e,n,i,r){let s=e*t,o=Math.abs(this.ascender-this.descender)*i,a=t-o,l=-this.ascender*i-a/2;return r===3?-(n-s-l):r===2?-(n*.5-s*.5-l):l}createPath(t,e,n,i,r){var l;let s=t.getPath(n,-i,r.fontSize,{kerning:!1,letterSpacing:r.letterSpacing});if(!s){console.error('THREE.Font: character "'+t+'" does not exists in font family '+this.familyName+".");return}let o=new RBe,a=(t.advanceWidth??1)*e;if(t)for(let c of s.commands){let h=(l=o.currentPath)==null?void 0:l.currentPoint;if(!(h&&c.type!=="Z"&&h.x===c.x&&-h.y===c.y))switch(c.type){case"M":o.moveTo(c.x,-c.y);break;case"L":o.lineTo(c.x,-c.y);break;case"Q":o.quadraticCurveTo(c.x1,-c.y1,c.x,-c.y);break;case"C":o.bezierCurveTo(c.x1,-c.y1,c.x2,-c.y2,c.x,-c.y);break}}return o.subPaths.forEach(c=>{let h=UBe(c.curves);h!==void 0&&c.currentPoint.distanceTo(h)>0&&c.lineTo(h.x,h.y)}),{offsetX:a+r.fontSize*r.letterSpacing,path:o}}getCharWidth(t,e){var n;return((n=this.font)==null?void 0:n.getAdvanceWidth(t,e.fontSize,{kerning:!0,letterSpacing:e.letterSpacing}))??0}getTextWidth(t,e){var n;return((n=this.font)==null?void 0:n.getAdvanceWidth(t,e.fontSize,{kerning:!0,letterSpacing:e.letterSpacing}))??0}computeSpaceWidthForLine(t,e,n){let i=this.getCharWidth(" ",n),r=t[e];if(r){let s=this.countSpaces(r.trimEnd());if(n.horizontalAlign===4&&e<t.length-1&&s){let o=n.width,a=this.getTextWidth(r,n);return(o-(a-s*i))/s}}return i}countSpaces(t){return(t.match(/ /g)||[]).length}};function UBe(t){if(t.length){let e=t[0];if(e instanceof Wa)return e.v1;if(e instanceof Na||e instanceof Hh)return e.v0}}var kBe=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(t){return this.objects.get(t)}get size(){return this.objects.size}get(t,e){let n=this.objects.get(t);return n===void 0?(n=this.createObject(t,e),this.objects.set(t,n)):n.isShared=!0,n}mutateIfUnique(t,e){let n=this.objects.get(t);if(n&&n.isShared!==!0)return this.objects.delete(t),this.objects.set(e,n),n}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(t,e){let n=this.objects.get(t);e===n&&this.unreachable.delete(t)}endGc(){this.unreachable.forEach(t=>{this.disposeObject(this.objects.get(t)),this.objects.delete(t)}),this.unreachable.clear()}dispose(){this.objects.forEach(t=>{this.disposeObject(t)}),this.objects.clear()}},$j=class extends kBe{constructor(t){super(),this.flatShading=t}disposeObject(t){t.dispose()}createObject(t,e){let n=rM(t,e,this.flatShading);return n.computeBoundingSphere(),n}},zBe={find(t){},markNeedsUpdateRendererDirty:function(){},markGeometryCacheDirty:function(){},addPendingExpandCloner:function(t){},addPendingUpdateCloner(t){},addPendingCommand(t){}},GBe=class extends _Be{constructor(t){super(),this.shared=t}create(t){return new dZ(t,this.shared)}},EE=class{constructor(t,e={}){if(this.geometryCache=new $j(!0),this.geometryCache2=new $j(!1),this.imageHolderCache=new GBe(this),this.thisContext={scene:zBe,shared:this},this.deletedMaterial=new EI(vo.defaultTwoLayerData("phong"),this.thisContext),this.deletedImage=new nf(ZA.emptyImage,this),this.deletedVideo=new nf(HA.defaultVideo,this),this.materials={},this.images={},this.videos={},this.colors={},this.audios={},this.fonts={},this.penumbraSize=[],this.requestRender=()=>{this._requestRender&&this._requestRender()},e.images)for(let[n,i]of Object.entries(e.images))this.addImage(n,i);if(e.videos)for(let[n,i]of Object.entries(e.videos))this.addVideo(n,i);if(e.audios)for(let[n,i]of Object.entries(e.audios))this.addAudio(n,i.data);this.reset(t)}setRequestRender(t){this._requestRender=t}reset(t){for(let[e,n]of Object.entries(t.images))this.addImage(e,n);for(let[e,n]of Object.entries(t.videos))this.addVideo(e,n);for(let[e,n]of Object.entries(t.colors))this.addColor(e,n);for(let[e,n]of Object.entries(t.materials))this.addMaterial(e,new EI(n,this.thisContext));for(let[e,n]of Object.entries(t.audios))this.addAudio(e,n.data);for(let[e,n]of Object.entries(t.fonts))this.addFont(e,n);this.penumbraSize=t.penumbraSize}addMaterial(t,e){e.uuid=t,this.materials[t]=e}deleteMaterial(t){this.materials[t]&&(this.materials[t].nodeMaterialDispose(),delete this.materials[t])}getMaterial(t){return this.materials[t]}getMaterialOrDeletedPlaceholder(t){return this.materials[t]??this.deletedMaterial}material(t){return typeof t=="string"?this.getMaterialOrDeletedPlaceholder(t):new SZ(t,this.thisContext)}getMaterials(){return this.materials}addImage(t,e){return this.images[t]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[t].updateSrc(e.data),!0):(this.images[t]=new nf(e,this),!1)}deleteImage(t){let e=this.images[t];e&&(e.dispose(),delete this.images[t])}getDefaultImage(){return this.images.image_0}getImage(t){return this.images[t]??this.deletedImage}image(t){return typeof t=="string"?this.getImage(t):this.imageHolderCache.load(t)}addVideo(t,e){return this.videos[t]?(this.videos[t].updateSrc(e.data),!0):(this.videos[t]=new nf(e,this),!1)}deleteVideo(t){let e=this.videos[t];e&&(e.dispose(),delete this.videos[t])}getVideo(t){return this.videos[t]??this.deletedVideo}video(t){return typeof t=="string"?this.getVideo(t):this.imageHolderCache.load(t)}addColor(t,e){return this.colors[t]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in e?this.colors[t].setRGBA(e.r,e.g,e.b,e.a):this.colors[t].setRGBA(e.r,e.g,e.b,1),!0):("a"in e?this.colors[t]=new sM(e.r,e.g,e.b,e.a):this.colors[t]=new sM(e.r,e.g,e.b,1),!1)}updateColor(t,e){if(this.colors[t]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let n=this.colors[t];return this.colors[t].r=e.r??n.r,this.colors[t].g=e.g??n.g,this.colors[t].b=e.b??n.b,this.colors[t].a=e.a??n.a,!0}return!1}deleteColor(t){this.colors[t]&&delete this.colors[t]}getColor(t){return this.colors[t]}color(t){let e;if(typeof t=="string"){let n=this.getColor(t);n?e=n:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),e=new Ns(0,0,0,0))}else return"a"in t?new Ns(t.r,t.g,t.b,t.a):new Ns(t.r,t.g,t.b,1);return e}addAudio(t,e){this.audios[t]=e}getAudio(t){let e=this.audios[t];if(e instanceof ry)return e;{let n=new ry({src:e});return this.audios[t]=n,n}}deleteAudio(t){let e=this.audios[t];e&&(e instanceof ry&&e.dispose(),delete this.audios[t])}addFont(t,e){this.fonts[t]=new NBe(e),this.fonts[t].loadingPromise.then(()=>this.requestRender())}getFont(t){return this.fonts[t]}deleteFont(t){this.fonts[t]&&delete this.fonts[t]}dispose(){Object.keys(this.materials).forEach(t=>this.deleteMaterial(t)),this._requestRender=void 0,Object.values(this.audios).forEach(t=>{t instanceof ry&&t.dispose()}),this.audios={},this.geometryCache.dispose(),this.geometryCache2.dispose()}};new EE($A.emptyData());var CE=class extends zs{updateByPatchedOp(t,e,n){if(super.updateByPatchedOp(t,e,n),DRe(t.path,["materials"])!==null&&t.type===0&&Array.isArray(this.material))for(let[i,r]of Object.entries(t.props)){let s=n.shared.material(r);this.material[Number(i)]=s}else if(th(t.path,["material"])&&this.material instanceof jh)"material"in e&&typeof e.material!="string"&&this.material.updateByOp(lo.drop(t,1),e.material,n);else if(th(t.path,["materials","*"])&&Array.isArray(this.material)){let i=t.path[1];if("materials"in e&&i<this.material.length){let r=e.materials[i];typeof r!="string"&&this.material[i].updateByOp(lo.drop(t,2),r,n)}}}updateState(t,e){var i,r,s,o,a;super.updateState(t,e),t.castShadow!==void 0&&(this.castShadow=t.castShadow),t.receiveShadow!==void 0&&(this.receiveShadow=t.receiveShadow);let n=this.dataPatched;if(((i=t.geometry)==null?void 0:i.type)!=="NonParametricGeometry"&&"material"in t&&t.material!==void 0&&(this.disposeMaterial(),this.material=e.shared.material(t.material).getFlavor(n.flatShading,n.side,n.wireframe),(r=e.scene)==null||r.markNeedsUpdateRendererDirty()),((s=t.geometry)==null?void 0:s.type)==="NonParametricGeometry"&&("materials"in t&&t.materials!==void 0?(this.disposeMaterial(),this.material=t.materials.map(l=>e.shared.material(l).getFlavor(n.flatShading,n.side,n.wireframe)),(o=e.scene)==null||o.markNeedsUpdateRendererDirty()):"material"in t&&t.material!==void 0&&(this.disposeMaterial(),this.material=[e.shared.material(t.material).getFlavor(n.flatShading,n.side,n.wireframe)],(a=e.scene)==null||a.markNeedsUpdateRendererDirty())),t.flatShading!==void 0||t.wireframe!==void 0||t.side!==void 0)if(Array.isArray(this.material))for(let l=0;l<this.material.length;l++)this.material[l]=this.material[l].getFlavor(n.flatShading,n.side,n.wireframe);else this.material=this.material.getFlavor(n.flatShading,n.side,n.wireframe)}disposeMaterial(){this.material&&oJ(this.material).forEach(t=>{t instanceof jh&&(t instanceof EI||t.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},ua=class extends CE{constructor(t,e,n){super(t,e),this.data=e,this.localGeometry=void 0}chooseGeoemtryCache(t){return t.geometryCache}markGeometryAsReachable(t){this.geometryCreateDeleyed instanceof Lt&&this.chooseGeoemtryCache(t).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof EE){let t=this.geometryCreateDeleyed,e=this.chooseGeoemtryCache(t);this.geometryCreateDeleyed=e.get(this.dataPatched.geometry,t)}return this.geometryCreateDeleyed}set geometry(t){this.localGeometry=t}get is2DAndNoDepth(){let t=this.dataPatched.geometry;return WA.is2DParametricMesh(t.type)&&t.depth===0}get is2DType(){return WA.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(t,e,n){super.updateByPatchedOp(t,e,n),th(t.path,["geometry"])&&this.updateByPatchedOpGeometry(lo.drop(t,1),e.geometry,n)}removeInteractionGeometry(){var t;(t=this.localGeometry)==null||t.dispose(),this.localGeometry=void 0}updateGeometryInteractions(t,e){var i;this.invalidateDownstreamBooleanData();let n=this.data.geometry.type;if(n==="NonParametricGeometry"||n==="SubdivGeometry"){let r=t;if(this.localGeometry===void 0){let c={...this.data.geometry,...r};this.localGeometry=rM(c,e,this.data.flatShading)}let s,o,a;r.scaleBaked?[s,o,a]=r.scaleBaked:{width:s,height:o,depth:a}=r;let l=this.localGeometry.userData;l.sxPrev!==void 0&&SI(this.localGeometry.attributes,s/l.sxPrev,o/l.syPrev,a/l.szPrev),l.sxPrev=s,l.syPrev=o,l.szPrev=a}else{let r={...this.data.geometry,...t};(i=this.localGeometry)==null||i.dispose(),this.localGeometry=rM(r,e,this.data.flatShading)}}refreshAttachedCloners(t){for(let e of this.attachedSurfaceCloners)t.scene.addPendingUpdateCloner(e.object)}refreshAttachedPaths(t){for(let e of this.attachedPaths)t.scene.addPendingCommand(()=>e.updateShape())}createGeometryDelayed(t){this.geometryCreateDeleyed=t.shared,this.refreshAttachedCloners(t),this.refreshAttachedPaths(t)}updateByPatchedOpGeometry(t,e,n){var r;let i=!1;t.type===0&&t.path.length===0&&qO(["scaleBaked"],Object.keys(t.props))&&this.geometryCreateDeleyed instanceof hs&&this.chooseGeoemtryCache(n.shared).mutateIfUnique(this.geometryCreateDeleyed.data,e)===this.geometryCreateDeleyed&&(i=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(e,t.props.scaleBaked),this.refreshAttachedCloners(n),this.refreshAttachedPaths(n)),i||((r=n.scene)==null||r.markGeometryCacheDirty(),this.createGeometryDelayed(n)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(t,e){this.createGeometryDelayed(e)}updateState(t,e){t.geometry!==void 0&&this.updateGeometryOnStateUpdate(t.geometry,e),super.updateState(t,e)}updateGeometryGroupsIfNeeded(){var t;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((t=this.geometry.getIndex())==null?void 0:t.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(t,e){let n=this.geometry.userData.parameters;this.is2DType?t.set(0,0,n.depth*.5):this.isNonParametric?(t.setScalar(0),this.geometry.boundingSphere&&t.copy(this.geometry.boundingSphere.center),e.set(n.width,n.height,n.depth??0).multiplyScalar(.5)):t.setScalar(0),e.set(n.width,n.height,n.depth??0).multiplyScalar(.5)}};function HBe(t){var o,a;if(t.geometry.attributes.extrudeNormal||!t.geometry.attributes.position||!t.geometry.attributes.normal)return;let e=new Map,n=t.geometry.attributes,i=n.position.array,r=n.normal.array,s=new Float32Array(i.length);for(let l=0;l<i.length;l+=3){let c=`${i[l]}_${i[l+1]}_${i[l+2]}`,h=new N(r[l],r[l+1],r[l+2]);e.has(c)?(o=e.get(c))==null||o.normals.push(h):e.set(c,{normals:[h],result:new N})}e.forEach((l,c)=>{for(let h of l.normals)l.result.add(h);l.result.divideScalar(l.normals.length)});for(let l=0;l<i.length;l+=3){let c=`${i[l]}_${i[l+1]}_${i[l+2]}`,h=(a=e.get(c))==null?void 0:a.result;h&&(s[l]=h.x,s[l+1]=h.y,s[l+2]=h.z)}t.geometry.setAttribute("extrudeNormal",new ft(s,3))}function VBe(t){if(t.geometry.attributes.extrudeNormals||!t.geometry.attributes.position)return;let e=t.geometry.attributes.position.array,n=new Float32Array(e.length),i=new N;for(let r=0;r<e.length;r+=3)i.set(e[r],e[r+1],e[r+2]).normalize(),n[r]=i.x,n[r+1]=i.y,n[r+2]=i.z;t.geometry.setAttribute("extrudeNormal",new ft(n,3))}function xF(t){if(Array.isArray(t.material)){for(let e of t.material)if(e.getLayersOfType("outline").length===0)return}else if(!(t.material instanceof jh)||t.material.getLayersOfType("outline").length===0)return;t instanceof ua&&t.is2DAndNoDepth?VBe(t):HBe(t)}function _F(t){if(!t.geometry.attributes.position)return;let e=t.geometry.attributes.position.array,n=new Float32Array(e.length),i=parseInt(t.uuid.replace(/\D/g,"")),r=[sn.seededRandom(i),sn.seededRandom(i+1e4),sn.seededRandom(i+2e4)];for(let s=0;s<e.length;s++)n[s]=r[s%3];t.geometry.setAttribute("randomColor",new Ut(n,3))}fF.then(t=>{});var xl=new Vi,B0=new N;function jBe(t){let e=!1;return t.scene.objects.traverse((n,i)=>{i.type==="Mesh"&&i.geometry.type==="SubdivGeometry"&&(e=!0)}),e}var kx=class extends ua{constructor(t,e,n){super(t,e,n),this.data=e,this.hiddenMatrixOld=new nt,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(t){return this.dataPatched.flatShading?t.geometryCache:t.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(t,e){let n=this.geometry.userData.parameters;t.copy(this.originalGeometryNew.boundingSphere.center),e.set(n.width,n.height,n.depth??0).multiplyScalar(.5)}createGeometryByControls(t){var s,o,a;if(this.skipReactionUpdate===!0)return;let e=(s=this.localGeometry)==null?void 0:s.uuid,{originalGeometry:n,subdividedGeometry:i,subdivPointer:r}=hs.build(t,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=r,n!==void 0&&((o=this.originalGeometry)==null||o.dispose(),this.originalGeometry=n),i!==void 0&&((a=this.subdividedGeometry)==null||a.dispose(),this.subdividedGeometry=i??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,xF(this),_F(this),this.calcBoundingBox(),e&&(this.localGeometry.uuid=e)}updateState(t,e){if(super.updateState(t,e),t.flatShading!==void 0){let n=this.material;this.material=n.getFlavor(!1,n.side,n.wireframe),this.smoothShading=!t.flatShading,this.createGeometryDelayed(e)}}updateMesh(t=!1){hs.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,t&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&hs.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,t&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=hs.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=hs.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(t,e){let n=this.localGeometry;this.localGeometry=this.originalGeometryNew,zs.prototype.raycast.call(this,t,e),this.localGeometry=n}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let t=this.originalGeometry;t.boundingSphere===null&&(t.boundingSphere=new la,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=t.boundingSphere));let e=t.attributes.position,n=t.boundingSphere.center;xl.setFromBufferAttribute(e),xl.getCenter(n),t.boundingSphere.radius=n.distanceTo(xl.max),isNaN(t.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),xl.getSize(B0),this.hasNonUniformScale&&B0.divide(this.scale);let i={width:B0.x,height:B0.y,depth:B0.z};return this.geometry.userData.parameters=i,i}updateBoundingSphere(t){let e=this.originalGeometry;xl.min.set(t[0],t[2],t[4]),xl.max.set(t[1],t[3],t[5]),this.hasNonUniformScale&&(xl.min.applyMatrix4(this.shearScaleInv),xl.max.applyMatrix4(this.shearScaleInv)),e.boundingSphere===null&&(e.boundingSphere=new la);let n=e.boundingSphere.center;xl.getCenter(n),e.boundingSphere.radius=n.distanceTo(xl.max)}freeSubdivPointer(){var t,e;this.subdivPointer&&(hs.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(t=this.originalGeometry)==null||t.dispose(),(e=this.subdividedGeometry)==null||e.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(t,e,n){super.updateByPatchedOpGeometry(t,e,n),this.localGeometry&&this.createGeometryByControls(e)}},e6=-1,WBe=1,XBe={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},YBe={polygon_center:0,edge:1,vertex:2},US=(t,e)=>(n,i)=>!e||n===0||t===0?0:t*i/100,Ht=(t,e)=>{let n=Math.abs(e),i=n*-1;return(t-e6)*(n-i)/(WBe-e6)+i};function qBe(t){let e=[],n={};for(var i=0,r=t.length;i<r;i++){var s=JSON.stringify(t[i].pos.map(o=>Math.round(o*1e4)/1e4));n[s]||(e.push(t[i]),n[s]=!0)}return e}var QBe=new N,kS=new N,KBe=new N,JBe=new N;function gg(t,e){let n=KBe.fromArray(t),i=JBe.fromArray(e);kS.copy(i).sub(n);let r=kS.length();return kS.normalize().multiplyScalar(r*.5),QBe.copy(n).add(kS).toArray()}var Zo=new Cs,zS=new N,aM=new N,Xd=new N;function ZBe(t){let e=[];for(let n=0;n<=t.index.count;n++)if(zS.fromArray(t.index.array,n*3),Zo.setFromAttributeAndIndices(t.attributes.position,zS.x,zS.y,zS.z),Zo.getNormal(aM),Zo.getMidpoint(Xd),!(isNaN(Xd.x)||isNaN(Xd.y)||isNaN(Xd.z))){let{a:i,b:r,c:s}=Zo,o=i.toArray(),a=r.toArray(),l=s.toArray(),c=i.distanceTo(r),h=r.distanceTo(s),u=s.distanceTo(i),d=gg(o,a),f=gg(a,l),p=gg(l,o),v=[c,h,u],g=Math.max(...v),m=v.filter(S=>Math.round(S)===Math.round(g)).length>1,y=[],_=Zo.getMidpoint(Xd).toArray();g===c&&!m&&(y=[f,p,p],_=d),g===h&&!m&&(y=[d,p,p],_=f),g===u&&!m&&(y=[d,f,f],_=p),m&&(y=[d,f,p]),e.push({vertices:[o,a,l],faceCenters:y,midpoint:_,norm:Zo.getNormal(aM).toArray()})}return e}function $Be(t){let e=[],{position:n}=t.attributes;for(let i=0;i<n.count;i++){Zo.setFromAttributeAndIndices(n,i*3,i*3+1,i*3+2),Zo.getNormal(aM),Zo.getMidpoint(Xd);let r=Zo.a.toArray(),s=Zo.b.toArray(),o=Zo.c.toArray();e.push({vertices:[r,s,o],faceCenters:[gg(r,s),gg(s,o),gg(o,r)],midpoint:Xd.toArray(),norm:aM.toArray()})}return e}var eOe=4,tOe=.5,F2=t=>.5*(1-Math.cos(t*Math.PI)),nOe=class{constructor(){this.perlin=new Array(4095+1)}noise(t,e=0,n=0){if(this.perlin==null){this.perlin=new Array(4095+1);for(let g=0;g<4095+1;g++)this.perlin[g]=Math.random()}t<0&&(t=-t),e<0&&(e=-e),n<0&&(n=-n);let i=Math.floor(t),r=Math.floor(e),s=Math.floor(n),o=t-i,a=e-r,l=n-s,c,h,u=0,d=.5,f,p,v;for(let g=0;g<eOe;g++){let m=i+(r<<4)+(s<<8);c=F2(o),h=F2(a),f=this.perlin[m&4095],f+=c*(this.perlin[m+1&4095]-f),p=this.perlin[m+16&4095],p+=c*(this.perlin[m+16+1&4095]-p),f+=h*(p-f),m+=256,p=this.perlin[m&4095],p+=c*(this.perlin[m+1&4095]-p),v=this.perlin[m+16&4095],v+=c*(this.perlin[m+16+1&4095]-v),p+=h*(v-p),f+=F2(l)*(p-f),u+=f*d,d*=tOe,i<<=1,o*=2,r<<=1,a*=2,s<<=1,l*=2,o>=1&&(i++,o--),a>=1&&(r++,a--),l>=1&&(s++,l--)}return u}noiseSeed(t){let e=(()=>{let n,i;return{setSeed(r){i=n=(r??Math.random()*4294967296)>>>0},getSeed(){return n},rand(){return i=(1664525*i+1013904223)%4294967296,i/4294967296}}})();e.setSeed(t),this.perlin=new Array(4095+1);for(let n=0;n<4095+1;n++)this.perlin[n]=e.rand()}},iOe=nOe,t6=new N,n6=new nt,i6=new uv;function r6(t){let e=!1;return t.scene.objects.traverse((n,i)=>{i.type==="Mesh"&&i.geometry.type==="TextGeometry"&&(e=!0)}),e}var AZ=class extends ua{constructor(t,e,n){super(t,e,n),this.data=e}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var e;let t=this.dataPatched;return((e=this.font)==null?void 0:e.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,t.geometry.height,this.fontScale,t.geometry.verticalAlign))??0}get fontScale(){let t=this.dataPatched;return this.font?t.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var t;return(((t=this.font)==null?void 0:t.ascender)??1)*this.fontScale}get descender(){var t;return(((t=this.font)==null?void 0:t.descender)??1)*this.fontScale}get lineHeight(){let t=this.dataPatched;return t.geometry.fontSize*t.geometry.lineHeight}raycast(t,e){let{matrixWorld:n}=this;if(!(isNaN(t.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(n6.copy(n).invert(),i6.copy(t.ray).applyMatrix4(n6),i6.intersectBox(this.singleBBox,t6))){let i=t6.applyMatrix4(n),r=t.ray.origin.distanceTo(i);e.push({distance:r,point:i.clone(),object:this})}}},rs=1e-4,_l,MZ,EZ,CZ,s6=new N,o6=new N;fF.then(t=>{_l=t,MZ=[_l.get_face_center,_l.get_edge_midpoint,_l.get_vertex_position],EZ=[_l.get_face_normal,_l.get_edge_normal,_l.get_vertex_normal],CZ=[_l.face_count,_l.edge_count,_l.vertex_count]});var rOe=new nt,sOe=new nt,Uu=new N,Cd=new N,O0=new N,N2=new N,oOe=new N,aOe=new N,Mc=new iOe,rf=class extends oF(Fn){constructor(t,e){super(),this.parameters=e,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.object=t}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(t){if(this.parent===null)this.updateState(this.parameters,t);else for(let e of this.children)e instanceof Fl&&e.expand()}invalidateTransform(t){this.matrixWorldNeedsUpdate=!0,this.traverse(e=>{e instanceof Fl&&e.object===t&&(e.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let t of this.children)t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD())}_updateCount(t){let e;if(t!==void 0?e=t:e=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"&&!this.parameters.toObject.object&&(e=0),this.parameters.type==="toObject"&&this.objectForSample){for(let i=0,r=this.children.length;i<r;++i)this.remove(this.children[0]);let n=this.children;if(n.length===e)return;if(n.length<e)for(let i=0,r=e-n.length;i<r;++i){let s=new Fl(this.object);s.expand(),this.add(s)}else for(let i=0,r=n.length-e;i<r;++i)this.remove(n[i])}else{if(this.children.length===e)return;if(this.children.length<e)for(let n=0,i=e-this.children.length;n<i;++n){let r=new Fl(this.object);r.expand(),this.add(r)}else for(let n=0,i=this.children.length-e;n<i;++n)this.remove(this.children[0])}}_updateRadial(t){let e=t.radial,n=e.start*sn.DEG2RAD,i=e.end*sn.DEG2RAD,r=n-i,s=new Tr(e.rotation[0],e.rotation[1],e.rotation[2]),o;switch(e.axis){case"z":o=new N(0,0,1);break;case"y":o=new N(0,1,0);break;default:case"x":o=new N(1,0,0);break}let a=t.randomnessObject??dh.defaultData([1,1,1]).randomnessObject,l=a.noiseType==="perlin";Mc.noiseSeed(a.seed);let c=w2((0,C0.default)(a.seed)),h=US(a.strength,this.parameters.randomness);for(let[u,d]of this.children.entries()){let f=u*(a.freqScale/10)+a.movement,p=l?Mc.noise(f):c(f,f);d.scale.x=e.scale[0]+h(u,Ht(p,a.scale[0]))||rs,d.scale.y=e.scale[1]+h(u,Ht(p,a.scale[1]))||rs,d.scale.z=e.scale[2]+h(u,Ht(p,a.scale[2]))||rs,d.position.setScalar(0);let v=r/t.count*u-n;switch(e.axis){case"x":d.rotation.set(0,v,0);break;case"y":d.rotation.set(0,0,v);break;case"z":d.rotation.set(v,0,0);break}d.translateOnAxis(o,e.radius),d.position.x+=e.position[0]+h(u,Ht(p,a.position[0])),d.position.y+=e.position[1]+h(u,Ht(p,a.position[1])),d.position.z+=e.position[2]+h(u,Ht(p,a.position[2]));let g=h(u,Ht(p,a.rotation[0])),m=h(u,Ht(p,a.rotation[1])),y=h(u,Ht(p,a.rotation[2]));e.alignment===!0?(d.rotation.x+=s.x+g,d.rotation.y+=s.y+m,d.rotation.z+=s.z+y):d.rotation.set(s.x+g,s.y+m,s.z+y)}}_updateLinear(t){if(t.type!=="linear")throw new Error;let e=t.linear,n=new Tr(e.rotation[0],e.rotation[1],e.rotation[2]),i=t.randomnessObject??dh.defaultData([1,1,1]).randomnessObject,r=i.noiseType==="perlin";Mc.noiseSeed(i.seed);let s=w2((0,C0.default)(i.seed)),o=US(i.strength,this.parameters.randomness);for(let[a,l]of this.children.entries()){let c=a*(i.freqScale/10)+i.movement,h=r?Mc.noise(c):s(c,c),u=o(a,Ht(h,i.rotation[0])),d=o(a,Ht(h,i.rotation[1])),f=o(a,Ht(h,i.rotation[2]));l.scale.x=1+(e.scale[0]-1)*a+o(a,Ht(h,i.scale[0]))||rs,l.scale.y=1+(e.scale[1]-1)*a+o(a,Ht(h,i.scale[1]))||rs,l.scale.z=1+(e.scale[2]-1)*a+o(a,Ht(h,i.scale[2]))||rs,l.rotation.x=n.x*a+u,l.rotation.y=n.y*a+d,l.rotation.z=n.z*a+f,l.position.x=e.position[0]*a+o(a,Ht(h,i.position[0])),l.position.y=e.position[1]*a+o(a,Ht(h,i.position[1])),l.position.z=e.position[2]*a+o(a,Ht(h,i.position[2]))}}_updateGrid(t){let e=0,n=t.grid,i=t.randomnessObject??dh.defaultData([1,1,1]).randomnessObject,r=US(i.strength,this.parameters.randomness),s=i.noiseType==="perlin";Mc.noiseSeed(i.seed);let o=aIe((0,C0.default)(i.seed));if(n.useCenter===!0){let a={x:n.count[0]%2===0?2:1,y:n.count[1]%2===0?2:1,z:n.count[2]%2===0?2:1},l=new N(n.size[0]*(n.count[0]-a.x)*.5,n.size[1]*(n.count[1]-a.y)*.5,n.size[2]*(n.count[2]-a.z)*.5);for(let c=0;c<n.count[0];c++)for(let h=0;h<n.count[1];h++)for(let u=0;u<n.count[2];u++){let d=[(c+1)*(i.freqScale/10)+i.movement,(h+1)*(i.freqScale/10)+i.movement,(u+1)*(i.freqScale/10)+i.movement],f=s?Mc.noise(...d):o(...d),p=this.children[e++];p.scale.x=1+r(e,Ht(f,i.scale[0]))||rs,p.scale.y=1+r(e,Ht(f,i.scale[1]))||rs,p.scale.z=1+r(e,Ht(f,i.scale[2]))||rs;let v=r(e,Ht(f,i.rotation[0])),g=r(e,Ht(f,i.rotation[1])),m=r(e,Ht(f,i.rotation[2]));p.rotation.set(v,g,m),p.position.x=n.size[0]*c-l.x+r(e,Ht(f,i.position[0])),p.position.y=n.size[1]*h-l.y+r(e,Ht(f,i.position[1])),p.position.z=n.size[2]*u-l.z+r(e,Ht(f,i.position[2]))}}else for(let a=0;a<n.count[0];a++)for(let l=0;l<n.count[1];l++)for(let c=0;c<n.count[2];c++){let h=[(a+1)*(i.freqScale/10)+i.movement,(l+1)*(i.freqScale/10)+i.movement,(c+1)*(i.freqScale/10)+i.movement],u=s?Mc.noise(...h):o(...h),d=this.children[e++];d.scale.x=1+r(e,Ht(u,i.scale[0]))||rs,d.scale.y=1+r(e,Ht(u,i.scale[1]))||rs,d.scale.z=1+r(e,Ht(u,i.scale[2]))||rs;let f=r(e,Ht(u,i.rotation[0])),p=r(e,Ht(u,i.rotation[1])),v=r(e,Ht(u,i.rotation[2]));d.rotation.set(f,p,v),d.position.x=n.size[0]*a+r(e,Ht(u,i.position[0])),d.position.y=-n.size[1]*l+r(e,Ht(u,i.position[1])),d.position.z=-n.size[2]*c+r(e,Ht(u,i.position[2]))}}_updateToObject(t){var v;if(t.type!=="toObject")throw new Error;let{toObject:e}=t,n=new Tr(e.rotation[0],e.rotation[1],e.rotation[2]),i=t.randomnessObject??dh.defaultData([1,1,1]).randomnessObject,r=i.noiseType==="perlin";Mc.noiseSeed(i.seed);let s=w2((0,C0.default)(i.seed)),o=US(i.strength,this.parameters.randomness);if(!e.object){for(let[,g]of this.children.entries())g.position.set(0,0,0),g.scale.setScalar(1),g.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof AZ)if(!((v=this.objectForSample.font)!=null&&v.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let a=this.getSubdivData(),l=[],c=g=>{let m=g.length,y=g.map(A=>A[0]).reduce((A,b)=>A+b,0),_=g.map(A=>A[1]).reduce((A,b)=>A+b,0),S=g.map(A=>A[2]).reduce((A,b)=>A+b,0);return[y/m,_/m,S/m]},h=g=>Math.round(g*1e6)/1e6;a.forEach(g=>{let m=a.filter(y=>h(g.pos[0])===h(y.pos[0])&&h(g.pos[1])===h(y.pos[1])&&h(g.pos[2])===h(y.pos[2]));m.length>1?l.push({pos:g.pos,norm:c(m.map(y=>y.norm))}):l.push(g)});let u=qBe(l);if(a.length>0){let g=Math.round(u.length*e.count/100);this._updateCount(g)}this.objectForSample.updateMatrixWorld();let d=new lIe(this.objectForSample).build(),f=XBe[e.axis],p=this.children;d.setRandomGenerator((0,C0.default)(this.object.uuid+e.seed));for(let[g,m]of p.entries()){let y=g*(i.freqScale/10)+i.movement,_=r?Mc.noise(y):s(y,y),S=o(g,Ht(_,i.rotation[0])),A=o(g,Ht(_,i.rotation[1])),b=o(g,Ht(_,i.rotation[2]));e.spreadType==="random"?d.sample(O0,N2):(u.length&&(O0.fromArray(u[g].pos),N2.fromArray(u[g].norm)),this.objectForSample instanceof kx&&O0.applyMatrix4(rOe.copy(this.objectForSample.matrixWorld).invert())),O0.applyMatrix4(this.object.hiddenMatrix.clone().invert()),m.position.copy(O0),Uu.fromArray(f);let T=e.align==="normal"?N2:this.object.getWorldDirection(aOe),M=Cd.fromArray(e.position);Cd.x+=Cd.x+o(g,Ht(_,i.position[0])),Cd.y+=Cd.y+o(g,Ht(_,i.position[1])),Cd.z+=Cd.z+o(g,Ht(_,i.position[2]));let E=Math.acos(T.dot(Uu)),P=oOe.crossVectors(Uu,T).normalize(),R=sOe.makeRotationAxis(P,E),F=T.clone().cross(this.object.up).normalize(),B=F.clone().cross(T).normalize(),k=new nt().makeBasis(F,T,B),j=new N(Uu.y,Uu.z,Uu.x).normalize(),Z=j.clone().cross(Uu).normalize(),ee=new nt().makeBasis(j,Uu,Z).invert(),O=new nt().multiplyMatrices(k,ee);m.rotation.setFromRotationMatrix(O),M.applyMatrix4(R),m.position.add(M),m.rotation.x=m.rotation.x+n.x+S,m.rotation.y=m.rotation.y+n.y+A,m.rotation.z=m.rotation.z+n.z+b,m.scale.setScalar(1),m.scale.x=m.scale.x+e.scale[0]+o(g,Ht(_,i.scale[0]))||rs,m.scale.y=m.scale.y+e.scale[1]+o(g,Ht(_,i.scale[1]))||rs,m.scale.z=m.scale.z+e.scale[2]+o(g,Ht(_,i.scale[2]))||rs,m.scale.multiply(this.object.scale),m.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let t=this.parameters.toObject.spreadType;if(t==="random")return[];if(this.objectForSample instanceof kx){let e=this.objectForSample,n=YBe[t],i=CZ[n],r=MZ[n],s=EZ[n],o=[],a=i(e.subdivPointerNew);for(let l=0;l<=a-1;l++){let c=r(e.subdivPointerNew,l),h=s(e.subdivPointerNew,l);s6.fromArray(c).applyMatrix4(e.matrixWorld),o6.fromArray(h),o.push({pos:s6.toArray(),norm:o6.toArray()})}return o}else return(this.objectForSample.geometry.index?ZBe(this.objectForSample.geometry):$Be(this.objectForSample.geometry)).map((e,n)=>t==="polygon_center"?{pos:e.midpoint,norm:e.norm}:t==="vertex"?[{pos:e.vertices[0],norm:e.norm},{pos:e.vertices[1],norm:e.norm},{pos:e.vertices[2],norm:e.norm}]:t==="edge"?[{pos:e.faceCenters[0],norm:e.norm},{pos:e.faceCenters[1],norm:e.norm},{pos:e.faceCenters[2],norm:e.norm}]:[]).flat()}updateState(t,e){var n;if(this.parameters=yE(t),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(n=this.object.parent)==null||n.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let i=e.find(this.parameters.toObject.object);i instanceof zs?this.objectForSample=i:this.objectForSample=void 0,this.matrix=new nt,this.hiddenMatrix=new nt,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,i&&i.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},R1=t=>{var e;return e=class extends t{},e.geometryHelper=new Zl(30,30,30),e},GS=new uv,U2=new la,a6=new nt,L1=(t,e,n,i,r=!1)=>{let s=e,o=t.matrixWorld;if(s.boundingSphere===null&&s.computeBoundingSphere(),U2.copy(s.boundingSphere),U2.applyMatrix4(o),n.ray.intersectsSphere(U2)===!1||(a6.copy(o).invert(),GS.copy(n.ray).applyMatrix4(a6),s.boundingBox!==null&&GS.intersectsBox(s.boundingBox)===!1))return;let a,l,c,h,u=s.index,d=s.attributes.position,f=s.drawRange,p,v;if(r===!1){let m=Math.max(0,f.start),y=Math.min(u.count,f.start+f.count);for(p=m,v=y;p<v;p+=3)if(l=u.getX(p),c=u.getX(p+1),h=u.getX(p+2),a=g(t,n,GS,d,l,c,h),a){a.faceIndex=Math.floor(p/3),i.push(a);return}}else{let m=s.attributes.position,y=new N,_=new N,S=new N,A=new N,b=2,T=1/((t.scale.x+t.scale.y+t.scale.z)/3),M=T*T,E=Math.max(0,f.start),P=Math.min(m.count,f.start+f.count);for(let R=E,F=P-1;R<F;R+=b){if(y.fromBufferAttribute(m,R),_.fromBufferAttribute(m,R+1),GS.distanceSqToSegment(y,_,A,S)>M)continue;A.applyMatrix4(t.matrixWorld);let B=n.ray.origin.distanceTo(A);B<n.near||B>n.far||i.push({distance:B,point:S.clone().applyMatrix4(t.matrixWorld),object:t})}}function g(m,y,_,S,A,b,T){let M=new N,E=new N,P=new N,R=new N,F=new N;if(M.fromBufferAttribute(S,A),E.fromBufferAttribute(S,b),P.fromBufferAttribute(S,T),_.intersectTriangle(M,E,P,!1,R)===null)return null;F.copy(R),F.applyMatrix4(m.matrixWorld);let B=y.ray.origin.distanceTo(F);return B<y.near||B>y.far?null:{faceIndex:1,distance:B,point:F.clone(),object:m}}},HS=new N,Uo=new dv,lOe=class extends C1{constructor(t){let e=new Lt,n=new $h({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],r=[],s={},o=new Rt(15711266),a=new Rt(15711266),l=new Rt(2857471);c("n1","n2",o),c("n2","n4",o),c("n4","n3",o),c("n3","n1",o),c("f1","f2",o),c("f2","f4",o),c("f4","f3",o),c("f3","f1",o),c("n1","f1",o),c("n2","f2",o),c("n3","f3",o),c("n4","f4",o),c("p","n1",a),c("p","n2",a),c("p","n3",a),c("p","n4",a),c("u1","u2",l),c("u2","u3",l),c("u3","u1",l);function c(u,d,f){h(u,f),h(d,f)}function h(u,d){i.push(0,0,0),r.push(d.r,d.g,d.b),s[u]===void 0&&(s[u]=[]),s[u].push(i.length/3-1)}e.setAttribute("position",new ft(i,3)),e.setAttribute("color",new ft(r,3)),super(e,n),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let t=this.geometry,e=this.pointMap;Uo.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let n=1,i=1,r=.8;Ea("n1",e,t,Uo,-n,-i,r),Ea("n2",e,t,Uo,n,-i,r),Ea("n3",e,t,Uo,-n,i,r),Ea("n4",e,t,Uo,n,i,r);let s=r;Ea("f1",e,t,Uo,-n,-i,s),Ea("f2",e,t,Uo,n,-i,s),Ea("f3",e,t,Uo,-n,i,s),Ea("f4",e,t,Uo,n,i,s);let o=s,a=.5;Ea("u1",e,t,Uo,n*.7*a,i*1.1,o),Ea("u2",e,t,Uo,-n*.7*a,i*1.1,o),Ea("u3",e,t,Uo,0,i*(1.1+.9*a),o),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function Ea(t,e,n,i,r,s,o){HS.set(r,s,o).unproject(i);let a=e[t];if(a!==void 0){let l=n.getAttribute("position");for(let c=0,h=a.length;c<h;c++)l.setXYZ(a[c],HS.x,HS.y,HS.z)}}var cOe=class extends R1(lOe){constructor(t){super(t),this.object=t,this.object=t,this.name=`CombinedCameraHelper: ${t.uuid}`}updateMatrixWorld(t){super.updateMatrixWorld(t),this.updateTarget()}updateTarget(){let t=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(t)}raycast(t,e){L1(this.object,this.geometry,t,e,!0)}},CI;(t=>t.is=e=>"objectHelper"in e)(CI||(CI={}));var TE=(t,e)=>class extends gJ(t){constructor(){super(...arguments),this.objectHelper=new e(this),this.gizmos={}}get geometryHelper(){return e.geometryHelper}raycast(n,i){this.objectHelper.raycast(n,i)}showGizmos(){for(let n in this.gizmos){let i=this.gizmos[n];i instanceof PA&&(i.visible=!0)}}updateEntityBoxSize(n,i){this.objectHelper.visible&&this.geometryHelper instanceof Zl?(n.setScalar(0),i.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(n,i)}hideGizmos(){for(let n in this.gizmos){let i=this.gizmos[n];i instanceof PA&&(i.visible=!1)}}},k2=790,tm=new N,z2=new N,G2=new on,H2=new N,F0=new N,V2=new N,Us=class extends TE(dv,cOe){constructor(t="",e={...XA.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=Bx.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(t,e),this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let n=this.width,i=this.height;if(e.orthographic.autoZoom){let r=e.orthographic.autoZoomFrustumSize??k2,s=n/i,o=n>i?s:1,a=n>i?1:s;this.orthoCamera=new AA(-r*.5*o,r*.5*o,r*.5*(1/a),-r*.5*(1/a),-5e4,1e4)}else this.orthoCamera=new AA(n*-.5,n*.5,i*.5,i*-.5,-5e4,1e4);this.perspCamera=new Yr(45,n/i,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(t){this.perspCamera.fov=t}get fov(){return this.perspCamera.fov}setNear(t,e){t==="PerspectiveCamera"?this.perspCamera.near=e:this.orthoCamera.near=e}setZoom(t,e){e>=0&&(t==="PerspectiveCamera"?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}set cameraType(t){t==="PerspectiveCamera"?this.toPerspective():t==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(t){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=t:this.orthoCamera.near=t}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(t){t>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}lookAt(t,e,n){typeof t=="number"&&(t=new N(t,e,n)),super.lookAt(t),this.getWorldPosition(tm),this.targetOffset=tm.distanceTo(t)}getTarget(t=new N){return this.getWorldDirection(z2),this.getWorldPosition(tm),z2.multiplyScalar(this.targetOffset),t.copy(tm).add(z2),t}getDistanceToTarget(){let t=this.getTarget();return this.getWorldPosition(tm),tm.distanceTo(t)}updateUp(){this.getWorldQuaternion(G2),H2.set(0,0,1).applyQuaternion(G2),F0.copy(Fn.DEFAULT_UP),this.isUpVectorFlipped&&F0.negate(),F0.applyQuaternion(G2),V2.copy(Fn.DEFAULT_UP).projectOnPlane(H2),this.angleOffsetFromUp=V2.angleTo(F0),this.angleOffsetFromUp*=V2.cross(F0).dot(H2)>=0?1:-1}updateTransformState(t){let e=super.updateTransformState(t);return t.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=t.isUpVectorFlipped),this.updateUp(),e}getViewFrontToObject(t){let e=t.getWorldPosition(new N),n=t.getWorldDirection(new N).multiplyScalar(this.targetOffset);return{position:e.clone().add(n),target:e}}getViewToObject(t){let e=t.getWorldPosition(new N),n=this.getWorldDirection(new N).multiplyScalar(this.targetOffset);return{position:e.clone().sub(n),target:e}}setViewplaneSize(t,e){if(this.aspect=t/e,this.data.type==="OrthographicCamera"&&this.data.orthographic.autoZoom){let n=this.data.orthographic.autoZoomFrustumSize??k2,i=t>e?this.aspect:1,r=t>e?1:this.aspect;this.left=-n*.5*i,this.right=n*.5*i,this.top=n*.5*(1/r),this.bottom=-n*.5*(1/r)}else this.left=-t*.5,this.right=t*.5,this.top=e*.5,this.bottom=-e*.5;this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(t){this.perspCamera.setFocalLength(t),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(t,e,n,i,r,s){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(t,e,n,i,r,s):this.orthoCamera.setViewOffset(t,e,n,i,r,s)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(t,e){return super.copy(t,e),this.parent=t.parent,this.orthoCamera.copy(t.orthoCamera),this.perspCamera.copy(t.perspCamera),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.far=t.far,this.view=t.view===null?null:Object.assign({},t.view),this._cameraType=t._cameraType,this.aspect=t.aspect,this.fov=t.fov,this.focus=t.focus,this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this.targetOffset=t.targetOffset,this.updateProjectionMatrix(),this}toCameraState(t=[]){let e={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom,autoZoom:!0,autoZoomFrustumSize:k2},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return HL(e,t)}updateCameraSubtype(t,e){let n=t==="perspective"?"PerspectiveCamera":"OrthographicCamera";e.zoom!==void 0&&this.setZoom(n,e.zoom),e.near!==void 0&&this.setNear(n,e.near),e.fov!==void 0&&n==="PerspectiveCamera"&&(this.fov=e.fov)}updateState(t,e){this.updateCameraState(t,e)}updateCameraState(t,e){this.updateState_Entity(t,e),t.far!==void 0&&(this.far=t.far),t.orthographic!==void 0&&this.updateCameraSubtype("orthographic",t.orthographic),t.perspective!==void 0&&this.updateCameraSubtype("perspective",t.perspective),t.type!==void 0&&(this.cameraType=t.type),t.up!==void 0&&this.up.fromArray(t.up),t.targetOffset!==void 0&&(this.targetOffset=t.targetOffset),t.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=t.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(t,e,n){super.updateByPatchedOp(t,e,n),t.path.length===1&&t.type===0&&this.updateCameraSubtype(t.path[0],t.props)}toState(t){return{...super.toState(t),...this.toCameraState(t),type:this.cameraType}}},l6=new nt;function c6(t){let e=!1;return t.scene.objects.traverse((n,i)=>{var r;((r=i.geometry)==null?void 0:r.type)==="BooleanGeometry"&&(e=!0)}),e}var Yg=class extends CE{constructor(t,e,n){super(t,e),this.data=e,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new Lt,this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(t,e,n){super.updateByPatchedOp(t,e,n),t.path.length===1&&t.path[0]==="geometry"&&t.type===0&&t.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(t,e=!0){var i;if(this.booleanMeshSetAddress!==-1&&!t)return;for(let r=0;r<this.children.length;r++){let s=this.children[r];s instanceof Yg&&s.recomputeBoolean(t===!0,e)}this.meshSetAddresses=[];for(let r=0;r<this.children.length;r++){let s=this.children[r];if(s instanceof zs&&s.dataPatched.visible===!0&&((i=s.geometry.attributes.position)==null?void 0:i.count)>0&&s.geometry.drawRange.count>0){if(s.booleanMeshSetAddress===-1){if((s.geometry.index??s.geometry.getAttribute("position")).count/3<15e5&&(s.booleanMeshSetAddress=Ju.getMeshSet(s.geometry,t===!0,e)),s.booleanMeshSetAddress===-1)return;Ju.transformMeshSet(s.booleanMeshSetAddress,s.matrix),s.booleanMatrixInvOld.copy(s.matrix).invert(),s.booleanWasTransformed=!1}else s instanceof Yg&&s.needsTransformForDownstream===!0?(Ju.transformMeshSet(s.booleanMeshSetAddress,s.matrix),s.needsTransformForDownstream=!1):s.booleanWasTransformed===!0&&(l6.multiplyMatrices(s.matrix,s.booleanMatrixInvOld),Ju.transformMeshSet(s.booleanMeshSetAddress,l6),s.booleanMatrixInvOld.copy(s.matrix).invert(),s.booleanWasTransformed=!1);this.meshSetAddresses.push(s.booleanMeshSetAddress)}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new bxe([],0)),this.geometry.setDrawRange(0,0);return}if(t===!0)return Ju.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let n=this.geometry;n.dispose(),this.geometry=new Lt,this.geometry.userData=n.userData,this.geometry.boundingSphere=n.boundingSphere;try{this.booleanMeshSetAddress=Ju.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(r){this.booleanMeshSetAddress=0,console.error(r)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,xF(this),_F(this)}dispose(){super.dispose(),this.geometry.dispose()}},TI;(t=>{function e(n){return Pn.is(n)&&n instanceof T1}t.is=e})(TI||(TI={}));var wF=(t,e)=>class extends TE(t,e){updateState_Light(n,i){this.updateState_Entity(n,i),n.color!==void 0&&(this.color=i.shared.color(n.color)),n.intensity!==void 0&&(this.intensity=n.intensity),n.depth!==void 0&&(this.shadow.camera.far=n.depth,this.shadow.needsUpdate=!0),n.shadows!==void 0&&(this.castShadow=n.shadows)}},Ol=t=>t instanceof zs,Hc=t=>t!==null&&t instanceof Yg,uOe=t=>t instanceof Us,hOe=t=>TI.is(t),u6=t=>CI.is(t),SF=class extends R1(iAe){constructor(t,e=15){super(e),this.object=t,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${t.uuid}`,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}raycast(t,e){L1(this.object,SF.geometryHelper,t,e)}update(){}},lM=class extends TE(km,SF){constructor(t,e){super(),this.super_Entity(t,e),this.objectHelper.update()}updateState(t,e){this.updateState_Entity(t,e)}},TZ=class extends R1(nAe){constructor(t,e=15,n=10066329){super(t,e,n),this.object=t,this.added=!1,this.name=`DirectionalLightHelper: ${t.uuid}`}raycast(t,e){L1(this.object,TZ.geometryHelper,t,e)}},PZ=class extends R1(tAe){constructor(t,e=15,n=6710886){super(t,e,n),this.object=t,this.name=`PointLightHelper: ${t.uuid}`}raycast(t,e){L1(this.object,PZ.geometryHelper,t,e)}},PI=class extends R1(eAe){constructor(t,e=6710886){super(t,e),this.object=t,this.name=`SpotLightHelper: ${t.uuid}`}raycast(t,e){L1(this.object,PI.geometryHelper,t,e)}update(){if(this.object!==void 0){let t=PI._vector,e=this.object.distance?this.object.distance:1e3,n=e*Math.tan(this.object.angle);this.cone.scale.set(n,n,e),t.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(t);let i=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let r=0,s=this.cone.material.length;r<s;r++)this.cone.material[r].color.set(i);else this.cone.material.color.set(i)}}},DZ=PI;DZ._vector=new N;function dOe(t,e){t.shadow.camera.right=e/2,t.shadow.camera.left=-e/2,t.shadow.camera.top=e/2,t.shadow.camera.bottom=-e/2,t.shadow.needsUpdate=!0}var fOe=class extends wF(Qbe,TZ){constructor(t,e,n){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.top=1250,i.bottom=-1250,i.right=1250,i.left=-1250,i.near=-1e4,i.far=2500;let r=new TA(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r}update(){this.shadow.camera.updateProjectionMatrix();for(let t in this.gizmos){let e=this.gizmos[t];e instanceof TA&&e.update()}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e);let n=t.depth!==void 0&&t.depth!==this.shadow.camera.far||t.size!==void 0&&t.size/2!==this.shadow.camera.right;t.size!==void 0&&dOe(this,t.size),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),n&&this.update()}},pOe=class extends wF(Ybe,PZ){constructor(t,e,n){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=90,i.aspect=1,i.near=100,i.far=2500;let r=new N(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),s=new N(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z),o=new Vi(r,s),a=new PA(o,new Rt(16755200));a.visible=!1,this.gizmos.shadowmap=a,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let t in this.gizmos){let e=this.gizmos[t];if(e instanceof PA){let n=this.shadow.camera,i=new N(-n.far+this.position.x,-n.far+this.position.y,-n.far+this.position.z),r=new N(n.far+this.position.x,n.far+this.position.y,n.far+this.position.z);e.box.set(i,r),e.updateMatrixWorld(!0)}}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e),t.distance!==void 0&&(this.distance=t.distance),t.decay!==void 0&&(this.decay=t.decay),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},h6=new N,d6=new N,f6=new on,mOe=class extends wF(Wbe,DZ){constructor(t,e,n){super(),this.super_Entity(t,e),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let i=this.shadow.camera;i.fov=sn.RAD2DEG*2*this.angle,i.aspect=1,i.near=100,i.far=2500;let r=new TA(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let t in this.gizmos){let e=this.gizmos[t];e instanceof TA&&e.update()}}updateMatrixWorld(t){super.updateMatrixWorld(t),d6.setFromMatrixPosition(this.matrixWorld),f6.setFromRotationMatrix(this.matrixWorld),h6.copy(this.up).applyQuaternion(f6).negate().multiplyScalar(this.distance),this.target.position.copy(d6).add(h6),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(t,e){this.updateState_Light(t,e),t.distance!==void 0&&(this.distance=t.distance),t.decay!==void 0&&(this.decay=t.decay),t.angle!==void 0&&(this.angle=t.angle),t.penumbra!==void 0&&(this.penumbra=t.penumbra),t.shadowRadius!==void 0&&(this.shadow.radius=t.shadowRadius),t.shadowResolution!==void 0&&(this.shadow.mapSize.set(t.shadowResolution,t.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},gOe=class extends ua{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(t,e){let n=this.geometry.getAttribute("position");n!==void 0?mF(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,t,e):super.updateEntityBoxSize(t,e)}},bF=class extends ua{constructor(t,e,n){super(t,e,n),this._shapeId=null,this._context=n}updateState(t,e){super.updateState(t,e),this.updateShape()}updateShape(){var i;let t=this.data.geometry.extrusion.shape,e;if(t.type==="Custom"){let r=t.shapeId;if(r!==this._shapeId&&this.detachShape(),r){this._shapeId=r;let s=this._context.scene.find(r);s!=null&&s.data&&(s.attachedPaths.add(this),e=(i=s.geometry.userData)==null?void 0:i.shape),e||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let r;switch(t.type){case"Rectangle":r=BJ;break;case"Ellipse":r=hF;break;case"Polygon":r=IJ;break;case"Star":r=OJ;break;default:throw new Error(`Unknown shape type: ${t.type}`)}e=r.create({parameters:t}).userData.shape}let n=this.geometry;e&&n.inputs&&(n.inputs.shapeData=e,n.build(),this.attachedSurfaceCloners.forEach(r=>r.update()))}detachShape(){var t;this._shapeId!==null&&((t=this._context.scene.find(this._shapeId))==null||t.attachedPaths.delete(this))}createGeometryDelayed(t){this.geometryCreateDeleyed=t.shared,this.updateShape(),this.refreshAttachedPaths(t)}updateTransformState(t){return super.updateTransformState(t)}updateGeometryInteractions(t,e){super.updateGeometryInteractions(t,e),this.updateShape()}updateEntityBoxSize(t,e){let n=this.geometry.getAttribute("position");n!==void 0?mF(n,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:n.count,t,e):super.updateEntityBoxSize(t,e)}},vg=class extends TE(km,SF){constructor(t,e,n){super(),e.type==="Instance"&&typeof t=="string"&&(e=this.transformAssignData(e,n)),this.super_Entity(t,e),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(t,e){let n=e.scene.data.objects.get(t.component);if(n){let i,r;for(let s of Wg.rootOverrideProps)t[s]===void 0?(i===void 0&&(i={...t}),i[s]=n.data[s]):(r===void 0&&(r={}),r[s]=t[s]);return this.overrideData=r,i??t}return t}updateByOp(t,e,n,i){let r;if(this.isInstanceRoot&&!i&&(e=this.transformAssignData(e,n),t.type===0&&t.path.length===0&&this.component))for(let s of Wg.rootOverrideProps)s in t.props&&t.props[s]===void 0&&(r===void 0&&(r={...t,props:{...t.props}}),r.props[s]=this.component.data[s]);super.updateByOp(r??t,e,n,i)}updateState(t,e){this.updateState_Entity(t,e)}expandInstanceChildren(t){let e=this.data;if(this.component===void 0){this.component=t.scene.find(e.component)??null;let n=!1;if(this.component!==this.oldComponent){if(this.oldComponent){let i=0;for(let r of this.children)if(Pn.is(r))t.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(r),AF(r),i+=1;else break;this.children.splice(0,i)}n=!0}this.component&&RZ(t,[this.uuid],e.overrides,this,this.component,this.component,0,n),this.oldComponent=this.component}}};function AF(t){if(t.component){let e=t.component.instances.indexOf(t);e>=0&&t.component.instances.splice(e,1);for(let n of t.children)Pn.is(n)&&AF(n)}}function p6(t,e,n,i){return t.component===e&&qO(t.identity,i)?t.overrideData===n?2:1:0}function RZ(t,e,n,i,r,s,o,a){if(o>50)return!1;if(i.component!==r){if(i.component){let c=i.component.instances.indexOf(i);c>=0&&i.component.instances.splice(c,1)}r.instances.push(i),i.component=r}r instanceof vg&&r.isInstanceRoot&&r.expandInstanceChildren(t);let l=0;for(let c of r.children)if(Pn.is(c)){let h=[...e,...typeof c.identity=="string"?[c.identity]:c.identity],u=YA.resolve(n,h,1),d=null,f;if(!a){let p=i.children[l];if(d=Pn.is(p)?p:null,d!==null){let v=p6(d,c,u,h);f=v>=1?d.stateSelection:void 0,v!==2&&(d=null)}if(d===null&&(d=t.scene.findInstance(h)??null,d!==null)){let v=p6(d,c,u,h);if(f=v>=1?d.stateSelection:void 0,v!==2)d=null;else{let g=d.parent.children.indexOf(d);d.parent.children.splice(g,1),i.children.splice(l,0,d),d.parent===i?g<=l&&console.error("not possible"):(d.parent=i,d.matrixWorldNeedsUpdate=!0,d.resetBBoxNeedsUpdate(),d.updateVisible(),t.pendingDeletes.delete(d))}}}if(d===null){let p=u?vf.apply(c.data,u):c.data;Of.is(p.type)&&(p={...p,type:"Empty"}),d=fh.createEntity(h,p,t),d.overrideData=u,i.add(d),i.children.splice(i.children.length-1,1),i.children.splice(l,0,d),d.updateState(d.data,t),f&&d.changeSelectedState(f,t),t.scene.registerInstanceAndSetUuid(d)}l+=1,RZ(t,e,n,d,c,s,o+1,a)}if(!a){let c=l;for(;;){let h=i.children[l];if(Pn.is(h))t.pendingDeletes.add(h);else break;l+=1}i.children.splice(c,l-c)}return!0}function vOe(t,e,n){let i;return e.geometry.type==="TextGeometry"?new AZ(t,e,n):(e.geometry.type==="SubdivGeometry"?i=new kx(t,e,n):e.geometry.type==="PathGeometry"?i=new bF(t,e,n):e.geometry.type==="VectorGeometry"?i=new gOe(t,e,n):e.geometry.type==="BooleanGeometry"?i=new Yg(t,e,n):i=new ua(t,e,n),i)}function MF(t,e,n){return e.type==="Mesh"?vOe(t,e,n):e.type==="Empty"?new lM(t,e):e.type==="PointLight"?new pOe(t,e,n):e.type==="SpotLight"?new mOe(t,e,n):e.type==="DirectionalLight"?new fOe(t,e,n):e.type==="Component"||e.type==="Instance"?new vg(t,e,n):Of.is(e.type)?new Us(t,e):(console.error(e),new lM(t,e))}fh.createEntity=MF;function yOe(t,e,n){let i=MF(t.identity,e,n),r=t.children,s=t.attachedPaths,o=t.parent,a=t.component,l=t.instances,c=t.overrideData,h=t.uuid,u=t.stateSelection;t.dispose();for(let d of Object.keys(t))delete t[d];Object.setPrototypeOf(t,Object.getPrototypeOf(i));for(let d of Object.keys(i))t[d]=i[d];t.children=[...t.children,...r],t.attachedPaths=s,t.parent=o,t.component=a,t.instances=l,t.uuid=h,t.overrideData=c,t.updateState(t.data,n),u&&t.changeSelectedState(u,n),t.resetBBoxNeedsUpdate()}fh.changeEntityProptotype=yOe;fh.Cloner=rf;function xOe(t,e,n,i){t.updateByOp(e,n,i,!1)}function m6(t,e){let n=!1,i=e.getLayersOfType("transmission"),r=e.getLayersOfType("outline");return r.length>0&&(t.layers.set(8),i.length>0&&t.layers.enable(3),n=!0,_F(t),xF(t)),i.length===0&&r.length===0&&t.layers.set(0),n}function g6(t,e){if(!e.layers)return!1;let n=!1,i=e.getLayersOfType("transmission").filter(s=>s.data.visible),r=e.getLayersOfType("outline").filter(s=>s.data.visible);return i.length>0&&(t.layers.set(3),r.length>0&&t.layers.enable(8),n=!0),i.length===0&&r.length===0&&t.layers.set(0),n}function _Oe(t){let e=!1;return t.traverseEntity(n=>{if(n instanceof CE)if(Array.isArray(n.material))for(let i=0;i<n.material.length;i++)m6(n,n.material[i])&&(e=!0);else m6(n,n.material)&&(e=!0)}),e}function wOe(t){let e=!1;return t.traverseEntity(n=>{if(n instanceof CE)if(Array.isArray(n.material))for(let i=0;i<n.material.length;i++)g6(n,n.material[i])&&(e=!0);else g6(n,n.material)&&(e=!0)}),e}var SOe=new YQ,bOe=new nt,AOe=new uv;function v6(t,e,n,i=!1){let r=t.cloner;if(r)for(let s of r.children){let o=bOe.copy(s.matrixWorld).invert(),a=AOe.copy(e.ray).applyMatrix4(o),l=t.matrixWorld;a.applyMatrix4(l);let c=SOe;c.set(a.origin,a.direction),c.near=e.near,c.far=e.far;let h=c.intersectObject(t,!1);h.length>0&&n.push({...h[0],object:i?s:t})}}var MOe=t=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${t};
const int gShadowSamples = ${t};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

vec2 vogelDiskSample(int sample_index, int sample_count, float angle)
{
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sample_index) + 0.5f) / sqrt(float(sample_count));
  float theta = float(sample_index) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// NOTE: For now we aren't using this screen-space noise. But we should enable
// it again once we do some sort of temporal AA. Then we could potentially lower
// the number of samples needed and still get a pretty smooth result.
// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos)
{
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

vec4 shadowmod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}
vec4 shadowperm(vec4 x){return shadowmod289(((x * 34.0) + 1.0) * x);}
float shadowNoise(vec3 p){
            vec3 a = floor(p);
            vec3 d = p - a;
            d = d * d * (3.0 - 2.0 * d);
            vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
            vec4 k1 = shadowperm(b.xyxy);
            vec4 k2 = shadowperm(k1.xyxy + b.zzww);
            vec4 c = k2 + a.zzzz;
            vec4 k3 = shadowperm(c);
            vec4 k4 = shadowperm(c + 1.0);
            vec4 o1 = fract(k3 * (1.0 / 41.0));
            vec4 o2 = fract(k4 * (1.0 / 41.0));
            vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
            vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
            return o4.y * d.y + o4.x * (1.0 - d.y);
        }

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;
    float temporalOffset = shadowNoise(floor(vWPosition * 10.));

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    //float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        float temporalOffset = shadowNoise(floor(vWPosition * 10.));
        float temporalAngle  = temporalOffset * PI2;


        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,EOe=jt.lights_fragment_begin,COe=jt.shadowmask_pars_fragment,y6=!1,TOe=t=>{switch(t){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},POe=(t="medium")=>{if(y6)return;y6=!0;let e=TOe(t);jt.shadowmap_pars_fragment=MOe(e);let n=EOe.slice();n=n.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),n=n.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),jt.lights_fragment_begin=n;let i=COe.slice();i=i.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),jt.shadowmask_pars_fragment=i},DOe=`
attribute vec3 randomColor;
varying vec3 vNormal;
flat out vec3 vColor;

void main()
{
vNormal = normal;
vColor = randomColor;
gl_Position = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
}
`,ROe=`
uniform float depthContrast;
varying vec3 vNormal;
flat in vec3 vColor;
void main()
{
vec3 normal = (normalize(vNormal)).rgb;

float contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;

vec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);
gl_FragColor = vec4(resultColor, vColor.r);
}
`,j2=new nr({vertexShader:DOe,fragmentShader:ROe,uniforms:{depthContrast:{value:1}}}),LOe=class{constructor(){this._constraints=new Map}setConstraint(t,e){e===null?this._constraints.delete(t):this._constraints.set(t,e)}removeDependencies(t){this._constraints.delete(t)}applyConstraints(t){let e=new Set;this._constraints.forEach((n,i)=>{let r=[i,n],s=n;for(;this._constraints.has(s);)s=this._constraints.get(s),e.has(s)||r.push(s);for(let o=r.length-2;o>=0;o--)if(!e.has(r[o])){let a=t.find(r[o]);a?a.applyPathSnapping(t):console.warn(`missing entity ${r[o]}`),e.add(r[o])}})}findDependency(t,e){let n=t;for(;this._constraints.has(n);)if(n=this._constraints.get(n),n===e)return!0;return!1}},DI=new E1;DI.wireframe=!0;var x6=new N,LZ=class extends gf{constructor(t,e){super(),this.data=t,this.backupFog=new LQ(16777215,.1,2e3),this.fogUseBGColor=!1,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.bgColor=new Ns(1,1,1,1),this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new LOe,this.needsRecomputeInstances=!1,this.ambientLight=new Vbe(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.personalCamera=this.createPersonalCamera(),this.activeCamera=this.personalCamera,this.postprocessing=t.postprocessing,this.init(t,e),this.matrixAutoUpdate=!1}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=wOe(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=_Oe(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(t){let e=t.identity.join("-"),n=this.entityIdentityToEntity[e];n&&(t.uuid=n.uuid),this.entityIdentityToEntity[e]=t,this.entityByUuid[t.uuid]=t}findInstance(t){return this.entityIdentityToEntity[t.join("-")]}getWithSortKey(t){let e=this.find(t);if(e===void 0)return;let n=[],i=e;for(;i!==this;){let r=i;i=i.parent;let s=i.children.indexOf(r);n.splice(0,0,s)}return{entity:e,sortKey:n}}getAllSorted(t){let e=[];for(let n of t){let i=this.getWithSortKey(n.id);i!==void 0&&e.push(i)}return e.sort((n,i)=>ZRe(n.sortKey,i.sortKey)),e.map(n=>n.entity)}nonExistOrDescendantOf(t,e){let n=this.find(t);if(n===void 0)return!0;for(;n;){if(n.uuid===e)return!0;n=n.parent}return!1}find(t){if(t===""||t===void 0)return;let e=this.entityByUuid[t];return e===void 0?this.getObjectByProperty("uuid",t):e}debugEnsureEntity(t){let e=this.find(t);if(e){if(Array.isArray(e.identity)&&this.findInstance(e.identity)===void 0){console.error("not found instance");debugger}}else{console.error("not found");debugger}}addPendingExpandCloner(t){this.toExpandCloner.add(t)}addPendingUpdateCloner(t){this.toUpdateCloner.add(t)}markToExpandCloner(t){this.toExpandCloner.add(t),t.traverseEntityAncestors(e=>{this.toExpandCloner.add(e)})}doPendingExpandCloner(){this.toExpandCloner.forEach(t=>{t.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(t=>{var e;(e=t.cloner)==null||e.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(t){this.pendingCommands.push(t)}applyPendingCommands(){this.pendingCommands.forEach(t=>t()),this.pendingCommands.length=0}updateTreeByOp(t,e){var n;if(t.path.length===0&&t.type===7){let i=t.parent===null?this:this.find(t.parent);if(i===void 0)throw new Error("unexpected");let r=this.createObject(t.id,t.data,t.children,i,t.localIndex,e);r.updateVisible(),r.resetBBoxNeedsUpdate(),Ol(r)&&Hc(r.parent)&&(r.invalidateUpstreamBooleanData(),r.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(i),this.markNeedsRecomputeInstancesForChildren(r),this.markToExpandCloner(r)}else if(t.path.length===0&&t.type===8){let i=this.find(t.id);if(i===void 0)throw new Error("unexpected");this.markToExpandCloner(i),i.resetBBoxNeedsUpdate(),this.unregisterObject(i);let r=i.parent;this.markNeedsRecomputeInstancesForAncessors(r),this.markNeedsRecomputeInstancesForChildren(i),i.parent.remove(i),Hc(i.parent)&&(i.parent.invalidateUpstreamBooleanData(),i.parent.invalidateDownstreamBooleanData().recomputeBoolean()),Ol(i)&&(i.freeBooleanPointer(),r instanceof Yg&&r.invalidateDownstreamBooleanData().recomputeBoolean()),i instanceof bF&&i.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(i),this.pathConstraints.removeDependencies(i.uuid)}else if(t.path.length===0&&t.type===9){let i=this.find(t.id);if(i===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(i);let r=i.parent;this.markNeedsRecomputeInstancesForAncessors(r),(n=i.cloner)==null||n.resetOnMove(),this.markToExpandCloner(i);let s=t.parent===null?this:this.find(t.parent);if(s===void 0)throw new Error("unexpected");s.add(i),this.markNeedsRecomputeInstancesForAncessors(s),this.markToExpandCloner(i),i.invalidateClonerTransform(i),i.updateVisible(),i.resetBBoxNeedsUpdate();let o=t.localIndex;s.children.splice(o,0,s.children.pop()),Ol(i)&&(i.invalidateUpstreamBooleanData(),Hc(i.parent)?i.parent.invalidateDownstreamBooleanData().recomputeBoolean():r instanceof Yg&&r.invalidateDownstreamBooleanData().recomputeBoolean())}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}updateEntityByOp(t,e,n,i){if(e.type===0){if(("overrides"in e.props||"component"in e.props)&&this.markNeedsRecomputeInstances(),e.path.includes("overrides")&&"states"in e.props){let{states:s,rest:o}=e.props;e={...e,props:o},this.markNeedsRecomputeInstances()}e.path[0]==="pathSnapping"&&e.props.pathId!==void 0&&this.pathConstraints.setConstraint(t,e.props.pathId)}let r=this.find(t);if(r)try{xOe(r,e,n,{scene:this,shared:i}),r instanceof ua&&r.updateGeometryGroupsIfNeeded()}catch(s){console.error(s)}}get enableFog(){return this.fog!==null}set enableFog(t){this.fog=t===!0?this.backupFog:null}init(t,e){if(this.createChildrenObjects(t.objects,this,e),this.personalCamera.removeFromParent(),this.add(this.personalCamera),this.ambientLight.removeFromParent(),this.add(this.ambientLight),this.setBackgroundColor(uo(t.backgroundColor,e)),this.updateFog(t.fog,e),this.updateAmbientLight(t.environment.ambientLight,e),this.activeCamera=this.personalCamera,t.publish.playCamera!==null){let n=this.find(t.publish.playCamera);n instanceof Us&&this.switchActiveCamera(n)}this.expandInstances(e,!0),this.traverseEntity(n=>{Hc(n)&&n.recomputeBoolean(),n instanceof Us&&n.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(t){t.traverseEntity(e=>{(e.data.type==="Component"||e.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(t){Pn.is(t)&&(t.data.type==="Component"&&this.markNeedsRecomputeInstances(),t.traverseAncestors(e=>{Pn.is(e)&&e.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(t,e,n,i,r,s,o){t&&t!==i.uuid&&i.find(t)&&r.forInstancesRec(a=>{a.isInstanceRoot||(a.data=NA(a.data,l=>{let c=l.events.data(o.id),h=a.goUp(s);if(h){let u=[...oJ(h.identity),t].join("-"),d=this.entityIdentityToEntity[u];if(d){let f=d.uuid;Wl.zoom(c,e)[n]=f}else console.warn("cannot find instance")}}).data)})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(t=>{if(t instanceof vg&&typeof t.identity=="string"&&t.data.type==="Component")return t.traverseEntity((e,n)=>{e.data.events.forEach(i=>{i.data.type==="GameControl"?e.forInstancesRec(r=>{r.isInstanceRoot||(r.data=NA(r.data,s=>{s.events.delete(i.id)}).data)}):i.data.type==="Conditional"?(i.data.condition.type==="Distance"?(this.relativeizeInner(i.data.condition.fromObject,["condition"],"fromObject",t,e,n,i),this.relativeizeInner(i.data.condition.toObject,["condition"],"toObject",t,e,n,i)):i.data.condition.type==="State"?this.relativeizeInner(i.data.condition.object,["condition"],"object",t,e,n,i):i.data.condition.type==="Comparison"&&(i.data.condition.lOperand.type==="Property"&&this.relativeizeInner(i.data.condition.lOperand.value[0],["condition","lOperand","value"],0,t,e,n,i),i.data.condition.rOperand.type==="Property"&&this.relativeizeInner(i.data.condition.rOperand.value[0],["condition","rOperand","value"],0,t,e,n,i)),i.data.inActions.forEach(r=>{r.data.type==="Transition"&&this.relativeizeInner(r.data.object,["inActions",r.id],"object",t,e,n,i)}),i.data.outActions.forEach(r=>{r.data.type==="Transition"&&this.relativeizeInner(r.data.object,["outActions",r.id],"object",t,e,n,i)})):"actions"in i.data&&i.data.actions.forEach(r=>{r.data.type==="Transition"&&this.relativeizeInner(r.data.object,["actions",r.id],"object",t,e,n,i)})})}),!0})}expandInstances(t,e){let n=new Set;this.traverseEntity(i=>{if(i instanceof vg&&i.isInstanceRoot)return i.expandInstanceChildren({scene:this,shared:t,pendingDeletes:n}),e||i.resetBBoxNeedsUpdate(),!0});for(let i of n)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(i),AF(i)}recomputeInstances(t){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(e=>{e instanceof vg&&e.isInstanceRoot&&(e.component=void 0)}),this.expandInstances(t,!1))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(t){t.traverseEntity(e=>{let n=typeof e.identity=="string"?e.identity:e.identity.join("-");this.entityIdentityToEntity[n]===e&&(delete this.entityByUuid[e.uuid],delete this.entityIdentityToEntity[n]),e.dispose()})}clearScene(){for(let t of this.children)Pn.is(t)&&t.disposeRecursively();this.children.length=0}resetAfterClear(t,e){this.init(t,e)}createPersonalCamera(){let t=new Us(LZ.PERSONAL_CAMERA_ID,{...XA.defaultData,name:"Personal Camera"});return t.objectHelper.visible=!1,this.registerObjectCreatedInLegacy(t),t}raycast(t){let e=[],n=i=>{for(let r of i.children){let s=r.cloner;Pn.is(r)&&!r.raycastLock&&(r.visible||s!=null&&s.object.data.visible)&&((Ol(r)||u6(r)&&this.enableHelpers&&r.objectHelper.visible)&&(t.intersectObject(r,!1,e),v6(r,t,e)),n(r))}};return n(this),e}raycastWithClones(t){let e=[],n=i=>{for(let r of i.children){let s=r.cloner;Pn.is(r)&&!r.raycastLock&&(r.visible||s!=null&&s.object.data.visible)&&((Ol(r)||u6(r)&&this.enableHelpers&&r.objectHelper.visible)&&(t.intersectObject(r,!1,e),v6(r,t,e,!0)),n(r))}};return n(this),e}forEachEntity(t){for(let e of this.children)Pn.is(e)&&t(e)}traverseEntity(t){for(let e of this.children)Pn.is(e)&&e.traverseEntity(t)}traverseObject(t){for(let e of this.children)nM.is(e)&&e.traverseObject(t)}traverseVisibleEntity(t){for(let e of this.children)Pn.is(e)&&e.visible&&e.traverseVisibleEntity(t)}updateFog(t,e){this.enableFog=t.enabled,this.fogUseBGColor=t.useBackgroundColor,t.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=uo(t.color,e),this.backupFog.near=t.near,this.backupFog.far=t.far}dispose(){this.clearScene()}updateAmbientLight(t,e){t.color!==void 0&&(this.ambientLight.color=uo(t.color,e)),t.intensity!==void 0&&(this.ambientLight.intensity=t.intensity),t.groundColor!==void 0&&(this.ambientLight.groundColor=uo(t.groundColor,e)),t.enabled!==void 0&&(this.ambientLight.visible=t.enabled)}switchActiveCamera(t){this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=t,t.objectHelper.visible=!1}setBackgroundColor(t){this.bgColor=t,this.fogUseBGColor===!0&&(this.backupFog.color=t)}createChildrenObjects(t,e,n){let i=0;for(let r of t)this.createObject(r.id,r.data,r.children,e,i,n),i+=1}registerObjectCreatedInLegacy(t){this.entityByUuid[t.uuid]=t}unregisterObject(t){delete this.entityByUuid[t.uuid];for(let e of t.children)this.unregisterObject(e)}createObject(t,e,n,i,r,s){var l;let o={scene:this,shared:s},a=MF(t,e,o);return a&&(this.entityByUuid[t]=a,i.add(a),i.children.splice(r,0,i.children.pop()),n.length>0&&(a.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(n,a,s)),a.updateState(e,o),a instanceof ua&&a.updateGeometryGroupsIfNeeded(),a.updateVisible(),a.cloner&&this.toExpandCloner.add(a),(l=e.pathSnapping)!=null&&l.pathId&&this.pathConstraints.setConstraint(t,e.pathSnapping.pathId)),a}getCenter(t){let e=[];for(let i=0,r=t.length;i<r;++i){let{id:s,recursive:o}=t[i],a=this.find(s),l=o?a.recursiveBBox:a.singleBBox;e.push(...l.vertices)}let n=new Vi;return n.setFromPoints(e),n.getCenter(x6),x6}copyMatrixWorld(t,e){if(t===null){e.identity();return}let n=this.find(t);n?e.copy(n.matrixWorld):e.identity()}copyParentMatrixWorld(t,e){var i;if(t===null){e.identity();return}let n=(i=this.find(t))==null?void 0:i.parent;n?e.copy(n.matrixWorld):e.identity()}traverseMaterial(t){this.traverseEntity(e=>{if(e instanceof zs)if(Array.isArray(e.material))for(let n=0;n<e.material.length;n++)e.material[n]instanceof jh&&t(e.material[n]);else e.material instanceof jh&&t(e.material)})}updateCanvasSize(t,e){this.activeCamera.setViewplaneSize(t,e);let n,i;t>=e?(n=e/t,i=1):(n=1,i=t/e),this.traverseMaterial(r=>{r.getLayersOfType("transmission").forEach(s=>{s.uniforms[`f${s.id}_aspectRatio`].value.x=n,s.uniforms[`f${s.id}_aspectRatio`].value.y=i})})}},Xl=LZ;Xl.PERSONAL_CAMERA_ID="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera",Xl.PERSONAL_CAMERA_EXPORT_ID="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCameraExport";var Rb=(t,e)=>{let n=e.x-t.x,i=e.y-t.y;return Math.sqrt(n*n+i*i)},IOe=(t,e)=>{let n=e.x-t.x,i=e.y-t.y;return OOe(Math.atan2(i,n))},BOe=(t,e,n)=>{let i={x:0,y:0};return n=RI(n),i.x=t.x-e*Math.cos(n),i.y=t.y-e*Math.sin(n),i},RI=t=>t*(Math.PI/180),OOe=t=>t*(180/Math.PI),FOe=t=>isNaN(t.buttons)?t.pressure!==0:t.buttons!==0,W2=new Map,_6=t=>{W2.has(t)&&clearTimeout(W2.get(t)),W2.set(t,setTimeout(t,100))},cM=(t,e,n)=>{let i=e.split(/[ ,]+/g),r;for(let s=0;s<i.length;s+=1)r=i[s],t.addEventListener?t.addEventListener(r,n,!1):t.attachEvent&&t.attachEvent(r,n)},w6=(t,e,n)=>{let i=e.split(/[ ,]+/g),r;for(let s=0;s<i.length;s+=1)r=i[s],t.removeEventListener?t.removeEventListener(r,n):t.detachEvent&&t.detachEvent(r,n)},IZ=t=>(t.preventDefault(),t.type.match(/^touch/)?t.changedTouches:t),S6=()=>{if(typeof window>"u")return;let t=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,e=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:t,y:e}},LI=(t,e)=>{e.top||e.right||e.bottom||e.left?(t.style.top=e.top,t.style.right=e.right,t.style.bottom=e.bottom,t.style.left=e.left):(t.style.left=e.x+"px",t.style.top=e.y+"px")},EF=(t,e,n)=>{let i=BZ(t);for(let r in i)if(i.hasOwnProperty(r))if(typeof e=="string")i[r]=e+" "+n;else{let s="";for(let o=0,a=e.length;o<a;o+=1)s+=e[o]+" "+n+", ";i[r]=s.slice(0,-2)}return i},NOe=(t,e)=>{let n=BZ(t);for(let i in n)n.hasOwnProperty(i)&&(n[i]=e);return n},BZ=t=>{let e={};return e[t]="",["webkit","Moz","o"].forEach(function(n){e[n+t.charAt(0).toUpperCase()+t.slice(1)]=""}),e},X2=(t,e)=>{for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},UOe=(t,e)=>{let n={};for(let i in t)t.hasOwnProperty(i)&&e.hasOwnProperty(i)?n[i]=e[i]:t.hasOwnProperty(i)&&(n[i]=t[i]);return n},II=(t,e)=>{if(t.length)for(let n=0,i=t.length;n<i;n+=1)e(t[n]);else e(t)},kOe=(t,e,n)=>({x:Math.min(Math.max(t.x,e.x-n),e.x+n),y:Math.min(Math.max(t.y,e.y-n),e.y+n)});typeof window<"u"&&(OZ="ontouchstart"in window,FZ=!!window.PointerEvent,NZ=!!window.MSPointerEvent);var OZ,FZ,NZ,N0={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},Wm,zx={};FZ?Wm=N0.pointer:NZ?Wm=N0.MSPointer:OZ?(Wm=N0.touch,zx=N0.mouse):Wm=N0.mouse;function Kf(){}Kf.prototype.on=function(t,e){var n=this,i=t.split(/[ ,]+/g),r;n._handlers_=n._handlers_||{};for(var s=0;s<i.length;s+=1)r=i[s],n._handlers_[r]=n._handlers_[r]||[],n._handlers_[r].push(e);return n};Kf.prototype.off=function(t,e){var n=this;return n._handlers_=n._handlers_||{},t===void 0?n._handlers_={}:e===void 0?n._handlers_[t]=null:n._handlers_[t]&&n._handlers_[t].indexOf(e)>=0&&n._handlers_[t].splice(n._handlers_[t].indexOf(e),1),n};Kf.prototype.trigger=function(t,e){var n=this,i=t.split(/[ ,]+/g),r;n._handlers_=n._handlers_||{};for(var s=0;s<i.length;s+=1)r=i[s],n._handlers_[r]&&n._handlers_[r].length&&n._handlers_[r].forEach(function(o){o.call(n,{type:r,target:n},e)})};Kf.prototype.config=function(t){var e=this;e.options=e.defaults||{},t&&(e.options=UOe(e.options,t))};Kf.prototype.bindEvt=function(t,e){var n=this;return n._domHandlers_=n._domHandlers_||{},n._domHandlers_[e]=function(){typeof n["on"+e]=="function"?n["on"+e].apply(n,arguments):console.warn('[WARNING] : Missing "on'+e+'" handler.')},cM(t,Wm[e],n._domHandlers_[e]),zx[e]&&cM(t,zx[e],n._domHandlers_[e]),n};Kf.prototype.unbindEvt=function(t,e){var n=this;return n._domHandlers_=n._domHandlers_||{},w6(t,Wm[e],n._domHandlers_[e]),zx[e]&&w6(t,zx[e],n._domHandlers_[e]),delete n._domHandlers_[e],this};var CF=Kf;function sr(t,e){return this.identifier=e.identifier,this.position=e.position,this.frontPosition=e.frontPosition,this.collection=t,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(e),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=sr.id,sr.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}sr.prototype=new CF;sr.constructor=sr;sr.id=0;sr.prototype.buildEl=function(t){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};sr.prototype.stylize=function(){if(this.options.dataOnly)return this;var t=this.options.fadeTime+"ms",e=NOe("borderRadius","50%"),n=EF("transition","opacity",t),i={};return i.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},i.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},i.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},X2(i.el,n),this.options.shape==="circle"&&X2(i.back,e),X2(i.front,e),this.applyStyles(i),this};sr.prototype.applyStyles=function(t){for(var e in this.ui)if(this.ui.hasOwnProperty(e))for(var n in t[e])this.ui[e].style[n]=t[e][n];return this};sr.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};sr.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};sr.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};sr.prototype.show=function(t){var e=this;return e.options.dataOnly||(clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.addToDom(),e.restCallback(),setTimeout(function(){e.ui.el.style.opacity=1},0),e.showTimeout=setTimeout(function(){e.trigger("shown",e.instance),typeof t=="function"&&t.call(this)},e.options.fadeTime)),e};sr.prototype.hide=function(t){var e=this;if(e.options.dataOnly)return e;if(e.ui.el.style.opacity=e.options.restOpacity,clearTimeout(e.removeTimeout),clearTimeout(e.showTimeout),clearTimeout(e.restTimeout),e.removeTimeout=setTimeout(function(){var n=e.options.mode==="dynamic"?"none":"block";e.ui.el.style.display=n,typeof t=="function"&&t.call(e),e.trigger("hidden",e.instance)},e.options.fadeTime),e.options.restJoystick){let n=e.options.restJoystick,i={};i.x=n===!0||n.x!==!1?0:e.instance.frontPosition.x,i.y=n===!0||n.y!==!1?0:e.instance.frontPosition.y,e.setPosition(t,i)}return e};sr.prototype.setPosition=function(t,e){var n=this;n.frontPosition={x:e.x,y:e.y};var i=n.options.fadeTime+"ms",r={};r.front=EF("transition",["top","left"],i);var s={front:{}};s.front={left:n.frontPosition.x+"px",top:n.frontPosition.y+"px"},n.applyStyles(r),n.applyStyles(s),n.restTimeout=setTimeout(function(){typeof t=="function"&&t.call(n),n.restCallback()},n.options.fadeTime)};sr.prototype.restCallback=function(){var t=this,e={};e.front=EF("transition","none",""),t.applyStyles(e),t.trigger("rested",t.instance)};sr.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};sr.prototype.computeDirection=function(t){var e=t.angle.radian,n=Math.PI/4,i=Math.PI/2,r,s,o;if(e>n&&e<n*3&&!t.lockX?r="up":e>-n&&e<=n&&!t.lockY?r="left":e>-n*3&&e<=-n&&!t.lockX?r="down":t.lockY||(r="right"),t.lockY||(e>-i&&e<i?s="left":s="right"),t.lockX||(e>0?o="up":o="down"),t.force>this.options.threshold){var a={},l;for(l in this.direction)this.direction.hasOwnProperty(l)&&(a[l]=this.direction[l]);var c={};this.direction={x:s,y:o,angle:r},t.direction=this.direction;for(l in a)a[l]===this.direction[l]&&(c[l]=!0);if(c.x&&c.y&&c.angle)return t;(!c.x||!c.y)&&this.trigger("plain",t),c.x||this.trigger("plain:"+s,t),c.y||this.trigger("plain:"+o,t),c.angle||this.trigger("dir dir:"+r,t)}else this.resetDirection();return t};var zOe=sr;function Di(t,e){var n=this;n.nipples=[],n.idles=[],n.actives=[],n.ids=[],n.pressureIntervals={},n.manager=t,n.id=Di.id,Di.id+=1,n.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},n.config(e),(n.options.mode==="static"||n.options.mode==="semi")&&(n.options.multitouch=!1),n.options.multitouch||(n.options.maxNumberOfNipples=1);let i=getComputedStyle(n.options.zone.parentElement);return i&&i.display==="flex"&&(n.parentIsFlex=!0),n.updateBox(),n.prepareNipples(),n.bindings(),n.begin(),n.nipples}Di.prototype=new CF;Di.constructor=Di;Di.id=0;Di.prototype.prepareNipples=function(){var t=this,e=t.nipples;e.on=t.on.bind(t),e.off=t.off.bind(t),e.options=t.options,e.destroy=t.destroy.bind(t),e.ids=t.ids,e.id=t.id,e.processOnMove=t.processOnMove.bind(t),e.processOnEnd=t.processOnEnd.bind(t),e.get=function(n){if(n===void 0)return e[0];for(var i=0,r=e.length;i<r;i+=1)if(e[i].identifier===n)return e[i];return!1}};Di.prototype.bindings=function(){var t=this;t.bindEvt(t.options.zone,"start"),t.options.zone.style.touchAction="none",t.options.zone.style.msTouchAction="none"};Di.prototype.begin=function(){var t=this,e=t.options;if(e.mode==="static"){var n=t.createNipple(e.position,t.manager.getIdentifier());n.add(),t.idles.push(n)}};Di.prototype.createNipple=function(t,e){var n=this,i=n.manager.scroll,r={},s=n.options,o={x:n.parentIsFlex?i.x:i.x+n.box.left,y:n.parentIsFlex?i.y:i.y+n.box.top};if(t.x&&t.y)r={x:t.x-o.x,y:t.y-o.y};else if(t.top||t.right||t.bottom||t.left){var a=document.createElement("DIV");a.style.display="hidden",a.style.top=t.top,a.style.right=t.right,a.style.bottom=t.bottom,a.style.left=t.left,a.style.position="absolute",s.zone.appendChild(a);var l=a.getBoundingClientRect();s.zone.removeChild(a),r=t,t={x:l.left+i.x,y:l.top+i.y}}var c=new zOe(n,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:e,position:t,zone:s.zone,frontPosition:{x:0,y:0},shape:s.shape});return s.dataOnly||(LI(c.ui.el,r),LI(c.ui.front,c.frontPosition)),n.nipples.push(c),n.trigger("added "+c.identifier+":added",c),n.manager.trigger("added "+c.identifier+":added",c),n.bindNipple(c),c};Di.prototype.updateBox=function(){var t=this;t.box=t.options.zone.getBoundingClientRect()};Di.prototype.bindNipple=function(t){var e=this,n,i=function(r,s){n=r.type+" "+s.id+":"+r.type,e.trigger(n,s)};t.on("destroyed",e.onDestroyed.bind(e)),t.on("shown hidden rested dir plain",i),t.on("dir:up dir:right dir:down dir:left",i),t.on("plain:up plain:right plain:down plain:left",i)};Di.prototype.pressureFn=function(t,e,n){var i=this,r=0;clearInterval(i.pressureIntervals[n]),i.pressureIntervals[n]=setInterval(function(){var s=t.force||t.pressure||t.webkitForce||0;s!==r&&(e.trigger("pressure",s),i.trigger("pressure "+e.identifier+":pressure",s),r=s)}.bind(i),100)};Di.prototype.onstart=function(t){var e=this,n=e.options,i=t;t=IZ(t),e.updateBox();var r=function(s){e.actives.length<n.maxNumberOfNipples?e.processOnStart(s):i.type.match(/^touch/)&&(Object.keys(e.manager.ids).forEach(function(o){if(Object.values(i.touches).findIndex(function(l){return l.identifier===o})<0){var a=[t[0]];a.identifier=o,e.processOnEnd(a)}}),e.actives.length<n.maxNumberOfNipples&&e.processOnStart(s))};return II(t,r),e.manager.bindDocument(),!1};Di.prototype.processOnStart=function(t){var e=this,n=e.options,i,r=e.manager.getIdentifier(t),s=t.force||t.pressure||t.webkitForce||0,o={x:t.pageX,y:t.pageY},a=e.getOrCreate(r,o);a.identifier!==r&&e.manager.removeIdentifier(a.identifier),a.identifier=r;var l=function(h){h.trigger("start",h),e.trigger("start "+h.id+":start",h),h.show(),s>0&&e.pressureFn(t,h,h.identifier),e.processOnMove(t)};if((i=e.idles.indexOf(a))>=0&&e.idles.splice(i,1),e.actives.push(a),e.ids.push(a.identifier),n.mode!=="semi")l(a);else{var c=Rb(o,a.position);if(c<=n.catchDistance)l(a);else{a.destroy(),e.processOnStart(t);return}}return a};Di.prototype.getOrCreate=function(t,e){var n=this,i=n.options,r;return/(semi|static)/.test(i.mode)?(r=n.idles[0],r?(n.idles.splice(0,1),r):i.mode==="semi"?n.createNipple(e,t):(console.warn("Coudln't find the needed nipple."),!1)):(r=n.createNipple(e,t),r)};Di.prototype.processOnMove=function(t){var e=this,n=e.options,i=e.manager.getIdentifier(t),r=e.nipples.get(i),s=e.manager.scroll;if(!FOe(t)){this.processOnEnd(t);return}if(!r){console.error("Found zombie joystick with ID "+i),e.manager.removeIdentifier(i);return}if(n.dynamicPage){var o=r.el.getBoundingClientRect();r.position={x:s.x+o.left,y:s.y+o.top}}r.identifier=i;var a=r.options.size/2,l={x:t.pageX,y:t.pageY};n.lockX&&(l.y=r.position.y),n.lockY&&(l.x=r.position.x);var c=Rb(l,r.position),h=IOe(l,r.position),u=RI(h),d=c/a,f={distance:c,position:l},p,v;if(r.options.shape==="circle"?(p=Math.min(c,a),v=BOe(r.position,p,h)):(v=kOe(l,r.position,a),p=Rb(v,r.position)),n.follow){if(c>a){let _=l.x-v.x,S=l.y-v.y;r.position.x+=_,r.position.y+=S,r.el.style.top=r.position.y-(e.box.top+s.y)+"px",r.el.style.left=r.position.x-(e.box.left+s.x)+"px",c=Rb(l,r.position)}}else l=v,c=p;var g=l.x-r.position.x,m=l.y-r.position.y;r.frontPosition={x:g,y:m},n.dataOnly||LI(r.ui.front,r.frontPosition);var y={identifier:r.identifier,position:l,force:d,pressure:t.force||t.pressure||t.webkitForce||0,distance:c,angle:{radian:u,degree:h},vector:{x:g/a,y:-m/a},raw:f,instance:r,lockX:n.lockX,lockY:n.lockY};y=r.computeDirection(y),y.angle={radian:RI(180-h),degree:180-h},r.trigger("move",y),e.trigger("move "+r.id+":move",y)};Di.prototype.processOnEnd=function(t){var e=this,n=e.options,i=e.manager.getIdentifier(t),r=e.nipples.get(i),s=e.manager.removeIdentifier(r.identifier);!r||(n.dataOnly||r.hide(function(){n.mode==="dynamic"&&(r.trigger("removed",r),e.trigger("removed "+r.id+":removed",r),e.manager.trigger("removed "+r.id+":removed",r),r.destroy())}),clearInterval(e.pressureIntervals[r.identifier]),r.resetDirection(),r.trigger("end",r),e.trigger("end "+r.id+":end",r),e.ids.indexOf(r.identifier)>=0&&e.ids.splice(e.ids.indexOf(r.identifier),1),e.actives.indexOf(r)>=0&&e.actives.splice(e.actives.indexOf(r),1),/(semi|static)/.test(n.mode)?e.idles.push(r):e.nipples.indexOf(r)>=0&&e.nipples.splice(e.nipples.indexOf(r),1),e.manager.unbindDocument(),/(semi|static)/.test(n.mode)&&(e.manager.ids[s.id]=s.identifier))};Di.prototype.onDestroyed=function(t,e){var n=this;n.nipples.indexOf(e)>=0&&n.nipples.splice(n.nipples.indexOf(e),1),n.actives.indexOf(e)>=0&&n.actives.splice(n.actives.indexOf(e),1),n.idles.indexOf(e)>=0&&n.idles.splice(n.idles.indexOf(e),1),n.ids.indexOf(e.identifier)>=0&&n.ids.splice(n.ids.indexOf(e.identifier),1),n.manager.removeIdentifier(e.identifier),n.manager.unbindDocument()};Di.prototype.destroy=function(){var t=this;t.unbindEvt(t.options.zone,"start"),t.nipples.forEach(function(n){n.destroy()});for(var e in t.pressureIntervals)t.pressureIntervals.hasOwnProperty(e)&&clearInterval(t.pressureIntervals[e]);t.trigger("destroyed",t.nipples),t.manager.unbindDocument(),t.off()};var GOe=Di;function wr(t){var e=this;e.ids={},e.index=0,e.collections=[],e.scroll=S6(),e.config(t),e.prepareCollections();var n=function(){var r;e.collections.forEach(function(s){s.forEach(function(o){r=o.el.getBoundingClientRect(),o.position={x:e.scroll.x+r.left,y:e.scroll.y+r.top}})})};if(typeof window>"u")return e.collections;cM(window,"resize",function(){_6(n)});var i=function(){e.scroll=S6()};return cM(window,"scroll",function(){_6(i)}),e.collections}wr.prototype=new CF;wr.constructor=wr;wr.prototype.prepareCollections=function(){var t=this;t.collections.create=t.create.bind(t),t.collections.on=t.on.bind(t),t.collections.off=t.off.bind(t),t.collections.destroy=t.destroy.bind(t),t.collections.get=function(e){var n;return t.collections.every(function(i){return n=i.get(e),!n}),n}};wr.prototype.create=function(t){return this.createCollection(t)};wr.prototype.createCollection=function(t){var e=this,n=new GOe(e,t);return e.bindCollection(n),e.collections.push(n),n};wr.prototype.bindCollection=function(t){var e=this,n,i=function(r,s){n=r.type+" "+s.id+":"+r.type,e.trigger(n,s)};t.on("destroyed",e.onDestroyed.bind(e)),t.on("shown hidden rested dir plain",i),t.on("dir:up dir:right dir:down dir:left",i),t.on("plain:up plain:right plain:down plain:left",i)};wr.prototype.bindDocument=function(){var t=this;t.binded||(t.bindEvt(document,"move").bindEvt(document,"end"),t.binded=!0)};wr.prototype.unbindDocument=function(t){var e=this;(!Object.keys(e.ids).length||t===!0)&&(e.unbindEvt(document,"move").unbindEvt(document,"end"),e.binded=!1)};wr.prototype.getIdentifier=function(t){var e;return t?(e=t.identifier===void 0?t.pointerId:t.identifier,e===void 0&&(e=this.latest||0)):e=this.index,this.ids[e]===void 0&&(this.ids[e]=this.index,this.index+=1),this.latest=e,this.ids[e]};wr.prototype.removeIdentifier=function(t){var e={};for(var n in this.ids)if(this.ids[n]===t){e.id=n,e.identifier=this.ids[n],delete this.ids[n];break}return e};wr.prototype.onmove=function(t){var e=this;return e.onAny("move",t),!1};wr.prototype.onend=function(t){var e=this;return e.onAny("end",t),!1};wr.prototype.oncancel=function(t){var e=this;return e.onAny("end",t),!1};wr.prototype.onAny=function(t,e){var n=this,i,r="processOn"+t.charAt(0).toUpperCase()+t.slice(1);e=IZ(e);var s=function(a,l,c){c.ids.indexOf(l)>=0&&(c[r](a),a._found_=!0)},o=function(a){i=n.getIdentifier(a),II(n.collections,s.bind(null,a,i)),a._found_||n.removeIdentifier(i)};return II(e,o),!1};wr.prototype.destroy=function(){var t=this;t.unbindDocument(!0),t.ids={},t.index=0,t.collections.forEach(function(e){e.destroy()}),t.off()};wr.prototype.onDestroyed=function(t,e){var n=this;if(n.collections.indexOf(e)<0)return!1;n.collections.splice(n.collections.indexOf(e),1)};var HOe=wr,b6=new HOe,VOe={create:function(t){return b6.create(t)},factory:b6},jOe=b1(uQ());function nm(t,e){let n=new Lt;if(!t.getAttribute("position"))return n.setAttribute("position",new ft([],3)),n.setIndex([]),n;let{positions:i,triIndices:r}=pF(t.getAttribute("position"),t.getIndex());return n.setAttribute("position",new ft(i,3)),n.setIndex(r),e&&n.applyMatrix4(e),n}var WOe=new nt,XOe=new nt,wl=[[0,0,0],[0,0,0],[0,0,0]];function UZ(t){let e=t.elements;wl[0][0]=e[0],wl[0][1]=e[4],wl[0][2]=e[8],wl[1][0]=e[1],wl[1][1]=e[5],wl[1][2]=e[9],wl[2][0]=e[2],wl[2][1]=e[6],wl[2][2]=e[10];let{u:n,v:i}=(0,jOe.SVD)(wl),r=WOe.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),s=XOe.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1);return r.multiply(s.transpose())}var YOe=class extends YQ{constructor(){super(),this.layers.enable(3),this.layers.enable(8)}setFromCamera(t,e){e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,-1).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):e.isPerspectiveCamera?(this.ray.origin.set(t.x,t.y,-1).unproject(e),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(t,e=!0,n=[]){return t.forEach(i=>{i.visible&&this.intersectObject(i,e,n)}),n}createRaycastLineHelper(){let t=new $h({color:65280,linewidth:10}),e=new N(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),n=new N(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),i=this.camera.far-this.camera.near,r=new N().addVectors(e,n.multiplyScalar(i)),s=new Lt;return s.setFromPoints([e,r]),new MA(s,t)}},kZ=t=>t instanceof lM||t instanceof vg;function qOe(t,e){return t.distance-e.distance}function zZ(t,e,n){if(!(!ih(e)||!e.visible)){Ol(e)&&e.raycast(t,n);for(let i of e.children)zZ(t,i,n)}}function BI(t,e,n){if(!n.some(r=>uM(t,r)!==void 0))return[];let i=[];return e.children.forEach(r=>zZ(t,r,i)),i.sort(qOe),i}function OI(t){let e=[];if(t.length){let n=t[0].object;ih(n)&&e.push(n);let i=n.parent;for(;i;)kZ(i)&&e.push(i),i=i.parent}return e}function uM(t,e){if(Ol(e)){if(e.visible){let n=[];return e.raycast(t,n),n.length?n[0]:void 0}}else if(kZ(e))return GZ(t,e)}function GZ(t,e){if(!(!ih(e)||!e.visible)){if(Ol(e)){let n=[];if(e.raycast(t,n),n.length)return n[0]}for(let n of e.children){let i=GZ(t,n);if(i)return i}}}function QOe(t,e,n){return{x:(t-(n.left+window.scrollX))/n.width*2-1,y:-((e-(n.top+window.scrollY))/n.height)*2+1}}var KOe=class{constructor(t,e,n,i,r,s){this.isExport=s,this.raycaster=new YOe,this.raycasterNeedsUpdate=!0,this.stopRaycast=!1,this._useWindowEvents=!1,this.sharedAssets=new EE($A.emptyData()),this.scene=new Xl({...uI.defaultData},this.sharedAssets),this.camera=new Us,this.renderer=t,this._useWindowEvents=e.data.publish.mouseEventTarget==="window",this.domElement=t.domElement,this.eventElement=this._useWindowEvents?window:t.domElement,this.stopRaycast=r,this.sharedAssets=i,this.scene=e,this.camera=n}set useWindowEvents(t){this._useWindowEvents=t,this.eventElement=t?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}updateRaycaster(t){if(!this.raycasterNeedsUpdate)return;this.raycasterNeedsUpdate=!1;let{pageX:e,pageY:n}=t.touches!==void 0&&t.touches.length>0?t.touches[0]:t,i=this.domElement.getBoundingClientRect();this.raycaster.setFromCamera(QOe(e,n,i),this.camera)}},HZ=(t=>(t[t.keydown=0]="keydown",t[t.keyup=1]="keyup",t[t.pointerdown=2]="pointerdown",t[t.pointerup=3]="pointerup",t[t.pointermove=4]="pointermove",t[t.wheel=5]="wheel",t[t.scroll=6]="scroll",t))(HZ||{}),du=class{constructor(t){this.eventContext=t,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},VZ=new Map,Ry=new Map,Xm=class{constructor(t,e,n,i){this.data=e;let{audio:r,volume:s,delay:o,loop:a}=e;if(!r)throw new Error("Missing property");let l=typeof r=="string"?i.getAudio(r).src:r.data;this.audioPlayer=new ry({src:l,volume:s,delay:o,loop:a}),Ry.has(n.uuid)?Ry.get(n.uuid).push(this):Ry.set(n.uuid,[this]),VZ.set(t,this)}playByToggle(){this.data.toggle==="stop"?this.audioPlayer.status==="playing"?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):this.data.toggle==="pause"?this.audioPlayer.status==="playing"?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},FI=class{constructor(t){this.data=t}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(t){let e=VZ.get(t);!e||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.audioPlayer[this.data.interaction](),this.disposeDelay()},this.data.delay)):e.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(t){let e=Ry.get(t);!(e!=null&&e.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(n=>n.audioPlayer[this.data.interaction]()),this.disposeDelay()},this.data.delay)):e.forEach(n=>n.audioPlayer[this.data.interaction]()))}pauseAllAudios(){let t=[...Ry.values()];!t.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(e=>{e.forEach(n=>{n.audioPlayer[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):t.forEach(e=>{e.forEach(n=>{n.audioPlayer[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},Ly=class{constructor(t,e,n,i){if(this.data=e,e.interaction==="play")this.interaction=new Xm(t,e,n,i);else if(e.interaction==="pause"||e.interaction==="stop")this.interaction=new FI(e);else throw new Error("Missing property")}dispatchBasic(){this.interaction instanceof Xm?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){this.interaction instanceof Xm?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(t){this.interaction instanceof Xm&&(t==="start"?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}};function JOe(t,e){let n=t.material.layers.find(i=>i.uuid===e);return n.color.texture.image.img instanceof HTMLVideoElement?n.color.texture.image.img:void 0}var jZ=new Map,Iy=new Map,By=class{constructor(t,e,n){this.data=e,this.delay=0,this.status="stopped";let{layerId:i,loop:r,volume:s,delay:o}=e;if(this.object=n,i===void 0)throw new Error("Missing property");let a=JOe(n,i);if(a)this.videoElement=a,this.videoElement.loop=r===1/0,this.videoElement.autoplay=!0,s!==void 0&&(this.videoElement.volume=s);else throw new Error("Missing property");o!==void 0&&(this.delay=o),Iy.has(n.uuid)?Iy.get(n.uuid).push(this):Iy.set(n.uuid,[this]),jZ.set(t,this),this.pause()}mute(){this.videoElement.muted=!0}unMute(){this.videoElement.muted=!1}play(t){let e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);t?(this.mute(),this.delay+=150):e?(this.mute(),window.setTimeout(()=>{this.unMute()},100)):this.unMute(),this.delayTimerId=window.setTimeout(()=>{this.videoElement.play(),this.clearDelay()},this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){this.videoElement.pause(),this.status="paused"}stop(){this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay()}playByToggle(){this.data.toggle==="stop"?this.status==="playing"?this.stop():(this.stop(),this.play()):this.data.toggle==="pause"?this.status==="playing"?this.pause():this.play():(this.stop(),this.play())}dispose(){this.stop(),this.videoElement.muted=!0}},NI=class{constructor(t){this.data=t}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(t){let e=jZ.get(t);!e||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e[this.data.interaction](),this.disposeDelay()},this.data.delay)):e[this.data.interaction]())}pauseAllVideosFromObject(t){let e=Iy.get(t);!(e!=null&&e.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(n=>n[this.data.interaction]()),this.disposeDelay()},this.data.delay)):e.forEach(n=>n[this.data.interaction]()))}pauseAllVideos(){let t=[...Iy.values()];!t.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(e=>{e.forEach(n=>{n[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):t.forEach(e=>{e.forEach(n=>{n[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},TF=class{constructor(t,e,n){if(this.data=e,e.interaction==="play")this.interaction=new By(t,e,n);else if(e.interaction==="pause"||e.interaction==="stop")this.interaction=new NI(e);else throw new Error("Missing property")}dispatchBasic(){this.interaction instanceof By?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){this.interaction instanceof By?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},ZOe="text/plain",$Oe="us-ascii",A6=(t,e)=>e.some(n=>n instanceof RegExp?n.test(t):n===t),eFe=(t,{stripHash:e})=>{let n=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(t);if(!n)throw new Error(`Invalid URL: ${t}`);let{type:i,data:r,hash:s}=n.groups,o=i.split(";");s=e?"":s;let a=!1;o[o.length-1]==="base64"&&(o.pop(),a=!0);let l=(o.shift()||"").toLowerCase(),c=[...o.map(h=>{let[u,d=""]=h.split("=").map(f=>f.trim());return u==="charset"&&(d=d.toLowerCase(),d===$Oe)?"":`${u}${d?`=${d}`:""}`}).filter(Boolean)];return a&&c.push("base64"),(c.length>0||l&&l!==ZOe)&&c.unshift(l),`data:${c.join(";")},${a?r.trim():r}${s?`#${s}`:""}`};function tFe(t,e){if(e={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...e},t=t.trim(),/^data:/i.test(t))return eFe(t,e);if(/^view-source:/i.test(t))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let n=t.startsWith("//");!n&&/^\.*\//.test(t)||(t=t.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,e.defaultProtocol));let i=new URL(t);if(e.forceHttp&&e.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(e.forceHttp&&i.protocol==="https:"&&(i.protocol="http:"),e.forceHttps&&i.protocol==="http:"&&(i.protocol="https:"),e.stripAuthentication&&(i.username="",i.password=""),e.stripHash?i.hash="":e.stripTextFragment&&(i.hash=i.hash.replace(/#?:~:text.*?$/i,"")),i.pathname){let s=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,o=0,a="";for(;;){let c=s.exec(i.pathname);if(!c)break;let h=c[0],u=c.index,d=i.pathname.slice(o,u);a+=d.replace(/\/{2,}/g,"/"),a+=h,o=u+h.length}let l=i.pathname.slice(o,i.pathname.length);a+=l.replace(/\/{2,}/g,"/"),i.pathname=a}if(i.pathname)try{i.pathname=decodeURI(i.pathname)}catch{}if(e.removeDirectoryIndex===!0&&(e.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(e.removeDirectoryIndex)&&e.removeDirectoryIndex.length>0){let s=i.pathname.split("/"),o=s[s.length-1];A6(o,e.removeDirectoryIndex)&&(s=s.slice(0,-1),i.pathname=s.slice(1).join("/")+"/")}if(i.hostname&&(i.hostname=i.hostname.replace(/\.$/,""),e.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(i.hostname)&&(i.hostname=i.hostname.replace(/^www\./,""))),Array.isArray(e.removeQueryParameters))for(let s of[...i.searchParams.keys()])A6(s,e.removeQueryParameters)&&i.searchParams.delete(s);if(e.removeQueryParameters===!0&&(i.search=""),e.sortQueryParameters){i.searchParams.sort();try{i.search=decodeURIComponent(i.search)}catch{}}e.removeTrailingSlash&&(i.pathname=i.pathname.replace(/\/$/,""));let r=t;return t=i.toString(),!e.removeSingleSlash&&i.pathname==="/"&&!r.endsWith("/")&&i.hash===""&&(t=t.replace(/\/$/,"")),(e.removeTrailingSlash||i.pathname==="/")&&i.hash===""&&e.removeSingleSlash&&(t=t.replace(/\/$/,"")),n&&!e.normalizeProtocol&&(t=t.replace(/^http:\/\//,"//")),e.stripProtocol&&(t=t.replace(/^(?:https?:)?\/\//,"")),t}var nFe=class{constructor({url:t,context:e},n){if(this.managers=n,!t)throw new Error("Missing property");this.url=t.startsWith("mailto:")?t:tFe(t,{removeTrailingSlash:!1,removeSingleSlash:!1}),this.context=e??"tab"}dispatch(){var t;cI?window.location.assign(this.url):(this.context==="tab"?window.open(this.url,"_blank"):this.context==="window"?window.open(this.url,"_blank",`width=${window.innerWidth}, height=${window.innerHeight}`):window.open(this.url,"_parent"),(t=this.managers.controlsManager.orbitControls)==null||t.onPointerUp(Nt[0]),$Re())}},WZ=class{constructor(t,e,n){this.data=t,this.managers=n,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=i=>{var a,l;this.timeoutIdQueue.shift();let r=this.scene.find(i);if(r===void 0)return;let s=this.controlsManager.sharedGameControlGlobals.rapierWorld,o=s?(a=r.dataPatched.physics)==null?void 0:a.fusedBody:!0;if(r.cloner){for(let c of r.cloner.children)o?(c.playModeVisible=!1,c.rigidBody&&((l=r.dataPatched.physics)==null?void 0:l.rigidBody)==="positioned"&&(s.removeRigidBody(c.rigidBody),c.rigidBody=void 0),c.boundsTree&&(c.boundsTree=void 0)):this.clone===void 0||this.clone===c?(c.playModeVisible=!1,c.rigidBody&&(s.removeRigidBody(c.rigidBody),c.rigidBody=void 0)):c.playModeVisible===void 0&&(c.playModeVisible=!0);(o||this.clone===void 0||this.clone===!1)&&(r.visible=!1,r.rigidBody&&(s.removeRigidBody(r.rigidBody),r.rigidBody=void 0),r.boundsTree&&(r.boundsTree=void 0))}else r.rigidBody&&(s.removeRigidBody(r.rigidBody),r.rigidBody=void 0),r.boundsTree&&(r.boundsTree=void 0),r.visible=!1;s===void 0?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(c=>c.boundsTree!==void 0):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(c=>c.rigidBody!==void 0),this.managers.eventManager.requestRender()},this.objects=[...t.objects],this.scene=e,this.controlsManager=n.controlsManager}dispatch(t){this.clone=t,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()}dispatchFromStart(){this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))}dispose(){this.timeoutIdQueue.forEach(t=>window.clearTimeout(t))}},M6=(()=>{let t,e,n,i;function r(a){!t&&!E6()&&(e==null?void 0:e.sharedGameControlGlobals.createdObjects.length)>0&&(t=requestAnimationFrame(s)),a&&(e=a,i=a.requestRender)}function s(a){let l=n?a-n:0,c=e.sharedGameControlGlobals.createdObjects,h=e.sharedGameControlGlobals.nCreatedPerAction,u=c.length,d=0;for(;d<u;){let f=c[d];f.userData.createdTime===void 0&&(f.userData.createdTime=a),f.userData.lifetime===void 0&&f.userData.quantity===void 0||f.userData.lifetime&&a-f.userData.createdTime<f.userData.lifetime||f.userData.quantity&&h[f.userData.actionId]<=f.userData.quantity?(f.userData.velocity&&(f.position.addScaledVector(f.userData.velocity,l/1e3),f.updateMatrix(),i()),d++):(h[f.userData.actionId]>f.userData.quantity&&h[f.userData.actionId]--,c.splice(d,1),f.removeFromParent(),e.sharedGameControlGlobals.rapierWorld&&f.rigidBody?e.sharedGameControlGlobals.rapierWorld.removeRigidBody(f.rigidBody):(f.boundsTree=void 0,e.sharedGameControlGlobals.entitiesWithTransformAnim=e.sharedGameControlGlobals.entitiesWithTransformAnim.filter(p=>p.boundsTree!==void 0)),u--,i())}t=d>0?requestAnimationFrame(s):void 0,n=d>0?a:void 0}function o(){E6()?t&&(cancelAnimationFrame(t),n=void 0):r()}return typeof document<"u"&&document.addEventListener("visibilitychange",o),r})();function E6(){return!!document&&document.hidden}var C6=new on,iFe=new N,rFe=new N,Oy=class{constructor(t,e,n){this.data=t,this.scene=e,this.controlsManager=n,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=sn.generateUUID(),this.dispatch=()=>{this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()},this.dispatchFromStart=()=>{this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))},this.dispatchThrottled=gRe(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{this.intervalId===null&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{if(this.timeoutIdQueue.shift(),this.object===void 0)return;let i=this.object.clone(!0);if(i.raycast=()=>{},i.visible=!0,this.data.coordinateSystem!=="world"){let s=this.data.coordinateSystem;s===Xl.PERSONAL_CAMERA_ID&&this.scene.find(Xl.PERSONAL_CAMERA_EXPORT_ID)&&(s=Xl.PERSONAL_CAMERA_EXPORT_ID);let o=this.scene.find(s);o&&(o.updateMatrixWorldSVD(),i.hiddenMatrix.setPosition(0,0,0),i.hiddenMatrix.premultiply(o.matrixWorldRigid),i.updateMatrixWorld())}i.position.fromArray(this.data.position),i.rotation.fromArray(this.data.rotation),i.updateMatrix(),this.scene.add(i);let r=this.controlsManager.sharedGameControlGlobals;r.createdObjects.push(i),r.nCreatedPerAction[this.uniqueId]===void 0?r.nCreatedPerAction[this.uniqueId]=1:r.nCreatedPerAction[this.uniqueId]++,i.updateWorldMatrix(!0,!0),this.controlsManager.sharedGameControlGlobals.rapierWorld?i.traverseObject(this.traverseObjectCB):this.traverseObjectCB(i),M6(),this.controlsManager.requestRender()},this.traverseObjectCB=i=>{var o,a,l,c;i.hasNonUniformScale&&i.updateMatrixWorldSVD();let r;if(i instanceof rf)if(i.objectForSample){if(i.objectForSample.dataPatched.physics.fusedBody)return;r=i.object}else return i.object.dataPatched.physics.fusedBody===!0&&i.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(i instanceof Fl)r=i.object;else if(r=i,(o=r.dataPatched.cloner)==null?void 0:o.hideBase)return!0;this.data.destroy==="Time"?i.userData.lifetime=this.data.lifetime*1e3:this.data.destroy==="Quantity"&&(i.userData.quantity=this.data.destroyAfterQuantity,i.userData.actionId=this.uniqueId),i.matrixWorld.decompose(iFe,C6,rFe);let s=new N().fromArray(this.data.velocity).applyQuaternion(C6);if(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(i,r,{fromCreate:!0,dynamic:this.data.dynamic}),this.data.destroy==="Collision"&&((a=i.rigidBody)==null||a.collider(0).setActiveEvents(1),i.userData.hasCollisionDestroy=!0),this.data.velocity.some(h=>h!==0)&&this.data.dynamic&&((l=i.rigidBody)==null||l.setLinvel(s.divideScalar(this.controlsManager.pixelsPerMeter),!0))):(this.controlsManager.addBoundsTree(i),this.data.velocity.some(h=>h!==0)&&this.data.dynamic&&(i.userData.velocity=s)),((c=r.dataPatched.physics)==null?void 0:c.fusedBody)===!0)return!0},this.scene=e,this.object=this.scene.find(this.data.object),this.data.hideBase==="Yes"&&(this.object.visible=!1),M6(n)}dispose(){this.timeoutIdQueue.forEach(t=>window.clearTimeout(t)),this.dispatchThrottled.cancel(),this.scene.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},sFe=class{constructor(t,e,n,i){this.scene=e,this.sharedAssets=n,this.sceneData=t,this.managers=i}dispatch(){var t,e,n;u$(this.sceneData,this.scene,this.sharedAssets,!0),(t=this.managers.eventManager)==null||t.reset(),(e=this.managers.controlsManager.orbitControls)==null||e.reset(),(n=this.managers.controlsManager)==null||n.gameControls.forEach(i=>i.reset(!0))}},XZ={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},PF={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},oFe=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],hM={CSS:{},springs:{}};function za(t,e,n){return Math.min(Math.max(t,e),n)}function Fy(t,e){return t.indexOf(e)>-1}function Y2(t,e){return t.apply(null,e)}var Dt={arr:function(t){return Array.isArray(t)},obj:function(t){return Fy(Object.prototype.toString.call(t),"Object")},pth:function(t){return Dt.obj(t)&&t.hasOwnProperty("totalLength")},svg:function(t){return t instanceof SVGElement},inp:function(t){return t instanceof HTMLInputElement},dom:function(t){return!("isNode"in t)&&(t.nodeType||Dt.svg(t))},str:function(t){return typeof t=="string"},fnc:function(t){return typeof t=="function"},und:function(t){return typeof t>"u"},hex:function(t){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(t)},rgb:function(t){return/^rgb/.test(t)},hsl:function(t){return/^hsl/.test(t)},col:function(t){return Dt.hex(t)||Dt.rgb(t)||Dt.hsl(t)},key:function(t){return!XZ.hasOwnProperty(t)&&!PF.hasOwnProperty(t)&&t!=="targets"&&t!=="keyframes"}};function YZ(t){var e=/\(([^)]+)\)/.exec(t);return e?e[1].split(",").map(function(n){return parseFloat(n)}):[]}function qZ(t,e){var n=YZ(t),i=za(Dt.und(n[0])?1:n[0],.1,100),r=za(Dt.und(n[1])?100:n[1],.1,100),s=za(Dt.und(n[2])?10:n[2],.1,100),o=za(Dt.und(n[3])?0:n[3],.1,100),a=Math.sqrt(r/i),l=s/(2*Math.sqrt(r*i)),c=l<1?a*Math.sqrt(1-l*l):0,h=1,u=l<1?(l*a+-o)/c:-o+a;function d(p){var v=e?e*p/1e3:p;return l<1?v=Math.exp(-v*l*a)*(h*Math.cos(c*v)+u*Math.sin(c*v)):v=(h+u*v)*Math.exp(-v*a),p===0||p===1?p:1-v}function f(){var p=hM.springs[t];if(p)return p;for(var v=1/6,g=0,m=0;;)if(g+=v,d(g)===1){if(m++,m>=16)break}else m=0;var y=g*v*1e3;return hM.springs[t]=y,y}return e?d:f}function aFe(t){return t===void 0&&(t=10),function(e){return Math.ceil(za(e,1e-6,1)*t)*(1/t)}}var lFe=function(){var t=11,e=1/(t-1);function n(h,u){return 1-3*u+3*h}function i(h,u){return 3*u-6*h}function r(h){return 3*h}function s(h,u,d){return((n(u,d)*h+i(u,d))*h+r(u))*h}function o(h,u,d){return 3*n(u,d)*h*h+2*i(u,d)*h+r(u)}function a(h,u,d,f,p){var v,g,m=0;do g=u+(d-u)/2,v=s(g,f,p)-h,v>0?d=g:u=g;while(Math.abs(v)>1e-7&&++m<10);return g}function l(h,u,d,f){for(var p=0;p<4;++p){var v=o(u,d,f);if(v===0)return u;var g=s(u,d,f)-h;u-=g/v}return u}function c(h,u,d,f){if(!(0<=h&&h<=1&&0<=d&&d<=1))return;var p=new Float32Array(t);if(h!==u||d!==f)for(var v=0;v<t;++v)p[v]=s(v*e,h,d);function g(m){for(var y=0,_=1,S=t-1;_!==S&&p[_]<=m;++_)y+=e;--_;var A=(m-p[_])/(p[_+1]-p[_]),b=y+A*e,T=o(b,h,d);return T>=.001?l(m,b,h,d):T===0?b:a(m,y,y+e,h,d)}return function(m){return h===u&&d===f||m===0||m===1?m:s(g(m),u,f)}}return c}(),QZ=function(){var t={linear:function(){return function(i){return i}}},e={Sine:function(){return function(i){return 1-Math.cos(i*Math.PI/2)}},Circ:function(){return function(i){return 1-Math.sqrt(1-i*i)}},Back:function(){return function(i){return i*i*(3*i-2)}},Bounce:function(){return function(i){for(var r,s=4;i<((r=Math.pow(2,--s))-1)/11;);return 1/Math.pow(4,3-s)-7.5625*Math.pow((r*3-2)/22-i,2)}},Elastic:function(i,r){i===void 0&&(i=1),r===void 0&&(r=.5);var s=za(i,1,10),o=za(r,.1,2);return function(a){return a===0||a===1?a:-s*Math.pow(2,10*(a-1))*Math.sin((a-1-o/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/o)}}},n=["Quad","Cubic","Quart","Quint","Expo"];return n.forEach(function(i,r){e[i]=function(){return function(s){return Math.pow(s,r+2)}}}),Object.keys(e).forEach(function(i){var r=e[i];t["easeIn"+i]=r,t["easeOut"+i]=function(s,o){return function(a){return 1-r(s,o)(1-a)}},t["easeInOut"+i]=function(s,o){return function(a){return a<.5?r(s,o)(a*2)/2:1-r(s,o)(a*-2+2)/2}}}),t}();function DF(t,e){if(Dt.fnc(t))return t;var n=t.split("(")[0],i=QZ[n],r=YZ(t);switch(n){case"spring":return qZ(t,e);case"cubicBezier":return Y2(lFe,r);case"steps":return Y2(aFe,r);default:return Y2(i,r)}}function KZ(t){try{var e=document.querySelectorAll(t);return e}catch{return}}function PE(t,e){for(var n=t.length,i=arguments.length>=2?arguments[1]:void 0,r=[],s=0;s<n;s++)if(s in t){var o=t[s];e.call(i,o,s,t)&&r.push(o)}return r}function DE(t){return t.reduce(function(e,n){return e.concat(Dt.arr(n)?DE(n):n)},[])}function T6(t){return Dt.arr(t)?t:(Dt.str(t)&&(t=KZ(t)||t),t instanceof NodeList||t instanceof HTMLCollection?[].slice.call(t):[t])}function RF(t,e){return t.some(function(n){return n===e})}function LF(t){var e={};for(var n in t)e[n]=t[n];return e}function UI(t,e){var n=LF(t);for(var i in t)n[i]=e.hasOwnProperty(i)?e[i]:t[i];return n}function RE(t,e){var n=LF(t);for(var i in e)n[i]=Dt.und(t[i])?e[i]:t[i];return n}function cFe(t){var e=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(t);return e?"rgba("+e[1]+",1)":t}function uFe(t){var e=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,n=t.replace(e,function(a,l,c,h){return l+l+c+c+h+h}),i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n),r=parseInt(i[1],16),s=parseInt(i[2],16),o=parseInt(i[3],16);return"rgba("+r+","+s+","+o+",1)"}function hFe(t){var e=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(t)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(t),n=parseInt(e[1],10)/360,i=parseInt(e[2],10)/100,r=parseInt(e[3],10)/100,s=e[4]||1;function o(d,f,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?d+(f-d)*6*p:p<1/2?f:p<2/3?d+(f-d)*(2/3-p)*6:d}var a,l,c;if(i==0)a=l=c=r;else{var h=r<.5?r*(1+i):r+i-r*i,u=2*r-h;a=o(u,h,n+1/3),l=o(u,h,n),c=o(u,h,n-1/3)}return"rgba("+a*255+","+l*255+","+c*255+","+s+")"}function dFe(t){if(Dt.rgb(t))return cFe(t);if(Dt.hex(t))return uFe(t);if(Dt.hsl(t))return hFe(t)}function Kc(t){var e=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(t);if(e)return e[1]}function fFe(t){if(Fy(t,"translate")||t==="perspective")return"px";if(Fy(t,"rotate")||Fy(t,"skew"))return"deg"}function kI(t,e){return Dt.fnc(t)?t(e.target,e.id,e.total):t}function kl(t,e){return t.getAttribute(e)}function IF(t,e,n){var i=Kc(e);if(RF([n,"deg","rad","turn"],i))return e;var r=hM.CSS[e+n];if(!Dt.und(r))return r;var s=100,o=document.createElement(t.tagName),a=t.parentNode&&t.parentNode!==document?t.parentNode:document.body;a.appendChild(o),o.style.position="absolute",o.style.width=s+n;var l=s/o.offsetWidth;a.removeChild(o);var c=l*parseFloat(e);return hM.CSS[e+n]=c,c}function JZ(t,e,n){if(e in t.style){var i=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=t.style[e]||getComputedStyle(t).getPropertyValue(i)||"0";return n?IF(t,r,n):r}}function BF(t,e){if(Dt.dom(t)&&!Dt.inp(t)&&(kl(t,e)||Dt.svg(t)&&t[e]))return"attribute";if(Dt.dom(t)&&RF(oFe,e))return"transform";if(Dt.dom(t)&&e!=="transform"&&JZ(t,e))return"css";if(t[e]!=null)return"object"}function ZZ(t){if(Dt.dom(t)){for(var e=t.style.transform||"",n=/(\w+)\(([^)]*)\)/g,i=new Map,r;r=n.exec(e);)i.set(r[1],r[2]);return i}}function pFe(t,e,n,i){var r=Fy(e,"scale")?1:0+fFe(e),s=ZZ(t).get(e)||r;return n&&(n.transforms.list.set(e,s),n.transforms.last=e),i?IF(t,s,i):s}function OF(t,e,n,i){switch(BF(t,e)){case"transform":return pFe(t,e,i,n);case"css":return JZ(t,e,n);case"attribute":return kl(t,e);default:return t[e]||0}}function FF(t,e){var n=/^(\*=|\+=|-=)/.exec(t);if(!n)return t;var i=Kc(t)||0,r=parseFloat(e),s=parseFloat(t.replace(n[0],""));switch(n[0][0]){case"+":return r+s+i;case"-":return r-s+i;case"*":return r*s+i}}function $Z(t,e){if(Dt.col(t))return dFe(t);if(/\s/g.test(t))return t;var n=Kc(t),i=n?t.substr(0,t.length-n.length):t;return e?i+e:i}function NF(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function mFe(t){return Math.PI*2*kl(t,"r")}function gFe(t){return kl(t,"width")*2+kl(t,"height")*2}function vFe(t){return NF({x:kl(t,"x1"),y:kl(t,"y1")},{x:kl(t,"x2"),y:kl(t,"y2")})}function e$(t){for(var e=t.points,n=0,i,r=0;r<e.numberOfItems;r++){var s=e.getItem(r);r>0&&(n+=NF(i,s)),i=s}return n}function yFe(t){var e=t.points;return e$(t)+NF(e.getItem(e.numberOfItems-1),e.getItem(0))}function t$(t){if(t.getTotalLength)return t.getTotalLength();switch(t.tagName.toLowerCase()){case"circle":return mFe(t);case"rect":return gFe(t);case"line":return vFe(t);case"polyline":return e$(t);case"polygon":return yFe(t)}}function xFe(t){var e=t$(t);return t.setAttribute("stroke-dasharray",e),e}function _Fe(t){for(var e=t.parentNode;Dt.svg(e)&&Dt.svg(e.parentNode);)e=e.parentNode;return e}function n$(t,e){var n=e||{},i=n.el||_Fe(t),r=i.getBoundingClientRect(),s=kl(i,"viewBox"),o=r.width,a=r.height,l=n.viewBox||(s?s.split(" "):[0,0,o,a]);return{el:i,viewBox:l,x:l[0]/1,y:l[1]/1,w:o/l[2],h:a/l[3]}}function wFe(t,e){var n=Dt.str(t)?KZ(t)[0]:t,i=e||100;return function(r){return{property:r,el:n,svg:n$(n),totalLength:t$(n)*(i/100)}}}function SFe(t,e){function n(a){a===void 0&&(a=0);var l=e+a>=1?e+a:0;return t.el.getPointAtLength(l)}var i=n$(t.el,t.svg),r=n(),s=n(-1),o=n(1);switch(t.property){case"x":return(r.x-i.x)*i.w;case"y":return(r.y-i.y)*i.h;case"angle":return Math.atan2(o.y-s.y,o.x-s.x)*180/Math.PI}}function P6(t,e){var n=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,i=$Z(Dt.pth(t)?t.totalLength:t,e)+"";return{original:i,numbers:i.match(n)?i.match(n).map(Number):[0],strings:Dt.str(t)||e?i.split(n):[]}}function i$(t){var e=t?DE(Dt.arr(t)?t.map(T6):T6(t)):[];return PE(e,function(n,i,r){return r.indexOf(n)===i})}function r$(t){var e=i$(t);return e.map(function(n,i){return{target:n,id:i,total:e.length,transforms:{list:ZZ(n)}}})}function bFe(t,e){var n=LF(e);if(/^spring/.test(n.easing)&&(n.duration=qZ(n.easing)),Dt.arr(t)){var i=t.length,r=i===2&&!Dt.obj(t[0]);r?t={value:t}:Dt.fnc(e.duration)||(n.duration=e.duration/i)}var s=Dt.arr(t)?t:[t];return s.map(function(o,a){var l=Dt.obj(o)&&!Dt.pth(o)?o:{value:o};return Dt.und(l.delay)&&(l.delay=a?0:e.delay),Dt.und(l.endDelay)&&(l.endDelay=a===s.length-1?e.endDelay:0),l}).map(function(o){return RE(o,n)})}function AFe(t){for(var e=PE(DE(t.map(function(s){return Object.keys(s)})),function(s){return Dt.key(s)}).reduce(function(s,o){return s.indexOf(o)<0&&s.push(o),s},[]),n={},i=function(s){var o=e[s];n[o]=t.map(function(a){var l={};for(var c in a)Dt.key(c)?c==o&&(l.value=a[c]):l[c]=a[c];return l})},r=0;r<e.length;r++)i(r);return n}function MFe(t,e){var n=[],i=e.keyframes;i&&(e=RE(AFe(i),e));for(var r in e)Dt.key(r)&&n.push({name:r,tweens:bFe(e[r],t)});return n}function EFe(t,e){var n={};for(var i in t){var r=kI(t[i],e);Dt.arr(r)&&(r=r.map(function(s){return kI(s,e)}),r.length===1&&(r=r[0])),n[i]=r}return n.duration=parseFloat(n.duration),n.delay=parseFloat(n.delay),n}function CFe(t,e){var n;return t.tweens.map(function(i){var r=EFe(i,e),s=r.value,o=Dt.arr(s)?s[1]:s,a=Kc(o),l=OF(e.target,t.name,a,e),c=n?n.to.original:l,h=Dt.arr(s)?s[0]:c,u=Kc(h)||Kc(l),d=a||u;return Dt.und(o)&&(o=c),r.from=P6(h,d),r.to=P6(FF(o,h),d),r.start=n?n.end:0,r.end=r.start+r.delay+r.duration+r.endDelay,r.easing=DF(r.easing,r.duration),r.isPath=Dt.pth(s),r.isColor=Dt.col(r.from.original),r.isColor&&(r.round=1),n=r,r})}var s$={css:function(t,e,n){return t.style[e]=n},attribute:function(t,e,n){return t.setAttribute(e,n)},object:function(t,e,n){return t[e]=n},transform:function(t,e,n,i,r){if(i.list.set(e,n),e===i.last||r){var s="";i.list.forEach(function(o,a){s+=a+"("+o+") "}),t.style.transform=s}}};function o$(t,e){var n=r$(t);n.forEach(function(i){for(var r in e){var s=kI(e[r],i),o=i.target,a=Kc(s),l=OF(o,r,a,i),c=a||Kc(l),h=FF($Z(s,c),l),u=BF(o,r);s$[u](o,r,h,i.transforms,!0)}})}function TFe(t,e){var n=BF(t.target,e.name);if(n){var i=CFe(e,t),r=i[i.length-1];return{type:n,property:e.name,animatable:t,tweens:i,duration:r.end,delay:i[0].delay,endDelay:r.endDelay}}}function PFe(t,e){return PE(DE(t.map(function(n){return e.map(function(i){return TFe(n,i)})})),function(n){return!Dt.und(n)})}function a$(t,e){var n=t.length,i=function(s){return s.timelineOffset?s.timelineOffset:0},r={};return r.duration=n?Math.max.apply(Math,t.map(function(s){let o=s.startOnceDelay??0,a=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return i(s)+o+a+l+s.duration*(s.loop??1)})):e.duration,r.delay=n?Math.min.apply(Math,t.map(function(s){let o=s.startOnceDelay??0,a=s.pingPongDelayCorrection??0;return i(s)+o+a+s.delay})):e.delay,r.endDelay=n?r.duration-Math.max.apply(Math,t.map(function(s){let o=s.startOnceDelay??0,a=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return i(s)+o+a+s.duration*(s.loop??1)-s.endDelay-l})):e.endDelay,r}var D6=0;function DFe(t){var e=UI(XZ,t),n=UI(PF,t),i=MFe(n,t),r=r$(t.targets),s=PFe(r,i),o=a$(s,n),a=D6;return D6++,RE(e,{id:a,children:[],animatables:r,animations:s,duration:o.duration,delay:o.delay,endDelay:o.endDelay,startOnceDelay:n.startOnceDelay,pingPongDelayCorrection:n.pingPongDelayCorrection,pingPongEndDelayCorrection:n.pingPongEndDelayCorrection})}var sa=[],R6=[],Lb,RFe=function(){function t(){Lb=requestAnimationFrame(e)}function e(n){var i=sa.length;if(i){for(var r=0;r<i;){var s=sa[r];s.paused?(sa.splice(r,1),i-=1):(s.tick(n),r++)}t()}else Lb=cancelAnimationFrame(Lb)}return t}();function LFe(t){document.hidden?(sa.forEach(function(e){return e.pause(t.timeStamp)}),R6=sa.slice(0),Pi.running=sa=[]):R6.forEach(function(e){return e.play(t.timeStamp)})}typeof document<"u"&&document.addEventListener("visibilitychange",LFe);function Pi(t){t===void 0&&(t={});var e=0,n=0,i=0,r,s,o=0,a=null;function l(b){var T=window.Promise&&new Promise(function(M){return a=M});return b.finished=T,T}var c=DFe(t);l(c);function h(){var b=c.direction;b!=="alternate"&&(c.direction=b!=="normal"?"normal":"reverse"),c.reversed=!c.reversed,s.forEach(function(T){(T.loop===1||T.loop%2===0)&&(T.reversed=c.reversed)})}function u(){c.direction="normal",c.reversed=!1,s.forEach(function(b){return b.reversed=!1})}function d(b){return c.reversed?c.duration-b:b}function f(){e=0,n=d(c.currentTime)*(1/Pi.speed)}function p(b,T){T&&(c.reversed?T.seek(T.duration*T.loop-(b-T.timelineOffset-T.pingPongDelayCorrection)):T.seek(b-T.timelineOffset-T.startOnceDelay-T.pingPongDelayCorrection))}function v(b){if(c.reversed)for(var T=o;T--;)p(b,s[T]);else for(var M=0;M<o;M++)p(b,s[M])}function g(b){var K,oe,ve,$,se,ne,ie,me,xe,Ae;var T=0,M=c.animations,E=M.length;for(c.direction!=="alternate"&&((K=c.parent)==null?void 0:K.direction)==="alternate"?((oe=c.parent)==null?void 0:oe.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1&&((ve=c.parent)!=null&&ve.reversed&&c.direction==="alternate"?b=c.duration-c.delay+c.endDelay-b:b=c.duration+c.delay-c.endDelay-b):S(!1,($=c.parent)==null?void 0:$.rewind,c.rewind,(se=c.parent)==null?void 0:se.reversePlayback,c.reversePlayback)&&((ne=c.parent)!=null&&ne.reversed&&c.direction==="alternate"?b=c.duration-c.delay+c.endDelay-b:b=c.duration+c.delay-c.endDelay-b);T<E;){var P=M[T],R=P.animatable,F=P.tweens,B=F.length-1,k=F[B];B&&(k=PE(F,function(Ee){return b<Ee.end})[0]||k);let we;(ie=c.parent)!=null&&ie.reversed&&c.direction==="alternate"?we=za(b-k.start-k.endDelay,0,k.duration)/k.duration:we=za(b-k.start-k.delay,0,k.duration)/k.duration;for(var j=isNaN(we)?1:k.easing(we),Z=k.to.strings,ee=k.round,O=[],W=k.to.numbers.length,H=void 0,Y=0;Y<W;Y++){var z=void 0;let Ee,Re;c.direction!=="alternate"?((me=c.parent)==null?void 0:me.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1?(Ee=k.to.numbers[Y],Re=k.from.numbers[Y]||0):(Re=k.to.numbers[Y],Ee=k.from.numbers[Y]||0):S(!0,(xe=c.parent)==null?void 0:xe.rewind,c.rewind,(Ae=c.parent)==null?void 0:Ae.reversePlayback,c.reversePlayback)?(Ee=k.to.numbers[Y],Re=k.from.numbers[Y]||0):(Re=k.to.numbers[Y],Ee=k.from.numbers[Y]||0),k.isPath?z=SFe(k.value,j*Re):z=Ee+j*(Re-Ee),ee&&(k.isColor&&Y>2||(z=Math.round(z*ee)/ee)),O.push(z)}var X=Z.length;if(!X)H=O[0];else{H=Z[0];for(var q=0;q<X;q++){Z[q];var re=Z[q+1],G=O[q];isNaN(G)||(re?H+=G+re:H+=G+" ")}}s$[P.type](R.target,P.property,H,R.transforms),P.currentValue=H,T++}}function m(b){c[b]&&!c.passThrough&&c[b](c)}function y(){c.remaining&&c.remaining!==!0&&c.remaining--}let _={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function S(b,T,M,E,P){return _[b<<4|T<<3|M<<2|E<<1|P]}function A(b){var R;var T=c.duration;let M=c.delay,E=T-c.endDelay;(R=c.parent)!=null&&R.reversed&&c.direction==="alternate"&&(M=c.endDelay,E=T-c.delay);var P=d(b);if(c.progress=za(P/T*100,0,100),c.reversePlayback=P<c.currentTime,o&&v(P),!c.began&&c.currentTime>=0&&(c.began=!0,m("begin")),!c.loopBegan&&c.currentTime>0&&(c.loopBegan=!0,m("loopBegin")),(c.reversed||P>=0)&&P<=M&&c.currentTime!==0&&(g(0),m("change")),(P>=E&&c.currentTime!==T+c.pingPongDelayCorrection||!T)&&(g(T),m("change")),P>M&&P<E?(c.changeBegan||(c.changeBegan=!0,c.changeCompleted=!1,m("changeBegin")),g(P),m("change")):c.changeBegan?(c.changeCompleted=!0,c.changeBegan=!1,m("change"),o&&m("timelineChangeComplete")):c.began&&P>E&&m("changeComplete"),c.currentTime=za(P,0,T+c.pingPongDelayCorrection),c.began&&m("update"),b>=T)if(y(),!c.remaining)c.paused=!0,c.completed||(c.completed=!0,m("loopComplete"),m("complete"),!c.passThrough&&"Promise"in window&&(a(),l(c)));else{o?e+=c.duration/Pi.speed:e+=c.duration;for(let F of s)F.setStartTime(0),F.remaining=F.loop;m("loopComplete"),c.loopBegan=!1,c.direction==="alternate"?h():o&&u()}}return c.reset=function(){var b=c.direction;c.passThrough=!1,c.currentTime=0,c.progress=0,c.paused=!0,c.began=!1,c.loopBegan=!1,c.changeBegan=!1,c.completed=!1,c.changeCompleted=!1,c.reversePlayback=!1,c.reversed=b==="reverse",c.remaining=c.loop,s=c.children,o=s.length;for(var T=o;T--;)c.children[T].reset();(c.reversed&&c.loop!==!0||b==="alternate"&&c.loop===1)&&c.remaining++,g(c.reversed?c.duration:0)},c.setStartTime=function(b){e=b},c.set=function(b,T){return o$(b,T),c},c.tick=function(b){i=b,e||(e=i),A((i+(n-e))*Pi.speed)},c.seek=function(b){A(b-e)},c.pause=function(b){c.paused=!0,o&&(r=b??performance.now())},c.play=function(b){!c.paused||(c.completed&&c.reset(),c.paused=!1,sa.push(c),o&&r!==void 0&&(e+=(b??performance.now())-r),Lb||RFe())},c.reverse=function(){h(),c.completed=!c.reversed,f()},c.restart=function(){c.reset(),c.play()},c.reset(),c.autoplay&&c.play(),c}function L6(t,e){for(var n=e.length;n--;)RF(t,e[n].animatable.target)&&e.splice(n,1)}function IFe(t){for(var e=i$(t),n=sa.length;n--;){var i=sa[n],r=i.animations,s=i.children;L6(e,r);for(var o=s.length;o--;){var a=s[o],l=a.animations;L6(e,l),!l.length&&!a.children.length&&s.splice(o,1)}!r.length&&!s.length&&i.pause()}}function BFe(t,e){e===void 0&&(e={});var n=e.direction||"normal",i=e.easing?DF(e.easing):null,r=e.grid,s=e.axis,o=e.from||0,a=o==="first",l=o==="center",c=o==="last",h=Dt.arr(t),u=parseFloat(h?t[0]:t),d=h?parseFloat(t[1]):0,f=Kc(h?t[1]:t)||0,p=e.start||0+(h?u:0),v=[],g=0;return function(m,y,_){if(a&&(o=0),l&&(o=(_-1)/2),c&&(o=_-1),!v.length){for(var S=0;S<_;S++){if(!r)v.push(Math.abs(o-S));else{var A=l?(r[0]-1)/2:o%r[0],b=l?(r[1]-1)/2:Math.floor(o/r[0]),T=S%r[0],M=Math.floor(S/r[0]),E=A-T,P=b-M,R=Math.sqrt(E*E+P*P);s==="x"&&(R=-E),s==="y"&&(R=-P),v.push(R)}g=Math.max.apply(Math,v)}i&&(v=v.map(function(B){return i(B/g)*g})),n==="reverse"&&(v=v.map(function(B){return s?B<0?B*-1:-B:Math.abs(g-B)}))}var F=h?(d-u)/g:u;return p+F*(Math.round(v[y]*100)/100)+f}}function OFe(t){t===void 0&&(t={});var e=Pi(t);return e.duration=0,e.add=function(n,i){var r=sa.indexOf(e),s=e.children;r>-1&&sa.splice(r,1);function o(d){d.passThrough=!0}for(var a=0;a<s.length;a++)o(s[a]);var l=RE(n,UI(PF,t));l.targets=l.targets||t.targets;var c=e.duration;l.autoplay=!1,l.timelineOffset=Dt.und(i)?c:FF(i,c),o(e);var h=Pi(l);o(h),s.push(h),h.parent=e;var u=a$(s,t);return e.delay=u.delay,e.endDelay=u.endDelay,e.duration=u.duration,h.loop===!0&&(e.duration=1/0),e.seek(0),e.reset(),e.autoplay&&e.play(),e},e}Pi.version="3.2.0";Pi.speed=1;Pi.running=sa;Pi.remove=IFe;Pi.get=OF;Pi.set=o$;Pi.convertPx=IF;Pi.path=wFe;Pi.setDashoffset=xFe;Pi.stagger=BFe;Pi.timeline=OFe;Pi.easing=DF;Pi.penner=QZ;Pi.random=function(t,e){return Math.floor(Math.random()*(e-t+1))+t};var l$=Pi,I6=new N,B6=new N,O6=new on;function FFe(t,e,n,i){if(i===0)return n.copy(t);if(i===1)return n.copy(e);let r=t.w*e.w+t.x*e.x+t.y*e.y+t.z*e.z;if(r>=1)return n.copy(t);let s=1-r*r;if(s<=Number.EPSILON){let h=1-i;return n.w=h*t.w+i*e.w,n.x=h*t.x+i*e.x,n.y=h*t.y+i*e.y,n.z=h*t.z+i*e.z,n.normalize(),n}let o=Math.sqrt(s),a=Math.atan2(o,r),l=Math.sin((1-i)*a)/o,c=Math.sin(i*a)/o;return n.w=t.w*l+e.w*c,n.x=t.x*l+e.x*c,n.y=t.y*l+e.y*c,n.z=t.z*l+e.z*c,n}function Nf(t,e,n,i,r){let s=n[t]?n[t]:void 0,o=i[t];if(o==null)return;let a=s??e[t],l=o;if(a!==l)return{update:c=>{let h=sn.lerp(a,l,c);r?e[t]=Math.trunc(h):e[t]=h},start:()=>{e[t]=a},end:()=>{e[t]=l}}}function c$(t,e,n,i,r){let s=n[t]?n[t]:void 0,o=i[t];if(!o)return;let a=e[t],l=[...s??a],c=[...o];if(!(l.length!==c.length||qO(l,c)))return{update:h=>{l.forEach((u,d)=>{let f=sn.lerp(u,c[d],h);e[t][d]=r?Math.trunc(f):f})},start:()=>{Object.assign(e[t],l)},end:()=>{Object.assign(e[t],c)}}}function F6(t,e,n,i){let r=n[t]?n[t]:void 0,s=i[t];if(!s)return;let o=e[t],a=r?new N().fromArray(r):o.clone(),l=new N().fromArray(s);if(!a.equals(l))return{update:c=>{o.lerpVectors(a,l,c)},start:()=>{o.copy(a)},end:()=>{o.copy(l)}}}function NFe(t,e,n,i){let r=n[t]?n[t]:void 0,s=i[t];if(!s)return;let o=e[t],a=r?new nt().fromArray(r):o.clone(),l=new N,c=new on,h=new N;a.decompose(l,c,h);let u=new nt().fromArray(s),d=new N,f=new on,p=new N;if(u.decompose(d,f,p),!a.equals(u))return{update:v=>{O6.slerpQuaternions(c,f,v),I6.lerpVectors(l,d,v),B6.lerpVectors(h,p,v),o.compose(I6,O6,B6)},start:()=>{o.compose(l,c,h)},end:()=>{o.compose(d,f,p)}}}function UFe(t,e,n,i,r){let s=n[t]?n[t]:void 0,o=i[t];if(!o)return;let a=e[t],l=s?typeof s=="string"?r.getColor(s).clone():new Rt().setRGB(s.r,s.g,s.b):a.clone(),c=typeof o=="string"?r.getColor(o).clone():new Rt().setRGB(o.r,o.g,o.b);if(l.equals(c))return;let h=a.clone();return e[t]=h,{update:u=>{h.lerpColors(l,c,u)},start:()=>{h.copy(l)},end:()=>{h.copy(c)}}}function td(t,e,n,i){if(typeof e[t]=="number")return Nf(t,e,n??{},i);if(Array.isArray(e[t]))return c$(t,e,n??{},i)}function kFe(t,e,n){var o,a,l,c;let i=[],r=t.cameraType==="OrthographicCamera"?(o=e.orthographic)==null?void 0:o.zoom:(a=e.perspective)==null?void 0:a.zoom,s=t.cameraType==="OrthographicCamera"?(l=n.orthographic)==null?void 0:l.zoom:(c=n.perspective)==null?void 0:c.zoom;if(s!==void 0){let h=r??t.zoom,u=s;h!==u&&i.push({update:d=>{t.zoom=sn.lerp(h,u,d),t.updateProjectionMatrix()},start:()=>{t.zoom=h,t.updateProjectionMatrix()},end:()=>{t.zoom=u,t.updateProjectionMatrix()}})}if(n.targetOffset!==void 0){let h=Nf("targetOffset",t,e,n);h&&i.push(h)}return i}function zFe(t,e,n,i){if(n.scaleBaked===void 0)return;let r=e.scaleBaked??t.data.geometry.scaleBaked,s=n.scaleBaked;if(yf.isEqual(r,s))return;let o=[];return o.push({update:a=>{t.updateGeometryInteractions({scaleBaked:[sn.lerp(r[0],s[0],a),sn.lerp(r[1],s[1],a),sn.lerp(r[2],s[2],a)]},i),t.invalidateDownstreamBooleanData()},start:()=>{t.updateGeometryInteractions({scaleBaked:r},i),t.invalidateDownstreamBooleanData()},end:()=>{t.updateGeometryInteractions({scaleBaked:s},i),t.invalidateDownstreamBooleanData()}}),o}function GFe(t,e,n){if(!n.extrusion)return;let i=t.extrusion,r=e.extrusion??{},s=n.extrusion,o=[];return sJ.forEach(a=>{let l=td(a,i,r,s);l&&o.push(l)}),o}function HFe(t,e,n,i){let r=[];if(!("geometry"in n))return r;let s=t.geometry.userData.parameters,o="geometry"in e?e.geometry:{},a=n.geometry;if(t instanceof kx){let l=zFe(t,o,a,i);l&&r.push(...l)}else{let l={};if(Object.assign(l,Rx(s,j5)),j5.forEach(c=>{let h=td(c,l,o,a);h&&r.push(h)}),t instanceof bF){Object.assign(l,{extrusion:{...s.extrusion}});let c=GFe(l,o,a);c&&r.push(...c)}r.length&&r.push({update:c=>{t.updateGeometryInteractions(l,i),t.updateGeometryGroupsIfNeeded()},start:c=>{t.updateGeometryInteractions(l,i),t.updateGeometryGroupsIfNeeded()},end:c=>{t.updateGeometryInteractions(l,i),t.updateGeometryGroupsIfNeeded()}})}return r}function VFe(t,e,n,i){let r=[];if(n.intensity!==void 0){let s=Nf("intensity",t,e,n);s&&r.push(s)}if(n.color!==void 0){let s=UFe("color",t,e,n,i);s&&r.push(s)}return r}function jFe(t,e,n,i){let r=[];if(Array.isArray(t.material)){if(!("materials"in n&&n.materials))return r;let s="materials"in e&&e.materials?e.materials:[],o=n.materials;t.material.forEach((a,l)=>{if(!o[l])return;let c=s[l]??{},h=o[l];typeof c=="string"||typeof h=="string"||r.push(...N6(a,c,h,i))})}else{if(!("material"in n&&n.material))return r;let s="material"in e&&e.material?e.material:{},o=n.material;if(typeof s=="string"||typeof o=="string")return r;r.push(...N6(t.material,s,o,i))}return r}function N6(t,e,n,i){var o;let r=[],s=oM(n,i)||!!e.layers&&oM(e,i);r.push($Fe(t,s));for(let a of t.layers){let l=(o=e.layers)==null?void 0:o.data(a.uuid),c=n.layers.data(a.uuid);if(!c||!(a.visible??!0)||!(c.visible??!0))continue;let h=a.getNames().filter(u=>!nJ.some(d=>u.includes(d)));for(let u of h)try{let d=a.getValue(u),f;if(u==="colors")f=JFe(a,l,c,u);else if(Array.isArray(d))u==="steps"&&(f=KFe(a,l,c,u));else if(typeof d=="number")f=WFe(a,l,c,u);else{if(typeof d=="boolean")continue;d instanceof Se?f=XFe(a,l,c,u):d instanceof N?f=YFe(a,l,c,u):d instanceof Ns?f=QFe(a,l,c,u,i):d instanceof Rt?f=qFe(a,l,c,u,i):"isTexture"in d&&(f=ZFe(a,l,c,u))}f&&(Array.isArray(f)?r.push(...f):r.push(f))}catch(d){console.error(`lerpMaterial: unexpected material layer for ${u}`,d)}}return r}function WFe(t,e,n,i){if(!t.hasValue(i)||!(i in n))return;let r=e?e[i]:t.getValue(i),s=n[i];if(r!==s)return{update:o=>{t.setValue(i,sn.lerp(r,s,o))},start:()=>{t.setValue(i,r)},end:()=>{t.setValue(i,s)}}}function XFe(t,e,n,i){if(!t.hasValue(i)||!(i in n))return;let r=t.getValue(i),s=e?new Se().fromArray(e[i]):r.clone(),o=new Se().fromArray(n[i]);if(!s.equals(o))return{update:a=>{r.lerpVectors(s,o,a)},start:()=>{r.copy(s)},end:()=>{r.copy(o)}}}function YFe(t,e,n,i){if(!t.hasValue(i)||!(i in n))return;let r=t.getValue(i),s=e?new N().fromArray(e[i]):r.clone(),o=new N().fromArray(n[i]);if(!s.equals(o))return{update:a=>{r.lerpVectors(s,o,a)},start:()=>{r.copy(s)},end:()=>{r.copy(o)}}}function qFe(t,e,n,i,r){if(!t.hasValue(i)||!(i in n))return;let s=e?e[i]:void 0,o=n[i],a=t.getValue(i),l=s?typeof s=="string"?r.getColor(s).clone():new Rt().setRGB(s.r,s.g,s.b):a.clone(),c=typeof o=="string"?r.getColor(o).clone():new Rt().setRGB(o.r,o.g,o.b);if(l.equals(c))return;let h=a.clone();return t.setValue(i,h),{update:u=>{h.lerpColors(l,c,u)},start:()=>{h.copy(l)},end:()=>{h.copy(c)}}}function QFe(t,e,n,i,r){if(!t.hasValue(i)||!(i in n))return;let s=e?e[i]:void 0,o=n[i],a=t.getValue(i),l=s?typeof s=="string"?r.getColor(s).clone():new Rt().setRGB(s.r,s.g,s.b):a.clone(),c=typeof o=="string"?r.getColor(o).clone():new Ns(o.r,o.g,o.b,o.a);if(l.equals(c))return;let h=a.clone();return t.setValue(i,h),{update:u=>{h.lerpColors(l,c,u)},start:()=>{h.copy(l)},end:()=>{h.copy(c)}}}function KFe(t,e,n,i="steps"){if(!t.hasValue(i)||!(i in n))return;let r=[],s=t.getValue(i),o=e?e[i]:s,a=n[i];for(let l=0;l<s.length;++l){let c=o[l],h=a[l];c!==h&&r.push({update:u=>{s[l]=sn.lerp(c,h,u)},start:()=>{s[l]=c},end:()=>{s[l]=h}})}return r.length?r:void 0}function JFe(t,e,n,i="colors"){if(!t.hasValue(i)||!(i in n))return;let r=[],s=t.getValue(i),o=e?e[i]:s.map(l=>l.toArray()),a=n[i];for(let l=0;l<s.length;++l){let c=[...o[l]],h=[...a[l]];GA.isEqual(c,h)||r.push({update:u=>{s[l].fromArray(GA.lerp(c,h,u))},start:()=>{s[l].fromArray(c)},end:()=>{s[l].fromArray(h)}})}return r.length?r:void 0}function ZFe(t,e,n,i="texture"){if(!t.hasValue(i)||!(i in n))return;let r=t.getNode("mat");if(!r)return;let s=e?e[i]:r,o=n[i],a=[...s.repeat],l=[...s.offset],c=[...o.repeat],h=[...o.offset];if(!Gm.isEqual(a,c)||!Gm.isEqual(l,h))return{update:u=>{r.repeat=Gm.lerp(a,c,u),r.offset=Gm.lerp(l,h,u),r.updateMatrix()},start:()=>{r.repeat=[...a],r.offset=[...l],r.updateMatrix()},end:()=>{r.repeat=[...c],r.offset=[...h],r.updateMatrix()}}}function $Fe(t,e){return{update:()=>{t.transparent=e}}}var q2=new N,U6=new Tr;function eNe(t,e,n,i){let r=[],s,o,a,l,c,h,u={slide:(e.pathSnapping??t.updatedPathSnapping??t.dataPatched.pathSnapping).slide,offset:(e.pathSnapping??t.updatedPathSnapping??t.dataPatched.pathSnapping).offset};if(c=Nf("slide",u,e.pathSnapping??t.updatedPathSnapping??t.dataPatched.pathSnapping,n.pathSnapping??t.dataPatched.pathSnapping),c&&r.push(c),h=Nf("offset",u,e.pathSnapping??t.updatedPathSnapping??t.dataPatched.pathSnapping,n.pathSnapping??t.dataPatched.pathSnapping),h&&r.push(h),!c&&!h&&(s=F6("position",t,e,n),s&&r.push(s),o=F6("scale",t,e,n),o&&r.push(o),a=tNe(t,e,n,i),a&&r.push(a),l=NFe("hiddenMatrix",t,e,n),l&&r.push(l)),s||o||a||l||c||h){let d=()=>{var f;t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),(f=t.parent)!=null&&f.matrixWorldFusedFalse&&(t.matrixWorld.multiplyMatrices(t.parent.matrixWorldFusedFalse,t.matrix),t.matrixWorldNeedsUpdate=!1),Ol(t)&&Hc(t.parent)&&t.invalidateDownstreamBooleanData(!0),t.updatePathSnapping(Object.assign({},e.pathSnapping,u))};r.push({update:d,start:d,end:d})}return r}function tNe(t,e,n,i){let r=e!=null&&e.rotation?e.rotation:void 0,s=n.rotation;if(!s)return;let o=r?new N().fromArray(r):new N().setFromEuler(t.rotation),a=new N().fromArray(s);if(o.equals(a))return;let l=q2.subVectors(a,o);if(i&&l.toArray().every(c=>Math.abs(c)<2*Math.PI)){let c=new on().setFromEuler(U6.setFromVector3(o)),h=new on().setFromEuler(U6.setFromVector3(a));return{update:u=>{FFe(c,h,t.quaternion,u)},start:()=>{t.rotation.setFromVector3(o)},end:()=>{t.rotation.setFromVector3(a)}}}else return{update:c=>{q2.lerpVectors(o,a,c),t.rotation.setFromVector3(q2)},start:()=>{t.rotation.setFromVector3(o)},end:()=>{t.rotation.setFromVector3(a)}}}function nNe(t,e,n){let i=[];if(!("cloner"in n)||!t.cloner)return i;let r=t.cloner,s="cloner"in e?e.cloner:{},o=n.cloner;KK.forEach(d=>{let f;d==="count"?f=Nf("count",r.parameters,s,o,!0):f=td(d,r.parameters,s??{},o),f&&i.push(f)});let a=iNe(r,s,o);a!=null&&a.length&&i.push(...a);let l=rNe(r,s,o);l!=null&&l.length&&i.push(...l);let c=sNe(r,s,o);c!=null&&c.length&&i.push(...c);let h=oNe(r,s,o);h!=null&&h.length&&i.push(...h);let u=aNe(r,s,o);return u!=null&&u.length&&i.push(...u),i.length&&i.push({update:()=>{r.update()}}),i}function iNe(t,e,n){if(t.parameters.type!=="radial")return;let i=e.radial,r=n.radial;if(!r)return;let s=t.parameters.radial,o=[];return JK.forEach(a=>{let l=td(a,s,i??{},r);l&&o.push(l)}),o}function rNe(t,e,n){if(t.parameters.type!=="linear")return;let i=e.linear,r=n.linear;if(!r)return;let s=[],o=t.parameters.linear;return ZK.forEach(a=>{let l=td(a,o,i??{},r);l&&s.push(l)}),s}function sNe(t,e,n){if(t.parameters.type!=="grid")return;let i=e.grid,r=n.grid;if(!r)return;let s=[],o=t.parameters.grid;return $K.forEach(a=>{let l;a==="count"?l=c$(a,o,i??{},r,!0):l=td(a,o,i??{},r),l&&s.push(l)}),s}function oNe(t,e,n){if(t.parameters.type!=="toObject")return;let i=e.toObject,r=n.toObject;if(!r)return;let s=[],o=t.parameters.toObject;return eJ.forEach(a=>{let l;a==="count"?l=Nf(a,o,i??{},r,!0):l=td(a,o,i??{},r),l&&s.push(l)}),s}function aNe(t,e,n){if(!t.parameters.randomness)return;let i=e.randomnessObject,r=n.randomnessObject;if(!r)return;let s=[],o=t.parameters.randomnessObject;return tJ.forEach(a=>{let l=td(a,o,i??{},r);l&&s.push(l)}),s}function k6(t,e,n,i,r){let s=[];return t.data.visible&&s.push(...eNe(t,e,n,r)),t.data.visible&&s.push(...nNe(t,e,n)),Ol(t)?(t instanceof ua&&t.data.visible&&s.push(...HFe(t,e,n,i)),t.data.visible&&s.push(...jFe(t,e,n,i))):hOe(t)?t.data.visible&&s.push(...VFe(t,e,n,i)):uOe(t)&&s.push(...kFe(t,e,n)),s.length?{update:o=>{s.forEach(a=>a.update(o))},start:o=>{s.forEach(a=>{var l;return(l=a.start)==null?void 0:l.call(a,o)})},end:o=>{s.forEach(a=>{var l;return(l=a.end)==null?void 0:l.call(a,o)})}}:void 0}var z6=new N;function u$(t,e,n,i=!1){let r=[];e.traverseObject(s=>{var c,h,u,d,f;if(i&&((c=s.rigidBody)==null||c.setTranslation(s.position0,!0),(h=s.rigidBody)==null||h.setRotation(s.rotation0,!0),(u=s.rigidBody)==null||u.setLinvel(z6,!0),(d=s.rigidBody)==null||d.setAngvel(z6,!0)),!Pn.is(s))return;let o=s.uuid,a=s.data;if(delete s.states,!a.states)return;let l=!1;r.some(p=>t.objects.isDescendantOf(o,p))?l=!0:((f=a.physics)==null?void 0:f.fusedBody)===!0&&a.physics.rigidBody==="dynamic"&&r.push(o),s.data=a,s.currentState=null,s.reversibleToState=null,s.currentTransitionEvent=null;for(let p of a.states)t.environment.usePhysics===!0&&a.physics&&(a.physics.rigidBody==="dynamic"||l)&&(p.data.position!==void 0||p.data.rotation!==void 0||p.data.hiddenMatrix!==void 0)||(s.states||(s.states={}),s.states[p.id]=tf.patch(a,p.data));lNe(e,s,null,n,a.events.find(p=>p.data.type==="Follow"||p.data.type==="LookAt")!==void 0)})}function lNe(t,e,n,i,r=!1){if(e instanceof ua&&e.removeInteractionGeometry(),e.changeSelectedState(n,{scene:t,shared:i},r),e instanceof ua&&e.updateGeometryGroupsIfNeeded(),e.cloner)for(let s of e.cloner.children)s.playModeVisible=void 0;e.updateVisible()}function h$(t){let e;switch(t.easing){case 0:e="cubicBezier( 0, 0, 1, 1 )";break;case 1:e="cubicBezier( .25, .1, .25, 1 )";break;case 2:e="cubicBezier( .42, 0, 1, 1 )";break;case 3:e="cubicBezier( 0, 0, .58, 1 )";break;case 4:e="cubicBezier( .42, 0, .58, 1 )";break;case 5:let{control1:n,control2:i}=t;e=`cubicBezier(
				${n[0]}, ${n[1]}, ${i[0]}, ${i[1]}
			)`;break;case 6:let{mass:r,stiffness:s,damping:o,velocity:a}=t;e=`spring( ${r}, ${s}, ${o}, ${a} )`;break;default:e="linear"}return{duration:t.duration,easing:e}}function d$(t){let e={delay:0,loop:t.repeat===-1?!0:t.repeat+1};if(t.repeat===0)e.direction="normal",e.rewind=!1;else switch(t.direction){case"pingpong":e.direction="alternate",e.rewind=!1;break;case"pingpong-rewind":e.direction="alternate",e.rewind=!0;break;default:e.direction="normal",e.rewind=!1;break}switch(e.delay=0,e.endDelay=0,e.startOnceDelay=0,e.pingPongDelayCorrection=0,e.pingPongEndDelayCorrection=0,t.delayDirection){case"start-once":e.startOnceDelay=t.delay;break;case"start":e.delay=t.delay;break;case"end":e.endDelay=t.delay;break;case"start-end":case void 0:e.delay=t.delay,e.endDelay=t.delay;break}return e.direction==="alternate"&&(e.delay/=2,e.endDelay/=2,t.delayDirection==="start"?(e.pingPongDelayCorrection=e.delay,typeof e.loop=="number"&&e.loop%2===0&&(e.pingPongEndDelayCorrection=e.delay)):t.delayDirection==="end"?typeof e.loop=="number"&&e.loop%2!==0&&(e.pingPongEndDelayCorrection=e.endDelay):t.delayDirection==="start-end"&&(e.pingPongDelayCorrection=e.delay,e.pingPongEndDelayCorrection=e.endDelay)),e}var cNe={type:"beginState"},uNe={type:"completeState",isfromEntity:!1},G6=class{constructor(t,e,n,i,r,s){if(this.object=t,this.data=i,this.sharedAssets=r,this.allowSlerp=s,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.dispatchEvent({type:"requestRender"})),this.targets.t===0||this.targets.t===1?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let o=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=o,this.object.dispatchEvent({type:"beginState",state:o}),this.object.traverseEntity(a=>{a!==this.object&&a instanceof Us&&a.dispatchEvent(cNe)})},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let o=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=o,this.object.dispatchEvent({type:"completeState",state:o}),this.object.traverseEntity(a=>{a!==this.object&&a instanceof Us&&a.dispatchEvent(uNe)})},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=k6(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},e===void 0){let o=Ib(this.object,this.object.currentState===n?this.object.prevState:this.object.currentState);if(!o)throw new Error("Missing property");this.from=o}else{let o=Ib(this.object,e);if(!o)throw new Error("Missing property");this.from=o}if(n===void 0)throw new Error("Missing property");{let o=Ib(this.object,n);if(!o)throw new Error("Missing property");this.to=o}this.useCurrentState=e===void 0||n===void 0,this.params={targets:this.targets,t:1,autoplay:!1,...d$(i),...h$(i),change:this.onChange},this.callback=k6(this.object,e===void 0?{}:this.from.data,n===void 0?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},Ny=class extends ys{constructor(t,e,n){if(super(),this.data=t,this.scene=e,this.sharedAssets=n,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.useToggle=!1,this.onTimelineChangeComplete=()=>{var r;this.data.tweens[0].data.direction!=="normal"&&(this.toggleIsForward=!this.toggleIsForward),this.timelineNeedsRebuild!==!1&&((r=this.timeline)==null||r.pause(),this.buildTimeline({isForward:this.toggleIsForward,isRebuild:!0}),this.timeline.play())},!t.object)throw new Error("Missing property");let i=e.find(t.object);if(!i)throw new Error("Missing property");if(!i.states)throw new Error("Missing property");if(this.object=i,t.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay=t.tweens[0].data.delayDirection==="start-once"?t.tweens[0].data.delay:0,this.init()}get playing(){return this.tweens.some(t=>t.changeBegan)??!1}init(){this.initialCurrentState=Ib(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return this.useToggle?this.initialCurrentState:this.object.currentState}buildTimeline({isForward:t=!0,isRebuild:e=!1}={}){var n,i,r,s;try{let o=d$(this.data.tweens[0].data),a=o.loop;e&&typeof o.loop=="number"&&o.loop--,(n=this.timeline)==null||n.pause(),this.timeline=l$.timeline({autoplay:!1,...o,...a===!0||a>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}});let l=this.tweens.findIndex(c=>c==null?void 0:c.changeBegan);if(this.timelineNeedsRebuild=l!==-1&&(a===!0||a>1),o.pingPongDelayCorrection&&e===!1&&(this.timelineNeedsRebuild=!0),t){let c=l===-1?0:l;for(let h=c;h<this.data.tweens.length-1;h++){let u=this.data.tweens[h],d=this.data.tweens[h+1],f;h===c&&(this.object.wasMovedByUser===!0||((i=this.object.previousAction)==null?void 0:i.playing)===!0)?(f=void 0,this.object instanceof Us&&(this.object.wasMovedByUser=!1)):f=u.data.state===void 0?this.currentState:u.data.state;let p=new G6(this.object,f,d.data.state===void 0?this.currentState:d.data.state,d.data,this.sharedAssets,this.data.allowSlerp??!1);l!==-1&&h===c&&Object.assign(p.params,{startOnceDelay:0}),this.tweens[h]=p,this.timeline.add(p.params,this.timeline.duration+(h===c?o.delay:0)+(h===c&&!e?o.pingPongDelayCorrection:0))}this.timeline.duration+=o.endDelay}else{let c=l===-1?this.data.tweens.length-1:l+1;for(let h=c;h>0;h--){let u=this.data.tweens[h],d=this.data.tweens[h-1],f;h===c&&(this.object.wasMovedByUser===!0||((r=this.object.previousAction)==null?void 0:r.playing)===!0)?(f=void 0,this.object instanceof Us&&(this.object.wasMovedByUser=!1)):f=u.data.state===void 0?this.currentState:u.data.state;let p=new G6(this.object,f,d.data.state===void 0?this.currentState:d.data.state,u.data,this.sharedAssets,this.data.allowSlerp??!1);l!==-1&&h===c&&Object.assign(p.params,{startOnceDelay:0}),this.tweens[h-1]=p,this.timeline.add(p.params,this.timeline.duration+(h===c?o.endDelay:0))}this.timeline.duration+=o.delay+(e?0:o.pingPongDelayCorrection)}}catch(o){o instanceof Error&&console.error(o.message)}((s=this.object.previousAction)==null?void 0:s.playing)===!0&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(this.playing)return!1;clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{try{this.buildTimeline(),this.timeline.play()}catch(t){t instanceof Error&&console.error(t.message)}},this.startOnceDelay)}pause(){var t;(t=this.timeline)==null||t.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let t=this.data.tweens[0].data.state===void 0?this.initialCurrentState:this.data.tweens[0].data.state;this.object.changeSelectedState(t,{scene:this.scene,shared:this.sharedAssets}),this.object.currentState=t}seek(t){var e;this.timeline===void 0&&this.buildTimeline(),(e=this.timeline)==null||e.seek(t*this.timeline.duration)}toggle(t){var e;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=t??!this.toggleIsForward,this.playing?((e=this.timeline)==null||e.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()):this.timeoutId=window.setTimeout(()=>{var n;(n=this.timeline)==null||n.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function Ib(t,e){var r;let n,i;if(typeof e=="string"?(n=e,i=(r=t.states)==null?void 0:r[n]):e===null&&(n=null,i=t.data),!(n===void 0||i===void 0))return{id:n,data:i}}var hNe={type:"beginState"},dNe={type:"completeState",isfromEntity:!1},H6={type:"requestRender"},f$=class extends ys{constructor(t,e){super(),this.data=t,this.scene=e,this.toggleIsForward=!1,this.useToggle=!1,this.posStart=new N,this.posEnd=new N,this.qStart=new on,this.qEnd=new on,this.zoomStart=1,this.zoomEnd=1,this.toCamera=e.find(t.targetCamera)}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(t=!1){if(!this.data.animate)return;let e={t:0};this.posStart.copy(this.scene.activeCamera.position),this.qStart.copy(this.scene.activeCamera.quaternion),this.zoomStart=this.scene.activeCamera.zoom,this.animation=l$({targets:e,t:1,...h$(this.data),update:()=>{e.t===0&&(this.useToggle&&!this.toggleIsForward?(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera)):(this.posEnd.copy(this.toCamera.position),this.qEnd.copy(this.toCamera.quaternion),this.zoomEnd=this.toCamera.zoom,this.fromCamera=this.scene.activeCamera,this.switchCamera(this.toCamera)),this.scene.activeCamera.dispatchEvent(hNe));let n=this.scene.activeCamera;n.position.lerpVectors(this.posStart,this.posEnd,e.t),n.quaternion.slerpQuaternions(this.qStart,this.qEnd,e.t),n.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*e.t,n.wasMovedBySwitchCameraAction=!0,n.updateMatrix(),n.updateMatrixWorld(),n.dispatchEvent(H6),e.t===1&&n.dispatchEvent(dNe)}})}switchCamera(t){this.scene.activeCamera.dispatchEvent({type:"cameraChange",camera:t}),this.scene.switchActiveCamera(t)}play(){this.playing||this.scene.activeCamera!==this.toCamera&&(clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var t;delete this.timeoutId;try{this.data.animate?(this.buildAnimation(),(t=this.animation)==null||t.play()):this.switchCamera(this.toCamera)}catch(e){e instanceof Error&&console.error(e.message)}},this.data.delay*1e3))}pause(){var t;(t=this.animation)==null||t.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(t){var e,n;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=t??!this.toggleIsForward,this.playing?((e=this.animation)==null||e.pause(),this.buildAnimation(!0),(n=this.animation)==null||n.play()):this.timeoutId=window.setTimeout(()=>{var i,r;delete this.timeoutId,this.data.animate?((i=this.animation)==null||i.pause(),this.buildAnimation(),(r=this.animation)==null||r.play()):(this.toggleIsForward?this.switchCamera(this.toCamera):this.switchCamera(this.fromCamera),this.scene.activeCamera.dispatchEvent(H6))},this.data.delay*1e3)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function Za(t,e,n,i,r,s){let o={Audio:[],Video:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[]};return e.forEach(({id:a,data:l})=>{try{l.type==="Audio"?Ou[t.type].includes("Audio")&&o.Audio.push(new Ly(a,l,s,i)):l.type==="Video"?Ou[t.type].includes("Video")&&o.Video.push(new TF(a,l,s)):l.type==="Link"?Ou[t.type].includes("Link")&&o.Link.push(new nFe(l,r)):l.type==="Create"?Ou[t.type].includes("Create")&&o.Create.push(new Oy(l,n,r.controlsManager)):l.type==="Destroy"?Ou[t.type].includes("Destroy")&&o.Destroy.push(new WZ(l,n,r)):l.type==="Reset"?Ou[t.type].includes("Reset")&&o.Reset.push(new sFe(n.data,n,i,r)):l.type==="Transition"?Ou[t.type].includes("Transition")&&o.Transition.push(new Ny(l,n,i)):l.type==="SwitchCamera"&&Ou[t.type].includes("SwitchCamera")&&o.SwitchCamera.push(new f$(l,n))}catch{}}),o}function ha(t){Object.values(t).forEach(e=>{e.forEach(n=>{(n instanceof Ly||n instanceof TF||n instanceof Ny||n instanceof Oy||n instanceof WZ||n instanceof f$)&&n.dispose()})})}var UF=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],p$=t=>{var e;return(e=UF.find(([n,i])=>i===t))==null?void 0:e[0]},I1=t=>{var e;return(e=UF.find(([n])=>n===t))==null?void 0:e[1]},fNe=(t,e)=>{let n=p$(t);if(n){let i=new CustomEvent(n,{bubbles:!0});return Object.defineProperty(i,"target",{writable:!1,value:e}),i}},pNe=class extends du{constructor(t){super(t),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=n=>{var s;if(!n.eventName||!n.target||n.eventName==="Scroll")return;let i=(s=this.splineEvents[p$(n.eventName)])==null?void 0:s[n.target.uuid];if(!i)return;n.eventName==="Scroll"&&n.deltaY!==void 0&&Object.assign(i,{deltaY:n.deltaY});let{domElement:r}=this.eventContext;r.dispatchEvent(i)};let{scene:e}=this.eventContext;e.traverseEntity(n=>{var i,r;if((i=n.data)!=null&&i.events.length){for(let[s,o]of UF)if(n.data.events.some(a=>a.data.type===o&&!a.data.disabled)){this.objectsPerEvents.has(s)?(r=this.objectsPerEvents.get(s))==null||r.push(n):this.objectsPerEvents.set(s,[n]);let a={id:n.uuid,name:n.name},l=fNe(o,a),c=this.splineEvents[s];c?c[n.uuid]=l:this.splineEvents[s]={[n.uuid]:l}}}})}connect(){this.objectsPerEvents.forEach(t=>{t.forEach(e=>{e.addEventListener("beginEvent",this.onBeginEvent)})})}disconnect(){this.objectsPerEvents.forEach(t=>{t.forEach(e=>{e.removeEventListener("beginEvent",this.onBeginEvent)})})}},mNe=class{constructor(t,e,n,i,r,s){if(this.id=t,this.data=e,this.object=n,this.entered=!1,this.useToggle=e.toggle,(e.type==="KeyDown"||e.type==="KeyUp"||e.type==="KeyPress")&&!e.key)throw new Error("Missing property");this.actions=Za(e,e.actions,i,r,s,n)}disconnect(){ha(this.actions)}dispatchHeld(t){this.actions.Create.forEach(e=>{t&&e.dispatchThrottled.cancel(),e.dispatchThrottled()})}dispatch(t=!1){let e=new Set;this.actions.Transition.forEach(n=>{n.object.currentTransitionEvent!==this?(n.object.currentTransitionEvent=this,n.init()):this.useToggle===!1&&e.add(n)}),this.useToggle?(this.actions.Transition.forEach(n=>{n.toggle()}),this.actions.SwitchCamera.forEach(n=>{n.toggle()})):this.data.type==="MousePress"||this.data.type==="KeyPress"?this.entered||(this.entered=!0,this.actions.Transition.forEach(n=>n.playFromCurrent()),this.actions.SwitchCamera.forEach(n=>n.playFromCurrent()),this.actions.Create.forEach(n=>n.dispatchStart())):(this.actions.Transition.some(n=>n.playing)||this.actions.Transition.forEach(n=>{e.has(n)===!1&&n.play()}),this.actions.SwitchCamera.some(n=>n.playing)||this.actions.SwitchCamera.forEach(n=>{n.play()})),this.actions.Link.forEach(n=>{n.dispatch()}),t===!1&&this.actions.Create.forEach(n=>{n.dispatch()}),this.actions.Destroy.forEach(n=>{n.dispatch()}),this.actions.Reset.forEach(n=>{n.dispatch()}),this.actions.Audio.forEach(n=>{n.dispatchBasic()}),this.actions.Video.forEach(n=>{n.dispatchBasic()})}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent()),this.actions.Create.forEach(t=>t.dispatchStop()))}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent())),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()})}},gNe=class extends du{constructor(t,e){super(t),this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.onWindowMouseDown=r=>{r.target===this.eventContext.domElement&&this.canvasMouseEvents.forEach(s=>{(s.data.type==="MouseDown"||s.data.type==="MousePress")&&s.dispatch()})},this.onWindowMouseUp=r=>{r.target===this.eventContext.domElement&&this.canvasMouseEvents.forEach(s=>{s.data.type==="MouseUp"?s.dispatch():s.data.type==="MousePress"&&s.dispatchRelease()})},this.onMouseDown=r=>{Nt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseEvent("MouseDown"))},this.onMouseUp=r=>{Nt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=r=>{Nt.length>1||(this.eventContext.updateRaycaster(r),this.handleMousePressEvent())},this.onMousePressRelease=r=>{Nt.length>1||(this.eventContext.updateRaycaster(r),this.handleMousePressEvent(!0))},this.onKeyDown=r=>{this.heldKeys[r.key]||(this.handleKeyEvent(r,"KeyDown"),this.handleKeyEventHeld(r,"KeyDown",!0)),this.heldKeys[r.key]=!0},this.onKeyUp=r=>{this.handleKeyEvent(r,"KeyUp"),this.handleKeyEventHeld(r,"KeyUp",!0)},this.onKeyPressDown=r=>{this.heldKeysPress[r.key]?this.handleKeyEventHeld(r,"KeyPress"):(this.handleKeyEvent(r,"KeyPress"),this.handleKeyEventHeld(r,"KeyPress",!0)),this.heldKeysPress[r.key]=!0},this.onKeyPressUp=r=>{this.handleKeyEvent(r,"KeyPress",!0)},this.releaseHeldKey=r=>{delete this.heldKeys[r.key]},this.releaseHeldKeyPress=r=>{delete this.heldKeysPress[r.key]},this._onUserEvent=({eventName:r,target:s,reverse:o})=>{var l,c,h,u;if(!r||!s)return;let a=I1(r);a&&(a==="MouseDown"||a==="MouseUp"||a==="MousePress"?(s.dispatchEvent({type:"beginEvent",eventName:a}),(c=(l=this.eventsPerObjects[a])==null?void 0:l[s.uuid])==null||c.forEach(d=>{d.dispatchUserEvent(o)})):(a==="KeyDown"||a==="KeyUp"||a==="KeyPress")&&(s.dispatchEvent({type:"beginEvent",eventName:a}),(u=(h=this.eventsPerObjects[a])==null?void 0:h[s.uuid])==null||u.forEach(d=>{d.dispatchUserEvent()})))};let{scene:n,sharedAssets:i}=this.eventContext;n.traverseEntity(r=>{var o,a;if(!((o=r.data)!=null&&o.events.length))return;let s=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let l of s){let c=this.eventsPerObjects[l];r.data.events.filter(({data:h})=>h.type===l&&h.disabled!==!0).forEach(({id:h,data:u})=>{try{let d=new mNe(h,u,r,n,i,e);d.actions.Video.length&&(this.hasVideoAction=!0),(u.type==="MouseDown"||u.type==="MouseUp"||u.type==="MousePress")&&u.mode!=="Object"?u.mode==="Canvas"&&this.canvasMouseEvents.push(d):c[r.uuid]?c[r.uuid].push(d):c[r.uuid]=[d]}catch{}}),(a=c[r.uuid])!=null&&a.length&&this.objectsPerTypes[l].push(r)}})}connect(){var e,n,i,r,s,o;let{domElement:t}=this.eventContext;this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),typeof window<"u"&&(window.addEventListener("pointerdown",this.onWindowMouseDown,{capture:!0}),window.addEventListener("pointerup",this.onWindowMouseUp,{capture:!0})),(e=this.objectsPerTypes.MouseDown)!=null&&e.length&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseDown)),(n=this.objectsPerTypes.MouseUp)!=null&&n.length&&(this.domEventsNeeded.add("pointerup"),t.addEventListener("pointerup",this.onMouseUp)),(i=this.objectsPerTypes.MousePress)!=null&&i.length&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),t.addEventListener("pointerup",this.onMousePressRelease)),(r=this.objectsPerTypes.KeyDown)!=null&&r.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),(s=this.objectsPerTypes.KeyUp)!=null&&s.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),(o=this.objectsPerTypes.KeyPress)!=null&&o.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach(([a,l])=>{l.forEach(c=>{c.addEventListener("userEvent",this._onUserEvent)})})}disconnect(){let{domElement:t}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},typeof window<"u"&&(window.removeEventListener("pointerdown",this.onWindowMouseDown,{capture:!0}),window.removeEventListener("pointerup",this.onWindowMouseUp,{capture:!0})),t.removeEventListener("pointerdown",this.onMouseDown),t.removeEventListener("pointerdown",this.onMousePressDown),t.removeEventListener("pointerup",this.onMouseUp),t.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach(e=>{Object.values(e).forEach(n=>{n.forEach(i=>{i.disconnect()})})}),this.canvasMouseEvents.forEach(e=>{e.disconnect()}),Object.entries(this.objectsPerTypes).forEach(([e,n])=>{n.forEach(i=>{i.removeEventListener("userEvent",this._onUserEvent)})})}handleMouseEvent(t){let{stopRaycast:e,raycaster:n,scene:i}=this.eventContext,r=this.objectsPerTypes[t];if(r.length)if(e){let s=BI(n,i,r);OI(s).forEach(o=>{this.eventsPerObjects[t][o.uuid]&&this.handleObjectMouseEventDispatch(o,t)})}else r.forEach(s=>{uM(n,s)&&this.handleObjectMouseEventDispatch(s,t)})}handleMousePressEvent(t=!1){let e="MousePress",n=this.objectsPerTypes[e],i=[];if(n.length){if(!t){let{stopRaycast:r,raycaster:s,scene:o}=this.eventContext;if(r){let a=BI(s,o,n);i=OI(a)}else n.forEach(a=>{uM(s,a)&&i.push(a)})}this._prevObjects.length&&this._prevObjects.forEach(r=>{i.includes(r)||this.handleObjectMouseEventDispatchRelease(r,e)}),i.length&&i.forEach(r=>{this.handleObjectMouseEventDispatch(r,e)}),this._prevObjects=i}}handleObjectMouseEventDispatch(t,e){var n,i;t.dispatchEvent({type:"beginEvent",eventName:e}),(i=(n=this.eventsPerObjects[e])==null?void 0:n[t.uuid])==null||i.forEach(r=>{r.dispatch()})}handleObjectMouseEventDispatchRelease(t,e){var n,i;t.dispatchEvent({type:"beginEvent",eventName:e}),(i=(n=this.eventsPerObjects[e])==null?void 0:n[t.uuid])==null||i.forEach(r=>{r.dispatchRelease()})}handleKeyEvent(t,e,n=!1){this.objectsPerTypes[e].forEach(i=>{let r=this.eventsPerObjects[e][i.uuid];r.some(({data:s})=>"key"in s&&s.key===t.key)&&i.dispatchEvent({type:"beginEvent",eventName:e}),r.forEach(s=>{"key"in s.data&&s.data.key===t.key&&(n?s.dispatchRelease():s.dispatch(!0))})})}handleKeyEventHeld(t,e,n=!1){this.objectsPerTypes[e].forEach(i=>{this.eventsPerObjects[e][i.uuid].forEach(r=>{"key"in r.data&&r.data.key===t.key&&r.dispatchHeld(n)})})}},vNe=new N,yNe=new N,m$=class{constructor(t,e,n,i,r){this.actionsIn=Za(t,t.inActions,n,i,r,e),this.actionsOut=Za(t,t.outActions,n,i,r,e)}disconnect(){ha(this.actionsIn),ha(this.actionsOut)}},xNe=class extends m${constructor(t,e,n,i,r,s){super(e,n,i,r,s),this.id=t,this.data=e,this.object=n,this.stage="out",this.objects=[],this.onUpdateMatrix=()=>{let c=vNe.setFromMatrixPosition(this.objects[0].matrixWorld),h=yNe.setFromMatrixPosition(this.objects[1].matrixWorld),u=c.distanceTo(h)<=this.distance?"in":"out";if(this.stage!==u){let d=u==="in"?this.actionsIn:this.actionsOut;d.Audio.forEach(f=>f.dispatchConditional()),d.Video.forEach(f=>f.dispatchConditional()),d.Create.forEach(f=>f.dispatch()),d.Destroy.forEach(f=>f.dispatch()),d.Transition.forEach(f=>{f.object.currentTransitionEvent!==this&&(f.object.currentTransitionEvent=this),f.init()}),d.Transition.forEach(f=>f.play()),d.SwitchCamera.forEach(f=>f.play()),this.stage=u}};let{distance:o,fromObject:a,toObject:l}=e.condition;this.distance=o;for(let c of[a,l]){if(!c)throw new Error("Missing property");let h=i.find(c);if(!h)throw new Error("Missing property");this.objects.push(h)}}connect(){this.objects.forEach(t=>{t.addEventListener("updateMatrix",this.onUpdateMatrix)}),this.onUpdateMatrix()}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach(t=>{t.removeEventListener("updateMatrix",this.onUpdateMatrix)})}},_Ne=class extends m${constructor(t,e,n,i,r,s){var l;super(e,n,i,r,s),this.id=t,this.data=e,this.object=n,this.onBegin=({target:c,state:h})=>{this.toState!==h&&(this.actionsOut.Audio.forEach(u=>u.dispatchConditional()),this.actionsOut.Video.forEach(u=>u.dispatchConditional()),this.actionsOut.Create.forEach(u=>u.dispatch()),this.actionsOut.Destroy.forEach(u=>u.dispatch()),this.actionsIn.Transition.forEach(u=>u.pause()),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach(u=>u.play()),this.actionsIn.SwitchCamera.forEach(u=>u.pause()),this.actionsOut.SwitchCamera.forEach(u=>u.play()))},this.onComplete=({target:c,state:h})=>{this.toState===h&&(this.actionsIn.Audio.forEach(u=>u.dispatchConditional()),this.actionsIn.Video.forEach(u=>u.dispatchConditional()),this.actionsIn.Create.forEach(u=>u.dispatch()),this.actionsIn.Destroy.forEach(u=>u.dispatch()),this.actionsOut.Transition.forEach(u=>u.pause()),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach(u=>u.play()),this.actionsOut.SwitchCamera.forEach(u=>u.pause()),this.actionsIn.SwitchCamera.forEach(u=>u.play()))};let{condition:o}=e;if(!o.object)throw new Error("Missing property");let a=i.find(o.object);if(!a)throw new Error("Missing property");if(this.toObject=a,o.state&&!((l=this.toObject.states)!=null&&l[o.state]))throw new Error("Missing property");this.toState=o.state}connect(){(this.actionsOut.Audio.length||this.actionsOut.Video.length||this.actionsOut.Create.length||this.actionsOut.Destroy.length||this.actionsOut.Transition.length||this.actionsOut.SwitchCamera.length)&&this.toObject.addEventListener("beginState",this.onBegin),(this.actionsIn.Audio.length||this.actionsIn.Video.length||this.actionsOut.Create.length||this.actionsIn.Destroy.length||this.actionsIn.Transition.length||this.actionsIn.SwitchCamera.length)&&this.toObject.addEventListener("completeState",this.onComplete)}disconnect(){super.disconnect(),(this.actionsOut.Audio.length||this.actionsOut.Video.length||this.actionsOut.Create.length||this.actionsOut.Destroy.length||this.actionsOut.Transition.length||this.actionsOut.SwitchCamera.length)&&this.toObject.removeEventListener("beginState",this.onBegin),(this.actionsIn.Audio.length||this.actionsIn.Video.length||this.actionsOut.Create.length||this.actionsIn.Destroy.length||this.actionsIn.Transition.length||this.actionsIn.SwitchCamera.length)&&this.toObject.removeEventListener("completeState",this.onComplete)}},wNe=class extends du{constructor(t,e){super(t),this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1;let{scene:n,sharedAssets:i}=this.eventContext;n.traverseEntity(r=>{var s;if((s=r.data)!=null&&s.events.length){for(let{id:o,data:a}of r.data.events)if(!a.disabled&&a.type==="Conditional")try{let l;a.condition.type==="Comparison"||(a.condition.type==="Distance"?l=new xNe(o,a,r,n,i,e):a.condition.type==="State"&&(l=new _Ne(o,a,r,n,i,e))),l&&(this.eventsPerConditions[a.condition.type].push(l),(l.actionsIn.Video.length||l.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch{}}})}connect(){super.connect(),Object.values(this.eventsPerConditions).forEach(t=>t.forEach(e=>e.connect()))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach(t=>t.forEach(e=>e.disconnect()))}},U0=new N,ku=new N,ss=new N,V6=new $s,SNe=.01,An=new N,dr=new N,j6=new N,VS=new on,Q2=new Tr,K2=new Pr,im=new N,Sl=new N,rm=.2,bNe=function(){let t=new nt;return(e,n,i)=>{t.copy(e.hiddenMatrix),e.parent!==null&&t.premultiply(e.parent.matrixWorld),t.invert(),e.position.copy(n),e.position.applyMatrix4(t),t.multiply(i??e.matrixWorld).decompose(An,e.quaternion,dr),e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),e instanceof zs&&Hc(e.parent)&&e.invalidateDownstreamBooleanData(!0)}}(),ANe=class{constructor(t,e,n,i,r){this.object=t,this.data=e,this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=this.data.resetSpeed===0?1:8/this.data.resetSpeed+1,this.snapDampingFactor=this.data.snapSpeed===0?1:8/this.data.snapSpeed+1,this.actionsDrag=Za(e,e.dragDropActions.drag,n,i,r,this.object),this.actionsDrop=Za(e,e.dragDropActions.drop,n,i,r,this.object);let s=[];this.data.objects.forEach(o=>{let a=n.find(o);!a||a.dataPatched.visible!==!1&&(r.controlsManager.usePhysics?a.traverseEntity((l,c)=>{var h;if(l.geometry&&s.unshift(l),(h=l.dataPatched.physics)==null?void 0:h.fusedBody)return l.geometry||s.unshift(l),!0}):s.push(a))}),this.dragItems=s.map(o=>(this.data.planeMode==="locked"&&(o.userData.lockedPlane=!0),o.userData.worldPosition0=new N().setFromMatrixPosition(o.matrixWorld),{obj:o,fromPosition:new N().setFromMatrixPosition(o.matrixWorld),pointStart:new N,pointEnd:new N,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:new N().copy(o.position),quat0:new on().copy(o.quaternion),snapped:!1,orientationMatrix:new nt}))}get activeDragItem(){return this.activeIdx!==null?this.dragItems[this.activeIdx]:null}dispose(){ha(this.actionsDrag),ha(this.actionsDrop),this.dragItems.forEach(t=>{t.obj.recursiveBBoxNeedsUpdate=!0,t.obj.userData.lockedPlane=void 0,t.obj.position.copy(t.position0),t.obj.quaternion.copy(t.quat0),t.obj.updateMatrix()})}},MNe=class extends du{constructor(t,e){super(t),this.managers=e,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=n=>{var o;if(Nt.length>1)return;this.eventContext.updateRaycaster(n);let{raycaster:i,scene:r}=this.eventContext,s=r.raycastWithClones(i);if(this.lastDropDestination=null,s.length===0){this.activeEvent=null;return}for(let a of this.events){let l=0;for(let{obj:c,pointEnd:h,pointStart:u}of a.dragItems){if(c===s[0].object||c===s[0].object.object||Pn.is(c)&&c.isAncestorOf(s[0].object.uuid)){if(a.activeIdx=l,a.activeDragItem.reset=!1,a.activeDragItem.currentDampingFactor=a.data.dampingFactor,a.activeDragItem.snapped=!1,a.data.cursor==="hand"&&this.setCursor("grabbing"),a.data.render==="on top"){let d=a.activeDragItem.obj;d.renderOrder=1,d.material.depthTest=!1,d.material.transparent0=d.material.transparent,d.material.transparent=!0}if(this.managers.controlsManager.usePhysics){a.activeDragItem.obj.rigidBody&&a.activeDragItem.obj.rigidBody.setBodyType(2,!0);let d=a.activeDragItem.obj;(d.hasNonUniformScale?d.matrixWorldRigid:d.matrixWorld).decompose(An,VS,dr),Q2.setFromQuaternion(VS),d.prevR===void 0?(d.prevR=Q2.clone(),d.prevT=An.clone()):(d.prevR.copy(Q2),d.prevT.copy(An)),this.managers.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(a.activeDragItem.obj)}this.calcPlaneIntersectPos(c,u,a.data.plane,a.data.referenceFrame),h.copy(u),(this.managers.controlsManager.usePhysics&&((o=c.dataPatched.physics)==null?void 0:o.rigidBody)==="dynamic"||a.data.drop===!1||a.data.resetOnSnapFail===!1)&&a.activeDragItem.fromPosition.setFromMatrixPosition(a.activeDragItem.obj.matrixWorld),this.activeEvent=a,this.managers.controlsManager.orbitControls&&(this.managers.controlsManager.orbitControls.enabled=!1);return}l++}}this.activeEvent=null},this.onPointerMove=n=>{var o,a,l,c;if(Nt.length>1)return;this.eventContext.updateRaycaster(n);let{raycaster:i,scene:r}=this.eventContext,s=r.raycastWithClones(i);if(Nt.length===0){let h=!1;for(let u of this.events){for(let{obj:d}of u.dragItems)if(d===((o=s[0])==null?void 0:o.object)||d===((l=(a=s[0])==null?void 0:a.object)==null?void 0:l.object)||Pn.is(d)&&d.isAncestorOf((c=s[0])==null?void 0:c.object.uuid)){switch(h=!0,u.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move");break}break}if(h)break}h||this.setCursor("default");return}if(this.activeEvent&&this.activeEvent.activeDragItem){let h=this.activeEvent.activeDragItem;h.snapped=!1;let u;if(this.activeEvent.data.drop&&(u=s.filter(d=>h.obj!==d.object&&!h.obj.isAncestorOf(d.object.uuid)&&!(d.object instanceof lM)&&(this.activeEvent.data.dropOn==="all"||this.activeEvent.data.dropDestinations.includes(d.object.uuid)))[0]),u){let d=j6.copy(u.face.normal).applyMatrix3(K2.getNormalMatrix(u.object.matrixWorld));if(this.activeEvent.data.snapTo==="center")h.fromPosition.setFromMatrixPosition(u.object.matrixWorld);else if(this.activeEvent.data.snapTo==="surface"){if(h.fromPosition.copy(u.point),this.activeEvent.data.snapSurfaceMode==="bbox"){An.copy(d).applyMatrix3(K2.setFromMatrix4(h.obj.matrixWorld).transpose());let f=h.obj;An.x>rm?dr.x=-f.recursiveBBox.min.x:An.x<-rm&&(dr.x=-f.recursiveBBox.max.x),An.y>rm?dr.y=-f.recursiveBBox.min.y:An.y<-rm&&(dr.y=-f.recursiveBBox.max.y),An.z>rm?dr.z=-f.recursiveBBox.min.z:An.z<-rm&&(dr.z=-f.recursiveBBox.max.z),dr.applyMatrix3(K2.invert())}else dr.copy(d).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);h.fromPosition.add(dr)}this.activeEvent.data.autoOrient&&(An.set(0,1,0).cross(d),An.length()<1e-4&&An.set(-1,0,0).cross(d),dr.crossVectors(j6,An),h.orientationMatrix.makeBasis(An,dr,d)),h.pointStart.copy(h.fromPosition),h.pointEnd.copy(h.pointStart),h.currentDampingFactor=this.activeEvent.snapDampingFactor,h.snapped=!0,this.lastDropDestination!==u.object&&(this.lastDropDestination=u.object,this.activeEvent.actionsDrop.Transition.forEach(f=>{f.play()}),this.activeEvent.actionsDrop.Audio.forEach(f=>{f.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Create.forEach(f=>{f.dispatchThrottled()}))}else h.orientationMatrix.makeRotationFromQuaternion(h.quat0),this.lastDropDestination=null,h.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(h.obj,h.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach(d=>{d.stop(),d.object.currentState!==null&&d.object.changeSelectedState(null,{scene:this.eventContext.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrop.Audio.forEach(d=>{d.dispatchGameControl("stop")});this.activeEvent.actionsDrag.Create.forEach(d=>{d.dispatchThrottled()}),this.activeEvent.wasDragEventTriggered===!1&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach(d=>{d.play()}),this.activeEvent.actionsDrag.Audio.forEach(d=>{d.dispatchGameControl("start")})),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout(()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach(d=>{d.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Transition.forEach(d=>{d.stop(),d.object.currentState!==null&&d.object.changeSelectedState(null,{scene:this.eventContext.scene,shared:this.eventContext.sharedAssets})}))},500),this.updateDragItem(h,this.activeEvent.data.dampingFactor===1)}},this.onPointerUp=n=>{var i;if(this.activeEvent&&this.activeEvent.activeDragItem){if(this.activeEvent.data.cursor==="hand"&&this.setCursor("grab"),this.activeEvent.data.render==="on top"){let s=this.activeEvent.activeDragItem.obj;s.renderOrder=0,s.material.depthTest=!0,s.material.transparent=s.material.transparent0}let r=((i=this.activeEvent.activeDragItem.obj.dataPatched.physics)==null?void 0:i.rigidBody)==="dynamic";this.activeEvent.activeDragItem.snapped===!1&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(this.managers.controlsManager.usePhysics===!1||!r)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.managers.controlsManager.usePhysics&&r&&(this.managers.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),this.activeEvent.wasDragEventTriggered===!0&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach(s=>{s.stop(),s.object.currentState!==null&&s.object.changeSelectedState(null,{scene:this.eventContext.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Audio.forEach(s=>{s.dispatchGameControl("stop")})),this.managers.controlsManager.orbitControls&&(this.managers.controlsManager.orbitControls.enabled=!0)}},t.scene.traverseEntity(n=>{var i;(i=n.data)==null||i.events.filter(r=>r.data.type==="DragDrop"&&!r.data.disabled).forEach(r=>{this.events.push(new ANe(n,r.data,t.scene,t.sharedAssets,e))})})}connect(){if(!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let t=this.eventContext.domElement;t.addEventListener("pointerdown",this.onPointerDown),t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let t=this.eventContext.domElement;t.removeEventListener("pointerdown",this.onPointerDown),t.removeEventListener("pointermove",this.onPointerMove),t.removeEventListener("pointerup",this.onPointerUp),this.events.forEach(e=>e.dispose())}setCursor(t){this.eventContext.domElement.style.cursor=t}onAnimationFrameDamping(){for(let t of this.events)for(let e of t.dragItems)e.paused||this.updateDragItem(e)}calcPlaneIntersectPos(t,e,n,i){let{camera:r,raycaster:s}=this.eventContext;r.getWorldDirection(ku),ku.negate();let o=VS.identity();switch(i==="local"&&t.matrixWorld.decompose(An,VS,dr),n){case"x":An.set(1,0,0).applyQuaternion(o),im.copy(ku).cross(An),Sl.copy(An).cross(im);break;case"y":An.set(0,1,0).applyQuaternion(o),im.copy(ku).cross(An),Sl.copy(An).cross(im);break;case"z":An.set(0,0,1).applyQuaternion(o),im.copy(ku).cross(An),Sl.copy(An).cross(im);break;case"xy":Sl.set(0,0,1).applyQuaternion(o);break;case"yz":Sl.set(1,0,0).applyQuaternion(o);break;case"xz":Sl.set(0,1,0).applyQuaternion(o);break;case"adaptive":ku.angleTo(dr.set(0,1,0))>Math.PI/6?(An.crossVectors(dr.set(0,1,0),ku),Sl.crossVectors(An,dr)):Sl.set(0,1,0);break;default:Sl.copy(ku);break}if(ss.setFromMatrixPosition(t.matrixWorld),V6.setFromNormalAndCoplanarPoint(Sl,t.userData.lockedPlane?t.userData.worldPosition0:ss),!!s.ray.intersectPlane(V6,e)&&(n==="x"||n==="y"||n==="z")){t.userData.lockedPlane&&(n==="x"&&(ss.y=t.userData.worldPosition0.y,ss.z=t.userData.worldPosition0.z),n==="y"&&(ss.x=t.userData.worldPosition0.x,ss.z=t.userData.worldPosition0.z),n==="z"&&(ss.x=t.userData.worldPosition0.x,ss.y=t.userData.worldPosition0.y));let a=dr.subVectors(e,ss).dot(An);e.copy(ss).addScaledVector(An,a)}}updateDragItem(t,e=!0){var n,i;ss.setFromMatrixPosition(t.obj.matrixWorld),t.reset==="current"?U0.subVectors(t.fromPosition,ss).divideScalar(t.currentDampingFactor):t.reset==="original"?(U0.subVectors(t.obj.userData.worldPosition0,ss).divideScalar(t.currentDampingFactor),t.fromPosition.copy(t.obj.userData.worldPosition0),t.pointStart.copy(t.fromPosition),t.pointEnd.copy(t.pointStart)):U0.subVectors(t.pointEnd,t.pointStart).add(t.fromPosition).sub(ss).divideScalar(t.currentDampingFactor),t.paused=t.currentDampingFactor>1?U0.length()<SNe:!0,e&&bNe(t.obj,U0.add(ss),(n=this.activeEvent)!=null&&n.data.drop&&((i=this.activeEvent)!=null&&i.data.autoOrient)?t.orientationMatrix:null),t.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.managers.eventManager.requestRender()}},sm=new N,J2=new N,Ec=new N,Cc=new N,W6=new $s,ENe=.01,CNe={type:"requestRender"},TNe=function(){let t=new N,e=new N;return(n,i,r)=>r>0?(t.subVectors(n,i),t.length()<=r?n:e.copy(i).add(t.normalize().multiplyScalar(r))):i}(),X6=function(){let t=new nt;return(e,n)=>{e.position.copy(n),e.parent!==null&&(t.copy(e.parent.matrixWorld).invert(),e.position.applyMatrix4(t)),t.copy(e.hiddenMatrix).invert(),e.position.applyMatrix4(t),e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),e instanceof zs&&Hc(e.parent)&&e.invalidateDownstreamBooleanData(!0)}}(),PNe=class{constructor(t,e,n,i,r){this.data=t,this.object=e,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new N,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...KL.defaultData,...t,...t.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},t.target===void 0||t.target==="cursor"||(t.target==="personal camera"?this.target=n.find(Xl.PERSONAL_CAMERA_ID):this.target=n.find(t.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=Za(t,t.actions,n,i,r,e)}},DNe=class extends du{constructor(t,e){super(t),this.events=[],this.pairOfEventListeners=[],this.onMouseMove=i=>{if(!(Nt.length>1)){this.eventContext.updateRaycaster(i);for(let r of this.events)r.target===void 0&&this.updateSingleEvent(r)}},this.onMouseEnter=i=>{for(let r of this.events)r.target===void 0&&(r.isReset=!1,r.currentDampingFactor=r.data.dampingFactor)},this.onMouseLeave=i=>{for(let r of this.events)r.target===void 0&&(r.data.resetOnPointerLeave&&(r.isReset=!0,r.currentDampingFactor=r.resetDampingFactor),this.updateSingleEvent(r))},this.onTargetChange=i=>()=>{this.updateSingleEvent(i)};let{scene:n}=this.eventContext;n.traverseEntity(i=>{var s,o;let r=(s=i.data)==null?void 0:s.events.find(a=>a.data.type==="Follow"&&!a.data.disabled);r&&(!n.data.environment.usePhysics||((o=i.dataPatched.physics)==null?void 0:o.rigidBody)!=="dynamic")&&this.events.push(new PNe(r.data,i,n,t.sharedAssets,e))})}connect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),co&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),e.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let n of this.events)if(n.target!==void 0){let i=n.target,r=this.onTargetChange(n);this.pairOfEventListeners.push([i,r]),i.addEventListener("requestRender",r)}}disconnect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),co&&t.removeEventListener("pointerdown",this.onMouseMove),e.removeEventListener("pointermove",this.onMouseMove),t.removeEventListener("pointerenter",this.onMouseEnter),t.removeEventListener("pointerleave",this.onMouseLeave);for(let[n,i]of this.pairOfEventListeners)n.removeEventListener("requestRender",i);for(let n of this.events)n.paused=!0,n.isReset=!1,ha(n.actions)}onAnimationFrameDamping(){for(let t of this.events)t.paused||this.updateSingleEvent(t)}updateSingleEvent(t){var s;this.events.forEach(o=>{o.actions.Create.forEach(a=>{a.dispatchThrottled()})});let{plane:e,limitDistance:n,limitDistanceEnabled:i}=t.data;if(t.object.getWorldPosition(Ec),t.isReset)Cc.copy(t.worldPosition0);else if(t.target)t.target.getWorldPosition(Cc);else{let{camera:o,raycaster:a}=this.eventContext;if(e==="custom"?(o.getWorldDirection(J2),J2.negate(),sm.copy(J2)):e==="xy"?sm.set(0,0,1):e==="xz"?sm.set(0,1,0):e==="yz"&&sm.set(1,0,0),W6.setFromNormalAndCoplanarPoint(sm,Ec),!a.ray.intersectPlane(W6,Cc))return}if(!t.isReset){if(Cc.distanceTo(t.worldPosition0)>n&&i&&t.target)if(t.snapComplete=!1,t.data.snapDelay&&(t.delayFinished=!1,typeof window<"u"&&t.timeoutId!==null&&(window.clearTimeout(t.timeoutId),t.timeoutId=null)),t.wasOutside=!0,t.data.resetAfterDistanceLimit)Cc.copy(t.worldPosition0),t.currentDampingFactor=t.resetDampingFactor;else return;else if(t.wasOutside&&(t.data.snapDelay&&typeof window<"u"&&(t.timeoutId=window.setTimeout(()=>{t.delayFinished=!0,t.paused=!1,this.updateSingleEvent(t)},t.data.snapDelay*1e3)),t.currentDampingFactor=t.data.dampingFactor,t.wasOutside=!1),t.delayFinished===!1)return}t.data.enabledTranslation[0]===!1&&(Cc.x=Ec.x),t.data.enabledTranslation[1]===!1&&(Cc.y=Ec.y),t.data.enabledTranslation[2]===!1&&(Cc.z=Ec.z);let r=TNe(Ec,Cc,t.wasOutside?0:t.data.maxDelta);if(t.currentDampingFactor>1){let o=sm.subVectors(r,Ec).divideScalar(t.currentDampingFactor);Ec.add(o),X6(t.object,Ec),t.paused=o.length()<ENe}else X6(t.object,r),t.paused=!0;(s=t.object)==null||s.dispatchEvent({type:"beginEvent",eventName:"Follow"}),t.object.dispatchEvent(CNe)}},k0=new N,jS=new N,z0=new nt,om=new on,zu=new on,G0=new N,H0=new N,Td=new N,Tc=new N,Z2=new $s,RNe=1e-6,LNe={type:"requestRender"},INe={type:"changeRotation"},Y6=function(){let t=new nt;return function(e,n){e.parent!==null?t.multiplyMatrices(e.parent.matrixWorld,e.hiddenMatrix):t.copy(e.hiddenMatrix),n.premultiply(UZ(t).invert()),e.rotation.setFromRotationMatrix(n),e.updateMatrix(),e instanceof zs&&Hc(e.parent)&&e.invalidateDownstreamBooleanData(!0)}}(),BNe=class{constructor(t,e,n){this.object=e,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new on,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...JL.defaultData,...t,...t.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},t.target===void 0||t.target==="cursor"||(t.target==="personal camera"?this.target=n.find(Xl.PERSONAL_CAMERA_ID):this.target=n.find(t.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},ONe=class extends du{constructor(t){super(t),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=n=>{if(!(Nt.length>1)){this._lastMouseEvent=n,this.eventContext.updateRaycaster(n);for(let i of this.events)i.target===void 0&&this.updateSingleEvent(i)}},this.onMouseEnter=n=>{for(let i of this.events)i.target===void 0&&(i.isReset=!1,i.currentDampingFactor=i.data.dampingFactor)},this.onMouseLeave=n=>{for(let i of this.events)i.target===void 0&&(i.data.resetOnPointerLeave&&(i.isReset=!0,i.currentDampingFactor=i.resetDampingFactor),this.updateSingleEvent(i))},this.onScroll=n=>{if(this._lastMouseEvent){let i=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(i)}},this.onTargetChange=n=>()=>{this.updateSingleEvent(n)},this.createUserEventListener=n=>({eventName:i,target:r})=>{if(!i||!r)return;let s=I1(i);s&&s==="LookAt"&&this.updateSingleEvent(n)};let{scene:e}=this.eventContext;e.traverseEntity(n=>{var r,s;let i=(r=n.data)==null?void 0:r.events.find(o=>o.data.type==="LookAt"&&!o.data.disabled);i&&(!e.data.environment.usePhysics||((s=n.dataPatched.physics)==null?void 0:s.rigidBody)!=="dynamic")&&this.events.push(new BNe(i.data,n,e))})}connect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),co&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),e.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?e.addEventListener("scroll",this.onScroll):(t.addEventListener("pointerenter",this.onMouseEnter),t.addEventListener("pointerleave",this.onMouseLeave));for(let n of this.events){if(n.target!==void 0){let s=this.onTargetChange(n),o=n.target;this.pairOfEventListeners.push([o,s]),o.addEventListener("requestRender",s)}let i=this.createUserEventListener(n),r=n.object;this.pairOfUserEventListeners.push([r,i]),r.addEventListener("userEvent",i)}}disconnect(){if(!this.events.length)return;let{domElement:t,eventElement:e}=this.eventContext;this.domEventsNeeded.clear(),co&&t.removeEventListener("pointerdown",this.onMouseMove),e.removeEventListener("pointermove",this.onMouseMove),t.removeEventListener("pointerenter",this.onMouseEnter),t.removeEventListener("pointerleave",this.onMouseLeave),e.removeEventListener("scroll",this.onScroll);for(let[n,i]of this.pairOfEventListeners)n.removeEventListener("requestRender",i);for(let[n,i]of this.pairOfUserEventListeners)n.removeEventListener("userEvent",i);for(let n of this.events)n.paused=!0,n.isReset=!1}onAnimationFrameDamping(){for(let t of this.events)t.paused||this.updateSingleEvent(t)}updateSingleEvent(t){var d;let{tilt:e,axis:n,distance:i,plane:r,limitDistance:s,enabledRotation:o,limitDistanceEnabled:a}=t.data,{camera:l,raycaster:c}=this.eventContext,{object:h,target:u}=t;if(h.getWorldPosition(G0),!t.isReset)if(t.target)t.target.getWorldPosition(H0);else{if(r==="custom"?(l.getWorldDirection(jS),jS.negate(),Z2.setFromNormalAndCoplanarPoint(jS,G0)):(r==="xy"?k0.set(0,0,1):r==="xz"?k0.set(0,1,0):r==="yz"&&k0.set(1,0,0),Z2.setFromNormalAndCoplanarPoint(k0,G0)),!c.ray.intersectPlane(Z2,H0))return;i>0&&(r==="custom"||r===void 0)&&H0.addScaledVector(jS,i)}if(t.isReset||(u?e==="target"?Td.copy(u.up).applyMatrix4(z0.extractRotation(u.matrixWorld)).normalize():o.some(f=>f===!1)?(n==="x"?(Tc.set(0,0,1),o[2]===!1&&Tc.set(0,1,0)):n==="y"?(Tc.set(1,0,0),o[0]===!1&&Tc.set(0,0,1)):(Tc.set(0,1,0),o[1]===!1&&Tc.set(1,0,0)),Td.copy(Tc).applyQuaternion(t.worldQuaternion0).normalize()):Td.set(0,1,0):r==="custom"?Td.set(0,1,0):Td.copy(k0)),t.isReset)zu.copy(t.worldQuaternion0);else if(G0.distanceTo(H0)>s&&a&&u)if(t.data.snapDelay&&(t.delayFinished=!1,typeof window<"u"&&t.timeoutId!==null&&(window.clearTimeout(t.timeoutId),t.timeoutId=null)),t.wasOutside=!0,t.data.resetAfterDistanceLimit)zu.copy(t.worldQuaternion0),t.currentDampingFactor=t.resetDampingFactor;else return;else{if(t.wasOutside&&(t.data.snapDelay&&typeof window<"u"&&(t.timeoutId=window.setTimeout(()=>{t.delayFinished=!0,t.paused=!1,this.updateSingleEvent(t)},t.data.snapDelay*1e3)),t.currentDampingFactor=t.data.dampingFactor,t.wasOutside=!1),t.delayFinished===!1)return;FNe(z0,H0,G0,Td,n,Tc),zu.setFromRotationMatrix(z0),om.setFromUnitVectors(Tc.applyQuaternion(zu),Td),o.some(f=>f===!1)&&e!=="target"&&zu.premultiply(om).normalize()}t.currentDampingFactor>1?(h.updateWorldMatrix(!0,!1),om.setFromRotationMatrix(UZ(h.matrixWorld)),om.slerp(zu,1/t.currentDampingFactor),Y6(h,z0.makeRotationFromQuaternion(om)),t.paused=8*(1-om.dot(zu))<RNe):(Y6(h,z0.makeRotationFromQuaternion(zu)),t.paused=!0),(d=t.object)==null||d.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),h.dispatchEvent(LNe),h.dispatchEvent(INe)}},ko=new N,qi=new N,Ci=new N;function FNe(t,e,n,i,r,s){let o=t.elements;Ci.subVectors(e,n),Ci.lengthSq()===0&&(Ci.z=1),Ci.normalize(),qi.crossVectors(i,Ci),qi.lengthSq()===0&&(Math.abs(i.z)===1?Ci.x+=1e-4:Ci.z+=1e-4,Ci.normalize(),qi.crossVectors(i,Ci)),qi.normalize(),ko.crossVectors(Ci,qi),r==="x"?s.z===1?[qi,ko,Ci]=[Ci,qi,ko]:(qi.negate(),[qi,Ci]=[Ci,qi]):r==="y"?s.x===1?[qi,ko,Ci]=[ko,Ci,qi]:(qi.negate(),[ko,Ci]=[Ci,ko]):s.x===1&&(qi.negate(),[qi,ko]=[ko,qi]),o[0]=qi.x,o[4]=ko.x,o[8]=Ci.x,o[1]=qi.y,o[5]=ko.y,o[9]=Ci.y,o[2]=qi.z,o[6]=ko.z,o[10]=Ci.z}var NNe=class{constructor(t,e,n,i,r,s){this.id=t,this.data=e,this.object=n,this.entered=!1,this.actions=Za(e,e.actions,i,r,s,n)}disconnect(){ha(this.actions)}dispatchEnter(){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.entered||(this.entered=!0,this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatch()),this.actions.Destroy.forEach(t=>t.dispatch()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent()))}dispatchLeave(){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.entered&&(this.entered=!1,this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent()))}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent()))}},UNe=class extends du{constructor(t,e){super(t),this.eventsPerObjects={},this.objects=[],this._prevObjects=[],this.onMouseDown=r=>{Nt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onMouseUp=r=>{Nt.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=r=>{Nt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onUserEvent=({eventName:r,target:s,reverse:o})=>{var l;if(!r||!s)return;let a=I1(r);a&&a==="MouseHover"&&(s.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(l=this.eventsPerObjects[s.uuid])==null||l.forEach(c=>c.dispatchUserEvent(o)))};let{scene:n,sharedAssets:i}=this.eventContext;n.traverseEntity(r=>{var s,o;if(!(!r.visible||!((s=r.data)!=null&&s.events.length))){for(let{id:a,data:l}of r.data.events)if(!l.disabled&&l.type==="MouseHover")try{let c=new NNe(a,l,r,n,i,e);this.eventsPerObjects[r.uuid]?this.eventsPerObjects[r.uuid].push(c):this.eventsPerObjects[r.uuid]=[c]}catch{}(o=this.eventsPerObjects[r.uuid])!=null&&o.length&&this.objects.push(r)}})}connect(){if(!this.objects.length)return;let{domElement:t}=this.eventContext;this.domEventsNeeded.clear(),co&&(this.domEventsNeeded.add("pointerdown"),t.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),t.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),t.addEventListener("pointermove",this.onMouseMove),this.objects.forEach(e=>{e.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if(!this.objects.length)return;let{domElement:t}=this.eventContext;this.domEventsNeeded.clear(),co&&(t.removeEventListener("pointerdown",this.onMouseDown),t.removeEventListener("pointerup",this.onMouseUp)),t.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach(e=>{e.forEach(n=>{n.disconnect()})}),this.objects.forEach(e=>{e.removeEventListener("userEvent",this.onUserEvent)})}handleMouseHoverEvent(t=!1){let e=[];if(!t){let{stopRaycast:n,raycaster:i,scene:r}=this.eventContext;if(n){let s=BI(i,r,this.objects);e=OI(s)}else this.objects.forEach(s=>{uM(i,s)&&e.push(s)})}this._prevObjects.length&&this._prevObjects.forEach(n=>{var i;e.includes(n)||(n.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(i=this.eventsPerObjects[n.uuid])==null||i.forEach(r=>r.dispatchLeave()))}),e.length&&e.forEach(n=>{var i;n.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(i=this.eventsPerObjects[n.uuid])==null||i.forEach(r=>r.dispatchEnter())}),this._prevObjects=e}},kNe=class{constructor(t,e,n,i,r,s){this.id=t,this.data=e,this.object=n,this.scrollCounter=0,this.actions=Za(e,e.actions,i,r,s,n)}connect(){this.scrollCounter=0}disconnect(){ha(this.actions)}dispatch(t){this.actions.Transition.forEach(i=>{i.object.currentTransitionEvent!==this&&(i.object.currentTransitionEvent=this,i.init())});let e=t>0?1:-1;this.scrollCounter+=e,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let n=this.scrollCounter/this.data.steps;this.actions.Transition.forEach(i=>i.seek(n)),this.actions.Create.forEach(i=>i.dispatchThrottled())}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?this.actions.Transition.forEach(e=>e.reverseFromCurrent()):this.actions.Transition.forEach(e=>{e.playFromCurrent()}),this.actions.Create.forEach(e=>e.dispatchThrottled())}},zNe=class{constructor(t,e,n,i,r,s,o){this.id=t,this.data=e,this.object=n,this.domElement=s,this.managers=o,this.scrollStart=0,this.scrollEnd=0,this.actions=Za(e,e.actions,i,r,o,n)}computeScrollBounds(){let t=this.domElement.getBoundingClientRect(),e=document.body,n=document.documentElement,i=window.pageYOffset||n.scrollTop||e.scrollTop,r=n.clientTop||e.clientTop||0,s=Math.round(t.top+i-r);if(this.data.startFrom==="enter"){let o=window.innerHeight,a=t.height,l=this.data.enterAnchor,c=l==="top"?o:l==="bottom"?o-a:o-a*.5;this.scrollStart=s-c}else this.scrollStart=0;this.scrollStart+=this.data.startOffset??0,this.scrollEnd=this.scrollStart+(this.data.endAfter??400),this.dispatch({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){ha(this.actions)}handleResize(){this.computeScrollBounds()}dispatch({x:t,y:e}){this.actions.Transition.forEach(r=>{r.object.currentTransitionEvent!==this&&(r.object.currentTransitionEvent=this,r.init())});let n=this.scrollEnd-this.scrollStart,i=Math.min(1,Math.max(0,(e-this.scrollStart)/n));this.actions.Transition.forEach(r=>r.seek(i)),this.actions.Create.forEach(r=>r.dispatchThrottled())}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?this.actions.Transition.forEach(e=>e.reverseFromCurrent()):this.actions.Transition.forEach(e=>{e.playFromCurrent()}),this.actions.Create.forEach(e=>e.dispatchThrottled())}},GNe=class extends du{constructor(t,e){super(t),this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach(([o,a])=>{a.forEach(l=>l.handleResize())})},this.onScroll=o=>{if(!this.isInview)return;let a={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach(([l,c])=>{l.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:a}),c.forEach(h=>h.dispatch(a))})},this.onWheel=o=>{!this.isInview||o.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach(([a,l])=>{a.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:o.deltaY}),l.forEach(c=>c.dispatch(o.deltaY))})},this.onUserEvent=({eventName:o,target:a,reverse:l})=>{var h;if(!o||!a)return;let c=I1(o);c&&c==="Scroll"&&(a.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),(h=this.wheelEventsPerObject.get(a))==null||h.forEach(u=>{u.dispatchUserEvent(l)}))};let{scene:n,sharedAssets:i,domElement:r,isExport:s}=this.eventContext;n.traverseEntity(o=>{var a,l,c;if((a=o.data)!=null&&a.events.length){for(let{id:h,data:u}of o.data.events)if(!u.disabled&&u.type==="Scroll")if(u.trigger==="load"||!s){let d=new kNe(h,u,o,n,i,e);this.wheelEventsPerObject.has(o)?(l=this.wheelEventsPerObject.get(o))==null||l.push(d):this.wheelEventsPerObject.set(o,[d])}else{let d=new zNe(h,u,o,n,i,r,e);this.scrollEventsPerObject.has(o)?(c=this.scrollEventsPerObject.get(o))==null||c.push(d):this.scrollEventsPerObject.set(o,[d])}}}),this.intersectionObserver=new IntersectionObserver(o=>{let a=o[0];a&&(this.isInview=a.isIntersecting)},{root:null})}connect(){this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(n=>n.connect()),t.addEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(n=>n.connect()),t.addEventListener("userEvent",this.onUserEvent)}),[...this.wheelEventsPerObject.values()].some(t=>t.length)&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some(t=>t.length)&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(n=>n.disconnect()),t.removeEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([t,e])=>{e.forEach(n=>n.disconnect()),t.removeEventListener("userEvent",this.onUserEvent)})}},HNe=class{constructor(t,e,n,i,r,s){this.id=t,this.data=e,this.object=n,this.actions=Za(e,e.actions,i,r,s,n)}disconnect(){ha(this.actions)}dispatch(){this.actions.Transition.forEach(t=>{t.play()}),this.actions.SwitchCamera.forEach(t=>{t.play()}),this.actions.Create.forEach(t=>{t.dispatchFromStart()}),this.actions.Destroy.forEach(t=>{t.dispatchFromStart()})}dispatchAfter(t){this.actions.Audio.forEach(e=>{(e.interaction.data.triggerAfter??"any")===t&&(e.interaction instanceof Xm?e.interaction.audioPlayer.play():e.interaction instanceof FI&&e.interaction.dispatch())}),this.actions.Video.forEach(e=>{let n=e.interaction.data.triggerAfter??"autoplay";n===t&&(e.interaction instanceof By?e.interaction.play(n==="autoplay"):e.interaction instanceof NI&&e.interaction.dispatch())})}dispatchUserEvent(t){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),t?(this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent())):(this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent())),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch()}),this.actions.Audio.forEach(e=>{e.interaction instanceof Xm?e.interaction.audioPlayer.play():e.interaction instanceof FI&&e.interaction.dispatch()}),this.actions.Video.forEach(e=>{e.interaction instanceof By?e.interaction.play():e.interaction instanceof NI&&e.interaction.dispatch()})}},VNe=class extends du{constructor(t,e){super(t),this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,s])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),s.forEach(o=>{o.dispatchAfter("mouseDown")})})},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,s])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),s.forEach(o=>{o.dispatchAfter("keyDown")})})},this.onAny=()=>{let{domElement:r,isExport:s}=this.eventContext;(s?document:r).removeEventListener("pointerdown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([o,a])=>{o.dispatchEvent({type:"beginEvent",eventName:"Start"}),a.forEach(l=>{l.dispatchAfter("any")})})},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([r,s])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),s.forEach(o=>{o.dispatchAfter("autoplay")})})},this.onUserEvent=({eventName:r,target:s,reverse:o})=>{var l,c;if(!r||!s)return;let a=I1(r);a&&a==="Start"&&(s.dispatchEvent({type:"beginEvent",eventName:"Start"}),(l=this.eventsPerObject.get(s))==null||l.forEach(h=>{h.dispatchUserEvent(o)}),(c=this.eventsAfterPerObject.get(s))==null||c.forEach(h=>{h.dispatchUserEvent(o)}))};let{scene:n,sharedAssets:i}=this.eventContext;n.traverseEntity(r=>{var s,o,a,l;if((s=r.data)!=null&&s.events.length)for(let{id:c,data:h}of r.data.events){if(h.disabled||h.type!=="Start")continue;let u=new HNe(c,h,r,n,i,e);(u.actions.Transition.length||u.actions.SwitchCamera.length||u.actions.Create.length||u.actions.Destroy.length)&&(this.eventsPerObject.has(r)?(o=this.eventsPerObject.get(r))==null||o.push(u):this.eventsPerObject.set(r,[u])),u.actions.Audio.length&&(this.eventsAfterPerObject.has(r)?(a=this.eventsAfterPerObject.get(r))==null||a.push(u):this.eventsAfterPerObject.set(r,[u])),u.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(r)?(l=this.eventsAfterPerObject.get(r))==null||l.push(u):this.eventsAfterPerObject.set(r,[u]))}})}connect(){if([...this.eventsAfterPerObject.values()].some(t=>t.length)){let{domElement:t,isExport:e}=this.eventContext,n=e?document:t;n.addEventListener("pointerdown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),n.addEventListener("pointerdown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([i,r])=>{i.addEventListener("userEvent",this.onUserEvent)}),this.onPlay()}[...this.eventsPerObject.entries()].forEach(([t,e])=>{t.dispatchEvent({type:"beginEvent",eventName:"Start"}),e.forEach(n=>n.dispatch()),t.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if([...this.eventsAfterPerObject.values()].some(t=>t.length)){let{domElement:t,isExport:e}=this.eventContext,n=e?document:t;n.removeEventListener("pointerdown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),n.removeEventListener("pointerdown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([i,r])=>{i.removeEventListener("userEvent",this.onUserEvent),r.forEach(s=>s.disconnect())})}[...this.eventsPerObject.entries()].forEach(([t,e])=>{t.removeEventListener("userEvent",this.onUserEvent),e.forEach(n=>n.disconnect())})}},jNe=class{constructor(t,e,n,i,r,s){this.id=t,this.data=e,this.object=n,this.disabled=!0,this.actions=Za(e,e.actions,i,r,s,n),this.target=e.target,this.useToggle=e.toggle}disconnect(){ha(this.actions)}dispatch(t){this.disabled||(this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.useToggle?this.actions.Transition.forEach(e=>{e.toggle()}):this.actions.Transition.forEach(e=>{e.play()}),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch(t??!1)}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}))}},$n;vRe.then(t=>$n=t);var Fi=new N,Ca=new on,Gu=new N,$2=new Tr(0,0,0,"YXZ"),WNe={type:"updateMatrix"},g$={type:"beginEvent",eventName:"Collision"};function XNe(t){if(t.scene.environment.usePhysics)return!0;let e=!1;return t.scene.objects.traverse((n,i)=>{for(let r of i.events)if(r.data.disabled!==!0&&r.data.type==="GameControl"&&r.data.collisionEnabled){e=!0;break}}),e}var q6=t=>t.states.some(e=>e.data.position!==void 0||e.data.rotation!==void 0||e.data.hiddenMatrix!==void 0||e.data.cloner!==void 0||e.data.pathSnapping!==void 0),YNe=class{constructor(t,e,n,i,r,s=!1){var g;this.scene=e,this.requestRender=i,this.sharedAssets=r,this.isExport=s,this.orbitControlsNeedsUpdate=!0,this.gameControls=[],this.gameControlStates=[],this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],eventsPerObjects:{},colliderToEntity:{},gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.processRigidBody=m=>{if(m.bodyType()!==$n.RigidBodyType.Dynamic)return;m.isSleeping()||this.nActiveRigidBodies++;let[y,_,S]=this.rigidBodyToMesh.get(m.handle);if(Fi.copy(m.translation()).multiplyScalar(this.pixelsPerMeter),Ca.copy(m.rotation()),y.matrixWorld.compose(Fi,Ca,_),y.hasNonUniformScale&&y.matrixWorld.multiply(y.shearScale),y.dispatchEvent(WNe),S){let A=y.cloner;if(A&&A.objectForSample===void 0){A.matrixWorld.copy(y.matrixWorld);for(let b of A.children)b.updateMatrixWorld(!0)}for(let b of y.children)b.updateMatrixWorld(!0)}},this.handleCollisionEvents=(m,y,_)=>{var S,A;if(_!==!1){for(let b=this.sharedGameControlGlobals.createdObjects.length-1;b>=0;b--){let T=this.sharedGameControlGlobals.createdObjects[b];if(T.userData.hasCollisionDestroy&&(((S=T.rigidBody)==null?void 0:S.collider(0).handle)===m||((A=T.rigidBody)==null?void 0:A.collider(0).handle)===y)){this.sharedGameControlGlobals.createdObjects.splice(b,1),T.removeFromParent(),requestAnimationFrame(()=>{var M;return(M=this.sharedGameControlGlobals.rapierWorld)==null?void 0:M.removeRigidBody(T.rigidBody)});break}}if(this.gameControls.some(b=>b.object===this.sharedGameControlGlobals.colliderToEntity[m])){let b=this.sharedGameControlGlobals.colliderToEntity[y],T=this.sharedGameControlGlobals.eventsPerObjects[b.uuid];if(T===void 0)return;for(let M of T)M.data.target==="character"&&this.dispatchCollisionEvent(M,b,y)}else if(this.gameControls.some(b=>b.object===this.sharedGameControlGlobals.colliderToEntity[y])){let b=this.sharedGameControlGlobals.colliderToEntity[m],T=this.sharedGameControlGlobals.eventsPerObjects[b.uuid];if(T===void 0)return;for(let M of T)M.data.target==="character"&&this.dispatchCollisionEvent(M,b,m)}else{let b=this.sharedGameControlGlobals.colliderToEntity[m],T=this.sharedGameControlGlobals.eventsPerObjects[b.uuid];if(T!==void 0)for(let P of T)P.data.target==="scene"&&this.dispatchCollisionEvent(P,b,m);let M=this.sharedGameControlGlobals.colliderToEntity[y],E=this.sharedGameControlGlobals.eventsPerObjects[M==null?void 0:M.uuid];if(E!==void 0)for(let P of E)P.data.target==="scene"&&this.dispatchCollisionEvent(P,M,y)}}},this.domElement=n.domElement;let o;t.scene.publish.playCamera===null?o=Xl.PERSONAL_CAMERA_ID:o=t.scene.publish.playCamera;let a=this.scene.find(o),l=!1,c,h=5,u=8,d=9,f="drag";if(this.usePhysics=t.scene.environment.usePhysics??eo.defaultData.usePhysics,this.pixelsPerMeter=t.scene.environment.pixelsPerMeter??eo.defaultData.pixelsPerMeter,this.gravity=t.scene.environment.gravity??eo.defaultData.gravity,(g=t.scene.objects.data(t.scene.publish.gameControlObject))==null||g.events.forEach(m=>{m.data.disabled!==!0&&m.data.type==="GameControl"&&(c=m.data.keyAssignments,h=m.data.joystickPosLoc,u=m.data.joystickRotLoc,d=m.data.jumpTouchButtonLoc,f=m.data.rotByTouch)}),this.scene.traverseEntity(m=>{m.dataPatched.events.forEach(y=>{var S,A;if(y.data.disabled||y.data.type!=="GameControl")return;let _=m;for(;((S=_=_.parent)==null?void 0:S.parent)!==null;)if((A=_.dataPatched.physics)!=null&&A.fusedBody)return;y.data.collisionEnabled&&(this.needsCollisionDetection=!0),this.gameControlStates.push([m,y.data])})}),this.gameControlStates.forEach(([m,y])=>{l=l||y.camera===a.uuid||m.uuid===a.uuid;let _=new v$(m,n.domElement,{...y,keyAssignments:c},t.scene.environment,this,m.uuid!==a.uuid&&y.camera===a.uuid,a,this.scene,r);_.addEventListener("change",i),_.addEventListener("end",i),_.addEventListener("start",i),this.gameControls.push(_),co&&y.touchControl&&(this.joystickToGameControls[h]!==void 0?this.joystickToGameControls[h].push([_,"pos"]):this.joystickToGameControls[h]=[[_,"pos"]],y.moveMode==="walk"&&(this.joystickToGameControls[d]!==void 0?this.joystickToGameControls[d].push([_,"jmp"]):this.joystickToGameControls[d]=[[_,"jmp"]]),f==="joystick"&&(this.joystickToGameControls[u]!==void 0?this.joystickToGameControls[u].push([_,"rot"]):this.joystickToGameControls[u]=[[_,"rot"]]))}),l===!1){let{enableRotate:m,enablePan:y,enableZoom:_,autoRotate:S,hoverRotatePanMode:A}=t.scene.publish.orbitControls;(m||y||_||S||A!==0)&&(this.orbitControls=new y$(a,n.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",i),this.orbitControls.addEventListener("end",i),this.orbitControls.addEventListener("start",i),this.orbitControls.fromJSON(t.scene.publish.orbitControls,t.scene.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let p=n.domElement.width/n.getPixelRatio(),v=n.domElement.height/n.getPixelRatio();this.joystickToGameControls.forEach((m,y)=>{let _=document.body.appendChild(document.createElement("div")),[S,A,b]=(t.scene.publish.joystickSizeAndXYOffset??Xg.defaultData.joystickSizeAndXYOffset)[y],T=(p-5*S)/4+S,M={},E=m.some(B=>B[1]==="jmp"),P=E?0:S;y<10?(y<5?M.top=P/2:M.bottom=P/2,M.left=P/2+y%5*T):y===10?(M.left=P/2,M.top=v/2):(M.right=P/2,M.top=v/2),M.top?M.top-=A[1]:M.bottom+=A[1],M.left?M.left+=A[0]:M.right-=A[0];for(let B in M)M[B]+="px";if(E){let B=_.appendChild(document.createElement("div"));Object.assign(B.style,M,{position:"absolute",width:S+"px",height:S+"px",backgroundColor:`rgba(255,255,255,${b==="show"?.4:0})`,zIndex:"9999",borderRadius:S+"px",border:b==="show"?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let k=S/16*16*.4;b==="show"&&(B.innerHTML=`
						<svg width="${k}" height="${S*.4}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					`),B.addEventListener("pointerdown",()=>{m.forEach(j=>{j[0].movementState.jump=1}),i()}),B.addEventListener("touchend",j=>j.preventDefault()),this.joysticks[y]=[void 0,_];return}let R={zone:_,mode:"static",position:M,size:S};b==="hide"&&(R.restOpacity=0);let F=VOe.create(R);F.on("move",(B,k)=>{m.forEach(j=>{let Z=j[0];j[1]==="pos"?k.force<.2?Z.moveForce=0:(Z.movementState.movePosZ=Math.sin(-k.angle.radian),Z.movementState.movePosX=Math.cos(-k.angle.radian),k.force<.3?Z.moveForce=(k.force-.2)/.1:Z.moveForce=1):k.force<.2?Z.rotForce=0:(Z.movementState.rotPosX=k.vector.y,Z.movementState.rotPosY=-k.vector.x,k.force<.3?Z.rotForce=(k.force-.2)/.1:Z.rotForce=1)}),i()}),F.on("end",(B,k)=>{m.forEach(j=>{let Z=j[0];j[1]==="pos"?(Z.movementState.movePosZ=0,Z.movementState.movePosX=0,Z.moveForce=1):(Z.movementState.rotPosX=0,Z.movementState.rotPosY=0,Z.rotForce=1)})}),this.joysticks[y]=[F,_]})}attachVRControllers(t){t.forEach(e=>{e.addEventListener("connected",n=>{"gamepad"in n.data&&"axes"in n.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(n.data.gamepad)})})}markIsDestroyTarget(){this.scene.traverseVisibleEntity(t=>{var n,i;let e=t.dataPatched;for(let r of e.events){if(r.data.disabled===!0)continue;let s=(i=(n=r.data.actions)==null?void 0:n.find(o=>o.data.type==="Destroy"))==null?void 0:i.data;if(s)for(let o of s.objects){let a=this.scene.find(o);a&&(a.userData.hasDestroy=!0)}}})}markIsDragObject(){this.scene.traverseVisibleEntity(t=>{let e=t.dataPatched;for(let n of e.events)if(!(n.data.disabled===!0||n.data.type!=="DragDrop"))for(let i of n.data.objects){let r=this.scene.find(i);r&&(r.userData.hasDrag=!0)}})}initBVH(){let t=[];if(this.scene.traverseObject(e=>{let n;if(e instanceof rf)return;e instanceof Fl?n=e.object:n=e;let i=n.dataPatched;if(i.collision==="visibility"?!i.visible:!i.collision)return!0;let r=e.geometry,s=n.userData.hasDestroy===!0,o=n.userData.hasDrag===!0;if(q6(i)||s||o||n.dataPatched.events.some(a=>a.data.disabled!==!0&&a.data.type==="GameControl"))return e.updateMatrixWorldSVD(),this.addBoundsTree(e),!0;r&&t.push(nm(r,e.matrixWorld))}),t.length>0){let e=Hm(t,!1);this.sharedGameControlGlobals.staticMeshBVH=new Ir(e)}}addRigidBody(t,e,n){let i=[],r=t.geometry,s=e.dataPatched;if((r==null?void 0:r.getAttribute("position"))!==void 0&&i.push(nm(r,t.shearScale)),s.physics.fusedBody){let o=this.gatherChildrenGeom(t,i);t.traverseObject(o),t.children.forEach(l=>l.updateMatrixWorld(!0));let a=t.cloner;a&&a.objectForSample===void 0&&s.physics.rigidBody==="dynamic"&&(a.traverseObject(o),a.children.forEach(l=>l.updateMatrixWorld(!0)))}if(i.length>0){let o,a=!n.fromCreate&&s.physics.rigidBody==="dynamic"||n.fromCreate&&n.dynamic;a?(o=$n.RigidBodyDesc.dynamic(),o.setLinearDamping(s.physics.damping).setAdditionalMass(1e-9).setGravityScale(s.physics.gravityScale).enabledRotations(...s.physics.enabledRotation).enabledTranslations(...s.physics.enabledTranslation)):(n.hasTransformAnim||n.hasFollow||n.hasDrag)&&!n.fromCreate?(o=$n.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(t)):o=$n.RigidBodyDesc.fixed();let l=Hm(i);(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(Fi,Ca,Gu),t.position0=Fi.clone().divideScalar(this.pixelsPerMeter),t.rotation0=Ca.clone(),Fi.divideScalar(this.pixelsPerMeter),o.setTranslation(Fi.x,Fi.y,Fi.z).setRotation(Ca),r?l==null||l.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):l==null||l.scale(Gu.x/this.pixelsPerMeter,Gu.y/this.pixelsPerMeter,Gu.z/this.pixelsPerMeter);let c=this.sharedGameControlGlobals.rapierWorld.createRigidBody(o);a&&this.rigidBodyToMesh.set(c.handle,[t,Gu.clone(),s.physics.fusedBody]);let h=!(s.geometry===void 0||s.geometry.type==="SubdivGeometry"||s.geometry.type==="NonParametricGeometry"||s.geometry.type==="BooleanGeometry"||s.geometry.type==="VectorGeometry"||s.geometry.type==="StarGeometry"||s.geometry.type==="RectangleGeometry"||s.geometry.type==="EllipseGeometry"||s.geometry.type==="TriangleGeometry"||s.geometry.type==="TorusGeometry"||s.geometry.type==="HelixGeometry");try{this.addCollider(c,s.physics,l,n.fromCreate?void 0:e,h)}catch{try{this.addCollider(c,s.physics,l,n.fromCreate?void 0:e,!1)}catch(u){console.error(u)}}t.rigidBody=c}}addBoundsTree(t){let e=[];if("geometry"in t&&t.geometry.getAttribute("position")!==void 0&&e.push(nm(t.geometry,t.shearScale)),t.traverseObject(this.gatherChildrenGeom(t,e)),t.children.forEach(n=>n.updateMatrixWorld(!0)),e.length>0){let n=Hm(e,!1);t.boundsTree=new Ir(n),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(t)}}addCollider(t,e,n,i,r=!0){var a,l;if((n==null?void 0:n.getAttribute("position").count)===0||((a=n==null?void 0:n.getIndex())==null?void 0:a.count)===0)return;let s;n&&(e.colliderType==="trimesh"?s=$n.ColliderDesc.trimesh(n.getAttribute("position").array,n.getIndex().array):s=$n.ColliderDesc.convexMesh(n.getAttribute("position").array,r?n.getIndex().array:void 0)),s.setFrictionCombineRule($n.CoefficientCombineRule.Average).setRestitutionCombineRule($n.CoefficientCombineRule.Average).setDensity(e.density).setFriction(e.friction).setRestitution(e.restitution);let o=this.sharedGameControlGlobals.rapierWorld.createCollider(s,t);i&&(this.sharedGameControlGlobals.colliderToEntity[o.handle]=i,(l=this.sharedGameControlGlobals.eventsPerObjects[i.uuid])!=null&&l.some(c=>c.target==="scene")&&o.setActiveEvents($n.ActiveEvents.COLLISION_EVENTS))}gatherChildrenGeom(t,e){return(n,i)=>{var a;if(i===0)return;let r;if(n instanceof rf)if(n.objectForSample){if(n.objectForSample.dataPatched.physics.fusedBody)return;r=n.object}else return n.object.dataPatched.physics.fusedBody===!0&&n.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(n instanceof Fl)r=n.object;else if(r=n,(a=r.dataPatched.cloner)==null?void 0:a.hideBase)return!0;let s=r.dataPatched;if(s.collision==="visibility"?!s.visible:!s.collision)return!0;i===1?t.hasNonUniformScale?n.matrixWorld.multiplyMatrices(t.shearScale,n.hiddenMatrix):n.matrixWorld.copy(n.hiddenMatrix):n.matrixWorld.multiplyMatrices(n.parent.matrixWorld,n.hiddenMatrix),n.matrixWorld.multiply(n.matrix);let o=n.geometry;(o==null?void 0:o.getAttribute("position"))!==void 0&&e.push(nm(o,n.matrixWorld))}}init(t){this.eventManager=t,this.markIsDestroyTarget(),this.markIsDragObject(),this.usePhysics&&(this.gameControlStates.length===0||this.needsCollisionDetection)&&this.initPhysics(),this.usePhysics===!1&&this.needsCollisionDetection&&this.initBVH(),this.initializationCounter++,window.setTimeout(()=>this.collisionEvents.forEach(e=>e.disabled=!1),80)}initPhysics(){this.sharedGameControlGlobals.rapierWorld=new $n.World(new $n.Vector3(0,this.gravity,0)),this.events=new $n.EventQueue(!0);let t=[];if(this.scene.traverseObject(s=>{var v,g,m,y;let o;if(s instanceof rf)if(s.objectForSample){if(s.objectForSample.dataPatched.physics.fusedBody)return;o=s.object}else return s.object.dataPatched.physics.fusedBody===!0&&s.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(s instanceof Fl)o=s.object;else if(o=s,((v=o.dataPatched.cloner)==null?void 0:v.disabled)===!1&&((g=o.dataPatched.cloner)==null?void 0:g.hideBase)&&((m=o.dataPatched.physics)==null?void 0:m.fusedBody)!==!0)return!0;let a=o.dataPatched;if(!a.physics||(a.collision==="visibility"?!a.visible:!a.collision))return!0;s.updateMatrixWorldSVD();let l=q6(a),c,h=!1,u=o.userData.hasDestroy,d=o.userData.hasDrag,f=!1;for(let _ of a.events)if(_.data.disabled!==!0){if(_.data.type==="GameControl")c=_.data;else if(_.data.type==="Collision"){h=!0;let S=new jNe(_.id,_.data,o,this.scene,this.sharedAssets,{controlsManager:this,eventManager:this.eventManager});this.collisionEvents.push(S),this.sharedGameControlGlobals.eventsPerObjects[o.uuid]&&this.sharedGameControlGlobals.eventsPerObjects[o.uuid].every(A=>A.id!==_.id)?this.sharedGameControlGlobals.eventsPerObjects[o.uuid].push(S):this.sharedGameControlGlobals.eventsPerObjects[o.uuid]=[S]}else if(_.data.type==="Follow"){f=!0;let S=_.data.target;s.traverseVisible(A=>{A.userData.isFollowingObj=S})}}a.physics.rigidBody==="dynamic"&&a.physics.fusedBody===!1&&(s.matrixWorldFusedFalse=s.matrixWorld.clone());let p=s.geometry;if(c!==void 0){let _=$n.RigidBodyDesc.kinematicPositionBased();(s.hasNonUniformScale?s.matrixWorldRigid:s.matrixWorld).decompose(Fi,Ca,Gu),s.position0=Fi.clone().divideScalar(this.pixelsPerMeter),s.rotation0=Ca.clone(),Fi.divideScalar(this.pixelsPerMeter),_.setTranslation(Fi.x,Fi.y,Fi.z).setRotation(Ca);let S=this.sharedGameControlGlobals.rapierWorld.createRigidBody(_);s.rigidBody=S;let A;c.collider.type==="sphere"?A=$n.ColliderDesc.ball(c.collider.radius/this.pixelsPerMeter):c.collider.type==="capsule"?A=$n.ColliderDesc.capsule((c.collider.height/2-c.collider.radius)/this.pixelsPerMeter,c.collider.radius/this.pixelsPerMeter):A=$n.ColliderDesc.cuboid(c.collider.width/this.pixelsPerMeter/2,c.collider.height/this.pixelsPerMeter/2,c.collider.depth/this.pixelsPerMeter/2),A.setFrictionCombineRule($n.CoefficientCombineRule.Average).setRestitutionCombineRule($n.CoefficientCombineRule.Average).setDensity(a.physics.density).setFriction(a.physics.friction).setRestitution(a.physics.restitution);let b=this.sharedGameControlGlobals.rapierWorld.createCollider(A,S);this.sharedGameControlGlobals.colliderToEntity[b.handle]=o,Fi.fromArray(c.collider.position).multiply(Gu.setFromMatrixScale(o.matrixWorld)).divideScalar(this.pixelsPerMeter),b.setTranslationWrtParent(Fi);let T=new on().setFromEuler(new Tr().setFromVector3(new N().fromArray(c.collider.rotation)));b.setRotationWrtParent(T),b.setActiveEvents($n.ActiveEvents.COLLISION_EVENTS)}else a.physics.rigidBody==="dynamic"||l||f||u||d||h?this.addRigidBody(s,o,{hasFollow:f,hasTransformAnim:l,hasDrag:d}):(p&&t.push(nm(p,s.matrixWorld)),a.physics.fusedBody&&s.traverseObject((_,S)=>{var M;if(S===0)return;let A;if(_ instanceof rf)if(_.objectForSample){if(_.objectForSample.dataPatched.physics.fusedBody)return;A=_.object}else return _.object.dataPatched.physics.fusedBody===!0&&_.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(_ instanceof Fl)A=_.object;else if(A=_,(M=A.dataPatched.cloner)==null?void 0:M.hideBase)return!0;let b=A.dataPatched;if(b.collision==="visibility"?!b.visible:!b.collision)return!0;let T=_.geometry;(T==null?void 0:T.getAttribute("position"))!==void 0&&t.push(nm(T,_.matrixWorld))}));if(((y=a.physics)==null?void 0:y.fusedBody)===!0||c)return!0}),t.length===0)return;let e=Hm(t);e.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let n=$n.RigidBodyDesc.fixed(),i=this.sharedGameControlGlobals.rapierWorld.createRigidBody(n),r=$n.ColliderDesc.trimesh(e.getAttribute("position").array,e.getIndex().array).setFrictionCombineRule($n.CoefficientCombineRule.Multiply).setRestitutionCombineRule($n.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(r,i)}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){var t;this.usePhysics?((t=this.sharedGameControlGlobals.rapierWorld)==null||t.free(),this.initPhysics()):(this.sharedGameControlGlobals.staticMeshBVH=void 0,this.initBVH())}dispose(){var t;this.scene.traverse(e=>{let n=e;n.matrixWorldFusedFalse&&(n.matrixWorldFusedFalse=void 0),n.rigidBody&&(n.rigidBody=void 0),n.position0&&(n.position0=void 0),n.rotation0&&(n.rotation0=void 0)}),(t=this.sharedGameControlGlobals.rapierWorld)==null||t.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.gameControls.forEach(e=>{e.reset(),e.dispose()}),this.gameControls=[],this.joysticks.forEach(([e,n])=>{e==null||e.destroy(),n.remove()}),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0);for(let e of Object.values(this.sharedGameControlGlobals.eventsPerObjects))e.forEach(n=>n.disconnect());this.sharedGameControlGlobals.eventsPerObjects={},this.scene.updateMatrixWorld(!0)}update(t,e,n){var r;let i=!0;if(this.orbitControls!==void 0&&this.orbitControls.needsUpdate&&(i=!this.orbitControls.update()),this.initializationCounter>=0&&this.initializationCounter<2)this.initializationCounter++,i=!1;else if(this.initializationCounter===2)for(let s of this.gameControls)i=!s.update(t,e,n)&&i;if(this.usePhysics){for(let s of this.sharedGameControlGlobals.entitiesWithTransformAnim){(s.hasNonUniformScale?s.matrixWorldRigid:s.matrixWorld).decompose(Fi,Ca,Gu),$2.setFromQuaternion(Ca);let o=s;o.prevR===void 0?(o.prevR=$2.clone(),o.prevT=Fi.clone()):(o.prevR.copy($2),o.prevT.copy(Fi)),s.rigidBody.setNextKinematicTranslation(Fi.divideScalar(this.pixelsPerMeter)),s.rigidBody.setNextKinematicRotation(Ca)}this.sharedGameControlGlobals.rapierWorld.step(this.events),(r=this.events)==null||r.drainCollisionEvents(this.handleCollisionEvents),i=!this.updatePositions()&&i}return i}dispatchCollisionEvent(t,e,n){var s;let i=((s=this.sharedGameControlGlobals.rapierWorld)==null?void 0:s.getCollider(n))._parent,r;if(e.cloner){for(let o of e.cloner.children)if(o.rigidBody===i){r=o;break}}t.dispatch(r),e.dispatchEvent(g$)}updateUseWindowEvents(t){var e;(e=this.orbitControls)==null||e.updateUseWindowEvents(t)}},eD={type:"change"},qNe={type:"lock"},QNe={type:"unlock"};new N;var Q6=new N,K6=new N,KNe=new N,os=new N,Ks=new N,Hu=new N,tD=new nt,J6=new nt,JNe=new nt;new nt;var Ta=new on,Pc=new on,bl=new Tr(0,0,0,"YXZ"),ZNe=new N(1,0,0),Pa=new N(0,1,0),$Ne=new N(0,0,1),Z6=new N(1,1,1),eUe=1,tUe=.025,nUe=16e-6,$6=12,iUe=20,jr=new ia,zo=new Vi,rUe={type:"requestRender"},eW=Math.PI/6,zI=class extends ys{constructor(t,e,n,i,r,s,o,a,l){var p;super(),this.object=t,this.domElement=e,this.controlsManager=r,this.cameraFollow=s,this.camera=o,this.scene=a,this.sharedAssets=l,this.enableDamping=!0,this.position0=new N,this.rotation0=new Tr(0,0,0,"XYZ"),this.scale0=new N,this.hiddenMatrix0=new nt,this.target0=new N,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.euler0=new Tr(0,0,0,"YXZ"),this.position0Cam=new N,this.quat0Cam=new on,this.scale0Cam=new N,this.hiddenMatrix0Cam=new nt,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new ia(new N(0,-40,0),new N(0,40,0)),matrix:new nt,position:new N,rotation:new on},this.euler=new Tr(0,0,0,"YXZ"),this.eulerDelta=new N,this.lastPosition=new N,this.lastCameraQuaternion=new on,this.lastCameraPosition=new N,this.PI_2=Math.PI/2,this.prevMouse=new Se,this.velocityTarget=new N,this.velocity=new N,this.directionXZ=new N,this.rotVelocityStick=new N,this.rotVelocityTarget=new N,this.rotVelocity=new N,this.rotDirection=new N,this.nonColliderRotOffset=new nt,this.nonColliderPosOffset=new nt,this.firstPointerId=-1,this.rot=new N,this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new nt,this.objectToTarget=new N,this.objectToTarget0=new N,this.objectToCamXZ=new N,this.objectToCamXZ0=new N,this.targetToCamera=new N,this.targetToCamera0=new N,this.cameraPolarAxis0=new N,this.targetPos=new N,this.targetQuat=new on,this.lerpFactorPos=new N().setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new on,this.objXZQuatInv=new on,this.objXZRotMat=new nt,this.isFirstPerson=!1,this.actions={},this.didHit=!1,this.groundVelocity=new N,this.pushedVelocity=new N,this.groundYRotation=0,this.objectRealQuat=new on,this.colliderWorldQuat=new on,this.groundNormal=new N,this.groundTilt=new on,this.groundTiltInv=new on,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.onPointerDown=v=>{v.target!==this.domElement||this.firstPointerId!==-1||(this.firstPointerId=v.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.rotBy!=="keys"&&!co&&(!Q5||K5>=15.5)&&this.domElement.requestPointerLock(),this.prevMouse.set(v.clientX,v.clientY))},this.onPointerUp=v=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),v.pointerType==="mouse"&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=v=>{if(v.pointerId!==this.firstPointerId)return;let g=v.clientX-this.prevMouse.x,m=v.clientY-this.prevMouse.y;this.prevMouse.set(v.clientX,v.clientY),v.pointerType==="mouse"&&this.rotBy!=="keys"&&(Q5&&K5<15.5&&!co?(this.eulerDelta.y=-g*this.mouseOrbitSensitivity,this.eulerDelta.x=-m*this.mouseOrbitSensitivity):(this.eulerDelta.y=-v.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-v.movementY*this.mouseOrbitSensitivity)),v.pointerType!=="mouse"&&this.rotByTouch==="drag"&&(this.eulerDelta.y=-g*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-m*this.mouseOrbitSensitivity*5),this.dispatchEvent(eD)},this.onPointerlockChange=v=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(qNe),zI.isLocked=!0):(this.dispatchEvent(QNe),zI.isLocked=!1)},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.onKeyDown=v=>{!(v.target instanceof HTMLInputElement)&&(v.code==="ArrowLeft"||v.code==="ArrowUp"||v.code==="ArrowRight"||v.code==="ArrowDown"||v.code==="Space")&&v.preventDefault();for(let g of this.keyAssignments)if(v.key.toUpperCase()===g[1]||v.key===g[1]){this.movementState[g[0]]=1;break}this.dispatchEvent(eD)},this.onKeyUp=v=>{for(let g of this.keyAssignments)if(v.key.toUpperCase()===g[1]||v.key===g[1]||v.code.slice(3,v.code.length).toUpperCase()===g[1]){this.movementState[g[0]]=0;break}},this.copyVRGamePadValues=(v,g)=>{for(let m=2;m<4;m++){let y=v.axes[m];g===0?m===2?this.movementState.movePosX=y:this.movementState.movePosZ=y:(v.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,m===2?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(y)>=.3&&(this.vrEulerYOffset+=y<0?1:-1),this.movementState.rotPosY=y):this.moveMode==="fly"&&(this.movementState.moveNegY=y))}},this.sharedGameControlGlobals=r.sharedGameControlGlobals,t===o&&(this.isFirstPerson=!0),this.position0.copy(this.object.position),this.rotation0.copy(this.object.rotation),this.scale0.copy(this.object.scale),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.object.position,this.object.quaternion,this.object.scale),this.object.rotation.reorder("YXZ"),this.euler0.copy(this.object.rotation);let c=this.object.rotation.y;if(this.objectRealQuat.copy(this.object.quaternion),this.object.rotation.y=0,this.objXZQuat.copy(this.object.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.object.quaternion),this.object.rotation.set(0,c,0),this.rot.setFromEuler(this.object.rotation),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||this.cameraFollow===!0)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),this.cameraFollow===!0){this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy((p=this.camera)==null?void 0:p.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let v=new N(0,0,-1).applyQuaternion(this.camera.quaternion),g=new N().subVectors(this.object.position,this.camera.position);this.objectToCamXZ.copy(g),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ);let m,y;Math.abs(v.y)<1e-6?(g.y=0,v.y=0,y=g.projectOnVector(v)):g.y/v.y>0?y=v.multiplyScalar(g.y/v.y):y=v.multiplyScalar(g.length()),this.targetToCamera0.copy(y).negate(),m=this.camera.position.clone().add(y),this.objectToTarget0.subVectors(m,this.object.position);let _=new Tr().setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-_.x,_.x=0,_.z=0,_.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(_)}if(this.object instanceof Us&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.object.quaternion,"YXZ"),this.connect(),this.rotByTouch=n.rotByTouch??"joystick",this.rotBy=n.rotBy??"keys",this.rotationMode=n.rotationMode??"normal",this.moveMode=n.moveMode??"walk",this.collisionEnabled=n.collisionEnabled,this.speedTranslate=(n.speedTranslate??250)*eUe,this.speedOrbit=(n.speedRotate??100)*tUe,this.mouseOrbitSensitivity=(n.speedRotate??100)*nUe,this.keyAssignments=n.keyAssignments.map(v=>{let g=[v[0],v[1]];return g[1]===""?g[1]="ArrowUp":g[1]===""?g[1]="ArrowLeft":g[1]===""?g[1]="ArrowDown":g[1]===""?g[1]="ArrowRight":g[1]===""?g[1]="Shift":g[1]===""?g[1]="Enter":g[1]==="Space"?g[1]=" ":g[1]===""?g[1]="Meta":g[1]==="Ctrl"?g[1]="Control":g[1]==="Esc"&&(g[1]="Escape"),g}),n.rotBy==="mouse"){let v;v=this.keyAssignments.findIndex(g=>g[0]==="rotNegX"),v!==-1&&(this.keyAssignments[v][1]=""),v=this.keyAssignments.findIndex(g=>g[0]==="rotPosX"),v!==-1&&(this.keyAssignments[v][1]=""),v=this.keyAssignments.findIndex(g=>g[0]==="rotPosY"),v!==-1&&(this.keyAssignments[v][1]=""),v=this.keyAssignments.findIndex(g=>g[0]==="rotNegY"),v!==-1&&(this.keyAssignments[v][1]="")}this.lerpFactorPosStart=1-.02**(1/((n.delayPos[0]??.3)*60)),this.lerpFactorPosEnd=1-.02**(1/((n.delayPos[1]??.3)*60)),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/((n.delayRot[0]??.3)*60)),this.lerpFactorRotEnd=1-.02**(1/((n.delayRot[1]??.3)*60)),this.lerpFactorPosCamera=1-.02**(1/((n.delayPosCamera??.3)*60)),this.lerpFactorRotCamera=1-.02**(1/((n.delayRotCamera??.3)*60)),this.gravity=(i.gravity??eo.defaultData.gravity)*$6,this.pixelsPerMeter=i.pixelsPerMeter??eo.defaultData.pixelsPerMeter,this.usePhysics=i.usePhysics??eo.defaultData.usePhysics,this.jumpPower=n.jumpPower*iUe,this.resetYPosition=this.object.position.y+Math.abs(n.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=n.alignToGround??!1,this.orientMode=n.autoOrientMove?n.orientMode:"none",this.orientWith=n.orientWith??hI.defaultDataThirdPerson.orientWith;let h=i.skinWidthRelative??eo.defaultData.skinWidthRelative,u=i.stepThreshRelative??eo.defaultData.stepThreshRelative;this.slopeThresh=(i.slopeThresh??eo.defaultData.slopeThresh)*Math.PI/180,n.collider.type==="capsule"?(this.collider.radius=n.collider.radius,this.collider.segment.start.y=n.collider.height/2-n.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=n.collider.height*h/this.pixelsPerMeter,this.stepThresh=n.collider.height*u/this.pixelsPerMeter):n.collider.type==="sphere"?(this.collider.radius=n.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*n.collider.radius*h/this.pixelsPerMeter,this.stepThresh=2*n.collider.radius*u/this.pixelsPerMeter):(this.offset=n.collider.height*h/this.pixelsPerMeter,this.stepThresh=n.collider.height*u/this.pixelsPerMeter),this.collider.type=n.collider.type;let d=new N().fromArray(n.collider.position),f=new on().setFromEuler(new Tr().fromArray([...n.collider.rotation,"XYZ"]));this.collider.position.copy(d).multiply(this.object.scale),this.collider.rotation.copy(f),this.collider.matrix.compose(d,f,Z6),n.cameraXAxis!==void 0&&(this.cameraXAxis=n.cameraXAxis,this.cameraYAxis=n.cameraYAxis,this.minPolarAngle=n.cameraRotXLimits[0],this.maxPolarAngle=n.cameraRotXLimits[1],this.minAzimuthAngleRel=n.cameraRotYLimits[0],this.maxAzimuthAngleRel=n.cameraRotYLimits[1]),n.gameActions!==void 0&&Object.entries(n.gameActions).forEach(([v,g],m)=>{g.forEach(({id:y,data:_})=>{try{this.actions[v]===void 0&&(this.actions[v]=[]),_.type==="Transition"?this.actions[v].push(new Ny(_,a,l)):_.type==="Audio"?this.actions[v].push(new Ly(y,_,t,l)):_.type==="Video"?this.actions[v].push(new TF(y,_,t)):_.type==="Create"&&this.actions[v].push(new Oy(_,a,this.controlsManager))}catch{}})}),this.dispatchStopEvent("move"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle")}reset(t=!1){if(this.object.rotation.copy(this.rotation0),this.object.position.copy(this.position0),this.object.scale.copy(this.scale0),this.object.hiddenMatrix.copy(this.hiddenMatrix0),t===!0){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.object.position,this.object.quaternion,this.object.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.rotation.reorder("YXZ");let e=this.object.rotation.y;this.object.rotation.y=0,this.objXZQuat.copy(this.object.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.object.quaternion),this.object.rotation.set(0,e,0),this.rot.setFromEuler(this.object.rotation),this.euler.setFromQuaternion(this.object.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}t===!1&&(this.object instanceof Us?this.object.matrixAutoUpdate=!0:this.object.updateMatrix()),this.cameraFollow===!0&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.dispatchEvent(eD)}connect(){this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError)}disconnect(){this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError)}dispose(){this.disconnect(),ha(this.actions)}dispatchStartEvent(t){this.actions[t]!==void 0&&(this.actionState[t]||(this.actionState[t]=!0,this.actions[t].forEach(e=>{e instanceof Ny?e.play():e instanceof Oy?e.dispatchStart():e instanceof Ly&&e.dispatchGameControl("start")})))}dispatchStopEvent(t){this.actions[t]!==void 0&&(!this.actionState[t]||(this.actionState[t]=!1,this.actions[t].forEach(e=>{e instanceof Ny?(e.stop(),e.object.currentState!==null&&e.object.changeSelectedState(null,{scene:this.scene,shared:this.sharedAssets})):e instanceof Oy?e.dispatchStop():e instanceof Ly&&e.dispatchGameControl("stop")})))}update(t,e,n){var a,l,c,h,u,d,f;if(this.gravity<0?this.object.position.y<this.resetYPosition:this.object.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let i=(this.isFirstFrame?16.6:t)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let r=i*60,s=!1;if(this.usePhysics&&this.collisionEnabled){let p=Ks.set(0,(this.velocity.y===0?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/(10*$6),1)*(this.gravity>0?1:-1):this.velocity.y)*i,0).divideScalar(this.pixelsPerMeter),v=this.sharedGameControlGlobals.rapierWorld.castShape(os.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.object.position).divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,p,(a=this.object.rigidBody)==null?void 0:a.collider(0).shape,1,!1,void 0,void 0,void 0,this.object.rigidBody);if(v){this.onObject=!0,this.groundNormal.set(v.normal2.x,v.normal2.y,v.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(s=!0),((l=v.collider.parent())==null?void 0:l.bodyType())===0&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let g=v.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let m of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(m.rigidBody===g&&m.userData.isFollowingObj!==this.object.uuid){(m.hasNonUniformScale?m.matrixWorldRigid:m.matrixWorld).decompose(os,Pc,Ks),this.groundVelocity.subVectors(os,m.prevT),this.object.getWorldPosition(Ks).add(this.collider.position).sub(m.position),this.groundYRotation=bl.setFromQuaternion(Pc).y-m.prevR.y,Hu.copy(Ks).applyAxisAngle(Pa,this.groundYRotation),this.groundVelocity.add(Hu.sub(Ks)).divideScalar(i);break}}else this.onObject=!1}this.moveMode==="walk"&&this.collisionEnabled&&(this.movementState.jump===1&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*r),this.moveMode==="fly"&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,this.directionXZ.normalize(),this.movementState.moveNegZ||this.movementState.movePosZ?this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce:this.velocityTarget.z=0,this.movementState.moveNegX||this.movementState.movePosX?this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce:this.velocityTarget.x=0,(this.moveMode==="walk"?this.velocityTarget.x+this.velocityTarget.z===0:this.velocityTarget.manhattanLength()===0)?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.moveMode==="walk"&&(this.lerpFactorPos.y=1),this.didHit===!1&&this.pushedVelocity.manhattanLength()===0||this.usePhysics===!1?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**r),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**r),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**r)):this.velocity.copy(this.velocityTarget),(this.moveMode==="walk"?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("move")));let o=KNe.copy(this.velocity);if(this.orientMode!=="none"&&this.isFirstPerson===!1){let p=Ks.copy(o);p.y=0,o.set(0,o.y,p.length()*-1)}if(bl.setFromVector3(this.rot),this.moveMode==="walk"&&(bl.x=0),o.applyEuler(bl),s&&(Pc.setFromUnitVectors(Pa,this.groundNormal),o.applyQuaternion(Pc)),n){let p=bl.set(0,this.vrEulerYOffset*eW,0);n.applyEuler(p),o.x+=n.x,o.z+=n.z,this.nonColliderPosOffset.elements[13]+=n.y*i}if(this.usePhysics===!0){let p=Ks;this.pushedVelocity.set(0,0,0);for(let v of this.sharedGameControlGlobals.entitiesWithTransformAnim){let g=Hu.setFromMatrixPosition(v.matrixWorld).sub(v.prevT).divideScalar(i).divideScalar(this.pixelsPerMeter),m=v.rigidBody.collider(0).castCollider(g,this.object.rigidBody.collider(0),os.copy(o).divideScalar(this.pixelsPerMeter),i,!1);if(g.multiplyScalar(this.pixelsPerMeter),m!==null){this.pushedVelocity.copy(g),p.copy(m.normal1).applyQuaternion(v.quaternion);break}}if(this.pushedVelocity.manhattanLength()!==0){let v=p.dot(o);v<0&&o.addScaledVector(p,-v),o.add(this.pushedVelocity)}else o.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),this.rotationMode==="normal"&&(this.movementState.rotPosX||this.movementState.rotNegX)||this.rotationMode==="steer"&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||this.moveMode==="walk")?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,this.rotationMode==="normal"&&(this.movementState.rotPosY||this.movementState.rotNegY)||this.rotationMode==="steer"&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(i),this.rotVelocityStick),this.rotVelocityTarget.manhattanLength()===0?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**r):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**r),this.euler.x+=this.rotVelocity.x*i,this.euler.y+=this.rotVelocity.y*i+this.groundYRotation,this.rotVelocityTarget.y===0&&this.directionXZ.manhattanLength()===0?this.rotationAccumWhenOrientWithCamera=0:(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*i),this.isFirstPerson===!1&&this.orientMode!=="none"&&this.directionXZ.manhattanLength()>0){let p=os,v=Ks.copy(this.directionXZ);v.x*=-1,this.camera.getWorldDirection(p);let g=Hu.copy(Pa).multiplyScalar(p.dot(Pa));if(p.sub(g),this.orientWith==="camera"?this.rot.y=p.angleTo(v)*(p.cross(v).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera:this.rot.y=this.euler.y+Math.atan2(-this.directionXZ.z,this.directionXZ.x)-Math.PI/2,this.orientMode==="radial"){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(Pa,this.euler.y-this.euler0.y);let m=Ks.copy(this.objectToCamXZ).normalize(),y=Hu.copy(o).multiplyScalar(i);y.y=0;let _=y.sub(os.copy(m).multiplyScalar(y.dot(m))).cross(m).y;this.euler.y-=Math.atan2(_,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*i+this.groundYRotation,this.rotVelocityTarget.y!==0&&(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.euler.y=this.rot.y);if(this.cameraFollow===!0&&(this.moveMode==="walk"?this.cameraXAxis==="Limit"?this.euler.x=sn.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=sn.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):this.cameraXAxis==="Limit"&&(this.euler.x=sn.clamp(this.euler.x,-this.PI_2,this.PI_2))),this.moveMode==="fly"?this.rot.x=this.euler.x:this.isFirstPerson&&(e?(bl.copy(e),bl.y=0):(bl.copy(this.euler),bl.y=0),this.nonColliderRotOffset.makeRotationFromEuler(bl)),e&&(this.moveMode==="walk"?(this.rot.y=e.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(e),this.rot.y+=this.vrEulerYOffset*eW),Ta.setFromAxisAngle(ZNe,this.rot.x),Pc.setFromAxisAngle(Pa,this.rot.y),Pc.multiply(Ta),Ta.setFromAxisAngle($Ne,this.rot.z),Pc.multiply(Ta),this.object.quaternion.copy(Pc),this.objectRealQuat.multiplyQuaternions(this.object.quaternion,this.objXZQuat),this.objectRealQuat.multiply(this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){let p=Ks.copy(o).multiplyScalar(i/this.pixelsPerMeter),v=null;this.didHit=!1;let g=new N;for(let m=0;m<5;m++){let y=p.length(),_=Hu.copy(p).normalize();if(v=this.sharedGameControlGlobals.rapierWorld.castShape(os.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.object.position).divideScalar(this.pixelsPerMeter).add(g),this.colliderWorldQuat,_,(c=this.object.rigidBody)==null?void 0:c.collider(0).shape,y,!1,8,void 0,void 0,this.object.rigidBody),v!==null){this.didHit=!0;let S=this.sharedGameControlGlobals.colliderToEntity[v.collider.handle];if(S!==this.lastHitObj&&m===0){this.lastHitObj=S;let M=this.sharedGameControlGlobals.eventsPerObjects[S==null?void 0:S.uuid];if(M){for(let E of M)if(E.data.target==="character"){let P=((h=this.sharedGameControlGlobals.rapierWorld)==null?void 0:h.getCollider(v.collider.handle))._parent,R;if(S.cloner){for(let F of S.cloner.children)if(F.rigidBody===P){R=F;break}}E.dispatch(R),S.dispatchEvent(g$)}}}let A=Q6.set(v.normal2.x,v.normal2.y,v.normal2.z).applyQuaternion(this.colliderWorldQuat),b=K6.copy(_).multiplyScalar(v.toi).dot(A),T=v.toi;if(T===0&&(this.object.position.y+=this.offset*this.pixelsPerMeter),b>this.offset&&(T=v.toi*(b-this.offset)/b,g.addScaledVector(_,T)),p.copy(_).multiplyScalar(y-T),Math.acos(-A.y)>this.slopeThresh){let M=os.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.object.position).divideScalar(this.pixelsPerMeter).add(g),E=Hu.copy(v.witness2).applyQuaternion(this.colliderWorldQuat);E.y=0;let P=M.add(E);P.y+=this.stepThresh;let R=this.sharedGameControlGlobals.rapierWorld.castShape(P,this.colliderWorldQuat,p,(u=this.object.rigidBody)==null?void 0:u.collider(0).shape,1,!1,8,void 0,void 0,this.object.rigidBody);R!==null&&R.toi===0&&(A.y=0,A.normalize())}p.addScaledVector(A,-p.dot(A))}else{m===0&&this.directionXZ.manhattanLength()!==0&&(this.lastHitObj=null),g.add(p);break}}this.object.position.addScaledVector(g,this.pixelsPerMeter),(d=this.object.rigidBody)==null||d.setTranslation(os.copy(this.object.position).divideScalar(this.pixelsPerMeter),!0),(f=this.object.rigidBody)==null||f.setRotation(Ta.copy(this.object.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let p=this.onObject?1:5,v=o.multiplyScalar(i/p);for(let g=0;g<p;g++)this.object.position.add(v),this.collisionAdjustment(i/p)}else this.object.position.addScaledVector(o,i);if(this.moveMode==="walk"&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.object.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.updateMatrix(),this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.object.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),this.cameraFollow===!0){this.updateFollowArms();let p=this.objectToTarget.add(this.object.position),v=this.targetToCamera.add(p);tD.lookAt(v,p,Pa).setPosition(v),tD.decompose(this.targetPos,this.targetQuat,os),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**r),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**r),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraYAxis==="Limit"&&this.orientMode==="cartesian"&&(this.euler.y=sn.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=sn.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.lastPosition.distanceToSquared(this.object.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(this.camera===void 0||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate)&&(this.moveMode==="fly"||this.onObject===!0||this.collisionEnabled===!1)?!1:(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.object.position),this.object.dispatchEvent(rUe),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let t=Ta.setFromAxisAngle(Pa,this.cameraYAxis==="Limit"&&this.orientMode!=="radial"?sn.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&this.objectToTarget.applyQuaternion(t);let e;this.cameraXAxis==="Limit"?e=sn.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):e=sn.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let n=os.copy(this.cameraPolarAxis0);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&n.applyQuaternion(t);let i=Pc.setFromAxisAngle(n,e);this.cameraYAxis!=="Locked"&&this.targetToCamera.applyQuaternion(t),this.cameraXAxis!=="Locked"&&this.targetToCamera.applyQuaternion(i)}groundTiltAdjustment(t){Pa.angleTo(t)*180/Math.PI<15||Pa.angleTo(t)*180/Math.PI>85?Ta.identity():Ta.setFromUnitVectors(Pa,t),this.groundTilt.slerp(Ta,.06),this.groundTiltInv.copy(this.groundTilt).invert()}collisionAdjustment(t){var r;let e=K6.set(0,0,0);this.object.updateMatrix();let n=tD.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(os,Ta,Ks).compose(os,Ta,Z6);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach(s=>{if(s===this.object||s.isDescendantOf(this.object))return;zo.makeEmpty(),s.updateMatrixWorldSVD();let o=s.matrixWorldRigid,a=J6.copy(o).invert(),l=JNe.copy(J6).multiply(n);jr.copy(this.collider.segment),jr.start.applyMatrix4(l),jr.end.applyMatrix4(l);let c=Q6.copy(this.object.position).applyMatrix4(a);zo.expandByPoint(jr.start),zo.expandByPoint(jr.end),zo.min.addScalar(-this.collider.radius),zo.max.addScalar(this.collider.radius),s.boundsTree.shapecast({intersectsBounds:h=>h.intersectsBox(zo),intersectsTriangle:h=>{let u=os,d=Ks,f=h.closestPointToSegment(jr,u,d);if(f<this.collider.radius){let p=this.collider.radius-f,v=d.sub(u).normalize(),g=Hu.copy(c);g.addScaledVector(v,p);let m=g.applyMatrix4(o).sub(this.object.position);e.add(m),jr.start.addScaledVector(v,p),jr.end.addScaledVector(v,p)}}})}),zo.makeEmpty(),jr.copy(this.collider.segment),jr.start.applyMatrix4(n),jr.end.applyMatrix4(n),zo.expandByPoint(jr.start),zo.expandByPoint(jr.end),zo.min.addScalar(-this.collider.radius),zo.max.addScalar(this.collider.radius),(r=this.sharedGameControlGlobals.staticMeshBVH)==null||r.shapecast({intersectsBounds:s=>s.intersectsBox(zo),intersectsTriangle:s=>{let o=os,a=Ks,l=s.closestPointToSegment(jr,o,a);if(l<this.collider.radius){let c=this.collider.radius-l,h=a.sub(o).normalize();this.alignToGround&&this.groundTiltAdjustment(h),e.addScaledVector(h,c),jr.start.addScaledVector(h,c),jr.end.addScaledVector(h,c)}}}),this.onObject=Math.abs(e.y)>Math.abs(t*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let i=Math.max(0,e.length()-1e-5);e.normalize().multiplyScalar(i),this.object.position.add(e)}},v$=zI;v$.isLocked=!1;var nD={type:"change"},tW={type:"changeZoom"},sUe={type:"changePan"},am={type:"start"},lm={type:"end",changed:!0},oUe={type:"end",changed:!1},iD=new on,nW=new Se,aUe=2*Math.PI,lUe=1e-8,cUe=.01,rD=new N,WS=new Se,sD=new N,XS=new on,iW=new nt,uUe={type:"requestRender"},y$=class extends ys{constructor(t,e,n={isPlayMode:!1,isExport:!1}){super(),this.object=t,this.domElement=e,this.options=n,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,Fo.DOLLY_ROTATE,Fo.PAN],this.offset=new N,this.eye=new N,this.lastPosition=new N,this.lastQuaternion=new on,this.current=new Se,this.overShoot=new Se,this.overRatio=new Se,this.spherical=new DV,this.sphericalDelta=new DV,this.panOffset=new N,this.panLeftV=new N,this.panUpV=new N,this.panV=new N,this.rotateStart=new Se,this.rotateEnd=new Se,this.rotateDelta=new Se,this.panStart=new Se,this.panEnd=new Se,this.panDelta=new Se,this.dollyStart=new Se,this.dollyEnd=new Se,this.dollyDelta=new Se,this.rotationRangeFactor=new Se,this.panRangeFactor=new Se,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=i=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=i.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(sD,XS,rD),this.offset.copy(sD).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&this.state===-1&&this.rotateLeft((this.autoRotateClockwise===!0?1:-1)*this.getAutoRotationAngle()),this.rotationLimitsMode!==0&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),this.rotationLimitsMode!==2&&(this.spherical.phi+=this.sphericalDelta.phi),(this.rotationLimitsMode!==1||this.autoRotate===!0)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),this.panLimitsMode!==0&&(this.target.applyQuaternion(iD.copy(XS).invert()),this.panOffset.applyQuaternion(iD),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(XS),this.panOffset.applyQuaternion(XS)),this.panLimitsMode===2&&(this.panOffset.y=0),this.panLimitsMode===1&&(this.panOffset.x=0),this.state===-1&&!this.gesture?(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)):(this.target.add(this.panOffset),this.panOffset.set(0,0,0)),this.offset.setFromSpherical(this.spherical),sD.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(iW.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(iW));let i=this.spherical.phi%aUe;return this.eye.copy(this.offset).normalize(),this.object.up.copy(Fn.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),i>0&&i>Math.PI||i<0&&i>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),this.state===-1||this.enableDamping===!0?(this.sphericalDelta.theta*=1-this.dampingFactor,this.sphericalDelta.phi*=1-this.dampingFactor):this.sphericalDelta.set(0,0,0),this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>cUe||8*(1-this.lastQuaternion.dot(this.object.quaternion))>lUe?(this.dispatchEvent(nD),this.object.dispatchEvent(uUe),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=i=>{this.enabled!==!1&&(i.pointerType==="touch"||i.pointerType==="pen"&&co?this.onPointerDownTouch(i):this.onPointerDownMouse(i),this.state!==-1&&(this.isPointerDown=!0,this.dispatchEvent(am),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),i.stopPropagation(),i.pointerType==="touch"||i.pointerType==="pen"&&co||this.domElement.setPointerCapture(i.pointerId)))},this.onPointerLeave=i=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(this.hoverRotatePanMode===1?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,rD.subVectors(this.position0,this.target0),this.spherical.setFromVector3(rD),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):this.hoverRotatePanMode===2&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=i},this.onPointerEnter=i=>{this.resetHoverEffectOnPointerLeave||this.pointerLeaveEvent===void 0?WS.set(i.clientX-this.domElement.clientWidth/2,i.clientY-this.domElement.clientHeight/2):WS.set(i.clientX-this.pointerLeaveEvent.clientX,i.clientY-this.pointerLeaveEvent.clientY),this.hoverRotatePanMode===1?(this.rotateDelta.copy(WS).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(nW,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(i.clientX,i.clientY)):this.hoverRotatePanMode===2&&(this.panDelta.copy(WS).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(i.clientX,i.clientY)),this.update()},this.onPointerMove=i=>{this.enabled!==!1&&(i.pointerType==="touch"||i.pointerType==="pen"&&co?this.onPointerMoveTouch(i):this.onPointerMoveMouse(i),i.stopPropagation())},this.onPointerUp=i=>{this.isPointerDown=!1,Nt.length===0&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),this.hasChange?this.dispatchEvent(lm):this.dispatchEvent(oUe),this.state=-1,i&&(i.stopPropagation(),i.pointerType==="touch"||i.pointerType==="pen"&&co||this.domElement.releasePointerCapture(i.pointerId))},this.onPointerDownMouse=i=>{let r;switch(this.useKeyEvents?r=this.mouseButtons[i.button]:r=this.mouseButtonsPlay[i.button],r){case 0:if(i.altKey===!0&&!i.shiftKey&&!_S(i)){if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}else if(this.key===" "){if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}break;case 4:if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2;break;case 3:if(_S(i)||i.shiftKey){if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}else{if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}break;case 5:if(_S(i)||i.shiftKey){if(this.enableRotate===!1)return;this.handleMouseDownRotate(i),this.state=0}else{if(this.enablePan===!1)return;this.handleMouseDownPan(i),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=i=>{switch(this.state){case 0:if(this.enableRotate===!1)return;this.handleMouseMoveRotate(i);break;case 1:if(this.enableZoom===!1)return;this.handleMouseMoveDolly(i);break;case 2:if(this.enablePan===!1)return;this.handleMouseMovePan(i);break}this.object.wasMovedByUser=!0},this.onPointerDownTouch=i=>{switch(this.touches[Nt.length-1]){case Fo.ROTATE:if(this.enableRotate===!1){this.state=-1;return}this.handleTouchStartRotate(),this.state=3;break;case Fo.PAN:if(this.enablePan===!1){this.state=-1;return}this.handleTouchStartPan(),this.state=4;break;case Fo.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1||this.isTouchZoom===!1)return;this.handleTouchStartDollyPan(),this.state=5;break;case Fo.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1||this.isTouchZoom===!1)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=i=>{switch(this.state){case 3:if(this.enableRotate===!1)return;this.handleTouchMoveRotate(i),this.update();break;case 4:if(this.enablePan===!1)return;this.handleTouchMovePan(i),this.update();break;case 5:if(this.enableZoom===!1&&this.enablePan===!1||this.isTouchZoom===!1)return;this.handleTouchMoveDollyPan(i),this.update();break;case 6:if(this.enableZoom===!1&&this.enableRotate===!1||this.isTouchZoom===!1)return;this.handleTouchMoveDollyRotate(i),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=YO(()=>this.dispatchEvent(lm),33),this.onMouseWheel=i=>{this.enabled===!1||this.enableZoom===!1&&this.enablePan===!1||(this.options.isExport===!1&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&i.preventDefault(),this.dispatchEvent(am),this.handleMouseWheel(i),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=i=>{if(this.enabled!==!1)if(i.preventDefault(),i.type==="gesturechange"){if(this.enableZoom===!1||this.isTouchZoom===!1)return;this.dispatchEvent(am),i.scale>this.prevScale?this.dollyIn(this.getZoomScale()):i.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=i.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(lm)},this.onContextMenu=i=>{this.enabled!==!1&&i.preventDefault()},this.onTouchEnd=i=>{i.preventDefault()},this.onKeyDown=i=>{this.enabled!==!1&&(this.key=i.key,i.key===" "&&this.dispatchEvent(am))},this.onKeyUp=i=>{this.enabled!==!1&&(this.key=void 0,this.state!==-1&&this.onPointerUp(Nt[0]),i.key===" "&&this.dispatchEvent(lm))},this.onPointerHover=i=>{i.pointerType!=="mouse"||this.enabled===!1||this.state!==-1||this.hoverRotatePanMode===2&&this.isPanOverShoot||this.hoverRotatePanMode===1&&this.isRotateOverShoot||(this.isPointerDown=!0,this.hoverRotatePanMode===2?this.handleMouseMovePan(i,this.hoverRotatePanStrength):this.hoverRotatePanMode===1&&this.handleMouseMoveRotate(i,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=i=>{i.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.addEventListenersToCamera()}dispatchEvent(t){t.type==="start"?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(t)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}reset(){this.object.quaternion.copy(this.quat0),this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.isUpVectorFlipped=this.isUpVectorFlipped0,this.object.updateProjectionMatrix(),this.dispatchEvent(nD),this.state=-1,this.pointerLeaveEvent=void 0}resetTo(t,e,n,i,r=!1){this.object.quaternion.copy(i),this.target.copy(t),this.object.position.copy(e),this.object.zoom=n,this.object.isUpVectorFlipped=r,this.object.updateProjectionMatrix(),this.dispatchEvent(nD),this.update(),this.state=-1}updateUseWindowEvents(t){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=t,this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(t,e){this.setEnableDampingSpeed(t.enableDamping),this.enablePan=t.enablePan,this.enableZoom=t.enableZoom,this.enableRotate=t.enableRotate,this.rotationLimitsMode=t.rotationLimitsMode,this.thetaIsFree=t.rotationHorizontalOffset.min===t.rotationHorizontalOffset.max&&t.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=t.rotationVerticalOffset.min===t.rotationVerticalOffset.max&&t.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=t.panLimitsMode,this.panSoftLimit=t.panSoftLimit,this.rotationSoftLimit=t.rotationSoftLimit,this.hoverRotatePanMode=t.hoverRotatePanMode,this.useWindowEvents=e==="window",this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let n=t.hoverRotatePanStrength/100;this.hoverRotatePanStrength=n**2,this.zoomLimitsEnabled=t.zoomLimitsEnabled,this.minZoom=t.zoomLimits.min,this.maxZoom=Math.max(t.zoomLimits.min,t.zoomLimits.max),this.minDistance=1e3/t.zoomLimits.max,this.maxDistance=Math.max(this.minDistance,1e3/t.zoomLimits.min),this.autoRotate=t.autoRotate,this.autoRotateSpeed=t.autoRotateSpeed,this.autoRotateClockwise=t.autoRotateClockwise;let i=this.object.getTarget().applyQuaternion(iD.copy(this.object.quaternion).invert());this.minV=-t.panVerticalOffset.min+i.y,this.maxV=t.panVerticalOffset.max+i.y,this.minH=-t.panHorizontalOffset.min+i.x,this.maxH=t.panHorizontalOffset.max+i.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=Al(this.spherical.phi-t.rotationVerticalOffset.min),this.maxPhi=Al(this.spherical.phi+t.rotationVerticalOffset.max),this.minTheta=Al(Al(this.spherical.theta)-t.rotationHorizontalOffset.min),this.maxTheta=Al(Al(this.spherical.theta)+t.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,t.orbitTouches===1&&(this.touches[0]=Fo.ROTATE),t.panTouches===1&&(this.touches[0]=Fo.PAN),t.orbitTouches===2&&(this.touches[1]=Fo.DOLLY_ROTATE),t.panTouches===2&&(this.touches[1]=Fo.DOLLY_PAN),t.orbitTouches===3&&(this.touches[2]=Fo.ROTATE),t.panTouches===3&&(this.touches[2]=Fo.PAN),this.isTouchZoom=t.isTouchZoom,this.resetHoverEffectOnPointerLeave=t.resetHoverEffectOnPointerLeave??!1}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),cI||(this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture)),this.domElement.addEventListener("touchend",this.onTouchEnd),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let t=this.useWindowEvents?window:this.domElement;t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),cI||(this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture)),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(t,e,n,i,r,s,o,a){this.overShoot.set(0,0);let l,c,h;t instanceof N?(l=t.x,c=t.y,this.current.set(this.target.x,this.target.y),h=!0):(l=t.theta,c=t.phi,this.current.set(Al(this.spherical.theta),Al(this.spherical.phi)),h=!1),n===0&&(this.current.x+=l,this.current.y+=c),(e===3||e===2)&&(!h&&this.isThetaFlipped?this.current.x>i&&this.current.x<0?this.overShoot.x=i-this.current.x:this.current.x<r&&this.current.x>0&&(this.overShoot.x=r-this.current.x):this.current.x>i?this.overShoot.x=i-this.current.x:this.current.x<r&&(this.overShoot.x=r-this.current.x)),(e===3||e===1)&&(this.current.y>s?this.overShoot.y=s-this.current.y:this.current.y<o&&(this.overShoot.y=o-this.current.y)),h||(this.overShoot.x=Al(this.overShoot.x),this.overShoot.y=Al(this.overShoot.y)),n!==0?(this.overRatio.copy(this.overShoot).divide(a),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),n===1&&(this.overRatio.x=rW(Math.abs(this.overRatio.x)),this.overRatio.y=rW(Math.abs(this.overRatio.y))),this.isPointerDown||n===1?n===2&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),c*this.overShoot.y<0&&!this.phiIsFree&&(c*=1-this.overRatio.y)):n===2&&(!h&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||h&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=this.overShoot.x*.05),this.phiIsFree||(c=this.overShoot.y*.05),h?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):h?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,c+=this.overShoot.y),t instanceof N?(t.x=l,t.y=c):(this.thetaIsFree||(t.theta=l),this.phiIsFree||(t.phi=c))}setEnableDampingSpeed(t){this.enableDamping=t,this.rotateSpeed=t===!0?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(t){this.sphericalDelta.theta-=t}rotateUp(t){this.sphericalDelta.phi-=t}panLeft(t,e){this.panLeftV.setFromMatrixColumn(e,0),this.panLeftV.multiplyScalar(-t),this.panOffset.add(this.panLeftV)}panUp(t,e){this.panUpV.setFromMatrixColumn(e,1),this.panUpV.multiplyScalar(t),this.panOffset.add(this.panUpV)}pan(t,e){let n=this.domElement;if(n&&this.object.isPerspectiveCamera){let i=this.object.position;this.panV.copy(i).sub(this.target);let r=this.panV.length();r*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*t*r/n.clientHeight,this.object.matrixWorld),this.panUp(2*e*r/n.clientHeight,this.object.matrixWorld)}else n&&this.object.isOrthographicCamera&&(this.panLeft(t*(this.object.right-this.object.left)/this.object.zoom/n.clientWidth,this.object.matrixWorld),this.panUp(e*(this.object.top-this.object.bottom)/this.object.zoom/n.clientHeight,this.object.matrixWorld));this.dispatchEvent(sUe)}dollyOut(t){this.object.isPerspectiveCamera?this.scale/=t:this.object.isOrthographicCamera&&(this.object.zoom*=t,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(tW)}dollyIn(t){this.object.isPerspectiveCamera?this.scale*=t:this.object.isOrthographicCamera&&(this.object.zoom/=t,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(tW)}zoomOut(t=this.getZoomScale()){this.dispatchEvent(am),this.dollyOut(t),this.dispatchEvent(lm)}zoomIn(t=this.getZoomScale()){this.dispatchEvent(am),this.dollyIn(t),this.dispatchEvent(lm)}handleMouseDownRotate(t){this.rotateStart.set(t.clientX,t.clientY)}handleMouseDownDolly(t){this.dollyStart.set(t.clientX,t.clientY)}handleMouseDownPan(t){this.panStart.set(t.clientX,t.clientY)}handleMouseMoveRotate(t,e=1){t.movementX!==void 0?this.rotateDelta.set(t.movementX,t.movementY):(this.rotateEnd.set(t.clientX,t.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*e).rotateAround(nW,-this.object.angleOffsetFromUp);let n=this.domElement,i=this.useWindowEvents?window.innerHeight:n.clientHeight,r=2*Math.PI*this.rotateDelta.x/i,s=2*Math.PI*this.rotateDelta.y/i;this.rotateLeft(r),this.rotateUp(s),this.update()}handleMouseMoveDolly(t){this.dollyEnd.set(t.clientX,t.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(t,e=1){t.movementX!==void 0?this.panDelta.set(t.movementX,t.movementY):(this.panEnd.set(t.clientX,t.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*e),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(t){if(JRe===!1&&_S(t)===!1&&hUe(t)===!0){if(this.enablePan===!1)return;this.gesture?(this.panDelta.set(-t.deltaX,-t.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),t.altKey?this.pan(0,this.panDelta.y):t.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.gesture=!1,this.isPointerDown=!1},30)}else{if(this.enableZoom===!1)return;t.deltaY===0?t.deltaX<0?this.dollyIn(this.getZoomScale()):t.deltaX>0&&this.dollyOut(this.getZoomScale()):t.deltaY<0?this.dollyIn(this.getZoomScale()):t.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(Nt.length===2){let t=.5*(Nt[0].pageX+Nt[1].pageX),e=.5*(Nt[0].pageY+Nt[1].pageY);this.rotateStart.set(t,e)}else this.rotateStart.set(Nt[0].pageX,Nt[0].pageY)}handleTouchStartPan(){if(Nt.length===2){let t=.5*(Nt[0].pageX+Nt[1].pageX),e=.5*(Nt[0].pageY+Nt[1].pageY);this.panStart.set(t,e)}else this.panStart.set(Nt[0].pageX,Nt[0].pageY)}handleTouchStartDolly(){let t=Nt[0].pageX-Nt[1].pageX,e=Nt[0].pageY-Nt[1].pageY,n=Math.sqrt(t*t+e*e);this.dollyStart.set(0,n)}handleTouchStartDollyPan(){this.enableZoom&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(t){if(Nt.length===2){let n=p2(t),i=.5*(t.pageX+n.x),r=.5*(t.pageY+n.y);this.rotateEnd.set(i,r)}else{if(t.pointerId!==Nt[0].pointerId)return;this.rotateEnd.set(t.pageX,t.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let e=this.domElement;e&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/e.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/e.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(t){if(Nt.length===2){let e=p2(t),n=.5*(t.pageX+e.x),i=.5*(t.pageY+e.y);this.panEnd.set(n,i)}else{if(t.pointerId!==Nt[0].pointerId)return;this.panEnd.set(t.pageX,t.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(t){let e=p2(t),n=t.pageX-e.x,i=t.pageY-e.y,r=Math.sqrt(n*n+i*i);this.dollyEnd.set(0,r),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(t){this.enableZoom&&this.handleTouchMoveDolly(t),this.enablePan&&this.handleTouchMovePan(t)}handleTouchMoveDollyRotate(t){this.enableZoom&&this.handleTouchMoveDolly(t),this.enableRotate&&this.handleTouchMoveRotate(t)}};function Al(t){let e=Math.PI*2;for(;t<=-Math.PI;)t+=e;for(;t>Math.PI;)t-=e;return t}function rW(t){return 1-Math.pow(1-t,4)}function hUe(t){return t.wheelDeltaY===0||t.deltaY===0?AE&&t.shiftKey&&Math.abs(t.wheelDeltaX)>=120?!1:t.wheelDeltaX?t.wheelDeltaX===-3*t.deltaX:t.deltaMode===0:t.wheelDeltaY?t.wheelDeltaY===-3*t.deltaY:t.deltaMode===0}var oD=new WeakMap,dUe=class extends CO{constructor(t){super(t),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(t){return this.decoderPath=t,this}setDecoderConfig(t){return this.decoderConfig=t,this}setWorkerLimit(t){return this.workerLimit=t,this}load(t,e,n,i){let r=new IL(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(t,s=>{this.decodeDracoFile(s,e).catch(i)},n,i)}decodeDracoFile(t,e,n,i){let r={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!n};return this.decodeGeometry(t,r).then(e)}decodeGeometry(t,e){let n=JSON.stringify(e);if(oD.has(t)){let a=oD.get(t);if(a.key===n)return a.promise;if(t.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i,r=this.workerNextTaskID++,s=t.byteLength,o=this._getWorker(r,s).then(a=>(i=a,new Promise((l,c)=>{i._callbacks[r]={resolve:l,reject:c},i.postMessage({type:"decode",id:r,taskConfig:e,buffer:t},[t])}))).then(a=>this._createGeometry(a.geometry));return o.catch(()=>!0).then(()=>{i&&r&&this._releaseTask(i,r)}),oD.set(t,{key:n,promise:o}),o}_createGeometry(t){let e=new Lt;t.index&&e.setIndex(new Ut(t.index.array,1));for(let n=0;n<t.attributes.length;n++){let i=t.attributes[n],r=i.name,s=i.array,o=i.itemSize;e.setAttribute(r,new Ut(s,o))}return e}_loadLibrary(t,e){let n=new IL(this.manager);return n.setPath(this.decoderPath),n.setResponseType(e),n.setWithCredentials(this.withCredentials),new Promise((i,r)=>{n.load(t,i,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let t=typeof WebAssembly!="object"||this.decoderConfig.type==="js",e=[];return t?e.push(this._loadLibrary("draco_decoder.js","text")):(e.push(this._loadLibrary("draco_wasm_wrapper.js","text")),e.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(e).then(n=>{let i=n[0];t||(this.decoderConfig.wasmBinary=n[1]);let r=fUe.toString(),s=["/* draco decoder */",i,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(t,e){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(r){let s=r.data;switch(s.type){case"decode":i._callbacks[s.id].resolve(s);break;case"error":i._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,r){return i._taskLoad>r._taskLoad?-1:1});let n=this.workerPool[this.workerPool.length-1];return n._taskCosts[t]=e,n._taskLoad+=e,n})}_releaseTask(t,e){t._taskLoad-=t._taskCosts[e],delete t._callbacks[e],delete t._taskCosts[e]}debug(){console.log("Task load: ",this.workerPool.map(t=>t._taskLoad))}dispose(){for(let t=0;t<this.workerPool.length;++t)this.workerPool[t].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}};function fUe(){let t,e;onmessage=function(o){let a=o.data;switch(a.type){case"init":t=a.decoderConfig,e=new Promise(function(h){t.onModuleLoaded=function(u){h({draco:u})},DracoDecoderModule(t)});break;case"decode":let l=a.buffer,c=a.taskConfig;e.then(h=>{let u=h.draco,d=new u.Decoder,f=new u.DecoderBuffer;f.Init(new Int8Array(l),l.byteLength);try{let p=n(u,d,f,c),v=p.attributes.map(g=>g.array.buffer);p.index&&v.push(p.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:p},v)}catch(p){console.error(p),self.postMessage({type:"error",id:a.id,error:p.message})}finally{u.destroy(f),u.destroy(d)}});break}};function n(o,a,l,c){let h=c.attributeIDs,u=c.attributeTypes,d,f,p=a.GetEncodedGeometryType(l);if(p===o.TRIANGULAR_MESH)d=new o.Mesh,f=a.DecodeBufferToMesh(l,d);else if(p===o.POINT_CLOUD)d=new o.PointCloud,f=a.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!f.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());let v={index:null,attributes:[]};for(let g in h){let m=self[u[g]],y,_;if(c.useUniqueIDs)_=h[g],y=a.GetAttributeByUniqueId(d,_);else{if(_=a.GetAttributeId(d,o[h[g]]),_===-1)continue;y=a.GetAttribute(d,_)}v.attributes.push(r(o,a,d,g,m,y))}return p===o.TRIANGULAR_MESH&&(v.index=i(o,a,d)),o.destroy(d),v}function i(o,a,l){let c=l.num_faces()*3,h=c*4,u=o._malloc(h);a.GetTrianglesUInt32Array(l,h,u);let d=new Uint32Array(o.HEAPF32.buffer,u,c).slice();return o._free(u),{array:d,itemSize:1}}function r(o,a,l,c,h,u){let d=u.num_components(),f=l.num_points()*d,p=f*h.BYTES_PER_ELEMENT,v=s(o,h),g=o._malloc(p);a.GetAttributeDataArrayForAllPoints(l,u,v,p,g);let m=new h(o.HEAPF32.buffer,g,f).slice();return o._free(g),{name:c,array:m,itemSize:d}}function s(o,a){switch(a){case Float32Array:return o.DT_FLOAT32;case Int8Array:return o.DT_INT8;case Int16Array:return o.DT_INT16;case Int32Array:return o.DT_INT32;case Uint8Array:return o.DT_UINT8;case Uint16Array:return o.DT_UINT16;case Uint32Array:return o.DT_UINT32}}}var gh;function pUe(){return gh||(gh=new dUe,gh.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),gh.decoderPending}async function mUe(t){if(gh){let e={attributeIDs:gh.defaultAttributeIDs,attributeTypes:gh.defaultAttributeTypes,useUniqueIDs:!1},n;try{n=await gh.decodeGeometry(new Int8Array(t).buffer,e)}catch(i){console.error(i)}if(n)return{index:n.index?{array:n.index.array}:void 0,attributes:Object.entries(n.attributes).map(([i,r])=>({name:i,itemSize:r.itemSize,array:r.array}))}}return null}async function gUe(t,e){let[n,i]=NK(qL.deserialize(new Uint8Array(t)));ILe(n);let r=[];n.scene.objects.traverse((s,o)=>{o.type==="Mesh"&&o.geometry.type==="NonParametricGeometry"&&o.geometry.data.draco!==void 0&&r.push(o)}),r.length&&await pUe();for(let s of r){let o=await mUe(qr(s.geometry.data.draco));if(o){o.index&&(s.geometry.data.index={array:o.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let a={};o.attributes.forEach(({name:l,array:c,itemSize:h})=>{a[l]={array:c,itemSize:h,type:"Float32Array",normalized:!1}}),s.geometry.data.attributes=a,s.geometry.data.draco=void 0}}return e&&e(n),i.result().data}var sW=Object.keys(HZ).filter(t=>isNaN(Number(t))),vUe=class{constructor(t,e,n,i,r,s,o,a){this.requestRender=s,this.isEnable=!1,this.onResetRaycaster=()=>{this.eventContext.raycasterNeedsUpdate=!0},this.onTouchMovePreventScroll=c=>{(c.touches.length>1||this.preventTouchScroll)&&c.preventDefault()},this.onMouseWheelPreventScroll=c=>{this.preventScroll&&c.preventDefault()},this.stopRaycast=i.stopRaycast,this.preventScroll=i.preventScroll,this.preventTouchScroll=i.preventTouchScroll,this.hideCursor=i.hideCursor,this.eventContext=new KOe(t,e,n,r,i.stopRaycast,a??!1);let l={controlsManager:o,eventManager:this};this.handlers={Spline:new pNe(this.eventContext),Conditional:new wNe(this.eventContext,l),Start:new VNe(this.eventContext,l),Basic:new gNe(this.eventContext,l),MouseHover:new UNe(this.eventContext,l),Scroll:new GNe(this.eventContext,l),Follow:new DNe(this.eventContext,l),DragDrop:new MNe(this.eventContext,l),LookAt:new ONe(this.eventContext)}}activate(){let{scene:t,domElement:e,eventElement:n}=this.eventContext;this.hideCursor&&(e.style.cursor="none"),this.isEnable=!0,t.traverseEntity(i=>{i.addEventListener("requestRender",this.requestRender)}),Object.values(this.handlers).forEach(i=>i.connect()),sW.forEach(i=>{Object.values(this.handlers).some(r=>r.domEventsNeeded.has(i))&&(e.addEventListener(i,this.onResetRaycaster),n.addEventListener(i,this.onResetRaycaster))}),e.addEventListener("wheel",this.onMouseWheelPreventScroll),e.addEventListener("touchmove",this.onTouchMovePreventScroll)}deactivate(){let{scene:t,domElement:e}=this.eventContext;this.isEnable=!1,e.style.cursor="",Object.values(this.handlers).forEach(n=>n.disconnect()),t.traverseEntity(n=>{n.removeEventListener("requestRender",this.requestRender)}),sW.forEach(n=>{e.removeEventListener(n,this.onResetRaycaster)}),e.removeEventListener("touchmove",this.onTouchMovePreventScroll),e.removeEventListener("wheel",this.onMouseWheelPreventScroll)}reset(){this.deactivate(),this.activate()}updateUseWindowEvents(t){let e=this.isEnable;e&&this.deactivate(),this.eventContext.useWindowEvents=t,e&&this.activate()}},yUe=class{constructor(t,e,n,i,r){this._aspect=1,this._renderer=t,this._camera=e,this._frameSize=new Se().copy(n),this._editorSize=new Se().copy(i),this._aspect=e.aspect,this._fov=r??e.fov}set frameSize(t){this._frameSize.copy(t)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||this._camera.cameraType!=="PerspectiveCamera")return;let t=this._frameSize.x,e=this._frameSize.y,n=this._editorSize.y;this._aspect=t/e,e<=n&&(this._camera.zoom*=n/e),this._renderer.setViewport(0,0,t,e)}updateCamera(){if(this._camera)if(this._camera.cameraType==="PerspectiveCamera"){let t=this._frameSize.y,e=this._editorSize.y,n=this._fov;if(t>e){let i=xUe(t,1080,2160,1,15)/100;n*=t/e,n*=1-i}this._camera.aspect=this._aspect,this._camera.fov=n,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y)}setCamera(t){this._camera=t,this._aspect=t.aspect,this._fov=t.fov}revert(){let t=window.innerWidth,e=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,t,e),this._renderer.setSize(t,e)),this._camera&&(this._camera.aspect=t/e,this._camera.fov=this._fov,this._camera.setViewplaneSize(t,e),this._camera.updateProjectionMatrix())}};function xUe(t,e,n,i,r){return(t-e)/(n-e)*(r-i)+i}var x$={RED:0,GREEN:1,BLUE:2,ALPHA:3},B1="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",_Ue=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;
#if PASS == 1
uniform vec4 kernel64[32];
#else
uniform vec4 kernel16[8];
#endif
varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;
#else
float CoC=texture2D(cocBuffer,vUv).g*scale;
#endif
if(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(CoC,CoCNearFar.g*scale);
#else
vec2 step=texelSize*CoC;
#endif
#if PASS == 1
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;
#else
vec4 maxValue=texture2D(inputBuffer,vUv);for(int i=0;i<8;++i){vec4 kernel=kernel16[i];vec2 uv=step*kernel.xy+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);uv=step*kernel.zw+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);}gl_FragColor=maxValue;
#endif
}}`,YS=class extends nr{constructor(t=!1,e=!1){super({name:"BokehMaterial",defines:{PASS:t?"2":"1"},uniforms:{kernel64:new _t(null),kernel16:new _t(null),inputBuffer:new _t(null),cocBuffer:new _t(null),texelSize:new _t(new Se),scale:new _t(1)},blending:Rr,depthWrite:!1,depthTest:!1,fragmentShader:_Ue,vertexShader:B1}),this.toneMapped=!1,e&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}set cocBuffer(t){this.uniforms.cocBuffer.value=t}setCoCBuffer(t){this.uniforms.cocBuffer.value=t}get scale(){return this.uniforms.scale.value}set scale(t){this.uniforms.scale.value=t}getScale(t){return this.uniforms.scale.value=t}setScale(t){this.uniforms.scale.value=t}generateKernel(){let t=2.39996323,e=new Float32Array(128),n=new Float32Array(32),i=0,r=0;for(let a=0;a<80;++a){let l=a*t,c=Math.sqrt(a)/Math.sqrt(80),h=c*Math.cos(l),u=c*Math.sin(l);a%5===0?(n[r++]=h,n[r++]=u):(e[i++]=h,e[i++]=u)}let s=[],o=[];for(let a=0;a<128;)s.push(new Zt(e[a++],e[a++],e[a++],e[a++]));for(let a=0;a<32;)o.push(new Zt(n[a++],n[a++],n[a++],n[a++]));this.uniforms.kernel64.value=s,this.uniforms.kernel16.value=o}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e)}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}};function oW(t,e,n){return t*(e-n)-e}function GI(t,e,n){return Math.min(Math.max((t+e)/(e-n),0),1)}var wUe=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,SUe=class extends nr{constructor(t){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new _t(null),focusDistance:new _t(0),focusRange:new _t(0),cameraNear:new _t(.3),cameraFar:new _t(1e3)},blending:Rr,depthWrite:!1,depthTest:!1,fragmentShader:wUe,vertexShader:B1}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(t)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(t){this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=hu){this.depthBuffer=t,this.depthPacking=e}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(t){this.uniforms.focusDistance.value=t}get worldFocusDistance(){return-oW(this.focusDistance,this.near,this.far)}set worldFocusDistance(t){this.focusDistance=GI(-t,this.near,this.far)}getFocusDistance(t){this.uniforms.focusDistance.value=t}setFocusDistance(t){this.uniforms.focusDistance.value=t}get focalLength(){return this.focusRange}set focalLength(t){this.focusRange=t}get focusRange(){return this.uniforms.focusRange.value}set focusRange(t){this.uniforms.focusRange.value=t}get worldFocusRange(){return-oW(this.focusRange,this.near,this.far)}set worldFocusRange(t){this.focusRange=GI(-t,this.near,this.far)}getFocalLength(t){return this.focusRange}setFocalLength(t){this.focusRange=t}adoptCameraSettings(t){t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,t instanceof Yr?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},bUe=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <encodings_fragment>
#include <dithering_fragment>
}`,AUe="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",aW=class extends nr{constructor(t=new Se){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new _t(null),texelSize:new _t(new Se),halfTexelSize:new _t(new Se),kernel:new _t(0),scale:new _t(1)},blending:Rr,depthWrite:!1,depthTest:!1,fragmentShader:bUe,vertexShader:AUe}),this.toneMapped=!1,this.setTexelSize(t.x,t.y)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.inputBuffer=t}get scale(){return this.uniforms.scale.value}set scale(t){this.uniforms.scale.value=t}getScale(){return this.uniforms.scale.value}setScale(t){this.uniforms.scale.value=t}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(t){this.uniforms.kernel.value=t}setKernel(t){this.kernel=t}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e),this.uniforms.halfTexelSize.value.set(t,e).multiplyScalar(.5)}setSize(t,e){let n=this.uniforms;n.texelSize.value.set(1/t,1/e),n.halfTexelSize.value.copy(n.texelSize.value).multiplyScalar(.5)}},MUe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,EUe=class extends nr{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new _t(null),opacity:new _t(1)},blending:Rr,depthWrite:!1,depthTest:!1,fragmentShader:MUe,vertexShader:B1}),this.toneMapped=!1}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}getOpacity(t){return this.uniforms.opacity.value}setOpacity(t){this.uniforms.opacity.value=t}},CUe=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,TUe=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,kF={DEPTH:0,LUMA:1,COLOR:2},_$={DISABLED:0,DEPTH:1,CUSTOM:2},PUe=class extends nr{constructor(t=new Se,e=kF.COLOR){super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:cv.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new _t(null),depthBuffer:new _t(null),predicationBuffer:new _t(null),texelSize:new _t(t)},blending:Rr,depthWrite:!1,depthTest:!1,fragmentShader:CUe,vertexShader:TUe}),this.toneMapped=!1,this.edgeDetectionMode=e}set depthBuffer(t){this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=hu){this.depthBuffer=t,this.depthPacking=e}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(t){this.defines.EDGE_DETECTION_MODE=t.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(t){this.edgeDetectionMode=t}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(t){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=t.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(t){this.localContrastAdaptationFactor=t}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(t){this.defines.EDGE_THRESHOLD=t.toFixed("6"),this.defines.DEPTH_THRESHOLD=(t*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(t){this.edgeDetectionThreshold=t}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(t){this.defines.PREDICATION_MODE=t.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(t){this.predicationMode=t}set predicationBuffer(t){this.uniforms.predicationBuffer.value=t}setPredicationBuffer(t){this.uniforms.predicationBuffer.value=t}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(t){this.defines.PREDICATION_THRESHOLD=t.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(t){this.predicationThreshold=t}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(t){this.defines.PREDICATION_SCALE=t.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(t){this.predicationScale=t}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(t){this.defines.PREDICATION_STRENGTH=t.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(t){this.predicationStrength=t}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}},DUe=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,RUe="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",Da={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},HI=class extends nr{constructor(t,e,n,i,r=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:cv.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new _t(null),depthBuffer:new _t(null),resolution:new _t(new Se),texelSize:new _t(new Se),cameraNear:new _t(.3),cameraFar:new _t(1e3),aspect:new _t(1),time:new _t(0)},blending:Rr,depthWrite:!1,depthTest:!1,dithering:r}),this.toneMapped=!1,t&&this.setShaderParts(t),e&&this.setDefines(e),n&&this.setUniforms(n),this.adoptCameraSettings(i)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(t){this.uniforms.depthBuffer.value=t}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=hu){this.depthBuffer=t,this.depthPacking=e}setShaderParts(t){return this.fragmentShader=DUe.replace(Da.FRAGMENT_HEAD,t.get(Da.FRAGMENT_HEAD)).replace(Da.FRAGMENT_MAIN_UV,t.get(Da.FRAGMENT_MAIN_UV)).replace(Da.FRAGMENT_MAIN_IMAGE,t.get(Da.FRAGMENT_MAIN_IMAGE)),this.vertexShader=RUe.replace(Da.VERTEX_HEAD,t.get(Da.VERTEX_HEAD)).replace(Da.VERTEX_MAIN_SUPPORT,t.get(Da.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(t){for(let e of t.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(t){for(let e of t.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(t){this.extensions={};for(let e of t)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(t){this.encodeOutput!==t&&(t?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(t){return this.encodeOutput}setOutputEncodingEnabled(t){this.encodeOutput=t}get time(){return this.uniforms.time.value}set time(t){this.uniforms.time.value=t}setDeltaTime(t){this.uniforms.time.value+=t}adoptCameraSettings(t){t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,t instanceof Yr?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(t,e){let n=this.uniforms;n.resolution.value.set(t,e),n.texelSize.value.set(1/t,1/e),n.aspect.value=t/e}static get Section(){return Da}},LUe=`#include <common>
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,IUe=class extends nr{constructor(t=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:cv.replace(/\D+/g,"")},uniforms:{inputBuffer:new _t(null),threshold:new _t(0),smoothing:new _t(1),range:new _t(null)},blending:Rr,depthWrite:!1,depthTest:!1,fragmentShader:LUe,vertexShader:B1}),this.toneMapped=!1,this.colorOutput=t,this.luminanceRange=e}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get threshold(){return this.uniforms.threshold.value}set threshold(t){this.smoothing>0||t>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=t}getThreshold(){return this.threshold}setThreshold(t){this.threshold=t}get smoothing(){return this.uniforms.smoothing.value}set smoothing(t){this.threshold>0||t>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=t}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(t){this.smoothing=t}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(t){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(t){t?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(t){return this.colorOutput}setColorOutputEnabled(t){this.colorOutput=t}get useRange(){return this.luminanceRange!==null}set useRange(t){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(t){t!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=t,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(t){this.luminanceRange=t}},BUe=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,w$={DISCARD:0,MULTIPLY:1,MULTIPLY_RGB_SET_ALPHA:2},OUe=class extends nr{constructor(t=null){super({name:"MaskMaterial",uniforms:{maskTexture:new _t(t),inputBuffer:new _t(null),strength:new _t(1)},blending:Rr,depthWrite:!1,depthTest:!1,fragmentShader:BUe,vertexShader:B1}),this.toneMapped=!1,this.setColorChannel(x$.RED),this.setMaskFunction(w$.DISCARD)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}set maskTexture(t){this.uniforms.maskTexture.value=t,delete this.defines.MASK_PRECISION_HIGH,t.type!==Kr&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(t){this.maskTexture=t}set colorChannel(t){this.defines.COLOR_CHANNEL=t.toFixed(0),this.needsUpdate=!0}setColorChannel(t){this.colorChannel=t}set maskFunction(t){this.defines.MASK_FUNCTION=t.toFixed(0),this.needsUpdate=!0}setMaskFunction(t){this.maskFunction=t}get inverted(){return this.defines.INVERTED!==void 0}set inverted(t){this.inverted&&!t?delete this.defines.INVERTED:t&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(t){this.inverted=t}get strength(){return this.uniforms.strength.value}set strength(t){this.uniforms.strength.value=t}getStrength(){return this.strength}setStrength(t){this.strength=t}},FUe=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,NUe="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",UUe=class extends nr{constructor(t=new Se,e=new Se){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new _t(null),searchTexture:new _t(null),areaTexture:new _t(null),resolution:new _t(e),texelSize:new _t(t)},blending:Rr,depthWrite:!1,depthTest:!1,fragmentShader:FUe,vertexShader:NUe}),this.toneMapped=!1}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(t){this.uniforms.searchTexture.value=t}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(t){this.uniforms.areaTexture.value=t}setLookupTextures(t,e){this.searchTexture=t,this.areaTexture=e}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(t){let e=Math.min(Math.max(t,0),112);this.defines.MAX_SEARCH_STEPS_INT=e.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=e.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(t){this.orthogonalSearchSteps=t}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(t){let e=Math.min(Math.max(t,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=e.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=e.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(t){this.diagonalSearchSteps=t}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(t){t?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(t){this.diagonalDetection=t}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(t){let e=Math.min(Math.max(t,0),100);this.defines.CORNER_ROUNDING=e.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(e/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(t){this.cornerRounding=t}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(t){t?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(t){this.cornerDetection=t}setSize(t,e){let n=this.uniforms;n.texelSize.value.set(1/t,1/e),n.resolution.value.set(t,e)}},kUe=new dv,Vu=null;function zUe(){if(Vu===null){let t=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]);Vu=new Lt,Vu.setAttribute!==void 0?(Vu.setAttribute("position",new Ut(t,3)),Vu.setAttribute("uv",new Ut(e,2))):(Vu.addAttribute("position",new Ut(t,3)),Vu.addAttribute("uv",new Ut(e,2)))}return Vu}var da=class{constructor(t="Pass",e=new gf,n=kUe){this.name=t,this.renderer=null,this.scene=e,this.camera=n,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(t){if(this.rtt===t){let e=this.getFullscreenMaterial();e!==null&&(e.needsUpdate=!0),this.rtt=!t}}setRenderer(t){this.renderer=t}isEnabled(){return this.enabled}setEnabled(t){this.enabled=t}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(t){let e=this.screen;e!==null?e.material=t:(e=new ao(zUe(),t),e.frustumCulled=!1,this.scene===null&&(this.scene=new gf),this.scene.add(e),this.screen=e)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(t){this.fullscreenMaterial=t}getDepthTexture(){return null}setDepthTexture(t,e=hu){}render(t,e,n,i,r){throw new Error("Render method not implemented!")}setSize(t,e){}initialize(t,e,n){}dispose(){for(let t of Object.keys(this)){let e=this[t];if(e!==null&&typeof e.dispose=="function"){if(e instanceof gf||e===this.renderer)continue;this[t].dispose()}}}},dM=class extends da{constructor(t,e=!0){super("CopyPass"),this.fullscreenMaterial=new EUe,this.needsSwap=!1,this.renderTarget=t,t===void 0&&(this.renderTarget=new $i(1,1,{minFilter:En,magFilter:En,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(t){this.autoResize=t}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(t){this.autoResize=t}render(t,e,n,i,r){this.fullscreenMaterial.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){this.autoResize&&this.renderTarget.setSize(t,e)}initialize(t,e,n){n!==void 0&&(this.renderTarget.texture.type=n,n!==Kr?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":t.outputEncoding===Wt&&(this.renderTarget.texture.encoding=Wt))}},GUe=class extends da{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(t,e,n,i,r){let s=t.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},aD=new Rt,LE=class extends da{constructor(t=!0,e=!0,n=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=t,this.depth=e,this.stencil=n,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(t,e,n){this.color=t,this.depth=e,this.stencil=n}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(t){this.overrideClearColor=t}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(t){this.overrideClearAlpha=t}render(t,e,n,i,r){let s=this.overrideClearColor,o=this.overrideClearAlpha,a=t.getClearAlpha(),l=s!==null,c=o>=0;l?(aD.copy(t.getClearColor(aD)),t.setClearColor(s,c?o:a)):c&&t.setClearAlpha(o),t.setRenderTarget(this.renderToScreen?null:e),t.clear(this.color,this.depth,this.stencil),l?t.setClearColor(aD,a):c&&t.setClearAlpha(a)}},ju=-1,Ls=class extends ys{constructor(e,n=ju,i=ju,r=1){super(),this.resizable=e,this.base=new Se(1,1),this.preferred=new Se(n,i),this.target=this.preferred,this.s=r}get width(){let{base:e,preferred:n,scale:i}=this,r;return n.width!==ju?r=n.width:n.height!==ju?r=Math.round(n.height*(e.width/Math.max(e.height,1))):r=Math.round(e.width*i),r}set width(e){this.preferredWidth=e}get height(){let{base:e,preferred:n,scale:i}=this,r;return n.height!==ju?r=n.height:n.width!==ju?r=Math.round(n.width/Math.max(e.width/Math.max(e.height,1),1)):r=Math.round(e.height*i),r}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferred.setScalar(ju),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.base.width}set baseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(e){this.base.height!==e&&(this.base.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,n){(this.base.width!==e||this.base.height!==n)&&(this.base.set(e,n),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(e){this.preferred.width!==e&&(this.preferred.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferred.height}set preferredHeight(e){this.preferred.height!==e&&(this.preferred.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,n){(this.preferred.width!==e||this.preferred.height!==n)&&(this.preferred.set(e,n),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(e){this.base.set(e.getBaseWidth(),e.getBaseHeight()),this.preferred.set(e.getPreferredWidth(),e.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return ju}},lD=!1,lW=class{constructor(t=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(t),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let n;if(e.material.flatShading)switch(e.material.side){case oo:n=this.materialsFlatShadedDoubleSide;break;case vr:n=this.materialsFlatShadedBackSide;break;default:n=this.materialsFlatShaded;break}else switch(e.material.side){case oo:n=this.materialsDoubleSide;break;case vr:n=this.materialsBackSide;break;default:n=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=n[2]:e.isInstancedMesh?e.material=n[1]:e.material=n[0],++this.meshCount}}}setMaterial(t){if(this.disposeMaterials(),this.material=t,t!==null){let e=this.materials=[t.clone(),t.clone(),t.clone()];for(let n of e)n.uniforms=Object.assign({},t.uniforms),n.side=Ka;e[2].skinning=!0,this.materialsBackSide=e.map(n=>{let i=n.clone();return i.uniforms=Object.assign({},t.uniforms),i.side=vr,i}),this.materialsDoubleSide=e.map(n=>{let i=n.clone();return i.uniforms=Object.assign({},t.uniforms),i.side=oo,i}),this.materialsFlatShaded=e.map(n=>{let i=n.clone();return i.uniforms=Object.assign({},t.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=e.map(n=>{let i=n.clone();return i.uniforms=Object.assign({},t.uniforms),i.flatShading=!0,i.side=vr,i}),this.materialsFlatShadedDoubleSide=e.map(n=>{let i=n.clone();return i.uniforms=Object.assign({},t.uniforms),i.flatShading=!0,i.side=oo,i})}}render(t,e,n){let i=t.shadowMap.enabled;if(t.shadowMap.enabled=!1,lD){let r=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),t.render(e,n);for(let s of r)s[0].material=s[1];this.meshCount!==r.size&&r.clear()}else{let r=e.overrideMaterial;e.overrideMaterial=this.material,t.render(e,n),e.overrideMaterial=r}t.shadowMap.enabled=i}disposeMaterials(){if(this.material!==null){let t=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let e of t)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return lD}static set workaroundEnabled(t){lD=t}},HUe=class extends da{constructor(t,e,n=null){super("RenderPass",t,e),this.needsSwap=!1,this.clearPass=new LE,this.overrideMaterialManager=n===null?null:new lW(n),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(t){super.renderToScreen=t,this.clearPass.renderToScreen=t}get overrideMaterial(){let t=this.overrideMaterialManager;return t!==null?t.material:null}set overrideMaterial(t){let e=this.overrideMaterialManager;t!==null?e!==null?e.setMaterial(t):this.overrideMaterialManager=new lW(t):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(t){this.overrideMaterial=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getSelection(){return this.selection}setSelection(t){this.selection=t}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(t){this.ignoreBackground=t}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(t){this.skipShadowMapUpdate=t}getClearPass(){return this.clearPass}render(t,e,n,i,r){let s=this.scene,o=this.camera,a=this.selection,l=o.layers.mask,c=s.background,h=t.shadowMap.autoUpdate,u=this.renderToScreen?null:e;a!==null&&o.layers.set(a.getLayer()),this.skipShadowMapUpdate&&(t.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(t,e),t.setRenderTarget(u),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(t,s,o):t.render(s,o),o.layers.mask=l,s.background=c,t.shadowMap.autoUpdate=h}},cW=class extends da{constructor(t,e,{resolutionScale:n=1,width:i=Ls.AUTO_SIZE,height:r=Ls.AUTO_SIZE,renderTarget:s}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new HUe(t,e,new DQ({depthPacking:vQ}));let o=this.renderPass;o.skipShadowMapUpdate=!0,o.ignoreBackground=!0;let a=o.getClearPass();a.overrideClearColor=new Rt(16777215),a.overrideClearAlpha=1,this.renderTarget=s,this.renderTarget===void 0&&(this.renderTarget=new $i(1,1,{minFilter:si,magFilter:si,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new Ls(this,i,r,n);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,n,i,r){let s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(t,s)}setSize(t,e){let n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height)}},hn={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},VUe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",jUe="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",WUe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",XUe="float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",YUe="float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",qUe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",QUe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",KUe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",JUe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",ZUe="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",$Ue="float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",eke="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",tke="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",nke="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",ike="float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",rke="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",ske="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",oke="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",ake=new Map([[hn.SKIP,null],[hn.ADD,VUe],[hn.ALPHA,jUe],[hn.AVERAGE,WUe],[hn.COLOR_BURN,XUe],[hn.COLOR_DODGE,YUe],[hn.DARKEN,qUe],[hn.DIFFERENCE,QUe],[hn.EXCLUSION,KUe],[hn.LIGHTEN,JUe],[hn.MULTIPLY,ZUe],[hn.DIVIDE,$Ue],[hn.NEGATION,eke],[hn.NORMAL,tke],[hn.OVERLAY,nke],[hn.REFLECT,ike],[hn.SCREEN,rke],[hn.SOFT_LIGHT,ske],[hn.SUBTRACT,oke]]),lke=class extends ys{constructor(t,e=1){super(),this.f=t,this.opacity=new _t(e)}getOpacity(){return this.opacity.value}setOpacity(t){this.opacity.value=t}get blendFunction(){return this.f}set blendFunction(t){this.f=t,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(t){this.blendFunction=t}getShaderCode(){return ake.get(this.blendFunction)}},Yl={NONE:0,DEPTH:1,CONVOLUTION:2},rc=class extends ys{constructor(t,e,{attributes:n=Yl.NONE,blendFunction:i=hn.SCREEN,defines:r=new Map,uniforms:s=new Map,extensions:o=null,vertexShader:a=null}={}){super(),this.name=t,this.renderer=null,this.attributes=n,this.fragmentShader=e,this.vertexShader=a,this.defines=r,this.uniforms=s,this.extensions=o,this.blendMode=new lke(i),this.blendMode.addEventListener("change",l=>this.setChanged())}getName(){return this.name}setRenderer(t){this.renderer=t}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(t){this.attributes=t,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(t){this.fragmentShader=t,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(t){this.vertexShader=t,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(t,e=hu){}update(t,e,n){}setSize(t,e){}initialize(t,e,n){}dispose(){for(let t of Object.keys(this)){let e=this[t];if(e!==null&&typeof e.dispose=="function"){if(e instanceof gf||e===this.renderer)continue;this[t].dispose()}}}};function uW(t,e,n){for(let i of e){let r="$1"+t+i.charAt(0).toUpperCase()+i.slice(1),s=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(let o of n.entries())o[1]!==null&&n.set(o[0],o[1].replace(s,r))}}function cke(t,e,n,i,r,s,o){let a=new Map([["fragment",e.getFragmentShader()],["vertex",e.getVertexShader()]]),l=a.get("fragment")!==void 0&&/mainImage/.test(a.get("fragment")),c=a.get("fragment")!==void 0&&/mainUv/.test(a.get("fragment")),h=[],u=[],d=!1,f=!1;if(a.get("fragment")===void 0)console.error("Missing fragment shader",e);else if(c&&o&Yl.CONVOLUTION)console.error("Effects that transform UV coordinates are incompatible with convolution effects",e);else if(!l&&!c)console.error("The fragment shader contains neither a mainImage nor a mainUv function",e);else{let p=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,v=HI.Section;if(c){let m=`	${t}MainUv(UV);
`;n.set(v.FRAGMENT_MAIN_UV,n.get(v.FRAGMENT_MAIN_UV)+m),d=!0}if(a.get("vertex")!==null&&/mainSupport/.test(a.get("vertex"))){let m=`	${t}MainSupport(`;m+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(a.get("vertex"))?`vUv);
`:`);
`,n.set(v.VERTEX_MAIN_SUPPORT,n.get(v.VERTEX_MAIN_SUPPORT)+m),h=h.concat([...a.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(y=>y[1])),u=u.concat(h).concat([...a.get("vertex").matchAll(p)].map(y=>y[1]))}u=u.concat([...a.get("fragment").matchAll(p)].map(m=>m[1])),u=u.concat([...e.defines.keys()].map(m=>m.replace(/\([\w\s,]*\)/g,""))),u=u.concat([...e.uniforms.keys()]),e.uniforms.forEach((m,y)=>s.set(t+y.charAt(0).toUpperCase()+y.slice(1),m)),e.defines.forEach((m,y)=>r.set(t+y.charAt(0).toUpperCase()+y.slice(1),m)),uW(t,u,r),uW(t,u,a);let g=e.blendMode;if(i.set(g.blendFunction,g),l){let m=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,y=`${t}MainImage(color0, UV, `;o&Yl.DEPTH&&m.test(a.get("fragment"))&&(y+="depth, ",f=!0),y+=`color1);
	`;let _=t+"BlendOpacity";s.set(_,g.opacity),y+=`color0 = blend${g.blendFunction}(color0, color1, ${_});

	`,n.set(v.FRAGMENT_MAIN_IMAGE,n.get(v.FRAGMENT_MAIN_IMAGE)+y),y=`uniform float ${_};

`,n.set(v.FRAGMENT_HEAD,n.get(v.FRAGMENT_HEAD)+y)}n.set(v.FRAGMENT_HEAD,n.get(v.FRAGMENT_HEAD)+a.get("fragment")+`
`),a.get("vertex")!==null&&n.set(v.VERTEX_HEAD,n.get(v.VERTEX_HEAD)+a.get("vertex")+`
`)}return{varyings:h,transformedUv:d,readDepth:f}}var cD=class extends da{constructor(t,...e){super("EffectPass"),this.fullscreenMaterial=new HI(null,null,null,t),this.effects=e.sort((n,i)=>i.attributes-n.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(t){this.fullscreenMaterial.encodeOutput=t}get dithering(){return this.fullscreenMaterial.dithering}set dithering(t){let e=this.fullscreenMaterial;e.dithering=t,e.needsUpdate=!0}verifyResources(){let t=this.renderer.capabilities,e=Math.min(t.maxFragmentUniforms,t.maxVertexUniforms);this.uniformCount>e&&console.warn("The current rendering context doesn't support more than "+e+" uniforms, but "+this.uniformCount+" were defined"),e=t.maxVaryings,this.varyingCount>e&&console.warn("The current rendering context doesn't support more than "+e+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let t=HI.Section,e=new Map([[t.FRAGMENT_HEAD,""],[t.FRAGMENT_MAIN_UV,""],[t.FRAGMENT_MAIN_IMAGE,""],[t.VERTEX_HEAD,""],[t.VERTEX_MAIN_SUPPORT,""]]),n=new Map,i=new Map,r=new Map,s=new Set,o=0,a=0,l=0,c=!1,h=!1;for(let d of this.effects)if(d.blendMode.blendFunction===hn.SKIP)l|=d.getAttributes()&Yl.DEPTH;else if(l&d.getAttributes()&Yl.CONVOLUTION)console.error("Convolution effects cannot be merged",d);else{l|=d.getAttributes();let f="e"+o++,p=cke(f,d,e,n,i,r,l);if(a+=p.varyings.length,c=c||p.transformedUv,h=h||p.readDepth,d.extensions!==null)for(let v of d.extensions)s.add(v)}let u=/\bblend\b/g;for(let d of n.values()){let f=d.getShaderCode().replace(u,`blend${d.blendFunction}`);e.set(t.FRAGMENT_HEAD,e.get(t.FRAGMENT_HEAD)+f+`
`)}if(l&Yl.DEPTH){if(h){let d=`float depth = readDepth(UV);

	`;e.set(t.FRAGMENT_MAIN_IMAGE,d+e.get(t.FRAGMENT_MAIN_IMAGE))}this.needsDepthTexture=this.getDepthTexture()===null}else this.needsDepthTexture=!1;if(c){let d=`vec2 transformedUv = vUv;
`;e.set(t.FRAGMENT_MAIN_UV,d+e.get(t.FRAGMENT_MAIN_UV)),i.set("UV","transformedUv")}else i.set("UV","vUv");e.forEach((d,f,p)=>p.set(f,d.trim().replace(/^#/,`
#`))),this.uniformCount=r.size,this.varyingCount=a,this.skipRendering=o===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(e).setExtensions(s).setUniforms(r).setDefines(i)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(t,e=hu){this.fullscreenMaterial.depthBuffer=t,this.fullscreenMaterial.depthPacking=e;for(let n of this.effects)n.setDepthTexture(t,e)}render(t,e,n,i,r){for(let s of this.effects)s.update(t,e,i);if(!this.skipRendering||this.renderToScreen){let s=this.fullscreenMaterial;s.inputBuffer=e.texture,s.time+=i,t.setRenderTarget(this.renderToScreen?null:n),t.render(this.scene,this.camera)}}setSize(t,e){this.fullscreenMaterial.setSize(t,e);for(let n of this.effects)n.setSize(t,e)}initialize(t,e,n){this.renderer=t;for(let i of this.effects)i.initialize(t,e,n),i.addEventListener("change",r=>this.handleEvent(r));this.updateMaterial(),this.verifyResources(),n!==void 0&&n!==Kr&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let t of this.effects)t.dispose()}handleEvent(t){switch(t.type){case"change":this.recompile();break}}},uke=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],S$=class extends da{constructor({resolutionScale:t=.5,width:e=Ls.AUTO_SIZE,height:n=Ls.AUTO_SIZE,kernelSize:i=zF.LARGE}={}){super("KawaseBlurPass"),this.renderTargetA=new $i(1,1,{minFilter:En,magFilter:En,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let r=this.resolution=new Ls(this,e,n,t);r.addEventListener("change",s=>this.setSize(r.baseWidth,r.baseHeight)),this.blurMaterial=new aW,this.ditheredBlurMaterial=new aW,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=i}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(t){this.resolution.preferredWidth=t}get height(){return this.resolution.height}set height(t){this.resolution.preferredHeight=t}get scale(){return this.blurMaterial.scale}set scale(t){this.blurMaterial.scale=t}getScale(){return this.blurMaterial.scale}setScale(t){this.blurMaterial.scale=t}getKernelSize(){return this.kernelSize}setKernelSize(t){this.kernelSize=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,n,i,r){let s=this.scene,o=this.camera,a=this.renderTargetA,l=this.renderTargetB,c=uke[this.kernelSize],h=this.blurMaterial,u=e,d,f;for(this.fullscreenMaterial=h,d=0,f=c.length-1;d<f;++d){let p=d&1?l:a;h.kernel=c[d],h.inputBuffer=u.texture,t.setRenderTarget(p),t.render(s,o),u=p}this.dithering&&(h=this.ditheredBlurMaterial,this.fullscreenMaterial=h),h.kernel=c[d],h.inputBuffer=u.texture,t.setRenderTarget(this.renderToScreen?null:n),t.render(s,o)}setSize(t,e){let n=this.resolution;n.setBaseSize(t,e);let i=n.width,r=n.height;this.renderTargetA.setSize(i,r),this.renderTargetB.setSize(i,r),this.blurMaterial.setSize(i,r),this.ditheredBlurMaterial.setSize(i,r)}initialize(t,e,n){n!==void 0&&(this.renderTargetA.texture.type=n,this.renderTargetB.texture.type=n,n!==Kr?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):t.outputEncoding===Wt&&(this.renderTargetA.texture.encoding=Wt,this.renderTargetB.texture.encoding=Wt))}static get AUTO_SIZE(){return Ls.AUTO_SIZE}},hke=class extends da{constructor({width:t=Ls.AUTO_SIZE,height:e=Ls.AUTO_SIZE,renderTarget:n,luminanceRange:i,colorOutput:r}={}){super("LuminancePass"),this.fullscreenMaterial=new IUe(r,i),this.needsSwap=!1,this.renderTarget=n,this.renderTarget===void 0&&(this.renderTarget=new $i(1,1,{minFilter:En,magFilter:En,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let s=this.resolution=new Ls(this,t,e);s.addEventListener("change",o=>this.setSize(s.baseWidth,s.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(t,e,n,i,r){let s=this.fullscreenMaterial;s.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){let n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height)}initialize(t,e,n){n!==void 0&&n!==Kr&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},dke=class extends da{constructor(t,e){super("MaskPass",t,e),this.needsSwap=!1,this.clearPass=new LE(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(t){this.inverse=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(t){this.inverted=t}render(t,e,n,i,r){let s=t.getContext(),o=t.state.buffers,a=this.scene,l=this.camera,c=this.clearPass,h=this.inverted?0:1,u=1-h;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.stencil.setFunc(s.ALWAYS,h,4294967295),o.stencil.setClear(u),o.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(t,null):(c.render(t,e),c.render(t,n))),this.renderToScreen?(t.setRenderTarget(null),t.render(a,l)):(t.setRenderTarget(e),t.render(a,l),t.setRenderTarget(n),t.render(a,l)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(s.EQUAL,1,4294967295),o.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.stencil.setLocked(!0)}},Zu=class extends da{constructor(t,e="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=t,this.inputBufferUniform=null,this.setInput(e)}setInput(t){if(this.inputBufferUniform=null,this.fullscreenMaterial!==null){let e=this.fullscreenMaterial.uniforms;e!==void 0&&e[t]!==void 0&&(this.inputBufferUniform=e[t])}}render(t,e,n,i,r){this.inputBufferUniform!==null&&e!==null&&(this.inputBufferUniform.value=e.texture),t.setRenderTarget(this.renderToScreen?null:n),t.render(this.scene,this.camera)}initialize(t,e,n){n!==void 0&&n!==Kr&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},uD=1/1e3,fke=1e3,pke=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(t){return this.fixedDeltaEnabled=t,this}isAutoResetEnabled(t){return this.autoReset}setAutoResetEnabled(t){return typeof document<"u"&&document.hidden!==void 0&&(t?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=t),this}getDelta(){return this.delta*uD}getFixedDelta(){return this.fixedDelta*uD}setFixedDelta(t){return this.fixedDelta=t*fke,this}getElapsed(){return this.elapsed*uD}getTimescale(){return this.timescale}setTimescale(t){return this.timescale=t,this}update(t){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=t!==void 0?t:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(t){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},mke=class{constructor(t=null,{depthBuffer:e=!0,stencilBuffer:n=!1,multisampling:i=0,frameBufferType:r}={}){this.renderer=null,this.inputBuffer=this.createBuffer(e,n,r,i),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new dM,this.depthTexture=null,this.passes=[],this.timer=new pke,this.autoRenderToScreen=!0,this.setRenderer(t)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(t){let e=this.inputBuffer,n=this.multisampling;n>0&&t>0?(this.inputBuffer.samples=t,this.outputBuffer.samples=t,this.inputBuffer.dispose(),this.outputBuffer.dispose()):n!==t&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,t),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(t){if(this.renderer=t,t!==null){let e=t.getSize(new Se),n=t.getContext().getContextAttributes().alpha,i=this.inputBuffer.texture.type;i===Kr&&t.outputEncoding===Wt&&(this.inputBuffer.texture.encoding=Wt,this.outputBuffer.texture.encoding=Wt,this.inputBuffer.dispose(),this.outputBuffer.dispose()),t.autoClear=!1,this.setSize(e.width,e.height);for(let r of this.passes)r.initialize(t,n,i)}}replaceRenderer(t,e=!0){let n=this.renderer,i=n.domElement.parentNode;return this.setRenderer(t),e&&i!==null&&(i.removeChild(n.domElement),i.appendChild(t.domElement)),n}createDepthTexture(){let t=this.depthTexture=new wO;return this.inputBuffer.depthTexture=t,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(t.format=If,t.type=ff):t.type=lh,t}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let t of this.passes)t.setDepthTexture(null)}}createBuffer(t,e,n,i){let r=this.renderer,s=r===null?new Se:r.getDrawingBufferSize(new Se),o={minFilter:En,magFilter:En,stencilBuffer:e,depthBuffer:t,type:n},a=new $i(s.width,s.height,o);return i>0&&(a.ignoreDepthForMultisampleCopy=!1,a.samples=i),n===Kr&&r!==null&&r.outputEncoding===Wt&&(a.texture.encoding=Wt),a.texture.name="EffectComposer.Buffer",a.texture.generateMipmaps=!1,a}addPass(t,e){let n=this.passes,i=this.renderer,r=i.getDrawingBufferSize(new Se),s=i.getContext().getContextAttributes().alpha,o=this.inputBuffer.texture.type;if(t.setRenderer(i),t.setSize(r.width,r.height),t.initialize(i,s,o),this.autoRenderToScreen&&(n.length>0&&(n[n.length-1].renderToScreen=!1),t.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?n.splice(e,0,t):n.push(t),this.autoRenderToScreen&&(n[n.length-1].renderToScreen=!0),t.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){let a=this.createDepthTexture();for(t of n)t.setDepthTexture(a)}else t.setDepthTexture(this.depthTexture)}removePass(t){let e=this.passes,n=e.indexOf(t);if(n!==-1&&e.splice(n,1).length>0){if(this.depthTexture!==null){let i=(r,s)=>r||s.needsDepthTexture;e.reduce(i,!1)||(t.getDepthTexture()===this.depthTexture&&t.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&n===e.length&&(t.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){let t=this.passes;this.deleteDepthTexture(),t.length>0&&(this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!1),this.passes=[])}render(t){let e=this.renderer,n=this.copyPass,i=this.inputBuffer,r=this.outputBuffer,s=!1,o,a,l;t===void 0&&(t=this.timer.update().getDelta());for(let c of this.passes)c.enabled&&(c.render(e,i,r,t,s),c.needsSwap&&(s&&(n.renderToScreen=c.renderToScreen,o=e.getContext(),a=e.state.buffers.stencil,a.setFunc(o.NOTEQUAL,1,4294967295),n.render(e,i,r,t,s),a.setFunc(o.EQUAL,1,4294967295)),l=i,i=r,r=l),c instanceof dke?s=!0:c instanceof GUe&&(s=!1))}setSize(t,e,n){let i=this.renderer;if(t===void 0||e===void 0){let s=i.getSize(new Se);t=s.width,e=s.height}i.setSize(t,e,n);let r=i.getDrawingBufferSize(new Se);this.inputBuffer.setSize(r.width,r.height),this.outputBuffer.setSize(r.width,r.height);for(let s of this.passes)s.setSize(r.width,r.height)}reset(){let t=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(t)}dispose(){for(let t of this.passes)t.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},zF={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},gke=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,vke=class extends rc{constructor({blendFunction:t=hn.SCREEN,luminanceThreshold:e=.9,luminanceSmoothing:n=.025,resolutionScale:i=.5,intensity:r=1,width:s=Ls.AUTO_SIZE,height:o=Ls.AUTO_SIZE,kernelSize:a=zF.LARGE}={}){super("BloomEffect",gke,{blendFunction:t,uniforms:new Map([["map",new _t(null)],["intensity",new _t(r)]])}),this.renderTarget=new $i(1,1,{minFilter:En,magFilter:En,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new hke({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothingFactor=n,this.blurPass=new S$({resolutionScale:i,width:s,height:o,kernelSize:a});let l=this.blurPass.getResolution();l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(t){this.resolution.preferredWidth=t}get height(){return this.resolution.height}set height(t){this.resolution.preferredHeight=t}get dithering(){return this.blurPass.dithering}set dithering(t){this.blurPass.dithering=t}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(t){this.blurPass.kernelSize=t}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(t){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(t){this.uniforms.get("intensity").value=t}getIntensity(){return this.intensity}setIntensity(t){this.intensity=t}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}update(t,e,n){let i=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(t,e,i),this.blurPass.render(t,i,i)):this.blurPass.render(t,e,i)}setSize(t,e){let n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height),this.luminancePass.resolution.copy(n)}initialize(t,e,n){this.blurPass.initialize(t,e,n),n!==void 0&&(this.renderTarget.texture.type=n,t.outputEncoding===Wt&&(this.renderTarget.texture.encoding=Wt))}},yke="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",xke=class extends rc{constructor({blendFunction:t=hn.NORMAL,brightness:e=0,contrast:n=0}={}){super("BrightnessContrastEffect",yke,{blendFunction:t,uniforms:new Map([["brightness",new _t(e)],["contrast",new _t(n)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(t){this.uniforms.get("brightness").value=t}getBrightness(t){return this.brightness}setBrightness(t){this.brightness=t}get contrast(){return this.uniforms.get("contrast").value}set contrast(t){this.uniforms.get("contrast").value=t}getContrast(t){return this.contrast}setContrast(t){this.contrast=t}},_ke="void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",wke=class extends rc{constructor(t=hn.NORMAL){super("ColorAverageEffect",_ke,{blendFunction:t})}},Ske="varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",bke="uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",Ake=class extends rc{constructor({blendFunction:t=hn.NORMAL,offset:e=new Se(.001,5e-4)}={}){super("ChromaticAberrationEffect",Ske,{vertexShader:bke,blendFunction:t,attributes:Yl.CONVOLUTION,uniforms:new Map([["offset",new _t(e)]])})}get offset(){return this.uniforms.get("offset").value}set offset(t){this.uniforms.get("offset").value=t}getOffset(){return this.offset}setOffset(t){this.offset=t}},Mke=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}`,Eke=class extends rc{constructor(t,{blendFunction:e=hn.NORMAL,worldFocusDistance:n,worldFocusRange:i,focusDistance:r=0,focalLength:s=.1,focusRange:o=s,bokehScale:a=1,width:l=Ls.AUTO_SIZE,height:c=Ls.AUTO_SIZE}={}){super("DepthOfFieldEffect",Mke,{blendFunction:e,attributes:Yl.DEPTH,uniforms:new Map([["nearColorBuffer",new _t(null)],["farColorBuffer",new _t(null)],["nearCoCBuffer",new _t(null)],["scale",new _t(1)]])}),this.camera=t,this.renderTarget=new $i(1,1,{minFilter:En,magFilter:En,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new Zu(new SUe(t));let h=this.cocMaterial;h.focusDistance=r,h.focusRange=o,n!==void 0&&(h.worldFocusDistance=n),i!==void 0&&(h.worldFocusRange=i),this.blurPass=new S$({kernelSize:zF.MEDIUM,width:l,height:c});let u=this.blurPass.getResolution();u.addEventListener("change",f=>this.setSize(u.getBaseWidth(),u.getBaseHeight())),this.maskPass=new Zu(new OUe(this.renderTargetCoC.texture));let d=this.maskPass.fullscreenMaterial;d.maskFunction=w$.MULTIPLY,d.colorChannel=x$.GREEN,this.bokehNearBasePass=new Zu(new YS(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new Zu(new YS(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new Zu(new YS(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new Zu(new YS(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=a}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(t){let e=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let n of e)n.fullscreenMaterial.setScale(t);this.maskPass.fullscreenMaterial.setStrength(t),this.uniforms.get("scale").value=t}getBokehScale(){return this.bokehScale}setBokehScale(t){this.bokehScale=t}getTarget(){return this.target}setTarget(t){this.target=t}calculateFocusDistance(t){let e=this.camera,n=e.position.distanceTo(t);return GI(-n,e.near,e.far)}setDepthTexture(t,e=hu){this.circleOfConfusionMaterial.depthBuffer=t,this.circleOfConfusionMaterial.depthPacking=e}update(t,e,n){let i=this.renderTarget,r=this.renderTargetCoC,s=this.renderTargetCoCBlurred,o=this.renderTargetMasked;if(this.target!==null){let a=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=a}this.cocPass.render(t,null,r),this.blurPass.render(t,r,s),this.maskPass.render(t,e,o),this.bokehFarBasePass.render(t,o,i),this.bokehFarFillPass.render(t,i,this.renderTargetFar),this.bokehNearBasePass.render(t,e,i),this.bokehNearFillPass.render(t,i,this.renderTargetNear)}setSize(t,e){let n=this.resolution;n.setBaseSize(t,e);let i=n.width,r=n.height,s=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];s.push(this.renderTargetCoC,this.renderTargetMasked),s.forEach(o=>o.setSize(t,e)),s=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],s.forEach(o=>o.setSize(i,r)),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(o=>o.fullscreenMaterial.setSize(i,r))}initialize(t,e,n){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(i=>i.initialize(t,e,n)),this.blurPass.initialize(t,e,Kr),n!==void 0&&(this.renderTarget.texture.type=n,this.renderTargetNear.texture.type=n,this.renderTargetFar.texture.type=n,this.renderTargetMasked.texture.type=n,t.outputEncoding===Wt&&(this.renderTarget.texture.encoding=Wt,this.renderTargetNear.texture.encoding=Wt,this.renderTargetFar.texture.encoding=Wt,this.renderTargetMasked.texture.encoding=Wt))}};new N;new nt;var Cke="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",Tke=class extends rc{constructor({blendFunction:t=hn.NORMAL,hue:e=0,saturation:n=0}={}){super("HueSaturationEffect",Cke,{blendFunction:t,uniforms:new Map([["hue",new _t(new N)],["saturation",new _t(n)]])}),this.hue=e}get saturation(){return this.uniforms.get("saturation").value}set saturation(t){this.uniforms.get("saturation").value=t}getSaturation(){return this.saturation}setSaturation(t){this.saturation=t}get hue(){let t=this.uniforms.get("hue").value;return Math.acos((t.x*3-1)/2)}set hue(t){let e=Math.sin(t),n=Math.cos(t);this.uniforms.get("hue").value.set((2*n+1)/3,(-Math.sqrt(3)*e-n+1)/3,(Math.sqrt(3)*e-n+1)/3)}getHue(){return this.hue}setHue(t){this.hue=t}};new Rt;var Pke=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,Dke=class extends rc{constructor({blendFunction:t=hn.SCREEN,premultiply:e=!1}={}){super("NoiseEffect",Pke,{blendFunction:t}),this.premultiply=e}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(t){this.premultiply!==t&&(t?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(t){this.premultiply=t}},Rke="uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",Lke=class extends rc{constructor(t=30){super("PixelationEffect",Rke,{uniforms:new Map([["active",new _t(!1)],["d",new _t(new Se)]])}),this.resolution=new Se,this.d=0,this.granularity=t}get granularity(){return this.d}set granularity(t){let e=Math.floor(t);e%2>0&&(e+=1),this.d=e,this.uniforms.get("active").value=e>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(t){this.granularity=t}setSize(t,e){this.resolution.set(t,e),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}};new N;new N;var hW="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",dW="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",Ike="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",Bke="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",vm={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},Oke=class extends rc{constructor({preset:t=vm.MEDIUM,edgeDetectionMode:e=kF.COLOR,predicationMode:n=_$.DISABLED}={}){super("SMAAEffect",Ike,{vertexShader:Bke,blendFunction:hn.NORMAL,attributes:Yl.CONVOLUTION|Yl.DEPTH,uniforms:new Map([["weightMap",new _t(null)]])});let i,r;arguments.length>1&&(i=arguments[0],r=arguments[1],arguments.length>2&&(t=arguments[2]),arguments.length>3&&(e=arguments[3])),this.renderTargetEdges=new $i(1,1,{minFilter:En,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new LE(!0,!1,!1),this.clearPass.overrideClearColor=new Rt(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new Zu(new PUe),this.edgeDetectionMaterial.edgeDetectionMode=e,this.edgeDetectionMaterial.predicationMode=n,this.weightsPass=new Zu(new UUe);let s=new jQ;s.onLoad=()=>{let o=new _r(i);o.name="SMAA.Search",o.magFilter=si,o.minFilter=si,o.generateMipmaps=!1,o.needsUpdate=!0,o.flipY=!0,this.weightsMaterial.searchTexture=o;let a=new _r(r);a.name="SMAA.Area",a.magFilter=En,a.minFilter=En,a.generateMipmaps=!1,a.needsUpdate=!0,a.flipY=!1,this.weightsMaterial.areaTexture=a,this.dispatchEvent({type:"load"})},s.itemStart("search"),s.itemStart("area"),i!==void 0&&r!==void 0?(s.itemEnd("search"),s.itemEnd("area")):typeof Image<"u"&&(i=new Image,r=new Image,i.addEventListener("load",()=>s.itemEnd("search")),r.addEventListener("load",()=>s.itemEnd("area")),i.src=hW,r.src=dW),this.applyPreset(t)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(t){this.edgeDetectionMaterial.edgeDetectionThreshold=t}setOrthogonalSearchSteps(t){this.weightsMaterial.orthogonalSearchSteps=t}applyPreset(t){let e=this.edgeDetectionMaterial,n=this.weightsMaterial;switch(t){case vm.LOW:e.edgeDetectionThreshold=.15,n.orthogonalSearchSteps=4,n.diagonalDetection=!1,n.cornerDetection=!1;break;case vm.MEDIUM:e.edgeDetectionThreshold=.1,n.orthogonalSearchSteps=8,n.diagonalDetection=!1,n.cornerDetection=!1;break;case vm.HIGH:e.edgeDetectionThreshold=.1,n.orthogonalSearchSteps=16,n.diagonalSearchSteps=8,n.cornerRounding=25,n.diagonalDetection=!0,n.cornerDetection=!0;break;case vm.ULTRA:e.edgeDetectionThreshold=.05,n.orthogonalSearchSteps=32,n.diagonalSearchSteps=16,n.cornerRounding=25,n.diagonalDetection=!0,n.cornerDetection=!0;break}}setDepthTexture(t,e=hu){this.edgeDetectionMaterial.depthBuffer=t,this.edgeDetectionMaterial.depthPacking=e}update(t,e,n){this.clearPass.render(t,this.renderTargetEdges),this.edgeDetectionPass.render(t,e,this.renderTargetEdges),this.weightsPass.render(t,this.renderTargetEdges,this.renderTargetWeights)}setSize(t,e){this.edgeDetectionMaterial.setSize(t,e),this.weightsMaterial.setSize(t,e),this.renderTargetEdges.setSize(t,e),this.renderTargetWeights.setSize(t,e)}dispose(){let{searchTexture:t,areaTexture:e}=this.weightsMaterial;t!==null&&e!==null&&(t.dispose(),e.dispose()),super.dispose()}static get searchImageDataURL(){return hW}static get areaImageDataURL(){return dW}},Fke=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,qS={DEFAULT:0,ESKIL:1},Nke=class extends rc{constructor({blendFunction:t=hn.NORMAL,technique:e=qS.DEFAULT,eskil:n=!1,offset:i=.5,darkness:r=.5}={}){super("VignetteEffect",Fke,{blendFunction:t,defines:new Map([["VIGNETTE_TECHNIQUE",e.toFixed(0)]]),uniforms:new Map([["offset",new _t(i)],["darkness",new _t(r)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(t){this.technique!==t&&(this.defines.set("VIGNETTE_TECHNIQUE",t.toFixed(0)),this.setChanged())}get eskil(){return this.technique===qS.ESKIL}set eskil(t){this.technique=t?qS.ESKIL:qS.DEFAULT}getTechnique(){return this.technique}setTechnique(t){this.technique=t}get offset(){return this.uniforms.get("offset").value}set offset(t){this.uniforms.get("offset").value=t}getOffset(){return this.offset}setOffset(t){this.offset=t}get darkness(){return this.uniforms.get("darkness").value}set darkness(t){this.uniforms.get("darkness").value=t}getDarkness(){return this.darkness}setDarkness(t){this.darkness=t}};Wr(0,0,0,0),new Float32Array([0,0,0,0]),Wr(0,0,0,1),new Float32Array([0,0,0,1]),Wr(0,0,1,0),new Float32Array([0,0,1,0]),Wr(0,0,1,1),new Float32Array([0,0,1,1]),Wr(0,1,0,0),new Float32Array([0,1,0,0]),Wr(0,1,0,1),new Float32Array([0,1,0,1]),Wr(0,1,1,0),new Float32Array([0,1,1,0]),Wr(0,1,1,1),new Float32Array([0,1,1,1]),Wr(1,0,0,0),new Float32Array([1,0,0,0]),Wr(1,0,0,1),new Float32Array([1,0,0,1]),Wr(1,0,1,0),new Float32Array([1,0,1,0]),Wr(1,0,1,1),new Float32Array([1,0,1,1]),Wr(1,1,0,0),new Float32Array([1,1,0,0]),Wr(1,1,0,1),new Float32Array([1,1,0,1]),Wr(1,1,1,0),new Float32Array([1,1,1,0]),Wr(1,1,1,1),new Float32Array([1,1,1,1]);function hD(t,e,n){return t+(e-t)*n}function Wr(t,e,n,i){let r=hD(t,e,.75),s=hD(n,i,1-.25);return hD(r,s,1-.125)}var fu=class{constructor(t,e){this.enabled=!1,this.effect=new t(e),Object.defineProperty(this,"opacity",{enumerable:!0,set(n){this.effect.blendMode.opacity.value=n},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(n){this.effect.blendMode.setBlendFunction(Number(n))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=hn.NORMAL}},Uke=class extends fu{constructor(){super(vke),this.blendFunction=hn.SCREEN}set intensity(t){this.effect.intensity=t}get intensity(){return this.effect.intensity}set luminanceThreshold(t){this.effect.luminanceMaterial.threshold=t}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(t){this.effect.luminanceMaterial.smoothing=t}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(t){this.effect.blurPass.scale=t}get blurScale(){return this.effect.blurPass.scale}set kernelSize(t){this.effect.blurPass.kernelSize=t}get kernelSize(){return this.effect.blurPass.kernelSize}},kke=class extends fu{constructor(){super(xke)}set contrast(t){this.effect.uniforms.get("contrast").value=t}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(t){this.effect.uniforms.get("brightness").value=t}get brightness(){return this.effect.uniforms.get("brightness").value}},zke=class extends fu{constructor(){super(Ake),this.effect.offset=new Se(.01,.01)}set offset(t){this.effect.offset.set(t[0]/1e3,t[1]/1e3)}get offset(){return[this.effect.offset.x*1e3,this.effect.offset.y*1e3]}},Gke=class extends fu{constructor(){super(wke)}},Hke=class extends fu{constructor(){super(Tke),this._hue=0}set hue(t){this._hue=t,this.effect.setHue(t)}get hue(){return this._hue}set saturation(t){this.effect.uniforms.get("saturation").value=t}get saturation(){return this.effect.uniforms.get("saturation").value}},Vke=class extends fu{constructor(){super(Dke),this.blendFunction=hn.OVERLAY}},jke=class extends fu{constructor(){super(Nke)}get eskil(){return this.effect.eskil}set eskil(t){this.effect.eskil=t}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(t){this.effect.uniforms.get("darkness").value=t}get offset(){return this.effect.uniforms.get("offset").value}set offset(t){this.effect.uniforms.get("offset").value=t}},Wke=class extends fu{constructor(t){super(Eke,t)}set focalLength(t){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=t}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(t){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=t}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(t){this.effect.bokehScale=t}},Xke=class extends fu{constructor(){super(Lke)}get granularity(){return this.effect.getGranularity()}set granularity(t){this.effect.setGranularity(t)}},Yke=class extends da{constructor(t,e,n){super("TransmissionPass",t,e),this.copyPass=new dM(n.transmissionRenderTarget),this.depthPass=new cW(t,e,{renderTarget:n.transmissionDepthTarget}),this.needsSwap=!1}updatePasses(t){this.copyPass=new dM(t.transmissionRenderTarget),this.depthPass=new cW(this.scene,this.camera,{renderTarget:t.transmissionDepthTarget})}setCamera(t){this.camera=t}setScene(t){this.scene=t}render(t,e,n){let i=this.camera.layers.mask;this.copyPass.render(t,e,n),this.camera.layers.disable(3),this.depthPass.render(t,e,n),t.shadowMap.needsUpdate=!1,t.shadowMap.autoUpdate=!1;let r=this.renderToScreen?null:e;this.camera.layers.set(3),t.setRenderTarget(r),t.render(this.scene,this.camera),this.camera.layers.mask=i}},fW=new gf,qke=new nr({transparent:!0,vertexShader:`
        void main() {
            gl_Position = vec4(0.0);
        }
    `,fragmentShader:`
        void main() {
            gl_FragColor = vec4(0.0);
        }
    `}),dD=class extends da{constructor(t,e){super("OpaquePass",t??fW,e),this.hasTransmissionPass=!1,this.clear=!0,this.needsSwap=!1,this.originalMaterials=new Map}setCamera(t){this.camera=t}setScene(t){this.scene=t??fW}getScene(){return this.scene}render(t,e){this.originalMaterials.clear(),this.camera.layers.enable(3),this.hasTransmissionPass&&this.scene.traverse(i=>{i.layers.isEnabled(3)&&i instanceof zs&&(this.originalMaterials.set(i.id,i.material),i.material=qke)}),this.camera.layers.enable(8),t.shadowMap.needsUpdate=!0,t.shadowMap.autoUpdate=!0;let n=this.renderToScreen?null:e;t.setRenderTarget(n),this.clear&&t.clear(),t.render(this.scene,this.camera),this.hasTransmissionPass&&this.originalMaterials.forEach((i,r)=>{let s=this.scene.getObjectById(r);s&&(s.material=i)})}};function pW(t,e){return e&&e.enabled&&t.push(e.effect),t}var Qke=t=>Object.values(hn).includes(t)?t:hn.NORMAL,Kke=class extends ys{constructor(t){super(),this.postprocessingState=Ox.defaultData,this._scene=new gf,this._camera=new Us,this.effects=new Map,this._renderToScreen=!0,this.clock=new Jbe,this.renderer=t,this.debug=!1,this.effects.set("bloom",new Uke),this.effects.set("chromaticAberration",new zke),this.effects.set("vignette",new jke),this.effects.set("noise",new Vke),this.effects.set("colorAverage",new Gke),this.effects.set("hueSaturation",new Hke),this.effects.set("brightnessContrast",new kke),this.effects.set("depthOfField",new Wke),this.effects.set("pixelation",new Xke),this.effectComposer=new mke(this.renderer),this.opaquePass=new dD(this.scene,this.camera),this.transmissionPass=new Yke(this.scene,this.camera,this.renderer),this.helperPass=new dD(void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperClearPass=new LE(!1,!0,!1),this.helperPassOnTop=new dD(void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this._initCopyPass(),this._initSmaa(),this._initPasses()}get scene(){return this._scene}set scene(t){this._scene=t,this.opaquePass.setScene(t),this.transmissionPass.setScene(t)}set sceneHelpers(t){this.helperPass.setScene(t)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(t){this.helperPassOnTop.setScene(t)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}get camera(){return this._camera}set camera(t){this._camera=t,this.opaquePass.setCamera(t),this.transmissionPass.setCamera(t),this.helperPass.setCamera(t),this.helperPassOnTop.setCamera(t)}setTransmissionPassEnabled(t){this.transmissionPass.enabled=t,this.opaquePass.hasTransmissionPass=t}disableHelpers(){this.helperPass.enabled=!1,this.helperClearPass.enabled=!1,this.helperPassOnTop.enabled=!1}enableHelpers(){this.helperPass.enabled=!0,this.helperClearPass.enabled=!0,this.helperPassOnTop.enabled=!0}_initSmaa(){let t=new Oke({preset:vm.ULTRA,edgeDetectionMode:kF.COLOR}),e=()=>{t.removeEventListener("load",e),this.dispatchEvent({type:"smaaloaded"})};t.addEventListener("load",e),t.edgeDetectionMaterial.predicationMode=_$.DEPTH,t.edgeDetectionMaterial.edgeDetectionThreshold=.05,t.edgeDetectionMaterial.predicationThreshold=.002,t.edgeDetectionMaterial.predicationScale=1,this.smaaPass=new cD(this.camera,t)}_initPasses(){var t,e;if((t=this.uvEffectPass)==null||t.dispose(),(e=this.effectPass)==null||e.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.postprocessingState.enabled){let n=[this.effects.get("pixelation")].reduce(pW,[]);n.length>0&&(this.uvEffectPass=new cD(this.camera,...n),this.effectComposer.addPass(this.uvEffectPass));let i=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(pW,[]);i.length>0&&(this.effectPass=new cD(this.camera,...i),this.effectComposer.addPass(this.effectPass))}this.effectComposer.addPass(this.helperPass),this.effectComposer.addPass(this.helperClearPass),this.effectComposer.addPass(this.helperPassOnTop),this.effectComposer.addPass(this.smaaPass)}_initCopyPass(){if(this._savePass)return;let t=new Se;this.renderer.getDrawingBufferSize(t),this._rt=new $i(t.x,t.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:Sx,wrapT:Sx}),this._rt.samples=0,this._savePass=new dM(this._rt,!1),this._savePass.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(t){if(this._renderToScreen===t)return;let e=this.effectComposer;!e||(t===!0?(e.removePass(this._savePass),e.passes[e.passes.length-1].renderToScreen=!0,e.autoRenderToScreen=!0):(e.autoRenderToScreen=!1,e.passes[e.passes.length-1].renderToScreen=!1,this._savePass.renderToScreen=!1,this.postprocessingState.enabled||(this._savePass.needsDepthTexture=!0),e.addPass(this._savePass)),this._renderToScreen=t)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(t){let{enabled:e,...n}=t,i=!1;e!==this.postprocessingState.enabled&&(i=!0);for(let r of Object.entries(n)){let s=r[1],o=this.effects.get(r[0]);if(o){o.enabled!==s.enabled&&(i=!0),o.enabled=s.enabled;for(let[a,l]of Object.entries(s))a==="blendFunction"?o.blendFunction=Qke(l):o[a]=l}}this.postprocessingState=t,i&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(t,e,n,i){t instanceof Zt?(this.effectComposer.inputBuffer.scissor.set(t.x,t.y,t.z,t.w),this.effectComposer.outputBuffer.scissor.set(t.x,t.y,t.z,t.w)):(this.effectComposer.inputBuffer.scissor.set(t,e,n,i),this.effectComposer.outputBuffer.scissor.set(t,e,n,i));let r=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(r),this.effectComposer.outputBuffer.scissor.multiplyScalar(r),this.renderer.setScissor(t,e,n,i)}setScissorTest(t){this.effectComposer.inputBuffer.scissorTest=t,this.effectComposer.outputBuffer.scissorTest=t,this.renderer.setScissorTest(t)}setViewport(t,e,n,i){t instanceof Zt?(this.effectComposer.inputBuffer.viewport.copy(t),this.effectComposer.outputBuffer.viewport.copy(t)):(this.effectComposer.inputBuffer.viewport.set(t,e,n,i),this.effectComposer.outputBuffer.viewport.set(t,e,n,i))}resize(t,e,n){if(this.effectComposer.setSize(t,e,n),this._rt){let i=this.renderer.getPixelRatio();this._rt.setSize(t*i,e*i)}}dispose(){var t,e;(t=this.uvEffectPass)==null||t.dispose(),(e=this.effectPass)==null||e.dispose(),this.effectComposer.dispose()}},mW=new _r,Jke=class extends RQ{constructor(t){super(t),this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new Se,this.pipeline=new Kke(this),this.overrideTransmission=t==null?void 0:t.overrideTransmission,this.autoClear=!1;let e=this.setPixelRatio.bind(this),n=this.setSize.bind(this),i=this.getContext();if(i&&"drawingBufferColorSpace"in i)try{i.drawingBufferColorSpace="display-p3"}catch(r){console.warn(r)}this.setPixelRatio=r=>{this._pixelRatio=r,e(r)},this.setSize=(r,s,o=!0)=>{var a,l,c;(this.viewportWidth!==r||this.viewportHeight!==s)&&(this.viewportWidth=r,this.viewportHeight=s,n(r,s,o),(a=this.normalRenderTarget)==null||a.setSize(r*this._pixelRatio,s*this._pixelRatio),(l=this.transmissionRenderTarget)==null||l.setSize(r*this._pixelRatio/2,s*this._pixelRatio/2),(c=this.transmissionDepthTarget)==null||c.setSize(r*this._pixelRatio/2,s*this._pixelRatio/2),this.pipeline.resize(r,s,o))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createTransmissionRenderTarget(){this.transmissionRenderTarget===void 0&&(this.transmissionRenderTarget=new $i(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{generateMipmaps:!0,minFilter:Ug,magFilter:En,wrapS:to,wrapT:to,depthBuffer:!1}),this.transmissionDepthTarget=new $i(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:si,magFilter:si,depthBuffer:!1}))}createNormalRenderTarget(){this.normalRenderTarget===void 0&&(this.normalRenderTarget=new $i(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:si,magFilter:si,type:ch,depthTexture:new wO(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(t,e){this.normalRenderTarget&&(this.setClearColor(0),e.layers.enable(8),e.layers.disable(0),e.layers.disable(3),this.setRenderTarget(this.normalRenderTarget),this.clear(),e instanceof Us?j2.uniforms.depthContrast.value=(e.far-e.near)/1e4:j2.uniforms.depthContrast.value=1,t.overrideMaterial=j2,this.render(t,e),this.setClearColor(t.bgColor,t.bgColor.a),this.setRenderTarget(null),t.overrideMaterial=t.wireframeState?DI:null,e.layers.enable(0),e.layers.enable(3))}renderSplineScene(t,e,n,i,r){this.setClearColor(t.bgColor,t.bgColor.a),n.penumbraSize.forEach((o,a)=>{ei.penumbraSize.value[a]=o}),ei.pixelRatioNode.value=this.getPixelRatio(),this.resolution.x!==0&&this.resolution.y!==0?ei.resolution.value.set(this.resolution.x,this.resolution.y):ei.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),this.overrideNormal!==void 0?(ei.normalRenderTarget.value=this.overrideNormal,ei.normalRenderTargetDepth.value=mW):t.needsNormal()&&(this.createNormalRenderTarget(),ei.normalRenderTarget.value=this.normalRenderTarget.texture,ei.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(t,e));let s=!1;if(this.overrideTransmission!==void 0)ei.transmissionRenderTarget.value=this.overrideTransmission,ei.transmissionRenderTargetDepth.value=mW,this.pipeline.setTransmissionPassEnabled(!1);else{let o=t.needsTransmission();o&&(this.transmissionRenderTarget===void 0&&(s=!0),this.createTransmissionRenderTarget(),ei.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,ei.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(o)}e.layers.enable(3),e.layers.enable(8),this.pipeline.sceneHelpers=i,this.pipeline.sceneHelpersOnTop=r,this.pipeline.scene=t,this.pipeline.camera=e,s&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==t.postprocessing&&this.pipeline.updatePostprocessing(t.postprocessing),this.clearAlphaOverride!==void 0&&this.setClearAlpha(this.clearAlphaOverride),t.overrideMaterial=t.wireframeState?DI:null,this.pipeline.render()}_currentDispose(){var t,e,n,i,r;this._superDispose(),this.pipeline.dispose(),(t=this.transmissionRenderTarget)==null||t.dispose(),(e=this.transmissionDepthTarget)==null||e.dispose(),(n=this.normalRenderTarget)==null||n.dispose(),(r=(i=this.normalRenderTarget)==null?void 0:i.depthTexture)==null||r.dispose()}},Zke=class{get sharedAssets(){return this.shared}constructor(t,e={}){this.shared=new EE(t.shared,e),this.scene=new Xl(t.scene,this.sharedAssets),this.scene.switchActiveCamera(this.scene.activeCamera)}reset(t,e){this.scene.clearScene(),this.sharedAssets.reset(t.shared),this.scene.resetAfterClear(t.scene,this.sharedAssets)}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity(t=>{t instanceof ua&&t.markGeometryAsReachable(this.shared)}),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},$ke=class{constructor({x:t=10,y:e=10}){this._startTime=0;let n=document.getElementById("spe-perfs");n?this.element=n:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left=`${t}px`,this.element.style.top=`${e}px`}dispose(){var t;(t=this.element.parentElement)==null||t.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let t=performance.now()-this._startTime;this.element.innerHTML=t.toFixed(3)+" ms"}};function eze(t){let e;if(t.index)for(let n=0;n<t.index.array.length;n+=3)e=t.index.array[n],t.index.array[n]=t.index.array[n+2],t.index.array[n+2]=e}function Uy(t){return t instanceof kx?"SubdivObject":t.geometry.type==="NonParametricGeometry"?"NonParametric":"Mesh"}function tze(t,e){let n={};return t.traverseEntity(i=>{var l;if(!i.visible||!(i instanceof zs)||i.type!=="Mesh"||Array.isArray(i.material)||i.states&&Object.keys(i.states).length)return;let r=i.parent;for(;r;){if(r instanceof zs&&i.states&&Object.keys(i.states).length)return;r=r.parent}let s=i.material.uuid,o=e.shared.materials[s];if(o){if(!vo.isMergable(o))return}else{let c=(l=e.scene.objects.get(i.uuid))==null?void 0:l.data;if(c&&"material"in c&&typeof c.material!="string"){if(!vo.isMergable(c.material))return;s=vo.getHash(c.material)}}n[s]||(n[s]={});let a=n[s][Uy(i)];if(a){if(a.push(i),i.cloner)for(let c of i.cloner.children)a.push(c)}else if(n[s][Uy(i)]=[i],i.cloner)for(let c of i.cloner.children)n[s][Uy(i)].push(c)}),n}function nze(t){let e=0;return Object.values(t).forEach(n=>{Object.values(n).forEach(i=>{let r=i.length;r>e&&(e=r)})}),e}function ize(t,e){let n=tze(e,t),i=nze(n),r=new Array(i),s=0,o=new Array(i),a=0,l=new Array(i),c=0,h=new Array(i),u=0;for(let[d,f]of Object.entries(n))for(let p of Object.values(f)){if(a=0,c=0,p.forEach(g=>{g instanceof zs&&(o[a++]=g.geometry.clone(),l[c++]=g)}),c<2)continue;for(let g=0;g<c;g++)l[g].updateWorldMatrix(!0,!1),o[g].applyMatrix4(l[g].matrixWorld),l[g].matrixWorld.determinant()<0&&eze(o[g]);let v=Hm(o.slice(0,a),!1);if(v){let g;switch(d){case"SubdivObject":{console.warn("Turning subdiv object into mesh"),g=new ao(v,l[0].material);break}default:{g=new ao(v,l[0].material);break}}g.castShadow=l[0].castShadow,g.receiveShadow=l[0].receiveShadow,e.add(g);let m=y=>{u=0;for(let _ of y)_.children&&m(_.children),_ instanceof zs&&(Array.isArray(_.material)||n[_.material.uuid]&&n[_.material.uuid][Uy(_)]&&n[_.material.uuid][Uy(_)].length>1||(h[u++]=_));for(let _=0;_<u;_++)e.attach(h[_])};for(let y=0;y<c;y++){let _=l[y];m(_.children),r[s++]=_}}}for(let d=0;d<s;d++)r[d].removeFromParent()}var rze=b1(rye(),1),sze=new Se;function oze(t){let e="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";t.endsWith(".spline")?console.warn(e+" The .spline files are only meant to be used by the Editor."):t.endsWith(".splinecode")||console.warn(e)}var aze=class{constructor(t,{renderOnDemand:e=!0}={}){this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._lastTime=performance.now(),this.time=performance.now(),this.dt=0,this._skipRender=!1,this.renderOnDemand=!0,this.disposed=!1,this.requestRender=()=>{this._skipRender=!1},this.render=n=>{var i,r,s;!this._renderer||(this._rafId=requestAnimationFrame(this.render),this.time=n,this.dt=this.time-this._lastTime,this._lastTime=this.time,(i=this._perfs)==null||i.start(),!(this.renderOnDemand&&this._skipRender)&&(this._skipRender=((r=this._controls)==null?void 0:r.update(this.dt))??!0,this._eventManager&&(this._eventManager.isEnable||this._eventManager.activate(),this._eventManager.handlers.Follow.onAnimationFrameDamping(),this._eventManager.handlers.LookAt.onAnimationFrameDamping(),this._eventManager.handlers.DragDrop.onAnimationFrameDamping(),(this._eventManager.handlers.Start.hasVideoAction||this._eventManager.handlers.Basic.hasVideoAction||this._eventManager.handlers.Conditional.hasVideoAction)&&(this._skipRender=!1)),this._scene&&this._camera&&(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.renderSplineScene(this._scene,this._camera,this._sharedAssetsManager)),(s=this._perfs)==null||s.end()))},this._resize=YO(()=>{var n;!this._renderer||(this._viewportMode===1&&this._frameView&&(this._frameView.frameSize=sze.set(this._viewportWidth,this._viewportHeight)),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._camera&&((n=this._frameView)==null||n.updateCamera(),this._camera.cameraType==="PerspectiveCamera"&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()),this.requestRender())},10),this.canvas=t,this.renderOnDemand=e,window.location.search.includes("perfs")&&(this._perfs=new $ke({x:10,y:10})),eLe(t)}async load(t,e){oze(t),this.disposed=!1;let n=await(await fetch(t,e)).arrayBuffer();await this.start(n)}async start(t,{interactive:e=!0}={}){var r;if(this.disposed)return;let n=await gUe(t);this._data=n,n.version&&(0,rze.default)(n.version,"0.9.314")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),await Promise.all([c6(n)&&I3e(),jBe(n)&&D3e(),n.scene.environment.usePhysics&&yRe(),r6(n)&&LBe()].filter(Boolean)),this._eventManager&&this._eventManager.deactivate(),this._controls&&this._controls.dispose(),(r=this._scene)==null||r.dispose();let i=new Zke(n);if(this._scene=i.scene,this._sharedAssetsManager=i.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let s=performance.now();ize(n,i.scene);let o=performance.now();console.log("Merged geometries in ",o-s," ms")}if(c6(n)&&this._scene.traverse(s=>{Hc(s)&&s.recomputeBoolean()}),this._sharedAssetsManager.setRequestRender(()=>{var s;this.requestRender(),(s=this._scene)==null||s.traverse(o=>{o instanceof rf&&o.pendingMediaLoad&&o.update()})}),r6(n)&&XNe(n)){let s=Object.keys(n.shared.fonts).map(o=>this._sharedAssetsManager.getFont(o)).map(o=>o.loadingPromise);await Promise.all(s)}if(this._scene.rewriteEventsBeforeGoToPlayMode(),u$(n.scene,this._scene,this._sharedAssetsManager),this._renderer||(this._renderer=new Jke({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.addEventListener("smaaloaded",this.requestRender),this._renderer.shadowMap.enabled=!0,this._renderer.shadowMap.type=n.scene.environment.ambientLight.softShadows?mO:hQ,POe(n.scene.environment.ambientLight.softShadowQuality)),this._frameView)this._frameView.setCamera(this._camera);else{let s=Object.values(n.frames)[0];s.preset==="fullscreen"?(this._viewportMode=1,this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=s.size[0],this._viewportHeight=s.size[1],this.canvas.style.width=`${this._viewportWidth}px`,this.canvas.style.height=`${this._viewportHeight}px`),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new yUe(this._renderer,this._camera,new Se(this._viewportWidth,this._viewportHeight),new Se(window.innerWidth,window.innerHeight))}if(e&&(this._scene.updateMatrixWorld(!0),this._controls=new YNe(n,this._scene,this._renderer,this.requestRender,this._sharedAssetsManager,!0),this._eventManager=new vUe(this._renderer,this._scene,this._camera,n.scene.publish,this._sharedAssetsManager,this.requestRender,this._controls,!0),this._controls.init(this._eventManager)),this._resize(),!this._resizeObserver&&this.canvas.parentElement){let s=!0;this._resizeObserver=new ResizeObserver(()=>{if(s){s=!1;return}this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._resize()}),this._resizeObserver.observe(this.canvas.parentElement)}this._rafId===void 0?this.render(performance.now()):this.requestRender()}findObjectById(t){var n;let e=(n=this._scene)==null?void 0:n.getObjectByProperty("uuid",t);return this._createProxyObject(e)}findObjectByName(t){var n;let e=(n=this._scene)==null?void 0:n.getObjectByName(t);return this._createProxyObject(e)}getSplineEvents(){var t;return((t=this._eventManager)==null?void 0:t.handlers.Spline).splineEvents}emitEvent(t,e){var n;(n=this.findObjectById(e)||this.findObjectByName(e))==null||n.emitEvent(t)}emitEventReverse(t,e){var n;(n=this.findObjectById(e)||this.findObjectByName(e))==null||n.emitEventReverse(t)}addEventListener(t,e){this.canvas.addEventListener(t,e)}removeEventListener(t,e){this.canvas.removeEventListener(t,e)}setZoom(t){var e,n;((e=this._controls)==null?void 0:e.orbitControls)instanceof y$&&((n=this._controls)==null||n.orbitControls.zoomOut(t))}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(t,e){this._viewportWidth=t,this._viewportHeight=e,this._viewportMode=2,this._resize()}setBackgroundColor(t){var o;let{r:e,g:n,b:i,a:r}={r:0,g:0,b:0,a:1},s=new Ns(e,n,i,r);try{s.setStyle(t)}catch{console.error("This is not a valid css color",t)}(o=this._scene)==null||o.setBackgroundColor(s),this.requestRender()}dispose(){var t,e,n,i,r,s;this.disposed=!0,(t=this._eventManager)==null||t.deactivate(),(e=this._scene)==null||e.dispose(),(n=this._sharedAssetsManager)==null||n.dispose(),this._rafId&&cancelAnimationFrame(this._rafId),this._proxyObjectCache.forEach(o=>{zV.unsubscribe(o)}),(i=this._renderer)==null||i.dispose(),(r=this._sharedAssetsManager)==null||r.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),(s=this._controls)==null||s.dispose(),tLe(this.canvas)}get data(){return this._data}_createProxyObject(t){if(t==null)return;if(this._proxyObjectCache.has(t.uuid))return this._proxyObjectCache.get(t.uuid);let e={name:t.name,uuid:t.uuid,visible:t.visible,intensity:t.intensity,position:t.position,rotation:t.rotation,scale:t.scale,emitEvent(i){t.dispatchEvent({type:"userEvent",eventName:i})},emitEventReverse(i){t.dispatchEvent({type:"userEvent",eventName:i,reverse:!0})}},n=zV(e,(i,r)=>{var s;typeof t[i]!="object"&&((s=Object.getOwnPropertyDescriptor(t,i))!=null&&s.writable)&&(t[i]=r),this.requestRender(),t.updateMatrix()});return this._proxyObjectCache.set(t.uuid,n),n}},QS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},VI={},lze={get exports(){return VI},set exports(t){VI=t}},V0={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gW;function cze(){if(gW)return V0;gW=1;var t=Wh,e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,r=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(a,l,c){var h,u={},d=null,f=null;c!==void 0&&(d=""+c),l.key!==void 0&&(d=""+l.key),l.ref!==void 0&&(f=l.ref);for(h in l)i.call(l,h)&&!s.hasOwnProperty(h)&&(u[h]=l[h]);if(a&&a.defaultProps)for(h in l=a.defaultProps,l)u[h]===void 0&&(u[h]=l[h]);return{$$typeof:e,type:a,key:d,ref:f,props:u,_owner:r.current}}return V0.Fragment=n,V0.jsx=o,V0.jsxs=o,V0}(function(t){t.exports=cze()})(lze);const jI=VI.jsx;var uze="Expected a function",vW=0/0,hze="[object Symbol]",dze=/^\s+|\s+$/g,fze=/^[-+]0x[0-9a-f]+$/i,pze=/^0b[01]+$/i,mze=/^0o[0-7]+$/i,gze=parseInt,vze=typeof QS=="object"&&QS&&QS.Object===Object&&QS,yze=typeof self=="object"&&self&&self.Object===Object&&self,xze=vze||yze||Function("return this")(),_ze=Object.prototype,wze=_ze.toString,Sze=Math.max,bze=Math.min,fD=function(){return xze.Date.now()};function Aze(t,e,n){var i,r,s,o,a,l,c=0,h=!1,u=!1,d=!0;if(typeof t!="function")throw new TypeError(uze);e=yW(e)||0,WI(n)&&(h=!!n.leading,u="maxWait"in n,s=u?Sze(yW(n.maxWait)||0,e):s,d="trailing"in n?!!n.trailing:d);function f(b){var T=i,M=r;return i=r=void 0,c=b,o=t.apply(M,T),o}function p(b){return c=b,a=setTimeout(m,e),h?f(b):o}function v(b){var T=b-l,M=b-c,E=e-T;return u?bze(E,s-M):E}function g(b){var T=b-l,M=b-c;return l===void 0||T>=e||T<0||u&&M>=s}function m(){var b=fD();if(g(b))return y(b);a=setTimeout(m,v(b))}function y(b){return a=void 0,d&&i?f(b):(i=r=void 0,o)}function _(){a!==void 0&&clearTimeout(a),c=0,i=l=r=a=void 0}function S(){return a===void 0?o:y(fD())}function A(){var b=fD(),T=g(b);if(i=arguments,r=this,l=b,T){if(a===void 0)return p(l);if(u)return a=setTimeout(m,e),f(l)}return a===void 0&&(a=setTimeout(m,e)),o}return A.cancel=_,A.flush=S,A}function WI(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function Mze(t){return!!t&&typeof t=="object"}function Eze(t){return typeof t=="symbol"||Mze(t)&&wze.call(t)==hze}function yW(t){if(typeof t=="number")return t;if(Eze(t))return vW;if(WI(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=WI(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(dze,"");var n=pze.test(t);return n||mze.test(t)?gze(t.slice(2),n?2:8):fze.test(t)?vW:+t}var Cze=Aze;function Tze(t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}const Pze=[],Dze={width:"100%",height:"100%"},Rze=ge.forwardRef(function({className:t,children:e,debounceTime:n=300,ignoreDimensions:i=Pze,parentSizeStyles:r,enableDebounceLeadingCall:s=!0,resizeObserverPolyfill:o,...a},l){const c=ge.useRef(null),h=ge.useRef(0),[u,d]=ge.useState({width:0,height:0,top:0,left:0}),f=ge.useMemo(()=>{const p=Array.isArray(i)?i:[i];return Cze(v=>{d(g=>Object.keys(g).filter(m=>g[m]!==v[m]).every(m=>p.includes(m))?g:v)},n,{leading:s})},[n,s,i]);return ge.useEffect(()=>{const p=o||window.ResizeObserver,v=new p(g=>{g.forEach(m=>{const{left:y,top:_,width:S,height:A}=(m==null?void 0:m.contentRect)??{};h.current=window.requestAnimationFrame(()=>{f({width:S,height:A,top:_,left:y})})})});return c.current&&v.observe(c.current),()=>{window.cancelAnimationFrame(h.current),v.disconnect(),f.cancel()}},[f,o]),jI("div",{style:{...Dze,...r},ref:Tze([l,c]),className:t,...a,children:e({...u,ref:c.current,resize:f})})}),xW=ge.forwardRef(({scene:t,style:e,onMouseDown:n,onMouseUp:i,onMouseHover:r,onKeyDown:s,onKeyUp:o,onStart:a,onLookAt:l,onFollow:c,onWheel:h,onLoad:u,renderOnDemand:d=!0,...f},p)=>{const v=ge.useRef(null),[g,m]=ge.useState(!0);return ge.useEffect(()=>{m(!0);let y;const _=[{name:"mouseDown",cb:n},{name:"mouseUp",cb:i},{name:"mouseHover",cb:r},{name:"keyDown",cb:s},{name:"keyUp",cb:o},{name:"start",cb:a},{name:"lookAt",cb:l},{name:"follow",cb:c},{name:"scroll",cb:h}];if(v.current){y=new aze(v.current,{renderOnDemand:d});async function S(){await y.load(t);for(let A of _)A.cb&&y.addEventListener(A.name,A.cb);m(!1),u==null||u(y)}S()}return()=>{for(let S of _)S.cb&&y.removeEventListener(S.name,S.cb);y.dispose()}},[t]),jI(Rze,{ref:p,parentSizeStyles:e,debounceTime:50,...f,children:()=>jI("canvas",{ref:v,style:{display:g?"none":"block"}})})});var b$={exports:{}},In={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sr=typeof Symbol=="function"&&Symbol.for,GF=Sr?Symbol.for("react.element"):60103,HF=Sr?Symbol.for("react.portal"):60106,IE=Sr?Symbol.for("react.fragment"):60107,BE=Sr?Symbol.for("react.strict_mode"):60108,OE=Sr?Symbol.for("react.profiler"):60114,FE=Sr?Symbol.for("react.provider"):60109,NE=Sr?Symbol.for("react.context"):60110,VF=Sr?Symbol.for("react.async_mode"):60111,UE=Sr?Symbol.for("react.concurrent_mode"):60111,kE=Sr?Symbol.for("react.forward_ref"):60112,zE=Sr?Symbol.for("react.suspense"):60113,Lze=Sr?Symbol.for("react.suspense_list"):60120,GE=Sr?Symbol.for("react.memo"):60115,HE=Sr?Symbol.for("react.lazy"):60116,Ize=Sr?Symbol.for("react.block"):60121,Bze=Sr?Symbol.for("react.fundamental"):60117,Oze=Sr?Symbol.for("react.responder"):60118,Fze=Sr?Symbol.for("react.scope"):60119;function Ao(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case GF:switch(t=t.type,t){case VF:case UE:case IE:case OE:case BE:case zE:return t;default:switch(t=t&&t.$$typeof,t){case NE:case kE:case HE:case GE:case FE:return t;default:return e}}case HF:return e}}}function A$(t){return Ao(t)===UE}In.AsyncMode=VF;In.ConcurrentMode=UE;In.ContextConsumer=NE;In.ContextProvider=FE;In.Element=GF;In.ForwardRef=kE;In.Fragment=IE;In.Lazy=HE;In.Memo=GE;In.Portal=HF;In.Profiler=OE;In.StrictMode=BE;In.Suspense=zE;In.isAsyncMode=function(t){return A$(t)||Ao(t)===VF};In.isConcurrentMode=A$;In.isContextConsumer=function(t){return Ao(t)===NE};In.isContextProvider=function(t){return Ao(t)===FE};In.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===GF};In.isForwardRef=function(t){return Ao(t)===kE};In.isFragment=function(t){return Ao(t)===IE};In.isLazy=function(t){return Ao(t)===HE};In.isMemo=function(t){return Ao(t)===GE};In.isPortal=function(t){return Ao(t)===HF};In.isProfiler=function(t){return Ao(t)===OE};In.isStrictMode=function(t){return Ao(t)===BE};In.isSuspense=function(t){return Ao(t)===zE};In.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===IE||t===UE||t===OE||t===BE||t===zE||t===Lze||typeof t=="object"&&t!==null&&(t.$$typeof===HE||t.$$typeof===GE||t.$$typeof===FE||t.$$typeof===NE||t.$$typeof===kE||t.$$typeof===Bze||t.$$typeof===Oze||t.$$typeof===Fze||t.$$typeof===Ize)};In.typeOf=Ao;b$.exports=In;var jF=b$.exports;function Nze(t){function e(z,X,q,re,G){for(var K=0,oe=0,ve=0,$=0,se,ne,ie=0,me=0,xe,Ae=xe=se=0,we=0,Ee=0,Re=0,Ue=0,Ne=q.length,U=Ne-1,L,te="",_e="",Te="",Ie="",Qe;we<Ne;){if(ne=q.charCodeAt(we),we===U&&oe+$+ve+K!==0&&(oe!==0&&(ne=oe===47?10:47),$=ve=K=0,Ne++,U++),oe+$+ve+K===0){if(we===U&&(0<Ee&&(te=te.replace(d,"")),0<te.trim().length)){switch(ne){case 32:case 9:case 59:case 13:case 10:break;default:te+=q.charAt(we)}ne=59}switch(ne){case 123:for(te=te.trim(),se=te.charCodeAt(0),xe=1,Ue=++we;we<Ne;){switch(ne=q.charCodeAt(we)){case 123:xe++;break;case 125:xe--;break;case 47:switch(ne=q.charCodeAt(we+1)){case 42:case 47:e:{for(Ae=we+1;Ae<U;++Ae)switch(q.charCodeAt(Ae)){case 47:if(ne===42&&q.charCodeAt(Ae-1)===42&&we+2!==Ae){we=Ae+1;break e}break;case 10:if(ne===47){we=Ae+1;break e}}we=Ae}}break;case 91:ne++;case 40:ne++;case 34:case 39:for(;we++<U&&q.charCodeAt(we)!==ne;);}if(xe===0)break;we++}switch(xe=q.substring(Ue,we),se===0&&(se=(te=te.replace(u,"").trim()).charCodeAt(0)),se){case 64:switch(0<Ee&&(te=te.replace(d,"")),ne=te.charCodeAt(1),ne){case 100:case 109:case 115:case 45:Ee=X;break;default:Ee=Z}if(xe=e(X,Ee,xe,ne,G+1),Ue=xe.length,0<O&&(Ee=n(Z,te,Re),Qe=a(3,xe,Ee,X,B,F,Ue,ne,G,re),te=Ee.join(""),Qe!==void 0&&(Ue=(xe=Qe.trim()).length)===0&&(ne=0,xe="")),0<Ue)switch(ne){case 115:te=te.replace(b,o);case 100:case 109:case 45:xe=te+"{"+xe+"}";break;case 107:te=te.replace(y,"$1 $2"),xe=te+"{"+xe+"}",xe=j===1||j===2&&s("@"+xe,3)?"@-webkit-"+xe+"@"+xe:"@"+xe;break;default:xe=te+xe,re===112&&(xe=(_e+=xe,""))}else xe="";break;default:xe=e(X,n(X,te,Re),xe,re,G+1)}Te+=xe,xe=Re=Ee=Ae=se=0,te="",ne=q.charCodeAt(++we);break;case 125:case 59:if(te=(0<Ee?te.replace(d,""):te).trim(),1<(Ue=te.length))switch(Ae===0&&(se=te.charCodeAt(0),se===45||96<se&&123>se)&&(Ue=(te=te.replace(" ",":")).length),0<O&&(Qe=a(1,te,X,z,B,F,_e.length,re,G,re))!==void 0&&(Ue=(te=Qe.trim()).length)===0&&(te="\0\0"),se=te.charCodeAt(0),ne=te.charCodeAt(1),se){case 0:break;case 64:if(ne===105||ne===99){Ie+=te+q.charAt(we);break}default:te.charCodeAt(Ue-1)!==58&&(_e+=r(te,se,ne,te.charCodeAt(2)))}Re=Ee=Ae=se=0,te="",ne=q.charCodeAt(++we)}}switch(ne){case 13:case 10:oe===47?oe=0:1+se===0&&re!==107&&0<te.length&&(Ee=1,te+="\0"),0<O*H&&a(0,te,X,z,B,F,_e.length,re,G,re),F=1,B++;break;case 59:case 125:if(oe+$+ve+K===0){F++;break}default:switch(F++,L=q.charAt(we),ne){case 9:case 32:if($+K+oe===0)switch(ie){case 44:case 58:case 9:case 32:L="";break;default:ne!==32&&(L=" ")}break;case 0:L="\\0";break;case 12:L="\\f";break;case 11:L="\\v";break;case 38:$+oe+K===0&&(Ee=Re=1,L="\f"+L);break;case 108:if($+oe+K+k===0&&0<Ae)switch(we-Ae){case 2:ie===112&&q.charCodeAt(we-3)===58&&(k=ie);case 8:me===111&&(k=me)}break;case 58:$+oe+K===0&&(Ae=we);break;case 44:oe+ve+$+K===0&&(Ee=1,L+="\r");break;case 34:case 39:oe===0&&($=$===ne?0:$===0?ne:$);break;case 91:$+oe+ve===0&&K++;break;case 93:$+oe+ve===0&&K--;break;case 41:$+oe+K===0&&ve--;break;case 40:if($+oe+K===0){if(se===0)switch(2*ie+3*me){case 533:break;default:se=1}ve++}break;case 64:oe+ve+$+K+Ae+xe===0&&(xe=1);break;case 42:case 47:if(!(0<$+K+ve))switch(oe){case 0:switch(2*ne+3*q.charCodeAt(we+1)){case 235:oe=47;break;case 220:Ue=we,oe=42}break;case 42:ne===47&&ie===42&&Ue+2!==we&&(q.charCodeAt(Ue+2)===33&&(_e+=q.substring(Ue,we+1)),L="",oe=0)}}oe===0&&(te+=L)}me=ie,ie=ne,we++}if(Ue=_e.length,0<Ue){if(Ee=X,0<O&&(Qe=a(2,_e,Ee,z,B,F,Ue,re,G,re),Qe!==void 0&&(_e=Qe).length===0))return Ie+_e+Te;if(_e=Ee.join(",")+"{"+_e+"}",j*k!==0){switch(j!==2||s(_e,2)||(k=0),k){case 111:_e=_e.replace(S,":-moz-$1")+_e;break;case 112:_e=_e.replace(_,"::-webkit-input-$1")+_e.replace(_,"::-moz-$1")+_e.replace(_,":-ms-input-$1")+_e}k=0}}return Ie+_e+Te}function n(z,X,q){var re=X.trim().split(g);X=re;var G=re.length,K=z.length;switch(K){case 0:case 1:var oe=0;for(z=K===0?"":z[0]+" ";oe<G;++oe)X[oe]=i(z,X[oe],q).trim();break;default:var ve=oe=0;for(X=[];oe<G;++oe)for(var $=0;$<K;++$)X[ve++]=i(z[$]+" ",re[oe],q).trim()}return X}function i(z,X,q){var re=X.charCodeAt(0);switch(33>re&&(re=(X=X.trim()).charCodeAt(0)),re){case 38:return X.replace(m,"$1"+z.trim());case 58:return z.trim()+X.replace(m,"$1"+z.trim());default:if(0<1*q&&0<X.indexOf("\f"))return X.replace(m,(z.charCodeAt(0)===58?"":"$1")+z.trim())}return z+X}function r(z,X,q,re){var G=z+";",K=2*X+3*q+4*re;if(K===944){z=G.indexOf(":",9)+1;var oe=G.substring(z,G.length-1).trim();return oe=G.substring(0,z).trim()+oe+";",j===1||j===2&&s(oe,1)?"-webkit-"+oe+oe:oe}if(j===0||j===2&&!s(G,1))return G;switch(K){case 1015:return G.charCodeAt(10)===97?"-webkit-"+G+G:G;case 951:return G.charCodeAt(3)===116?"-webkit-"+G+G:G;case 963:return G.charCodeAt(5)===110?"-webkit-"+G+G:G;case 1009:if(G.charCodeAt(4)!==100)break;case 969:case 942:return"-webkit-"+G+G;case 978:return"-webkit-"+G+"-moz-"+G+G;case 1019:case 983:return"-webkit-"+G+"-moz-"+G+"-ms-"+G+G;case 883:if(G.charCodeAt(8)===45)return"-webkit-"+G+G;if(0<G.indexOf("image-set(",11))return G.replace(R,"$1-webkit-$2")+G;break;case 932:if(G.charCodeAt(4)===45)switch(G.charCodeAt(5)){case 103:return"-webkit-box-"+G.replace("-grow","")+"-webkit-"+G+"-ms-"+G.replace("grow","positive")+G;case 115:return"-webkit-"+G+"-ms-"+G.replace("shrink","negative")+G;case 98:return"-webkit-"+G+"-ms-"+G.replace("basis","preferred-size")+G}return"-webkit-"+G+"-ms-"+G+G;case 964:return"-webkit-"+G+"-ms-flex-"+G+G;case 1023:if(G.charCodeAt(8)!==99)break;return oe=G.substring(G.indexOf(":",15)).replace("flex-","").replace("space-between","justify"),"-webkit-box-pack"+oe+"-webkit-"+G+"-ms-flex-pack"+oe+G;case 1005:return p.test(G)?G.replace(f,":-webkit-")+G.replace(f,":-moz-")+G:G;case 1e3:switch(oe=G.substring(13).trim(),X=oe.indexOf("-")+1,oe.charCodeAt(0)+oe.charCodeAt(X)){case 226:oe=G.replace(A,"tb");break;case 232:oe=G.replace(A,"tb-rl");break;case 220:oe=G.replace(A,"lr");break;default:return G}return"-webkit-"+G+"-ms-"+oe+G;case 1017:if(G.indexOf("sticky",9)===-1)break;case 975:switch(X=(G=z).length-10,oe=(G.charCodeAt(X)===33?G.substring(0,X):G).substring(z.indexOf(":",7)+1).trim(),K=oe.charCodeAt(0)+(oe.charCodeAt(7)|0)){case 203:if(111>oe.charCodeAt(8))break;case 115:G=G.replace(oe,"-webkit-"+oe)+";"+G;break;case 207:case 102:G=G.replace(oe,"-webkit-"+(102<K?"inline-":"")+"box")+";"+G.replace(oe,"-webkit-"+oe)+";"+G.replace(oe,"-ms-"+oe+"box")+";"+G}return G+";";case 938:if(G.charCodeAt(5)===45)switch(G.charCodeAt(6)){case 105:return oe=G.replace("-items",""),"-webkit-"+G+"-webkit-box-"+oe+"-ms-flex-"+oe+G;case 115:return"-webkit-"+G+"-ms-flex-item-"+G.replace(M,"")+G;default:return"-webkit-"+G+"-ms-flex-line-pack"+G.replace("align-content","").replace(M,"")+G}break;case 973:case 989:if(G.charCodeAt(3)!==45||G.charCodeAt(4)===122)break;case 931:case 953:if(P.test(z)===!0)return(oe=z.substring(z.indexOf(":")+1)).charCodeAt(0)===115?r(z.replace("stretch","fill-available"),X,q,re).replace(":fill-available",":stretch"):G.replace(oe,"-webkit-"+oe)+G.replace(oe,"-moz-"+oe.replace("fill-",""))+G;break;case 962:if(G="-webkit-"+G+(G.charCodeAt(5)===102?"-ms-"+G:"")+G,q+re===211&&G.charCodeAt(13)===105&&0<G.indexOf("transform",10))return G.substring(0,G.indexOf(";",27)+1).replace(v,"$1-webkit-$2")+G}return G}function s(z,X){var q=z.indexOf(X===1?":":"{"),re=z.substring(0,X!==3?q:10);return q=z.substring(q+1,z.length-1),W(X!==2?re:re.replace(E,"$1"),q,X)}function o(z,X){var q=r(X,X.charCodeAt(0),X.charCodeAt(1),X.charCodeAt(2));return q!==X+";"?q.replace(T," or ($1)").substring(4):"("+X+")"}function a(z,X,q,re,G,K,oe,ve,$,se){for(var ne=0,ie=X,me;ne<O;++ne)switch(me=ee[ne].call(h,z,ie,q,re,G,K,oe,ve,$,se)){case void 0:case!1:case!0:case null:break;default:ie=me}if(ie!==X)return ie}function l(z){switch(z){case void 0:case null:O=ee.length=0;break;default:if(typeof z=="function")ee[O++]=z;else if(typeof z=="object")for(var X=0,q=z.length;X<q;++X)l(z[X]);else H=!!z|0}return l}function c(z){return z=z.prefix,z!==void 0&&(W=null,z?typeof z!="function"?j=1:(j=2,W=z):j=0),c}function h(z,X){var q=z;if(33>q.charCodeAt(0)&&(q=q.trim()),Y=q,q=[Y],0<O){var re=a(-1,X,q,q,B,F,0,0,0,0);re!==void 0&&typeof re=="string"&&(X=re)}var G=e(Z,q,X,0,0);return 0<O&&(re=a(-2,G,q,q,B,F,G.length,0,0,0),re!==void 0&&(G=re)),Y="",k=0,F=B=1,G}var u=/^\0+/g,d=/[\0\r\f]/g,f=/: */g,p=/zoo|gra/,v=/([,: ])(transform)/g,g=/,\r+?/g,m=/([\t\r\n ])*\f?&/g,y=/@(k\w+)\s*(\S*)\s*/,_=/::(place)/g,S=/:(read-only)/g,A=/[svh]\w+-[tblr]{2}/,b=/\(\s*(.*)\s*\)/g,T=/([\s\S]*?);/g,M=/-self|flex-/g,E=/[^]*?(:[rp][el]a[\w-]+)[^]*/,P=/stretch|:\s*\w+\-(?:conte|avail)/,R=/([^-])(image-set\()/,F=1,B=1,k=0,j=1,Z=[],ee=[],O=0,W=null,H=0,Y="";return h.use=l,h.set=c,t!==void 0&&c(t),h}var Uze={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function kze(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var zze=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,_W=kze(function(t){return zze.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),WF=jF,Gze={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},Hze={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},Vze={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},M$={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},XF={};XF[WF.ForwardRef]=Vze;XF[WF.Memo]=M$;function wW(t){return WF.isMemo(t)?M$:XF[t.$$typeof]||Gze}var jze=Object.defineProperty,Wze=Object.getOwnPropertyNames,SW=Object.getOwnPropertySymbols,Xze=Object.getOwnPropertyDescriptor,Yze=Object.getPrototypeOf,bW=Object.prototype;function E$(t,e,n){if(typeof e!="string"){if(bW){var i=Yze(e);i&&i!==bW&&E$(t,i,n)}var r=Wze(e);SW&&(r=r.concat(SW(e)));for(var s=wW(t),o=wW(e),a=0;a<r.length;++a){var l=r[a];if(!Hze[l]&&!(n&&n[l])&&!(o&&o[l])&&!(s&&s[l])){var c=Xze(e,l);try{jze(t,l,c)}catch{}}}}return t}var qze=E$;const Qze=mM(qze);function Vc(){return(Vc=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}var AW=function(t,e){for(var n=[t[0]],i=0,r=e.length;i<r;i+=1)n.push(e[i],t[i+1]);return n},XI=function(t){return t!==null&&typeof t=="object"&&(t.toString?t.toString():Object.prototype.toString.call(t))==="[object Object]"&&!jF.typeOf(t)},fM=Object.freeze([]),Ih=Object.freeze({});function Gx(t){return typeof t=="function"}function MW(t){return t.displayName||t.name||"Component"}function YF(t){return t&&typeof t.styledComponentId=="string"}var qg=typeof process<"u"&&process.env!==void 0&&({}.REACT_APP_SC_ATTR||{}.SC_ATTR)||"data-styled",qF=typeof window<"u"&&"HTMLElement"in window,Kze=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&process.env!==void 0&&({}.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&{}.REACT_APP_SC_DISABLE_SPEEDY!==""?{}.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&{}.REACT_APP_SC_DISABLE_SPEEDY:{}.SC_DISABLE_SPEEDY!==void 0&&{}.SC_DISABLE_SPEEDY!==""&&{}.SC_DISABLE_SPEEDY!=="false"&&{}.SC_DISABLE_SPEEDY));function O1(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];throw new Error("An error occurred. See https://git.io/JUIaE#"+t+" for more information."+(n.length>0?" Args: "+n.join(", "):""))}var Jze=function(){function t(n){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=n}var e=t.prototype;return e.indexOfGroup=function(n){for(var i=0,r=0;r<n;r++)i+=this.groupSizes[r];return i},e.insertRules=function(n,i){if(n>=this.groupSizes.length){for(var r=this.groupSizes,s=r.length,o=s;n>=o;)(o<<=1)<0&&O1(16,""+n);this.groupSizes=new Uint32Array(o),this.groupSizes.set(r),this.length=o;for(var a=s;a<o;a++)this.groupSizes[a]=0}for(var l=this.indexOfGroup(n+1),c=0,h=i.length;c<h;c++)this.tag.insertRule(l,i[c])&&(this.groupSizes[n]++,l++)},e.clearGroup=function(n){if(n<this.length){var i=this.groupSizes[n],r=this.indexOfGroup(n),s=r+i;this.groupSizes[n]=0;for(var o=r;o<s;o++)this.tag.deleteRule(r)}},e.getGroup=function(n){var i="";if(n>=this.length||this.groupSizes[n]===0)return i;for(var r=this.groupSizes[n],s=this.indexOfGroup(n),o=s+r,a=s;a<o;a++)i+=this.tag.getRule(a)+`/*!sc*/
`;return i},t}(),Bb=new Map,pM=new Map,ky=1,KS=function(t){if(Bb.has(t))return Bb.get(t);for(;pM.has(ky);)ky++;var e=ky++;return Bb.set(t,e),pM.set(e,t),e},Zze=function(t){return pM.get(t)},$ze=function(t,e){e>=ky&&(ky=e+1),Bb.set(t,e),pM.set(e,t)},e4e="style["+qg+'][data-styled-version="5.3.10"]',t4e=new RegExp("^"+qg+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),n4e=function(t,e,n){for(var i,r=n.split(","),s=0,o=r.length;s<o;s++)(i=r[s])&&t.registerName(e,i)},i4e=function(t,e){for(var n=(e.textContent||"").split(`/*!sc*/
`),i=[],r=0,s=n.length;r<s;r++){var o=n[r].trim();if(o){var a=o.match(t4e);if(a){var l=0|parseInt(a[1],10),c=a[2];l!==0&&($ze(c,l),n4e(t,c,a[3]),t.getTag().insertRules(l,i)),i.length=0}else i.push(o)}}},r4e=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null},C$=function(t){var e=document.head,n=t||e,i=document.createElement("style"),r=function(a){for(var l=a.childNodes,c=l.length;c>=0;c--){var h=l[c];if(h&&h.nodeType===1&&h.hasAttribute(qg))return h}}(n),s=r!==void 0?r.nextSibling:null;i.setAttribute(qg,"active"),i.setAttribute("data-styled-version","5.3.10");var o=r4e();return o&&i.setAttribute("nonce",o),n.insertBefore(i,s),i},s4e=function(){function t(n){var i=this.element=C$(n);i.appendChild(document.createTextNode("")),this.sheet=function(r){if(r.sheet)return r.sheet;for(var s=document.styleSheets,o=0,a=s.length;o<a;o++){var l=s[o];if(l.ownerNode===r)return l}O1(17)}(i),this.length=0}var e=t.prototype;return e.insertRule=function(n,i){try{return this.sheet.insertRule(i,n),this.length++,!0}catch{return!1}},e.deleteRule=function(n){this.sheet.deleteRule(n),this.length--},e.getRule=function(n){var i=this.sheet.cssRules[n];return i!==void 0&&typeof i.cssText=="string"?i.cssText:""},t}(),o4e=function(){function t(n){var i=this.element=C$(n);this.nodes=i.childNodes,this.length=0}var e=t.prototype;return e.insertRule=function(n,i){if(n<=this.length&&n>=0){var r=document.createTextNode(i),s=this.nodes[n];return this.element.insertBefore(r,s||null),this.length++,!0}return!1},e.deleteRule=function(n){this.element.removeChild(this.nodes[n]),this.length--},e.getRule=function(n){return n<this.length?this.nodes[n].textContent:""},t}(),a4e=function(){function t(n){this.rules=[],this.length=0}var e=t.prototype;return e.insertRule=function(n,i){return n<=this.length&&(this.rules.splice(n,0,i),this.length++,!0)},e.deleteRule=function(n){this.rules.splice(n,1),this.length--},e.getRule=function(n){return n<this.length?this.rules[n]:""},t}(),EW=qF,l4e={isServer:!qF,useCSSOMInjection:!Kze},T$=function(){function t(n,i,r){n===void 0&&(n=Ih),i===void 0&&(i={}),this.options=Vc({},l4e,{},n),this.gs=i,this.names=new Map(r),this.server=!!n.isServer,!this.server&&qF&&EW&&(EW=!1,function(s){for(var o=document.querySelectorAll(e4e),a=0,l=o.length;a<l;a++){var c=o[a];c&&c.getAttribute(qg)!=="active"&&(i4e(s,c),c.parentNode&&c.parentNode.removeChild(c))}}(this))}t.registerId=function(n){return KS(n)};var e=t.prototype;return e.reconstructWithOptions=function(n,i){return i===void 0&&(i=!0),new t(Vc({},this.options,{},n),this.gs,i&&this.names||void 0)},e.allocateGSInstance=function(n){return this.gs[n]=(this.gs[n]||0)+1},e.getTag=function(){return this.tag||(this.tag=(r=(i=this.options).isServer,s=i.useCSSOMInjection,o=i.target,n=r?new a4e(o):s?new s4e(o):new o4e(o),new Jze(n)));var n,i,r,s,o},e.hasNameForId=function(n,i){return this.names.has(n)&&this.names.get(n).has(i)},e.registerName=function(n,i){if(KS(n),this.names.has(n))this.names.get(n).add(i);else{var r=new Set;r.add(i),this.names.set(n,r)}},e.insertRules=function(n,i,r){this.registerName(n,i),this.getTag().insertRules(KS(n),r)},e.clearNames=function(n){this.names.has(n)&&this.names.get(n).clear()},e.clearRules=function(n){this.getTag().clearGroup(KS(n)),this.clearNames(n)},e.clearTag=function(){this.tag=void 0},e.toString=function(){return function(n){for(var i=n.getTag(),r=i.length,s="",o=0;o<r;o++){var a=Zze(o);if(a!==void 0){var l=n.names.get(a),c=i.getGroup(o);if(l&&c&&l.size){var h=qg+".g"+o+'[id="'+a+'"]',u="";l!==void 0&&l.forEach(function(d){d.length>0&&(u+=d+",")}),s+=""+c+h+'{content:"'+u+`"}/*!sc*/
`}}}return s}(this)},t}(),c4e=/(a)(d)/gi,CW=function(t){return String.fromCharCode(t+(t>25?39:97))};function YI(t){var e,n="";for(e=Math.abs(t);e>52;e=e/52|0)n=CW(e%52)+n;return(CW(e%52)+n).replace(c4e,"$1-$2")}var Ym=function(t,e){for(var n=e.length;n;)t=33*t^e.charCodeAt(--n);return t},P$=function(t){return Ym(5381,t)};function u4e(t){for(var e=0;e<t.length;e+=1){var n=t[e];if(Gx(n)&&!YF(n))return!1}return!0}var h4e=P$("5.3.10"),d4e=function(){function t(e,n,i){this.rules=e,this.staticRulesId="",this.isStatic=(i===void 0||i.isStatic)&&u4e(e),this.componentId=n,this.baseHash=Ym(h4e,n),this.baseStyle=i,T$.registerId(n)}return t.prototype.generateAndInjectStyles=function(e,n,i){var r=this.componentId,s=[];if(this.baseStyle&&s.push(this.baseStyle.generateAndInjectStyles(e,n,i)),this.isStatic&&!i.hash)if(this.staticRulesId&&n.hasNameForId(r,this.staticRulesId))s.push(this.staticRulesId);else{var o=Qg(this.rules,e,n,i).join(""),a=YI(Ym(this.baseHash,o)>>>0);if(!n.hasNameForId(r,a)){var l=i(o,"."+a,void 0,r);n.insertRules(r,a,l)}s.push(a),this.staticRulesId=a}else{for(var c=this.rules.length,h=Ym(this.baseHash,i.hash),u="",d=0;d<c;d++){var f=this.rules[d];if(typeof f=="string")u+=f;else if(f){var p=Qg(f,e,n,i),v=Array.isArray(p)?p.join(""):p;h=Ym(h,v+d),u+=v}}if(u){var g=YI(h>>>0);if(!n.hasNameForId(r,g)){var m=i(u,"."+g,void 0,r);n.insertRules(r,g,m)}s.push(g)}}return s.join(" ")},t}(),f4e=/^\s*\/\/.*$/gm,p4e=[":","[",".","#"];function m4e(t){var e,n,i,r,s=t===void 0?Ih:t,o=s.options,a=o===void 0?Ih:o,l=s.plugins,c=l===void 0?fM:l,h=new Nze(a),u=[],d=function(v){function g(m){if(m)try{v(m+"}")}catch{}}return function(m,y,_,S,A,b,T,M,E,P){switch(m){case 1:if(E===0&&y.charCodeAt(0)===64)return v(y+";"),"";break;case 2:if(M===0)return y+"/*|*/";break;case 3:switch(M){case 102:case 112:return v(_[0]+y),"";default:return y+(P===0?"/*|*/":"")}case-2:y.split("/*|*/}").forEach(g)}}}(function(v){u.push(v)}),f=function(v,g,m){return g===0&&p4e.indexOf(m[n.length])!==-1||m.match(r)?v:"."+e};function p(v,g,m,y){y===void 0&&(y="&");var _=v.replace(f4e,""),S=g&&m?m+" "+g+" { "+_+" }":_;return e=y,n=g,i=new RegExp("\\"+n+"\\b","g"),r=new RegExp("(\\"+n+"\\b){2,}"),h(m||!g?"":g,S)}return h.use([].concat(c,[function(v,g,m){v===2&&m.length&&m[0].lastIndexOf(n)>0&&(m[0]=m[0].replace(i,f))},d,function(v){if(v===-2){var g=u;return u=[],g}}])),p.hash=c.length?c.reduce(function(v,g){return g.name||O1(15),Ym(v,g.name)},5381).toString():"",p}var D$=Wh.createContext();D$.Consumer;var R$=Wh.createContext(),g4e=(R$.Consumer,new T$),qI=m4e();function v4e(){return ge.useContext(D$)||g4e}function y4e(){return ge.useContext(R$)||qI}var x4e=function(){function t(e,n){var i=this;this.inject=function(r,s){s===void 0&&(s=qI);var o=i.name+s.hash;r.hasNameForId(i.id,o)||r.insertRules(i.id,o,s(i.rules,o,"@keyframes"))},this.toString=function(){return O1(12,String(i.name))},this.name=e,this.id="sc-keyframes-"+e,this.rules=n}return t.prototype.getName=function(e){return e===void 0&&(e=qI),this.name+e.hash},t}(),_4e=/([A-Z])/,w4e=/([A-Z])/g,S4e=/^ms-/,b4e=function(t){return"-"+t.toLowerCase()};function TW(t){return _4e.test(t)?t.replace(w4e,b4e).replace(S4e,"-ms-"):t}var PW=function(t){return t==null||t===!1||t===""};function Qg(t,e,n,i){if(Array.isArray(t)){for(var r,s=[],o=0,a=t.length;o<a;o+=1)(r=Qg(t[o],e,n,i))!==""&&(Array.isArray(r)?s.push.apply(s,r):s.push(r));return s}if(PW(t))return"";if(YF(t))return"."+t.styledComponentId;if(Gx(t)){if(typeof(c=t)!="function"||c.prototype&&c.prototype.isReactComponent||!e)return t;var l=t(e);return Qg(l,e,n,i)}var c;return t instanceof x4e?n?(t.inject(n,i),t.getName(i)):t:XI(t)?function h(u,d){var f,p,v=[];for(var g in u)u.hasOwnProperty(g)&&!PW(u[g])&&(Array.isArray(u[g])&&u[g].isCss||Gx(u[g])?v.push(TW(g)+":",u[g],";"):XI(u[g])?v.push.apply(v,h(u[g],g)):v.push(TW(g)+": "+(f=g,(p=u[g])==null||typeof p=="boolean"||p===""?"":typeof p!="number"||p===0||f in Uze||f.startsWith("--")?String(p).trim():p+"px")+";"));return d?[d+" {"].concat(v,["}"]):v}(t):t.toString()}var DW=function(t){return Array.isArray(t)&&(t.isCss=!0),t};function A4e(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return Gx(t)||XI(t)?DW(Qg(AW(fM,[t].concat(n)))):n.length===0&&t.length===1&&typeof t[0]=="string"?t:DW(Qg(AW(t,n)))}var M4e=function(t,e,n){return n===void 0&&(n=Ih),t.theme!==n.theme&&t.theme||e||n.theme},E4e=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,C4e=/(^-|-$)/g;function pD(t){return t.replace(E4e,"-").replace(C4e,"")}var T4e=function(t){return YI(P$(t)>>>0)};function JS(t){return typeof t=="string"&&!0}var QI=function(t){return typeof t=="function"||typeof t=="object"&&t!==null&&!Array.isArray(t)},P4e=function(t){return t!=="__proto__"&&t!=="constructor"&&t!=="prototype"};function D4e(t,e,n){var i=t[n];QI(e)&&QI(i)?L$(i,e):t[n]=e}function L$(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];for(var r=0,s=n;r<s.length;r++){var o=s[r];if(QI(o))for(var a in o)P4e(a)&&D4e(t,o[a],a)}return t}var I$=Wh.createContext();I$.Consumer;var mD={};function B$(t,e,n){var i=YF(t),r=!JS(t),s=e.attrs,o=s===void 0?fM:s,a=e.componentId,l=a===void 0?function(y,_){var S=typeof y!="string"?"sc":pD(y);mD[S]=(mD[S]||0)+1;var A=S+"-"+T4e("5.3.10"+S+mD[S]);return _?_+"-"+A:A}(e.displayName,e.parentComponentId):a,c=e.displayName,h=c===void 0?function(y){return JS(y)?"styled."+y:"Styled("+MW(y)+")"}(t):c,u=e.displayName&&e.componentId?pD(e.displayName)+"-"+e.componentId:e.componentId||l,d=i&&t.attrs?Array.prototype.concat(t.attrs,o).filter(Boolean):o,f=e.shouldForwardProp;i&&t.shouldForwardProp&&(f=e.shouldForwardProp?function(y,_,S){return t.shouldForwardProp(y,_,S)&&e.shouldForwardProp(y,_,S)}:t.shouldForwardProp);var p,v=new d4e(n,u,i?t.componentStyle:void 0),g=v.isStatic&&o.length===0,m=function(y,_){return function(S,A,b,T){var M=S.attrs,E=S.componentStyle,P=S.defaultProps,R=S.foldedComponentIds,F=S.shouldForwardProp,B=S.styledComponentId,k=S.target,j=function(re,G,K){re===void 0&&(re=Ih);var oe=Vc({},G,{theme:re}),ve={};return K.forEach(function($){var se,ne,ie,me=$;for(se in Gx(me)&&(me=me(oe)),me)oe[se]=ve[se]=se==="className"?(ne=ve[se],ie=me[se],ne&&ie?ne+" "+ie:ne||ie):me[se]}),[oe,ve]}(M4e(A,ge.useContext(I$),P)||Ih,A,M),Z=j[0],ee=j[1],O=function(re,G,K,oe){var ve=v4e(),$=y4e(),se=G?re.generateAndInjectStyles(Ih,ve,$):re.generateAndInjectStyles(K,ve,$);return se}(E,T,Z),W=b,H=ee.$as||A.$as||ee.as||A.as||k,Y=JS(H),z=ee!==A?Vc({},A,{},ee):A,X={};for(var q in z)q[0]!=="$"&&q!=="as"&&(q==="forwardedAs"?X.as=z[q]:(F?F(q,_W,H):!Y||_W(q))&&(X[q]=z[q]));return A.style&&ee.style!==A.style&&(X.style=Vc({},A.style,{},ee.style)),X.className=Array.prototype.concat(R,B,O!==B?O:null,A.className,ee.className).filter(Boolean).join(" "),X.ref=W,ge.createElement(H,X)}(p,y,_,g)};return m.displayName=h,(p=Wh.forwardRef(m)).attrs=d,p.componentStyle=v,p.displayName=h,p.shouldForwardProp=f,p.foldedComponentIds=i?Array.prototype.concat(t.foldedComponentIds,t.styledComponentId):fM,p.styledComponentId=u,p.target=i?t.target:t,p.withComponent=function(y){var _=e.componentId,S=function(b,T){if(b==null)return{};var M,E,P={},R=Object.keys(b);for(E=0;E<R.length;E++)M=R[E],T.indexOf(M)>=0||(P[M]=b[M]);return P}(e,["componentId"]),A=_&&_+"-"+(JS(y)?y:pD(MW(y)));return B$(y,Vc({},S,{attrs:d,componentId:A}),n)},Object.defineProperty(p,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(y){this._foldedDefaultProps=i?L$({},t.defaultProps,y):y}}),Object.defineProperty(p,"toString",{value:function(){return"."+p.styledComponentId}}),r&&Qze(p,t,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),p}var KI=function(t){return function e(n,i,r){if(r===void 0&&(r=Ih),!jF.isValidElementType(i))return O1(1,String(i));var s=function(){return n(i,r,A4e.apply(void 0,arguments))};return s.withConfig=function(o){return e(n,i,Vc({},r,{},o))},s.attrs=function(o){return e(n,i,Vc({},r,{attrs:Array.prototype.concat(r.attrs,o).filter(Boolean)}))},s}(B$,t)};["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach(function(t){KI[t]=KI(t)});const R4e=KI;var O$={exports:{}};(function(t,e){(function(i,r){t.exports=r(ge)})(Tee,n=>(()=>{var i={"./node_modules/css-mediaquery/index.js":(a,l)=>{l.match=p,l.parse=v;var c=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,h=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,u=/^(?:(min|max)-)?(.+)/,d=/(em|rem|px|cm|mm|in|pt|pc)?$/,f=/(dpi|dpcm|dppx)?$/;function p(_,S){return v(_).some(function(A){var b=A.inverse,T=A.type==="all"||S.type===A.type;if(T&&b||!(T||b))return!1;var M=A.expressions.every(function(E){var P=E.feature,R=E.modifier,F=E.value,B=S[P];if(!B)return!1;switch(P){case"orientation":case"scan":return B.toLowerCase()===F.toLowerCase();case"width":case"height":case"device-width":case"device-height":F=y(F),B=y(B);break;case"resolution":F=m(F),B=m(B);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":F=g(F),B=g(B);break;case"grid":case"color":case"color-index":case"monochrome":F=parseInt(F,10)||1,B=parseInt(B,10)||0;break}switch(R){case"min":return B>=F;case"max":return B<=F;default:return B===F}});return M&&!b||!M&&b})}function v(_){return _.split(",").map(function(S){S=S.trim();var A=S.match(c),b=A[1],T=A[2],M=A[3]||"",E={};return E.inverse=!!b&&b.toLowerCase()==="not",E.type=T?T.toLowerCase():"all",M=M.match(/\([^\)]+\)/g)||[],E.expressions=M.map(function(P){var R=P.match(h),F=R[1].toLowerCase().match(u);return{modifier:F[1],feature:F[2],value:R[2]}}),E})}function g(_){var S=Number(_),A;return S||(A=_.match(/^(\d+)\s*\/\s*(\d+)$/),S=A[1]/A[2]),S}function m(_){var S=parseFloat(_),A=String(_).match(f)[1];switch(A){case"dpcm":return S/2.54;case"dppx":return S*96;default:return S}}function y(_){var S=parseFloat(_),A=String(_).match(d)[1];switch(A){case"em":return S*16;case"rem":return S*16;case"cm":return S*96/2.54;case"mm":return S*96/2.54/10;case"in":return S*96;case"pt":return S*72;case"pc":return S*72/12;default:return S}}},"./node_modules/hyphenate-style-name/index.js":(a,l,c)=>{c.r(l),c.d(l,{default:()=>v});var h=/[A-Z]/g,u=/^ms-/,d={};function f(g){return"-"+g.toLowerCase()}function p(g){if(d.hasOwnProperty(g))return d[g];var m=g.replace(h,f);return d[g]=u.test(m)?"-"+m:m}const v=p},"./node_modules/matchmediaquery/index.js":(a,l,c)=>{var h=c("./node_modules/css-mediaquery/index.js").match,u=typeof window<"u"?window.matchMedia:null;function d(p,v,g){var m=this;if(u&&!g){var y=u.call(window,p);this.matches=y.matches,this.media=y.media,y.addListener(A)}else this.matches=h(p,v),this.media=p;this.addListener=_,this.removeListener=S,this.dispose=b;function _(T){y&&y.addListener(T)}function S(T){y&&y.removeListener(T)}function A(T){m.matches=T.matches,m.media=T.media}function b(){y&&y.removeListener(A)}}function f(p,v,g){return new d(p,v,g)}a.exports=f},"./node_modules/object-assign/index.js":a=>{/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var l=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable;function u(f){if(f==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(f)}function d(){try{if(!Object.assign)return!1;var f=new String("abc");if(f[5]="de",Object.getOwnPropertyNames(f)[0]==="5")return!1;for(var p={},v=0;v<10;v++)p["_"+String.fromCharCode(v)]=v;var g=Object.getOwnPropertyNames(p).map(function(y){return p[y]});if(g.join("")!=="0123456789")return!1;var m={};return"abcdefghijklmnopqrst".split("").forEach(function(y){m[y]=y}),Object.keys(Object.assign({},m)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}a.exports=d()?Object.assign:function(f,p){for(var v,g=u(f),m,y=1;y<arguments.length;y++){v=Object(arguments[y]);for(var _ in v)c.call(v,_)&&(g[_]=v[_]);if(l){m=l(v);for(var S=0;S<m.length;S++)h.call(v,m[S])&&(g[m[S]]=v[m[S]])}}return g}},"./node_modules/prop-types/checkPropTypes.js":(a,l,c)=>{var h=function(){};{var u=c("./node_modules/prop-types/lib/ReactPropTypesSecret.js"),d={},f=c("./node_modules/prop-types/lib/has.js");h=function(v){var g="Warning: "+v;typeof console<"u"&&console.error(g);try{throw new Error(g)}catch{}}}function p(v,g,m,y,_){for(var S in v)if(f(v,S)){var A;try{if(typeof v[S]!="function"){var b=Error((y||"React class")+": "+m+" type `"+S+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof v[S]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw b.name="Invariant Violation",b}A=v[S](g,S,y,m,null,u)}catch(M){A=M}if(A&&!(A instanceof Error)&&h((y||"React class")+": type specification of "+m+" `"+S+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof A+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),A instanceof Error&&!(A.message in d)){d[A.message]=!0;var T=_?_():"";h("Failed "+m+" type: "+A.message+(T??""))}}}p.resetWarningCache=function(){d={}},a.exports=p},"./node_modules/prop-types/factoryWithTypeCheckers.js":(a,l,c)=>{var h=c("./node_modules/react-is/index.js"),u=c("./node_modules/object-assign/index.js"),d=c("./node_modules/prop-types/lib/ReactPropTypesSecret.js"),f=c("./node_modules/prop-types/lib/has.js"),p=c("./node_modules/prop-types/checkPropTypes.js"),v=function(){};v=function(m){var y="Warning: "+m;typeof console<"u"&&console.error(y);try{throw new Error(y)}catch{}};function g(){return null}a.exports=function(m,y){var _=typeof Symbol=="function"&&Symbol.iterator,S="@@iterator";function A($){var se=$&&(_&&$[_]||$[S]);if(typeof se=="function")return se}var b="<<anonymous>>",T={array:R("array"),bigint:R("bigint"),bool:R("boolean"),func:R("function"),number:R("number"),object:R("object"),string:R("string"),symbol:R("symbol"),any:F(),arrayOf:B,element:k(),elementType:j(),instanceOf:Z,node:H(),objectOf:O,oneOf:ee,oneOfType:W,shape:z,exact:X};function M($,se){return $===se?$!==0||1/$===1/se:$!==$&&se!==se}function E($,se){this.message=$,this.data=se&&typeof se=="object"?se:{},this.stack=""}E.prototype=Error.prototype;function P($){var se={},ne=0;function ie(xe,Ae,we,Ee,Re,Ue,Ne){if(Ee=Ee||b,Ue=Ue||we,Ne!==d){if(y){var U=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw U.name="Invariant Violation",U}else if(typeof console<"u"){var L=Ee+":"+we;!se[L]&&ne<3&&(v("You are manually calling a React.PropTypes validation function for the `"+Ue+"` prop on `"+Ee+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),se[L]=!0,ne++)}}return Ae[we]==null?xe?Ae[we]===null?new E("The "+Re+" `"+Ue+"` is marked as required "+("in `"+Ee+"`, but its value is `null`.")):new E("The "+Re+" `"+Ue+"` is marked as required in "+("`"+Ee+"`, but its value is `undefined`.")):null:$(Ae,we,Ee,Re,Ue)}var me=ie.bind(null,!1);return me.isRequired=ie.bind(null,!0),me}function R($){function se(ne,ie,me,xe,Ae,we){var Ee=ne[ie],Re=G(Ee);if(Re!==$){var Ue=K(Ee);return new E("Invalid "+xe+" `"+Ae+"` of type "+("`"+Ue+"` supplied to `"+me+"`, expected ")+("`"+$+"`."),{expectedType:$})}return null}return P(se)}function F(){return P(g)}function B($){function se(ne,ie,me,xe,Ae){if(typeof $!="function")return new E("Property `"+Ae+"` of component `"+me+"` has invalid PropType notation inside arrayOf.");var we=ne[ie];if(!Array.isArray(we)){var Ee=G(we);return new E("Invalid "+xe+" `"+Ae+"` of type "+("`"+Ee+"` supplied to `"+me+"`, expected an array."))}for(var Re=0;Re<we.length;Re++){var Ue=$(we,Re,me,xe,Ae+"["+Re+"]",d);if(Ue instanceof Error)return Ue}return null}return P(se)}function k(){function $(se,ne,ie,me,xe){var Ae=se[ne];if(!m(Ae)){var we=G(Ae);return new E("Invalid "+me+" `"+xe+"` of type "+("`"+we+"` supplied to `"+ie+"`, expected a single ReactElement."))}return null}return P($)}function j(){function $(se,ne,ie,me,xe){var Ae=se[ne];if(!h.isValidElementType(Ae)){var we=G(Ae);return new E("Invalid "+me+" `"+xe+"` of type "+("`"+we+"` supplied to `"+ie+"`, expected a single ReactElement type."))}return null}return P($)}function Z($){function se(ne,ie,me,xe,Ae){if(!(ne[ie]instanceof $)){var we=$.name||b,Ee=ve(ne[ie]);return new E("Invalid "+xe+" `"+Ae+"` of type "+("`"+Ee+"` supplied to `"+me+"`, expected ")+("instance of `"+we+"`."))}return null}return P(se)}function ee($){if(!Array.isArray($))return arguments.length>1?v("Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z])."):v("Invalid argument supplied to oneOf, expected an array."),g;function se(ne,ie,me,xe,Ae){for(var we=ne[ie],Ee=0;Ee<$.length;Ee++)if(M(we,$[Ee]))return null;var Re=JSON.stringify($,function(Ne,U){var L=K(U);return L==="symbol"?String(U):U});return new E("Invalid "+xe+" `"+Ae+"` of value `"+String(we)+"` "+("supplied to `"+me+"`, expected one of "+Re+"."))}return P(se)}function O($){function se(ne,ie,me,xe,Ae){if(typeof $!="function")return new E("Property `"+Ae+"` of component `"+me+"` has invalid PropType notation inside objectOf.");var we=ne[ie],Ee=G(we);if(Ee!=="object")return new E("Invalid "+xe+" `"+Ae+"` of type "+("`"+Ee+"` supplied to `"+me+"`, expected an object."));for(var Re in we)if(f(we,Re)){var Ue=$(we,Re,me,xe,Ae+"."+Re,d);if(Ue instanceof Error)return Ue}return null}return P(se)}function W($){if(!Array.isArray($))return v("Invalid argument supplied to oneOfType, expected an instance of array."),g;for(var se=0;se<$.length;se++){var ne=$[se];if(typeof ne!="function")return v("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+oe(ne)+" at index "+se+"."),g}function ie(me,xe,Ae,we,Ee){for(var Re=[],Ue=0;Ue<$.length;Ue++){var Ne=$[Ue],U=Ne(me,xe,Ae,we,Ee,d);if(U==null)return null;U.data&&f(U.data,"expectedType")&&Re.push(U.data.expectedType)}var L=Re.length>0?", expected one of type ["+Re.join(", ")+"]":"";return new E("Invalid "+we+" `"+Ee+"` supplied to "+("`"+Ae+"`"+L+"."))}return P(ie)}function H(){function $(se,ne,ie,me,xe){return q(se[ne])?null:new E("Invalid "+me+" `"+xe+"` supplied to "+("`"+ie+"`, expected a ReactNode."))}return P($)}function Y($,se,ne,ie,me){return new E(($||"React class")+": "+se+" type `"+ne+"."+ie+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+me+"`.")}function z($){function se(ne,ie,me,xe,Ae){var we=ne[ie],Ee=G(we);if(Ee!=="object")return new E("Invalid "+xe+" `"+Ae+"` of type `"+Ee+"` "+("supplied to `"+me+"`, expected `object`."));for(var Re in $){var Ue=$[Re];if(typeof Ue!="function")return Y(me,xe,Ae,Re,K(Ue));var Ne=Ue(we,Re,me,xe,Ae+"."+Re,d);if(Ne)return Ne}return null}return P(se)}function X($){function se(ne,ie,me,xe,Ae){var we=ne[ie],Ee=G(we);if(Ee!=="object")return new E("Invalid "+xe+" `"+Ae+"` of type `"+Ee+"` "+("supplied to `"+me+"`, expected `object`."));var Re=u({},ne[ie],$);for(var Ue in Re){var Ne=$[Ue];if(f($,Ue)&&typeof Ne!="function")return Y(me,xe,Ae,Ue,K(Ne));if(!Ne)return new E("Invalid "+xe+" `"+Ae+"` key `"+Ue+"` supplied to `"+me+"`.\nBad object: "+JSON.stringify(ne[ie],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys($),null,"  "));var U=Ne(we,Ue,me,xe,Ae+"."+Ue,d);if(U)return U}return null}return P(se)}function q($){switch(typeof $){case"number":case"string":case"undefined":return!0;case"boolean":return!$;case"object":if(Array.isArray($))return $.every(q);if($===null||m($))return!0;var se=A($);if(se){var ne=se.call($),ie;if(se!==$.entries){for(;!(ie=ne.next()).done;)if(!q(ie.value))return!1}else for(;!(ie=ne.next()).done;){var me=ie.value;if(me&&!q(me[1]))return!1}}else return!1;return!0;default:return!1}}function re($,se){return $==="symbol"?!0:se?se["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&se instanceof Symbol:!1}function G($){var se=typeof $;return Array.isArray($)?"array":$ instanceof RegExp?"object":re(se,$)?"symbol":se}function K($){if(typeof $>"u"||$===null)return""+$;var se=G($);if(se==="object"){if($ instanceof Date)return"date";if($ instanceof RegExp)return"regexp"}return se}function oe($){var se=K($);switch(se){case"array":case"object":return"an "+se;case"boolean":case"date":case"regexp":return"a "+se;default:return se}}function ve($){return!$.constructor||!$.constructor.name?b:$.constructor.name}return T.checkPropTypes=p,T.resetWarningCache=p.resetWarningCache,T.PropTypes=T,T}},"./node_modules/prop-types/index.js":(a,l,c)=>{{var h=c("./node_modules/react-is/index.js"),u=!0;a.exports=c("./node_modules/prop-types/factoryWithTypeCheckers.js")(h.isElement,u)}},"./node_modules/prop-types/lib/ReactPropTypesSecret.js":a=>{var l="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";a.exports=l},"./node_modules/prop-types/lib/has.js":a=>{a.exports=Function.call.bind(Object.prototype.hasOwnProperty)},"./node_modules/react-is/cjs/react-is.development.js":(a,l)=>{/** @license React v16.13.1
 * react-is.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){var c=typeof Symbol=="function"&&Symbol.for,h=c?Symbol.for("react.element"):60103,u=c?Symbol.for("react.portal"):60106,d=c?Symbol.for("react.fragment"):60107,f=c?Symbol.for("react.strict_mode"):60108,p=c?Symbol.for("react.profiler"):60114,v=c?Symbol.for("react.provider"):60109,g=c?Symbol.for("react.context"):60110,m=c?Symbol.for("react.async_mode"):60111,y=c?Symbol.for("react.concurrent_mode"):60111,_=c?Symbol.for("react.forward_ref"):60112,S=c?Symbol.for("react.suspense"):60113,A=c?Symbol.for("react.suspense_list"):60120,b=c?Symbol.for("react.memo"):60115,T=c?Symbol.for("react.lazy"):60116,M=c?Symbol.for("react.block"):60121,E=c?Symbol.for("react.fundamental"):60117,P=c?Symbol.for("react.responder"):60118,R=c?Symbol.for("react.scope"):60119;function F(Ne){return typeof Ne=="string"||typeof Ne=="function"||Ne===d||Ne===y||Ne===p||Ne===f||Ne===S||Ne===A||typeof Ne=="object"&&Ne!==null&&(Ne.$$typeof===T||Ne.$$typeof===b||Ne.$$typeof===v||Ne.$$typeof===g||Ne.$$typeof===_||Ne.$$typeof===E||Ne.$$typeof===P||Ne.$$typeof===R||Ne.$$typeof===M)}function B(Ne){if(typeof Ne=="object"&&Ne!==null){var U=Ne.$$typeof;switch(U){case h:var L=Ne.type;switch(L){case m:case y:case d:case p:case f:case S:return L;default:var te=L&&L.$$typeof;switch(te){case g:case _:case T:case b:case v:return te;default:return U}}case u:return U}}}var k=m,j=y,Z=g,ee=v,O=h,W=_,H=d,Y=T,z=b,X=u,q=p,re=f,G=S,K=!1;function oe(Ne){return K||(K=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),ve(Ne)||B(Ne)===m}function ve(Ne){return B(Ne)===y}function $(Ne){return B(Ne)===g}function se(Ne){return B(Ne)===v}function ne(Ne){return typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===h}function ie(Ne){return B(Ne)===_}function me(Ne){return B(Ne)===d}function xe(Ne){return B(Ne)===T}function Ae(Ne){return B(Ne)===b}function we(Ne){return B(Ne)===u}function Ee(Ne){return B(Ne)===p}function Re(Ne){return B(Ne)===f}function Ue(Ne){return B(Ne)===S}l.AsyncMode=k,l.ConcurrentMode=j,l.ContextConsumer=Z,l.ContextProvider=ee,l.Element=O,l.ForwardRef=W,l.Fragment=H,l.Lazy=Y,l.Memo=z,l.Portal=X,l.Profiler=q,l.StrictMode=re,l.Suspense=G,l.isAsyncMode=oe,l.isConcurrentMode=ve,l.isContextConsumer=$,l.isContextProvider=se,l.isElement=ne,l.isForwardRef=ie,l.isFragment=me,l.isLazy=xe,l.isMemo=Ae,l.isPortal=we,l.isProfiler=Ee,l.isStrictMode=Re,l.isSuspense=Ue,l.isValidElementType=F,l.typeOf=B})()},"./node_modules/react-is/index.js":(a,l,c)=>{a.exports=c("./node_modules/react-is/cjs/react-is.development.js")},"./node_modules/shallow-equal/dist/index.esm.js":(a,l,c)=>{c.r(l),c.d(l,{shallowEqualArrays:()=>u,shallowEqualObjects:()=>h});function h(d,f){if(d===f)return!0;if(!d||!f)return!1;var p=Object.keys(d),v=Object.keys(f),g=p.length;if(v.length!==g)return!1;for(var m=0;m<g;m++){var y=p[m];if(d[y]!==f[y]||!Object.prototype.hasOwnProperty.call(f,y))return!1}return!0}function u(d,f){if(d===f)return!0;if(!d||!f)return!1;var p=d.length;if(f.length!==p)return!1;for(var v=0;v<p;v++)if(d[v]!==f[v])return!1;return!0}},"./src/Component.ts":function(a,l,c){var h=this&&this.__rest||function(p,v){var g={};for(var m in p)Object.prototype.hasOwnProperty.call(p,m)&&v.indexOf(m)<0&&(g[m]=p[m]);if(p!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,m=Object.getOwnPropertySymbols(p);y<m.length;y++)v.indexOf(m[y])<0&&Object.prototype.propertyIsEnumerable.call(p,m[y])&&(g[m[y]]=p[m[y]]);return g},u=this&&this.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(l,"__esModule",{value:!0});var d=u(c("./src/useMediaQuery.ts")),f=function(p){var v=p.children,g=p.device,m=p.onChange,y=h(p,["children","device","onChange"]),_=(0,d.default)(y,g,m);return typeof v=="function"?v(_):_?v:null};l.default=f},"./src/Context.ts":(a,l,c)=>{Object.defineProperty(l,"__esModule",{value:!0});var h=c("react"),u=(0,h.createContext)(void 0);l.default=u},"./src/index.ts":function(a,l,c){var h=this&&this.__importDefault||function(v){return v&&v.__esModule?v:{default:v}};Object.defineProperty(l,"__esModule",{value:!0}),l.Context=l.toQuery=l.useMediaQuery=l.default=void 0;var u=h(c("./src/useMediaQuery.ts"));l.useMediaQuery=u.default;var d=h(c("./src/Component.ts"));l.default=d.default;var f=h(c("./src/toQuery.ts"));l.toQuery=f.default;var p=h(c("./src/Context.ts"));l.Context=p.default},"./src/mediaQuery.ts":function(a,l,c){var h=this&&this.__assign||function(){return h=Object.assign||function(S){for(var A,b=1,T=arguments.length;b<T;b++){A=arguments[b];for(var M in A)Object.prototype.hasOwnProperty.call(A,M)&&(S[M]=A[M])}return S},h.apply(this,arguments)},u=this&&this.__rest||function(S,A){var b={};for(var T in S)Object.prototype.hasOwnProperty.call(S,T)&&A.indexOf(T)<0&&(b[T]=S[T]);if(S!=null&&typeof Object.getOwnPropertySymbols=="function")for(var M=0,T=Object.getOwnPropertySymbols(S);M<T.length;M++)A.indexOf(T[M])<0&&Object.prototype.propertyIsEnumerable.call(S,T[M])&&(b[T[M]]=S[T[M]]);return b},d=this&&this.__importDefault||function(S){return S&&S.__esModule?S:{default:S}};Object.defineProperty(l,"__esModule",{value:!0});var f=d(c("./node_modules/prop-types/index.js")),p=f.default.oneOfType([f.default.string,f.default.number]),v={all:f.default.bool,grid:f.default.bool,aural:f.default.bool,braille:f.default.bool,handheld:f.default.bool,print:f.default.bool,projection:f.default.bool,screen:f.default.bool,tty:f.default.bool,tv:f.default.bool,embossed:f.default.bool},g={orientation:f.default.oneOf(["portrait","landscape"]),scan:f.default.oneOf(["progressive","interlace"]),aspectRatio:f.default.string,deviceAspectRatio:f.default.string,height:p,deviceHeight:p,width:p,deviceWidth:p,color:f.default.bool,colorIndex:f.default.bool,monochrome:f.default.bool,resolution:p,type:Object.keys(v)};g.type;var m=u(g,["type"]),y=h({minAspectRatio:f.default.string,maxAspectRatio:f.default.string,minDeviceAspectRatio:f.default.string,maxDeviceAspectRatio:f.default.string,minHeight:p,maxHeight:p,minDeviceHeight:p,maxDeviceHeight:p,minWidth:p,maxWidth:p,minDeviceWidth:p,maxDeviceWidth:p,minColor:f.default.number,maxColor:f.default.number,minColorIndex:f.default.number,maxColorIndex:f.default.number,minMonochrome:f.default.number,maxMonochrome:f.default.number,minResolution:p,maxResolution:p},m),_=h(h({},v),y);l.default={all:_,types:v,matchers:g,features:y}},"./src/toQuery.ts":function(a,l,c){var h=this&&this.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(l,"__esModule",{value:!0});var u=h(c("./node_modules/hyphenate-style-name/index.js")),d=h(c("./src/mediaQuery.ts")),f=function(m){return"not ".concat(m)},p=function(m,y){var _=(0,u.default)(m);return typeof y=="number"&&(y="".concat(y,"px")),y===!0?_:y===!1?f(_):"(".concat(_,": ").concat(y,")")},v=function(m){return m.join(" and ")},g=function(m){var y=[];return Object.keys(d.default.all).forEach(function(_){var S=m[_];S!=null&&y.push(p(_,S))}),v(y)};l.default=g},"./src/useMediaQuery.ts":function(a,l,c){var h=this&&this.__importDefault||function(E){return E&&E.__esModule?E:{default:E}};Object.defineProperty(l,"__esModule",{value:!0});var u=c("react"),d=h(c("./node_modules/matchmediaquery/index.js")),f=h(c("./node_modules/hyphenate-style-name/index.js")),p=c("./node_modules/shallow-equal/dist/index.esm.js"),v=h(c("./src/toQuery.ts")),g=h(c("./src/Context.ts")),m=function(E){return E.query||(0,v.default)(E)},y=function(E){if(E){var P=Object.keys(E);return P.reduce(function(R,F){return R[(0,f.default)(F)]=E[F],R},{})}},_=function(){var E=(0,u.useRef)(!1);return(0,u.useEffect)(function(){E.current=!0},[]),E.current},S=function(E){var P=(0,u.useContext)(g.default),R=function(){return y(E)||y(P)},F=(0,u.useState)(R),B=F[0],k=F[1];return(0,u.useEffect)(function(){var j=R();(0,p.shallowEqualObjects)(B,j)||k(j)},[E,P]),B},A=function(E){var P=function(){return m(E)},R=(0,u.useState)(P),F=R[0],B=R[1];return(0,u.useEffect)(function(){var k=P();F!==k&&B(k)},[E]),F},b=function(E,P){var R=function(){return(0,d.default)(E,P||{},!!P)},F=(0,u.useState)(R),B=F[0],k=F[1],j=_();return(0,u.useEffect)(function(){if(j){var Z=R();return k(Z),function(){Z&&Z.dispose()}}},[E,P]),B},T=function(E){var P=(0,u.useState)(E.matches),R=P[0],F=P[1];return(0,u.useEffect)(function(){var B=function(k){F(k.matches)};return E.addListener(B),F(E.matches),function(){E.removeListener(B)}},[E]),R},M=function(E,P,R){var F=S(P),B=A(E);if(!B)throw new Error("Invalid or missing MediaQuery!");var k=b(B,F),j=T(k),Z=_();return(0,u.useEffect)(function(){Z&&R&&R(j)},[j]),(0,u.useEffect)(function(){return function(){k&&k.dispose()}},[]),j};l.default=M},react:a=>{a.exports=n}},r={};function s(a){var l=r[a];if(l!==void 0)return l.exports;var c=r[a]={exports:{}};return i[a].call(c.exports,c,c.exports,s),c.exports}s.d=(a,l)=>{for(var c in l)s.o(l,c)&&!s.o(a,c)&&Object.defineProperty(a,c,{enumerable:!0,get:l[c]})},s.o=(a,l)=>Object.prototype.hasOwnProperty.call(a,l),s.r=a=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})};var o=s("./src/index.ts");return o})())})(O$);var L4e=O$.exports;const I4e=()=>{const t=L4e.useMediaQuery({maxWidth:1068});return We.jsx(We.Fragment,{children:We.jsx("div",{children:We.jsx(B4e,{className:"flex flex-col w-screen h-screen min-h-screen items-center justify-center relative",children:t?We.jsx(xW,{className:"splinesm",scene:"https://prod.spline.design/2UDr40IsmI03S33u/scene.splinecode"}):We.jsx(xW,{className:"spline",scene:"https://prod.spline.design/fHSFs1CucN88MZIU/scene.splinecode"})})})})},B4e=R4e.div`



.spline {
  position: absolute;
  //  width: 200%;
  // height: 100%
  // overflow-x: hidden;

  // @media (max-width: 576px){
  //   display: none;
  // }
   
  @media (min-width: 390px){
    transform: scale(0.25) translateX(-1100px);
    
  }
  @media (min-width: 600px){
    transform: scale(0.4) translateX(-1000px);
    
  }
  @media (min-width: 824px){
    transform: scale(0.5) translateX(-850px);
  }
  @media (min-width: 1024px){
    transform: scale(0.6) translateX(-700px);
  }
  @media (min-width: 1224px){
    transform: scale(0.7) translateX(-600px);
  }
  @media (min-width: 1524px){
    transform: scale(0.8) translateX(-500px);
  }
  @media (min-width: 1754px){
    transform: scale(0.9) translateX(-400px);
  }
  @media (min-width: 1954px){
    transform: scale(1) translateX(-300px);
  }
   
}

.splinesm {
  position: absolute;
  //  width: 200%;
  // height: 100%
  // overflow-x: hidden;

  // @media (max-width: 576px){
  //   display: none;
  // }

  //WIDTH

  @media (min-width: 290px){
    transform: scale(.9) translateY(250px);
    
  }
  @media (min-width: 390px){
    transform: scale(1) translateY(250px);
    
  }
  @media (min-width: 500px){
    transform: scale(1.2) translateX(100px)  translateY(150px);
  }
  @media (min-width: 600px){
    transform: scale(1.2) translateX(220px)  translateY(300px);
    
  }
  @media (min-width: 800px){
    transform: scale(1.2) translateX(250px)  translateY(350px);
  }
  @media (min-width: 900px){
    transform: scale(1.5) translateX(300px)  translateY(450px);
  }

// Height

  
}

`,O4e=()=>We.jsxs("div",{className:"absolute top-40",children:[We.jsxs("div",{className:"relative",children:[We.jsxs("h1",{className:`${iu.heroHeadText} text-white ml-20`,children:[We.jsxs("div",{className:"static-texts",children:["Hi, I'm ",We.jsx("span",{className:"text-[#08B6F9]",children:"Steven"})]}),We.jsx("span",{className:"text-[#08B6F9]",children:We.jsx("ul",{className:"dynamic-texts"})})]}),We.jsxs("p",{className:`${iu.heroSubText} mt-2 ml-20 text-white-100`,children:["A Computer Engineering Student ",We.jsx("br",{className:"sm:block hidden"})]})]}),We.jsxs("div",{className:"flex flex-col justify-center ml-10 mt-5 relative",children:[We.jsx("div",{className:"w-5 h-5 rounded-full bg-[#08B6F9]"}),We.jsx("div",{className:"flex flex-col neon-gradient ml-2"}),We.jsx("div",{className:"flex flex-col neonFade-gradient ml-2"})]})]}),F4e=()=>We.jsxs("div",{className:"relative z-0 bg-primary",children:[We.jsx(dpe,{}),We.jsx(ipe,{}),We.jsx(O4e,{}),We.jsx(I4e,{}),We.jsx("div",{className:" bg-cover bg-no-repeat bg-center pointer-events-none"}),We.jsxs("div",{className:"relative z-0",children:[We.jsx("div",{id:"about",children:We.jsx(eQ,{})}),We.jsx("div",{id:"project",children:We.jsx(z0e,{})}),We.jsx("div",{id:"contact",children:We.jsx(cQ,{})})]})]}),N4e=()=>We.jsx("div",{children:"NoPage"}),U4e=()=>We.jsx(qie,{children:We.jsxs(Vie,{children:[We.jsx(cm,{index:!0,element:We.jsx(F4e,{})}),We.jsx(cm,{path:"/Tech",element:We.jsx(S0e,{})}),We.jsx(cm,{path:"/About",element:We.jsx(eQ,{})}),We.jsx(cm,{path:"/Contact",element:We.jsx(cQ,{})}),We.jsx(cm,{path:"*",element:We.jsx(N4e,{})})]})});gD.createRoot(document.getElementById("root")).render(We.jsx(Wh.StrictMode,{children:We.jsx(U4e,{})}))});export default k4e();
